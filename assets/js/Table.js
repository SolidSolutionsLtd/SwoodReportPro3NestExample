const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./mu42bxql.js","../main.C0iT5PB5.js","../css/main.qzrU6PW5.css","./VariableParser.js"])))=>i.map(i=>d[i]);
var mS=Object.defineProperty;var vS=(s,t,e)=>t in s?mS(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var Ne=(s,t,e)=>vS(s,typeof t!="symbol"?t+"":t,e);import{s as Ro,t as Io,r as _e,O as h0,j as Ae,Q as gS,U as Co,V as ql,W as bS,F as _o,v as ds,X as O1,y as fh,Y as u0,d as D1,x as Ta,z as yS,Z as c0,E as Ys,_ as xS,w as rn,$ as CS,a0 as wS,a1 as ES,a2 as em,a3 as SS,a4 as Ec,a5 as tm,a6 as wl,a7 as L1,a8 as kS,a9 as TS,aa as f0,H as ns,ab as AS,ac as OS,ad as d0,ae as Gh,af as DS,ag as p0,ah as LS,J as RS,ai as IS,aj as _S,k as ks,ak as m,al as ie,am as po,an as Ue,ao as Cf,ap as It,aq as m0,ar as FS,as as R1,at as NS,au as MS,av as Pe,aw as I1,ax as P,ay as os,az as mr,aA as R,aB as Z,aC as Oe,aD as O,aE as Se,aF as Wi,aG as Rr,aH as X,aI as fi,aJ as fn,aK as Ii,aL as ea,aM as at,aN as wt,aO as Ir,aP as ia,aQ as st,aR as xe,aS as vr,aT as Ur,aU as ye,aV as dt,aW as Zi,aX as Yu,aY as Dl,aZ as On,a_ as Cs,a$ as br,b0 as Ji,b1 as to,b2 as He,b3 as _1,b4 as gr,b5 as Cn,b6 as v0,b7 as F1,b8 as PS,b9 as Ud,ba as BS,bb as N1,bc as HS,T as Ll,S as wf,b as Xh,bd as io,be as M1,B as mo,bf as VS,I as no,bg as Kh,g as im,bh as jn,P as WS,bi as zS,c as jS}from"../main.C0iT5PB5.js";import{V as g0}from"./VariableParser.js";var P1={exports:{}},US="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",$S=US,qS=$S;function B1(){}function H1(){}H1.resetWarningCache=B1;var GS=function(){function s(i,r,n,a,o,l){if(l!==qS){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}s.isRequired=s;function t(){return s}var e={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:t,element:s,elementType:s,instanceOf:t,node:s,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:H1,resetWarningCache:B1};return e.PropTypes=e,e};P1.exports=GS();var XS=P1.exports,Vt={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rm=Symbol.for("react.element"),sm=Symbol.for("react.portal"),Sc=Symbol.for("react.fragment"),kc=Symbol.for("react.strict_mode"),Tc=Symbol.for("react.profiler"),Ac=Symbol.for("react.provider"),Oc=Symbol.for("react.context"),KS=Symbol.for("react.server_context"),Dc=Symbol.for("react.forward_ref"),Lc=Symbol.for("react.suspense"),Rc=Symbol.for("react.suspense_list"),Ic=Symbol.for("react.memo"),_c=Symbol.for("react.lazy"),YS=Symbol.for("react.offscreen"),V1;V1=Symbol.for("react.module.reference");function ps(s){if(typeof s=="object"&&s!==null){var t=s.$$typeof;switch(t){case rm:switch(s=s.type,s){case Sc:case Tc:case kc:case Lc:case Rc:return s;default:switch(s=s&&s.$$typeof,s){case KS:case Oc:case Dc:case _c:case Ic:case Ac:return s;default:return t}}case sm:return t}}}Vt.ContextConsumer=Oc;Vt.ContextProvider=Ac;Vt.Element=rm;Vt.ForwardRef=Dc;Vt.Fragment=Sc;Vt.Lazy=_c;Vt.Memo=Ic;Vt.Portal=sm;Vt.Profiler=Tc;Vt.StrictMode=kc;Vt.Suspense=Lc;Vt.SuspenseList=Rc;Vt.isAsyncMode=function(){return!1};Vt.isConcurrentMode=function(){return!1};Vt.isContextConsumer=function(s){return ps(s)===Oc};Vt.isContextProvider=function(s){return ps(s)===Ac};Vt.isElement=function(s){return typeof s=="object"&&s!==null&&s.$$typeof===rm};Vt.isForwardRef=function(s){return ps(s)===Dc};Vt.isFragment=function(s){return ps(s)===Sc};Vt.isLazy=function(s){return ps(s)===_c};Vt.isMemo=function(s){return ps(s)===Ic};Vt.isPortal=function(s){return ps(s)===sm};Vt.isProfiler=function(s){return ps(s)===Tc};Vt.isStrictMode=function(s){return ps(s)===kc};Vt.isSuspense=function(s){return ps(s)===Lc};Vt.isSuspenseList=function(s){return ps(s)===Rc};Vt.isValidElementType=function(s){return typeof s=="string"||typeof s=="function"||s===Sc||s===Tc||s===kc||s===Lc||s===Rc||s===YS||typeof s=="object"&&s!==null&&(s.$$typeof===_c||s.$$typeof===Ic||s.$$typeof===Ac||s.$$typeof===Oc||s.$$typeof===Dc||s.$$typeof===V1||s.getModuleId!==void 0)};Vt.typeOf=ps;var Ar="top",cs="bottom",fs="right",Or="left",nm="auto",dh=[Ar,cs,fs,Or],wo="start",Gl="end",JS="clippingParents",W1="viewport",Jo="popper",QS="reference",b0=dh.reduce(function(s,t){return s.concat([t+"-"+wo,t+"-"+Gl])},[]),z1=[].concat(dh,[nm]).reduce(function(s,t){return s.concat([t,t+"-"+wo,t+"-"+Gl])},[]),ZS="beforeRead",ek="read",tk="afterRead",ik="beforeMain",rk="main",sk="afterMain",nk="beforeWrite",ak="write",ok="afterWrite",lk=[ZS,ek,tk,ik,rk,sk,nk,ak,ok];function Ns(s){return s?(s.nodeName||"").toLowerCase():null}function $r(s){if(s==null)return window;if(s.toString()!=="[object Window]"){var t=s.ownerDocument;return t&&t.defaultView||window}return s}function va(s){var t=$r(s).Element;return s instanceof t||s instanceof Element}function hs(s){var t=$r(s).HTMLElement;return s instanceof t||s instanceof HTMLElement}function am(s){if(typeof ShadowRoot>"u")return!1;var t=$r(s).ShadowRoot;return s instanceof t||s instanceof ShadowRoot}function hk(s){var t=s.state;Object.keys(t.elements).forEach(function(e){var i=t.styles[e]||{},r=t.attributes[e]||{},n=t.elements[e];!hs(n)||!Ns(n)||(Object.assign(n.style,i),Object.keys(r).forEach(function(a){var o=r[a];o===!1?n.removeAttribute(a):n.setAttribute(a,o===!0?"":o)}))})}function uk(s){var t=s.state,e={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,e.popper),t.styles=e,t.elements.arrow&&Object.assign(t.elements.arrow.style,e.arrow),function(){Object.keys(t.elements).forEach(function(i){var r=t.elements[i],n=t.attributes[i]||{},a=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:e[i]),o=a.reduce(function(l,h){return l[h]="",l},{});!hs(r)||!Ns(r)||(Object.assign(r.style,o),Object.keys(n).forEach(function(l){r.removeAttribute(l)}))})}}const ck={name:"applyStyles",enabled:!0,phase:"write",fn:hk,effect:uk,requires:["computeStyles"]};function _s(s){return s.split("-")[0]}var la=Math.max,Ju=Math.min,Eo=Math.round;function $d(){var s=navigator.userAgentData;return s!=null&&s.brands&&Array.isArray(s.brands)?s.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function j1(){return!/^((?!chrome|android).)*safari/i.test($d())}function So(s,t,e){t===void 0&&(t=!1),e===void 0&&(e=!1);var i=s.getBoundingClientRect(),r=1,n=1;t&&hs(s)&&(r=s.offsetWidth>0&&Eo(i.width)/s.offsetWidth||1,n=s.offsetHeight>0&&Eo(i.height)/s.offsetHeight||1);var a=va(s)?$r(s):window,o=a.visualViewport,l=!j1()&&e,h=(i.left+(l&&o?o.offsetLeft:0))/r,u=(i.top+(l&&o?o.offsetTop:0))/n,c=i.width/r,f=i.height/n;return{width:c,height:f,top:u,right:h+c,bottom:u+f,left:h,x:h,y:u}}function om(s){var t=So(s),e=s.offsetWidth,i=s.offsetHeight;return Math.abs(t.width-e)<=1&&(e=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:s.offsetLeft,y:s.offsetTop,width:e,height:i}}function U1(s,t){var e=t.getRootNode&&t.getRootNode();if(s.contains(t))return!0;if(e&&am(e)){var i=t;do{if(i&&s.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function sn(s){return $r(s).getComputedStyle(s)}function fk(s){return["table","td","th"].indexOf(Ns(s))>=0}function Fn(s){return((va(s)?s.ownerDocument:s.document)||window.document).documentElement}function Fc(s){return Ns(s)==="html"?s:s.assignedSlot||s.parentNode||(am(s)?s.host:null)||Fn(s)}function y0(s){return!hs(s)||sn(s).position==="fixed"?null:s.offsetParent}function dk(s){var t=/firefox/i.test($d()),e=/Trident/i.test($d());if(e&&hs(s)){var i=sn(s);if(i.position==="fixed")return null}var r=Fc(s);for(am(r)&&(r=r.host);hs(r)&&["html","body"].indexOf(Ns(r))<0;){var n=sn(r);if(n.transform!=="none"||n.perspective!=="none"||n.contain==="paint"||["transform","perspective"].indexOf(n.willChange)!==-1||t&&n.willChange==="filter"||t&&n.filter&&n.filter!=="none")return r;r=r.parentNode}return null}function ph(s){for(var t=$r(s),e=y0(s);e&&fk(e)&&sn(e).position==="static";)e=y0(e);return e&&(Ns(e)==="html"||Ns(e)==="body"&&sn(e).position==="static")?t:e||dk(s)||t}function lm(s){return["top","bottom"].indexOf(s)>=0?"x":"y"}function Rl(s,t,e){return la(s,Ju(t,e))}function pk(s,t,e){var i=Rl(s,t,e);return i>e?e:i}function $1(){return{top:0,right:0,bottom:0,left:0}}function q1(s){return Object.assign({},$1(),s)}function G1(s,t){return t.reduce(function(e,i){return e[i]=s,e},{})}var mk=function(t,e){return t=typeof t=="function"?t(Object.assign({},e.rects,{placement:e.placement})):t,q1(typeof t!="number"?t:G1(t,dh))};function vk(s){var t,e=s.state,i=s.name,r=s.options,n=e.elements.arrow,a=e.modifiersData.popperOffsets,o=_s(e.placement),l=lm(o),h=[Or,fs].indexOf(o)>=0,u=h?"height":"width";if(!(!n||!a)){var c=mk(r.padding,e),f=om(n),d=l==="y"?Ar:Or,p=l==="y"?cs:fs,v=e.rects.reference[u]+e.rects.reference[l]-a[l]-e.rects.popper[u],g=a[l]-e.rects.reference[l],b=ph(n),C=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,y=v/2-g/2,x=c[d],w=C-f[u]-c[p],S=C/2-f[u]/2+y,E=Rl(x,S,w),k=l;e.modifiersData[i]=(t={},t[k]=E,t.centerOffset=E-S,t)}}function gk(s){var t=s.state,e=s.options,i=e.element,r=i===void 0?"[data-popper-arrow]":i;r!=null&&(typeof r=="string"&&(r=t.elements.popper.querySelector(r),!r)||U1(t.elements.popper,r)&&(t.elements.arrow=r))}const bk={name:"arrow",enabled:!0,phase:"main",fn:vk,effect:gk,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ko(s){return s.split("-")[1]}var yk={top:"auto",right:"auto",bottom:"auto",left:"auto"};function xk(s,t){var e=s.x,i=s.y,r=t.devicePixelRatio||1;return{x:Eo(e*r)/r||0,y:Eo(i*r)/r||0}}function x0(s){var t,e=s.popper,i=s.popperRect,r=s.placement,n=s.variation,a=s.offsets,o=s.position,l=s.gpuAcceleration,h=s.adaptive,u=s.roundOffsets,c=s.isFixed,f=a.x,d=f===void 0?0:f,p=a.y,v=p===void 0?0:p,g=typeof u=="function"?u({x:d,y:v}):{x:d,y:v};d=g.x,v=g.y;var b=a.hasOwnProperty("x"),C=a.hasOwnProperty("y"),y=Or,x=Ar,w=window;if(h){var S=ph(e),E="clientHeight",k="clientWidth";if(S===$r(e)&&(S=Fn(e),sn(S).position!=="static"&&o==="absolute"&&(E="scrollHeight",k="scrollWidth")),S=S,r===Ar||(r===Or||r===fs)&&n===Gl){x=cs;var A=c&&S===w&&w.visualViewport?w.visualViewport.height:S[E];v-=A-i.height,v*=l?1:-1}if(r===Or||(r===Ar||r===cs)&&n===Gl){y=fs;var z=c&&S===w&&w.visualViewport?w.visualViewport.width:S[k];d-=z-i.width,d*=l?1:-1}}var D=Object.assign({position:o},h&&yk),T=u===!0?xk({x:d,y:v},$r(e)):{x:d,y:v};if(d=T.x,v=T.y,l){var M;return Object.assign({},D,(M={},M[x]=C?"0":"",M[y]=b?"0":"",M.transform=(w.devicePixelRatio||1)<=1?"translate("+d+"px, "+v+"px)":"translate3d("+d+"px, "+v+"px, 0)",M))}return Object.assign({},D,(t={},t[x]=C?v+"px":"",t[y]=b?d+"px":"",t.transform="",t))}function Ck(s){var t=s.state,e=s.options,i=e.gpuAcceleration,r=i===void 0?!0:i,n=e.adaptive,a=n===void 0?!0:n,o=e.roundOffsets,l=o===void 0?!0:o,h={placement:_s(t.placement),variation:ko(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,x0(Object.assign({},h,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:l})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,x0(Object.assign({},h,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const wk={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Ck,data:{}};var Yh={passive:!0};function Ek(s){var t=s.state,e=s.instance,i=s.options,r=i.scroll,n=r===void 0?!0:r,a=i.resize,o=a===void 0?!0:a,l=$r(t.elements.popper),h=[].concat(t.scrollParents.reference,t.scrollParents.popper);return n&&h.forEach(function(u){u.addEventListener("scroll",e.update,Yh)}),o&&l.addEventListener("resize",e.update,Yh),function(){n&&h.forEach(function(u){u.removeEventListener("scroll",e.update,Yh)}),o&&l.removeEventListener("resize",e.update,Yh)}}const Sk={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Ek,data:{}};var kk={left:"right",right:"left",bottom:"top",top:"bottom"};function Wu(s){return s.replace(/left|right|bottom|top/g,function(t){return kk[t]})}var Tk={start:"end",end:"start"};function C0(s){return s.replace(/start|end/g,function(t){return Tk[t]})}function hm(s){var t=$r(s),e=t.pageXOffset,i=t.pageYOffset;return{scrollLeft:e,scrollTop:i}}function um(s){return So(Fn(s)).left+hm(s).scrollLeft}function Ak(s,t){var e=$r(s),i=Fn(s),r=e.visualViewport,n=i.clientWidth,a=i.clientHeight,o=0,l=0;if(r){n=r.width,a=r.height;var h=j1();(h||!h&&t==="fixed")&&(o=r.offsetLeft,l=r.offsetTop)}return{width:n,height:a,x:o+um(s),y:l}}function Ok(s){var t,e=Fn(s),i=hm(s),r=(t=s.ownerDocument)==null?void 0:t.body,n=la(e.scrollWidth,e.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=la(e.scrollHeight,e.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),o=-i.scrollLeft+um(s),l=-i.scrollTop;return sn(r||e).direction==="rtl"&&(o+=la(e.clientWidth,r?r.clientWidth:0)-n),{width:n,height:a,x:o,y:l}}function cm(s){var t=sn(s),e=t.overflow,i=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(e+r+i)}function X1(s){return["html","body","#document"].indexOf(Ns(s))>=0?s.ownerDocument.body:hs(s)&&cm(s)?s:X1(Fc(s))}function Il(s,t){var e;t===void 0&&(t=[]);var i=X1(s),r=i===((e=s.ownerDocument)==null?void 0:e.body),n=$r(i),a=r?[n].concat(n.visualViewport||[],cm(i)?i:[]):i,o=t.concat(a);return r?o:o.concat(Il(Fc(a)))}function qd(s){return Object.assign({},s,{left:s.x,top:s.y,right:s.x+s.width,bottom:s.y+s.height})}function Dk(s,t){var e=So(s,!1,t==="fixed");return e.top=e.top+s.clientTop,e.left=e.left+s.clientLeft,e.bottom=e.top+s.clientHeight,e.right=e.left+s.clientWidth,e.width=s.clientWidth,e.height=s.clientHeight,e.x=e.left,e.y=e.top,e}function w0(s,t,e){return t===W1?qd(Ak(s,e)):va(t)?Dk(t,e):qd(Ok(Fn(s)))}function Lk(s){var t=Il(Fc(s)),e=["absolute","fixed"].indexOf(sn(s).position)>=0,i=e&&hs(s)?ph(s):s;return va(i)?t.filter(function(r){return va(r)&&U1(r,i)&&Ns(r)!=="body"}):[]}function Rk(s,t,e,i){var r=t==="clippingParents"?Lk(s):[].concat(t),n=[].concat(r,[e]),a=n[0],o=n.reduce(function(l,h){var u=w0(s,h,i);return l.top=la(u.top,l.top),l.right=Ju(u.right,l.right),l.bottom=Ju(u.bottom,l.bottom),l.left=la(u.left,l.left),l},w0(s,a,i));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function K1(s){var t=s.reference,e=s.element,i=s.placement,r=i?_s(i):null,n=i?ko(i):null,a=t.x+t.width/2-e.width/2,o=t.y+t.height/2-e.height/2,l;switch(r){case Ar:l={x:a,y:t.y-e.height};break;case cs:l={x:a,y:t.y+t.height};break;case fs:l={x:t.x+t.width,y:o};break;case Or:l={x:t.x-e.width,y:o};break;default:l={x:t.x,y:t.y}}var h=r?lm(r):null;if(h!=null){var u=h==="y"?"height":"width";switch(n){case wo:l[h]=l[h]-(t[u]/2-e[u]/2);break;case Gl:l[h]=l[h]+(t[u]/2-e[u]/2);break}}return l}function Xl(s,t){t===void 0&&(t={});var e=t,i=e.placement,r=i===void 0?s.placement:i,n=e.strategy,a=n===void 0?s.strategy:n,o=e.boundary,l=o===void 0?JS:o,h=e.rootBoundary,u=h===void 0?W1:h,c=e.elementContext,f=c===void 0?Jo:c,d=e.altBoundary,p=d===void 0?!1:d,v=e.padding,g=v===void 0?0:v,b=q1(typeof g!="number"?g:G1(g,dh)),C=f===Jo?QS:Jo,y=s.rects.popper,x=s.elements[p?C:f],w=Rk(va(x)?x:x.contextElement||Fn(s.elements.popper),l,u,a),S=So(s.elements.reference),E=K1({reference:S,element:y,strategy:"absolute",placement:r}),k=qd(Object.assign({},y,E)),A=f===Jo?k:S,z={top:w.top-A.top+b.top,bottom:A.bottom-w.bottom+b.bottom,left:w.left-A.left+b.left,right:A.right-w.right+b.right},D=s.modifiersData.offset;if(f===Jo&&D){var T=D[r];Object.keys(z).forEach(function(M){var K=[fs,cs].indexOf(M)>=0?1:-1,te=[Ar,cs].indexOf(M)>=0?"y":"x";z[M]+=T[te]*K})}return z}function Ik(s,t){t===void 0&&(t={});var e=t,i=e.placement,r=e.boundary,n=e.rootBoundary,a=e.padding,o=e.flipVariations,l=e.allowedAutoPlacements,h=l===void 0?z1:l,u=ko(i),c=u?o?b0:b0.filter(function(p){return ko(p)===u}):dh,f=c.filter(function(p){return h.indexOf(p)>=0});f.length===0&&(f=c);var d=f.reduce(function(p,v){return p[v]=Xl(s,{placement:v,boundary:r,rootBoundary:n,padding:a})[_s(v)],p},{});return Object.keys(d).sort(function(p,v){return d[p]-d[v]})}function _k(s){if(_s(s)===nm)return[];var t=Wu(s);return[C0(s),t,C0(t)]}function Fk(s){var t=s.state,e=s.options,i=s.name;if(!t.modifiersData[i]._skip){for(var r=e.mainAxis,n=r===void 0?!0:r,a=e.altAxis,o=a===void 0?!0:a,l=e.fallbackPlacements,h=e.padding,u=e.boundary,c=e.rootBoundary,f=e.altBoundary,d=e.flipVariations,p=d===void 0?!0:d,v=e.allowedAutoPlacements,g=t.options.placement,b=_s(g),C=b===g,y=l||(C||!p?[Wu(g)]:_k(g)),x=[g].concat(y).reduce(function(L,_){return L.concat(_s(_)===nm?Ik(t,{placement:_,boundary:u,rootBoundary:c,padding:h,flipVariations:p,allowedAutoPlacements:v}):_)},[]),w=t.rects.reference,S=t.rects.popper,E=new Map,k=!0,A=x[0],z=0;z<x.length;z++){var D=x[z],T=_s(D),M=ko(D)===wo,K=[Ar,cs].indexOf(T)>=0,te=K?"width":"height",ee=Xl(t,{placement:D,boundary:u,rootBoundary:c,altBoundary:f,padding:h}),J=K?M?fs:Or:M?cs:Ar;w[te]>S[te]&&(J=Wu(J));var re=Wu(J),j=[];if(n&&j.push(ee[T]<=0),o&&j.push(ee[J]<=0,ee[re]<=0),j.every(function(L){return L})){A=D,k=!1;break}E.set(D,j)}if(k)for(var de=p?3:1,we=function(_){var U=x.find(function(se){var ae=E.get(se);if(ae)return ae.slice(0,_).every(function(oe){return oe})});if(U)return A=U,"break"},N=de;N>0;N--){var H=we(N);if(H==="break")break}t.placement!==A&&(t.modifiersData[i]._skip=!0,t.placement=A,t.reset=!0)}}const Nk={name:"flip",enabled:!0,phase:"main",fn:Fk,requiresIfExists:["offset"],data:{_skip:!1}};function E0(s,t,e){return e===void 0&&(e={x:0,y:0}),{top:s.top-t.height-e.y,right:s.right-t.width+e.x,bottom:s.bottom-t.height+e.y,left:s.left-t.width-e.x}}function S0(s){return[Ar,fs,cs,Or].some(function(t){return s[t]>=0})}function Mk(s){var t=s.state,e=s.name,i=t.rects.reference,r=t.rects.popper,n=t.modifiersData.preventOverflow,a=Xl(t,{elementContext:"reference"}),o=Xl(t,{altBoundary:!0}),l=E0(a,i),h=E0(o,r,n),u=S0(l),c=S0(h);t.modifiersData[e]={referenceClippingOffsets:l,popperEscapeOffsets:h,isReferenceHidden:u,hasPopperEscaped:c},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":c})}const Pk={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Mk};function Bk(s,t,e){var i=_s(s),r=[Or,Ar].indexOf(i)>=0?-1:1,n=typeof e=="function"?e(Object.assign({},t,{placement:s})):e,a=n[0],o=n[1];return a=a||0,o=(o||0)*r,[Or,fs].indexOf(i)>=0?{x:o,y:a}:{x:a,y:o}}function Hk(s){var t=s.state,e=s.options,i=s.name,r=e.offset,n=r===void 0?[0,0]:r,a=z1.reduce(function(u,c){return u[c]=Bk(c,t.rects,n),u},{}),o=a[t.placement],l=o.x,h=o.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=h),t.modifiersData[i]=a}const Vk={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Hk};function Wk(s){var t=s.state,e=s.name;t.modifiersData[e]=K1({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const zk={name:"popperOffsets",enabled:!0,phase:"read",fn:Wk,data:{}};function jk(s){return s==="x"?"y":"x"}function Uk(s){var t=s.state,e=s.options,i=s.name,r=e.mainAxis,n=r===void 0?!0:r,a=e.altAxis,o=a===void 0?!1:a,l=e.boundary,h=e.rootBoundary,u=e.altBoundary,c=e.padding,f=e.tether,d=f===void 0?!0:f,p=e.tetherOffset,v=p===void 0?0:p,g=Xl(t,{boundary:l,rootBoundary:h,padding:c,altBoundary:u}),b=_s(t.placement),C=ko(t.placement),y=!C,x=lm(b),w=jk(x),S=t.modifiersData.popperOffsets,E=t.rects.reference,k=t.rects.popper,A=typeof v=="function"?v(Object.assign({},t.rects,{placement:t.placement})):v,z=typeof A=="number"?{mainAxis:A,altAxis:A}:Object.assign({mainAxis:0,altAxis:0},A),D=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(S){if(n){var M,K=x==="y"?Ar:Or,te=x==="y"?cs:fs,ee=x==="y"?"height":"width",J=S[x],re=J+g[K],j=J-g[te],de=d?-k[ee]/2:0,we=C===wo?E[ee]:k[ee],N=C===wo?-k[ee]:-E[ee],H=t.elements.arrow,L=d&&H?om(H):{width:0,height:0},_=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:$1(),U=_[K],se=_[te],ae=Rl(0,E[ee],L[ee]),oe=y?E[ee]/2-de-ae-U-z.mainAxis:we-ae-U-z.mainAxis,me=y?-E[ee]/2+de+ae+se+z.mainAxis:N+ae+se+z.mainAxis,Re=t.elements.arrow&&ph(t.elements.arrow),V=Re?x==="y"?Re.clientTop||0:Re.clientLeft||0:0,$e=(M=D==null?void 0:D[x])!=null?M:0,Me=J+oe-$e-V,Ze=J+me-$e,Je=Rl(d?Ju(re,Me):re,J,d?la(j,Ze):j);S[x]=Je,T[x]=Je-J}if(o){var Le,Ct=x==="x"?Ar:Or,si=x==="x"?cs:fs,Wt=S[w],li=w==="y"?"height":"width",ar=Wt+g[Ct],xi=Wt-g[si],Tt=[Ar,Or].indexOf(b)!==-1,Ni=(Le=D==null?void 0:D[w])!=null?Le:0,Di=Tt?ar:Wt-E[li]-k[li]-Ni+z.altAxis,F=Tt?Wt+E[li]+k[li]-Ni-z.altAxis:xi,Q=d&&Tt?pk(Di,Wt,F):Rl(d?Di:ar,Wt,d?F:xi);S[w]=Q,T[w]=Q-Wt}t.modifiersData[i]=T}}const $k={name:"preventOverflow",enabled:!0,phase:"main",fn:Uk,requiresIfExists:["offset"]};function qk(s){return{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}}function Gk(s){return s===$r(s)||!hs(s)?hm(s):qk(s)}function Xk(s){var t=s.getBoundingClientRect(),e=Eo(t.width)/s.offsetWidth||1,i=Eo(t.height)/s.offsetHeight||1;return e!==1||i!==1}function Kk(s,t,e){e===void 0&&(e=!1);var i=hs(t),r=hs(t)&&Xk(t),n=Fn(t),a=So(s,r,e),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!e)&&((Ns(t)!=="body"||cm(n))&&(o=Gk(t)),hs(t)?(l=So(t,!0),l.x+=t.clientLeft,l.y+=t.clientTop):n&&(l.x=um(n))),{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}function Yk(s){var t=new Map,e=new Set,i=[];s.forEach(function(n){t.set(n.name,n)});function r(n){e.add(n.name);var a=[].concat(n.requires||[],n.requiresIfExists||[]);a.forEach(function(o){if(!e.has(o)){var l=t.get(o);l&&r(l)}}),i.push(n)}return s.forEach(function(n){e.has(n.name)||r(n)}),i}function Jk(s){var t=Yk(s);return lk.reduce(function(e,i){return e.concat(t.filter(function(r){return r.phase===i}))},[])}function Qk(s){var t;return function(){return t||(t=new Promise(function(e){Promise.resolve().then(function(){t=void 0,e(s())})})),t}}function Zk(s){var t=s.reduce(function(e,i){var r=e[i.name];return e[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,e},{});return Object.keys(t).map(function(e){return t[e]})}var k0={placement:"bottom",modifiers:[],strategy:"absolute"};function T0(){for(var s=arguments.length,t=new Array(s),e=0;e<s;e++)t[e]=arguments[e];return!t.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function eT(s){s===void 0&&(s={});var t=s,e=t.defaultModifiers,i=e===void 0?[]:e,r=t.defaultOptions,n=r===void 0?k0:r;return function(o,l,h){h===void 0&&(h=n);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},k0,n),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},c=[],f=!1,d={state:u,setOptions:function(b){var C=typeof b=="function"?b(u.options):b;v(),u.options=Object.assign({},n,u.options,C),u.scrollParents={reference:va(o)?Il(o):o.contextElement?Il(o.contextElement):[],popper:Il(l)};var y=Jk(Zk([].concat(i,u.options.modifiers)));return u.orderedModifiers=y.filter(function(x){return x.enabled}),p(),d.update()},forceUpdate:function(){if(!f){var b=u.elements,C=b.reference,y=b.popper;if(T0(C,y)){u.rects={reference:Kk(C,ph(y),u.options.strategy==="fixed"),popper:om(y)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(z){return u.modifiersData[z.name]=Object.assign({},z.data)});for(var x=0;x<u.orderedModifiers.length;x++){if(u.reset===!0){u.reset=!1,x=-1;continue}var w=u.orderedModifiers[x],S=w.fn,E=w.options,k=E===void 0?{}:E,A=w.name;typeof S=="function"&&(u=S({state:u,options:k,name:A,instance:d})||u)}}}},update:Qk(function(){return new Promise(function(g){d.forceUpdate(),g(u)})}),destroy:function(){v(),f=!0}};if(!T0(o,l))return d;d.setOptions(h).then(function(g){!f&&h.onFirstUpdate&&h.onFirstUpdate(g)});function p(){u.orderedModifiers.forEach(function(g){var b=g.name,C=g.options,y=C===void 0?{}:C,x=g.effect;if(typeof x=="function"){var w=x({state:u,name:b,instance:d,options:y}),S=function(){};c.push(w||S)}})}function v(){c.forEach(function(g){return g()}),c=[]}return d}}var tT=[Sk,zk,wk,ck,Vk,Nk,$k,bk,Pk],iT=eT({defaultModifiers:tT});function rT(s){return Io("MuiPopper",s)}Ro("MuiPopper",["root"]);function sT(s,t){if(t==="ltr")return s;switch(s){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return s}}function Gd(s){return typeof s=="function"?s():s}function nT(s){return s.nodeType!==void 0}const aT=s=>{const{classes:t}=s;return _o({root:["root"]},rT,t)},oT={},lT=_e.forwardRef(function(t,e){var te;const{anchorEl:i,children:r,direction:n,disablePortal:a,modifiers:o,open:l,placement:h,popperOptions:u,popperRef:c,slotProps:f={},slots:d={},TransitionProps:p,ownerState:v,...g}=t,b=_e.useRef(null),C=Co(b,e),y=_e.useRef(null),x=Co(y,c),w=_e.useRef(x);ql(()=>{w.current=x},[x]),_e.useImperativeHandle(c,()=>y.current,[]);const S=sT(h,n),[E,k]=_e.useState(S),[A,z]=_e.useState(Gd(i));_e.useEffect(()=>{y.current&&y.current.forceUpdate()}),_e.useEffect(()=>{i&&z(Gd(i))},[i]),ql(()=>{if(!A||!l)return;const ee=j=>{k(j.placement)};let J=[{name:"preventOverflow",options:{altBoundary:a}},{name:"flip",options:{altBoundary:a}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:j})=>{ee(j)}}];o!=null&&(J=J.concat(o)),u&&u.modifiers!=null&&(J=J.concat(u.modifiers));const re=iT(A,b.current,{placement:S,...u,modifiers:J});return w.current(re),()=>{re.destroy(),w.current(null)}},[A,a,o,l,u,S]);const D={placement:E};p!==null&&(D.TransitionProps=p);const T=aT(t),M=(te=d.root)!=null?te:"div",K=bS({elementType:M,externalSlotProps:f.root,externalForwardedProps:g,additionalProps:{role:"tooltip",ref:C},ownerState:t,className:T.root});return Ae.jsx(M,{...K,children:typeof r=="function"?r(D):r})}),hT=_e.forwardRef(function(t,e){const{anchorEl:i,children:r,container:n,direction:a="ltr",disablePortal:o=!1,keepMounted:l=!1,modifiers:h,open:u,placement:c="bottom",popperOptions:f=oT,popperRef:d,style:p,transition:v=!1,slotProps:g={},slots:b={},...C}=t,[y,x]=_e.useState(!0),w=()=>{x(!1)},S=()=>{x(!0)};if(!l&&!u&&(!v||y))return null;let E;if(n)E=n;else if(i){const z=Gd(i);E=z&&nT(z)?h0(z).body:h0(null).body}const k=!u&&l&&(!v||y)?"none":void 0,A=v?{in:u,onEnter:w,onExited:S}:void 0;return Ae.jsx(gS,{disablePortal:o,container:E,children:Ae.jsx(lT,{anchorEl:i,direction:a,disablePortal:o,modifiers:h,ref:e,open:v?!y:u,placement:c,popperOptions:f,popperRef:d,slotProps:g,slots:b,...C,style:{position:"fixed",top:0,left:0,display:k,...p},TransitionProps:A,children:r})})}),uT=ds(hT,{name:"MuiPopper",slot:"Root",overridesResolver:(s,t)=>t.root})({}),Y1=_e.forwardRef(function(t,e){var E;const i=O1(),r=fh({props:t,name:"MuiPopper"}),{anchorEl:n,component:a,components:o,componentsProps:l,container:h,disablePortal:u,keepMounted:c,modifiers:f,open:d,placement:p,popperOptions:v,popperRef:g,transition:b,slots:C,slotProps:y,...x}=r,w=(E=C==null?void 0:C.root)!=null?E:o==null?void 0:o.Root,S={anchorEl:n,container:h,disablePortal:u,keepMounted:c,modifiers:f,open:d,placement:p,popperOptions:v,popperRef:g,transition:b,...x};return Ae.jsx(uT,{as:a,direction:i?"rtl":"ltr",slots:{root:w},slotProps:y!=null?y:l,...S,ref:e})});function Jh(s){return parseInt(s,10)||0}const cT={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function fT(s){return s==null||Object.keys(s).length===0||s.outerHeightStyle===0&&!s.overflowing}const dT=_e.forwardRef(function(t,e){const{onChange:i,maxRows:r,minRows:n=1,style:a,value:o,...l}=t,{current:h}=_e.useRef(o!=null),u=_e.useRef(null),c=Co(e,u),f=_e.useRef(null),d=_e.useRef(null),p=_e.useCallback(()=>{const b=u.current,y=u0(b).getComputedStyle(b);if(y.width==="0px")return{outerHeightStyle:0,overflowing:!1};const x=d.current;x.style.width=y.width,x.value=b.value||t.placeholder||"x",x.value.slice(-1)==="\n"&&(x.value+=" ");const w=y.boxSizing,S=Jh(y.paddingBottom)+Jh(y.paddingTop),E=Jh(y.borderBottomWidth)+Jh(y.borderTopWidth),k=x.scrollHeight;x.value="x";const A=x.scrollHeight;let z=k;n&&(z=Math.max(Number(n)*A,z)),r&&(z=Math.min(Number(r)*A,z)),z=Math.max(z,A);const D=z+(w==="border-box"?S+E:0),T=Math.abs(z-k)<=1;return{outerHeightStyle:D,overflowing:T}},[r,n,t.placeholder]),v=_e.useCallback(()=>{const b=p();if(fT(b))return;const C=b.outerHeightStyle,y=u.current;f.current!==C&&(f.current=C,y.style.height="".concat(C,"px")),y.style.overflow=b.overflowing?"hidden":""},[p]);ql(()=>{const b=()=>{v()};let C;const y=D1(b),x=u.current,w=u0(x);w.addEventListener("resize",y);let S;return typeof ResizeObserver<"u"&&(S=new ResizeObserver(b),S.observe(x)),()=>{y.clear(),cancelAnimationFrame(C),w.removeEventListener("resize",y),S&&S.disconnect()}},[p,v]),ql(()=>{v()});const g=b=>{h||v(),i&&i(b)};return Ae.jsxs(_e.Fragment,{children:[Ae.jsx("textarea",{value:o,onChange:g,ref:c,rows:n,style:a,...l}),Ae.jsx("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:d,tabIndex:-1,style:{...cT.shadow,...a,paddingTop:0,paddingBottom:0}})]})});function pT({props:s,states:t,muiFormControl:e}){return t.reduce((i,r)=>(i[r]=s[r],e&&typeof s[r]>"u"&&(i[r]=e[r]),i),{})}function A0(s){return s!=null&&!(Array.isArray(s)&&s.length===0)}function mT(s,t=!1){return s&&(A0(s.value)&&s.value!==""||t&&A0(s.defaultValue)&&s.defaultValue!=="")}function vT(s){return Io("MuiInputBase",s)}const Xd=Ro("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var O0;const gT=(s,t)=>{const{ownerState:e}=s;return[t.root,e.formControl&&t.formControl,e.startAdornment&&t.adornedStart,e.endAdornment&&t.adornedEnd,e.error&&t.error,e.size==="small"&&t.sizeSmall,e.multiline&&t.multiline,e.color&&t["color".concat(rn(e.color))],e.fullWidth&&t.fullWidth,e.hiddenLabel&&t.hiddenLabel]},bT=(s,t)=>{const{ownerState:e}=s;return[t.input,e.size==="small"&&t.inputSizeSmall,e.multiline&&t.inputMultiline,e.type==="search"&&t.inputTypeSearch,e.startAdornment&&t.inputAdornedStart,e.endAdornment&&t.inputAdornedEnd,e.hiddenLabel&&t.inputHiddenLabel]},yT=s=>{const{classes:t,color:e,disabled:i,error:r,endAdornment:n,focused:a,formControl:o,fullWidth:l,hiddenLabel:h,multiline:u,readOnly:c,size:f,startAdornment:d,type:p}=s,v={root:["root","color".concat(rn(e)),i&&"disabled",r&&"error",l&&"fullWidth",a&&"focused",o&&"formControl",f&&f!=="medium"&&"size".concat(rn(f)),u&&"multiline",d&&"adornedStart",n&&"adornedEnd",h&&"hiddenLabel",c&&"readOnly"],input:["input",i&&"disabled",p==="search"&&"inputTypeSearch",u&&"inputMultiline",f==="small"&&"inputSizeSmall",h&&"inputHiddenLabel",d&&"inputAdornedStart",n&&"inputAdornedEnd",c&&"readOnly"]};return _o(v,vT,t)},xT=ds("div",{name:"MuiInputBase",slot:"Root",overridesResolver:gT})(Ta(({theme:s})=>({...s.typography.body1,color:(s.vars||s).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",["&.".concat(Xd.disabled)]:{color:(s.vars||s).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:t})=>t.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:t,size:e})=>t.multiline&&e==="small",style:{paddingTop:1}},{props:({ownerState:t})=>t.fullWidth,style:{width:"100%"}}]}))),CT=ds("input",{name:"MuiInputBase",slot:"Input",overridesResolver:bT})(Ta(({theme:s})=>{const t=s.palette.mode==="light",e={color:"currentColor",...s.vars?{opacity:s.vars.opacity.inputPlaceholder}:{opacity:t?.42:.5},transition:s.transitions.create("opacity",{duration:s.transitions.duration.shorter})},i={opacity:"0 !important"},r=s.vars?{opacity:s.vars.opacity.inputPlaceholder}:{opacity:t?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":e,"&::-moz-placeholder":e,"&::-ms-input-placeholder":e,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},["label[data-shrink=false] + .".concat(Xd.formControl," &")]:{"&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&::-ms-input-placeholder":i,"&:focus::-webkit-input-placeholder":r,"&:focus::-moz-placeholder":r,"&:focus::-ms-input-placeholder":r},["&.".concat(Xd.disabled)]:{opacity:1,WebkitTextFillColor:(s.vars||s).palette.text.disabled},variants:[{props:({ownerState:n})=>!n.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:n})=>n.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),D0=CS({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),wT=_e.forwardRef(function(t,e){var Ee;const i=fh({props:t,name:"MuiInputBase"}),{"aria-describedby":r,autoComplete:n,autoFocus:a,className:o,color:l,components:h={},componentsProps:u={},defaultValue:c,disabled:f,disableInjectingGlobalStyles:d,endAdornment:p,error:v,fullWidth:g=!1,id:b,inputComponent:C="input",inputProps:y={},inputRef:x,margin:w,maxRows:S,minRows:E,multiline:k=!1,name:A,onBlur:z,onChange:D,onClick:T,onFocus:M,onKeyDown:K,onKeyUp:te,placeholder:ee,readOnly:J,renderSuffix:re,rows:j,size:de,slotProps:we={},slots:N={},startAdornment:H,type:L="text",value:_,...U}=i,se=y.value!=null?y.value:_,{current:ae}=_e.useRef(se!=null),oe=_e.useRef(),me=_e.useCallback(ke=>{},[]),Re=Co(oe,x,y.ref,me),[V,$e]=_e.useState(!1),Me=yS(),Ze=pT({props:i,muiFormControl:Me,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Ze.focused=Me?Me.focused:V,_e.useEffect(()=>{!Me&&f&&V&&($e(!1),z&&z())},[Me,f,V,z]);const Je=Me&&Me.onFilled,Le=Me&&Me.onEmpty,Ct=_e.useCallback(ke=>{mT(ke)?Je&&Je():Le&&Le()},[Je,Le]);ql(()=>{ae&&Ct({value:se})},[se,Ct,ae]);const si=ke=>{M&&M(ke),y.onFocus&&y.onFocus(ke),Me&&Me.onFocus?Me.onFocus(ke):$e(!0)},Wt=ke=>{z&&z(ke),y.onBlur&&y.onBlur(ke),Me&&Me.onBlur?Me.onBlur(ke):$e(!1)},li=(ke,...et)=>{if(!ae){const At=ke.target||oe.current;if(At==null)throw new Error(wS(1));Ct({value:At.value})}y.onChange&&y.onChange(ke,...et),D&&D(ke,...et)};_e.useEffect(()=>{Ct(oe.current)},[]);const ar=ke=>{oe.current&&ke.currentTarget===ke.target&&oe.current.focus(),T&&T(ke)};let xi=C,Tt=y;k&&xi==="input"&&(j?Tt={type:void 0,minRows:j,maxRows:j,...Tt}:Tt={type:void 0,maxRows:S,minRows:E,...Tt},xi=dT);const Ni=ke=>{Ct(ke.animationName==="mui-auto-fill-cancel"?oe.current:{value:"x"})};_e.useEffect(()=>{Me&&Me.setAdornedStart(!!H)},[Me,H]);const Di={...i,color:Ze.color||"primary",disabled:Ze.disabled,endAdornment:p,error:Ze.error,focused:Ze.focused,formControl:Me,fullWidth:g,hiddenLabel:Ze.hiddenLabel,multiline:k,size:Ze.size,startAdornment:H,type:L},F=yT(Di),Q=N.root||h.Root||xT,pe=we.root||u.root||{},ge=N.input||h.Input||CT;return Tt={...Tt,...(Ee=we.input)!=null?Ee:u.input},Ae.jsxs(_e.Fragment,{children:[!d&&typeof D0=="function"&&(O0||(O0=Ae.jsx(D0,{}))),Ae.jsxs(Q,{...pe,ref:e,onClick:ar,...U,...!c0(Q)&&{ownerState:{...Di,...pe.ownerState}},className:Ys(F.root,pe.className,o,J&&"MuiInputBase-readOnly"),children:[H,Ae.jsx(xS.Provider,{value:null,children:Ae.jsx(ge,{"aria-invalid":Ze.error,"aria-describedby":r,autoComplete:n,autoFocus:a,defaultValue:c,disabled:Ze.disabled,id:b,onAnimationStart:Ni,name:A,placeholder:ee,readOnly:J,required:Ze.required,rows:j,value:se,onKeyDown:K,onKeyUp:te,type:L,...Tt,...!c0(ge)&&{as:xi,ownerState:{...Di,...Tt.ownerState}},ref:Re,className:Ys(F.input,Tt.className,J&&"MuiInputBase-readOnly"),onBlur:Wt,onChange:li,onFocus:si})}),p,re?re({...Ze,startAdornment:H}):null]})]})}),L0=_e.createContext();function ET(s){return Io("MuiGrid",s)}const ST=[0,1,2,3,4,5,6,7,8,9,10],kT=["column-reverse","column","row-reverse","row"],TT=["nowrap","wrap-reverse","wrap"],Qo=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],Kl=Ro("MuiGrid",["root","container","item","zeroMinWidth",...ST.map(s=>"spacing-xs-".concat(s)),...kT.map(s=>"direction-xs-".concat(s)),...TT.map(s=>"wrap-xs-".concat(s)),...Qo.map(s=>"grid-xs-".concat(s)),...Qo.map(s=>"grid-sm-".concat(s)),...Qo.map(s=>"grid-md-".concat(s)),...Qo.map(s=>"grid-lg-".concat(s)),...Qo.map(s=>"grid-xl-".concat(s))]);function AT({theme:s,ownerState:t}){let e;return s.breakpoints.keys.reduce((i,r)=>{let n={};if(t[r]&&(e=t[r]),!e)return i;if(e===!0)n={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(e==="auto")n={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const a=Ec({values:t.columns,breakpoints:s.breakpoints.values}),o=typeof a=="object"?a[r]:a;if(o==null)return i;const l="".concat(Math.round(e/o*1e8)/1e6,"%");let h={};if(t.container&&t.item&&t.columnSpacing!==0){const u=s.spacing(t.columnSpacing);if(u!=="0px"){const c="calc(".concat(l," + ").concat(u,")");h={flexBasis:c,maxWidth:c}}}n={flexBasis:l,flexGrow:0,maxWidth:l,...h}}return s.breakpoints.values[r]===0?Object.assign(i,n):i[s.breakpoints.up(r)]=n,i},{})}function OT({theme:s,ownerState:t}){const e=Ec({values:t.direction,breakpoints:s.breakpoints.values});return tm({theme:s},e,i=>{const r={flexDirection:i};return i.startsWith("column")&&(r["& > .".concat(Kl.item)]={maxWidth:"none"}),r})}function J1({breakpoints:s,values:t}){let e="";Object.keys(t).forEach(r=>{e===""&&t[r]!==0&&(e=r)});const i=Object.keys(s).sort((r,n)=>s[r]-s[n]);return i.slice(0,i.indexOf(e))}function DT({theme:s,ownerState:t}){const{container:e,rowSpacing:i}=t;let r={};if(e&&i!==0){const n=Ec({values:i,breakpoints:s.breakpoints.values});let a;typeof n=="object"&&(a=J1({breakpoints:s.breakpoints.values,values:n})),r=tm({theme:s},n,(o,l)=>{const h=s.spacing(o);return h!=="0px"?{marginTop:s.spacing(-o),["& > .".concat(Kl.item)]:{paddingTop:h}}:a!=null&&a.includes(l)?{}:{marginTop:0,["& > .".concat(Kl.item)]:{paddingTop:0}}})}return r}function LT({theme:s,ownerState:t}){const{container:e,columnSpacing:i}=t;let r={};if(e&&i!==0){const n=Ec({values:i,breakpoints:s.breakpoints.values});let a;typeof n=="object"&&(a=J1({breakpoints:s.breakpoints.values,values:n})),r=tm({theme:s},n,(o,l)=>{const h=s.spacing(o);if(h!=="0px"){const u=s.spacing(-o);return{width:"calc(100% + ".concat(h,")"),marginLeft:u,["& > .".concat(Kl.item)]:{paddingLeft:h}}}return a!=null&&a.includes(l)?{}:{width:"100%",marginLeft:0,["& > .".concat(Kl.item)]:{paddingLeft:0}}})}return r}function RT(s,t,e={}){if(!s||s<=0)return[];if(typeof s=="string"&&!Number.isNaN(Number(s))||typeof s=="number")return[e["spacing-xs-".concat(String(s))]];const i=[];return t.forEach(r=>{const n=s[r];Number(n)>0&&i.push(e["spacing-".concat(r,"-").concat(String(n))])}),i}const IT=ds("div",{name:"MuiGrid",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:e}=s,{container:i,direction:r,item:n,spacing:a,wrap:o,zeroMinWidth:l,breakpoints:h}=e;let u=[];i&&(u=RT(a,h,t));const c=[];return h.forEach(f=>{const d=e[f];d&&c.push(t["grid-".concat(f,"-").concat(String(d))])}),[t.root,i&&t.container,n&&t.item,l&&t.zeroMinWidth,...u,r!=="row"&&t["direction-xs-".concat(String(r))],o!=="wrap"&&t["wrap-xs-".concat(String(o))],...c]}})(({ownerState:s})=>({boxSizing:"border-box",...s.container&&{display:"flex",flexWrap:"wrap",width:"100%"},...s.item&&{margin:0},...s.zeroMinWidth&&{minWidth:0},...s.wrap!=="wrap"&&{flexWrap:s.wrap}}),OT,DT,LT,AT);function _T(s,t){if(!s||s<=0)return[];if(typeof s=="string"&&!Number.isNaN(Number(s))||typeof s=="number")return["spacing-xs-".concat(String(s))];const e=[];return t.forEach(i=>{const r=s[i];if(Number(r)>0){const n="spacing-".concat(i,"-").concat(String(r));e.push(n)}}),e}const FT=s=>{const{classes:t,container:e,direction:i,item:r,spacing:n,wrap:a,zeroMinWidth:o,breakpoints:l}=s;let h=[];e&&(h=_T(n,l));const u=[];l.forEach(f=>{const d=s[f];d&&u.push("grid-".concat(f,"-").concat(String(d)))});const c={root:["root",e&&"container",r&&"item",o&&"zeroMinWidth",...h,i!=="row"&&"direction-xs-".concat(String(i)),a!=="wrap"&&"wrap-xs-".concat(String(a)),...u]};return _o(c,ET,t)},Qh=_e.forwardRef(function(t,e){const i=ES({props:t,name:"MuiGrid"}),{breakpoints:r}=em(),n=SS(i),{className:a,columns:o,columnSpacing:l,component:h="div",container:u=!1,direction:c="row",item:f=!1,rowSpacing:d,spacing:p=0,wrap:v="wrap",zeroMinWidth:g=!1,...b}=n,C=d||p,y=l||p,x=_e.useContext(L0),w=u?o||12:x,S={},E={...b};r.keys.forEach(z=>{b[z]!=null&&(S[z]=b[z],delete E[z])});const k={...n,columns:w,container:u,direction:c,item:f,rowSpacing:C,columnSpacing:y,wrap:v,zeroMinWidth:g,spacing:p,...S,breakpoints:r.keys},A=FT(k);return Ae.jsx(L0.Provider,{value:w,children:Ae.jsx(IT,{ownerState:k,className:Ys(A.root,a),as:h,ref:e,...E})})});function Kd(s){return"scale(".concat(s,", ").concat(s**2,")")}const NT={entering:{opacity:1,transform:Kd(1)},entered:{opacity:1,transform:"none"}},Ef=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Qu=_e.forwardRef(function(t,e){const{addEndListener:i,appear:r=!0,children:n,easing:a,in:o,onEnter:l,onEntered:h,onEntering:u,onExit:c,onExited:f,onExiting:d,style:p,timeout:v="auto",TransitionComponent:g=kS,...b}=t,C=wl(),y=_e.useRef(),x=em(),w=_e.useRef(null),S=Co(w,L1(n),e),E=te=>ee=>{if(te){const J=w.current;ee===void 0?te(J):te(J,ee)}},k=E(u),A=E((te,ee)=>{TS(te);const{duration:J,delay:re,easing:j}=f0({style:p,timeout:v,easing:a},{mode:"enter"});let de;v==="auto"?(de=x.transitions.getAutoHeightDuration(te.clientHeight),y.current=de):de=J,te.style.transition=[x.transitions.create("opacity",{duration:de,delay:re}),x.transitions.create("transform",{duration:Ef?de:de*.666,delay:re,easing:j})].join(","),l&&l(te,ee)}),z=E(h),D=E(d),T=E(te=>{const{duration:ee,delay:J,easing:re}=f0({style:p,timeout:v,easing:a},{mode:"exit"});let j;v==="auto"?(j=x.transitions.getAutoHeightDuration(te.clientHeight),y.current=j):j=ee,te.style.transition=[x.transitions.create("opacity",{duration:j,delay:J}),x.transitions.create("transform",{duration:Ef?j:j*.666,delay:Ef?J:J||j*.333,easing:re})].join(","),te.style.opacity=0,te.style.transform=Kd(.75),c&&c(te)}),M=E(f),K=te=>{v==="auto"&&C.start(y.current||0,te),i&&i(w.current,te)};return Ae.jsx(g,{appear:r,in:o,nodeRef:w,onEnter:A,onEntered:z,onEntering:k,onExit:T,onExited:M,onExiting:D,addEndListener:K,timeout:v==="auto"?null:v,...b,children:(te,ee)=>_e.cloneElement(n,{style:{opacity:0,transform:Kd(.75),visibility:te==="exited"&&!o?"hidden":void 0,...NT[te],...p,...n.props.style},ref:S,...ee})})});Qu&&(Qu.muiSupportAuto=!0);function MT(s){return Io("MuiTooltip",s)}const ui=Ro("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function PT(s){return Math.round(s*1e5)/1e5}const BT=s=>{const{classes:t,disableInteractive:e,arrow:i,touch:r,placement:n}=s,a={popper:["popper",!e&&"popperInteractive",i&&"popperArrow"],tooltip:["tooltip",i&&"tooltipArrow",r&&"touch","tooltipPlacement".concat(rn(n.split("-")[0]))],arrow:["arrow"]};return _o(a,MT,t)},HT=ds(Y1,{name:"MuiTooltip",slot:"Popper",overridesResolver:(s,t)=>{const{ownerState:e}=s;return[t.popper,!e.disableInteractive&&t.popperInteractive,e.arrow&&t.popperArrow,!e.open&&t.popperClose]}})(Ta(({theme:s})=>({zIndex:(s.vars||s).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:t})=>!t.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:t})=>!t,style:{pointerEvents:"none"}},{props:({ownerState:t})=>t.arrow,style:{['&[data-popper-placement*="bottom"] .'.concat(ui.arrow)]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},['&[data-popper-placement*="top"] .'.concat(ui.arrow)]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},['&[data-popper-placement*="right"] .'.concat(ui.arrow)]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},['&[data-popper-placement*="left"] .'.concat(ui.arrow)]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:t})=>t.arrow&&!t.isRtl,style:{['&[data-popper-placement*="right"] .'.concat(ui.arrow)]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!!t.isRtl,style:{['&[data-popper-placement*="right"] .'.concat(ui.arrow)]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!t.isRtl,style:{['&[data-popper-placement*="left"] .'.concat(ui.arrow)]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!!t.isRtl,style:{['&[data-popper-placement*="left"] .'.concat(ui.arrow)]:{left:0,marginLeft:"-0.71em"}}}]}))),VT=ds("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(s,t)=>{const{ownerState:e}=s;return[t.tooltip,e.touch&&t.touch,e.arrow&&t.tooltipArrow,t["tooltipPlacement".concat(rn(e.placement.split("-")[0]))]]}})(Ta(({theme:s})=>({backgroundColor:s.vars?s.vars.palette.Tooltip.bg:ns(s.palette.grey[700],.92),borderRadius:(s.vars||s).shape.borderRadius,color:(s.vars||s).palette.common.white,fontFamily:s.typography.fontFamily,padding:"4px 8px",fontSize:s.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:s.typography.fontWeightMedium,[".".concat(ui.popper,'[data-popper-placement*="left"] &')]:{transformOrigin:"right center"},[".".concat(ui.popper,'[data-popper-placement*="right"] &')]:{transformOrigin:"left center"},[".".concat(ui.popper,'[data-popper-placement*="top"] &')]:{transformOrigin:"center bottom",marginBottom:"14px"},[".".concat(ui.popper,'[data-popper-placement*="bottom"] &')]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:t})=>t.arrow,style:{position:"relative",margin:0}},{props:({ownerState:t})=>t.touch,style:{padding:"8px 16px",fontSize:s.typography.pxToRem(14),lineHeight:"".concat(PT(16/14),"em"),fontWeight:s.typography.fontWeightRegular}},{props:({ownerState:t})=>!t.isRtl,style:{[".".concat(ui.popper,'[data-popper-placement*="left"] &')]:{marginRight:"14px"},[".".concat(ui.popper,'[data-popper-placement*="right"] &')]:{marginLeft:"14px"}}},{props:({ownerState:t})=>!t.isRtl&&t.touch,style:{[".".concat(ui.popper,'[data-popper-placement*="left"] &')]:{marginRight:"24px"},[".".concat(ui.popper,'[data-popper-placement*="right"] &')]:{marginLeft:"24px"}}},{props:({ownerState:t})=>!!t.isRtl,style:{[".".concat(ui.popper,'[data-popper-placement*="left"] &')]:{marginLeft:"14px"},[".".concat(ui.popper,'[data-popper-placement*="right"] &')]:{marginRight:"14px"}}},{props:({ownerState:t})=>!!t.isRtl&&t.touch,style:{[".".concat(ui.popper,'[data-popper-placement*="left"] &')]:{marginLeft:"24px"},[".".concat(ui.popper,'[data-popper-placement*="right"] &')]:{marginRight:"24px"}}},{props:({ownerState:t})=>t.touch,style:{[".".concat(ui.popper,'[data-popper-placement*="top"] &')]:{marginBottom:"24px"}}},{props:({ownerState:t})=>t.touch,style:{[".".concat(ui.popper,'[data-popper-placement*="bottom"] &')]:{marginTop:"24px"}}}]}))),WT=ds("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(s,t)=>t.arrow})(Ta(({theme:s})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:s.vars?s.vars.palette.Tooltip.bg:ns(s.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let Zh=!1;const R0=new DS;let Zo={x:0,y:0};function eu(s,t){return(e,...i)=>{t&&t(e,...i),s(e,...i)}}const I0=_e.forwardRef(function(t,e){var Mh,Ph,Bh,Hh,Vh,Wh,zh,jh,Va,Uh,$h,qh,I,q,B,W,G,Y,ce;const i=fh({props:t,name:"MuiTooltip"}),{arrow:r=!1,children:n,classes:a,components:o={},componentsProps:l={},describeChild:h=!1,disableFocusListener:u=!1,disableHoverListener:c=!1,disableInteractive:f=!1,disableTouchListener:d=!1,enterDelay:p=100,enterNextDelay:v=0,enterTouchDelay:g=700,followCursor:b=!1,id:C,leaveDelay:y=0,leaveTouchDelay:x=1500,onClose:w,onOpen:S,open:E,placement:k="bottom",PopperComponent:A,PopperProps:z={},slotProps:D={},slots:T={},title:M,TransitionComponent:K=Qu,TransitionProps:te,...ee}=i,J=_e.isValidElement(n)?n:Ae.jsx("span",{children:n}),re=em(),j=O1(),[de,we]=_e.useState(),[N,H]=_e.useState(null),L=_e.useRef(!1),_=f||b,U=wl(),se=wl(),ae=wl(),oe=wl(),[me,Re]=AS({controlled:E,default:!1,name:"Tooltip",state:"open"});let V=me;const $e=OS(C),Me=_e.useRef(),Ze=d0(()=>{Me.current!==void 0&&(document.body.style.WebkitUserSelect=Me.current,Me.current=void 0),oe.clear()});_e.useEffect(()=>Ze,[Ze]);const Je=he=>{R0.clear(),Zh=!0,Re(!0),S&&!V&&S(he)},Le=d0(he=>{R0.start(800+y,()=>{Zh=!1}),Re(!1),w&&V&&w(he),U.start(re.transitions.duration.shortest,()=>{L.current=!1})}),Ct=he=>{L.current&&he.type!=="touchstart"||(de&&de.removeAttribute("title"),se.clear(),ae.clear(),p||Zh&&v?se.start(Zh?v:p,()=>{Je(he)}):Je(he))},si=he=>{se.clear(),ae.start(y,()=>{Le(he)})},[,Wt]=_e.useState(!1),li=he=>{p0(he.target)||(Wt(!1),si(he))},ar=he=>{de||we(he.currentTarget),p0(he.target)&&(Wt(!0),Ct(he))},xi=he=>{L.current=!0;const le=J.props;le.onTouchStart&&le.onTouchStart(he)},Tt=he=>{xi(he),ae.clear(),U.clear(),Ze(),Me.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",oe.start(g,()=>{document.body.style.WebkitUserSelect=Me.current,Ct(he)})},Ni=he=>{J.props.onTouchEnd&&J.props.onTouchEnd(he),Ze(),ae.start(x,()=>{Le(he)})};_e.useEffect(()=>{if(!V)return;function he(le){le.key==="Escape"&&Le(le)}return document.addEventListener("keydown",he),()=>{document.removeEventListener("keydown",he)}},[Le,V]);const Di=Co(L1(J),we,e);!M&&M!==0&&(V=!1);const F=_e.useRef(),Q=he=>{const le=J.props;le.onMouseMove&&le.onMouseMove(he),Zo={x:he.clientX,y:he.clientY},F.current&&F.current.update()},pe={},ge=typeof M=="string";h?(pe.title=!V&&ge&&!c?M:null,pe["aria-describedby"]=V?$e:null):(pe["aria-label"]=ge?M:null,pe["aria-labelledby"]=V&&!ge?$e:null);const Ee={...pe,...ee,...J.props,className:Ys(ee.className,J.props.className),onTouchStart:xi,ref:Di,...b?{onMouseMove:Q}:{}},ke={};d||(Ee.onTouchStart=Tt,Ee.onTouchEnd=Ni),c||(Ee.onMouseOver=eu(Ct,Ee.onMouseOver),Ee.onMouseLeave=eu(si,Ee.onMouseLeave),_||(ke.onMouseOver=Ct,ke.onMouseLeave=si)),u||(Ee.onFocus=eu(ar,Ee.onFocus),Ee.onBlur=eu(li,Ee.onBlur),_||(ke.onFocus=ar,ke.onBlur=li));const et=_e.useMemo(()=>{var le;let he=[{name:"arrow",enabled:!!N,options:{element:N,padding:4}}];return(le=z.popperOptions)!=null&&le.modifiers&&(he=he.concat(z.popperOptions.modifiers)),{...z.popperOptions,modifiers:he}},[N,z]),At={...i,isRtl:j,arrow:r,disableInteractive:_,placement:k,PopperComponentProp:A,touch:L.current},qt=BT(At),or=(Ph=(Mh=T.popper)!=null?Mh:o.Popper)!=null?Ph:HT,lr=(Vh=(Hh=(Bh=T.transition)!=null?Bh:o.Transition)!=null?Hh:K)!=null?Vh:Qu,Hn=(zh=(Wh=T.tooltip)!=null?Wh:o.Tooltip)!=null?zh:VT,Vn=(Va=(jh=T.arrow)!=null?jh:o.Arrow)!=null?Va:WT,Ba=Gh(or,{...z,...(Uh=D.popper)!=null?Uh:l.popper,className:Ys(qt.popper,z==null?void 0:z.className,(qh=($h=D.popper)!=null?$h:l.popper)==null?void 0:qh.className)},At),Wn=Gh(lr,{...te,...(I=D.transition)!=null?I:l.transition},At),yf=Gh(Hn,{...(q=D.tooltip)!=null?q:l.tooltip,className:Ys(qt.tooltip,(W=(B=D.tooltip)!=null?B:l.tooltip)==null?void 0:W.className)},At),Ha=Gh(Vn,{...(G=D.arrow)!=null?G:l.arrow,className:Ys(qt.arrow,(ce=(Y=D.arrow)!=null?Y:l.arrow)==null?void 0:ce.className)},At);return Ae.jsxs(_e.Fragment,{children:[_e.cloneElement(J,Ee),Ae.jsx(or,{as:A!=null?A:Y1,placement:k,anchorEl:b?{getBoundingClientRect:()=>({top:Zo.y,left:Zo.x,right:Zo.x,bottom:Zo.y,width:0,height:0})}:de,popperRef:F,open:de?V:!1,id:$e,transition:!0,...ke,...Ba,popperOptions:et,children:({TransitionProps:he})=>Ae.jsx(lr,{timeout:re.transitions.duration.shorter,...he,...Wn,children:Ae.jsxs(Hn,{...yf,children:[M,r?Ae.jsx(Vn,{...Ha,ref:H}):null]})})})]})});function zT(s){return Io("MuiToggleButton",s)}const oa=Ro("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),Q1=_e.createContext({}),Z1=_e.createContext(void 0);function jT(s,t){return t===void 0||s===void 0?!1:Array.isArray(t)?t.includes(s):s===t}const UT=s=>{const{classes:t,fullWidth:e,selected:i,disabled:r,size:n,color:a}=s,o={root:["root",i&&"selected",r&&"disabled",e&&"fullWidth","size".concat(rn(n)),a]};return _o(o,zT,t)},$T=ds(LS,{name:"MuiToggleButton",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:e}=s;return[t.root,t["size".concat(rn(e.size))]]}})(Ta(({theme:s})=>({...s.typography.button,borderRadius:(s.vars||s).shape.borderRadius,padding:11,border:"1px solid ".concat((s.vars||s).palette.divider),color:(s.vars||s).palette.action.active,["&.".concat(oa.disabled)]:{color:(s.vars||s).palette.action.disabled,border:"1px solid ".concat((s.vars||s).palette.action.disabledBackground)},"&:hover":{textDecoration:"none",backgroundColor:s.vars?"rgba(".concat(s.vars.palette.text.primaryChannel," / ").concat(s.vars.palette.action.hoverOpacity,")"):ns(s.palette.text.primary,s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[{props:{color:"standard"},style:{["&.".concat(oa.selected)]:{color:(s.vars||s).palette.text.primary,backgroundColor:s.vars?"rgba(".concat(s.vars.palette.text.primaryChannel," / ").concat(s.vars.palette.action.selectedOpacity,")"):ns(s.palette.text.primary,s.palette.action.selectedOpacity),"&:hover":{backgroundColor:s.vars?"rgba(".concat(s.vars.palette.text.primaryChannel," / calc(").concat(s.vars.palette.action.selectedOpacity," + ").concat(s.vars.palette.action.hoverOpacity,"))"):ns(s.palette.text.primary,s.palette.action.selectedOpacity+s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:s.vars?"rgba(".concat(s.vars.palette.text.primaryChannel," / ").concat(s.vars.palette.action.selectedOpacity,")"):ns(s.palette.text.primary,s.palette.action.selectedOpacity)}}}}},...Object.entries(s.palette).filter(RS()).map(([t])=>({props:{color:t},style:{["&.".concat(oa.selected)]:{color:(s.vars||s).palette[t].main,backgroundColor:s.vars?"rgba(".concat(s.vars.palette[t].mainChannel," / ").concat(s.vars.palette.action.selectedOpacity,")"):ns(s.palette[t].main,s.palette.action.selectedOpacity),"&:hover":{backgroundColor:s.vars?"rgba(".concat(s.vars.palette[t].mainChannel," / calc(").concat(s.vars.palette.action.selectedOpacity," + ").concat(s.vars.palette.action.hoverOpacity,"))"):ns(s.palette[t].main,s.palette.action.selectedOpacity+s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:s.vars?"rgba(".concat(s.vars.palette[t].mainChannel," / ").concat(s.vars.palette.action.selectedOpacity,")"):ns(s.palette[t].main,s.palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{padding:7,fontSize:s.typography.pxToRem(13)}},{props:{size:"large"},style:{padding:15,fontSize:s.typography.pxToRem(15)}}]}))),qT=_e.forwardRef(function(t,e){const{value:i,...r}=_e.useContext(Q1),n=_e.useContext(Z1),a=IS({...r,selected:jT(t.value,i)},t),o=fh({props:a,name:"MuiToggleButton"}),{children:l,className:h,color:u="standard",disabled:c=!1,disableFocusRipple:f=!1,fullWidth:d=!1,onChange:p,onClick:v,selected:g,size:b="medium",value:C,...y}=o,x={...o,color:u,disabled:c,disableFocusRipple:f,fullWidth:d,size:b},w=UT(x),S=k=>{v&&(v(k,C),k.defaultPrevented)||p&&p(k,C)},E=n||"";return Ae.jsx($T,{className:Ys(r.className,w.root,h,E),disabled:c,focusRipple:!f,ref:e,onClick:S,onChange:p,value:C,ownerState:x,"aria-pressed":g,...y,children:l})});function GT(s){return Io("MuiToggleButtonGroup",s)}const Yt=Ro("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),XT=s=>{const{classes:t,orientation:e,fullWidth:i,disabled:r}=s,n={root:["root",e,i&&"fullWidth"],grouped:["grouped","grouped".concat(rn(e)),r&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return _o(n,GT,t)},KT=ds("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:e}=s;return[{["& .".concat(Yt.grouped)]:t.grouped},{["& .".concat(Yt.grouped)]:t["grouped".concat(rn(e.orientation))]},{["& .".concat(Yt.firstButton)]:t.firstButton},{["& .".concat(Yt.lastButton)]:t.lastButton},{["& .".concat(Yt.middleButton)]:t.middleButton},t.root,e.orientation==="vertical"&&t.vertical,e.fullWidth&&t.fullWidth]}})(Ta(({theme:s})=>({display:"inline-flex",borderRadius:(s.vars||s).shape.borderRadius,variants:[{props:{orientation:"vertical"},style:{flexDirection:"column",["& .".concat(Yt.grouped)]:{["&.".concat(Yt.selected," + .").concat(Yt.grouped,".").concat(Yt.selected)]:{borderTop:0,marginTop:0}},["& .".concat(Yt.firstButton,",& .").concat(Yt.middleButton)]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},["& .".concat(Yt.lastButton,",& .").concat(Yt.middleButton)]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},["& .".concat(Yt.lastButton,".").concat(oa.disabled,",& .").concat(Yt.middleButton,".").concat(oa.disabled)]:{borderTop:"1px solid transparent"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"horizontal"},style:{["& .".concat(Yt.grouped)]:{["&.".concat(Yt.selected," + .").concat(Yt.grouped,".").concat(Yt.selected)]:{borderLeft:0,marginLeft:0}},["& .".concat(Yt.firstButton,",& .").concat(Yt.middleButton)]:{borderTopRightRadius:0,borderBottomRightRadius:0},["& .".concat(Yt.lastButton,",& .").concat(Yt.middleButton)]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},["& .".concat(Yt.lastButton,".").concat(oa.disabled,",& .").concat(Yt.middleButton,".").concat(oa.disabled)]:{borderLeft:"1px solid transparent"}}}]}))),YT=_e.forwardRef(function(t,e){const i=fh({props:t,name:"MuiToggleButtonGroup"}),{children:r,className:n,color:a="standard",disabled:o=!1,exclusive:l=!1,fullWidth:h=!1,onChange:u,orientation:c="horizontal",size:f="medium",value:d,...p}=i,v={...i,disabled:o,fullWidth:h,orientation:c,size:f},g=XT(v),b=_e.useCallback((E,k)=>{if(!u)return;const A=d&&d.indexOf(k);let z;d&&A>=0?(z=d.slice(),z.splice(A,1)):z=d?d.concat(k):[k],u(E,z)},[u,d]),C=_e.useCallback((E,k)=>{u&&u(E,d===k?null:k)},[u,d]),y=_e.useMemo(()=>({className:g.grouped,onChange:l?C:b,value:d,size:f,fullWidth:h,color:a,disabled:o}),[g.grouped,l,C,b,d,f,h,a,o]),x=_S(r),w=x.length,S=E=>{const k=E===0,A=E===w-1;return k&&A?"":k?g.firstButton:A?g.lastButton:g.middleButton};return Ae.jsx(KT,{role:"group",className:Ys(g.root,n),ref:e,ownerState:v,...p,children:Ae.jsx(Q1.Provider,{value:y,children:x.map((E,k)=>Ae.jsx(Z1.Provider,{value:S(k),children:E},k))})})});class JT{constructor(t,e,i,r,n,a,o,l,h,u,c,f,d,p,v,g=[]){this.key=t,this.swoodVersion=e,this.schemaVersion=i,this.name=r,this.projectPath=n,this.reportPath=a,this.createdDate=o,this.createdBy=l,this.variables=h,this.serialNumbers=u,this.swcps=c,this.projectQuantity=f,this.status=d,this.tier=p,this.dataSettings=v,this.dimensionProperties=g}}class fm{constructor(t,e,i,r,n,a,o,l,h,u,c,f,d,p,v=[]){this.key=t,this.swoodVersion=e,this.schemaVersion=i,this.name=r,this.projectPath=n,this.reportPath=a,this.createdDate=o,this.createdBy=l,this.variables=h,this.serialNumbers=u,this.swcps=c,this.status=f,this.tier=d,this.dataSettings=p,this.dimensionProperties=v,this.createViewModel=()=>new JT(this.key,this.swoodVersion,this.schemaVersion,this.name,this.projectPath,this.reportPath,this.createdDate,this.createdBy,this.variables,this.serialNumbers,this.swcps,this.getProjectQuantity(),this.status,this.tier,this.dataSettings,this.dimensionProperties),this.getProjectQuantity=()=>{var g;return(g=this.swcps["Project Quantity"])!=null?g:1}}static fromData(t,e){return new fm(t.key,t.swoodVersion,t.schemaVersion,t.name,t.projectPath,t.reportPath,t.createdDate,t.createdBy,t.variables,t.serialNumbers,t.swcps,e.status,e.tier,t.dataSettings,t.dimensionProperties)}}const QT=["length","width","thickness","lengthWithEdgeband","widthWithEdgeband","thicknessWithLaminate","lengthWithoutEdgeband","widthWithoutEdgeband","thicknessWithoutLaminate","lengthStock","widthStock","thicknessStock","height","depth"];class ZT{constructor(){this.instances=new Set,this.instances=new Set(QT)}addInstances(t){var e;for(const i of Object.keys(t))for(const r of(e=t[i])!=null?e:[])r.type==="D"&&this.instances.add(r.alias);return this}getAll(){return Array.from(this.instances)}has(t){return this.instances.has(t)}}class dm{static parseVariablesArrayToObject(t){if(!t||t.length===0)return{};const e={};for(const i of t)e[i.name]=dm.parseValue(i.value,i.type);return e}static parseValue(t,e){switch(e){case"Text":case"Date":return String(t);case"Number":case"Double":{const i=Number(t);return isNaN(i)?(console.warn('invalid number for type "'.concat(e,'": "').concat(t,'", defaulting to 0')),0):i}case"YesOrNo":return t.toLocaleLowerCase()==="yes";case"Unknown":return t;default:return console.warn('unhandled type "'.concat(e,'", returning raw value')),t}}}class pm{constructor(t,e,i,r,n,a,o,l,h,u,c,f,d){this.key=t,this.swoodVersion=e,this.schemaVersion=i,this.name=r,this.projectPath=n,this.reportPath=a,this.createdDate=o,this.createdBy=l,this.variables=h,this.serialNumbers=u,this.swcps=c,this.dataSettings=f,this.dimensionProperties=d}static fromProjectRaw(t,e,i){var l;const r=g0.parseVariables(t.variables,(l=i.report)!=null?l:[]),n=g0.parseVariablesArrayToObject(t.serialNumbers.variables),a=dm.parseVariablesArrayToObject(t.swcps),o=new ZT().addInstances(i!=null?i:{});return new pm(t.reportGUID,t.reportVersion,t.schemaVersion,t.projectName,t.projectPath,t.reportPath,t.createdDate,t.createdBy,r,n,a,e,o.getAll())}}class wn{constructor(t){this.project=t}static hasInstance(){return!!wn.instance}static getInstance(t,e,i){var r;if(!wn.instance){if(!t)throw new Error("Report must be initialized with data the first time.");if(!e)throw new Error("Report must be initialized with settings the first time.");if(!i)throw new Error("Report must be initialized with licenseInfo the first time.");const n=pm.fromProjectRaw(t,e,(r=t.variableDefinitions)!=null?r:{}),o=fm.fromData(n,i).createViewModel();wn.instance={project:o}}return wn.instance.project}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Yl={};Yl.version="0.18.5";var jr=1200,ga=1252,eA=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],mm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Nc=function(s){eA.indexOf(s)!=-1&&(ga=mm[0]=s)};function tA(){Nc(1252)}var ls=function(s){jr=s,Nc(s)};function Mc(){ls(1200),tA()}function Zu(s){for(var t=[],e=0,i=s.length;e<i;++e)t[e]=s.charCodeAt(e);return t}function iA(s){for(var t=[],e=0;e<s.length>>1;++e)t[e]=String.fromCharCode(s.charCodeAt(2*e)+(s.charCodeAt(2*e+1)<<8));return t.join("")}function ex(s){for(var t=[],e=0;e<s.length>>1;++e)t[e]=String.fromCharCode(s.charCodeAt(2*e+1)+(s.charCodeAt(2*e)<<8));return t.join("")}var ao=function(s){var t=s.charCodeAt(0),e=s.charCodeAt(1);return t==255&&e==254?iA(s.slice(2)):t==254&&e==255?ex(s.slice(2)):t==65279?s.slice(1):s},El=function(t){return String.fromCharCode(t)},Yd=function(t){return String.fromCharCode(t)},kt;function rA(s){kt=s,ls=function(t){jr=t,Nc(t)},ao=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?kt.utils.decode(1200,Zu(t.slice(2))):t},El=function(e){return jr===1200?String.fromCharCode(e):kt.utils.decode(jr,[e&255,e>>8])[0]},Yd=function(e){return kt.utils.decode(ga,[e])[0]},Dx()}var En="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Jl(s){for(var t="",e=0,i=0,r=0,n=0,a=0,o=0,l=0,h=0;h<s.length;)e=s.charCodeAt(h++),n=e>>2,i=s.charCodeAt(h++),a=(e&3)<<4|i>>4,r=s.charCodeAt(h++),o=(i&15)<<2|r>>6,l=r&63,isNaN(i)?o=l=64:isNaN(r)&&(l=64),t+=En.charAt(n)+En.charAt(a)+En.charAt(o)+En.charAt(l);return t}function qr(s){var t="",e=0,i=0,r=0,n=0,a=0,o=0,l=0;s=s.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<s.length;)n=En.indexOf(s.charAt(h++)),a=En.indexOf(s.charAt(h++)),e=n<<2|a>>4,t+=String.fromCharCode(e),o=En.indexOf(s.charAt(h++)),i=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(i)),l=En.indexOf(s.charAt(h++)),r=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(r));return t}var vt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),nn=function(){if(typeof Buffer<"u"){var s=!Buffer.from;if(!s)try{Buffer.from("foo","utf8")}catch(t){s=!0}return s?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Dn(s){return vt?Buffer.alloc?Buffer.alloc(s):new Buffer(s):typeof Uint8Array<"u"?new Uint8Array(s):new Array(s)}function _0(s){return vt?Buffer.allocUnsafe?Buffer.allocUnsafe(s):new Buffer(s):typeof Uint8Array<"u"?new Uint8Array(s):new Array(s)}var Vr=function(t){return vt?nn(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function mh(s){if(typeof ArrayBuffer>"u")return Vr(s);for(var t=new ArrayBuffer(s.length),e=new Uint8Array(t),i=0;i!=s.length;++i)e[i]=s.charCodeAt(i)&255;return t}function Nn(s){if(Array.isArray(s))return s.map(function(i){return String.fromCharCode(i)}).join("");for(var t=[],e=0;e<s.length;++e)t[e]=String.fromCharCode(s[e]);return t.join("")}function sA(s){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(s)}function vm(s){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(s instanceof ArrayBuffer)return vm(new Uint8Array(s));for(var t=new Array(s.length),e=0;e<s.length;++e)t[e]=s[e];return t}var Hi=vt?function(s){return Buffer.concat(s.map(function(t){return Buffer.isBuffer(t)?t:nn(t)}))}:function(s){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<s.length;++t)e+=s[t].length;var i=new Uint8Array(e),r=0;for(t=0,e=0;t<s.length;e+=r,++t)if(r=s[t].length,s[t]instanceof Uint8Array)i.set(s[t],e);else{if(typeof s[t]=="string")throw"wtf";i.set(new Uint8Array(s[t]),e)}return i}return[].concat.apply([],s.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function nA(s){for(var t=[],e=0,i=s.length+250,r=Dn(s.length+255),n=0;n<s.length;++n){var a=s.charCodeAt(n);if(a<128)r[e++]=a;else if(a<2048)r[e++]=192|a>>6&31,r[e++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=s.charCodeAt(++n)&1023;r[e++]=240|a>>8&7,r[e++]=128|a>>2&63,r[e++]=128|o>>6&15|(a&3)<<4,r[e++]=128|o&63}else r[e++]=224|a>>12&15,r[e++]=128|a>>6&63,r[e++]=128|a&63;e>i&&(t.push(r.slice(0,e)),e=0,r=Dn(65535),i=65530)}return t.push(r.slice(0,e)),Hi(t)}var ir=/\u0000/g,Sl=/[\u0001-\u0006]/g;function vo(s){for(var t="",e=s.length-1;e>=0;)t+=s.charAt(e--);return t}function ws(s,t){var e=""+s;return e.length>=t?e:ci("0",t-e.length)+e}function gm(s,t){var e=""+s;return e.length>=t?e:ci(" ",t-e.length)+e}function ec(s,t){var e=""+s;return e.length>=t?e:e+ci(" ",t-e.length)}function aA(s,t){var e=""+Math.round(s);return e.length>=t?e:ci("0",t-e.length)+e}function oA(s,t){var e=""+s;return e.length>=t?e:ci("0",t-e.length)+e}var F0=Math.pow(2,32);function Wa(s,t){if(s>F0||s<-F0)return aA(s,t);var e=Math.round(s);return oA(e,t)}function tc(s,t){return t=t||0,s.length>=7+t&&(s.charCodeAt(t)|32)===103&&(s.charCodeAt(t+1)|32)===101&&(s.charCodeAt(t+2)|32)===110&&(s.charCodeAt(t+3)|32)===101&&(s.charCodeAt(t+4)|32)===114&&(s.charCodeAt(t+5)|32)===97&&(s.charCodeAt(t+6)|32)===108}var N0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function lA(s){return s||(s={}),s[0]="General",s[1]="0",s[2]="0.00",s[3]="#,##0",s[4]="#,##0.00",s[9]="0%",s[10]="0.00%",s[11]="0.00E+00",s[12]="# ?/?",s[13]="# ??/??",s[14]="m/d/yy",s[15]="d-mmm-yy",s[16]="d-mmm",s[17]="mmm-yy",s[18]="h:mm AM/PM",s[19]="h:mm:ss AM/PM",s[20]="h:mm",s[21]="h:mm:ss",s[22]="m/d/yy h:mm",s[37]="#,##0 ;(#,##0)",s[38]="#,##0 ;[Red](#,##0)",s[39]="#,##0.00;(#,##0.00)",s[40]="#,##0.00;[Red](#,##0.00)",s[45]="mm:ss",s[46]="[h]:mm:ss",s[47]="mmss.0",s[48]="##0.0E+0",s[49]="@",s[56]='"/ "hh""mm""ss" "',s}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},M0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hA={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ic(s,t,e){for(var i=s<0?-1:1,r=s*i,n=0,a=1,o=0,l=1,h=0,u=0,c=Math.floor(r);h<t&&(c=Math.floor(r),o=c*a+n,u=c*h+l,!(r-c<5e-8));)r=1/(r-c),n=a,a=o,l=h,h=u;if(u>t&&(h>t?(u=l,o=n):(u=h,o=a)),!e)return[0,i*o,u];var f=Math.floor(i*o/u);return[f,i*o-f*u,u]}function Sn(s,t,e){if(s>2958465||s<0)return null;var i=s|0,r=Math.floor(86400*(s-i)),n=0,a=[],o={D:i,T:r,u:86400*(s-i)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(i+=1462),o.u>.9999&&(o.u=0,++r==86400&&(o.T=r=0,++i,++o.D)),i===60)a=e?[1317,10,29]:[1900,2,29],n=3;else if(i===0)a=e?[1317,8,29]:[1900,1,0],n=6;else{i>60&&--i;var l=new Date(1900,0,1);l.setDate(l.getDate()+i-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],n=l.getDay(),i<60&&(n=(n+6)%7),e&&(n=mA(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=r%60,r=Math.floor(r/60),o.M=r%60,r=Math.floor(r/60),o.H=r,o.q=n,o}var tx=new Date(1899,11,31,0,0,0),uA=tx.getTime(),cA=new Date(1900,2,1,0,0,0);function ix(s,t){var e=s.getTime();return t?e-=1461*24*60*60*1e3:s>=cA&&(e+=24*60*60*1e3),(e-(uA+(s.getTimezoneOffset()-tx.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function bm(s){return s.indexOf(".")==-1?s:s.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fA(s){return s.indexOf("E")==-1?s:s.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function dA(s){var t=s<0?12:11,e=bm(s.toFixed(12));return e.length<=t||(e=s.toPrecision(10),e.length<=t)?e:s.toExponential(5)}function pA(s){var t=bm(s.toFixed(11));return t.length>(s<0?12:11)||t==="0"||t==="-0"?s.toPrecision(6):t}function Ql(s){var t=Math.floor(Math.log(Math.abs(s))*Math.LOG10E),e;return t>=-4&&t<=-1?e=s.toPrecision(10+t):Math.abs(t)<=9?e=dA(s):t===10?e=s.toFixed(10).substr(0,12):e=pA(s),bm(fA(e.toUpperCase()))}function ba(s,t){switch(typeof s){case"string":return s;case"boolean":return s?"TRUE":"FALSE";case"number":return(s|0)===s?s.toString(10):Ql(s);case"undefined":return"";case"object":if(s==null)return"";if(s instanceof Date)return Gr(14,ix(s,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+s)}function mA(s,t){t[0]-=581;var e=s.getDay();return s<60&&(e=(e+6)%7),e}function vA(s,t,e,i){var r="",n=0,a=0,o=e.y,l,h=0;switch(s){case 98:o=e.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,h=2;break;default:l=o%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:l=e.m,h=t.length;break;case 3:return Sf[e.m-1][1];case 5:return Sf[e.m-1][0];default:return Sf[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=e.d,h=t.length;break;case 3:return N0[e.q][0];default:return N0[e.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(e.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=e.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=e.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?ws(e.S,t.length):(i>=2?a=i===3?1e3:100:a=i===1?10:1,n=Math.round(a*(e.S+e.u)),n>=60*a&&(n=0),t==="s"?n===0?"0":""+n/a:(r=ws(n,2+i),t==="ss"?r.substr(0,2):"."+r.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=e.D*24+e.H;break;case"[m]":case"[mm]":l=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":l=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:l=o,h=1;break}var u=h>0?ws(l,h):"";return u}function kn(s){var t=3;if(s.length<=t)return s;for(var e=s.length%t,i=s.substr(0,e);e!=s.length;e+=t)i+=(i.length>0?",":"")+s.substr(e,t);return i}var rx=/%/g;function gA(s,t,e){var i=t.replace(rx,""),r=t.length-i.length;return Qs(s,i,e*Math.pow(10,2*r))+ci("%",r)}function bA(s,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return Qs(s,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function sx(s,t){var e,i=s.indexOf("E")-s.indexOf(".")-1;if(s.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+sx(s,-t);var r=s.indexOf(".");r===-1&&(r=s.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%r;if(n<0&&(n+=r),e=(t/Math.pow(10,n)).toPrecision(i+1+(r+n)%r),e.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+n):e+="E+"+(a-n);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,r)+"."+e.substr(2+r),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,h,u){return l+h+u.substr(0,(r+n)%r)+"."+u.substr(n)+"E"})}else e=t.toExponential(i);return s.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),s.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var nx=/# (\?+)( ?)\/( ?)(\d+)/;function yA(s,t,e){var i=parseInt(s[4],10),r=Math.round(t*i),n=Math.floor(r/i),a=r-n*i,o=i;return e+(n===0?"":""+n)+" "+(a===0?ci(" ",s[1].length+1+s[4].length):gm(a,s[1].length)+s[2]+"/"+s[3]+ws(o,s[4].length))}function xA(s,t,e){return e+(t===0?"":""+t)+ci(" ",s[1].length+2+s[4].length)}var ax=/^#*0*\.([0#]+)/,ox=/\).*[0#]/,lx=/\(###\) ###\\?-####/;function fr(s){for(var t="",e,i=0;i!=s.length;++i)switch(e=s.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function P0(s,t){var e=Math.pow(10,t);return""+Math.round(s*e)/e}function B0(s,t){var e=s-Math.floor(s),i=Math.pow(10,t);return t<(""+Math.round(e*i)).length?0:Math.round(e*i)}function CA(s,t){return t<(""+Math.round((s-Math.floor(s))*Math.pow(10,t))).length?1:0}function wA(s){return s<2147483647&&s>-2147483648?""+(s>=0?s|0:s-1|0):""+Math.floor(s)}function Zr(s,t,e){if(s.charCodeAt(0)===40&&!t.match(ox)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Zr("n",i,e):"("+Zr("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return bA(s,t,e);if(t.indexOf("%")!==-1)return gA(s,t,e);if(t.indexOf("E")!==-1)return sx(t,e);if(t.charCodeAt(0)===36)return"$"+Zr(s,t.substr(t.charAt(1)==" "?2:1),e);var r,n,a,o,l=Math.abs(e),h=e<0?"-":"";if(t.match(/^00+$/))return h+Wa(l,t.length);if(t.match(/^[#?]+$/))return r=Wa(e,0),r==="0"&&(r=""),r.length>t.length?r:fr(t.substr(0,t.length-r.length))+r;if(n=t.match(nx))return yA(n,l,h);if(t.match(/^#+0+$/))return h+Wa(l,t.length-t.indexOf("0"));if(n=t.match(ax))return r=P0(e,n[1].length).replace(/^([^\.]+)$/,"$1."+fr(n[1])).replace(/\.$/,"."+fr(n[1])).replace(/\.(\d*)$/,function(p,v){return"."+v+ci("0",fr(n[1]).length-v.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return h+P0(l,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return h+kn(Wa(l,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Zr(s,t,-e):kn(""+(Math.floor(e)+CA(e,n[1].length)))+"."+ws(B0(e,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return Zr(s,t.replace(/^#,#*,/,""),e);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=vo(Zr(s,t.replace(/[\\-]/g,""),e)),a=0,vo(vo(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<r.length?r.charAt(a++):p==="0"?"0":""}));if(t.match(lx))return r=Zr(s,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var u="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(n[4].length,7),o=ic(l,Math.pow(10,a)-1,!1),r=""+h,u=Qs("n",n[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),r+=u+n[2]+"/"+n[3],u=ec(o[2],a),u.length<n[4].length&&(u=fr(n[4].substr(n[4].length-u.length))+u),r+=u,r;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(n[1].length,n[4].length),7),o=ic(l,Math.pow(10,a)-1,!0),h+(o[0]||(o[1]?"":"0"))+" "+(o[1]?gm(o[1],a)+n[2]+"/"+n[3]+ec(o[2],a):ci(" ",2*a+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return r=Wa(e,0),t.length<=r.length?r:fr(t.substr(0,t.length-r.length))+r;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),a=r.indexOf(".");var c=t.indexOf(".")-a,f=t.length-r.length-c;return fr(t.substr(0,c)+r+t.substr(t.length-f))}if(n=t.match(/^00,000\.([#0]*0)$/))return a=B0(e,n[1].length),e<0?"-"+Zr(s,t,-e):kn(wA(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?ws(0,3-p.length):"")+p})+"."+ws(a,n[1].length);switch(t){case"###,##0.00":return Zr(s,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var d=kn(Wa(l,0));return d!=="0"?h+d:"";case"###,###.00":return Zr(s,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Zr(s,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function EA(s,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return Qs(s,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function SA(s,t,e){var i=t.replace(rx,""),r=t.length-i.length;return Qs(s,i,e*Math.pow(10,2*r))+ci("%",r)}function hx(s,t){var e,i=s.indexOf("E")-s.indexOf(".")-1;if(s.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+hx(s,-t);var r=s.indexOf(".");r===-1&&(r=s.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%r;if(n<0&&(n+=r),e=(t/Math.pow(10,n)).toPrecision(i+1+(r+n)%r),!e.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+n):e+="E+"+(a-n),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,h,u){return l+h+u.substr(0,(r+n)%r)+"."+u.substr(n)+"E"})}else e=t.toExponential(i);return s.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),s.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Ds(s,t,e){if(s.charCodeAt(0)===40&&!t.match(ox)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ds("n",i,e):"("+Ds("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return EA(s,t,e);if(t.indexOf("%")!==-1)return SA(s,t,e);if(t.indexOf("E")!==-1)return hx(t,e);if(t.charCodeAt(0)===36)return"$"+Ds(s,t.substr(t.charAt(1)==" "?2:1),e);var r,n,a,o,l=Math.abs(e),h=e<0?"-":"";if(t.match(/^00+$/))return h+ws(l,t.length);if(t.match(/^[#?]+$/))return r=""+e,e===0&&(r=""),r.length>t.length?r:fr(t.substr(0,t.length-r.length))+r;if(n=t.match(nx))return xA(n,l,h);if(t.match(/^#+0+$/))return h+ws(l,t.length-t.indexOf("0"));if(n=t.match(ax))return r=(""+e).replace(/^([^\.]+)$/,"$1."+fr(n[1])).replace(/\.$/,"."+fr(n[1])),r=r.replace(/\.(\d*)$/,function(p,v){return"."+v+ci("0",fr(n[1]).length-v.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return h+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return h+kn(""+l);if(n=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ds(s,t,-e):kn(""+e)+"."+ci("0",n[1].length);if(n=t.match(/^#,#*,#0/))return Ds(s,t.replace(/^#,#*,/,""),e);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=vo(Ds(s,t.replace(/[\\-]/g,""),e)),a=0,vo(vo(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<r.length?r.charAt(a++):p==="0"?"0":""}));if(t.match(lx))return r=Ds(s,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var u="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(n[4].length,7),o=ic(l,Math.pow(10,a)-1,!1),r=""+h,u=Qs("n",n[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),r+=u+n[2]+"/"+n[3],u=ec(o[2],a),u.length<n[4].length&&(u=fr(n[4].substr(n[4].length-u.length))+u),r+=u,r;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(n[1].length,n[4].length),7),o=ic(l,Math.pow(10,a)-1,!0),h+(o[0]||(o[1]?"":"0"))+" "+(o[1]?gm(o[1],a)+n[2]+"/"+n[3]+ec(o[2],a):ci(" ",2*a+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return r=""+e,t.length<=r.length?r:fr(t.substr(0,t.length-r.length))+r;if(n=t.match(/^([#0]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),a=r.indexOf(".");var c=t.indexOf(".")-a,f=t.length-r.length-c;return fr(t.substr(0,c)+r+t.substr(t.length-f))}if(n=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Ds(s,t,-e):kn(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?ws(0,3-p.length):"")+p})+"."+ws(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=kn(""+l);return d!=="0"?h+d:"";default:if(t.match(/\.[0#?]*$/))return Ds(s,t.slice(0,t.lastIndexOf(".")),e)+fr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Qs(s,t,e){return(e|0)===e?Ds(s,t,e):Zr(s,t,e)}function kA(s){for(var t=[],e=!1,i=0,r=0;i<s.length;++i)switch(s.charCodeAt(i)){case 34:e=!e;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=s.substr(r,i-r),r=i+1}if(t[t.length]=s.substr(r),e===!0)throw new Error("Format |"+s+"| unterminated string ");return t}var ux=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Aa(s){for(var t=0,e="",i="";t<s.length;)switch(e=s.charAt(t)){case"G":tc(s,t)&&(t+=6),t++;break;case'"':for(;s.charCodeAt(++t)!==34&&t<s.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(s.charAt(t+1)==="1"||s.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(s.substr(t,3).toUpperCase()==="A/P"||s.substr(t,5).toUpperCase()==="AM/PM"||s.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(i=e;s.charAt(t++)!=="]"&&t<s.length;)i+=s.charAt(t);if(i.match(ux))return!0;break;case".":case"0":case"#":for(;t<s.length&&("0#?.,E+-%".indexOf(e=s.charAt(++t))>-1||e=="\\"&&s.charAt(t+1)=="-"&&"0#".indexOf(s.charAt(t+2))>-1););break;case"?":for(;s.charAt(++t)===e;);break;case"*":++t,(s.charAt(t)==" "||s.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<s.length&&"0123456789".indexOf(s.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function TA(s,t,e,i){for(var r=[],n="",a=0,o="",l="t",h,u,c,f="H";a<s.length;)switch(o=s.charAt(a)){case"G":if(!tc(s,a))throw new Error("unrecognized character "+o+" in "+s);r[r.length]={t:"G",v:"General"},a+=7;break;case'"':for(n="";(c=s.charCodeAt(++a))!==34&&a<s.length;)n+=String.fromCharCode(c);r[r.length]={t:"t",v:n},++a;break;case"\\":var d=s.charAt(++a),p=d==="("||d===")"?d:"t";r[r.length]={t:p,v:d},++a;break;case"_":r[r.length]={t:"t",v:" "},a+=2;break;case"@":r[r.length]={t:"T",v:t},++a;break;case"B":case"b":if(s.charAt(a+1)==="1"||s.charAt(a+1)==="2"){if(h==null&&(h=Sn(t,e,s.charAt(a+1)==="2"),h==null))return"";r[r.length]={t:"X",v:s.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=Sn(t,e),h==null))return"";for(n=o;++a<s.length&&s.charAt(a).toLowerCase()===o;)n+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),r[r.length]={t:o,v:n},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(h==null&&(h=Sn(t,e)),s.substr(a,3).toUpperCase()==="A/P"?(h!=null&&(v.v=h.H>=12?"P":"A"),v.t="T",f="h",a+=3):s.substr(a,5).toUpperCase()==="AM/PM"?(h!=null&&(v.v=h.H>=12?"PM":"AM"),v.t="T",a+=5,f="h"):s.substr(a,5).toUpperCase()==="/"?(h!=null&&(v.v=h.H>=12?"":""),v.t="T",a+=5,f="h"):(v.t="t",++a),h==null&&v.t==="T")return"";r[r.length]=v,l=o;break;case"[":for(n=o;s.charAt(a++)!=="]"&&a<s.length;)n+=s.charAt(a);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(ux)){if(h==null&&(h=Sn(t,e),h==null))return"";r[r.length]={t:"Z",v:n.toLowerCase()},l=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",Aa(s)||(r[r.length]={t:"t",v:n}));break;case".":if(h!=null){for(n=o;++a<s.length&&(o=s.charAt(a))==="0";)n+=o;r[r.length]={t:"s",v:n};break}case"0":case"#":for(n=o;++a<s.length&&"0#?.,E+-%".indexOf(o=s.charAt(a))>-1;)n+=o;r[r.length]={t:"n",v:n};break;case"?":for(n=o;s.charAt(++a)===o;)n+=o;r[r.length]={t:o,v:n},l=o;break;case"*":++a,(s.charAt(a)==" "||s.charAt(a)=="*")&&++a;break;case"(":case")":r[r.length]={t:i===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=o;a<s.length&&"0123456789".indexOf(s.charAt(++a))>-1;)n+=s.charAt(a);r[r.length]={t:"D",v:n};break;case" ":r[r.length]={t:o,v:o},++a;break;case"$":r[r.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+s);r[r.length]={t:"t",v:o},++a;break}var g=0,b=0,C;for(a=r.length-1,l="t";a>=0;--a)switch(r[a].t){case"h":case"H":r[a].t=f,l="h",g<1&&(g=1);break;case"s":(C=r[a].v.match(/\.0+$/))&&(b=Math.max(b,C[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=r[a].t;break;case"m":l==="s"&&(r[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&r[a].v.match(/[Hh]/)&&(g=1),g<2&&r[a].v.match(/[Mm]/)&&(g=2),g<3&&r[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var y="",x;for(a=0;a<r.length;++a)switch(r[a].t){case"t":case"T":case" ":case"D":break;case"X":r[a].v="",r[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[a].v=vA(r[a].t.charCodeAt(0),r[a].v,h,b),r[a].t="t";break;case"n":case"?":for(x=a+1;r[x]!=null&&((o=r[x].t)==="?"||o==="D"||(o===" "||o==="t")&&r[x+1]!=null&&(r[x+1].t==="?"||r[x+1].t==="t"&&r[x+1].v==="/")||r[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(r[x].v==="/"||r[x].v===" "&&r[x+1]!=null&&r[x+1].t=="?"));)r[a].v+=r[x].v,r[x]={v:"",t:";"},++x;y+=r[a].v,a=x-1;break;case"G":r[a].t="t",r[a].v=ba(t,e);break}var w="",S,E;if(y.length>0){y.charCodeAt(0)==40?(S=t<0&&y.charCodeAt(0)===45?-t:t,E=Qs("n",y,S)):(S=t<0&&i>1?-t:t,E=Qs("n",y,S),S<0&&r[0]&&r[0].t=="t"&&(E=E.substr(1),r[0].v="-"+r[0].v)),x=E.length-1;var k=r.length;for(a=0;a<r.length;++a)if(r[a]!=null&&r[a].t!="t"&&r[a].v.indexOf(".")>-1){k=a;break}var A=r.length;if(k===r.length&&E.indexOf("E")===-1){for(a=r.length-1;a>=0;--a)r[a]==null||"n?".indexOf(r[a].t)===-1||(x>=r[a].v.length-1?(x-=r[a].v.length,r[a].v=E.substr(x+1,r[a].v.length)):x<0?r[a].v="":(r[a].v=E.substr(0,x+1),x=-1),r[a].t="t",A=a);x>=0&&A<r.length&&(r[A].v=E.substr(0,x+1)+r[A].v)}else if(k!==r.length&&E.indexOf("E")===-1){for(x=E.indexOf(".")-1,a=k;a>=0;--a)if(!(r[a]==null||"n?".indexOf(r[a].t)===-1)){for(u=r[a].v.indexOf(".")>-1&&a===k?r[a].v.indexOf(".")-1:r[a].v.length-1,w=r[a].v.substr(u+1);u>=0;--u)x>=0&&(r[a].v.charAt(u)==="0"||r[a].v.charAt(u)==="#")&&(w=E.charAt(x--)+w);r[a].v=w,r[a].t="t",A=a}for(x>=0&&A<r.length&&(r[A].v=E.substr(0,x+1)+r[A].v),x=E.indexOf(".")+1,a=k;a<r.length;++a)if(!(r[a]==null||"n?(".indexOf(r[a].t)===-1&&a!==k)){for(u=r[a].v.indexOf(".")>-1&&a===k?r[a].v.indexOf(".")+1:0,w=r[a].v.substr(0,u);u<r[a].v.length;++u)x<E.length&&(w+=E.charAt(x++));r[a].v=w,r[a].t="t",A=a}}}for(a=0;a<r.length;++a)r[a]!=null&&"n?".indexOf(r[a].t)>-1&&(S=i>1&&t<0&&a>0&&r[a-1].v==="-"?-t:t,r[a].v=Qs(r[a].t,r[a].v,S),r[a].t="t");var z="";for(a=0;a!==r.length;++a)r[a]!=null&&(z+=r[a].v);return z}var H0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function V0(s,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(s==e)return!0;break;case">":if(s>e)return!0;break;case"<":if(s<e)return!0;break;case"<>":if(s!=e)return!0;break;case">=":if(s>=e)return!0;break;case"<=":if(s<=e)return!0;break}return!1}function AA(s,t){var e=kA(s),i=e.length,r=e[i-1].indexOf("@");if(i<4&&r>-1&&--i,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||r>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=r>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=r>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=r>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var n=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[i,n];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var a=e[0].match(H0),o=e[1].match(H0);return V0(t,a)?[i,e[0]]:V0(t,o)?[i,e[1]]:[i,e[a!=null&&o!=null?2:1]]}return[i,n]}function Gr(s,t,e){e==null&&(e={});var i="";switch(typeof s){case"string":s=="m/d/yy"&&e.dateNF?i=e.dateNF:i=s;break;case"number":s==14&&e.dateNF?i=e.dateNF:i=(e.table!=null?e.table:nt)[s],i==null&&(i=e.table&&e.table[M0[s]]||nt[M0[s]]),i==null&&(i=hA[s]||"General");break}if(tc(i,0))return ba(t,e);t instanceof Date&&(t=ix(t,e.date1904));var r=AA(i,t);if(tc(r[1]))return ba(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return TA(r[1],t,e,r[0])}function Fs(s,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(nt[e]==null){t<0&&(t=e);continue}if(nt[e]==s){t=e;break}}t<0&&(t=391)}return nt[t]=s,t}function vh(s){for(var t=0;t!=392;++t)s[t]!==void 0&&Fs(s[t],t)}function Fo(){nt=lA()}var cx={format:Gr,load:Fs,_table:nt,load_table:vh,parse_date_code:Sn,is_date:Aa,get_table:function(){return cx._table=nt}},OA={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},fx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function DA(s){var t=typeof s=="number"?nt[s]:s;return t=t.replace(fx,"(\\d+)"),new RegExp("^"+t+"$")}function LA(s,t,e){var i=-1,r=-1,n=-1,a=-1,o=-1,l=-1;(t.match(fx)||[]).forEach(function(c,f){var d=parseInt(e[f+1],10);switch(c.toLowerCase().charAt(0)){case"y":i=d;break;case"d":n=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:r=d;break}}),l>=0&&o==-1&&r>=0&&(o=r,r=-1);var h=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?h:i==-1&&r==-1&&n==-1?u:h+"T"+u}var RA=function(){var s={};s.version="1.2.0";function t(){for(var E=0,k=new Array(256),A=0;A!=256;++A)E=A,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,k[A]=E;return typeof Int32Array<"u"?new Int32Array(k):k}var e=t();function i(E){var k=0,A=0,z=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(z=0;z!=256;++z)D[z]=E[z];for(z=0;z!=256;++z)for(A=E[z],k=256+z;k<4096;k+=256)A=D[k]=A>>>8^E[A&255];var T=[];for(z=1;z!=16;++z)T[z-1]=typeof Int32Array<"u"?D.subarray(z*256,z*256+256):D.slice(z*256,z*256+256);return T}var r=i(e),n=r[0],a=r[1],o=r[2],l=r[3],h=r[4],u=r[5],c=r[6],f=r[7],d=r[8],p=r[9],v=r[10],g=r[11],b=r[12],C=r[13],y=r[14];function x(E,k){for(var A=k^-1,z=0,D=E.length;z<D;)A=A>>>8^e[(A^E.charCodeAt(z++))&255];return~A}function w(E,k){for(var A=k^-1,z=E.length-15,D=0;D<z;)A=y[E[D++]^A&255]^C[E[D++]^A>>8&255]^b[E[D++]^A>>16&255]^g[E[D++]^A>>>24]^v[E[D++]]^p[E[D++]]^d[E[D++]]^f[E[D++]]^c[E[D++]]^u[E[D++]]^h[E[D++]]^l[E[D++]]^o[E[D++]]^a[E[D++]]^n[E[D++]]^e[E[D++]];for(z+=15;D<z;)A=A>>>8^e[(A^E[D++])&255];return~A}function S(E,k){for(var A=k^-1,z=0,D=E.length,T=0,M=0;z<D;)T=E.charCodeAt(z++),T<128?A=A>>>8^e[(A^T)&255]:T<2048?(A=A>>>8^e[(A^(192|T>>6&31))&255],A=A>>>8^e[(A^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,M=E.charCodeAt(z++)&1023,A=A>>>8^e[(A^(240|T>>8&7))&255],A=A>>>8^e[(A^(128|T>>2&63))&255],A=A>>>8^e[(A^(128|M>>6&15|(T&3)<<4))&255],A=A>>>8^e[(A^(128|M&63))&255]):(A=A>>>8^e[(A^(224|T>>12&15))&255],A=A>>>8^e[(A^(128|T>>6&63))&255],A=A>>>8^e[(A^(128|T&63))&255]);return~A}return s.table=e,s.bstr=x,s.buf=w,s.str=S,s}(),rt=function(){var t={};t.version="1.2.1";function e(I,q){for(var B=I.split("/"),W=q.split("/"),G=0,Y=0,ce=Math.min(B.length,W.length);G<ce;++G){if(Y=B[G].length-W[G].length)return Y;if(B[G]!=W[G])return B[G]<W[G]?-1:1}return B.length-W.length}function i(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:i(I.slice(0,-1));var q=I.lastIndexOf("/");return q===-1?I:I.slice(0,q+1)}function r(I){if(I.charAt(I.length-1)=="/")return r(I.slice(0,-1));var q=I.lastIndexOf("/");return q===-1?I:I.slice(q+1)}function n(I,q){typeof q=="string"&&(q=new Date(q));var B=q.getHours();B=B<<6|q.getMinutes(),B=B<<5|q.getSeconds()>>>1,I.write_shift(2,B);var W=q.getFullYear()-1980;W=W<<4|q.getMonth()+1,W=W<<5|q.getDate(),I.write_shift(2,W)}function a(I){var q=I.read_shift(2)&65535,B=I.read_shift(2)&65535,W=new Date,G=B&31;B>>>=5;var Y=B&15;B>>>=4,W.setMilliseconds(0),W.setFullYear(B+1980),W.setMonth(Y-1),W.setDate(G);var ce=q&31;q>>>=5;var he=q&63;return q>>>=6,W.setHours(q),W.setMinutes(he),W.setSeconds(ce<<1),W}function o(I){$i(I,0);for(var q={},B=0;I.l<=I.length-4;){var W=I.read_shift(2),G=I.read_shift(2),Y=I.l+G,ce={};switch(W){case 21589:B=I.read_shift(1),B&1&&(ce.mtime=I.read_shift(4)),G>5&&(B&2&&(ce.atime=I.read_shift(4)),B&4&&(ce.ctime=I.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}I.l=Y,q[W]=ce}return q}var l;function h(){return l||(l={})}function u(I,q){if(I[0]==80&&I[1]==75)return Ba(I,q);if((I[0]|32)==109&&(I[1]|32)==105)return Wh(I,q);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var B=3,W=512,G=0,Y=0,ce=0,he=0,le=0,ve=[],be=I.slice(0,512);$i(be,0);var Ie=c(be);switch(B=Ie[0],B){case 3:W=512;break;case 4:W=4096;break;case 0:if(Ie[1]==0)return Ba(I,q);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}W!==512&&(be=I.slice(0,W),$i(be,28));var ze=I.slice(0,W);f(be,B);var Qe=be.read_shift(4,"i");if(B===3&&Qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Qe);be.l+=4,ce=be.read_shift(4,"i"),be.l+=4,be.chk("00100000","Mini Stream Cutoff Size: "),he=be.read_shift(4,"i"),G=be.read_shift(4,"i"),le=be.read_shift(4,"i"),Y=be.read_shift(4,"i");for(var Fe=-1,Xe=0;Xe<109&&(Fe=be.read_shift(4,"i"),!(Fe<0));++Xe)ve[Xe]=Fe;var ut=d(I,W);g(le,Y,ut,W,ve);var ni=C(ut,ce,ve,W);ni[ce].name="!Directory",G>0&&he!==M&&(ni[he].name="!MiniFAT"),ni[ve[0]].name="!FAT",ni.fat_addrs=ve,ni.ssz=W;var ai={},Xi=[],Xo=[],Ko=[];y(ce,ni,ut,Xi,G,ai,Xo,he),p(Xo,Ko,Xi),Xi.shift();var Yo={FileIndex:Xo,FullPaths:Ko};return q&&q.raw&&(Yo.raw={header:ze,sectors:ut}),Yo}function c(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(K,"Header Signature: "),I.l+=16;var q=I.read_shift(2,"u");return[I.read_shift(2,"u"),q]}function f(I,q){var B=9;switch(I.l+=2,B=I.read_shift(2)){case 9:if(q!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(q!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function d(I,q){for(var B=Math.ceil(I.length/q)-1,W=[],G=1;G<B;++G)W[G-1]=I.slice(G*q,(G+1)*q);return W[B-1]=I.slice(B*q),W}function p(I,q,B){for(var W=0,G=0,Y=0,ce=0,he=0,le=B.length,ve=[],be=[];W<le;++W)ve[W]=be[W]=W,q[W]=B[W];for(;he<be.length;++he)W=be[he],G=I[W].L,Y=I[W].R,ce=I[W].C,ve[W]===W&&(G!==-1&&ve[G]!==G&&(ve[W]=ve[G]),Y!==-1&&ve[Y]!==Y&&(ve[W]=ve[Y])),ce!==-1&&(ve[ce]=W),G!==-1&&W!=ve[W]&&(ve[G]=ve[W],be.lastIndexOf(G)<he&&be.push(G)),Y!==-1&&W!=ve[W]&&(ve[Y]=ve[W],be.lastIndexOf(Y)<he&&be.push(Y));for(W=1;W<le;++W)ve[W]===W&&(Y!==-1&&ve[Y]!==Y?ve[W]=ve[Y]:G!==-1&&ve[G]!==G&&(ve[W]=ve[G]));for(W=1;W<le;++W)if(I[W].type!==0){if(he=W,he!=ve[he])do he=ve[he],q[W]=q[he]+"/"+q[W];while(he!==0&&ve[he]!==-1&&he!=ve[he]);ve[W]=-1}for(q[0]+="/",W=1;W<le;++W)I[W].type!==2&&(q[W]+="/")}function v(I,q,B){for(var W=I.start,G=I.size,Y=[],ce=W;B&&G>0&&ce>=0;)Y.push(q.slice(ce*T,ce*T+T)),G-=T,ce=ra(B,ce*4);return Y.length===0?Ce(0):Hi(Y).slice(0,I.size)}function g(I,q,B,W,G){var Y=M;if(I===M){if(q!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var ce=B[I],he=(W>>>2)-1;if(!ce)return;for(var le=0;le<he&&(Y=ra(ce,le*4))!==M;++le)G.push(Y);g(ra(ce,W-4),q-1,B,W,G)}}function b(I,q,B,W,G){var Y=[],ce=[];G||(G=[]);var he=W-1,le=0,ve=0;for(le=q;le>=0;){G[le]=!0,Y[Y.length]=le,ce.push(I[le]);var be=B[Math.floor(le*4/W)];if(ve=le*4&he,W<4+ve)throw new Error("FAT boundary crossed: "+le+" 4 "+W);if(!I[be])break;le=ra(I[be],ve)}return{nodes:Y,data:Q0([ce])}}function C(I,q,B,W){var G=I.length,Y=[],ce=[],he=[],le=[],ve=W-1,be=0,Ie=0,ze=0,Qe=0;for(be=0;be<G;++be)if(he=[],ze=be+q,ze>=G&&(ze-=G),!ce[ze]){le=[];var Fe=[];for(Ie=ze;Ie>=0;){Fe[Ie]=!0,ce[Ie]=!0,he[he.length]=Ie,le.push(I[Ie]);var Xe=B[Math.floor(Ie*4/W)];if(Qe=Ie*4&ve,W<4+Qe)throw new Error("FAT boundary crossed: "+Ie+" 4 "+W);if(!I[Xe]||(Ie=ra(I[Xe],Qe),Fe[Ie]))break}Y[ze]={nodes:he,data:Q0([le])}}return Y}function y(I,q,B,W,G,Y,ce,he){for(var le=0,ve=W.length?2:0,be=q[I].data,Ie=0,ze=0,Qe;Ie<be.length;Ie+=128){var Fe=be.slice(Ie,Ie+128);$i(Fe,64),ze=Fe.read_shift(2),Qe=Vc(Fe,0,ze-ve),W.push(Qe);var Xe={name:Qe,type:Fe.read_shift(1),color:Fe.read_shift(1),L:Fe.read_shift(4,"i"),R:Fe.read_shift(4,"i"),C:Fe.read_shift(4,"i"),clsid:Fe.read_shift(16),state:Fe.read_shift(4,"i"),start:0,size:0},ut=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);ut!==0&&(Xe.ct=x(Fe,Fe.l-8));var ni=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);ni!==0&&(Xe.mt=x(Fe,Fe.l-8)),Xe.start=Fe.read_shift(4,"i"),Xe.size=Fe.read_shift(4,"i"),Xe.size<0&&Xe.start<0&&(Xe.size=Xe.type=0,Xe.start=M,Xe.name=""),Xe.type===5?(le=Xe.start,G>0&&le!==M&&(q[le].name="!StreamData")):Xe.size>=4096?(Xe.storage="fat",q[Xe.start]===void 0&&(q[Xe.start]=b(B,Xe.start,q.fat_addrs,q.ssz)),q[Xe.start].name=Xe.name,Xe.content=q[Xe.start].data.slice(0,Xe.size)):(Xe.storage="minifat",Xe.size<0?Xe.size=0:le!==M&&Xe.start!==M&&q[le]&&(Xe.content=v(Xe,q[le].data,(q[he]||{}).data))),Xe.content&&$i(Xe.content,0),Y[Qe]=Xe,ce.push(Xe)}}function x(I,q){return new Date((Bi(I,q+4)/1e7*Math.pow(2,32)+Bi(I,q)/1e7-11644473600)*1e3)}function w(I,q){return h(),u(l.readFileSync(I),q)}function S(I,q){var B=q&&q.type;switch(B||vt&&Buffer.isBuffer(I)&&(B="buffer"),B||"base64"){case"file":return w(I,q);case"base64":return u(Vr(qr(I)),q);case"binary":return u(Vr(I),q)}return u(I,q)}function E(I,q){var B=q||{},W=B.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=W+"/",I.FileIndex[0]={name:W,type:5}),B.CLSID&&(I.FileIndex[0].clsid=B.CLSID),k(I)}function k(I){var q="Sh33tJ5";if(!rt.find(I,"/"+q)){var B=Ce(4);B[0]=55,B[1]=B[3]=50,B[2]=54,I.FileIndex.push({name:q,type:2,content:B,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+q),A(I)}}function A(I,q){E(I);for(var B=!1,W=!1,G=I.FullPaths.length-1;G>=0;--G){var Y=I.FileIndex[G];switch(Y.type){case 0:W?B=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(Y.R*Y.L*Y.C)&&(B=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!q)){var ce=new Date(1987,1,19),he=0,le=Object.create?Object.create(null):{},ve=[];for(G=0;G<I.FullPaths.length;++G)le[I.FullPaths[G]]=!0,I.FileIndex[G].type!==0&&ve.push([I.FullPaths[G],I.FileIndex[G]]);for(G=0;G<ve.length;++G){var be=i(ve[G][0]);W=le[be],W||(ve.push([be,{name:r(be).replace("/",""),type:1,clsid:ee,ct:ce,mt:ce,content:null}]),le[be]=!0)}for(ve.sort(function(Qe,Fe){return e(Qe[0],Fe[0])}),I.FullPaths=[],I.FileIndex=[],G=0;G<ve.length;++G)I.FullPaths[G]=ve[G][0],I.FileIndex[G]=ve[G][1];for(G=0;G<ve.length;++G){var Ie=I.FileIndex[G],ze=I.FullPaths[G];if(Ie.name=r(ze).replace("/",""),Ie.L=Ie.R=Ie.C=-(Ie.color=1),Ie.size=Ie.content?Ie.content.length:0,Ie.start=0,Ie.clsid=Ie.clsid||ee,G===0)Ie.C=ve.length>1?1:-1,Ie.size=0,Ie.type=5;else if(ze.slice(-1)=="/"){for(he=G+1;he<ve.length&&i(I.FullPaths[he])!=ze;++he);for(Ie.C=he>=ve.length?-1:he,he=G+1;he<ve.length&&i(I.FullPaths[he])!=i(ze);++he);Ie.R=he>=ve.length?-1:he,Ie.type=1}else i(I.FullPaths[G+1]||"")==i(ze)&&(Ie.R=G+1),Ie.type=2}}}function z(I,q){var B=q||{};if(B.fileType=="mad")return zh(I,B);switch(A(I),B.fileType){case"zip":return yf(I,B)}var W=function(Qe){for(var Fe=0,Xe=0,ut=0;ut<Qe.FileIndex.length;++ut){var ni=Qe.FileIndex[ut];if(ni.content){var ai=ni.content.length;ai>0&&(ai<4096?Fe+=ai+63>>6:Xe+=ai+511>>9)}}for(var Xi=Qe.FullPaths.length+3>>2,Xo=Fe+7>>3,Ko=Fe+127>>7,Yo=Xo+Xe+Xi+Ko,zn=Yo+127>>7,xf=zn<=109?0:Math.ceil((zn-109)/127);Yo+zn+xf+127>>7>zn;)xf=++zn<=109?0:Math.ceil((zn-109)/127);var zs=[1,xf,zn,Ko,Xi,Xe,Fe,0];return Qe.FileIndex[0].size=Fe<<6,zs[7]=(Qe.FileIndex[0].start=zs[0]+zs[1]+zs[2]+zs[3]+zs[4]+zs[5])+(zs[6]+7>>3),zs}(I),G=Ce(W[7]<<9),Y=0,ce=0;{for(Y=0;Y<8;++Y)G.write_shift(1,te[Y]);for(Y=0;Y<8;++Y)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),Y=0;Y<3;++Y)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,W[2]),G.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:M),G.write_shift(4,W[3]),G.write_shift(-4,W[1]?W[0]-1:M),G.write_shift(4,W[1]),Y=0;Y<109;++Y)G.write_shift(-4,Y<W[2]?W[1]+Y:-1)}if(W[1])for(ce=0;ce<W[1];++ce){for(;Y<236+ce*127;++Y)G.write_shift(-4,Y<W[2]?W[1]+Y:-1);G.write_shift(-4,ce===W[1]-1?M:ce+1)}var he=function(Qe){for(ce+=Qe;Y<ce-1;++Y)G.write_shift(-4,Y+1);Qe&&(++Y,G.write_shift(-4,M))};for(ce=Y=0,ce+=W[1];Y<ce;++Y)G.write_shift(-4,J.DIFSECT);for(ce+=W[2];Y<ce;++Y)G.write_shift(-4,J.FATSECT);he(W[3]),he(W[4]);for(var le=0,ve=0,be=I.FileIndex[0];le<I.FileIndex.length;++le)be=I.FileIndex[le],be.content&&(ve=be.content.length,!(ve<4096)&&(be.start=ce,he(ve+511>>9)));for(he(W[6]+7>>3);G.l&511;)G.write_shift(-4,J.ENDOFCHAIN);for(ce=Y=0,le=0;le<I.FileIndex.length;++le)be=I.FileIndex[le],be.content&&(ve=be.content.length,!(!ve||ve>=4096)&&(be.start=ce,he(ve+63>>6)));for(;G.l&511;)G.write_shift(-4,J.ENDOFCHAIN);for(Y=0;Y<W[4]<<2;++Y){var Ie=I.FullPaths[Y];if(!Ie||Ie.length===0){for(le=0;le<17;++le)G.write_shift(4,0);for(le=0;le<3;++le)G.write_shift(4,-1);for(le=0;le<12;++le)G.write_shift(4,0);continue}be=I.FileIndex[Y],Y===0&&(be.start=be.size?be.start-1:M);var ze=Y===0&&B.root||be.name;if(ve=2*(ze.length+1),G.write_shift(64,ze,"utf16le"),G.write_shift(2,ve),G.write_shift(1,be.type),G.write_shift(1,be.color),G.write_shift(-4,be.L),G.write_shift(-4,be.R),G.write_shift(-4,be.C),be.clsid)G.write_shift(16,be.clsid,"hex");else for(le=0;le<4;++le)G.write_shift(4,0);G.write_shift(4,be.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,be.start),G.write_shift(4,be.size),G.write_shift(4,0)}for(Y=1;Y<I.FileIndex.length;++Y)if(be=I.FileIndex[Y],be.size>=4096)if(G.l=be.start+1<<9,vt&&Buffer.isBuffer(be.content))be.content.copy(G,G.l,0,be.size),G.l+=be.size+511&-512;else{for(le=0;le<be.size;++le)G.write_shift(1,be.content[le]);for(;le&511;++le)G.write_shift(1,0)}for(Y=1;Y<I.FileIndex.length;++Y)if(be=I.FileIndex[Y],be.size>0&&be.size<4096)if(vt&&Buffer.isBuffer(be.content))be.content.copy(G,G.l,0,be.size),G.l+=be.size+63&-64;else{for(le=0;le<be.size;++le)G.write_shift(1,be.content[le]);for(;le&63;++le)G.write_shift(1,0)}if(vt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function D(I,q){var B=I.FullPaths.map(function(le){return le.toUpperCase()}),W=B.map(function(le){var ve=le.split("/");return ve[ve.length-(le.slice(-1)=="/"?2:1)]}),G=!1;q.charCodeAt(0)===47?(G=!0,q=B[0].slice(0,-1)+q):G=q.indexOf("/")!==-1;var Y=q.toUpperCase(),ce=G===!0?B.indexOf(Y):W.indexOf(Y);if(ce!==-1)return I.FileIndex[ce];var he=!Y.match(Sl);for(Y=Y.replace(ir,""),he&&(Y=Y.replace(Sl,"!")),ce=0;ce<B.length;++ce)if((he?B[ce].replace(Sl,"!"):B[ce]).replace(ir,"")==Y||(he?W[ce].replace(Sl,"!"):W[ce]).replace(ir,"")==Y)return I.FileIndex[ce];return null}var T=64,M=-2,K="d0cf11e0a1b11ae1",te=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(I,q,B){h();var W=z(I,B);l.writeFileSync(q,W)}function j(I){for(var q=new Array(I.length),B=0;B<I.length;++B)q[B]=String.fromCharCode(I[B]);return q.join("")}function de(I,q){var B=z(I,q);switch(q&&q.type||"buffer"){case"file":return h(),l.writeFileSync(q.filename,B),B;case"binary":return typeof B=="string"?B:j(B);case"base64":return Jl(typeof B=="string"?B:j(B));case"buffer":if(vt)return Buffer.isBuffer(B)?B:nn(B);case"array":return typeof B=="string"?Vr(B):B}return B}var we;function N(I){try{var q=I.InflateRaw,B=new q;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)we=I;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function H(I,q){if(!we)return Hn(I,q);var B=we.InflateRaw,W=new B,G=W._processChunk(I.slice(I.l),W._finishFlushFlag);return I.l+=W.bytesRead,G}function L(I){return we?we.deflateRawSync(I):ge(I)}var _=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(I){var q=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(q>>16|q>>8|q)&255}for(var oe=typeof Uint8Array<"u",me=oe?new Uint8Array(256):[],Re=0;Re<256;++Re)me[Re]=ae(Re);function V(I,q){var B=me[I&255];return q<=8?B>>>8-q:(B=B<<8|me[I>>8&255],q<=16?B>>>16-q:(B=B<<8|me[I>>16&255],B>>>24-q))}function $e(I,q){var B=q&7,W=q>>>3;return(I[W]|(B<=6?0:I[W+1]<<8))>>>B&3}function Me(I,q){var B=q&7,W=q>>>3;return(I[W]|(B<=5?0:I[W+1]<<8))>>>B&7}function Ze(I,q){var B=q&7,W=q>>>3;return(I[W]|(B<=4?0:I[W+1]<<8))>>>B&15}function Je(I,q){var B=q&7,W=q>>>3;return(I[W]|(B<=3?0:I[W+1]<<8))>>>B&31}function Le(I,q){var B=q&7,W=q>>>3;return(I[W]|(B<=1?0:I[W+1]<<8))>>>B&127}function Ct(I,q,B){var W=q&7,G=q>>>3,Y=(1<<B)-1,ce=I[G]>>>W;return B<8-W||(ce|=I[G+1]<<8-W,B<16-W)||(ce|=I[G+2]<<16-W,B<24-W)||(ce|=I[G+3]<<24-W),ce&Y}function si(I,q,B){var W=q&7,G=q>>>3;return W<=5?I[G]|=(B&7)<<W:(I[G]|=B<<W&255,I[G+1]=(B&7)>>8-W),q+3}function Wt(I,q,B){var W=q&7,G=q>>>3;return B=(B&1)<<W,I[G]|=B,q+1}function li(I,q,B){var W=q&7,G=q>>>3;return B<<=W,I[G]|=B&255,B>>>=8,I[G+1]=B,q+8}function ar(I,q,B){var W=q&7,G=q>>>3;return B<<=W,I[G]|=B&255,B>>>=8,I[G+1]=B&255,I[G+2]=B>>>8,q+16}function xi(I,q){var B=I.length,W=2*B>q?2*B:q+5,G=0;if(B>=q)return I;if(vt){var Y=_0(W);if(I.copy)I.copy(Y);else for(;G<I.length;++G)Y[G]=I[G];return Y}else if(oe){var ce=new Uint8Array(W);if(ce.set)ce.set(I);else for(;G<B;++G)ce[G]=I[G];return ce}return I.length=W,I}function Tt(I){for(var q=new Array(I),B=0;B<I;++B)q[B]=0;return q}function Ni(I,q,B){var W=1,G=0,Y=0,ce=0,he=0,le=I.length,ve=oe?new Uint16Array(32):Tt(32);for(Y=0;Y<32;++Y)ve[Y]=0;for(Y=le;Y<B;++Y)I[Y]=0;le=I.length;var be=oe?new Uint16Array(le):Tt(le);for(Y=0;Y<le;++Y)ve[G=I[Y]]++,W<G&&(W=G),be[Y]=0;for(ve[0]=0,Y=1;Y<=W;++Y)ve[Y+16]=he=he+ve[Y-1]<<1;for(Y=0;Y<le;++Y)he=I[Y],he!=0&&(be[Y]=ve[he+16]++);var Ie=0;for(Y=0;Y<le;++Y)if(Ie=I[Y],Ie!=0)for(he=V(be[Y],W)>>W-Ie,ce=(1<<W+4-Ie)-1;ce>=0;--ce)q[he|ce<<Ie]=Ie&15|Y<<4;return W}var Di=oe?new Uint16Array(512):Tt(512),F=oe?new Uint16Array(32):Tt(32);if(!oe){for(var Q=0;Q<512;++Q)Di[Q]=0;for(Q=0;Q<32;++Q)F[Q]=0}(function(){for(var I=[],q=0;q<32;q++)I.push(5);Ni(I,F,32);var B=[];for(q=0;q<=143;q++)B.push(8);for(;q<=255;q++)B.push(9);for(;q<=279;q++)B.push(7);for(;q<=287;q++)B.push(8);Ni(B,Di,288)})();var pe=function(){for(var q=oe?new Uint8Array(32768):[],B=0,W=0;B<se.length-1;++B)for(;W<se[B+1];++W)q[W]=B;for(;W<32768;++W)q[W]=29;var G=oe?new Uint8Array(259):[];for(B=0,W=0;B<U.length-1;++B)for(;W<U[B+1];++W)G[W]=B;function Y(he,le){for(var ve=0;ve<he.length;){var be=Math.min(65535,he.length-ve),Ie=ve+be==he.length;for(le.write_shift(1,+Ie),le.write_shift(2,be),le.write_shift(2,~be&65535);be-- >0;)le[le.l++]=he[ve++]}return le.l}function ce(he,le){for(var ve=0,be=0,Ie=oe?new Uint16Array(32768):[];be<he.length;){var ze=Math.min(65535,he.length-be);if(ze<10){for(ve=si(le,ve,+(be+ze==he.length)),ve&7&&(ve+=8-(ve&7)),le.l=ve/8|0,le.write_shift(2,ze),le.write_shift(2,~ze&65535);ze-- >0;)le[le.l++]=he[be++];ve=le.l*8;continue}ve=si(le,ve,+(be+ze==he.length)+2);for(var Qe=0;ze-- >0;){var Fe=he[be];Qe=(Qe<<5^Fe)&32767;var Xe=-1,ut=0;if((Xe=Ie[Qe])&&(Xe|=be&-32768,Xe>be&&(Xe-=32768),Xe<be))for(;he[Xe+ut]==he[be+ut]&&ut<250;)++ut;if(ut>2){Fe=G[ut],Fe<=22?ve=li(le,ve,me[Fe+1]>>1)-1:(li(le,ve,3),ve+=5,li(le,ve,me[Fe-23]>>5),ve+=3);var ni=Fe<8?0:Fe-4>>2;ni>0&&(ar(le,ve,ut-U[Fe]),ve+=ni),Fe=q[be-Xe],ve=li(le,ve,me[Fe]>>3),ve-=3;var ai=Fe<4?0:Fe-2>>1;ai>0&&(ar(le,ve,be-Xe-se[Fe]),ve+=ai);for(var Xi=0;Xi<ut;++Xi)Ie[Qe]=be&32767,Qe=(Qe<<5^he[be])&32767,++be;ze-=ut-1}else Fe<=143?Fe=Fe+48:ve=Wt(le,ve,1),ve=li(le,ve,me[Fe]),Ie[Qe]=be&32767,++be}ve=li(le,ve,0)-1}return le.l=(ve+7)/8|0,le.l}return function(le,ve){return le.length<8?Y(le,ve):ce(le,ve)}}();function ge(I){var q=Ce(50+Math.floor(I.length*1.1)),B=pe(I,q);return q.slice(0,B)}var Ee=oe?new Uint16Array(32768):Tt(32768),ke=oe?new Uint16Array(32768):Tt(32768),et=oe?new Uint16Array(128):Tt(128),At=1,qt=1;function or(I,q){var B=Je(I,q)+257;q+=5;var W=Je(I,q)+1;q+=5;var G=Ze(I,q)+4;q+=4;for(var Y=0,ce=oe?new Uint8Array(19):Tt(19),he=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,ve=oe?new Uint8Array(8):Tt(8),be=oe?new Uint8Array(8):Tt(8),Ie=ce.length,ze=0;ze<G;++ze)ce[_[ze]]=Y=Me(I,q),le<Y&&(le=Y),ve[Y]++,q+=3;var Qe=0;for(ve[0]=0,ze=1;ze<=le;++ze)be[ze]=Qe=Qe+ve[ze-1]<<1;for(ze=0;ze<Ie;++ze)(Qe=ce[ze])!=0&&(he[ze]=be[Qe]++);var Fe=0;for(ze=0;ze<Ie;++ze)if(Fe=ce[ze],Fe!=0){Qe=me[he[ze]]>>8-Fe;for(var Xe=(1<<7-Fe)-1;Xe>=0;--Xe)et[Qe|Xe<<Fe]=Fe&7|ze<<3}var ut=[];for(le=1;ut.length<B+W;)switch(Qe=et[Le(I,q)],q+=Qe&7,Qe>>>=3){case 16:for(Y=3+$e(I,q),q+=2,Qe=ut[ut.length-1];Y-- >0;)ut.push(Qe);break;case 17:for(Y=3+Me(I,q),q+=3;Y-- >0;)ut.push(0);break;case 18:for(Y=11+Le(I,q),q+=7;Y-- >0;)ut.push(0);break;default:ut.push(Qe),le<Qe&&(le=Qe);break}var ni=ut.slice(0,B),ai=ut.slice(B);for(ze=B;ze<286;++ze)ni[ze]=0;for(ze=W;ze<30;++ze)ai[ze]=0;return At=Ni(ni,Ee,286),qt=Ni(ai,ke,30),q}function lr(I,q){if(I[0]==3&&!(I[1]&3))return[Dn(q),2];for(var B=0,W=0,G=_0(q||1<<18),Y=0,ce=G.length>>>0,he=0,le=0;!(W&1);){if(W=Me(I,B),B+=3,W>>>1)W>>1==1?(he=9,le=5):(B=or(I,B),he=At,le=qt);else{B&7&&(B+=8-(B&7));var ve=I[B>>>3]|I[(B>>>3)+1]<<8;if(B+=32,ve>0)for(!q&&ce<Y+ve&&(G=xi(G,Y+ve),ce=G.length);ve-- >0;)G[Y++]=I[B>>>3],B+=8;continue}for(;;){!q&&ce<Y+32767&&(G=xi(G,Y+32767),ce=G.length);var be=Ct(I,B,he),Ie=W>>>1==1?Di[be]:Ee[be];if(B+=Ie&15,Ie>>>=4,!(Ie>>>8&255))G[Y++]=Ie;else{if(Ie==256)break;Ie-=257;var ze=Ie<8?0:Ie-4>>2;ze>5&&(ze=0);var Qe=Y+U[Ie];ze>0&&(Qe+=Ct(I,B,ze),B+=ze),be=Ct(I,B,le),Ie=W>>>1==1?F[be]:ke[be],B+=Ie&15,Ie>>>=4;var Fe=Ie<4?0:Ie-2>>1,Xe=se[Ie];for(Fe>0&&(Xe+=Ct(I,B,Fe),B+=Fe),!q&&ce<Qe&&(G=xi(G,Qe+100),ce=G.length);Y<Qe;)G[Y]=G[Y-Xe],++Y}}}return q?[G,B+7>>>3]:[G.slice(0,Y),B+7>>>3]}function Hn(I,q){var B=I.slice(I.l||0),W=lr(B,q);return I.l+=W[1],W[0]}function Vn(I,q){if(I)typeof console<"u"&&console.error(q);else throw new Error(q)}function Ba(I,q){var B=I;$i(B,0);var W=[],G=[],Y={FileIndex:W,FullPaths:G};E(Y,{root:q.root});for(var ce=B.length-4;(B[ce]!=80||B[ce+1]!=75||B[ce+2]!=5||B[ce+3]!=6)&&ce>=0;)--ce;B.l=ce+4,B.l+=4;var he=B.read_shift(2);B.l+=6;var le=B.read_shift(4);for(B.l=le,ce=0;ce<he;++ce){B.l+=20;var ve=B.read_shift(4),be=B.read_shift(4),Ie=B.read_shift(2),ze=B.read_shift(2),Qe=B.read_shift(2);B.l+=8;var Fe=B.read_shift(4),Xe=o(B.slice(B.l+Ie,B.l+Ie+ze));B.l+=Ie+ze+Qe;var ut=B.l;B.l=Fe+4,Wn(B,ve,be,Y,Xe),B.l=ut}return Y}function Wn(I,q,B,W,G){I.l+=2;var Y=I.read_shift(2),ce=I.read_shift(2),he=a(I);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var le=I.read_shift(4),ve=I.read_shift(4),be=I.read_shift(4),Ie=I.read_shift(2),ze=I.read_shift(2),Qe="",Fe=0;Fe<Ie;++Fe)Qe+=String.fromCharCode(I[I.l++]);if(ze){var Xe=o(I.slice(I.l,I.l+ze));(Xe[21589]||{}).mt&&(he=Xe[21589].mt),((G||{})[21589]||{}).mt&&(he=G[21589].mt)}I.l+=ze;var ut=I.slice(I.l,I.l+ve);switch(ce){case 8:ut=H(I,be);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var ni=!1;Y&8&&(le=I.read_shift(4),le==134695760&&(le=I.read_shift(4),ni=!0),ve=I.read_shift(4),be=I.read_shift(4)),ve!=q&&Vn(ni,"Bad compressed size: "+q+" != "+ve),be!=B&&Vn(ni,"Bad uncompressed size: "+B+" != "+be),Va(W,Qe,ut,{unsafe:!0,mt:he})}function yf(I,q){var B=q||{},W=[],G=[],Y=Ce(1),ce=B.compression?8:0,he=0,le=0,ve=0,be=0,Ie=0,ze=I.FullPaths[0],Qe=ze,Fe=I.FileIndex[0],Xe=[],ut=0;for(le=1;le<I.FullPaths.length;++le)if(Qe=I.FullPaths[le].slice(ze.length),Fe=I.FileIndex[le],!(!Fe.size||!Fe.content||Qe=="Sh33tJ5")){var ni=be,ai=Ce(Qe.length);for(ve=0;ve<Qe.length;++ve)ai.write_shift(1,Qe.charCodeAt(ve)&127);ai=ai.slice(0,ai.l),Xe[Ie]=RA.buf(Fe.content,0);var Xi=Fe.content;ce==8&&(Xi=L(Xi)),Y=Ce(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,he),Y.write_shift(2,ce),Fe.mt?n(Y,Fe.mt):Y.write_shift(4,0),Y.write_shift(-4,Xe[Ie]),Y.write_shift(4,Xi.length),Y.write_shift(4,Fe.content.length),Y.write_shift(2,ai.length),Y.write_shift(2,0),be+=Y.length,W.push(Y),be+=ai.length,W.push(ai),be+=Xi.length,W.push(Xi),Y=Ce(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,he),Y.write_shift(2,ce),Y.write_shift(4,0),Y.write_shift(-4,Xe[Ie]),Y.write_shift(4,Xi.length),Y.write_shift(4,Fe.content.length),Y.write_shift(2,ai.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,ni),ut+=Y.l,G.push(Y),ut+=ai.length,G.push(ai),++Ie}return Y=Ce(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,Ie),Y.write_shift(2,Ie),Y.write_shift(4,ut),Y.write_shift(4,be),Y.write_shift(2,0),Hi([Hi(W),Hi(G),Y])}var Ha={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Mh(I,q){if(I.ctype)return I.ctype;var B=I.name||"",W=B.match(/\.([^\.]+)$/);return W&&Ha[W[1]]||q&&(W=(B=q).match(/[\.\\]([^\.\\])+$/),W&&Ha[W[1]])?Ha[W[1]]:"application/octet-stream"}function Ph(I){for(var q=Jl(I),B=[],W=0;W<q.length;W+=76)B.push(q.slice(W,W+76));return B.join("\r\n")+"\r\n"}function Bh(I){var q=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ve){var be=ve.charCodeAt(0).toString(16).toUpperCase();return"="+(be.length==1?"0"+be:be)});q=q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),q.charAt(0)=="\n"&&(q="=0D"+q.slice(1)),q=q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,"\n=0A").replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],W=q.split("\r\n"),G=0;G<W.length;++G){var Y=W[G];if(Y.length==0){B.push("");continue}for(var ce=0;ce<Y.length;){var he=76,le=Y.slice(ce,ce+he);le.charAt(he-1)=="="?he--:le.charAt(he-2)=="="?he-=2:le.charAt(he-3)=="="&&(he-=3),le=Y.slice(ce,ce+he),ce+=he,ce<Y.length&&(le+="="),B.push(le)}}return B.join("\r\n")}function Hh(I){for(var q=[],B=0;B<I.length;++B){for(var W=I[B];B<=I.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+I[++B];q.push(W)}for(var G=0;G<q.length;++G)q[G]=q[G].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return Vr(q.join("\r\n"))}function Vh(I,q,B){for(var W="",G="",Y="",ce,he=0;he<10;++he){var le=q[he];if(!le||le.match(/^\s*$/))break;var ve=le.match(/^(.*?):\s*([^\s].*)$/);if(ve)switch(ve[1].toLowerCase()){case"content-location":W=ve[2].trim();break;case"content-type":Y=ve[2].trim();break;case"content-transfer-encoding":G=ve[2].trim();break}}switch(++he,G.toLowerCase()){case"base64":ce=Vr(qr(q.slice(he).join("")));break;case"quoted-printable":ce=Hh(q.slice(he));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var be=Va(I,W.slice(B.length),ce,{unsafe:!0});Y&&(be.ctype=Y)}function Wh(I,q){if(j(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=q&&q.root||"",W=(vt&&Buffer.isBuffer(I)?I.toString("binary"):j(I)).split("\r\n"),G=0,Y="";for(G=0;G<W.length;++G)if(Y=W[G],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),B||(B=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),Y.slice(0,B.length)!=B););var ce=(W[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var he="--"+(ce[1]||""),le=[],ve=[],be={FileIndex:le,FullPaths:ve};E(be);var Ie,ze=0;for(G=0;G<W.length;++G){var Qe=W[G];Qe!==he&&Qe!==he+"--"||(ze++&&Vh(be,W.slice(Ie,G),B),Ie=G)}return be}function zh(I,q){var B=q||{},W=B.boundary||"SheetJS";W="------="+W;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],Y=I.FullPaths[0],ce=Y,he=I.FileIndex[0],le=1;le<I.FullPaths.length;++le)if(ce=I.FullPaths[le].slice(Y.length),he=I.FileIndex[le],!(!he.size||!he.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ut){return"_x"+ut.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ut){return"_u"+ut.charCodeAt(0).toString(16)+"_"});for(var ve=he.content,be=vt&&Buffer.isBuffer(ve)?ve.toString("binary"):j(ve),Ie=0,ze=Math.min(1024,be.length),Qe=0,Fe=0;Fe<=ze;++Fe)(Qe=be.charCodeAt(Fe))>=32&&Qe<128&&++Ie;var Xe=Ie>=ze*4/5;G.push(W),G.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+ce),G.push("Content-Transfer-Encoding: "+(Xe?"quoted-printable":"base64")),G.push("Content-Type: "+Mh(he,ce)),G.push(""),G.push(Xe?Bh(be):Ph(be))}return G.push(W+"--\r\n"),G.join("\r\n")}function jh(I){var q={};return E(q,I),q}function Va(I,q,B,W){var G=W&&W.unsafe;G||E(I);var Y=!G&&rt.find(I,q);if(!Y){var ce=I.FullPaths[0];q.slice(0,ce.length)==ce?ce=q:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+q).replace("//","/")),Y={name:r(q),type:2},I.FileIndex.push(Y),I.FullPaths.push(ce),G||rt.utils.cfb_gc(I)}return Y.content=B,Y.size=B?B.length:0,W&&(W.CLSID&&(Y.clsid=W.CLSID),W.mt&&(Y.mt=W.mt),W.ct&&(Y.ct=W.ct)),Y}function Uh(I,q){E(I);var B=rt.find(I,q);if(B){for(var W=0;W<I.FileIndex.length;++W)if(I.FileIndex[W]==B)return I.FileIndex.splice(W,1),I.FullPaths.splice(W,1),!0}return!1}function $h(I,q,B){E(I);var W=rt.find(I,q);if(W){for(var G=0;G<I.FileIndex.length;++G)if(I.FileIndex[G]==W)return I.FileIndex[G].name=r(B),I.FullPaths[G]=B,!0}return!1}function qh(I){A(I,!0)}return t.find=D,t.read=S,t.parse=u,t.write=de,t.writeFile=re,t.utils={cfb_new:jh,cfb_add:Va,cfb_del:Uh,cfb_mov:$h,cfb_gc:qh,ReadShift:_l,CheckField:Lx,prep_blob:$i,bconcat:Hi,use_zlib:N,_deflateRaw:ge,_inflateRaw:Hn,consts:J},t}();let Tn;function IA(s){Tn=s}function _A(s){return typeof s=="string"?mh(s):Array.isArray(s)?sA(s):s}function gh(s,t,e){if(typeof Tn<"u"&&Tn.writeFileSync)return e?Tn.writeFileSync(s,t,e):Tn.writeFileSync(s,t);if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=mh(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(s,t)}var i=e=="utf8"?Rs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,s);if(typeof Blob<"u"){var r=new Blob([_A(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,s);if(typeof saveAs<"u")return saveAs(r,s);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:s,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=s,a.href=n,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(s);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Nn(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+s)}function FA(s){if(typeof Tn<"u")return Tn.readFileSync(s);if(typeof Deno<"u")return Deno.readFileSync(s);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(s);t.open("r"),t.encoding="binary";var e=t.read();return t.close(),e}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+s)}function mi(s){for(var t=Object.keys(s),e=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(s,t[i])&&e.push(t[i]);return e}function W0(s,t){for(var e=[],i=mi(s),r=0;r!==i.length;++r)e[s[i[r]][t]]==null&&(e[s[i[r]][t]]=i[r]);return e}function Pc(s){for(var t=[],e=mi(s),i=0;i!==e.length;++i)t[s[e[i]]]=e[i];return t}function Bc(s){for(var t=[],e=mi(s),i=0;i!==e.length;++i)t[s[e[i]]]=parseInt(e[i],10);return t}function NA(s){for(var t=[],e=mi(s),i=0;i!==e.length;++i)t[s[e[i]]]==null&&(t[s[e[i]]]=[]),t[s[e[i]]].push(e[i]);return t}var rc=new Date(1899,11,30,0,0,0);function Fi(s,t){var e=s.getTime(),i=rc.getTime()+(s.getTimezoneOffset()-rc.getTimezoneOffset())*6e4;return(e-i)/(24*60*60*1e3)}var dx=new Date,MA=rc.getTime()+(dx.getTimezoneOffset()-rc.getTimezoneOffset())*6e4,z0=dx.getTimezoneOffset();function Hc(s){var t=new Date;return t.setTime(s*24*60*60*1e3+MA),t.getTimezoneOffset()!==z0&&t.setTime(t.getTime()+(t.getTimezoneOffset()-z0)*6e4),t}function PA(s){var t=0,e=0,i=!1,r=s.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+s+"| is not an ISO8601 Duration");for(var n=1;n!=r.length;++n)if(r[n]){switch(e=1,n>3&&(i=!0),r[n].slice(r[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[n].slice(r[n].length-1));case"D":e*=24;case"H":e*=60;case"M":if(i)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=e*parseInt(r[n],10)}return t}var j0=new Date("2017-02-19T19:06:09.000Z"),px=isNaN(j0.getFullYear())?new Date("2/19/17"):j0,BA=px.getFullYear()==2017;function ti(s,t){var e=new Date(s);if(BA)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(s instanceof Date)return s;if(px.getFullYear()==1917&&!isNaN(e.getFullYear())){var i=e.getFullYear();return s.indexOf(""+i)>-1||e.setFullYear(e.getFullYear()+100),e}var r=s.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return s.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function ya(s,t){if(vt&&Buffer.isBuffer(s)){if(t){if(s[0]==255&&s[1]==254)return Rs(s.slice(2).toString("utf16le"));if(s[1]==254&&s[2]==255)return Rs(ex(s.slice(2).toString("binary")))}return s.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(s[0]==255&&s[1]==254)return Rs(new TextDecoder("utf-16le").decode(s.slice(2)));if(s[0]==254&&s[1]==255)return Rs(new TextDecoder("utf-16be").decode(s.slice(2)))}var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(s)&&(s=new Uint8Array(s)),new TextDecoder("latin1").decode(s).replace(/[]/g,function(n){return e[n]||n})}catch(n){}for(var i=[],r=0;r!=s.length;++r)i.push(String.fromCharCode(s[r]));return i.join("")}function Ut(s){if(typeof JSON<"u"&&!Array.isArray(s))return JSON.parse(JSON.stringify(s));if(typeof s!="object"||s==null)return s;if(s instanceof Date)return new Date(s.getTime());var t={};for(var e in s)Object.prototype.hasOwnProperty.call(s,e)&&(t[e]=Ut(s[e]));return t}function ci(s,t){for(var e="";e.length<t;)e+=s;return e}function Es(s){var t=Number(s);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(s))return t;var e=1,i=s.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(i))||(i=i.replace(/[(](.*)[)]/,function(r,n){return e=-e,n}),!isNaN(t=Number(i)))?t/e:t}var HA=["january","february","march","april","may","june","july","august","september","october","november","december"];function To(s){var t=new Date(s),e=new Date(NaN),i=t.getYear(),r=t.getMonth(),n=t.getDate();if(isNaN(n))return e;var a=s.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&HA.indexOf(a)==-1)return e}else if(a.match(/[a-z]/))return e;return i<0||i>8099?e:(r>0||n>1)&&i!=101?t:s.match(/[^-0-9:,\/\\]/)?e:t}var VA=function(){var s="abacaba".split(/(:?b)/i).length==5;return function(e,i,r){if(s||typeof i=="string")return e.split(i);for(var n=e.split(i),a=[n[0]],o=1;o<n.length;++o)a.push(r),a.push(n[o]);return a}}();function mx(s){return s?s.content&&s.type?ya(s.content,!0):s.data?ao(s.data):s.asNodeBuffer&&vt?ao(s.asNodeBuffer().toString("binary")):s.asBinary?ao(s.asBinary()):s._data&&s._data.getContent?ao(ya(Array.prototype.slice.call(s._data.getContent(),0))):null:null}function vx(s){if(!s)return null;if(s.data)return Zu(s.data);if(s.asNodeBuffer&&vt)return s.asNodeBuffer();if(s._data&&s._data.getContent){var t=s._data.getContent();return typeof t=="string"?Zu(t):Array.prototype.slice.call(t)}return s.content&&s.type?s.content:null}function WA(s){return s&&s.name.slice(-4)===".bin"?vx(s):mx(s)}function rs(s,t){for(var e=s.FullPaths||mi(s.files),i=t.toLowerCase().replace(/[\/]/g,"\\"),r=i.replace(/\\/g,"/"),n=0;n<e.length;++n){var a=e[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==a||r==a)return s.files?s.files[e[n]]:s.FileIndex[n]}return null}function ym(s,t){var e=rs(s,t);if(e==null)throw new Error("Cannot find file "+t+" in zip");return e}function Ti(s,t,e){if(!e)return WA(ym(s,t));if(!t)return null;try{return Ti(s,t)}catch(i){return null}}function Wr(s,t,e){if(!e)return mx(ym(s,t));if(!t)return null;try{return Wr(s,t)}catch(i){return null}}function zA(s,t,e){return vx(ym(s,t))}function U0(s){for(var t=s.FullPaths||mi(s.files),e=[],i=0;i<t.length;++i)t[i].slice(-1)!="/"&&e.push(t[i].replace(/^Root Entry[\/]/,""));return e.sort()}function ft(s,t,e){if(s.FullPaths){if(typeof e=="string"){var i;return vt?i=nn(e):i=nA(e),rt.utils.cfb_add(s,t,i)}rt.utils.cfb_add(s,t,e)}else s.file(t,e)}function xm(){return rt.utils.cfb_new()}function gx(s,t){switch(t.type){case"base64":return rt.read(s,{type:"base64"});case"binary":return rt.read(s,{type:"binary"});case"buffer":case"array":return rt.read(s,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function kl(s,t){if(s.charAt(0)=="/")return s.slice(1);var e=t.split("/");t.slice(-1)!="/"&&e.pop();for(var i=s.split("/");i.length!==0;){var r=i.shift();r===".."?e.pop():r!=="."&&e.push(r)}return e.join("/")}var yi='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',jA=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,$0=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,UA=/<[^>]*>/g,nr=yi.match($0)?$0:UA,$A=/<\w*:/,qA=/<(\/?)\w+:/;function lt(s,t,e){for(var i={},r=0,n=0;r!==s.length&&!((n=s.charCodeAt(r))===32||n===10||n===13);++r);if(t||(i[0]=s.slice(0,r)),r===s.length)return i;var a=s.match(jA),o=0,l="",h=0,u="",c="",f=1;if(a)for(h=0;h!=a.length;++h){for(c=a[h],n=0;n!=c.length&&c.charCodeAt(n)!==61;++n);for(u=c.slice(0,n).trim();c.charCodeAt(n+1)==32;)++n;for(f=(r=c.charCodeAt(n+1))==34||r==39?1:0,l=c.slice(n+1+f,c.length-f),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),i[u]=l,i[u.toLowerCase()]=l;else{var d=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(i[d]&&u.slice(o-3,o)=="ext")continue;i[d]=l,i[d.toLowerCase()]=l}}return i}function Bs(s){return s.replace(qA,"<$1")}var bx={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Cm=Pc(bx),Dt=function(){var s=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function e(i){var r=i+"",n=r.indexOf("<![CDATA[");if(n==-1)return r.replace(s,function(o,l){return bx[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=r.indexOf("]]>");return e(r.slice(0,n))+r.slice(n+9,a)+e(r.slice(a+3))}}(),wm=/[&<>'"]/g,GA=/[\u0000-\u0008\u000b-\u001f]/g;function Pt(s){var t=s+"";return t.replace(wm,function(e){return Cm[e]}).replace(GA,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function q0(s){return Pt(s).replace(/ /g,"_x0020_")}var yx=/[\u0000-\u001f]/g;function Em(s){var t=s+"";return t.replace(wm,function(e){return Cm[e]}).replace(/\n/g,"<br/>").replace(yx,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function XA(s){var t=s+"";return t.replace(wm,function(e){return Cm[e]}).replace(yx,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var G0=function(){var s=/&#(\d+);/g;function t(e,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(s,t)}}();function KA(s){return s.replace(/(\r\n|[\r\n])/g,"&#10;")}function Zt(s){switch(s){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function kf(s){for(var t="",e=0,i=0,r=0,n=0,a=0,o=0;e<s.length;){if(i=s.charCodeAt(e++),i<128){t+=String.fromCharCode(i);continue}if(r=s.charCodeAt(e++),i>191&&i<224){a=(i&31)<<6,a|=r&63,t+=String.fromCharCode(a);continue}if(n=s.charCodeAt(e++),i<240){t+=String.fromCharCode((i&15)<<12|(r&63)<<6|n&63);continue}a=s.charCodeAt(e++),o=((i&7)<<18|(r&63)<<12|(n&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function X0(s){var t=Dn(2*s.length),e,i,r=1,n=0,a=0,o;for(i=0;i<s.length;i+=r)r=1,(o=s.charCodeAt(i))<128?e=o:o<224?(e=(o&31)*64+(s.charCodeAt(i+1)&63),r=2):o<240?(e=(o&15)*4096+(s.charCodeAt(i+1)&63)*64+(s.charCodeAt(i+2)&63),r=3):(r=4,e=(o&7)*262144+(s.charCodeAt(i+1)&63)*4096+(s.charCodeAt(i+2)&63)*64+(s.charCodeAt(i+3)&63),e-=65536,a=55296+(e>>>10&1023),e=56320+(e&1023)),a!==0&&(t[n++]=a&255,t[n++]=a>>>8,a=0),t[n++]=e%256,t[n++]=e>>>8;return t.slice(0,n).toString("ucs2")}function K0(s){return nn(s,"binary").toString("utf8")}var tu="foo bar baz",Ht=vt&&(K0(tu)==kf(tu)&&K0||X0(tu)==kf(tu)&&X0)||kf,Rs=vt?function(s){return nn(s,"utf8").toString("binary")}:function(s){for(var t=[],e=0,i=0,r=0;e<s.length;)switch(i=s.charCodeAt(e++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,r=s.charCodeAt(e++)-56320+(i<<10),t.push(String.fromCharCode(240+(r>>18&7))),t.push(String.fromCharCode(144+(r>>12&63))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)))}return t.join("")},Zl=function(){var s={};return function(e,i){var r=e+"|"+(i||"");return s[r]?s[r]:s[r]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",i||"")}}(),xx=function(){var s=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<s.length;++r)i=i.replace(s[r][0],s[r][1]);return i}}(),YA=function(){var s={};return function(e){return s[e]!==void 0?s[e]:s[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),JA=/<\/?(?:vt:)?variant>/g,QA=/<(?:vt:)([^>]*)>([\s\S]*)</;function Y0(s,t){var e=lt(s),i=s.match(YA(e.baseType))||[],r=[];if(i.length!=e.size){if(t.WTF)throw new Error("unexpected vector length "+i.length+" != "+e.size);return r}return i.forEach(function(n){var a=n.replace(JA,"").match(QA);a&&r.push({v:Ht(a[2]),t:a[1]})}),r}var Cx=/(^\s|\s$|\n)/;function qi(s,t){return"<"+s+(t.match(Cx)?' xml:space="preserve"':"")+">"+t+"</"+s+">"}function eh(s){return mi(s).map(function(t){return" "+t+'="'+s[t]+'"'}).join("")}function Be(s,t,e){return"<"+s+(e!=null?eh(e):"")+(t!=null?(t.match(Cx)?' xml:space="preserve"':"")+">"+t+"</"+s:"/")+">"}function Jd(s,t){try{return s.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function ZA(s,t){switch(typeof s){case"string":var e=Be("vt:lpwstr",Pt(s));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return Be((s|0)==s?"vt:i4":"vt:r8",Pt(String(s)));case"boolean":return Be("vt:bool",s?"true":"false")}if(s instanceof Date)return Be("vt:filetime",Jd(s));throw new Error("Unable to serialize "+s)}function Sm(s){if(vt&&Buffer.isBuffer(s))return s.toString("utf8");if(typeof s=="string")return s;if(typeof Uint8Array<"u"&&s instanceof Uint8Array)return Ht(Nn(vm(s)));throw new Error("Bad input format: expected Buffer or string")}var th=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,_i={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Oa=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Hr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function eO(s,t){for(var e=1-2*(s[t+7]>>>7),i=((s[t+7]&127)<<4)+(s[t+6]>>>4&15),r=s[t+6]&15,n=5;n>=0;--n)r=r*256+s[t+n];return i==2047?r==0?e*(1/0):NaN:(i==0?i=-1022:(i-=1023,r+=Math.pow(2,52)),e*Math.pow(2,i-52)*r)}function tO(s,t,e){var i=(t<0||1/t==-1/0?1:0)<<7,r=0,n=0,a=i?-t:t;isFinite(a)?a==0?r=n=0:(r=Math.floor(Math.log(a)/Math.LN2),n=a*Math.pow(2,52-r),r<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?r=-1022:(n-=Math.pow(2,52),r+=1023)):(r=2047,n=isNaN(t)?26985:0);for(var o=0;o<=5;++o,n/=256)s[e+o]=n&255;s[e+6]=(r&15)<<4|n&15,s[e+7]=r>>4|i}var J0=function(s){for(var t=[],e=10240,i=0;i<s[0].length;++i)if(s[0][i])for(var r=0,n=s[0][i].length;r<n;r+=e)t.push.apply(t,s[0][i].slice(r,r+e));return t},Q0=vt?function(s){return s[0].length>0&&Buffer.isBuffer(s[0][0])?Buffer.concat(s[0].map(function(t){return Buffer.isBuffer(t)?t:nn(t)})):J0(s)}:J0,Z0=function(s,t,e){for(var i=[],r=t;r<e;r+=2)i.push(String.fromCharCode(Js(s,r)));return i.join("").replace(ir,"")},Vc=vt?function(s,t,e){return Buffer.isBuffer(s)?s.toString("utf16le",t,e).replace(ir,""):Z0(s,t,e)}:Z0,eg=function(s,t,e){for(var i=[],r=t;r<t+e;++r)i.push(("0"+s[r].toString(16)).slice(-2));return i.join("")},wx=vt?function(s,t,e){return Buffer.isBuffer(s)?s.toString("hex",t,t+e):eg(s,t,e)}:eg,tg=function(s,t,e){for(var i=[],r=t;r<e;r++)i.push(String.fromCharCode(ro(s,r)));return i.join("")},No=vt?function(t,e,i){return Buffer.isBuffer(t)?t.toString("utf8",e,i):tg(t,e,i)}:tg,Ex=function(s,t){var e=Bi(s,t);return e>0?No(s,t+4,t+4+e-1):""},km=Ex,Sx=function(s,t){var e=Bi(s,t);return e>0?No(s,t+4,t+4+e-1):""},Tm=Sx,kx=function(s,t){var e=2*Bi(s,t);return e>0?No(s,t+4,t+4+e-1):""},Am=kx,Tx=function(t,e){var i=Bi(t,e);return i>0?Vc(t,e+4,e+4+i):""},Om=Tx,Ax=function(s,t){var e=Bi(s,t);return e>0?No(s,t+4,t+4+e):""},Dm=Ax,Ox=function(s,t){return eO(s,t)},sc=Ox,Lm=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};vt&&(km=function(t,e){if(!Buffer.isBuffer(t))return Ex(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},Tm=function(t,e){if(!Buffer.isBuffer(t))return Sx(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},Am=function(t,e){if(!Buffer.isBuffer(t))return kx(t,e);var i=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i-1)},Om=function(t,e){if(!Buffer.isBuffer(t))return Tx(t,e);var i=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i)},Dm=function(t,e){if(!Buffer.isBuffer(t))return Ax(t,e);var i=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+i)},sc=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):Ox(t,e)},Lm=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function Dx(){Vc=function(s,t,e){return kt.utils.decode(1200,s.slice(t,e)).replace(ir,"")},No=function(s,t,e){return kt.utils.decode(65001,s.slice(t,e))},km=function(s,t){var e=Bi(s,t);return e>0?kt.utils.decode(ga,s.slice(t+4,t+4+e-1)):""},Tm=function(s,t){var e=Bi(s,t);return e>0?kt.utils.decode(jr,s.slice(t+4,t+4+e-1)):""},Am=function(s,t){var e=2*Bi(s,t);return e>0?kt.utils.decode(1200,s.slice(t+4,t+4+e-1)):""},Om=function(s,t){var e=Bi(s,t);return e>0?kt.utils.decode(1200,s.slice(t+4,t+4+e)):""},Dm=function(s,t){var e=Bi(s,t);return e>0?kt.utils.decode(65001,s.slice(t+4,t+4+e)):""}}typeof kt<"u"&&Dx();var ro=function(s,t){return s[t]},Js=function(s,t){return s[t+1]*256+s[t]},iO=function(s,t){var e=s[t+1]*256+s[t];return e<32768?e:(65535-e+1)*-1},Bi=function(s,t){return s[t+3]*(1<<24)+(s[t+2]<<16)+(s[t+1]<<8)+s[t]},ra=function(s,t){return s[t+3]<<24|s[t+2]<<16|s[t+1]<<8|s[t]},rO=function(s,t){return s[t]<<24|s[t+1]<<16|s[t+2]<<8|s[t+3]};function _l(s,t){var e="",i,r,n=[],a,o,l,h;switch(t){case"dbcs":if(h=this.l,vt&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*s).toString("utf16le");else for(l=0;l<s;++l)e+=String.fromCharCode(Js(this,h)),h+=2;s*=2;break;case"utf8":e=No(this,this.l,this.l+s);break;case"utf16le":s*=2,e=Vc(this,this.l,this.l+s);break;case"wstr":if(typeof kt<"u")e=kt.utils.decode(jr,this.slice(this.l,this.l+2*s));else return _l.call(this,s,"dbcs");s=2*s;break;case"lpstr-ansi":e=km(this,this.l),s=4+Bi(this,this.l);break;case"lpstr-cp":e=Tm(this,this.l),s=4+Bi(this,this.l);break;case"lpwstr":e=Am(this,this.l),s=4+2*Bi(this,this.l);break;case"lpp4":s=4+Bi(this,this.l),e=Om(this,this.l),s&2&&(s+=2);break;case"8lpp4":s=4+Bi(this,this.l),e=Dm(this,this.l),s&3&&(s+=4-(s&3));break;case"cstr":for(s=0,e="";(a=ro(this,this.l+s++))!==0;)n.push(El(a));e=n.join("");break;case"_wstr":for(s=0,e="";(a=Js(this,this.l+s))!==0;)n.push(El(a)),s+=2;s+=2,e=n.join("");break;case"dbcs-cont":for(e="",h=this.l,l=0;l<s;++l){if(this.lens&&this.lens.indexOf(h)!==-1)return a=ro(this,h),this.l=h+1,o=_l.call(this,s-l,a?"dbcs-cont":"sbcs-cont"),n.join("")+o;n.push(El(Js(this,h))),h+=2}e=n.join(""),s*=2;break;case"cpstr":if(typeof kt<"u"){e=kt.utils.decode(jr,this.slice(this.l,this.l+s));break}case"sbcs-cont":for(e="",h=this.l,l=0;l!=s;++l){if(this.lens&&this.lens.indexOf(h)!==-1)return a=ro(this,h),this.l=h+1,o=_l.call(this,s-l,a?"dbcs-cont":"sbcs-cont"),n.join("")+o;n.push(El(ro(this,h))),h+=1}e=n.join("");break;default:switch(s){case 1:return i=ro(this,this.l),this.l++,i;case 2:return i=(t==="i"?iO:Js)(this,this.l),this.l+=2,i;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(i=(s>0?ra:rO)(this,this.l),this.l+=4,i):(r=Bi(this,this.l),this.l+=4,r);case 8:case-8:if(t==="f")return s==8?r=sc(this,this.l):r=sc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;s=8;case 16:e=wx(this,this.l,s);break}}return this.l+=s,e}var sO=function(s,t,e){s[e]=t&255,s[e+1]=t>>>8&255,s[e+2]=t>>>16&255,s[e+3]=t>>>24&255},nO=function(s,t,e){s[e]=t&255,s[e+1]=t>>8&255,s[e+2]=t>>16&255,s[e+3]=t>>24&255},aO=function(s,t,e){s[e]=t&255,s[e+1]=t>>>8&255};function oO(s,t,e){var i=0,r=0;if(e==="dbcs"){for(r=0;r!=t.length;++r)aO(this,t.charCodeAt(r),this.l+2*r);i=2*t.length}else if(e==="sbcs"){if(typeof kt<"u"&&ga==874)for(r=0;r!=t.length;++r){var n=kt.utils.encode(ga,t.charAt(r));this[this.l+r]=n[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=t.charCodeAt(r)&255;i=t.length}else if(e==="hex"){for(;r<s;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}else if(e==="utf16le"){var a=Math.min(this.l+s,this.length);for(r=0;r<Math.min(t.length,s);++r){var o=t.charCodeAt(r);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(s){case 1:i=1,this[this.l]=t&255;break;case 2:i=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:i=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:i=4,sO(this,t,this.l);break;case 8:if(i=8,e==="f"){tO(this,t,this.l);break}case 16:break;case-4:i=4,nO(this,t,this.l);break}return this.l+=i,this}function Lx(s,t){var e=wx(this,this.l,s.length>>1);if(e!==s)throw new Error(t+"Expected "+s+" saw "+e);this.l+=s.length>>1}function $i(s,t){s.l=t,s.read_shift=_l,s.chk=Lx,s.write_shift=oO}function sr(s,t){s.l+=t}function Ce(s){var t=Dn(s);return $i(t,0),t}function an(s,t,e){if(s){var i,r,n;$i(s,s.l||0);for(var a=s.length,o=0,l=0;s.l<a;){o=s.read_shift(1),o&128&&(o=(o&127)+((s.read_shift(1)&127)<<7));var h=oh[o]||oh[65535];for(i=s.read_shift(1),n=i&127,r=1;r<4&&i&128;++r)n+=((i=s.read_shift(1))&127)<<7*r;l=s.l+n;var u=h.f&&h.f(s,n,e);if(s.l=l,t(u,h,o))return}}}function Dr(){var s=[],t=vt?256:2048,e=function(h){var u=Ce(h);return $i(u,0),u},i=e(t),r=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&s.push(i),i=null)},n=function(h){return i&&h<i.length-i.l?i:(r(),i=e(Math.max(h+1,t)))},a=function(){return r(),Hi(s)},o=function(h){r(),i=h,i.l==null&&(i.l=i.length),n(t)};return{next:n,push:o,end:a,_bufs:s}}function De(s,t,e,i){var r=+t,n;if(!isNaN(r)){i||(i=oh[r].p||(e||[]).length||0),n=1+(r>=128?1:0)+1,i>=128&&++n,i>=16384&&++n,i>=2097152&&++n;var a=s.next(n);r<=127?a.write_shift(1,r):(a.write_shift(1,(r&127)+128),a.write_shift(1,r>>7));for(var o=0;o!=4;++o)if(i>=128)a.write_shift(1,(i&127)+128),i>>=7;else{a.write_shift(1,i);break}i>0&&Lm(e)&&s.push(e)}}function Fl(s,t,e){var i=Ut(s);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!e||e.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function ig(s,t,e){var i=Ut(s);return i.s=Fl(i.s,t.s,e),i.e=Fl(i.e,t.s,e),i}function Nl(s,t){if(s.cRel&&s.c<0)for(s=Ut(s);s.c<0;)s.c+=t>8?16384:256;if(s.rRel&&s.r<0)for(s=Ut(s);s.r<0;)s.r+=t>8?1048576:t>5?65536:16384;var e=ot(s);return!s.cRel&&s.cRel!=null&&(e=uO(e)),!s.rRel&&s.rRel!=null&&(e=lO(e)),e}function Tf(s,t){return s.s.r==0&&!s.s.rRel&&s.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!s.e.rRel?(s.s.cRel?"":"$")+ei(s.s.c)+":"+(s.e.cRel?"":"$")+ei(s.e.c):s.s.c==0&&!s.s.cRel&&s.e.c==(t.biff>=12?16383:255)&&!s.e.cRel?(s.s.rRel?"":"$")+di(s.s.r)+":"+(s.e.rRel?"":"$")+di(s.e.r):Nl(s.s,t.biff)+":"+Nl(s.e,t.biff)}function Rm(s){return parseInt(hO(s),10)-1}function di(s){return""+(s+1)}function lO(s){return s.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function hO(s){return s.replace(/\$(\d+)$/,"$1")}function Im(s){for(var t=cO(s),e=0,i=0;i!==t.length;++i)e=26*e+t.charCodeAt(i)-64;return e-1}function ei(s){if(s<0)throw new Error("invalid column "+s);var t="";for(++s;s;s=Math.floor((s-1)/26))t=String.fromCharCode((s-1)%26+65)+t;return t}function uO(s){return s.replace(/^([A-Z])/,"$$$1")}function cO(s){return s.replace(/^\$([A-Z])/,"$1")}function fO(s){return s.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function oi(s){for(var t=0,e=0,i=0;i<s.length;++i){var r=s.charCodeAt(i);r>=48&&r<=57?t=10*t+(r-48):r>=65&&r<=90&&(e=26*e+(r-64))}return{c:e-1,r:t-1}}function ot(s){for(var t=s.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(s.r+1)}function yr(s){var t=s.indexOf(":");return t==-1?{s:oi(s),e:oi(s)}:{s:oi(s.slice(0,t)),e:oi(s.slice(t+1))}}function ct(s,t){return typeof t>"u"||typeof t=="number"?ct(s.s,s.e):(typeof s!="string"&&(s=ot(s)),typeof t!="string"&&(t=ot(t)),s==t?s:s+":"+t)}function Et(s){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,i=0,r=0,n=s.length;for(e=0;i<n&&!((r=s.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(t.s.c=--e,e=0;i<n&&!((r=s.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;if(t.s.r=--e,i===n||r!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,e=0;i!=n&&!((r=s.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(t.e.c=--e,e=0;i!=n&&!((r=s.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;return t.e.r=--e,t}function rg(s,t){var e=s.t=="d"&&t instanceof Date;if(s.z!=null)try{return s.w=Gr(s.z,e?Fi(t):t)}catch(i){}try{return s.w=Gr((s.XF||{}).numFmtId||(e?14:0),e?Fi(t):t)}catch(i){return""+t}}function Ms(s,t,e){return s==null||s.t==null||s.t=="z"?"":s.w!==void 0?s.w:(s.t=="d"&&!s.z&&e&&e.dateNF&&(s.z=e.dateNF),s.t=="e"?on[s.v]||s.v:t==null?rg(s,s.v):rg(s,t))}function Mn(s,t){var e=t&&t.sheet?t.sheet:"Sheet1",i={};return i[e]=s,{SheetNames:[e],Sheets:i}}function Rx(s,t,e){var i=e||{},r=s?Array.isArray(s):i.dense,n=s||(r?[]:{}),a=0,o=0;if(n&&i.origin!=null){if(typeof i.origin=="number")a=i.origin;else{var l=typeof i.origin=="string"?oi(i.origin):i.origin;a=l.r,o=l.c}n["!ref"]||(n["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var u=Et(n["!ref"]);h.s.c=u.s.c,h.s.r=u.s.r,h.e.c=Math.max(h.e.c,u.e.c),h.e.r=Math.max(h.e.r,u.e.r),a==-1&&(h.e.r=a=u.e.r+1)}for(var c=0;c!=t.length;++c)if(t[c]){if(!Array.isArray(t[c]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[c].length;++f)if(!(typeof t[c][f]>"u")){var d={v:t[c][f]},p=a+c,v=o+f;if(h.s.r>p&&(h.s.r=p),h.s.c>v&&(h.s.c=v),h.e.r<p&&(h.e.r=p),h.e.c<v&&(h.e.c=v),t[c][f]&&typeof t[c][f]=="object"&&!Array.isArray(t[c][f])&&!(t[c][f]instanceof Date))d=t[c][f];else if(Array.isArray(d.v)&&(d.f=t[c][f][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(i.nullError)d.t="e",d.v=0;else if(i.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=i.dateNF||nt[14],i.cellDates?(d.t="d",d.w=Gr(d.z,Fi(d.v))):(d.t="n",d.v=Fi(d.v),d.w=Gr(d.z,d.v))):d.t="s";if(r)n[p]||(n[p]=[]),n[p][v]&&n[p][v].z&&(d.z=n[p][v].z),n[p][v]=d;else{var g=ot({c:v,r:p});n[g]&&n[g].z&&(d.z=n[g].z),n[g]=d}}}return h.s.c<1e7&&(n["!ref"]=ct(h)),n}function Mo(s,t){return Rx(null,s,t)}function dO(s){return s.read_shift(4,"i")}function Ss(s,t){return t||(t=Ce(4)),t.write_shift(4,s),t}function rr(s){var t=s.read_shift(4);return t===0?"":s.read_shift(t,"dbcs")}function Vi(s,t){var e=!1;return t==null&&(e=!0,t=Ce(4+2*s.length)),t.write_shift(4,s.length),s.length>0&&t.write_shift(0,s,"dbcs"),e?t.slice(0,t.l):t}function pO(s){return{ich:s.read_shift(2),ifnt:s.read_shift(2)}}function mO(s,t){return t||(t=Ce(4)),t.write_shift(2,0),t.write_shift(2,0),t}function _m(s,t){var e=s.l,i=s.read_shift(1),r=rr(s),n=[],a={t:r,h:r};if(i&1){for(var o=s.read_shift(4),l=0;l!=o;++l)n.push(pO(s));a.r=n}else a.r=[{ich:0,ifnt:0}];return s.l=e+t,a}function vO(s,t){var e=!1;return t==null&&(e=!0,t=Ce(15+4*s.t.length)),t.write_shift(1,0),Vi(s.t,t),e?t.slice(0,t.l):t}var gO=_m;function bO(s,t){var e=!1;return t==null&&(e=!0,t=Ce(23+4*s.t.length)),t.write_shift(1,1),Vi(s.t,t),t.write_shift(4,1),mO({ich:0,ifnt:0},t),e?t.slice(0,t.l):t}function ms(s){var t=s.read_shift(4),e=s.read_shift(2);return e+=s.read_shift(1)<<16,s.l++,{c:t,iStyleRef:e}}function Da(s,t){return t==null&&(t=Ce(8)),t.write_shift(-4,s.c),t.write_shift(3,s.iStyleRef||s.s),t.write_shift(1,0),t}function La(s){var t=s.read_shift(2);return t+=s.read_shift(1)<<16,s.l++,{c:-1,iStyleRef:t}}function Ra(s,t){return t==null&&(t=Ce(4)),t.write_shift(3,s.iStyleRef||s.s),t.write_shift(1,0),t}var yO=rr,Ix=Vi;function Fm(s){var t=s.read_shift(4);return t===0||t===4294967295?"":s.read_shift(t,"dbcs")}function nc(s,t){var e=!1;return t==null&&(e=!0,t=Ce(127)),t.write_shift(4,s.length>0?s.length:4294967295),s.length>0&&t.write_shift(0,s,"dbcs"),e?t.slice(0,t.l):t}var xO=rr,Qd=Fm,Nm=nc;function Mm(s){var t=s.slice(s.l,s.l+4),e=t[0]&1,i=t[0]&2;s.l+=4;var r=i===0?sc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ra(t,0)>>2;return e?r/100:r}function _x(s,t){t==null&&(t=Ce(4));var e=0,i=0,r=s*100;if(s==(s|0)&&s>=-(1<<29)&&s<1<<29?i=1:r==(r|0)&&r>=-(1<<29)&&r<1<<29&&(i=1,e=1),i)t.write_shift(-4,((e?r:s)<<2)+(e+2));else throw new Error("unsupported RkNumber "+s)}function Fx(s){var t={s:{},e:{}};return t.s.r=s.read_shift(4),t.e.r=s.read_shift(4),t.s.c=s.read_shift(4),t.e.c=s.read_shift(4),t}function CO(s,t){return t||(t=Ce(16)),t.write_shift(4,s.s.r),t.write_shift(4,s.e.r),t.write_shift(4,s.s.c),t.write_shift(4,s.e.c),t}var Ia=Fx,Po=CO;function tr(s){if(s.length-s.l<8)throw"XLS Xnum Buffer underflow";return s.read_shift(8,"f")}function xa(s,t){return(t||Ce(8)).write_shift(8,s,"f")}function wO(s){var t={},e=s.read_shift(1),i=e>>>1,r=s.read_shift(1),n=s.read_shift(2,"i"),a=s.read_shift(1),o=s.read_shift(1),l=s.read_shift(1);switch(s.l++,i){case 0:t.auto=1;break;case 1:t.index=r;var h=ha[r];h&&(t.rgb=rh(h));break;case 2:t.rgb=rh([a,o,l]);break;case 3:t.theme=r;break}return n!=0&&(t.tint=n>0?n/32767:n/32768),t}function ac(s,t){if(t||(t=Ce(8)),!s||s.auto)return t.write_shift(4,0),t.write_shift(4,0),t;s.index!=null?(t.write_shift(1,2),t.write_shift(1,s.index)):s.theme!=null?(t.write_shift(1,6),t.write_shift(1,s.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=s.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!s.rgb||s.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var i=s.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),t.write_shift(1,parseInt(i.slice(0,2),16)),t.write_shift(1,parseInt(i.slice(2,4),16)),t.write_shift(1,parseInt(i.slice(4,6),16)),t.write_shift(1,255)}return t}function EO(s){var t=s.read_shift(1);s.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function SO(s,t){t||(t=Ce(2));var e=(s.italic?2:0)|(s.strike?8:0)|(s.outline?16:0)|(s.shadow?32:0)|(s.condense?64:0)|(s.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}function Nx(s,t){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=s.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return e[s.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return s.l-=4,s.read_shift(0,t==1?"lpstr":"lpwstr")}function kO(s){return Nx(s,1)}function TO(s){return Nx(s,2)}var Pm=2,Sr=3,iu=11,sg=12,oc=19,ru=64,AO=65,OO=71,DO=4108,LO=4126,Pi=80,Mx=81,RO=[Pi,Mx],Zd={1:{n:"CodePage",t:Pm},2:{n:"Category",t:Pi},3:{n:"PresentationFormat",t:Pi},4:{n:"ByteCount",t:Sr},5:{n:"LineCount",t:Sr},6:{n:"ParagraphCount",t:Sr},7:{n:"SlideCount",t:Sr},8:{n:"NoteCount",t:Sr},9:{n:"HiddenCount",t:Sr},10:{n:"MultimediaClipCount",t:Sr},11:{n:"ScaleCrop",t:iu},12:{n:"HeadingPairs",t:DO},13:{n:"TitlesOfParts",t:LO},14:{n:"Manager",t:Pi},15:{n:"Company",t:Pi},16:{n:"LinksUpToDate",t:iu},17:{n:"CharacterCount",t:Sr},19:{n:"SharedDoc",t:iu},22:{n:"HyperlinksChanged",t:iu},23:{n:"AppVersion",t:Sr,p:"version"},24:{n:"DigSig",t:AO},26:{n:"ContentType",t:Pi},27:{n:"ContentStatus",t:Pi},28:{n:"Language",t:Pi},29:{n:"Version",t:Pi},255:{},2147483648:{n:"Locale",t:oc},2147483651:{n:"Behavior",t:oc},1919054434:{}},ep={1:{n:"CodePage",t:Pm},2:{n:"Title",t:Pi},3:{n:"Subject",t:Pi},4:{n:"Author",t:Pi},5:{n:"Keywords",t:Pi},6:{n:"Comments",t:Pi},7:{n:"Template",t:Pi},8:{n:"LastAuthor",t:Pi},9:{n:"RevNumber",t:Pi},10:{n:"EditTime",t:ru},11:{n:"LastPrinted",t:ru},12:{n:"CreatedDate",t:ru},13:{n:"ModifiedDate",t:ru},14:{n:"PageCount",t:Sr},15:{n:"WordCount",t:Sr},16:{n:"CharCount",t:Sr},17:{n:"Thumbnail",t:OO},18:{n:"Application",t:Pi},19:{n:"DocSecurity",t:Sr},255:{},2147483648:{n:"Locale",t:oc},2147483651:{n:"Behavior",t:oc},1919054434:{}},ng={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},IO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function _O(s){return s.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var FO=_O([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ha=Ut(FO),on={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Px={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},tp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},su={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Bm(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function NO(s){var t=Bm();if(!s||!s.match)return t;var e={};if((s.match(nr)||[]).forEach(function(i){var r=lt(i);switch(r[0].replace($A,"<")){case"<?xml":break;case"<Types":t.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[r.Extension]=r.ContentType;break;case"<Override":t[tp[r.ContentType]]!==void 0&&t[tp[r.ContentType]].push(r.PartName);break}}),t.xmlns!==_i.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=e,delete t.calcchains,t}function Bx(s,t){var e=NA(tp),i=[],r;i[i.length]=yi,i[i.length]=Be("Types",null,{xmlns:_i.CT,"xmlns:xsd":_i.xsd,"xmlns:xsi":_i.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Be("Default",null,{Extension:l[0],ContentType:l[1]})}));var n=function(l){s[l]&&s[l].length>0&&(r=s[l][0],i[i.length]=Be("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:su[l][t.bookType]||su[l].xlsx}))},a=function(l){(s[l]||[]).forEach(function(h){i[i.length]=Be("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:su[l][t.bookType]||su[l].xlsx})})},o=function(l){(s[l]||[]).forEach(function(h){i[i.length]=Be("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:e[l][0]})})};return n("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ih(s){var t=s.lastIndexOf("/");return s.slice(0,t+1)+"_rels/"+s.slice(t+1)+".rels"}function Ml(s,t){var e={"!id":{}};if(!s)return e;t.charAt(0)!=="/"&&(t="/"+t);var i={};return(s.match(nr)||[]).forEach(function(r){var n=lt(r);if(n[0]==="<Relationship"){var a={};a.Type=n.Type,a.Target=n.Target,a.Id=n.Id,n.TargetMode&&(a.TargetMode=n.TargetMode);var o=n.TargetMode==="External"?n.Target:kl(n.Target,t);e[o]=a,i[n.Id]=a}}),e["!id"]=i,e}function go(s){var t=[yi,Be("Relationships",null,{xmlns:_i.RELS})];return mi(s["!id"]).forEach(function(e){t[t.length]=Be("Relationship",null,s["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Mt(s,t,e,i,r,n){if(r||(r={}),s["!id"]||(s["!id"]={}),s["!idx"]||(s["!idx"]=1),t<0)for(t=s["!idx"];s["!id"]["rId"+t];++t);if(s["!idx"]=t+1,r.Id="rId"+t,r.Type=i,r.Target=e,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),s["!id"][r.Id])throw new Error("Cannot rewrite rId "+t);return s["!id"][r.Id]=r,s[("/"+r.Target).replace("//","/")]=r,t}var MO="application/vnd.oasis.opendocument.spreadsheet";function PO(s,t){for(var e=Sm(s),i,r;i=th.exec(e);)switch(i[3]){case"manifest":break;case"file-entry":if(r=lt(i[0],!1),r.path=="/"&&r.type!==MO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw i}}function BO(s){var t=[yi];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var e=0;e<s.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+s[e][0]+'" manifest:media-type="'+s[e][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}function ag(s,t,e){return['  <rdf:Description rdf:about="'+s+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function HO(s,t){return['  <rdf:Description rdf:about="'+s+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function VO(s){var t=[yi];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var e=0;e!=s.length;++e)t.push(ag(s[e][0],s[e][1])),t.push(HO("",s[e][0]));return t.push(ag("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Hx(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Yl.version+"</meta:generator></office:meta></office:document-meta>"}var us=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],WO=function(){for(var s=new Array(us.length),t=0;t<us.length;++t){var e=us[t],i="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);s[t]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return s}();function Vx(s){var t={};s=Ht(s);for(var e=0;e<us.length;++e){var i=us[e],r=s.match(WO[e]);r!=null&&r.length>0&&(t[i[1]]=Dt(r[1])),i[2]==="date"&&t[i[1]]&&(t[i[1]]=ti(t[i[1]]))}return t}function Af(s,t,e,i,r){r[s]!=null||t==null||t===""||(r[s]=t,t=Pt(t),i[i.length]=e?Be(s,t,e):qi(s,t))}function Wx(s,t){var e=t||{},i=[yi,Be("cp:coreProperties",null,{"xmlns:cp":_i.CORE_PROPS,"xmlns:dc":_i.dc,"xmlns:dcterms":_i.dcterms,"xmlns:dcmitype":_i.dcmitype,"xmlns:xsi":_i.xsi})],r={};if(!s&&!e.Props)return i.join("");s&&(s.CreatedDate!=null&&Af("dcterms:created",typeof s.CreatedDate=="string"?s.CreatedDate:Jd(s.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r),s.ModifiedDate!=null&&Af("dcterms:modified",typeof s.ModifiedDate=="string"?s.ModifiedDate:Jd(s.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r));for(var n=0;n!=us.length;++n){var a=us[n],o=e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:s?s[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Af(a[0],o,null,i,r)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var ua=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],zx=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function jx(s,t,e,i){var r=[];if(typeof s=="string")r=Y0(s,i);else for(var n=0;n<s.length;++n)r=r.concat(s[n].map(function(u){return{v:u}}));var a=typeof t=="string"?Y0(t,i).map(function(u){return u.v}):t,o=0,l=0;if(a.length>0)for(var h=0;h!==r.length;h+=2){switch(l=+r[h+1].v,r[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":e.Worksheets=l,e.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":e.NamedRanges=l,e.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":e.Chartsheets=l,e.ChartNames=a.slice(o,o+l);break}o+=l}}function zO(s,t,e){var i={};return t||(t={}),s=Ht(s),ua.forEach(function(r){var n=(s.match(Zl(r[0]))||[])[1];switch(r[2]){case"string":n&&(t[r[1]]=Dt(n));break;case"bool":t[r[1]]=n==="true";break;case"raw":var a=s.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));a&&a.length>0&&(i[r[1]]=a[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&jx(i.HeadingPairs,i.TitlesOfParts,t,e),t}function Ux(s){var t=[],e=Be;return s||(s={}),s.Application="SheetJS",t[t.length]=yi,t[t.length]=Be("Properties",null,{xmlns:_i.EXT_PROPS,"xmlns:vt":_i.vt}),ua.forEach(function(i){if(s[i[1]]!==void 0){var r;switch(i[2]){case"string":r=Pt(String(s[i[1]]));break;case"bool":r=s[i[1]]?"true":"false";break}r!==void 0&&(t[t.length]=e(i[0],r))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(s.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",s.SheetNames.map(function(i){return"<vt:lpstr>"+Pt(i)+"</vt:lpstr>"}).join(""),{size:s.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var jO=/<[^>]+>[^<]*/g;function UO(s,t){var e={},i="",r=s.match(jO);if(r)for(var n=0;n!=r.length;++n){var a=r[n],o=lt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":i=Dt(o.name);break;case"</property>":i=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),h=l[0].slice(4),u=l[1];switch(h){case"lpstr":case"bstr":case"lpwstr":e[i]=Dt(u);break;case"bool":e[i]=Zt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[i]=parseInt(u,10);break;case"r4":case"r8":case"decimal":e[i]=parseFloat(u);break;case"filetime":case"date":e[i]=ti(u);break;case"cy":case"error":e[i]=Dt(u);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",a,h,l)}}else if(a.slice(0,2)!=="</"){if(t.WTF)throw new Error(a)}}}return e}function $x(s){var t=[yi,Be("Properties",null,{xmlns:_i.CUST_PROPS,"xmlns:vt":_i.vt})];if(!s)return t.join("");var e=1;return mi(s).forEach(function(r){++e,t[t.length]=Be("property",ZA(s[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Pt(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ip={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Of;function $O(s,t,e){Of||(Of=Pc(ip)),t=Of[t]||t,s[t]=e}function qO(s,t){var e=[];return mi(ip).map(function(i){for(var r=0;r<us.length;++r)if(us[r][1]==i)return us[r];for(r=0;r<ua.length;++r)if(ua[r][1]==i)return ua[r];throw i}).forEach(function(i){if(s[i[1]]!=null){var r=t&&t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:s[i[1]];switch(i[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),e.push(qi(ip[i[1]]||i[1],r))}}),Be("DocumentProperties",e.join(""),{xmlns:Hr.o})}function GO(s,t){var e=["Worksheets","SheetNames"],i="CustomDocumentProperties",r=[];return s&&mi(s).forEach(function(n){if(Object.prototype.hasOwnProperty.call(s,n)){for(var a=0;a<us.length;++a)if(n==us[a][1])return;for(a=0;a<ua.length;++a)if(n==ua[a][1])return;for(a=0;a<e.length;++a)if(n==e[a])return;var o=s[n],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),r.push(Be(q0(n),o,{"dt:dt":l}))}}),t&&mi(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&!(s&&Object.prototype.hasOwnProperty.call(s,n))){var a=t[n],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),r.push(Be(q0(n),a,{"dt:dt":o}))}}),"<"+i+' xmlns="'+Hr.o+'">'+r.join("")+"</"+i+">"}function Hm(s){var t=s.read_shift(4),e=s.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function XO(s){var t=typeof s=="string"?new Date(Date.parse(s)):s,e=t.getTime()/1e3+11644473600,i=e%Math.pow(2,32),r=(e-i)/Math.pow(2,32);i*=1e7,r*=1e7;var n=i/Math.pow(2,32)|0;n>0&&(i=i%Math.pow(2,32),r+=n);var a=Ce(8);return a.write_shift(4,i),a.write_shift(4,r),a}function qx(s,t,e){var i=s.l,r=s.read_shift(0,"lpstr-cp");if(e)for(;s.l-i&3;)++s.l;return r}function Gx(s,t,e){var i=s.read_shift(0,"lpwstr");return i}function Xx(s,t,e){return t===31?Gx(s):qx(s,t,e)}function rp(s,t,e){return Xx(s,t,e===!1?0:4)}function KO(s,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Xx(s,t,0)}function YO(s){for(var t=s.read_shift(4),e=[],i=0;i!=t;++i){var r=s.l;e[i]=s.read_shift(0,"lpwstr").replace(ir,""),s.l-r&2&&(s.l+=2)}return e}function JO(s){for(var t=s.read_shift(4),e=[],i=0;i!=t;++i)e[i]=s.read_shift(0,"lpstr-cp").replace(ir,"");return e}function QO(s){var t=s.l,e=lc(s,Mx);s[s.l]==0&&s[s.l+1]==0&&s.l-t&2&&(s.l+=2);var i=lc(s,Sr);return[e,i]}function ZO(s){for(var t=s.read_shift(4),e=[],i=0;i<t/2;++i)e.push(QO(s));return e}function og(s,t){for(var e=s.read_shift(4),i={},r=0;r!=e;++r){var n=s.read_shift(4),a=s.read_shift(4);i[n]=s.read_shift(a,t===1200?"utf16le":"utf8").replace(ir,"").replace(Sl,"!"),t===1200&&a%2&&(s.l+=2)}return s.l&3&&(s.l=s.l>>3<<2),i}function Kx(s){var t=s.read_shift(4),e=s.slice(s.l,s.l+t);return s.l+=t,(t&3)>0&&(s.l+=4-(t&3)&3),e}function eD(s){var t={};return t.Size=s.read_shift(4),s.l+=t.Size+3-(t.Size-1)%4,t}function lc(s,t,e){var i=s.read_shift(2),r,n=e||{};if(s.l+=2,t!==sg&&i!==t&&RO.indexOf(t)===-1&&!((t&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+t+" saw "+i);switch(t===sg?i:t){case 2:return r=s.read_shift(2,"i"),n.raw||(s.l+=2),r;case 3:return r=s.read_shift(4,"i"),r;case 11:return s.read_shift(4)!==0;case 19:return r=s.read_shift(4),r;case 30:return qx(s,i,4).replace(ir,"");case 31:return Gx(s);case 64:return Hm(s);case 65:return Kx(s);case 71:return eD(s);case 80:return rp(s,i,!n.raw).replace(ir,"");case 81:return KO(s,i).replace(ir,"");case 4108:return ZO(s);case 4126:case 4127:return i==4127?YO(s):JO(s);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+i)}}function lg(s,t){var e=Ce(4),i=Ce(4);switch(e.write_shift(4,s==80?31:s),s){case 3:i.write_shift(-4,t);break;case 5:i=Ce(8),i.write_shift(8,t,"f");break;case 11:i.write_shift(4,t?1:0);break;case 64:i=XO(t);break;case 31:case 80:for(i=Ce(4+2*(t.length+1)+(t.length%2?0:2)),i.write_shift(4,t.length+1),i.write_shift(0,t,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+s+" "+t)}return Hi([e,i])}function hg(s,t){var e=s.l,i=s.read_shift(4),r=s.read_shift(4),n=[],a=0,o=0,l=-1,h={};for(a=0;a!=r;++a){var u=s.read_shift(4),c=s.read_shift(4);n[a]=[u,c+e]}n.sort(function(C,y){return C[1]-y[1]});var f={};for(a=0;a!=r;++a){if(s.l!==n[a][1]){var d=!0;if(a>0&&t)switch(t[n[a-1][0]].t){case 2:s.l+2===n[a][1]&&(s.l+=2,d=!1);break;case 80:s.l<=n[a][1]&&(s.l=n[a][1],d=!1);break;case 4108:s.l<=n[a][1]&&(s.l=n[a][1],d=!1);break}if((!t||a==0)&&s.l<=n[a][1]&&(d=!1,s.l=n[a][1]),d)throw new Error("Read Error: Expected address "+n[a][1]+" at "+s.l+" :"+a)}if(t){var p=t[n[a][0]];if(f[p.n]=lc(s,p.t,{raw:!0}),p.p==="version"&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(f[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ls(o=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(n[a][0]===1){if(o=f.CodePage=lc(s,Pm),ls(o),l!==-1){var v=s.l;s.l=n[l][1],h=og(s,o),s.l=v}}else if(n[a][0]===0){if(o===0){l=a,s.l=n[a+1][1];continue}h=og(s,o)}else{var g=h[n[a][0]],b;switch(s[s.l]){case 65:s.l+=4,b=Kx(s);break;case 30:s.l+=4,b=rp(s,s[s.l-4]).replace(/\u0000+$/,"");break;case 31:s.l+=4,b=rp(s,s[s.l-4]).replace(/\u0000+$/,"");break;case 3:s.l+=4,b=s.read_shift(4,"i");break;case 19:s.l+=4,b=s.read_shift(4);break;case 5:s.l+=4,b=s.read_shift(8,"f");break;case 11:s.l+=4,b=gi(s,4);break;case 64:s.l+=4,b=ti(Hm(s));break;default:throw new Error("unparsed value: "+s[s.l])}f[g]=b}}return s.l=e+i,f}var Yx=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function tD(s){switch(typeof s){case"boolean":return 11;case"number":return(s|0)==s?3:5;case"string":return 31;case"object":if(s instanceof Date)return 64;break}return-1}function ug(s,t,e){var i=Ce(8),r=[],n=[],a=8,o=0,l=Ce(8),h=Ce(8);if(l.write_shift(4,2),l.write_shift(4,1200),h.write_shift(4,1),n.push(l),r.push(h),a+=8+l.length,!t){h=Ce(8),h.write_shift(4,0),r.unshift(h);var u=[Ce(4)];for(u[0].write_shift(4,s.length),o=0;o<s.length;++o){var c=s[o][0];for(l=Ce(8+2*(c.length+1)+(c.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,c.length+1),l.write_shift(0,c,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Hi(u),n.unshift(l),a+=8+l.length}for(o=0;o<s.length;++o)if(!(t&&!t[s[o][0]])&&!(Yx.indexOf(s[o][0])>-1||zx.indexOf(s[o][0])>-1)&&s[o][1]!=null){var f=s[o][1],d=0;if(t){d=+t[s[o][0]];var p=e[d];if(p.p=="version"&&typeof f=="string"){var v=f.split(".");f=(+v[0]<<16)+(+v[1]||0)}l=lg(p.t,f)}else{var g=tD(f);g==-1&&(g=31,f=String(f)),l=lg(g,f)}n.push(l),h=Ce(8),h.write_shift(4,t?d:2+o),r.push(h),a+=8+l.length}var b=8*(n.length+1);for(o=0;o<n.length;++o)r[o].write_shift(4,b),b+=n[o].length;return i.write_shift(4,a),i.write_shift(4,n.length),Hi([i].concat(r).concat(n))}function cg(s,t,e){var i=s.content;if(!i)return{};$i(i,0);var r,n,a,o,l=0;i.chk("feff","Byte Order: "),i.read_shift(2);var h=i.read_shift(4),u=i.read_shift(16);if(u!==rt.utils.consts.HEADER_CLSID&&u!==e)throw new Error("Bad PropertySet CLSID "+u);if(r=i.read_shift(4),r!==1&&r!==2)throw new Error("Unrecognized #Sets: "+r);if(n=i.read_shift(16),o=i.read_shift(4),r===1&&o!==i.l)throw new Error("Length mismatch: "+o+" !== "+i.l);r===2&&(a=i.read_shift(16),l=i.read_shift(4));var c=hg(i,t),f={SystemIdentifier:h};for(var d in c)f[d]=c[d];if(f.FMTID=n,r===1)return f;if(l-i.l==2&&(i.l+=2),i.l!==l)throw new Error("Length mismatch 2: "+i.l+" !== "+l);var p;try{p=hg(i,null)}catch(v){}for(d in p)f[d]=p[d];return f.FMTID=[n,a],f}function fg(s,t,e,i,r,n){var a=Ce(r?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,rt.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,r?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,r?68:48);var l=ug(s,e,i);if(o.push(l),r){var h=ug(r,null,null);a.write_shift(16,n,"hex"),a.write_shift(4,68+l.length),o.push(h)}return Hi(o)}function ln(s,t){return s.read_shift(t),null}function iD(s,t){t||(t=Ce(s));for(var e=0;e<s;++e)t.write_shift(1,0);return t}function rD(s,t,e){for(var i=[],r=s.l+t;s.l<r;)i.push(e(s,r-s.l));if(r!==s.l)throw new Error("Slurp error");return i}function gi(s,t){return s.read_shift(t)===1}function dr(s,t){return t||(t=Ce(2)),t.write_shift(2,+!!s),t}function Ai(s){return s.read_shift(2,"u")}function ss(s,t){return t||(t=Ce(2)),t.write_shift(2,s),t}function Jx(s,t){return rD(s,t,Ai)}function sD(s){var t=s.read_shift(1),e=s.read_shift(1);return e===1?t:t===1}function Qx(s,t,e){return e||(e=Ce(2)),e.write_shift(1,t=="e"?+s:+!!s),e.write_shift(1,t=="e"?1:0),e}function bh(s,t,e){var i=s.read_shift(e&&e.biff>=12?2:1),r="sbcs-cont",n=jr;if(e&&e.biff>=8&&(jr=1200),!e||e.biff==8){var a=s.read_shift(1);a&&(r="dbcs-cont")}else e.biff==12&&(r="wstr");e.biff>=2&&e.biff<=5&&(r="cpstr");var o=i?s.read_shift(i,r):"";return jr=n,o}function nD(s){var t=jr;jr=1200;var e=s.read_shift(2),i=s.read_shift(1),r=i&4,n=i&8,a=1+(i&1),o=0,l,h={};n&&(o=s.read_shift(2)),r&&(l=s.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",c=e===0?"":s.read_shift(e,u);return n&&(s.l+=4*o),r&&(s.l+=l),h.t=c,n||(h.raw="<t>"+h.t+"</t>",h.r=h.t),jr=t,h}function aD(s){var t=s.t||"",e=Ce(3);e.write_shift(2,t.length),e.write_shift(1,1);var i=Ce(2*t.length);i.write_shift(2*t.length,t,"utf16le");var r=[e,i];return Hi(r)}function Ca(s,t,e){var i;if(e){if(e.biff>=2&&e.biff<=5)return s.read_shift(t,"cpstr");if(e.biff>=12)return s.read_shift(t,"dbcs-cont")}var r=s.read_shift(1);return r===0?i=s.read_shift(t,"sbcs-cont"):i=s.read_shift(t,"dbcs-cont"),i}function yh(s,t,e){var i=s.read_shift(e&&e.biff==2?1:2);return i===0?(s.l++,""):Ca(s,i,e)}function _a(s,t,e){if(e.biff>5)return yh(s,t,e);var i=s.read_shift(1);return i===0?(s.l++,""):s.read_shift(i,e.biff<=4||!s.lens?"cpstr":"sbcs-cont")}function Zx(s,t,e){return e||(e=Ce(3+2*s.length)),e.write_shift(2,s.length),e.write_shift(1,1),e.write_shift(31,s,"utf16le"),e}function oD(s){var t=s.read_shift(1);s.l++;var e=s.read_shift(2);return s.l+=2,[t,e]}function lD(s){var t=s.read_shift(4),e=s.l,i=!1;t>24&&(s.l+=t-24,s.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),s.l=e);var r=s.read_shift((i?t-24:t)>>1,"utf16le").replace(ir,"");return i&&(s.l+=24),r}function hD(s){for(var t=s.read_shift(2),e="";t-- >0;)e+="../";var i=s.read_shift(0,"lpstr-ansi");if(s.l+=2,s.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var r=s.read_shift(4);if(r===0)return e+i.replace(/\\/g,"/");var n=s.read_shift(4);if(s.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=s.read_shift(n>>1,"utf16le").replace(ir,"");return e+a}function uD(s,t){var e=s.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return lD(s);case"0303000000000000c000000000000046":return hD(s);default:throw new Error("Unsupported Moniker "+e)}}function nu(s){var t=s.read_shift(4),e=t>0?s.read_shift(t,"utf16le").replace(ir,""):"";return e}function dg(s,t){t||(t=Ce(6+s.length*2)),t.write_shift(4,1+s.length);for(var e=0;e<s.length;++e)t.write_shift(2,s.charCodeAt(e));return t.write_shift(2,0),t}function cD(s,t){var e=s.l+t,i=s.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var r=s.read_shift(2);s.l+=2;var n,a,o,l,h="",u,c;r&16&&(n=nu(s,e-s.l)),r&128&&(a=nu(s,e-s.l)),(r&257)===257&&(o=nu(s,e-s.l)),(r&257)===1&&(l=uD(s,e-s.l)),r&8&&(h=nu(s,e-s.l)),r&32&&(u=s.read_shift(16)),r&64&&(c=Hm(s)),s.l=e;var f=a||o||l||"";f&&h&&(f+="#"+h),f||(f="#"+h),r&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var d={Target:f};return u&&(d.guid=u),c&&(d.time=c),n&&(d.Tooltip=n),d}function fD(s){var t=Ce(512),e=0,i=s.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var r=i.indexOf("#"),n=r>-1?31:23;switch(i.charAt(0)){case"#":n=28;break;case".":n&=-3;break}t.write_shift(4,2),t.write_shift(4,n);var a=[8,6815827,6619237,4849780,83];for(e=0;e<a.length;++e)t.write_shift(4,a[e]);if(n==28)i=i.slice(1),dg(i,t);else if(n&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));var o=r>-1?i.slice(0,r):i;for(t.write_shift(4,2*(o.length+1)),e=0;e<o.length;++e)t.write_shift(2,o.charCodeAt(e));t.write_shift(2,0),n&8&&dg(r>-1?i.slice(r+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));for(var l=0;i.slice(l*3,l*3+3)=="../"||i.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,i.length-3*l+1),e=0;e<i.length-3*l;++e)t.write_shift(1,i.charCodeAt(e+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function eC(s){var t=s.read_shift(1),e=s.read_shift(1),i=s.read_shift(1),r=s.read_shift(1);return[t,e,i,r]}function tC(s,t){var e=eC(s);return e[3]=0,e}function Hs(s){var t=s.read_shift(2),e=s.read_shift(2),i=s.read_shift(2);return{r:t,c:e,ixfe:i}}function wa(s,t,e,i){return i||(i=Ce(6)),i.write_shift(2,s),i.write_shift(2,t),i.write_shift(2,e||0),i}function dD(s){var t=s.read_shift(2),e=s.read_shift(2);return s.l+=8,{type:t,flags:e}}function pD(s,t,e){return t===0?"":_a(s,t,e)}function mD(s,t,e){var i=e.biff>8?4:2,r=s.read_shift(i),n=s.read_shift(i,"i"),a=s.read_shift(i,"i");return[r,n,a]}function iC(s){var t=s.read_shift(2),e=Mm(s);return[t,e]}function vD(s,t,e){s.l+=4,t-=4;var i=s.l+t,r=bh(s,t,e),n=s.read_shift(2);if(i-=s.l,n!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+n);return s.l+=n,r}function Wc(s){var t=s.read_shift(2),e=s.read_shift(2),i=s.read_shift(2),r=s.read_shift(2);return{s:{c:i,r:t},e:{c:r,r:e}}}function rC(s,t){return t||(t=Ce(8)),t.write_shift(2,s.s.r),t.write_shift(2,s.e.r),t.write_shift(2,s.s.c),t.write_shift(2,s.e.c),t}function sC(s){var t=s.read_shift(2),e=s.read_shift(2),i=s.read_shift(1),r=s.read_shift(1);return{s:{c:i,r:t},e:{c:r,r:e}}}var gD=sC;function nC(s){s.l+=4;var t=s.read_shift(2),e=s.read_shift(2),i=s.read_shift(2);return s.l+=12,[e,t,i]}function bD(s){var t={};return s.l+=4,s.l+=16,t.fSharedNote=s.read_shift(2),s.l+=4,t}function yD(s){var t={};return s.l+=4,s.cf=s.read_shift(2),t}function Ki(s){s.l+=2,s.l+=s.read_shift(2)}var xD={0:Ki,4:Ki,5:Ki,6:Ki,7:yD,8:Ki,9:Ki,10:Ki,11:Ki,12:Ki,13:bD,14:Ki,15:Ki,16:Ki,17:Ki,18:Ki,19:Ki,20:Ki,21:nC};function CD(s,t){for(var e=s.l+t,i=[];s.l<e;){var r=s.read_shift(2);s.l-=2;try{i.push(xD[r](s,e-s.l))}catch(n){return s.l=e,i}}return s.l!=e&&(s.l=e),i}function au(s,t){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=s.read_shift(2),t-=2,t>=2&&(e.dt=s.read_shift(2),s.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return s.read_shift(t),e}function Vm(s,t,e){var i=1536,r=16;switch(e.bookType){case"biff8":break;case"biff5":i=1280,r=8;break;case"biff4":i=4,r=6;break;case"biff3":i=3,r=6;break;case"biff2":i=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var n=Ce(r);return n.write_shift(2,i),n.write_shift(2,t),r>4&&n.write_shift(2,29282),r>6&&n.write_shift(2,1997),r>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function wD(s,t){return t===0||s.read_shift(2),1200}function ED(s,t,e){if(e.enc)return s.l+=t,"";var i=s.l,r=_a(s,0,e);return s.read_shift(t+i-s.l),r}function SD(s,t){var e=!t||t.biff==8,i=Ce(e?112:54);for(i.write_shift(t.biff==8?2:1,7),e&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(e?0:536870912));i.l<i.length;)i.write_shift(1,e?0:32);return i}function kD(s,t,e){var i=e&&e.biff==8||t==2?s.read_shift(2):(s.l+=t,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function TD(s,t,e){var i=s.read_shift(4),r=s.read_shift(1)&3,n=s.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule";break}var a=bh(s,0,e);return a.length===0&&(a="Sheet1"),{pos:i,hs:r,dt:n,name:a}}function AD(s,t){var e=!t||t.biff>=8?2:1,i=Ce(8+e*s.name.length);i.write_shift(4,s.pos),i.write_shift(1,s.hs||0),i.write_shift(1,s.dt),i.write_shift(1,s.name.length),t.biff>=8&&i.write_shift(1,1),i.write_shift(e*s.name.length,s.name,t.biff<8?"sbcs":"utf16le");var r=i.slice(0,i.l);return r.l=i.l,r}function OD(s,t){for(var e=s.l+t,i=s.read_shift(4),r=s.read_shift(4),n=[],a=0;a!=r&&s.l<e;++a)n.push(nD(s));return n.Count=i,n.Unique=r,n}function DD(s,t){var e=Ce(8);e.write_shift(4,s.Count),e.write_shift(4,s.Unique);for(var i=[],r=0;r<s.length;++r)i[r]=aD(s[r]);var n=Hi([e].concat(i));return n.parts=[e.length].concat(i.map(function(a){return a.length})),n}function LD(s,t){var e={};return e.dsst=s.read_shift(2),s.l+=t-2,e}function RD(s){var t={};t.r=s.read_shift(2),t.c=s.read_shift(2),t.cnt=s.read_shift(2)-t.c;var e=s.read_shift(2);s.l+=4;var i=s.read_shift(1);return s.l+=3,i&7&&(t.level=i&7),i&32&&(t.hidden=!0),i&64&&(t.hpt=e/20),t}function ID(s){var t=dD(s);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var e=s.read_shift(4);return e!==0}function _D(s){return s.read_shift(2),s.read_shift(4)}function pg(s,t,e){var i=0;e&&e.biff==2||(i=s.read_shift(2));var r=s.read_shift(2);e&&e.biff==2&&(i=1-(r>>15),r&=32767);var n={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[n,r]}function FD(s){var t=s.read_shift(2),e=s.read_shift(2),i=s.read_shift(2),r=s.read_shift(2),n=s.read_shift(2),a=s.read_shift(2),o=s.read_shift(2),l=s.read_shift(2),h=s.read_shift(2);return{Pos:[t,e],Dim:[i,r],Flags:n,CurTab:a,FirstTab:o,Selected:l,TabRatio:h}}function ND(){var s=Ce(18);return s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,29280),s.write_shift(2,17600),s.write_shift(2,56),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,1),s.write_shift(2,500),s}function MD(s,t,e){if(e&&e.biff>=2&&e.biff<5)return{};var i=s.read_shift(2);return{RTL:i&64}}function PD(s){var t=Ce(18),e=1718;return s&&s.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function BD(){}function HD(s,t,e){var i={dyHeight:s.read_shift(2),fl:s.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:s.l+=2;break;default:s.l+=10;break}return i.name=bh(s,0,e),i}function VD(s,t){var e=s.name||"Arial",i=t&&t.biff==5,r=i?15+e.length:16+2*e.length,n=Ce(r);return n.write_shift(2,(s.sz||12)*20),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le"),n}function WD(s){var t=Hs(s);return t.isst=s.read_shift(4),t}function zD(s,t,e,i){var r=Ce(10);return wa(s,t,i,r),r.write_shift(4,e),r}function jD(s,t,e){e.biffguess&&e.biff==2&&(e.biff=5);var i=s.l+t,r=Hs(s);e.biff==2&&s.l++;var n=yh(s,i-s.l,e);return r.val=n,r}function UD(s,t,e,i,r){var n=!r||r.biff==8,a=Ce(8+ +n+(1+n)*e.length);return wa(s,t,i,a),a.write_shift(2,e.length),n&&a.write_shift(1,1),a.write_shift((1+n)*e.length,e,n?"utf16le":"sbcs"),a}function $D(s,t,e){var i=s.read_shift(2),r=_a(s,0,e);return[i,r]}function qD(s,t,e,i){var r=e&&e.biff==5;i||(i=Ce(r?3+t.length:5+2*t.length)),i.write_shift(2,s),i.write_shift(r?1:2,t.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le");var n=i.length>i.l?i.slice(0,i.l):i;return n.l==null&&(n.l=n.length),n}var GD=_a;function mg(s,t,e){var i=s.l+t,r=e.biff==8||!e.biff?4:2,n=s.read_shift(r),a=s.read_shift(r),o=s.read_shift(2),l=s.read_shift(2);return s.l=i,{s:{r:n,c:o},e:{r:a,c:l}}}function XD(s,t){var e=t.biff==8||!t.biff?4:2,i=Ce(2*e+6);return i.write_shift(e,s.s.r),i.write_shift(e,s.e.r+1),i.write_shift(2,s.s.c),i.write_shift(2,s.e.c+1),i.write_shift(2,0),i}function KD(s){var t=s.read_shift(2),e=s.read_shift(2),i=iC(s);return{r:t,c:e,ixfe:i[0],rknum:i[1]}}function YD(s,t){for(var e=s.l+t-2,i=s.read_shift(2),r=s.read_shift(2),n=[];s.l<e;)n.push(iC(s));if(s.l!==e)throw new Error("MulRK read error");var a=s.read_shift(2);if(n.length!=a-r+1)throw new Error("MulRK length mismatch");return{r:i,c:r,C:a,rkrec:n}}function JD(s,t){for(var e=s.l+t-2,i=s.read_shift(2),r=s.read_shift(2),n=[];s.l<e;)n.push(s.read_shift(2));if(s.l!==e)throw new Error("MulBlank read error");var a=s.read_shift(2);if(n.length!=a-r+1)throw new Error("MulBlank length mismatch");return{r:i,c:r,C:a,ixfe:n}}function QD(s,t,e,i){var r={},n=s.read_shift(4),a=s.read_shift(4),o=s.read_shift(4),l=s.read_shift(2);return r.patternType=IO[o>>26],i.cellStyles&&(r.alc=n&7,r.fWrap=n>>3&1,r.alcV=n>>4&7,r.fJustLast=n>>7&1,r.trot=n>>8&255,r.cIndent=n>>16&15,r.fShrinkToFit=n>>20&1,r.iReadOrder=n>>22&2,r.fAtrNum=n>>26&1,r.fAtrFnt=n>>27&1,r.fAtrAlc=n>>28&1,r.fAtrBdr=n>>29&1,r.fAtrPat=n>>30&1,r.fAtrProt=n>>31&1,r.dgLeft=a&15,r.dgRight=a>>4&15,r.dgTop=a>>8&15,r.dgBottom=a>>12&15,r.icvLeft=a>>16&127,r.icvRight=a>>23&127,r.grbitDiag=a>>30&3,r.icvTop=o&127,r.icvBottom=o>>7&127,r.icvDiag=o>>14&127,r.dgDiag=o>>21&15,r.icvFore=l&127,r.icvBack=l>>7&127,r.fsxButton=l>>14&1),r}function ZD(s,t,e){var i={};return i.ifnt=s.read_shift(2),i.numFmtId=s.read_shift(2),i.flags=s.read_shift(2),i.fStyle=i.flags>>2&1,t-=6,i.data=QD(s,t,i.fStyle,e),i}function vg(s,t,e,i){var r=e&&e.biff==5;i||(i=Ce(r?16:20)),i.write_shift(2,0),s.style?(i.write_shift(2,s.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,s.numFmtId||0),i.write_shift(2,t<<4));var n=0;return s.numFmtId>0&&r&&(n|=1024),i.write_shift(4,n),i.write_shift(4,0),r||i.write_shift(4,0),i.write_shift(2,0),i}function e2(s){s.l+=4;var t=[s.read_shift(2),s.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function t2(s){var t=Ce(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function gg(s,t,e){var i=Hs(s);(e.biff==2||t==9)&&++s.l;var r=sD(s);return i.val=r,i.t=r===!0||r===!1?"b":"e",i}function i2(s,t,e,i,r,n){var a=Ce(8);return wa(s,t,i,a),Qx(e,n,a),a}function r2(s,t,e){e.biffguess&&e.biff==2&&(e.biff=5);var i=Hs(s),r=tr(s);return i.val=r,i}function s2(s,t,e,i){var r=Ce(14);return wa(s,t,i,r),xa(e,r),r}var bg=pD;function n2(s,t,e){var i=s.l+t,r=s.read_shift(2),n=s.read_shift(2);if(e.sbcch=n,n==1025||n==14849)return[n,r];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var a=Ca(s,n),o=[];i>s.l;)o.push(yh(s));return[n,r,a,o]}function yg(s,t,e){var i=s.read_shift(2),r,n={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return e.sbcch===14849&&(r=vD(s,t-2,e)),n.body=r||s.read_shift(t-2),typeof r=="string"&&(n.Name=r),n}var a2=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function xg(s,t,e){var i=s.l+t,r=s.read_shift(2),n=s.read_shift(1),a=s.read_shift(1),o=s.read_shift(e&&e.biff==2?1:2),l=0;(!e||e.biff>=5)&&(e.biff!=5&&(s.l+=2),l=s.read_shift(2),e.biff==5&&(s.l+=2),s.l+=4);var h=Ca(s,a,e);r&32&&(h=a2[h.charCodeAt(0)]);var u=i-s.l;e&&e.biff==2&&--u;var c=i==s.l||o===0||!(u>0)?[]:C_(s,u,e,o);return{chKey:n,Name:h,itab:l,rgce:c}}function aC(s,t,e){if(e.biff<8)return o2(s,t,e);for(var i=[],r=s.l+t,n=s.read_shift(e.biff>8?4:2);n--!==0;)i.push(mD(s,e.biff>8?12:6,e));if(s.l!=r)throw new Error("Bad ExternSheet: "+s.l+" != "+r);return i}function o2(s,t,e){s[s.l+1]==3&&s[s.l]++;var i=bh(s,t,e);return i.charCodeAt(0)==3?i.slice(1):i}function l2(s,t,e){if(e.biff<8){s.l+=t;return}var i=s.read_shift(2),r=s.read_shift(2),n=Ca(s,i,e),a=Ca(s,r,e);return[n,a]}function h2(s,t,e){var i=sC(s);s.l++;var r=s.read_shift(1);return t-=8,[w_(s,t,e),r,i]}function Cg(s,t,e){var i=gD(s);switch(e.biff){case 2:s.l++,t-=7;break;case 3:case 4:s.l+=2,t-=8;break;default:s.l+=6,t-=12}return[i,y_(s,t,e)]}function u2(s){var t=s.read_shift(4)!==0,e=s.read_shift(4)!==0,i=s.read_shift(4);return[t,e,i]}function c2(s,t,e){if(!(e.biff<8)){var i=s.read_shift(2),r=s.read_shift(2),n=s.read_shift(2),a=s.read_shift(2),o=_a(s,0,e);return e.biff<8&&s.read_shift(1),[{r:i,c:r},o,a,n]}}function f2(s,t,e){return c2(s,t,e)}function d2(s,t){for(var e=[],i=s.read_shift(2);i--;)e.push(Wc(s));return e}function p2(s){var t=Ce(2+s.length*8);t.write_shift(2,s.length);for(var e=0;e<s.length;++e)rC(s[e],t);return t}function m2(s,t,e){if(e&&e.biff<8)return g2(s,t,e);var i=nC(s),r=CD(s,t-22,i[1]);return{cmo:i,ft:r}}var v2={8:function(s,t){var e=s.l+t;s.l+=10;var i=s.read_shift(2);s.l+=4,s.l+=2,s.l+=2,s.l+=2,s.l+=4;var r=s.read_shift(1);return s.l+=r,s.l=e,{fmt:i}}};function g2(s,t,e){s.l+=4;var i=s.read_shift(2),r=s.read_shift(2),n=s.read_shift(2);s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=6,t-=36;var a=[];return a.push((v2[i]||sr)(s,t,e)),{cmo:[r,i,n],ft:a}}function b2(s,t,e){var i=s.l,r="";try{s.l+=4;var n=(e.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(n)==-1?s.l+=6:a=oD(s,6,e);var o=s.read_shift(2);s.read_shift(2),Ai(s,2);var l=s.read_shift(2);s.l+=l;for(var h=1;h<s.lens.length-1;++h){if(s.l-i!=s.lens[h])throw new Error("TxO: bad continue record");var u=s[s.l],c=Ca(s,s.lens[h+1]-s.lens[h]-1);if(r+=c,r.length>=(u?o:2*o))break}if(r.length!==o&&r.length!==o*2)throw new Error("cchText: "+o+" != "+r.length);return s.l=i+t,{t:r}}catch(f){return s.l=i+t,{t:r}}}function y2(s,t){var e=Wc(s);s.l+=16;var i=cD(s,t-24);return[e,i]}function x2(s){var t=Ce(24),e=oi(s[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)t.write_shift(1,parseInt(i[r],16));return Hi([t,fD(s[1])])}function C2(s,t){s.read_shift(2);var e=Wc(s),i=s.read_shift((t-10)/2,"dbcs-cont");return i=i.replace(ir,""),[e,i]}function w2(s){var t=s[1].Tooltip,e=Ce(10+2*(t.length+1));e.write_shift(2,2048);var i=oi(s[0]);e.write_shift(2,i.r),e.write_shift(2,i.r),e.write_shift(2,i.c),e.write_shift(2,i.c);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function E2(s){var t=[0,0],e;return e=s.read_shift(2),t[0]=ng[e]||e,e=s.read_shift(2),t[1]=ng[e]||e,t}function S2(s){return s||(s=Ce(4)),s.write_shift(2,1),s.write_shift(2,1),s}function k2(s){for(var t=s.read_shift(2),e=[];t-- >0;)e.push(tC(s));return e}function T2(s){for(var t=s.read_shift(2),e=[];t-- >0;)e.push(tC(s));return e}function A2(s){s.l+=2;var t={cxfs:0,crc:0};return t.cxfs=s.read_shift(2),t.crc=s.read_shift(4),t}function oC(s,t,e){if(!e.cellStyles)return sr(s,t);var i=e&&e.biff>=12?4:2,r=s.read_shift(i),n=s.read_shift(i),a=s.read_shift(i),o=s.read_shift(i),l=s.read_shift(2);i==2&&(s.l+=2);var h={s:r,e:n,w:a,ixfe:o,flags:l};return(e.biff>=5||!e.biff)&&(h.level=l>>8&7),h}function O2(s,t){var e=Ce(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,s.width*256),e.write_shift(2,0);var i=0;return s.hidden&&(i|=1),e.write_shift(1,i),i=s.level||0,e.write_shift(1,i),e.write_shift(2,0),e}function D2(s,t){var e={};return t<32||(s.l+=16,e.header=tr(s),e.footer=tr(s),s.l+=2),e}function L2(s,t,e){var i={area:!1};if(e.biff!=5)return s.l+=t,i;var r=s.read_shift(1);return s.l+=3,r&16&&(i.area=!0),i}function R2(s){for(var t=Ce(2*s),e=0;e<s;++e)t.write_shift(2,e+1);return t}var I2=Hs,_2=Jx,F2=yh;function N2(s){var t=s.read_shift(2),e=s.read_shift(2),i=s.read_shift(4),r={fmt:t,env:e,len:i,data:s.slice(s.l,s.l+i)};return s.l+=i,r}function M2(s,t,e){e.biffguess&&e.biff==5&&(e.biff=2);var i=Hs(s);++s.l;var r=_a(s,t-7,e);return i.t="str",i.val=r,i}function P2(s){var t=Hs(s);++s.l;var e=tr(s);return t.t="n",t.val=e,t}function B2(s,t,e){var i=Ce(15);return Eh(i,s,t),i.write_shift(8,e,"f"),i}function H2(s){var t=Hs(s);++s.l;var e=s.read_shift(2);return t.t="n",t.val=e,t}function V2(s,t,e){var i=Ce(9);return Eh(i,s,t),i.write_shift(2,e),i}function W2(s){var t=s.read_shift(1);return t===0?(s.l++,""):s.read_shift(t,"sbcs-cont")}function z2(s,t){s.l+=6,s.l+=2,s.l+=1,s.l+=3,s.l+=1,s.l+=t-13}function j2(s,t,e){var i=s.l+t,r=Hs(s),n=s.read_shift(2),a=Ca(s,n,e);return s.l=i,r.t="str",r.val=a,r}var U2=[2,3,48,49,131,139,140,245],sp=function(){var s={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Pc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(o,l){var h=[],u=Dn(1);switch(l.type){case"base64":u=Vr(qr(o));break;case"binary":u=Vr(o);break;case"buffer":case"array":u=o;break}$i(u,0);var c=u.read_shift(1),f=!!(c&136),d=!1,p=!1;switch(c){case 2:break;case 3:break;case 48:d=!0,f=!0;break;case 49:d=!0,f=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+c.toString(16))}var v=0,g=521;c==2&&(v=u.read_shift(2)),u.l+=3,c!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),c!=2&&(g=u.read_shift(2));var b=u.read_shift(2),C=l.codepage||1252;c!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(C=s[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var y=[],x={},w=Math.min(u.length,c==2?521:g-10-(d?264:0)),S=p?32:11;u.l<w&&u[u.l]!=13;)switch(x={},x.name=kt.utils.decode(C,u.slice(u.l,u.l+S)).replace(/[\u0000\r\n].*$/g,""),u.l+=S,x.type=String.fromCharCode(u.read_shift(1)),c!=2&&!p&&(x.offset=u.read_shift(4)),x.len=u.read_shift(1),c==2&&(x.offset=u.read_shift(2)),x.dec=u.read_shift(1),x.name.length&&y.push(x),c!=2&&(u.l+=p?13:14),x.type){case"B":(!d||x.len!=8)&&l.WTF&&console.log("Skipping "+x.name+":"+x.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+x.name+":"+x.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+x.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var E=0,k=0;for(h[0]=[],k=0;k!=y.length;++k)h[0][k]=y[k].name;for(;v-- >0;){if(u[u.l]===42){u.l+=b;continue}for(++u.l,h[++E]=[],k=0,k=0;k!=y.length;++k){var A=u.slice(u.l,u.l+y[k].len);u.l+=y[k].len,$i(A,0);var z=kt.utils.decode(C,A);switch(y[k].type){case"C":z.trim().length&&(h[E][k]=z.replace(/\s+$/,""));break;case"D":z.length===8?h[E][k]=new Date(+z.slice(0,4),+z.slice(4,6)-1,+z.slice(6,8)):h[E][k]=z;break;case"F":h[E][k]=parseFloat(z.trim());break;case"+":case"I":h[E][k]=p?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(z.trim().toUpperCase()){case"Y":case"T":h[E][k]=!0;break;case"N":case"F":h[E][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+z+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+c.toString(16));h[E][k]="##MEMO##"+(p?parseInt(z.trim(),10):A.read_shift(4));break;case"N":z=z.replace(/\u0000/g,"").trim(),z&&z!="."&&(h[E][k]=+z||0);break;case"@":h[E][k]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":h[E][k]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":h[E][k]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[E][k]=-A.read_shift(-8,"f");break;case"B":if(d&&y[k].len==8){h[E][k]=A.read_shift(8,"f");break}case"G":case"P":A.l+=y[k].len;break;case"0":if(y[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[k].type)}}}if(c!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(h=h.slice(0,l.sheetRows)),l.DBF=y,h}function i(o,l){var h=l||{};h.dateNF||(h.dateNF="yyyymmdd");var u=Mo(e(o,h),h);return u["!cols"]=h.DBF.map(function(c){return{wch:c.len,DBF:c}}),delete h.DBF,u}function r(o,l){try{return Mn(i(o,l),l)}catch(h){if(l&&l.WTF)throw h}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var h=l||{};if(+h.codepage>=0&&ls(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var u=Dr(),c=fc(o,{header:1,raw:!0,cellDates:!0}),f=c[0],d=c.slice(1),p=o["!cols"]||[],v=0,g=0,b=0,C=1;for(v=0;v<f.length;++v){if(((p[v]||{}).DBF||{}).name){f[v]=p[v].DBF.name,++b;continue}if(f[v]!=null){if(++b,typeof f[v]=="number"&&(f[v]=f[v].toString(10)),typeof f[v]!="string")throw new Error("DBF Invalid column name "+f[v]+" |"+typeof f[v]+"|");if(f.indexOf(f[v])!==v){for(g=0;g<1024;++g)if(f.indexOf(f[v]+"_"+g)==-1){f[v]+="_"+g;break}}}}var y=Et(o["!ref"]),x=[],w=[],S=[];for(v=0;v<=y.e.c-y.s.c;++v){var E="",k="",A=0,z=[];for(g=0;g<d.length;++g)d[g][v]!=null&&z.push(d[g][v]);if(z.length==0||f[v]==null){x[v]="?";continue}for(g=0;g<z.length;++g){switch(typeof z[g]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=z[g]instanceof Date?"D":"C";break;default:k="C"}A=Math.max(A,String(z[g]).length),E=E&&E!=k?"C":k}A>250&&(A=250),k=((p[v]||{}).DBF||{}).type,k=="C"&&p[v].DBF.len>A&&(A=p[v].DBF.len),E=="B"&&k=="N"&&(E="N",S[v]=p[v].DBF.dec,A=p[v].DBF.len),w[v]=E=="C"||k=="N"?A:n[E]||0,C+=w[v],x[v]=E}var D=u.next(32);for(D.write_shift(4,318902576),D.write_shift(4,d.length),D.write_shift(2,296+32*b),D.write_shift(2,C),v=0;v<4;++v)D.write_shift(4,0);for(D.write_shift(4,0|(+t[ga]||3)<<8),v=0,g=0;v<f.length;++v)if(f[v]!=null){var T=u.next(32),M=(f[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,M,"sbcs"),T.write_shift(1,x[v]=="?"?"C":x[v],"sbcs"),T.write_shift(4,g),T.write_shift(1,w[v]||n[x[v]]||0),T.write_shift(1,S[v]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),g+=w[v]||n[x[v]]||0}var K=u.next(264);for(K.write_shift(4,13),v=0;v<65;++v)K.write_shift(4,0);for(v=0;v<d.length;++v){var te=u.next(C);for(te.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(x[g]){case"L":te.write_shift(1,d[v][g]==null?63:d[v][g]?84:70);break;case"B":te.write_shift(8,d[v][g]||0,"f");break;case"N":var ee="0";for(typeof d[v][g]=="number"&&(ee=d[v][g].toFixed(S[g]||0)),b=0;b<w[g]-ee.length;++b)te.write_shift(1,32);te.write_shift(1,ee,"sbcs");break;case"D":d[v][g]?(te.write_shift(4,("0000"+d[v][g].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(d[v][g].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+d[v][g].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var J=String(d[v][g]!=null?d[v][g]:"").slice(0,w[g]);for(te.write_shift(1,J,"sbcs"),b=0;b<w[g]-J.length;++b)te.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:r,to_sheet:i,from_sheet:a}}(),lC=function(){var s={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+mi(s).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(f,d){var p=s[d];return typeof p=="number"?Yd(p):p},i=function(f,d,p){var v=d.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return v==59?f:Yd(v)};s["|"]=254;function r(f,d){switch(d.type){case"base64":return n(qr(f),d);case"binary":return n(f,d);case"buffer":return n(vt&&Buffer.isBuffer(f)?f.toString("binary"):Nn(f),d);case"array":return n(ya(f),d)}throw new Error("Unrecognized type "+d.type)}function n(f,d){var p=f.split(/[\n\r]+/),v=-1,g=-1,b=0,C=0,y=[],x=[],w=null,S={},E=[],k=[],A=[],z=0,D;for(+d.codepage>=0&&ls(+d.codepage);b!==p.length;++b){z=0;var T=p[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,e),M=T.replace(/;;/g,"\0").split(";").map(function(_){return _.replace(/\u0000/g,";")}),K=M[0],te;if(T.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&x.push(T.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,J=!1,re=!1,j=!1,de=-1,we=-1;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"A":break;case"X":g=parseInt(M[C].slice(1))-1,J=!0;break;case"Y":for(v=parseInt(M[C].slice(1))-1,J||(g=0),D=y.length;D<=v;++D)y[D]=[];break;case"K":te=M[C].slice(1),te.charAt(0)==='"'?te=te.slice(1,te.length-1):te==="TRUE"?te=!0:te==="FALSE"?te=!1:isNaN(Es(te))?isNaN(To(te).getDate())||(te=ti(te)):(te=Es(te),w!==null&&Aa(w)&&(te=Hc(te))),typeof kt<"u"&&typeof te=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(te=kt.utils.decode(d.codepage,te)),ee=!0;break;case"E":j=!0;var N=bo(M[C].slice(1),{r:v,c:g});y[v][g]=[y[v][g],N];break;case"S":re=!0,y[v][g]=[y[v][g],"S5S"];break;case"G":break;case"R":de=parseInt(M[C].slice(1))-1;break;case"C":we=parseInt(M[C].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+T)}if(ee&&(y[v][g]&&y[v][g].length==2?y[v][g][0]=te:y[v][g]=te,w=null),re){if(j)throw new Error("SYLK shared formula cannot have own formula");var H=de>-1&&y[de][we];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");y[v][g][1]=TC(H[1],{r:v-de,c:g-we})}break;case"F":var L=0;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"X":g=parseInt(M[C].slice(1))-1,++L;break;case"Y":for(v=parseInt(M[C].slice(1))-1,D=y.length;D<=v;++D)y[D]=[];break;case"M":z=parseInt(M[C].slice(1))/20;break;case"F":break;case"G":break;case"P":w=x[parseInt(M[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=M[C].slice(1).split(" "),D=parseInt(A[0],10);D<=parseInt(A[1],10);++D)z=parseInt(A[2],10),k[D-1]=z===0?{hidden:!0}:{wch:z},Ln(k[D-1]);break;case"C":g=parseInt(M[C].slice(1))-1,k[g]||(k[g]={});break;case"R":v=parseInt(M[C].slice(1))-1,E[v]||(E[v]={}),z>0?(E[v].hpt=z,E[v].hpx=Oo(z)):z===0&&(E[v].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+T)}L<1&&(w=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+T)}}return E.length>0&&(S["!rows"]=E),k.length>0&&(S["!cols"]=k),d&&d.sheetRows&&(y=y.slice(0,d.sheetRows)),[y,S]}function a(f,d){var p=r(f,d),v=p[0],g=p[1],b=Mo(v,d);return mi(g).forEach(function(C){b[C]=g[C]}),b}function o(f,d){return Mn(a(f,d),d)}function l(f,d,p,v){var g="C;Y"+(p+1)+";X"+(v+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+qm(f.f,{r:p,c:v}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function h(f,d){d.forEach(function(p,v){var g="F;W"+(v+1)+" "+(v+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=sh(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=nh(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function u(f,d){d.forEach(function(p,v){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*ah(p.hpx)+";"),g.length>2&&f.push(g+"R"+(v+1))})}function c(f,d){var p=["ID;PWXL;N;E"],v=[],g=Et(f["!ref"]),b,C=Array.isArray(f),y="\r\n";p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),f["!cols"]&&h(p,f["!cols"]),f["!rows"]&&u(p,f["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var x=g.s.r;x<=g.e.r;++x)for(var w=g.s.c;w<=g.e.c;++w){var S=ot({r:x,c:w});b=C?(f[x]||[])[w]:f[S],!(!b||b.v==null&&(!b.f||b.F))&&v.push(l(b,f,x,w))}return p.join(y)+y+v.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:a,from_sheet:c}}(),hC=function(){function s(n,a){switch(a.type){case"base64":return t(qr(n),a);case"binary":return t(n,a);case"buffer":return t(vt&&Buffer.isBuffer(n)?n.toString("binary"):Nn(n),a);case"array":return t(ya(n),a)}throw new Error("Unrecognized type "+a.type)}function t(n,a){for(var o=n.split("\n"),l=-1,h=-1,u=0,c=[];u!==o.length;++u){if(o[u].trim()==="BOT"){c[++l]=[],h=0;continue}if(!(l<0)){var f=o[u].trim().split(","),d=f[0],p=f[1];++u;for(var v=o[u]||"";(v.match(/["]/g)||[]).length&1&&u<o.length-1;)v+="\n"+o[++u];switch(v=v.trim(),+d){case-1:if(v==="BOT"){c[++l]=[],h=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?c[l][h]=!0:v==="FALSE"?c[l][h]=!1:isNaN(Es(p))?isNaN(To(p).getDate())?c[l][h]=p:c[l][h]=ti(p):c[l][h]=Es(p),++h;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),c[l][h++]=v!==""?v:null;break}if(v==="EOD")break}}return a&&a.sheetRows&&(c=c.slice(0,a.sheetRows)),c}function e(n,a){return Mo(s(n,a),a)}function i(n,a){return Mn(e(n,a),a)}var r=function(){var n=function(l,h,u,c,f){l.push(h),l.push(u+","+c),l.push('"'+f.replace(/"/g,'""')+'"')},a=function(l,h,u,c){l.push(h+","+u),l.push(h==1?'"'+c.replace(/"/g,'""')+'"':c)};return function(l){var h=[],u=Et(l["!ref"]),c,f=Array.isArray(l);n(h,"TABLE",0,1,"sheetjs"),n(h,"VECTORS",0,u.e.r-u.s.r+1,""),n(h,"TUPLES",0,u.e.c-u.s.c+1,""),n(h,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){a(h,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var v=ot({r:d,c:p});if(c=f?(l[d]||[])[p]:l[v],!c){a(h,1,0,"");continue}switch(c.t){case"n":var g=c.w;!g&&c.v!=null&&(g=c.v),g==null?c.f&&!c.F?a(h,1,0,"="+c.f):a(h,1,0,""):a(h,0,g,"V");break;case"b":a(h,0,c.v?1:0,c.v?"TRUE":"FALSE");break;case"s":a(h,1,0,isNaN(c.v)?c.v:'="'+c.v+'"');break;case"d":c.w||(c.w=Gr(c.z||nt[14],Fi(ti(c.v)))),a(h,0,c.w,"V");break;default:a(h,1,0,"")}}}a(h,-1,0,"EOD");var b="\r\n",C=h.join(b);return C}}();return{to_workbook:i,to_sheet:e,from_sheet:r}}(),uC=function(){function s(c){return c.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(c){return c.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(c,f){for(var d=c.split("\n"),p=-1,v=-1,g=0,b=[];g!==d.length;++g){var C=d[g].trim().split(":");if(C[0]==="cell"){var y=oi(C[1]);if(b.length<=y.r)for(p=b.length;p<=y.r;++p)b[p]||(b[p]=[]);switch(p=y.r,v=y.c,C[2]){case"t":b[p][v]=s(C[3]);break;case"v":b[p][v]=+C[3];break;case"vtf":var x=C[C.length-1];case"vtc":switch(C[3]){case"nl":b[p][v]=!!+C[4];break;default:b[p][v]=+C[4];break}C[2]=="vtf"&&(b[p][v]=[b[p][v],x])}}}return f&&f.sheetRows&&(b=b.slice(0,f.sheetRows)),b}function i(c,f){return Mo(e(c,f),f)}function r(c,f){return Mn(i(c,f),f)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),l="--SocialCalcSpreadsheetControlSave--";function h(c){if(!c||!c["!ref"])return"";for(var f=[],d=[],p,v="",g=yr(c["!ref"]),b=Array.isArray(c),C=g.s.r;C<=g.e.r;++C)for(var y=g.s.c;y<=g.e.c;++y)if(v=ot({r:C,c:y}),p=b?(c[C]||[])[y]:c[v],!(!p||p.v==null||p.t==="z")){switch(d=["cell",v,"t"],p.t){case"s":case"str":d.push(t(p.v));break;case"n":p.f?(d[2]="vtf",d[3]="n",d[4]=p.v,d[5]=t(p.f)):(d[2]="v",d[3]=p.v);break;case"b":d[2]="vt"+(p.f?"f":"c"),d[3]="nl",d[4]=p.v?"1":"0",d[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var x=Fi(ti(p.v));d[2]="vtc",d[3]="nd",d[4]=""+x,d[5]=p.w||Gr(p.z||nt[14],x);break;case"e":continue}f.push(d.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join("\n")}function u(c){return[n,a,o,a,h(c),l].join("\n")}return{to_workbook:r,to_sheet:i,from_sheet:u}}(),Ao=function(){function s(u,c,f,d,p){p.raw?c[f][d]=u:u===""||(u==="TRUE"?c[f][d]=!0:u==="FALSE"?c[f][d]=!1:isNaN(Es(u))?isNaN(To(u).getDate())?c[f][d]=u:c[f][d]=ti(u):c[f][d]=Es(u))}function t(u,c){var f=c||{},d=[];if(!u||u.length===0)return d;for(var p=u.split(/[\r\n]/),v=p.length-1;v>=0&&p[v].length===0;)--v;for(var g=10,b=0,C=0;C<=v;++C)b=p[C].indexOf(" "),b==-1?b=p[C].length:b++,g=Math.max(g,b);for(C=0;C<=v;++C){d[C]=[];var y=0;for(s(p[C].slice(0,g).trim(),d,C,y,f),y=1;y<=(p[C].length-g)/10+1;++y)s(p[C].slice(g+(y-1)*10,g+y*10).trim(),d,C,y,f)}return f.sheetRows&&(d=d.slice(0,f.sheetRows)),d}var e={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function r(u){for(var c={},f=!1,d=0,p=0;d<u.length;++d)(p=u.charCodeAt(d))==34?f=!f:!f&&p in e&&(c[p]=(c[p]||0)+1);p=[];for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&p.push([c[d],d]);if(!p.length){c=i;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&p.push([c[d],d])}return p.sort(function(v,g){return v[0]-g[0]||i[v[1]]-i[g[1]]}),e[p.pop()[1]]||44}function n(u,c){var f=c||{},d="",p=f.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=r(u.slice(0,1024)):f&&f.FS?d=f.FS:d=r(u.slice(0,1024));var g=0,b=0,C=0,y=0,x=0,w=d.charCodeAt(0),S=!1,E=0,k=u.charCodeAt(0);u=u.replace(/\r\n/mg,"\n");var A=f.dateNF!=null?DA(f.dateNF):null;function z(){var D=u.slice(y,x),T={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)T.t="z";else if(f.raw)T.t="s",T.v=D;else if(D.trim().length===0)T.t="s",T.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(T.t="s",T.v=D.slice(2,-1).replace(/""/g,'"')):nI(D)?(T.t="n",T.f=D.slice(1)):(T.t="s",T.v=D);else if(D=="TRUE")T.t="b",T.v=!0;else if(D=="FALSE")T.t="b",T.v=!1;else if(!isNaN(C=Es(D)))T.t="n",f.cellText!==!1&&(T.w=D),T.v=C;else if(!isNaN(To(D).getDate())||A&&D.match(A)){T.z=f.dateNF||nt[14];var M=0;A&&D.match(A)&&(D=LA(D,f.dateNF,D.match(A)||[]),M=1),f.cellDates?(T.t="d",T.v=ti(D,M)):(T.t="n",T.v=Fi(ti(D,M))),f.cellText!==!1&&(T.w=Gr(T.z,T.v instanceof Date?Fi(T.v):T.v)),f.cellNF||delete T.z}else T.t="s",T.v=D;if(T.t=="z"||(f.dense?(p[g]||(p[g]=[]),p[g][b]=T):p[ot({c:b,r:g})]=T),y=x+1,k=u.charCodeAt(y),v.e.c<b&&(v.e.c=b),v.e.r<g&&(v.e.r=g),E==w)++b;else if(b=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;x<u.length;++x)switch(E=u.charCodeAt(x)){case 34:k===34&&(S=!S);break;case w:case 10:case 13:if(!S&&z())break e;break}return x-y>0&&z(),p["!ref"]=ct(v),p}function a(u,c){return!(c&&c.PRN)||c.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?n(u,c):Mo(t(u,c),c)}function o(u,c){var f="",d=c.type=="string"?[0,0,0,0]:tv(u,c);switch(c.type){case"base64":f=qr(u);break;case"binary":f=u;break;case"buffer":c.codepage==65001?f=u.toString("utf8"):c.codepage&&typeof kt<"u"?f=kt.utils.decode(c.codepage,u):f=vt&&Buffer.isBuffer(u)?u.toString("binary"):Nn(u);break;case"array":f=ya(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+c.type)}return d[0]==239&&d[1]==187&&d[2]==191?f=Ht(f.slice(3)):c.type!="string"&&c.type!="buffer"&&c.codepage==65001?f=Ht(f):c.type=="binary"&&typeof kt<"u"&&c.codepage&&(f=kt.utils.decode(c.codepage,kt.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?uC.to_sheet(c.type=="string"?f:Ht(f),c):a(f,c)}function l(u,c){return Mn(o(u,c),c)}function h(u){for(var c=[],f=Et(u["!ref"]),d,p=Array.isArray(u),v=f.s.r;v<=f.e.r;++v){for(var g=[],b=f.s.c;b<=f.e.c;++b){var C=ot({r:v,c:b});if(d=p?(u[v]||[])[b]:u[C],!d||d.v==null){g.push("          ");continue}for(var y=(d.w||(Ms(d),d.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(b===0?" ":""))}c.push(g.join(""))}return c.join("\n")}return{to_workbook:l,to_sheet:o,from_sheet:h}}();function $2(s,t){var e=t||{},i=!!e.WTF;e.WTF=!0;try{var r=lC.to_workbook(s,e);return e.WTF=i,r}catch(n){if(e.WTF=i,!n.message.match(/SYLK bad record ID/)&&i)throw n;return Ao.to_workbook(s,t)}}var ca=function(){function s(N,H,L){if(N){$i(N,N.l||0);for(var _=L.Enum||de;N.l<N.length;){var U=N.read_shift(2),se=_[U]||_[65535],ae=N.read_shift(2),oe=N.l+ae,me=se.f&&se.f(N,ae,L);if(N.l=oe,H(me,se,U))return}}}function t(N,H){switch(H.type){case"base64":return e(Vr(qr(N)),H);case"binary":return e(Vr(N),H);case"buffer":case"array":return e(N,H)}throw"Unsupported type "+H.type}function e(N,H){if(!N)return N;var L=H||{},_=L.dense?[]:{},U="Sheet1",se="",ae=0,oe={},me=[],Re=[],V={s:{r:0,c:0},e:{r:0,c:0}},$e=L.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)L.Enum=de,s(N,function(Le,Ct,si){switch(si){case 0:L.vers=Le,Le>=4096&&(L.qpro=!0);break;case 6:V=Le;break;case 204:Le&&(se=Le);break;case 222:se=Le;break;case 15:case 51:L.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:si==14&&(Le[2]&112)==112&&(Le[2]&15)>1&&(Le[2]&15)<15&&(Le[1].z=L.dateNF||nt[14],L.cellDates&&(Le[1].t="d",Le[1].v=Hc(Le[1].v))),L.qpro&&Le[3]>ae&&(_["!ref"]=ct(V),oe[U]=_,me.push(U),_=L.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},ae=Le[3],U=se||"Sheet"+(ae+1),se="");var Wt=L.dense?(_[Le[0].r]||[])[Le[0].c]:_[ot(Le[0])];if(Wt){Wt.t=Le[1].t,Wt.v=Le[1].v,Le[1].z!=null&&(Wt.z=Le[1].z),Le[1].f!=null&&(Wt.f=Le[1].f);break}L.dense?(_[Le[0].r]||(_[Le[0].r]=[]),_[Le[0].r][Le[0].c]=Le[1]):_[ot(Le[0])]=Le[1];break}},L);else if(N[2]==26||N[2]==14)L.Enum=we,N[2]==14&&(L.qpro=!0,N.l=0),s(N,function(Le,Ct,si){switch(si){case 204:U=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>ae&&(_["!ref"]=ct(V),oe[U]=_,me.push(U),_=L.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},ae=Le[3],U="Sheet"+(ae+1)),$e>0&&Le[0].r>=$e)break;L.dense?(_[Le[0].r]||(_[Le[0].r]=[]),_[Le[0].r][Le[0].c]=Le[1]):_[ot(Le[0])]=Le[1],V.e.c<Le[0].c&&(V.e.c=Le[0].c),V.e.r<Le[0].r&&(V.e.r=Le[0].r);break;case 27:Le[14e3]&&(Re[Le[14e3][0]]=Le[14e3][1]);break;case 1537:Re[Le[0]]=Le[1],Le[0]==ae&&(U=Le[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(_["!ref"]=ct(V),oe[se||U]=_,me.push(se||U),!Re.length)return{SheetNames:me,Sheets:oe};for(var Me={},Ze=[],Je=0;Je<Re.length;++Je)oe[me[Je]]?(Ze.push(Re[Je]||me[Je]),Me[Re[Je]]=oe[Re[Je]]||oe[me[Je]]):(Ze.push(Re[Je]),Me[Re[Je]]={"!ref":"A1"});return{SheetNames:Ze,Sheets:Me}}function i(N,H){var L=H||{};if(+L.codepage>=0&&ls(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var _=Dr(),U=Et(N["!ref"]),se=Array.isArray(N),ae=[];Ve(_,0,n(1030)),Ve(_,6,l(U));for(var oe=Math.min(U.e.r,8191),me=U.s.r;me<=oe;++me)for(var Re=di(me),V=U.s.c;V<=U.e.c;++V){me===U.s.r&&(ae[V]=ei(V));var $e=ae[V]+Re,Me=se?(N[me]||[])[V]:N[$e];if(!(!Me||Me.t=="z"))if(Me.t=="n")(Me.v|0)==Me.v&&Me.v>=-32768&&Me.v<=32767?Ve(_,13,d(me,V,Me.v)):Ve(_,14,v(me,V,Me.v));else{var Ze=Ms(Me);Ve(_,15,c(me,V,Ze.slice(0,239)))}}return Ve(_,1),_.end()}function r(N,H){var L=H||{};if(+L.codepage>=0&&ls(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var _=Dr();Ve(_,0,a(N));for(var U=0,se=0;U<N.SheetNames.length;++U)(N.Sheets[N.SheetNames[U]]||{})["!ref"]&&Ve(_,27,j(N.SheetNames[U],se++));var ae=0;for(U=0;U<N.SheetNames.length;++U){var oe=N.Sheets[N.SheetNames[U]];if(!(!oe||!oe["!ref"])){for(var me=Et(oe["!ref"]),Re=Array.isArray(oe),V=[],$e=Math.min(me.e.r,8191),Me=me.s.r;Me<=$e;++Me)for(var Ze=di(Me),Je=me.s.c;Je<=me.e.c;++Je){Me===me.s.r&&(V[Je]=ei(Je));var Le=V[Je]+Ze,Ct=Re?(oe[Me]||[])[Je]:oe[Le];if(!(!Ct||Ct.t=="z"))if(Ct.t=="n")Ve(_,23,z(Me,Je,ae,Ct.v));else{var si=Ms(Ct);Ve(_,22,E(Me,Je,ae,si.slice(0,239)))}}++ae}}return Ve(_,1),_.end()}function n(N){var H=Ce(2);return H.write_shift(2,N),H}function a(N){var H=Ce(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var L=0,_=0,U=0,se=0;se<N.SheetNames.length;++se){var ae=N.SheetNames[se],oe=N.Sheets[ae];if(!(!oe||!oe["!ref"])){++U;var me=yr(oe["!ref"]);L<me.e.r&&(L=me.e.r),_<me.e.c&&(_=me.e.c)}}return L>8191&&(L=8191),H.write_shift(2,L),H.write_shift(1,U),H.write_shift(1,_),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(N,H,L){var _={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&L.qpro?(_.s.c=N.read_shift(1),N.l++,_.s.r=N.read_shift(2),_.e.c=N.read_shift(1),N.l++,_.e.r=N.read_shift(2),_):(_.s.c=N.read_shift(2),_.s.r=N.read_shift(2),H==12&&L.qpro&&(N.l+=2),_.e.c=N.read_shift(2),_.e.r=N.read_shift(2),H==12&&L.qpro&&(N.l+=2),_.s.c==65535&&(_.s.c=_.e.c=_.s.r=_.e.r=0),_)}function l(N){var H=Ce(8);return H.write_shift(2,N.s.c),H.write_shift(2,N.s.r),H.write_shift(2,N.e.c),H.write_shift(2,N.e.r),H}function h(N,H,L){var _=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(_[0].c=N.read_shift(1),_[3]=N.read_shift(1),_[0].r=N.read_shift(2),N.l+=2):(_[2]=N.read_shift(1),_[0].c=N.read_shift(2),_[0].r=N.read_shift(2)),_}function u(N,H,L){var _=N.l+H,U=h(N,H,L);if(U[1].t="s",L.vers==20768){N.l++;var se=N.read_shift(1);return U[1].v=N.read_shift(se,"utf8"),U}return L.qpro&&N.l++,U[1].v=N.read_shift(_-N.l,"cstr"),U}function c(N,H,L){var _=Ce(7+L.length);_.write_shift(1,255),_.write_shift(2,H),_.write_shift(2,N),_.write_shift(1,39);for(var U=0;U<_.length;++U){var se=L.charCodeAt(U);_.write_shift(1,se>=128?95:se)}return _.write_shift(1,0),_}function f(N,H,L){var _=h(N,H,L);return _[1].v=N.read_shift(2,"i"),_}function d(N,H,L){var _=Ce(7);return _.write_shift(1,255),_.write_shift(2,H),_.write_shift(2,N),_.write_shift(2,L,"i"),_}function p(N,H,L){var _=h(N,H,L);return _[1].v=N.read_shift(8,"f"),_}function v(N,H,L){var _=Ce(13);return _.write_shift(1,255),_.write_shift(2,H),_.write_shift(2,N),_.write_shift(8,L,"f"),_}function g(N,H,L){var _=N.l+H,U=h(N,H,L);if(U[1].v=N.read_shift(8,"f"),L.qpro)N.l=_;else{var se=N.read_shift(2);x(N.slice(N.l,N.l+se),U),N.l+=se}return U}function b(N,H,L){var _=H&32768;return H&=-32769,H=(_?N:0)+(H>=8192?H-16384:H),(_?"":"$")+(L?ei(H):di(H))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function x(N,H){$i(N,0);for(var L=[],_=0,U="",se="",ae="",oe="";N.l<N.length;){var me=N[N.l++];switch(me){case 0:L.push(N.read_shift(8,"f"));break;case 1:se=b(H[0].c,N.read_shift(2),!0),U=b(H[0].r,N.read_shift(2),!1),L.push(se+U);break;case 2:{var Re=b(H[0].c,N.read_shift(2),!0),V=b(H[0].r,N.read_shift(2),!1);se=b(H[0].c,N.read_shift(2),!0),U=b(H[0].r,N.read_shift(2),!1),L.push(Re+V+":"+se+U)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(N.read_shift(2));break;case 6:{for(var $e="";me=N[N.l++];)$e+=String.fromCharCode(me);L.push('"'+$e.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:oe=L.pop(),ae=L.pop(),L.push(["AND","OR"][me-20]+"("+ae+","+oe+")");break;default:if(me<32&&y[me])oe=L.pop(),ae=L.pop(),L.push(ae+y[me]+oe);else if(C[me]){if(_=C[me][1],_==69&&(_=N[N.l++]),_>L.length){console.error("WK1 bad formula parse 0x"+me.toString(16)+":|"+L.join("|")+"|");return}var Me=L.slice(-_);L.length-=_,L.push(C[me][0]+"("+Me.join(",")+")")}else return me<=7?console.error("WK1 invalid opcode "+me.toString(16)):me<=24?console.error("WK1 unsupported op "+me.toString(16)):me<=30?console.error("WK1 invalid opcode "+me.toString(16)):me<=115?console.error("WK1 unsupported function opcode "+me.toString(16)):console.error("WK1 unrecognized opcode "+me.toString(16))}}L.length==1?H[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function w(N){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=N.read_shift(2),H[3]=N[N.l++],H[0].c=N[N.l++],H}function S(N,H){var L=w(N);return L[1].t="s",L[1].v=N.read_shift(H-4,"cstr"),L}function E(N,H,L,_){var U=Ce(6+_.length);U.write_shift(2,N),U.write_shift(1,L),U.write_shift(1,H),U.write_shift(1,39);for(var se=0;se<_.length;++se){var ae=_.charCodeAt(se);U.write_shift(1,ae>=128?95:ae)}return U.write_shift(1,0),U}function k(N,H){var L=w(N);L[1].v=N.read_shift(2);var _=L[1].v>>1;if(L[1].v&1)switch(_&7){case 0:_=(_>>3)*5e3;break;case 1:_=(_>>3)*500;break;case 2:_=(_>>3)/20;break;case 3:_=(_>>3)/200;break;case 4:_=(_>>3)/2e3;break;case 5:_=(_>>3)/2e4;break;case 6:_=(_>>3)/16;break;case 7:_=(_>>3)/64;break}return L[1].v=_,L}function A(N,H){var L=w(N),_=N.read_shift(4),U=N.read_shift(4),se=N.read_shift(2);if(se==65535)return _===0&&U===3221225472?(L[1].t="e",L[1].v=15):_===0&&U===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var ae=se&32768;return se=(se&32767)-16446,L[1].v=(1-ae*2)*(U*Math.pow(2,se+32)+_*Math.pow(2,se)),L}function z(N,H,L,_){var U=Ce(14);if(U.write_shift(2,N),U.write_shift(1,L),U.write_shift(1,H),_==0)return U.write_shift(4,0),U.write_shift(4,0),U.write_shift(2,65535),U;var se=0,ae=0,oe=0,me=0;return _<0&&(se=1,_=-_),ae=Math.log2(_)|0,_/=Math.pow(2,ae-31),me=_>>>0,me&2147483648||(_/=2,++ae,me=_>>>0),_-=me,me|=2147483648,me>>>=0,_*=Math.pow(2,32),oe=_>>>0,U.write_shift(4,oe),U.write_shift(4,me),ae+=16383+(se?32768:0),U.write_shift(2,ae),U}function D(N,H){var L=A(N);return N.l+=H-14,L}function T(N,H){var L=w(N),_=N.read_shift(4);return L[1].v=_>>6,L}function M(N,H){var L=w(N),_=N.read_shift(8,"f");return L[1].v=_,L}function K(N,H){var L=M(N);return N.l+=H-10,L}function te(N,H){return N[N.l+H-1]==0?N.read_shift(H,"cstr"):""}function ee(N,H){var L=N[N.l++];L>H-1&&(L=H-1);for(var _="";_.length<L;)_+=String.fromCharCode(N[N.l++]);return _}function J(N,H,L){if(!(!L.qpro||H<21)){var _=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var U=N.read_shift(H-21,"cstr");return[_,U]}}function re(N,H){for(var L={},_=N.l+H;N.l<_;){var U=N.read_shift(2);if(U==14e3){for(L[U]=[0,""],L[U][0]=N.read_shift(2);N[N.l];)L[U][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return L}function j(N,H){var L=Ce(5+N.length);L.write_shift(2,14e3),L.write_shift(2,H);for(var _=0;_<N.length;++_){var U=N.charCodeAt(_);L[L.l++]=U>127?95:U}return L[L.l++]=0,L}var de={0:{n:"BOF",f:Ai},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:te},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},we={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:r,to_workbook:t}}();function q2(s){var t={},e=s.match(nr),i=0,r=!1;if(e)for(;i!=e.length;++i){var n=lt(e[i]);switch(n[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(n.val=="1")break;t.cp=mm[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=n.val;break;case"<sz":t.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(n.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(n.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":n.rgb&&(t.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(n[0].charCodeAt(1)!==47&&!r)throw new Error("Unrecognized rich format "+n[0])}}return t}var G2=function(){var s=Zl("t"),t=Zl("rPr");function e(n){var a=n.match(s);if(!a)return{t:"s",v:""};var o={t:"s",v:Dt(a[1])},l=n.match(t);return l&&(o.s=q2(l[1])),o}var i=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(a){return a.replace(i,"").split(r).map(e).filter(function(o){return o.v})}}(),X2=function(){var t=/(\r\n|\n)/g;function e(r,n,a){var o=[];r.u&&o.push("text-decoration: underline;"),r.uval&&o.push("text-underline-style:"+r.uval+";"),r.sz&&o.push("font-size:"+r.sz+"pt;"),r.outline&&o.push("text-effect: outline;"),r.shadow&&o.push("text-shadow: auto;"),n.push('<span style="'+o.join("")+'">'),r.b&&(n.push("<b>"),a.push("</b>")),r.i&&(n.push("<i>"),a.push("</i>")),r.strike&&(n.push("<s>"),a.push("</s>"));var l=r.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(n.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),r}function i(r){var n=[[],r.v,[]];return r.v?(r.s&&e(r.s,n[0],n[2]),n[0].join("")+n[1].replace(t,"<br/>")+n[2].join("")):""}return function(n){return n.map(i).join("")}}(),K2=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Y2=/<(?:\w+:)?r>/,J2=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Wm(s,t){var e=t?t.cellHTML:!0,i={};return s?(s.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=Dt(Ht(s.slice(s.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=Ht(s),e&&(i.h=Em(i.t))):s.match(Y2)&&(i.r=Ht(s),i.t=Dt(Ht((s.replace(J2,"").match(K2)||[]).join("").replace(nr,""))),e&&(i.h=X2(G2(i.r)))),i):{t:""}}var Q2=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Z2=/<(?:\w+:)?(?:si|sstItem)>/g,eL=/<\/(?:\w+:)?(?:si|sstItem)>/;function tL(s,t){var e=[],i="";if(!s)return e;var r=s.match(Q2);if(r){i=r[2].replace(Z2,"").split(eL);for(var n=0;n!=i.length;++n){var a=Wm(i[n].trim(),t);a!=null&&(e[e.length]=a)}r=lt(r[1]),e.Count=r.count,e.Unique=r.uniqueCount}return e}var iL=/^\s|\s$|[\t\n\r]/;function cC(s,t){if(!t.bookSST)return"";var e=[yi];e[e.length]=Be("sst",null,{xmlns:Oa[0],count:s.Count,uniqueCount:s.Unique});for(var i=0;i!=s.length;++i)if(s[i]!=null){var r=s[i],n="<si>";r.r?n+=r.r:(n+="<t",r.t||(r.t=""),r.t.match(iL)&&(n+=' xml:space="preserve"'),n+=">"+Pt(r.t)+"</t>"),n+="</si>",e[e.length]=n}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function rL(s){return[s.read_shift(4),s.read_shift(4)]}function sL(s,t){var e=[],i=!1;return an(s,function(n,a,o){switch(o){case 159:e.Count=n[0],e.Unique=n[1];break;case 19:e.push(n);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(a.T,!i||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),e}function nL(s,t){return t||(t=Ce(8)),t.write_shift(4,s.Count),t.write_shift(4,s.Unique),t}var aL=vO;function oL(s){var t=Dr();De(t,159,nL(s));for(var e=0;e<s.length;++e)De(t,19,aL(s[e]));return De(t,160),t.end()}function fC(s){if(typeof kt<"u")return kt.utils.encode(ga,s);for(var t=[],e=s.split(""),i=0;i<e.length;++i)t[i]=e[i].charCodeAt(0);return t}function Zs(s,t){var e={};return e.Major=s.read_shift(2),e.Minor=s.read_shift(2),t>=4&&(s.l+=t-4),e}function lL(s){var t={};return t.id=s.read_shift(0,"lpp4"),t.R=Zs(s,4),t.U=Zs(s,4),t.W=Zs(s,4),t}function hL(s){for(var t=s.read_shift(4),e=s.l+t-4,i={},r=s.read_shift(4),n=[];r-- >0;)n.push({t:s.read_shift(4),v:s.read_shift(0,"lpp4")});if(i.name=s.read_shift(0,"lpp4"),i.comps=n,s.l!=e)throw new Error("Bad DataSpaceMapEntry: "+s.l+" != "+e);return i}function uL(s){var t=[];s.l+=4;for(var e=s.read_shift(4);e-- >0;)t.push(hL(s));return t}function cL(s){var t=[];s.l+=4;for(var e=s.read_shift(4);e-- >0;)t.push(s.read_shift(0,"lpp4"));return t}function fL(s){var t={};return s.read_shift(4),s.l+=4,t.id=s.read_shift(0,"lpp4"),t.name=s.read_shift(0,"lpp4"),t.R=Zs(s,4),t.U=Zs(s,4),t.W=Zs(s,4),t}function dL(s){var t=fL(s);if(t.ename=s.read_shift(0,"8lpp4"),t.blksz=s.read_shift(4),t.cmode=s.read_shift(4),s.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function dC(s,t){var e=s.l+t,i={};i.Flags=s.read_shift(4)&63,s.l+=4,i.AlgID=s.read_shift(4);var r=!1;switch(i.AlgID){case 26126:case 26127:case 26128:r=i.Flags==36;break;case 26625:r=i.Flags==4;break;case 0:r=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!r)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=s.read_shift(4),i.KeySize=s.read_shift(4),i.ProviderType=s.read_shift(4),s.l+=8,i.CSPName=s.read_shift(e-s.l>>1,"utf16le"),s.l=e,i}function pC(s,t){var e={},i=s.l+t;return s.l+=4,e.Salt=s.slice(s.l,s.l+16),s.l+=16,e.Verifier=s.slice(s.l,s.l+16),s.l+=16,s.read_shift(4),e.VerifierHash=s.slice(s.l,i),s.l=i,e}function pL(s){var t=Zs(s);switch(t.Minor){case 2:return[t.Minor,mL(s)];case 3:return[t.Minor,vL()];case 4:return[t.Minor,gL(s)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function mL(s){var t=s.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var e=s.read_shift(4),i=dC(s,e),r=pC(s,s.length-s.l);return{t:"Std",h:i,v:r}}function vL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function gL(s){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];s.l+=4;var e=s.read_shift(s.length-s.l,"utf8"),i={};return e.replace(nr,function(n){var a=lt(n);switch(Bs(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){i[o]=a[o]});break;case"<dataIntegrity":i.encryptedHmacKey=a.encryptedHmacKey,i.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(a);break;default:throw a[0]}}),i}function bL(s,t){var e={},i=e.EncryptionVersionInfo=Zs(s,4);if(t-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);e.Flags=s.read_shift(4),t-=4;var r=s.read_shift(4);return t-=4,e.EncryptionHeader=dC(s,r),t-=r,e.EncryptionVerifier=pC(s,t),e}function yL(s){var t={},e=t.EncryptionVersionInfo=Zs(s,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return t.Salt=s.read_shift(16),t.EncryptedVerifier=s.read_shift(16),t.EncryptedVerifierHash=s.read_shift(16),t}function zm(s){var t=0,e,i=fC(s),r=i.length+1,n,a,o,l,h;for(e=Dn(r),e[0]=i.length,n=1;n!=r;++n)e[n]=i[n-1];for(n=r-1;n>=0;--n)a=e[n],o=t&16384?1:0,l=t<<1&32767,h=o|l,t=h^a;return t^52811}var mC=function(){var s=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(a){return(a/2|a*128)&255},r=function(a,o){return i(a^o)},n=function(a){for(var o=t[a.length-1],l=104,h=a.length-1;h>=0;--h)for(var u=a[h],c=0;c!=7;++c)u&64&&(o^=e[l]),u*=2,--l;return o};return function(a){for(var o=fC(a),l=n(o),h=o.length,u=Dn(16),c=0;c!=16;++c)u[c]=0;var f,d,p;for((h&1)===1&&(f=l>>8,u[h]=r(s[0],f),--h,f=l&255,d=o[o.length-1],u[h]=r(d,f));h>0;)--h,f=l>>8,u[h]=r(o[h],f),--h,f=l&255,u[h]=r(o[h],f);for(h=15,p=15-o.length;p>0;)f=l>>8,u[h]=r(s[p],f),--h,--p,f=l&255,u[h]=r(o[h],f),--h,--p;return u}}(),xL=function(s,t,e,i,r){r||(r=t),i||(i=mC(s));var n,a;for(n=0;n!=t.length;++n)a=t[n],a^=i[e],a=(a>>5|a<<3)&255,r[n]=a,++e;return[r,e,i]},CL=function(s){var t=0,e=mC(s);return function(i){var r=xL("",i,t,e);return t=r[1],r[0]}};function wL(s,t,e,i){var r={key:Ai(s),verificationBytes:Ai(s)};return e.password&&(r.verifier=zm(e.password)),i.valid=r.verificationBytes===r.verifier,i.valid&&(i.insitu=CL(e.password)),r}function EL(s,t,e){var i=e||{};return i.Info=s.read_shift(2),s.l-=2,i.Info===1?i.Data=yL(s):i.Data=bL(s,t),i}function SL(s,t,e){var i={Type:e.biff>=8?s.read_shift(2):0};return i.Type?EL(s,t-2,i):wL(s,e.biff>=8?t:t-2,e,i),i}var vC=function(){function s(r,n){switch(n.type){case"base64":return t(qr(r),n);case"binary":return t(r,n);case"buffer":return t(vt&&Buffer.isBuffer(r)?r.toString("binary"):Nn(r),n);case"array":return t(ya(r),n)}throw new Error("Unrecognized type "+n.type)}function t(r,n){var a=n||{},o=a.dense?[]:{},l=r.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,c){Array.isArray(o)&&(o[c]=[]);for(var f=/\\\w+\b/g,d=0,p,v=-1;p=f.exec(u);){switch(p[0]){case"\\cell":var g=u.slice(d,f.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++v,g.length){var b={v:g,t:"s"};Array.isArray(o)?o[c][v]=b:o[ot({r:c,c:v})]=b}break}d=f.lastIndex}v>h.e.c&&(h.e.c=v)}),o["!ref"]=ct(h),o}function e(r,n){return Mn(s(r,n),n)}function i(r){for(var n=["{\\rtf1\\ansi"],a=Et(r["!ref"]),o,l=Array.isArray(r),h=a.s.r;h<=a.e.r;++h){n.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)n.push("\\cellx"+(u+1));for(n.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var c=ot({r:h,c:u});o=l?(r[h]||[])[u]:r[c],!(!o||o.v==null&&(!o.f||o.F))&&(n.push(" "+(o.w||(Ms(o),o.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:e,to_sheet:s,from_sheet:i}}();function kL(s){var t=s.slice(s[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function rh(s){for(var t=0,e=1;t!=3;++t)e=e*256+(s[t]>255?255:s[t]<0?0:s[t]);return e.toString(16).toUpperCase().slice(1)}function TL(s){var t=s[0]/255,e=s[1]/255,i=s[2]/255,r=Math.max(t,e,i),n=Math.min(t,e,i),a=r-n;if(a===0)return[0,0,t];var o=0,l=0,h=r+n;switch(l=a/(h>1?2-h:h),r){case t:o=((e-i)/a+6)%6;break;case e:o=(i-t)/a+2;break;case i:o=(t-e)/a+4;break}return[o/6,l,h/2]}function AL(s){var t=s[0],e=s[1],i=s[2],r=e*2*(i<.5?i:1-i),n=i-r/2,a=[n,n,n],o=6*t,l;if(e!==0)switch(o|0){case 0:case 6:l=r*o,a[0]+=r,a[1]+=l;break;case 1:l=r*(2-o),a[0]+=l,a[1]+=r;break;case 2:l=r*(o-2),a[1]+=r,a[2]+=l;break;case 3:l=r*(4-o),a[1]+=l,a[2]+=r;break;case 4:l=r*(o-4),a[2]+=r,a[0]+=l;break;case 5:l=r*(6-o),a[2]+=l,a[0]+=r;break}for(var h=0;h!=3;++h)a[h]=Math.round(a[h]*255);return a}function hc(s,t){if(t===0)return s;var e=TL(kL(s));return t<0?e[2]=e[2]*(1+t):e[2]=1-(1-e[2])*(1-t),rh(AL(e))}var gC=6,OL=15,DL=1,er=gC;function sh(s){return Math.floor((s+Math.round(128/er)/256)*er)}function nh(s){return Math.floor((s-5)/er*100+.5)/100}function uc(s){return Math.round((s*er+5)/er*256)/256}function Df(s){return uc(nh(sh(s)))}function jm(s){var t=Math.abs(s-Df(s)),e=er;if(t>.005)for(er=DL;er<OL;++er)Math.abs(s-Df(s))<=t&&(t=Math.abs(s-Df(s)),e=er);er=e}function Ln(s){s.width?(s.wpx=sh(s.width),s.wch=nh(s.wpx),s.MDW=er):s.wpx?(s.wch=nh(s.wpx),s.width=uc(s.wch),s.MDW=er):typeof s.wch=="number"&&(s.width=uc(s.wch),s.wpx=sh(s.width),s.MDW=er),s.customWidth&&delete s.customWidth}var LL=96,bC=LL;function ah(s){return s*96/bC}function Oo(s){return s*bC/96}var RL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function IL(s,t,e,i){t.Borders=[];var r={},n=!1;(s[0].match(nr)||[]).forEach(function(a){var o=lt(a);switch(Bs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":r={},o.diagonalUp&&(r.diagonalUp=Zt(o.diagonalUp)),o.diagonalDown&&(r.diagonalDown=Zt(o.diagonalDown)),t.Borders.push(r);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i&&i.WTF&&!n)throw new Error("unrecognized "+o[0]+" in borders")}})}function _L(s,t,e,i){t.Fills=[];var r={},n=!1;(s[0].match(nr)||[]).forEach(function(a){var o=lt(a);switch(Bs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":r={},t.Fills.push(r);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":o.patternType&&(r.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":r.bgColor||(r.bgColor={}),o.indexed&&(r.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(r.bgColor.theme=parseInt(o.theme,10)),o.tint&&(r.bgColor.tint=parseFloat(o.tint)),o.rgb&&(r.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":r.fgColor||(r.fgColor={}),o.theme&&(r.fgColor.theme=parseInt(o.theme,10)),o.tint&&(r.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(r.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i&&i.WTF&&!n)throw new Error("unrecognized "+o[0]+" in fills")}})}function FL(s,t,e,i){t.Fonts=[];var r={},n=!1;(s[0].match(nr)||[]).forEach(function(a){var o=lt(a);switch(Bs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(r),r={};break;case"<name":o.val&&(r.name=Ht(o.val));break;case"<name/>":case"</name>":break;case"<b":r.bold=o.val?Zt(o.val):1;break;case"<b/>":r.bold=1;break;case"<i":r.italic=o.val?Zt(o.val):1;break;case"<i/>":r.italic=1;break;case"<u":switch(o.val){case"none":r.underline=0;break;case"single":r.underline=1;break;case"double":r.underline=2;break;case"singleAccounting":r.underline=33;break;case"doubleAccounting":r.underline=34;break}break;case"<u/>":r.underline=1;break;case"<strike":r.strike=o.val?Zt(o.val):1;break;case"<strike/>":r.strike=1;break;case"<outline":r.outline=o.val?Zt(o.val):1;break;case"<outline/>":r.outline=1;break;case"<shadow":r.shadow=o.val?Zt(o.val):1;break;case"<shadow/>":r.shadow=1;break;case"<condense":r.condense=o.val?Zt(o.val):1;break;case"<condense/>":r.condense=1;break;case"<extend":r.extend=o.val?Zt(o.val):1;break;case"<extend/>":r.extend=1;break;case"<sz":o.val&&(r.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(r.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(r.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(r.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=mm[parseInt(o.val,10)];break;case"<color":if(r.color||(r.color={}),o.auto&&(r.color.auto=Zt(o.auto)),o.rgb)r.color.rgb=o.rgb.slice(-6);else if(o.indexed){r.color.index=parseInt(o.indexed,10);var l=ha[r.color.index];r.color.index==81&&(l=ha[1]),l||(l=ha[1]),r.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(r.color.theme=parseInt(o.theme,10),o.tint&&(r.color.tint=parseFloat(o.tint)),o.theme&&e.themeElements&&e.themeElements.clrScheme&&(r.color.rgb=hc(e.themeElements.clrScheme[r.color.theme].rgb,r.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i&&i.WTF&&!n)throw new Error("unrecognized "+o[0]+" in fonts")}})}function NL(s,t,e){t.NumberFmt=[];for(var i=mi(nt),r=0;r<i.length;++r)t.NumberFmt[i[r]]=nt[i[r]];var n=s[0].match(nr);if(n)for(r=0;r<n.length;++r){var a=lt(n[r]);switch(Bs(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Dt(Ht(a.formatCode)),l=parseInt(a.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Fs(o,l)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function ML(s){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var i=e[0];i<=e[1];++i)s[i]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:i,formatCode:Pt(s[i])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ou=["numFmtId","fillId","fontId","borderId","xfId"],lu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function PL(s,t,e){t.CellXf=[];var i,r=!1;(s[0].match(nr)||[]).forEach(function(n){var a=lt(n),o=0;switch(Bs(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=a,delete i[0],o=0;o<ou.length;++o)i[ou[o]]&&(i[ou[o]]=parseInt(i[ou[o]],10));for(o=0;o<lu.length;++o)i[lu[o]]&&(i[lu[o]]=Zt(i[lu[o]]));if(t.NumberFmt&&i.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[i.numFmtId]==t.NumberFmt[o]){i.numFmtId=o;break}}t.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Zt(a.wrapText)),i.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":r=!0;break;case"</AlternateContent>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(e&&e.WTF&&!r)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function BL(s){var t=[];return t[t.length]=Be("cellXfs",null),s.forEach(function(e){t[t.length]=Be("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var HL=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,h){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var c;return(c=o.match(t))&&NL(c,u,h),(c=o.match(r))&&FL(c,u,l,h),(c=o.match(i))&&_L(c,u,l,h),(c=o.match(n))&&IL(c,u,l,h),(c=o.match(e))&&PL(c,u,h),u}}();function yC(s,t){var e=[yi,Be("styleSheet",null,{xmlns:Oa[0],"xmlns:vt":_i.vt})],i;return s.SSF&&(i=ML(s.SSF))!=null&&(e[e.length]=i),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=BL(t.cellXfs))&&(e[e.length]=i),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function VL(s,t){var e=s.read_shift(2),i=rr(s);return[e,i]}function WL(s,t,e){e||(e=Ce(6+4*t.length)),e.write_shift(2,s),Vi(t,e);var i=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),i}function zL(s,t,e){var i={};i.sz=s.read_shift(2)/20;var r=EO(s);r.fItalic&&(i.italic=1),r.fCondense&&(i.condense=1),r.fExtend&&(i.extend=1),r.fShadow&&(i.shadow=1),r.fOutline&&(i.outline=1),r.fStrikeout&&(i.strike=1);var n=s.read_shift(2);switch(n===700&&(i.bold=1),s.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var a=s.read_shift(1);a!=0&&(i.underline=a);var o=s.read_shift(1);o>0&&(i.family=o);var l=s.read_shift(1);switch(l>0&&(i.charset=l),s.l++,i.color=wO(s),s.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=rr(s),i}function jL(s,t){t||(t=Ce(25+4*32)),t.write_shift(2,s.sz*20),SO(s,t),t.write_shift(2,s.bold?700:400);var e=0;s.vertAlign=="superscript"?e=1:s.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,s.underline||0),t.write_shift(1,s.family||0),t.write_shift(1,s.charset||0),t.write_shift(1,0),ac(s.color,t);var i=0;return s.scheme=="major"&&(i=1),s.scheme=="minor"&&(i=2),t.write_shift(1,i),Vi(s.name,t),t.length>t.l?t.slice(0,t.l):t}var UL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Lf,$L=sr;function wg(s,t){t||(t=Ce(4*3+8*7+16*1)),Lf||(Lf=Pc(UL));var e=Lf[s.patternType];e==null&&(e=40),t.write_shift(4,e);var i=0;if(e!=40)for(ac({auto:1},t),ac({auto:1},t);i<12;++i)t.write_shift(4,0);else{for(;i<4;++i)t.write_shift(4,0);for(;i<12;++i)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function qL(s,t){var e=s.l+t,i=s.read_shift(2),r=s.read_shift(2);return s.l=e,{ixfe:i,numFmtId:r}}function xC(s,t,e){e||(e=Ce(16)),e.write_shift(2,t||0),e.write_shift(2,s.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var i=0;return e.write_shift(1,i),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function el(s,t){return t||(t=Ce(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var GL=sr;function XL(s,t){return t||(t=Ce(51)),t.write_shift(1,0),el(null,t),el(null,t),el(null,t),el(null,t),el(null,t),t.length>t.l?t.slice(0,t.l):t}function KL(s,t){return t||(t=Ce(12+4*10)),t.write_shift(4,s.xfId),t.write_shift(2,1),t.write_shift(1,+s.builtinId),t.write_shift(1,0),nc(s.name||"",t),t.length>t.l?t.slice(0,t.l):t}function YL(s,t,e){var i=Ce(2052);return i.write_shift(4,s),nc(t,i),nc(e,i),i.length>i.l?i.slice(0,i.l):i}function JL(s,t,e){var i={};i.NumberFmt=[];for(var r in nt)i.NumberFmt[r]=nt[r];i.CellXf=[],i.Fonts=[];var n=[],a=!1;return an(s,function(l,h,u){switch(u){case 44:i.NumberFmt[l[0]]=l[1],Fs(l[1],l[0]);break;case 43:i.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=hc(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:n[n.length-1]==617&&i.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;default:if(h.T>0)n.push(u);else if(h.T<0)n.pop();else if(!a||e.WTF&&n[n.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),i}function QL(s,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&++e}),e!=0&&(De(s,615,Ss(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&De(s,44,WL(r,t[r]))}),De(s,616))}}function ZL(s){var t=1;De(s,611,Ss(t)),De(s,43,jL({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),De(s,612)}function eR(s){var t=2;De(s,603,Ss(t)),De(s,45,wg({patternType:"none"})),De(s,45,wg({patternType:"gray125"})),De(s,604)}function tR(s){var t=1;De(s,613,Ss(t)),De(s,46,XL()),De(s,614)}function iR(s){var t=1;De(s,626,Ss(t)),De(s,47,xC({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),De(s,627)}function rR(s,t){De(s,617,Ss(t.length)),t.forEach(function(e){De(s,47,xC(e,0))}),De(s,618)}function sR(s){var t=1;De(s,619,Ss(t)),De(s,48,KL({xfId:0,builtinId:0,name:"Normal"})),De(s,620)}function nR(s){var t=0;De(s,505,Ss(t)),De(s,506)}function aR(s){var t=0;De(s,508,YL(t,"TableStyleMedium9","PivotStyleMedium4")),De(s,509)}function oR(s,t){var e=Dr();return De(e,278),QL(e,s.SSF),ZL(e),eR(e),tR(e),iR(e),rR(e,t.cellXfs),sR(e),nR(e),aR(e),De(e,279),e.end()}var lR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function hR(s,t,e){t.themeElements.clrScheme=[];var i={};(s[0].match(nr)||[]).forEach(function(r){var n=lt(r);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=n.val;break;case"<a:sysClr":i.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":n[0].charAt(1)==="/"?(t.themeElements.clrScheme[lR.indexOf(n[0])]=i,i={}):i.name=n[0].slice(3,n[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function uR(){}function cR(){}var fR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,dR=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,pR=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function mR(s,t,e){t.themeElements={};var i;[["clrScheme",fR,hR],["fontScheme",dR,uR],["fmtScheme",pR,cR]].forEach(function(r){if(!(i=s.match(r[1])))throw new Error(r[0]+" not found in themeElements");r[2](i,t,e)})}var vR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function CC(s,t){(!s||s.length===0)&&(s=Um());var e,i={};if(!(e=s.match(vR)))throw new Error("themeElements not found in theme");return mR(e[0],i,t),i.raw=s,i}function Um(s,t){if(t&&t.themeXLSX)return t.themeXLSX;if(s&&typeof s.raw=="string")return s.raw;var e=[yi];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function gR(s,t,e){var i=s.l+t,r=s.read_shift(4);if(r!==124226){if(!e.cellStyles){s.l=i;return}var n=s.slice(s.l);s.l=i;var a;try{a=gx(n,{type:"array"})}catch(l){return}var o=Wr(a,"theme/theme/theme1.xml",!0);if(o)return CC(o,e)}}function bR(s){return s.read_shift(4)}function yR(s){var t={};switch(t.xclrType=s.read_shift(2),t.nTintShade=s.read_shift(2),t.xclrType){case 0:s.l+=4;break;case 1:t.xclrValue=xR(s,4);break;case 2:t.xclrValue=eC(s);break;case 3:t.xclrValue=bR(s);break;case 4:s.l+=4;break}return s.l+=8,t}function xR(s,t){return sr(s,t)}function CR(s,t){return sr(s,t)}function wR(s){var t=s.read_shift(2),e=s.read_shift(2)-4,i=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=yR(s);break;case 6:i[1]=CR(s,e);break;case 14:case 15:i[1]=s.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+e)}return i}function ER(s,t){var e=s.l+t;s.l+=2;var i=s.read_shift(2);s.l+=2;for(var r=s.read_shift(2),n=[];r-- >0;)n.push(wR(s,e-s.l));return{ixfe:i,ext:n}}function SR(s,t){t.forEach(function(e){switch(e[0]){}})}function kR(s,t){return{flags:s.read_shift(4),version:s.read_shift(4),name:rr(s)}}function TR(s){var t=Ce(12+2*s.name.length);return t.write_shift(4,s.flags),t.write_shift(4,s.version),Vi(s.name,t),t.slice(0,t.l)}function AR(s){for(var t=[],e=s.read_shift(4);e-- >0;)t.push([s.read_shift(4),s.read_shift(4)]);return t}function OR(s){var t=Ce(4+8*s.length);t.write_shift(4,s.length);for(var e=0;e<s.length;++e)t.write_shift(4,s[e][0]),t.write_shift(4,s[e][1]);return t}function DR(s,t){var e=Ce(8+2*t.length);return e.write_shift(4,s),Vi(t,e),e.slice(0,e.l)}function LR(s){return s.l+=4,s.read_shift(4)!=0}function RR(s,t){var e=Ce(8);return e.write_shift(4,s),e.write_shift(4,1),e}function IR(s,t,e){var i={Types:[],Cell:[],Value:[]},r=e||{},n=[],a=!1,o=2;return an(s,function(l,h,u){switch(u){case 335:i.Types.push({name:l.name});break;case 51:l.forEach(function(c){o==1?i.Cell.push({type:i.Types[c[0]-1].name,index:c[1]}):o==0&&i.Value.push({type:i.Types[c[0]-1].name,index:c[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;default:if(!h.T){if(!a||r.WTF&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),i}function _R(){var s=Dr();return De(s,332),De(s,334,Ss(1)),De(s,335,TR({name:"XLDAPR",version:12e4,flags:3496657072})),De(s,336),De(s,339,DR(1,"XLDAPR")),De(s,52),De(s,35,Ss(514)),De(s,4096,Ss(0)),De(s,4097,ss(1)),De(s,36),De(s,53),De(s,340),De(s,337,RR(1)),De(s,51,OR([[1,0]])),De(s,338),De(s,333),s.end()}function FR(s,t,e){var i={Types:[],Cell:[],Value:[]};if(!s)return i;var r=!1,n=2,a;return s.replace(nr,function(o){var l=lt(o);switch(Bs(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<i.Types.length;++h)i.Types[h].name==l.name&&(a=i.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":n==1?i.Cell.push({type:i.Types[l.t-1].name,index:+l.v}):n==0&&i.Value.push({type:i.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":n=1;break;case"</cellMetadata>":n=2;break;case"<valueMetadata":n=0;break;case"</valueMetadata>":n=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!r&&e.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),i}function wC(){var s=[yi];return s.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),s.join("")}function NR(s){var t=[];if(!s)return t;var e=1;return(s.match(nr)||[]).forEach(function(i){var r=lt(i);switch(r[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?e=r.i:r.i=e,t.push(r);break}}),t}function MR(s){var t={};t.i=s.read_shift(4);var e={};e.r=s.read_shift(4),e.c=s.read_shift(4),t.r=ot(e);var i=s.read_shift(1);return i&2&&(t.l="1"),i&8&&(t.a="1"),t}function PR(s,t,e){var i=[];return an(s,function(n,a,o){switch(o){case 63:i.push(n);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),i}function BR(s,t,e,i){if(!s)return s;var r=i||{},n=!1;an(s,function(o,l,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(!l.T){if(!n||r.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},r)}function HR(s,t){if(!s)return"??";var e=(s.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][e].Target}var oo=1024;function EC(s,t){for(var e=[21600,21600],i=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),r=[Be("xml",null,{"xmlns:v":Hr.v,"xmlns:o":Hr.o,"xmlns:x":Hr.x,"xmlns:mv":Hr.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:s}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:i})];oo<s*1e3;)oo+=1e3;return t.forEach(function(n){var a=oi(n[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Be("v:fill",l,o),u={on:"t",obscured:"t"};++oo,r=r.concat(["<v:shape"+eh({id:"_x0000_s"+oo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Be("v:shadow",null,u),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",qi("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),qi("x:AutoFill","False"),qi("x:Row",String(a.r)),qi("x:Column",String(a.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function Eg(s,t,e,i){var r=Array.isArray(s),n;t.forEach(function(a){var o=oi(a.ref);if(r?(s[o.r]||(s[o.r]=[]),n=s[o.r][o.c]):n=s[a.ref],!n){n={t:"z"},r?s[o.r][o.c]=n:s[a.ref]=n;var l=Et(s["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var h=ct(l);h!==s["!ref"]&&(s["!ref"]=h)}n.c||(n.c=[]);var u={a:a.author,t:a.t,r:a.r,T:e};a.h&&(u.h=a.h);for(var c=n.c.length-1;c>=0;--c){if(!e&&n.c[c].T)return;e&&!n.c[c].T&&n.c.splice(c,1)}if(e&&i){for(c=0;c<i.length;++c)if(u.a==i[c].id){u.a=i[c].name||u.a;break}}n.c.push(u)})}function VR(s,t){if(s.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],i=[],r=s.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);r&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&e.push(o[1])}});var n=s.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=lt(o[0]),h={author:l.authorId&&e[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=oi(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var c=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!c&&!!c[1]&&Wm(c[1])||{r:"",t:"",h:""};h.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),h.t=(f.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(h.h=f.h),i.push(h)}}}}),i}function SC(s){var t=[yi,Be("comments",null,{xmlns:Oa[0]})],e=[];return t.push("<authors>"),s.forEach(function(i){i[1].forEach(function(r){var n=Pt(r.a);e.indexOf(n)==-1&&(e.push(n),t.push("<author>"+n+"</author>")),r.T&&r.ID&&e.indexOf("tc="+r.ID)==-1&&(e.push("tc="+r.ID),t.push("<author>tc="+r.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),s.forEach(function(i){var r=0,n=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?r=e.indexOf("tc="+i[1][0].ID):i[1].forEach(function(l){l.a&&(r=e.indexOf(Pt(l.a))),n.push(l.t||"")}),t.push('<comment ref="'+i[0]+'" authorId="'+r+'"><text>'),n.length<=1)t.push(qi("t",Pt(n[0]||"")));else{for(var a="Comment:\n    "+n[0]+"\n",o=1;o<n.length;++o)a+="Reply:\n    "+n[o]+"\n";t.push(qi("t",Pt(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function WR(s,t){var e=[],i=!1,r={},n=0;return s.replace(nr,function(o,l){var h=lt(o);switch(Bs(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":r={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":r.t!=null&&e.push(r);break;case"<text>":case"<text":n=l+o.length;break;case"</text>":r.t=s.slice(n,l).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return o}),e}function zR(s,t,e){var i=[yi,Be("ThreadedComments",null,{xmlns:_i.TCMNT}).replace(/[\/]>/,">")];return s.forEach(function(r){var n="";(r[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};o==0?n=l.id:l.parentId=n,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),i.push(Be("threadedComment",qi("text",a.t||""),l))})}),i.push("</ThreadedComments>"),i.join("")}function jR(s,t){var e=[],i=!1;return s.replace(nr,function(n){var a=lt(n);switch(Bs(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return n}),e}function UR(s){var t=[yi,Be("personList",null,{xmlns:_i.TCMNT,"xmlns:x":Oa[0]}).replace(/[\/]>/,">")];return s.forEach(function(e,i){t.push(Be("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function $R(s){var t={};t.iauthor=s.read_shift(4);var e=Ia(s);return t.rfx=e.s,t.ref=ot(e.s),s.l+=16,t}function qR(s,t){return t==null&&(t=Ce(36)),t.write_shift(4,s[1].iauthor),Po(s[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var GR=rr;function XR(s){return Vi(s.slice(0,54))}function KR(s,t){var e=[],i=[],r={},n=!1;return an(s,function(o,l,h){switch(h){case 632:i.push(o);break;case 635:r=o;break;case 637:r.t=o.t,r.h=o.h,r.r=o.r;break;case 636:if(r.author=i[r.iauthor],delete r.iauthor,t.sheetRows&&r.rfx&&t.sheetRows<=r.rfx.r)break;r.t||(r.t=""),delete r.rfx,e.push(r);break;case 3072:break;case 35:n=!0;break;case 36:n=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!n||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),e}function YR(s){var t=Dr(),e=[];return De(t,628),De(t,630),s.forEach(function(i){i[1].forEach(function(r){e.indexOf(r.a)>-1||(e.push(r.a.slice(0,54)),De(t,632,XR(r.a)))})}),De(t,631),De(t,633),s.forEach(function(i){i[1].forEach(function(r){r.iauthor=e.indexOf(r.a);var n={s:oi(i[0]),e:oi(i[0])};De(t,635,qR([n,r])),r.t&&r.t.length>0&&De(t,637,bO(r)),De(t,636),delete r.iauthor})}),De(t,634),De(t,629),t.end()}var JR="application/vnd.ms-office.vbaProject";function QR(s){var t=rt.utils.cfb_new({root:"R"});return s.FullPaths.forEach(function(e,i){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var r=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");rt.utils.cfb_add(t,r,s.FileIndex[i].content)}}),rt.write(t)}function ZR(s,t){t.FullPaths.forEach(function(e,i){if(i!=0){var r=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&rt.utils.cfb_add(s,r,t.FileIndex[i].content)}})}var kC=["xlsb","xlsm","xlam","biff8","xla"];function eI(){return{"!type":"dialog"}}function tI(){return{"!type":"dialog"}}function iI(){return{"!type":"macro"}}function rI(){return{"!type":"macro"}}var bo=function(){var s=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(i,r,n,a){var o=!1,l=!1;n.length==0?l=!0:n.charAt(0)=="["&&(l=!0,n=n.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var h=n.length>0?parseInt(n,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?h+=t.r:--h,r+(o?"":"$")+ei(u)+(l?"":"$")+di(h)}return function(r,n){return t=n,r.replace(s,e)}}(),$m=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,qm=function(){return function(t,e){return t.replace($m,function(i,r,n,a,o,l){var h=Im(a)-(n?0:e.c),u=Rm(l)-(o?0:e.r),c=u==0?"":o?u+1:"["+u+"]",f=h==0?"":n?h+1:"["+h+"]";return r+"R"+c+"C"+f})}}();function TC(s,t){return s.replace($m,function(e,i,r,n,a,o){return i+(r=="$"?r+n:ei(Im(n)+t.c))+(a=="$"?a+o:di(Rm(o)+t.r))})}function sI(s,t,e){var i=yr(t),r=i.s,n=oi(e),a={r:n.r-r.r,c:n.c-r.c};return TC(s,a)}function nI(s){return s.length!=1}function Sg(s){return s.replace(/_xlfn\./g,"")}function Ci(s){s.l+=1}function Rn(s,t){var e=s.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function AC(s,t,e){var i=2;if(e){if(e.biff>=2&&e.biff<=5)return OC(s);e.biff==12&&(i=4)}var r=s.read_shift(i),n=s.read_shift(i),a=Rn(s),o=Rn(s);return{s:{r,c:a[0],cRel:a[1],rRel:a[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function OC(s){var t=Rn(s),e=Rn(s),i=s.read_shift(1),r=s.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:e[0],c:r,cRel:e[1],rRel:e[2]}}}function aI(s,t,e){if(e.biff<8)return OC(s);var i=s.read_shift(e.biff==12?4:2),r=s.read_shift(e.biff==12?4:2),n=Rn(s),a=Rn(s);return{s:{r:i,c:n[0],cRel:n[1],rRel:n[2]},e:{r,c:a[0],cRel:a[1],rRel:a[2]}}}function DC(s,t,e){if(e&&e.biff>=2&&e.biff<=5)return oI(s);var i=s.read_shift(e&&e.biff==12?4:2),r=Rn(s);return{r:i,c:r[0],cRel:r[1],rRel:r[2]}}function oI(s){var t=Rn(s),e=s.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function lI(s){var t=s.read_shift(2),e=s.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function hI(s,t,e){var i=e&&e.biff?e.biff:8;if(i>=2&&i<=5)return uI(s);var r=s.read_shift(i>=12?4:2),n=s.read_shift(2),a=(n&16384)>>14,o=(n&32768)>>15;if(n&=16383,o==1)for(;r>524287;)r-=1048576;if(a==1)for(;n>8191;)n=n-16384;return{r,c:n,cRel:a,rRel:o}}function uI(s){var t=s.read_shift(2),e=s.read_shift(1),i=(t&32768)>>15,r=(t&16384)>>14;return t&=16383,i==1&&t>=8192&&(t=t-16384),r==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:r,rRel:i}}function cI(s,t,e){var i=(s[s.l++]&96)>>5,r=AC(s,e.biff>=2&&e.biff<=5?6:8,e);return[i,r]}function fI(s,t,e){var i=(s[s.l++]&96)>>5,r=s.read_shift(2,"i"),n=8;if(e)switch(e.biff){case 5:s.l+=12,n=6;break;case 12:n=12;break}var a=AC(s,n,e);return[i,r,a]}function dI(s,t,e){var i=(s[s.l++]&96)>>5;return s.l+=e&&e.biff>8?12:e.biff<8?6:8,[i]}function pI(s,t,e){var i=(s[s.l++]&96)>>5,r=s.read_shift(2),n=8;if(e)switch(e.biff){case 5:s.l+=12,n=6;break;case 12:n=12;break}return s.l+=n,[i,r]}function mI(s,t,e){var i=(s[s.l++]&96)>>5,r=aI(s,t-1,e);return[i,r]}function vI(s,t,e){var i=(s[s.l++]&96)>>5;return s.l+=e.biff==2?6:e.biff==12?14:7,[i]}function kg(s){var t=s[s.l+1]&1,e=1;return s.l+=4,[t,e]}function gI(s,t,e){s.l+=2;for(var i=s.read_shift(e&&e.biff==2?1:2),r=[],n=0;n<=i;++n)r.push(s.read_shift(e&&e.biff==2?1:2));return r}function bI(s,t,e){var i=s[s.l+1]&255?1:0;return s.l+=2,[i,s.read_shift(e&&e.biff==2?1:2)]}function yI(s,t,e){var i=s[s.l+1]&255?1:0;return s.l+=2,[i,s.read_shift(e&&e.biff==2?1:2)]}function xI(s){var t=s[s.l+1]&255?1:0;return s.l+=2,[t,s.read_shift(2)]}function CI(s,t,e){var i=s[s.l+1]&255?1:0;return s.l+=e&&e.biff==2?3:4,[i]}function LC(s){var t=s.read_shift(1),e=s.read_shift(1);return[t,e]}function wI(s){return s.read_shift(2),LC(s)}function EI(s){return s.read_shift(2),LC(s)}function SI(s,t,e){var i=(s[s.l]&96)>>5;s.l+=1;var r=DC(s,0,e);return[i,r]}function kI(s,t,e){var i=(s[s.l]&96)>>5;s.l+=1;var r=hI(s,0,e);return[i,r]}function TI(s,t,e){var i=(s[s.l]&96)>>5;s.l+=1;var r=s.read_shift(2);e&&e.biff==5&&(s.l+=12);var n=DC(s,0,e);return[i,r,n]}function AI(s,t,e){var i=(s[s.l]&96)>>5;s.l+=1;var r=s.read_shift(e&&e.biff<=3?1:2);return[L_[r],_C[r],i]}function OI(s,t,e){var i=s[s.l++],r=s.read_shift(1),n=e&&e.biff<=3?[i==88?-1:0,s.read_shift(1)]:DI(s);return[r,(n[0]===0?_C:D_)[n[1]]]}function DI(s){return[s[s.l+1]>>7,s.read_shift(2)&32767]}function LI(s,t,e){s.l+=e&&e.biff==2?3:4}function RI(s,t,e){if(s.l++,e&&e.biff==12)return[s.read_shift(4,"i"),0];var i=s.read_shift(2),r=s.read_shift(e&&e.biff==2?1:2);return[i,r]}function II(s){return s.l++,on[s.read_shift(1)]}function _I(s){return s.l++,s.read_shift(2)}function FI(s){return s.l++,s.read_shift(1)!==0}function NI(s){return s.l++,tr(s)}function MI(s,t,e){return s.l++,bh(s,t-1,e)}function PI(s,t){var e=[s.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=gi(s,1)?"TRUE":"FALSE",t!=12&&(s.l+=7);break;case 37:case 16:e[1]=on[s[s.l]],s.l+=t==12?4:8;break;case 0:s.l+=8;break;case 1:e[1]=tr(s);break;case 2:e[1]=_a(s,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function BI(s,t,e){for(var i=s.read_shift(e.biff==12?4:2),r=[],n=0;n!=i;++n)r.push((e.biff==12?Ia:Wc)(s));return r}function HI(s,t,e){var i=0,r=0;e.biff==12?(i=s.read_shift(4),r=s.read_shift(4)):(r=1+s.read_shift(1),i=1+s.read_shift(2)),e.biff>=2&&e.biff<8&&(--i,--r==0&&(r=256));for(var n=0,a=[];n!=i&&(a[n]=[]);++n)for(var o=0;o!=r;++o)a[n][o]=PI(s,e.biff);return a}function VI(s,t,e){var i=s.read_shift(1)>>>5&3,r=!e||e.biff>=8?4:2,n=s.read_shift(r);switch(e.biff){case 2:s.l+=5;break;case 3:case 4:s.l+=8;break;case 5:s.l+=12;break}return[i,0,n]}function WI(s,t,e){if(e.biff==5)return zI(s);var i=s.read_shift(1)>>>5&3,r=s.read_shift(2),n=s.read_shift(4);return[i,r,n]}function zI(s){var t=s.read_shift(1)>>>5&3,e=s.read_shift(2,"i");s.l+=8;var i=s.read_shift(2);return s.l+=12,[t,e,i]}function jI(s,t,e){var i=s.read_shift(1)>>>5&3;s.l+=e&&e.biff==2?3:4;var r=s.read_shift(e&&e.biff==2?1:2);return[i,r]}function UI(s,t,e){var i=s.read_shift(1)>>>5&3,r=s.read_shift(e&&e.biff==2?1:2);return[i,r]}function $I(s,t,e){var i=s.read_shift(1)>>>5&3;return s.l+=4,e.biff<8&&s.l--,e.biff==12&&(s.l+=2),[i]}function qI(s,t,e){var i=(s[s.l++]&96)>>5,r=s.read_shift(2),n=4;if(e)switch(e.biff){case 5:n=15;break;case 12:n=6;break}return s.l+=n,[i,r]}var GI=sr,XI=sr,KI=sr;function xh(s,t,e){return s.l+=2,[lI(s)]}function Gm(s){return s.l+=6,[]}var YI=xh,JI=Gm,QI=Gm,ZI=xh;function RC(s){return s.l+=2,[Ai(s),s.read_shift(2)&1]}var e_=xh,t_=RC,i_=Gm,r_=xh,s_=xh,n_=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function a_(s){s.l+=2;var t=s.read_shift(2),e=s.read_shift(2),i=s.read_shift(4),r=s.read_shift(2),n=s.read_shift(2),a=n_[e>>2&31];return{ixti:t,coltype:e&3,rt:a,idx:i,c:r,C:n}}function o_(s){return s.l+=2,[s.read_shift(4)]}function l_(s,t,e){return s.l+=5,s.l+=2,s.l+=e.biff==2?1:4,["PTGSHEET"]}function h_(s,t,e){return s.l+=e.biff==2?4:5,["PTGENDSHEET"]}function u_(s){var t=s.read_shift(1)>>>5&3,e=s.read_shift(2);return[t,e]}function c_(s){var t=s.read_shift(1)>>>5&3,e=s.read_shift(2);return[t,e]}function f_(s){return s.l+=4,[0,0]}var Tg={1:{n:"PtgExp",f:RI},2:{n:"PtgTbl",f:KI},3:{n:"PtgAdd",f:Ci},4:{n:"PtgSub",f:Ci},5:{n:"PtgMul",f:Ci},6:{n:"PtgDiv",f:Ci},7:{n:"PtgPower",f:Ci},8:{n:"PtgConcat",f:Ci},9:{n:"PtgLt",f:Ci},10:{n:"PtgLe",f:Ci},11:{n:"PtgEq",f:Ci},12:{n:"PtgGe",f:Ci},13:{n:"PtgGt",f:Ci},14:{n:"PtgNe",f:Ci},15:{n:"PtgIsect",f:Ci},16:{n:"PtgUnion",f:Ci},17:{n:"PtgRange",f:Ci},18:{n:"PtgUplus",f:Ci},19:{n:"PtgUminus",f:Ci},20:{n:"PtgPercent",f:Ci},21:{n:"PtgParen",f:Ci},22:{n:"PtgMissArg",f:Ci},23:{n:"PtgStr",f:MI},26:{n:"PtgSheet",f:l_},27:{n:"PtgEndSheet",f:h_},28:{n:"PtgErr",f:II},29:{n:"PtgBool",f:FI},30:{n:"PtgInt",f:_I},31:{n:"PtgNum",f:NI},32:{n:"PtgArray",f:vI},33:{n:"PtgFunc",f:AI},34:{n:"PtgFuncVar",f:OI},35:{n:"PtgName",f:VI},36:{n:"PtgRef",f:SI},37:{n:"PtgArea",f:cI},38:{n:"PtgMemArea",f:jI},39:{n:"PtgMemErr",f:GI},40:{n:"PtgMemNoMem",f:XI},41:{n:"PtgMemFunc",f:UI},42:{n:"PtgRefErr",f:$I},43:{n:"PtgAreaErr",f:dI},44:{n:"PtgRefN",f:kI},45:{n:"PtgAreaN",f:mI},46:{n:"PtgMemAreaN",f:u_},47:{n:"PtgMemNoMemN",f:c_},57:{n:"PtgNameX",f:WI},58:{n:"PtgRef3d",f:TI},59:{n:"PtgArea3d",f:fI},60:{n:"PtgRefErr3d",f:qI},61:{n:"PtgAreaErr3d",f:pI},255:{}},d_={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},p_={1:{n:"PtgElfLel",f:RC},2:{n:"PtgElfRw",f:r_},3:{n:"PtgElfCol",f:YI},6:{n:"PtgElfRwV",f:s_},7:{n:"PtgElfColV",f:ZI},10:{n:"PtgElfRadical",f:e_},11:{n:"PtgElfRadicalS",f:i_},13:{n:"PtgElfColS",f:JI},15:{n:"PtgElfColSV",f:QI},16:{n:"PtgElfRadicalLel",f:t_},25:{n:"PtgList",f:a_},29:{n:"PtgSxName",f:o_},255:{}},m_={0:{n:"PtgAttrNoop",f:f_},1:{n:"PtgAttrSemi",f:CI},2:{n:"PtgAttrIf",f:yI},4:{n:"PtgAttrChoose",f:gI},8:{n:"PtgAttrGoto",f:bI},16:{n:"PtgAttrSum",f:LI},32:{n:"PtgAttrBaxcel",f:kg},33:{n:"PtgAttrBaxcel",f:kg},64:{n:"PtgAttrSpace",f:wI},65:{n:"PtgAttrSpaceSemi",f:EI},128:{n:"PtgAttrIfError",f:xI},255:{}};function Ch(s,t,e,i){if(i.biff<8)return sr(s,t);for(var r=s.l+t,n=[],a=0;a!==e.length;++a)switch(e[a][0]){case"PtgArray":e[a][1]=HI(s,0,i),n.push(e[a][1]);break;case"PtgMemArea":e[a][2]=BI(s,e[a][1],i),n.push(e[a][2]);break;case"PtgExp":i&&i.biff==12&&(e[a][1][1]=s.read_shift(4),n.push(e[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[a][0]}return t=r-s.l,t!==0&&n.push(sr(s,t)),n}function wh(s,t,e){for(var i=s.l+t,r,n,a=[];i!=s.l;)t=i-s.l,n=s[s.l],r=Tg[n]||Tg[d_[n]],(n===24||n===25)&&(r=(n===24?p_:m_)[s[s.l+1]]),!r||!r.f?sr(s,t):a.push([r.n,r.f(s,t,e)]);return a}function v_(s){for(var t=[],e=0;e<s.length;++e){for(var i=s[e],r=[],n=0;n<i.length;++n){var a=i[n];if(a)switch(a[0]){case 2:r.push('"'+a[1].replace(/"/g,'""')+'"');break;default:r.push(a[1])}else r.push("")}t.push(r.join(","))}return t.join(";")}var g_={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function b_(s,t){if(!s&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(s)?"'"+s+"'":s}function IC(s,t,e){if(!s)return"SH33TJSERR0";if(e.biff>8&&(!s.XTI||!s.XTI[t]))return s.SheetNames[t];if(!s.XTI)return"SH33TJSERR6";var i=s.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":s.XTI[t-1];if(!i)return"SH33TJSERR1";var r="";if(e.biff>8)switch(s[i[0]][0]){case 357:return r=i[1]==-1?"#REF":s.SheetNames[i[1]],i[1]==i[2]?r:r+":"+s.SheetNames[i[2]];case 358:return e.SID!=null?s.SheetNames[e.SID]:"SH33TJSSAME"+s[i[0]][0];case 355:default:return"SH33TJSSRC"+s[i[0]][0]}switch(s[i[0]][0][0]){case 1025:return r=i[1]==-1?"#REF":s.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?r:r+":"+s.SheetNames[i[2]];case 14849:return s[i[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return s[i[0]][0][3]?(r=i[1]==-1?"#REF":s[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?r:r+":"+s[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function Ag(s,t,e){var i=IC(s,t,e);return i=="#REF"?i:b_(i,e)}function Qi(s,t,e,i,r){var n=r&&r.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,h,u,c=0,f=0,d,p="";if(!s[0]||!s[0][0])return"";for(var v=-1,g="",b=0,C=s[0].length;b<C;++b){var y=s[0][b];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),h=o.pop(),v>=0){switch(s[0][v][1][0]){case 0:g=ci(" ",s[0][v][1][1]);break;case 1:g=ci("\r",s[0][v][1][1]);break;default:if(g="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][v][1][0])}h=h+g,v=-1}o.push(h+g_[y[0]]+l);break;case"PtgIsect":l=o.pop(),h=o.pop(),o.push(h+" "+l);break;case"PtgUnion":l=o.pop(),h=o.pop(),o.push(h+","+l);break;case"PtgRange":l=o.pop(),h=o.pop(),o.push(h+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Fl(y[1][1],a,r),o.push(Nl(u,n));break;case"PtgRefN":u=e?Fl(y[1][1],e,r):y[1][1],o.push(Nl(u,n));break;case"PtgRef3d":c=y[1][1],u=Fl(y[1][2],a,r),p=Ag(i,c,r),o.push(p+"!"+Nl(u,n));break;case"PtgFunc":case"PtgFuncVar":var x=y[1][0],w=y[1][1];x||(x=0),x&=127;var S=x==0?[]:o.slice(-x);o.length-=x,w==="User"&&(w=S.shift()),o.push(w+"("+S.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":d=ig(y[1][1],e?{s:e}:a,r),o.push(Tf(d,r));break;case"PtgArea":d=ig(y[1][1],a,r),o.push(Tf(d,r));break;case"PtgArea3d":c=y[1][1],d=y[1][2],p=Ag(i,c,r),o.push(p+"!"+Tf(d,r));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var E=(i.names||[])[f-1]||(i[0]||[])[f],k=E?E.Name:"SH33TJSNAME"+String(f);k&&k.slice(0,6)=="_xlfn."&&!r.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var A=y[1][1];f=y[1][2];var z;if(r.biff<=5)A<0&&(A=-A),i[A]&&(z=i[A][f]);else{var D="";if(((i[A]||[])[0]||[])[0]==14849||(((i[A]||[])[0]||[])[0]==1025?i[A][f]&&i[A][f].itab>0&&(D=i.SheetNames[i[A][f].itab-1]+"!"):D=i.SheetNames[f-1]+"!"),i[A]&&i[A][f])D+=i[A][f].Name;else if(i[0]&&i[0][f])D+=i[0][f].Name;else{var T=(IC(i,A,r)||"").split(";;");T[f-1]?D=T[f-1]:D+="SH33TJSERRX"}o.push(D);break}z||(z={Name:"SH33TJSERRY"}),o.push(z.Name);break;case"PtgParen":var M="(",K=")";if(v>=0){switch(g="",s[0][v][1][0]){case 2:M=ci(" ",s[0][v][1][1])+M;break;case 3:M=ci("\r",s[0][v][1][1])+M;break;case 4:K=ci(" ",s[0][v][1][1])+K;break;case 5:K=ci("\r",s[0][v][1][1])+K;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][v][1][0])}v=-1}o.push(M+o.pop()+K);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var te={c:e.c,r:e.r};if(i.sharedf[ot(u)]){var ee=i.sharedf[ot(u)];o.push(Qi(ee,a,te,i,r))}else{var J=!1;for(l=0;l!=i.arrayf.length;++l)if(h=i.arrayf[l],!(u.c<h[0].s.c||u.c>h[0].e.c)&&!(u.r<h[0].s.r||u.r>h[0].e.r)){o.push(Qi(h[1],a,te,i,r)),J=!0;break}J||o.push(y[1])}break;case"PtgArray":o.push("{"+v_(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&v>=0&&re.indexOf(s[0][b][0])==-1){y=s[0][v];var j=!0;switch(y[1][0]){case 4:j=!1;case 0:g=ci(" ",y[1][1]);break;case 5:j=!1;case 1:g=ci("\r",y[1][1]);break;default:if(g="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((j?g:"")+o.pop()+(j?"":g)),v=-1}}if(o.length>1&&r.WTF)throw new Error("bad formula stack");return o[0]}function y_(s,t,e){var i=s.l+t,r=e.biff==2?1:2,n,a=s.read_shift(r);if(a==65535)return[[],sr(s,t-2)];var o=wh(s,a,e);return t!==a+r&&(n=Ch(s,t-a-r,o,e)),s.l=i,[o,n]}function x_(s,t,e){var i=s.l+t,r=e.biff==2?1:2,n,a=s.read_shift(r);if(a==65535)return[[],sr(s,t-2)];var o=wh(s,a,e);return t!==a+r&&(n=Ch(s,t-a-r,o,e)),s.l=i,[o,n]}function C_(s,t,e,i){var r=s.l+t,n=wh(s,i,e),a;return r!==s.l&&(a=Ch(s,r-s.l,n,e)),[n,a]}function w_(s,t,e){var i=s.l+t,r,n=s.read_shift(2),a=wh(s,n,e);return n==65535?[[],sr(s,t-2)]:(t!==n+2&&(r=Ch(s,i-n-2,a,e)),[a,r])}function E_(s){var t;if(Js(s,s.l+6)!==65535)return[tr(s),"n"];switch(s[s.l]){case 0:return s.l+=8,["String","s"];case 1:return t=s[s.l+2]===1,s.l+=8,[t,"b"];case 2:return t=s[s.l+2],s.l+=8,[t,"e"];case 3:return s.l+=8,["","s"]}return[]}function S_(s){if(s==null){var t=Ce(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof s=="number")return xa(s);return xa(0)}function Rf(s,t,e){var i=s.l+t,r=Hs(s);e.biff==2&&++s.l;var n=E_(s),a=s.read_shift(1);e.biff!=2&&(s.read_shift(1),e.biff>=5&&s.read_shift(4));var o=x_(s,i-s.l,e);return{cell:r,val:n[0],formula:o,shared:a>>3&1,tt:n[1]}}function k_(s,t,e,i,r){var n=wa(t,e,r),a=S_(s.v),o=Ce(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var h=Ce(s.bf.length),u=0;u<s.bf.length;++u)h[u]=s.bf[u];var c=Hi([n,a,o,h]);return c}function zc(s,t,e){var i=s.read_shift(4),r=wh(s,i,e),n=s.read_shift(4),a=n>0?Ch(s,n,r,e):null;return[r,a]}var T_=zc,jc=zc,A_=zc,O_=zc,D_={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},_C={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},L_={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Og(s){return s.slice(0,3)=="of:"&&(s=s.slice(3)),s.charCodeAt(0)==61&&(s=s.slice(1),s.charCodeAt(0)==61&&(s=s.slice(1))),s=s.replace(/COM\.MICROSOFT\./g,""),s=s.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,e){return e.replace(/\./g,"")}),s=s.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),s.replace(/[;~]/g,",").replace(/\|/g,";")}function R_(s){var t="of:="+s.replace($m,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function If(s){var t=s.split(":"),e=t[0].split(".")[0];return[e,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function I_(s){return s.replace(/\./,"!")}var Pl={},yo={},Bl=typeof Map<"u";function Xm(s,t,e){var i=0,r=s.length;if(e){if(Bl?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var n=Bl?e.get(t):e[t];i<n.length;++i)if(s[n[i]].t===t)return s.Count++,n[i]}}else for(;i<r;++i)if(s[i].t===t)return s.Count++,i;return s[r]={t},s.Count++,s.Unique++,e&&(Bl?(e.has(t)||e.set(t,[]),e.get(t).push(r)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(r))),r}function Uc(s,t){var e={min:s+1,max:s+1},i=-1;return t.MDW&&(er=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?i=nh(t.wpx):t.wch!=null&&(i=t.wch),i>-1?(e.width=uc(i),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function fa(s,t){if(s){var e=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(e=[1,1,1,1,.5,.5]),s.left==null&&(s.left=e[0]),s.right==null&&(s.right=e[1]),s.top==null&&(s.top=e[2]),s.bottom==null&&(s.bottom=e[3]),s.header==null&&(s.header=e[4]),s.footer==null&&(s.footer=e[5])}}function Pn(s,t,e){var i=e.revssf[t.z!=null?t.z:"General"],r=60,n=s.length;if(i==null&&e.ssf){for(;r<392;++r)if(e.ssf[r]==null){Fs(t.z,r),e.ssf[r]=t.z,e.revssf[t.z]=i=r;break}}for(r=0;r!=n;++r)if(s[r].numFmtId===i)return r;return s[n]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}function FC(s,t,e,i,r,n){try{i.cellNF&&(s.z=nt[t])}catch(o){if(i.WTF)throw o}if(!(s.t==="z"&&!i.cellStyles)){if(s.t==="d"&&typeof s.v=="string"&&(s.v=ti(s.v)),(!i||i.cellText!==!1)&&s.t!=="z")try{if(nt[t]==null&&Fs(OA[t]||"General",t),s.t==="e")s.w=s.w||on[s.v];else if(t===0)if(s.t==="n")(s.v|0)===s.v?s.w=s.v.toString(10):s.w=Ql(s.v);else if(s.t==="d"){var a=Fi(s.v);(a|0)===a?s.w=a.toString(10):s.w=Ql(a)}else{if(s.v===void 0)return"";s.w=ba(s.v,yo)}else s.t==="d"?s.w=Gr(t,Fi(s.v),yo):s.w=Gr(t,s.v,yo)}catch(o){if(i.WTF)throw o}if(i.cellStyles&&e!=null)try{s.s=n.Fills[e],s.s.fgColor&&s.s.fgColor.theme&&!s.s.fgColor.rgb&&(s.s.fgColor.rgb=hc(r.themeElements.clrScheme[s.s.fgColor.theme].rgb,s.s.fgColor.tint||0),i.WTF&&(s.s.fgColor.raw_rgb=r.themeElements.clrScheme[s.s.fgColor.theme].rgb)),s.s.bgColor&&s.s.bgColor.theme&&(s.s.bgColor.rgb=hc(r.themeElements.clrScheme[s.s.bgColor.theme].rgb,s.s.bgColor.tint||0),i.WTF&&(s.s.bgColor.raw_rgb=r.themeElements.clrScheme[s.s.bgColor.theme].rgb))}catch(o){if(i.WTF&&n.Fills)throw o}}}function __(s,t,e){if(s&&s["!ref"]){var i=Et(s["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+e+"): "+s["!ref"])}}function F_(s,t){var e=Et(t);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(s["!ref"]=ct(e))}var N_=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,M_=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,P_=/<(?:\w:)?hyperlink [^>]*>/mg,B_=/"(\w*:\w*)"/,H_=/<(?:\w:)?col\b[^>]*[\/]?>/g,V_=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,W_=/<(?:\w:)?pageMargins[^>]*\/>/g,NC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,z_=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,j_=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function U_(s,t,e,i,r,n,a){if(!s)return s;i||(i={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",u="",c=s.match(M_);c?(h=s.slice(0,c.index),u=s.slice(c.index+c[0].length)):h=u=s;var f=h.match(NC);f?Km(f[0],o,r,e):(f=h.match(z_))&&q_(f[0],f[1]||"",o,r,e);var d=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var p=h.slice(d,d+50).match(B_);p&&F_(o,p[1])}var v=h.match(j_);v&&v[1]&&nF(v[1],r);var g=[];if(t.cellStyles){var b=h.match(H_);b&&eF(g,b)}c&&lF(c[1],o,t,l,n,a);var C=u.match(V_);C&&(o["!autofilter"]=iF(C[0]));var y=[],x=u.match(N_);if(x)for(d=0;d!=x.length;++d)y[d]=Et(x[d].slice(x[d].indexOf('"')+1));var w=u.match(P_);w&&J_(o,w,i);var S=u.match(W_);if(S&&(o["!margins"]=Q_(lt(S[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=ct(l)),t.sheetRows>0&&o["!ref"]){var E=Et(o["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=ct(E))}return g.length>0&&(o["!cols"]=g),y.length>0&&(o["!merges"]=y),o}function $_(s){if(s.length===0)return"";for(var t='<mergeCells count="'+s.length+'">',e=0;e!=s.length;++e)t+='<mergeCell ref="'+ct(s[e])+'"/>';return t+"</mergeCells>"}function Km(s,t,e,i){var r=lt(s);e.Sheets[i]||(e.Sheets[i]={}),r.codeName&&(e.Sheets[i].CodeName=Dt(Ht(r.codeName)))}function q_(s,t,e,i,r){Km(s.slice(0,s.indexOf(">")),e,i,r)}function G_(s,t,e,i,r){var n=!1,a={},o=null;if(i.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[e];try{t.Workbook&&(l=t.Workbook.Sheets[e].CodeName||l)}catch(u){}n=!0,a.codeName=Rs(Pt(l))}if(s&&s["!outline"]){var h={summaryBelow:1,summaryRight:1};s["!outline"].above&&(h.summaryBelow=0),s["!outline"].left&&(h.summaryRight=0),o=(o||"")+Be("outlinePr",null,h)}!n&&!o||(r[r.length]=Be("sheetPr",o,a))}var X_=["objects","scenarios","selectLockedCells","selectUnlockedCells"],K_=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Y_(s){var t={sheet:1};return X_.forEach(function(e){s[e]!=null&&s[e]&&(t[e]="1")}),K_.forEach(function(e){s[e]!=null&&!s[e]&&(t[e]="0")}),s.password&&(t.password=zm(s.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function J_(s,t,e){for(var i=Array.isArray(s),r=0;r!=t.length;++r){var n=lt(Ht(t[r]),!0);if(!n.ref)return;var a=((e||{})["!id"]||[])[n.id];a?(n.Target=a.Target,n.location&&(n.Target+="#"+Dt(n.location))):(n.Target="#"+Dt(n.location),a={Target:n.Target,TargetMode:"Internal"}),n.Rel=a,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var o=Et(n.ref),l=o.s.r;l<=o.e.r;++l)for(var h=o.s.c;h<=o.e.c;++h){var u=ot({c:h,r:l});i?(s[l]||(s[l]=[]),s[l][h]||(s[l][h]={t:"z",v:void 0}),s[l][h].l=n):(s[u]||(s[u]={t:"z",v:void 0}),s[u].l=n)}}}function Q_(s){var t={};return["left","right","top","bottom","header","footer"].forEach(function(e){s[e]&&(t[e]=parseFloat(s[e]))}),t}function Z_(s){return fa(s),Be("pageMargins",null,s)}function eF(s,t){for(var e=!1,i=0;i!=t.length;++i){var r=lt(t[i],!0);r.hidden&&(r.hidden=Zt(r.hidden));var n=parseInt(r.min,10)-1,a=parseInt(r.max,10)-1;for(r.outlineLevel&&(r.level=+r.outlineLevel||0),delete r.min,delete r.max,r.width=+r.width,!e&&r.width&&(e=!0,jm(r.width)),Ln(r);n<=a;)s[n++]=Ut(r)}}function tF(s,t){for(var e=["<cols>"],i,r=0;r!=t.length;++r)(i=t[r])&&(e[e.length]=Be("col",null,Uc(r,i)));return e[e.length]="</cols>",e.join("")}function iF(s){var t={ref:(s.match(/ref="([^"]*)"/)||[])[1]};return t}function rF(s,t,e,i){var r=typeof s.ref=="string"?s.ref:ct(s.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var n=e.Workbook.Names,a=yr(r);a.s.r==a.e.r&&(a.e.r=yr(t["!ref"]).e.r,r=ct(a));for(var o=0;o<n.length;++o){var l=n[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==i){l.Ref="'"+e.SheetNames[i]+"'!"+r;break}}return o==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+r}),Be("autoFilter",null,{ref:r})}var sF=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function nF(s,t){t.Views||(t.Views=[{}]),(s.match(sF)||[]).forEach(function(e,i){var r=lt(e);t.Views[i]||(t.Views[i]={}),+r.zoomScale&&(t.Views[i].zoom=+r.zoomScale),Zt(r.rightToLeft)&&(t.Views[i].RTL=!0)})}function aF(s,t,e,i){var r={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,r),{})}function oF(s,t,e,i){if(s.c&&e["!comments"].push([t,s.c]),s.v===void 0&&typeof s.f!="string"||s.t==="z"&&!s.f)return"";var r="",n=s.t,a=s.v;if(s.t!=="z")switch(s.t){case"b":r=s.v?"1":"0";break;case"n":r=""+s.v;break;case"e":r=on[s.v];break;case"d":i&&i.cellDates?r=ti(s.v,-1).toISOString():(s=Ut(s),s.t="n",r=""+(s.v=Fi(ti(s.v)))),typeof s.z>"u"&&(s.z=nt[14]);break;default:r=s.v;break}var o=qi("v",Pt(r)),l={r:t},h=Pn(i.cellXfs,s,i);switch(h!==0&&(l.s=h),s.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(s.v==null){delete s.t;break}if(s.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){o=qi("v",""+Xm(i.Strings,s.v,i.revStrings)),l.t="s";break}l.t="str";break}if(s.t!=n&&(s.t=n,s.v=a),typeof s.f=="string"&&s.f){var u=s.F&&s.F.slice(0,t.length)==t?{t:"array",ref:s.F}:null;o=Be("f",Pt(s.f),u)+(s.v!=null?o:"")}return s.l&&e["!links"].push([t,s.l]),s.D&&(l.cm=1),Be("c",o,l)}var lF=function(){var s=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,r=/ref=["']([^"']*)["']/,n=Zl("v"),a=Zl("f");return function(l,h,u,c,f,d){for(var p=0,v="",g=[],b=[],C=0,y=0,x=0,w="",S,E,k=0,A=0,z,D,T=0,M=0,K=Array.isArray(d.CellXf),te,ee=[],J=[],re=Array.isArray(h),j=[],de={},we=!1,N=!!u.sheetStubs,H=l.split(t),L=0,_=H.length;L!=_;++L){v=H[L].trim();var U=v.length;if(U!==0){var se=0;e:for(p=0;p<U;++p)switch(v[p]){case">":if(v[p-1]!="/"){++p;break e}if(u&&u.cellStyles){if(E=lt(v.slice(se,p),!0),k=E.r!=null?parseInt(E.r,10):k+1,A=-1,u.sheetRows&&u.sheetRows<k)continue;de={},we=!1,E.ht&&(we=!0,de.hpt=parseFloat(E.ht),de.hpx=Oo(de.hpt)),E.hidden=="1"&&(we=!0,de.hidden=!0),E.outlineLevel!=null&&(we=!0,de.level=+E.outlineLevel),we&&(j[k-1]=de)}break;case"<":se=p;break}if(se>=p)break;if(E=lt(v.slice(se,p),!0),k=E.r!=null?parseInt(E.r,10):k+1,A=-1,!(u.sheetRows&&u.sheetRows<k)){c.s.r>k-1&&(c.s.r=k-1),c.e.r<k-1&&(c.e.r=k-1),u&&u.cellStyles&&(de={},we=!1,E.ht&&(we=!0,de.hpt=parseFloat(E.ht),de.hpx=Oo(de.hpt)),E.hidden=="1"&&(we=!0,de.hidden=!0),E.outlineLevel!=null&&(we=!0,de.level=+E.outlineLevel),we&&(j[k-1]=de)),g=v.slice(p).split(s);for(var ae=0;ae!=g.length&&g[ae].trim().charAt(0)=="<";++ae);for(g=g.slice(ae),p=0;p!=g.length;++p)if(v=g[p].trim(),v.length!==0){if(b=v.match(e),C=p,y=0,x=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,b!=null&&b.length===2){for(C=0,w=b[1],y=0;y!=w.length&&!((x=w.charCodeAt(y)-64)<1||x>26);++y)C=26*C+x;--C,A=C}else++A;for(y=0;y!=v.length&&v.charCodeAt(y)!==62;++y);if(++y,E=lt(v.slice(0,y),!0),E.r||(E.r=ot({r:k-1,c:A})),w=v.slice(y),S={t:""},(b=w.match(n))!=null&&b[1]!==""&&(S.v=Dt(b[1])),u.cellFormula){if((b=w.match(a))!=null&&b[1]!==""){if(S.f=Dt(Ht(b[1])).replace(/\r\n/g,"\n"),u.xlfn||(S.f=Sg(S.f)),b[0].indexOf('t="array"')>-1)S.F=(w.match(r)||[])[1],S.F.indexOf(":")>-1&&ee.push([Et(S.F),S.F]);else if(b[0].indexOf('t="shared"')>-1){D=lt(b[0]);var oe=Dt(Ht(b[1]));u.xlfn||(oe=Sg(oe)),J[parseInt(D.si,10)]=[D,oe,E.r]}}else(b=w.match(/<f[^>]*\/>/))&&(D=lt(b[0]),J[D.si]&&(S.f=sI(J[D.si][1],J[D.si][2],E.r)));var me=oi(E.r);for(y=0;y<ee.length;++y)me.r>=ee[y][0].s.r&&me.r<=ee[y][0].e.r&&me.c>=ee[y][0].s.c&&me.c<=ee[y][0].e.c&&(S.F=ee[y][1])}if(E.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else if(N)S.t="z";else continue;else S.t=E.t||"n";switch(c.s.c>A&&(c.s.c=A),c.e.c<A&&(c.e.c=A),S.t){case"n":if(S.v==""||S.v==null){if(!N)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!N)continue;S.t="z"}else z=Pl[parseInt(S.v,10)],S.v=z.t,S.r=z.r,u.cellHTML&&(S.h=z.h);break;case"str":S.t="s",S.v=S.v!=null?Ht(S.v):"",u.cellHTML&&(S.h=Em(S.v));break;case"inlineStr":b=w.match(i),S.t="s",b!=null&&(z=Wm(b[1]))?(S.v=z.t,u.cellHTML&&(S.h=z.h)):S.v="";break;case"b":S.v=Zt(S.v);break;case"d":u.cellDates?S.v=ti(S.v,1):(S.v=Fi(ti(S.v,1)),S.t="n");break;case"e":(!u||u.cellText!==!1)&&(S.w=S.v),S.v=Px[S.v];break}if(T=M=0,te=null,K&&E.s!==void 0&&(te=d.CellXf[E.s],te!=null&&(te.numFmtId!=null&&(T=te.numFmtId),u.cellStyles&&te.fillId!=null&&(M=te.fillId))),FC(S,T,M,u,f,d),u.cellDates&&K&&S.t=="n"&&Aa(nt[T])&&(S.t="d",S.v=Hc(S.v)),E.cm&&u.xlmeta){var Re=(u.xlmeta.Cell||[])[+E.cm-1];Re&&Re.type=="XLDAPR"&&(S.D=!0)}if(re){var V=oi(E.r);h[V.r]||(h[V.r]=[]),h[V.r][V.c]=S}else h[E.r]=S}}}}j.length>0&&(h["!rows"]=j)}}();function hF(s,t,e,i){var r=[],n=[],a=Et(s["!ref"]),o="",l,h="",u=[],c=0,f=0,d=s["!rows"],p=Array.isArray(s),v={r:h},g,b=-1;for(f=a.s.c;f<=a.e.c;++f)u[f]=ei(f);for(c=a.s.r;c<=a.e.r;++c){for(n=[],h=di(c),f=a.s.c;f<=a.e.c;++f){l=u[f]+h;var C=p?(s[c]||[])[f]:s[l];C!==void 0&&(o=oF(C,l,s,t))!=null&&n.push(o)}(n.length>0||d&&d[c])&&(v={r:h},d&&d[c]&&(g=d[c],g.hidden&&(v.hidden=1),b=-1,g.hpx?b=ah(g.hpx):g.hpt&&(b=g.hpt),b>-1&&(v.ht=b,v.customHeight=1),g.level&&(v.outlineLevel=g.level)),r[r.length]=Be("row",n.join(""),v))}if(d)for(;c<d.length;++c)d&&d[c]&&(v={r:c+1},g=d[c],g.hidden&&(v.hidden=1),b=-1,g.hpx?b=ah(g.hpx):g.hpt&&(b=g.hpt),b>-1&&(v.ht=b,v.customHeight=1),g.level&&(v.outlineLevel=g.level),r[r.length]=Be("row","",v));return r.join("")}function MC(s,t,e,i){var r=[yi,Be("worksheet",null,{xmlns:Oa[0],"xmlns:r":_i.r})],n=e.SheetNames[s],a=0,o="",l=e.Sheets[n];l==null&&(l={});var h=l["!ref"]||"A1",u=Et(h);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),h=ct(u)}i||(i={}),l["!comments"]=[];var c=[];G_(l,e,s,t,r),r[r.length]=Be("dimension",null,{ref:h}),r[r.length]=aF(l,t,s,e),t.sheetFormat&&(r[r.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(r[r.length]=tF(l,l["!cols"])),r[a=r.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=hF(l,t),o.length>0&&(r[r.length]=o)),r.length>a+1&&(r[r.length]="</sheetData>",r[a]=r[a].replace("/>",">")),l["!protect"]&&(r[r.length]=Y_(l["!protect"])),l["!autofilter"]!=null&&(r[r.length]=rF(l["!autofilter"],l,e,s)),l["!merges"]!=null&&l["!merges"].length>0&&(r[r.length]=$_(l["!merges"]));var f=-1,d,p=-1;return l["!links"].length>0&&(r[r.length]="<hyperlinks>",l["!links"].forEach(function(v){v[1].Target&&(d={ref:v[0]},v[1].Target.charAt(0)!="#"&&(p=Mt(i,-1,Pt(v[1].Target).replace(/#.*$/,""),bt.HLINK),d["r:id"]="rId"+p),(f=v[1].Target.indexOf("#"))>-1&&(d.location=Pt(v[1].Target.slice(f+1))),v[1].Tooltip&&(d.tooltip=Pt(v[1].Tooltip)),r[r.length]=Be("hyperlink",null,d))}),r[r.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(r[r.length]=Z_(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(r[r.length]=qi("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:h}))),c.length>0&&(p=Mt(i,-1,"../drawings/drawing"+(s+1)+".xml",bt.DRAW),r[r.length]=Be("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=c),l["!comments"].length>0&&(p=Mt(i,-1,"../drawings/vmlDrawing"+(s+1)+".vml",bt.VML),r[r.length]=Be("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function uF(s,t){var e={},i=s.l+t;e.r=s.read_shift(4),s.l+=4;var r=s.read_shift(2);s.l+=1;var n=s.read_shift(1);return s.l=i,n&7&&(e.level=n&7),n&16&&(e.hidden=!0),n&32&&(e.hpt=r/20),e}function cF(s,t,e){var i=Ce(145),r=(e["!rows"]||[])[s]||{};i.write_shift(4,s),i.write_shift(4,0);var n=320;r.hpx?n=ah(r.hpx)*20:r.hpt&&(n=r.hpt*20),i.write_shift(2,n),i.write_shift(1,0);var a=0;r.level&&(a|=r.level),r.hidden&&(a|=16),(r.hpx||r.hpt)&&(a|=32),i.write_shift(1,a),i.write_shift(1,0);var o=0,l=i.l;i.l+=4;for(var h={r:s,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var c=-1,f=-1,d=u<<10;d<u+1<<10;++d){h.c=d;var p=Array.isArray(e)?(e[h.r]||[])[h.c]:e[ot(h)];p&&(c<0&&(c=d),f=d)}c<0||(++o,i.write_shift(4,c),i.write_shift(4,f))}var v=i.l;return i.l=l,i.write_shift(4,o),i.l=v,i.length>i.l?i.slice(0,i.l):i}function fF(s,t,e,i){var r=cF(i,e,t);(r.length>17||(t["!rows"]||[])[i])&&De(s,0,r)}var dF=Ia,pF=Po;function mF(){}function vF(s,t){var e={},i=s[s.l];return++s.l,e.above=!(i&64),e.left=!(i&128),s.l+=18,e.name=yO(s),e}function gF(s,t,e){e==null&&(e=Ce(84+4*s.length));var i=192;t&&(t.above&&(i&=-65),t.left&&(i&=-129)),e.write_shift(1,i);for(var r=1;r<3;++r)e.write_shift(1,0);return ac({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),Ix(s,e),e.slice(0,e.l)}function bF(s){var t=ms(s);return[t]}function yF(s,t,e){return e==null&&(e=Ce(8)),Da(t,e)}function xF(s){var t=La(s);return[t]}function CF(s,t,e){return e==null&&(e=Ce(4)),Ra(t,e)}function wF(s){var t=ms(s),e=s.read_shift(1);return[t,e,"b"]}function EF(s,t,e){return e==null&&(e=Ce(9)),Da(t,e),e.write_shift(1,s.v?1:0),e}function SF(s){var t=La(s),e=s.read_shift(1);return[t,e,"b"]}function kF(s,t,e){return e==null&&(e=Ce(5)),Ra(t,e),e.write_shift(1,s.v?1:0),e}function TF(s){var t=ms(s),e=s.read_shift(1);return[t,e,"e"]}function AF(s,t,e){return e==null&&(e=Ce(9)),Da(t,e),e.write_shift(1,s.v),e}function OF(s){var t=La(s),e=s.read_shift(1);return[t,e,"e"]}function DF(s,t,e){return e==null&&(e=Ce(8)),Ra(t,e),e.write_shift(1,s.v),e.write_shift(2,0),e.write_shift(1,0),e}function LF(s){var t=ms(s),e=s.read_shift(4);return[t,e,"s"]}function RF(s,t,e){return e==null&&(e=Ce(12)),Da(t,e),e.write_shift(4,t.v),e}function IF(s){var t=La(s),e=s.read_shift(4);return[t,e,"s"]}function _F(s,t,e){return e==null&&(e=Ce(8)),Ra(t,e),e.write_shift(4,t.v),e}function FF(s){var t=ms(s),e=tr(s);return[t,e,"n"]}function NF(s,t,e){return e==null&&(e=Ce(16)),Da(t,e),xa(s.v,e),e}function PC(s){var t=La(s),e=tr(s);return[t,e,"n"]}function MF(s,t,e){return e==null&&(e=Ce(12)),Ra(t,e),xa(s.v,e),e}function PF(s){var t=ms(s),e=Mm(s);return[t,e,"n"]}function BF(s,t,e){return e==null&&(e=Ce(12)),Da(t,e),_x(s.v,e),e}function HF(s){var t=La(s),e=Mm(s);return[t,e,"n"]}function VF(s,t,e){return e==null&&(e=Ce(8)),Ra(t,e),_x(s.v,e),e}function WF(s){var t=ms(s),e=_m(s);return[t,e,"is"]}function zF(s){var t=ms(s),e=rr(s);return[t,e,"str"]}function jF(s,t,e){return e==null&&(e=Ce(12+4*s.v.length)),Da(t,e),Vi(s.v,e),e.length>e.l?e.slice(0,e.l):e}function UF(s){var t=La(s),e=rr(s);return[t,e,"str"]}function $F(s,t,e){return e==null&&(e=Ce(8+4*s.v.length)),Ra(t,e),Vi(s.v,e),e.length>e.l?e.slice(0,e.l):e}function qF(s,t,e){var i=s.l+t,r=ms(s);r.r=e["!row"];var n=s.read_shift(1),a=[r,n,"b"];if(e.cellFormula){s.l+=2;var o=jc(s,i-s.l,e);a[3]=Qi(o,null,r,e.supbooks,e)}else s.l=i;return a}function GF(s,t,e){var i=s.l+t,r=ms(s);r.r=e["!row"];var n=s.read_shift(1),a=[r,n,"e"];if(e.cellFormula){s.l+=2;var o=jc(s,i-s.l,e);a[3]=Qi(o,null,r,e.supbooks,e)}else s.l=i;return a}function XF(s,t,e){var i=s.l+t,r=ms(s);r.r=e["!row"];var n=tr(s),a=[r,n,"n"];if(e.cellFormula){s.l+=2;var o=jc(s,i-s.l,e);a[3]=Qi(o,null,r,e.supbooks,e)}else s.l=i;return a}function KF(s,t,e){var i=s.l+t,r=ms(s);r.r=e["!row"];var n=rr(s),a=[r,n,"str"];if(e.cellFormula){s.l+=2;var o=jc(s,i-s.l,e);a[3]=Qi(o,null,r,e.supbooks,e)}else s.l=i;return a}var YF=Ia,JF=Po;function QF(s,t){return t==null&&(t=Ce(4)),t.write_shift(4,s),t}function ZF(s,t){var e=s.l+t,i=Ia(s),r=Fm(s),n=rr(s),a=rr(s),o=rr(s);s.l=e;var l={rfx:i,relId:r,loc:n,display:o};return a&&(l.Tooltip=a),l}function eN(s,t){var e=Ce(50+4*(s[1].Target.length+(s[1].Tooltip||"").length));Po({s:oi(s[0]),e:oi(s[0])},e),Nm("rId"+t,e);var i=s[1].Target.indexOf("#"),r=i==-1?"":s[1].Target.slice(i+1);return Vi(r||"",e),Vi(s[1].Tooltip||"",e),Vi("",e),e.slice(0,e.l)}function tN(){}function iN(s,t,e){var i=s.l+t,r=Fx(s),n=s.read_shift(1),a=[r];if(a[2]=n,e.cellFormula){var o=T_(s,i-s.l,e);a[1]=o}else s.l=i;return a}function rN(s,t,e){var i=s.l+t,r=Ia(s),n=[r];if(e.cellFormula){var a=O_(s,i-s.l,e);n[1]=a,s.l=i}else s.l=i;return n}function sN(s,t,e){e==null&&(e=Ce(18));var i=Uc(s,t);e.write_shift(-4,s),e.write_shift(-4,s),e.write_shift(4,(i.width||10)*256),e.write_shift(4,0);var r=0;return t.hidden&&(r|=1),typeof i.width=="number"&&(r|=2),t.level&&(r|=t.level<<8),e.write_shift(2,r),e}var BC=["left","right","top","bottom","header","footer"];function nN(s){var t={};return BC.forEach(function(e){t[e]=tr(s)}),t}function aN(s,t){return t==null&&(t=Ce(6*8)),fa(s),BC.forEach(function(e){xa(s[e],t)}),t}function oN(s){var t=s.read_shift(2);return s.l+=28,{RTL:t&32}}function lN(s,t,e){e==null&&(e=Ce(30));var i=924;return(((t||{}).Views||[])[0]||{}).RTL&&(i|=32),e.write_shift(2,i),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function hN(s){var t=Ce(24);return t.write_shift(4,4),t.write_shift(4,1),Po(s,t),t}function uN(s,t){return t==null&&(t=Ce(16*4+2)),t.write_shift(2,s.password?zm(s.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,s[e[0]]!=null&&!s[e[0]]?1:0):t.write_shift(4,s[e[0]]!=null&&s[e[0]]?0:1)}),t}function cN(){}function fN(){}function dN(s,t,e,i,r,n,a){if(!s)return s;var o=t||{};i||(i={"!id":{}});var l=o.dense?[]:{},h,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},c=!1,f=!1,d,p,v,g,b,C,y,x,w,S=[];o.biff=12,o["!row"]=0;var E=0,k=!1,A=[],z={},D=o.supbooks||r.supbooks||[[]];if(D.sharedf=z,D.arrayf=A,D.SheetNames=r.SheetNames||r.Sheets.map(function(re){return re.name}),!o.supbooks&&(o.supbooks=D,r.Names))for(var T=0;T<r.Names.length;++T)D[0][T+1]=r.Names[T];var M=[],K=[],te=!1;oh[16]={n:"BrtShortReal",f:PC};var ee;if(an(s,function(j,de,we){if(!f)switch(we){case 148:h=j;break;case 0:d=j,o.sheetRows&&o.sheetRows<=d.r&&(f=!0),x=di(g=d.r),o["!row"]=d.r,(j.hidden||j.hpt||j.level!=null)&&(j.hpt&&(j.hpx=Oo(j.hpt)),K[j.r]=j);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:j[2]},j[2]){case"n":p.v=j[1];break;case"s":y=Pl[j[1]],p.v=y.t,p.r=y.r;break;case"b":p.v=!!j[1];break;case"e":p.v=j[1],o.cellText!==!1&&(p.w=on[p.v]);break;case"str":p.t="s",p.v=j[1];break;case"is":p.t="s",p.v=j[1].t;break}if((v=a.CellXf[j[0].iStyleRef])&&FC(p,v.numFmtId,null,o,n,a),b=j[0].c==-1?b+1:j[0].c,o.dense?(l[g]||(l[g]=[]),l[g][b]=p):l[ei(b)+x]=p,o.cellFormula){for(k=!1,E=0;E<A.length;++E){var N=A[E];d.r>=N[0].s.r&&d.r<=N[0].e.r&&b>=N[0].s.c&&b<=N[0].e.c&&(p.F=ct(N[0]),k=!0)}!k&&j.length>3&&(p.f=j[3])}if(u.s.r>d.r&&(u.s.r=d.r),u.s.c>b&&(u.s.c=b),u.e.r<d.r&&(u.e.r=d.r),u.e.c<b&&(u.e.c=b),o.cellDates&&v&&p.t=="n"&&Aa(nt[v.numFmtId])){var H=Sn(p.v);H&&(p.t="d",p.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}ee&&(ee.type=="XLDAPR"&&(p.D=!0),ee=void 0);break;case 1:case 12:if(!o.sheetStubs||c)break;p={t:"z",v:void 0},b=j[0].c==-1?b+1:j[0].c,o.dense?(l[g]||(l[g]=[]),l[g][b]=p):l[ei(b)+x]=p,u.s.r>d.r&&(u.s.r=d.r),u.s.c>b&&(u.s.c=b),u.e.r<d.r&&(u.e.r=d.r),u.e.c<b&&(u.e.c=b),ee&&(ee.type=="XLDAPR"&&(p.D=!0),ee=void 0);break;case 176:S.push(j);break;case 49:ee=((o.xlmeta||{}).Cell||[])[j-1];break;case 494:var L=i["!id"][j.relId];for(L?(j.Target=L.Target,j.loc&&(j.Target+="#"+j.loc),j.Rel=L):j.relId==""&&(j.Target="#"+j.loc),g=j.rfx.s.r;g<=j.rfx.e.r;++g)for(b=j.rfx.s.c;b<=j.rfx.e.c;++b)o.dense?(l[g]||(l[g]=[]),l[g][b]||(l[g][b]={t:"z",v:void 0}),l[g][b].l=j):(C=ot({c:b,r:g}),l[C]||(l[C]={t:"z",v:void 0}),l[C].l=j);break;case 426:if(!o.cellFormula)break;A.push(j),w=o.dense?l[g][b]:l[ei(b)+x],w.f=Qi(j[1],u,{r:d.r,c:b},D,o),w.F=ct(j[0]);break;case 427:if(!o.cellFormula)break;z[ot(j[0].s)]=j[1],w=o.dense?l[g][b]:l[ei(b)+x],w.f=Qi(j[1],u,{r:d.r,c:b},D,o);break;case 60:if(!o.cellStyles)break;for(;j.e>=j.s;)M[j.e--]={width:j.w/256,hidden:!!(j.flags&1),level:j.level},te||(te=!0,jm(j.w/256)),Ln(M[j.e+1]);break;case 161:l["!autofilter"]={ref:ct(j)};break;case 476:l["!margins"]=j;break;case 147:r.Sheets[e]||(r.Sheets[e]={}),j.name&&(r.Sheets[e].CodeName=j.name),(j.above||j.left)&&(l["!outline"]={above:j.above,left:j.left});break;case 137:r.Views||(r.Views=[{}]),r.Views[0]||(r.Views[0]={}),j.RTL&&(r.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:c=!0;break;case 36:c=!1;break;case 37:c=!0;break;case 38:c=!1;break;default:if(!de.T){if(!c||o.WTF)throw new Error("Unexpected record 0x"+we.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(l["!ref"]=ct(h||u)),o.sheetRows&&l["!ref"]){var J=Et(l["!ref"]);o.sheetRows<=+J.e.r&&(J.e.r=o.sheetRows-1,J.e.r>u.e.r&&(J.e.r=u.e.r),J.e.r<J.s.r&&(J.s.r=J.e.r),J.e.c>u.e.c&&(J.e.c=u.e.c),J.e.c<J.s.c&&(J.s.c=J.e.c),l["!fullref"]=l["!ref"],l["!ref"]=ct(J))}return S.length>0&&(l["!merges"]=S),M.length>0&&(l["!cols"]=M),K.length>0&&(l["!rows"]=K),l}function pN(s,t,e,i,r,n,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Ut(t),t.z=t.z||nt[14],t.v=Fi(ti(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r:e,c:i};switch(l.s=Pn(r.cellXfs,t,r),t.l&&n["!links"].push([ot(l),t.l]),t.c&&n["!comments"].push([ot(l),t.c]),t.t){case"s":case"str":return r.bookSST?(o=Xm(r.Strings,t.v,r.revStrings),l.t="s",l.v=o,a?De(s,18,_F(t,l)):De(s,7,RF(t,l))):(l.t="str",a?De(s,17,$F(t,l)):De(s,6,jF(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?De(s,13,VF(t,l)):De(s,2,BF(t,l)):a?De(s,16,MF(t,l)):De(s,5,NF(t,l)),!0;case"b":return l.t="b",a?De(s,15,kF(t,l)):De(s,4,EF(t,l)),!0;case"e":return l.t="e",a?De(s,14,DF(t,l)):De(s,3,AF(t,l)),!0}return a?De(s,12,CF(t,l)):De(s,1,yF(t,l)),!0}function mN(s,t,e,i){var r=Et(t["!ref"]||"A1"),n,a="",o=[];De(s,145);var l=Array.isArray(t),h=r.e.r;t["!rows"]&&(h=Math.max(r.e.r,t["!rows"].length-1));for(var u=r.s.r;u<=h;++u){a=di(u),fF(s,t,r,u);var c=!1;if(u<=r.e.r)for(var f=r.s.c;f<=r.e.c;++f){u===r.s.r&&(o[f]=ei(f)),n=o[f]+a;var d=l?(t[u]||[])[f]:t[n];if(!d){c=!1;continue}c=pN(s,d,u,f,i,t,c)}}De(s,146)}function vN(s,t){!t||!t["!merges"]||(De(s,177,QF(t["!merges"].length)),t["!merges"].forEach(function(e){De(s,176,JF(e))}),De(s,178))}function gN(s,t){!t||!t["!cols"]||(De(s,390),t["!cols"].forEach(function(e,i){e&&De(s,60,sN(i,e))}),De(s,391))}function bN(s,t){!t||!t["!ref"]||(De(s,648),De(s,649,hN(Et(t["!ref"]))),De(s,650))}function yN(s,t,e){t["!links"].forEach(function(i){if(i[1].Target){var r=Mt(e,-1,i[1].Target.replace(/#.*$/,""),bt.HLINK);De(s,494,eN(i,r))}}),delete t["!links"]}function xN(s,t,e,i){if(t["!comments"].length>0){var r=Mt(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",bt.VML);De(s,551,Nm("rId"+r)),t["!legacy"]=r}}function CN(s,t,e,i){if(t["!autofilter"]){var r=t["!autofilter"],n=typeof r.ref=="string"?r.ref:ct(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,o=yr(n);o.s.r==o.e.r&&(o.e.r=yr(t["!ref"]).e.r,n=ct(o));for(var l=0;l<a.length;++l){var h=a[l];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==i){h.Ref="'"+e.SheetNames[i]+"'!"+n;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+n}),De(s,161,Po(Et(n))),De(s,162)}}function wN(s,t,e){De(s,133),De(s,137,lN(t,e)),De(s,138),De(s,134)}function EN(s,t){t["!protect"]&&De(s,535,uN(t["!protect"]))}function SN(s,t,e,i){var r=Dr(),n=e.SheetNames[s],a=e.Sheets[n]||{},o=n;try{e&&e.Workbook&&(o=e.Workbook.Sheets[s].CodeName||o)}catch(h){}var l=Et(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],De(r,129),(e.vbaraw||a["!outline"])&&De(r,147,gF(o,a["!outline"])),De(r,148,pF(l)),wN(r,a,e.Workbook),gN(r,a),mN(r,a,s,t),EN(r,a),CN(r,a,e,s),vN(r,a),yN(r,a,i),a["!margins"]&&De(r,476,aN(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&bN(r,a),xN(r,a,s,i),De(r,130),r.end()}function kN(s){var t=[],e=s.match(/^<c:numCache>/),i;(s.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(n){var a=n.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(t[+a[1]]=e?+a[2]:a[2])});var r=Dt((s.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(s.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(n){i=n.replace(/<.*?>/g,"")}),[t,r,i]}function TN(s,t,e,i,r,n){var a=n||{"!type":"chart"};if(!s)return n;var o=0,l=0,h="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(s.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(c){var f=kN(c);u.s.r=u.s.c=0,u.e.c=o,h=ei(o),f[0].forEach(function(d,p){a[h+di(p)]={t:"n",v:d,z:f[1]},l=p}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=ct(u)),a}function AN(s,t,e,i,r){if(!s)return s;i||(i={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},a,o=s.match(NC);return o&&Km(o[0],n,r,e),(a=s.match(/drawing r:id="(.*?)"/))&&(n["!rel"]=a[1]),i["!id"][n["!rel"]]&&(n["!drawel"]=i["!id"][n["!rel"]]),n}function ON(s,t){s.l+=10;var e=rr(s);return{name:e}}function DN(s,t,e,i,r){if(!s)return s;i||(i={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},a=!1;return an(s,function(l,h,u){switch(u){case 550:n["!rel"]=l;break;case 651:r.Sheets[e]||(r.Sheets[e]={}),l.name&&(r.Sheets[e].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),i["!id"][n["!rel"]]&&(n["!drawel"]=i["!id"][n["!rel"]]),n}var Ym=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],LN=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],RN=[],IN=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Dg(s,t){for(var e=0;e!=s.length;++e)for(var i=s[e],r=0;r!=t.length;++r){var n=t[r];if(i[n[0]]==null)i[n[0]]=n[1];else switch(n[2]){case"bool":typeof i[n[0]]=="string"&&(i[n[0]]=Zt(i[n[0]]));break;case"int":typeof i[n[0]]=="string"&&(i[n[0]]=parseInt(i[n[0]],10));break}}}function Lg(s,t){for(var e=0;e!=t.length;++e){var i=t[e];if(s[i[0]]==null)s[i[0]]=i[1];else switch(i[2]){case"bool":typeof s[i[0]]=="string"&&(s[i[0]]=Zt(s[i[0]]));break;case"int":typeof s[i[0]]=="string"&&(s[i[0]]=parseInt(s[i[0]],10));break}}}function HC(s){Lg(s.WBProps,Ym),Lg(s.CalcPr,IN),Dg(s.WBView,LN),Dg(s.Sheets,RN),yo.date1904=Zt(s.WBProps.date1904)}function _N(s){return!s.Workbook||!s.Workbook.WBProps?"false":Zt(s.Workbook.WBProps.date1904)?"true":"false"}var FN="][*?/\\".split("");function VC(s,t){if(s.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return FN.forEach(function(i){if(s.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}function NN(s,t,e){s.forEach(function(i,r){VC(i);for(var n=0;n<r;++n)if(i==s[n])throw new Error("Duplicate Sheet Name: "+i);if(e){var a=t&&t[r]&&t[r].CodeName||i;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function WC(s){if(!s||!s.SheetNames||!s.Sheets)throw new Error("Invalid Workbook");if(!s.SheetNames.length)throw new Error("Workbook is empty");var t=s.Workbook&&s.Workbook.Sheets||[];NN(s.SheetNames,t,!!s.vbaraw);for(var e=0;e<s.SheetNames.length;++e)__(s.Sheets[s.SheetNames[e]],s.SheetNames[e],e)}var MN=/<\w+:workbook/;function PN(s,t){if(!s)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,r="xmlns",n={},a=0;if(s.replace(nr,function(l,h){var u=lt(l);switch(Bs(u[0])){case"<?xml":break;case"<workbook":l.match(MN)&&(r="xmlns"+l.match(/<(\w+):/)[1]),e.xmlns=u[r];break;case"</workbook>":break;case"<fileVersion":delete u[0],e.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ym.forEach(function(c){if(u[c[0]]!=null)switch(c[2]){case"bool":e.WBProps[c[0]]=Zt(u[c[0]]);break;case"int":e.WBProps[c[0]]=parseInt(u[c[0]],10);break;default:e.WBProps[c[0]]=u[c[0]]}}),u.codeName&&(e.WBProps.CodeName=Ht(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],e.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Dt(Ht(u.name)),delete u[0],e.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":n={},n.Name=Ht(u.name),u.comment&&(n.Comment=u.comment),u.localSheetId&&(n.Sheet=+u.localSheetId),Zt(u.hidden||"0")&&(n.Hidden=!0),a=h+l.length;break;case"</definedName>":n.Ref=Dt(Ht(s.slice(a,h))),e.Names.push(n);break;case"<definedName/>":break;case"<calcPr":delete u[0],e.CalcPr=u;break;case"<calcPr/>":delete u[0],e.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Oa.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return HC(e),e}function zC(s){var t=[yi];t[t.length]=Be("workbook",null,{xmlns:Oa[0],"xmlns:r":_i.r});var e=s.Workbook&&(s.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};s.Workbook&&s.Workbook.WBProps&&(Ym.forEach(function(o){s.Workbook.WBProps[o[0]]!=null&&s.Workbook.WBProps[o[0]]!=o[1]&&(i[o[0]]=s.Workbook.WBProps[o[0]])}),s.Workbook.WBProps.CodeName&&(i.codeName=s.Workbook.WBProps.CodeName,delete i.CodeName)),t[t.length]=Be("workbookPr",null,i);var r=s.Workbook&&s.Workbook.Sheets||[],n=0;if(r&&r[0]&&r[0].Hidden){for(t[t.length]="<bookViews>",n=0;n!=s.SheetNames.length&&!(!r[n]||!r[n].Hidden);++n);n==s.SheetNames.length&&(n=0),t[t.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",n=0;n!=s.SheetNames.length;++n){var a={name:Pt(s.SheetNames[n].slice(0,31))};if(a.sheetId=""+(n+1),a["r:id"]="rId"+(n+1),r[n])switch(r[n].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=Be("sheet",null,a)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",s.Workbook&&s.Workbook.Names&&s.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Be("definedName",Pt(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function BN(s,t){var e={};return e.Hidden=s.read_shift(4),e.iTabID=s.read_shift(4),e.strRelID=Qd(s),e.name=rr(s),e}function HN(s,t){return t||(t=Ce(127)),t.write_shift(4,s.Hidden),t.write_shift(4,s.iTabID),Nm(s.strRelID,t),Vi(s.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function VN(s,t){var e={},i=s.read_shift(4);e.defaultThemeVersion=s.read_shift(4);var r=t>8?rr(s):"";return r.length>0&&(e.CodeName=r),e.autoCompressPictures=!!(i&65536),e.backupFile=!!(i&64),e.checkCompatibility=!!(i&4096),e.date1904=!!(i&1),e.filterPrivacy=!!(i&8),e.hidePivotFieldList=!!(i&1024),e.promptedSolutions=!!(i&16),e.publishItems=!!(i&2048),e.refreshAllConnections=!!(i&262144),e.saveExternalLinkValues=!!(i&128),e.showBorderUnselectedTables=!!(i&4),e.showInkAnnotation=!!(i&32),e.showObjects=["all","placeholders","none"][i>>13&3],e.showPivotChartFilter=!!(i&32768),e.updateLinks=["userSet","never","always"][i>>8&3],e}function WN(s,t){t||(t=Ce(72));var e=0;return s&&s.filterPrivacy&&(e|=8),t.write_shift(4,e),t.write_shift(4,0),Ix(s&&s.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function zN(s,t){var e={};return s.read_shift(4),e.ArchID=s.read_shift(4),s.l+=t-8,e}function jN(s,t,e){var i=s.l+t;s.l+=4,s.l+=1;var r=s.read_shift(4),n=xO(s),a=A_(s,0,e),o=Fm(s);s.l=i;var l={Name:n,Ptg:a};return r<268435455&&(l.Sheet=r),o&&(l.Comment=o),l}function UN(s,t){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],r=!1;t||(t={}),t.biff=12;var n=[],a=[[]];return a.SheetNames=[],a.XTI=[],oh[16]={n:"BrtFRTArchID$",f:zN},an(s,function(l,h,u){switch(u){case 156:a.SheetNames.push(l.name),e.Sheets.push(l);break;case 153:e.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Qi(l.Ptg,null,null,a,t),delete t.SID,delete l.Ptg,n.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(u),r=!0;break;case 36:i.pop(),r=!1;break;case 37:i.push(u),r=!0;break;case 38:i.pop(),r=!1;break;case 16:break;default:if(!h.T){if(!r||t.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),HC(e),e.Names=n,e.supbooks=a,e}function $N(s,t){De(s,143);for(var e=0;e!=t.SheetNames.length;++e){var i=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,r={Hidden:i,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};De(s,156,HN(r))}De(s,144)}function qN(s,t){t||(t=Ce(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return Vi("SheetJS",t),Vi(Yl.version,t),Vi(Yl.version,t),Vi("7262",t),t.length>t.l?t.slice(0,t.l):t}function GN(s,t){t||(t=Ce(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,s),t.write_shift(4,s);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function XN(s,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,i=0,r=-1,n=-1;i<e.length;++i)!e[i]||!e[i].Hidden&&r==-1?r=i:e[i].Hidden==1&&n==-1&&(n=i);n>r||(De(s,135),De(s,158,GN(r)),De(s,136))}}function KN(s,t){var e=Dr();return De(e,131),De(e,128,qN()),De(e,153,WN(s.Workbook&&s.Workbook.WBProps||null)),XN(e,s),$N(e,s),De(e,132),e.end()}function YN(s,t,e){return t.slice(-4)===".bin"?UN(s,e):PN(s,e)}function JN(s,t,e,i,r,n,a,o){return t.slice(-4)===".bin"?dN(s,i,e,r,n,a,o):U_(s,i,e,r,n,a,o)}function QN(s,t,e,i,r,n,a,o){return t.slice(-4)===".bin"?DN(s,i,e,r,n):AN(s,i,e,r,n)}function ZN(s,t,e,i,r,n,a,o){return t.slice(-4)===".bin"?iI():rI()}function eM(s,t,e,i,r,n,a,o){return t.slice(-4)===".bin"?eI():tI()}function tM(s,t,e,i){return t.slice(-4)===".bin"?JL(s,e,i):HL(s,e,i)}function iM(s,t,e){return CC(s,e)}function rM(s,t,e){return t.slice(-4)===".bin"?sL(s,e):tL(s,e)}function sM(s,t,e){return t.slice(-4)===".bin"?KR(s,e):VR(s,e)}function nM(s,t,e){return t.slice(-4)===".bin"?PR(s):NR(s)}function aM(s,t,e,i){return e.slice(-4)===".bin"?BR(s,t,e,i):void 0}function oM(s,t,e){return t.slice(-4)===".bin"?IR(s,t,e):FR(s,t,e)}function lM(s,t,e){return(t.slice(-4)===".bin"?KN:zC)(s)}function hM(s,t,e,i,r){return(t.slice(-4)===".bin"?SN:MC)(s,e,i,r)}function uM(s,t,e){return(t.slice(-4)===".bin"?oR:yC)(s,e)}function cM(s,t,e){return(t.slice(-4)===".bin"?oL:cC)(s,e)}function fM(s,t,e){return(t.slice(-4)===".bin"?YR:SC)(s)}function dM(s){return(s.slice(-4)===".bin"?_R:wC)()}var jC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,UC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function gs(s,t){var e=s.split(/\s+/),i=[];if(i[0]=e[0],e.length===1)return i;var r=s.match(jC),n,a,o,l;if(r)for(l=0;l!=r.length;++l)n=r[l].match(UC),(a=n[1].indexOf(":"))===-1?i[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(a+1),i[o]=n[2].slice(1,n[2].length-1));return i}function pM(s){var t=s.split(/\s+/),e={};if(t.length===1)return e;var i=s.match(jC),r,n,a,o;if(i)for(o=0;o!=i.length;++o)r=i[o].match(UC),(n=r[1].indexOf(":"))===-1?e[r[1]]=r[2].slice(1,r[2].length-1):(r[1].slice(0,6)==="xmlns:"?a="xmlns"+r[1].slice(6):a=r[1].slice(n+1),e[a]=r[2].slice(1,r[2].length-1));return e}var Hl;function mM(s,t){var e=Hl[s]||Dt(s);return e==="General"?ba(t):Gr(e,t)}function vM(s,t,e,i){var r=i;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=Zt(i);break;case"i2":case"int":r=parseInt(i,10);break;case"r4":case"float":r=parseFloat(i);break;case"date":case"dateTime.tz":r=ti(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}s[Dt(t)]=r}function gM(s,t,e){if(s.t!=="z"){if(!e||e.cellText!==!1)try{s.t==="e"?s.w=s.w||on[s.v]:t==="General"?s.t==="n"?(s.v|0)===s.v?s.w=s.v.toString(10):s.w=Ql(s.v):s.w=ba(s.v):s.w=mM(t||"General",s.v)}catch(n){if(e.WTF)throw n}try{var i=Hl[t]||t||"General";if(e.cellNF&&(s.z=i),e.cellDates&&s.t=="n"&&Aa(i)){var r=Sn(s.v);r&&(s.t="d",s.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}catch(n){if(e.WTF)throw n}}}function bM(s,t,e){if(e.cellStyles&&t.Interior){var i=t.Interior;i.Pattern&&(i.patternType=RL[i.Pattern]||i.Pattern)}s[t.ID]=t}function yM(s,t,e,i,r,n,a,o,l,h){var u="General",c=i.StyleID,f={};h=h||{};var d=[],p=0;for(c===void 0&&o&&(c=o.StyleID),c===void 0&&a&&(c=a.StyleID);n[c]!==void 0&&(n[c].nf&&(u=n[c].nf),n[c].Interior&&d.push(n[c].Interior),!!n[c].Parent);)c=n[c].Parent;switch(e.Type){case"Boolean":i.t="b",i.v=Zt(s);break;case"String":i.t="s",i.r=G0(Dt(s)),i.v=s.indexOf("<")>-1?Dt(t||s).replace(/<.*?>/g,""):i.r;break;case"DateTime":s.slice(-1)!="Z"&&(s+="Z"),i.v=(ti(s)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),i.v!==i.v?i.v=Dt(s):i.v<60&&(i.v=i.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+s),i.t||(i.t="n");break;case"Error":i.t="e",i.v=Px[s],h.cellText!==!1&&(i.w=s);break;default:s==""&&t==""?i.t="z":(i.t="s",i.v=G0(t||s));break}if(gM(i,u,h),h.cellFormula!==!1)if(i.Formula){var v=Dt(i.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),i.f=bo(v,r),delete i.Formula,i.ArrayRange=="RC"?i.F=bo("RC:RC",r):i.ArrayRange&&(i.F=bo(i.ArrayRange,r),l.push([Et(i.F),i.F]))}else for(p=0;p<l.length;++p)r.r>=l[p][0].s.r&&r.r<=l[p][0].e.r&&r.c>=l[p][0].s.c&&r.c<=l[p][0].e.c&&(i.F=l[p][1]);h.cellStyles&&(d.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),i.s=f),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function xM(s){s.t=s.v||"",s.t=s.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),s.v=s.w=s.ixfe=void 0}function _f(s,t){var e=t||{};Fo();var i=ao(Sm(s));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(typeof kt<"u"?i=kt.utils.decode(65001,Zu(i)):i=Ht(i));var r=i.slice(0,1024).toLowerCase(),n=!1;if(r=r.replace(/".*?"/g,""),(r.indexOf(">")&1023)>Math.min(r.indexOf(",")&1023,r.indexOf(";")&1023)){var a=Ut(e);return a.type="string",Ao.to_workbook(i,a)}if(r.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ct){r.indexOf("<"+Ct)>=0&&(n=!0)}),n)return iP(i,e);Hl={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],h,u={},c=[],f=e.dense?[]:{},d="",p={},v={},g=gs('<Data ss:Type="String">'),b=0,C=0,y=0,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},w={},S={},E="",k=0,A=[],z={},D={},T=0,M=[],K=[],te={},ee=[],J,re=!1,j=[],de=[],we={},N=0,H=0,L={Sheets:[],WBProps:{date1904:!1}},_={};th.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var U="";o=th.exec(i);)switch(o[3]=(U=o[3]).toLowerCase()){case"data":if(U=="data"){if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?yM(i.slice(b,o.index),E,g,l[l.length-1][0]=="comment"?te:p,{c:C,r:y},w,ee[C],v,j,e):(E="",g=gs(o[0]),b=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(K.length>0&&(p.c=K),(!e.sheetRows||e.sheetRows>y)&&p.v!==void 0&&(e.dense?(f[y]||(f[y]=[]),f[y][C]=p):f[ei(C)+di(y)]=p),p.HRef&&(p.l={Target:Dt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(N=C+(parseInt(p.MergeAcross,10)|0),H=y+(parseInt(p.MergeDown,10)|0),A.push({s:{c:C,r:y},e:{c:N,r:H}})),!e.sheetStubs)p.MergeAcross?C=N+1:++C;else if(p.MergeAcross||p.MergeDown){for(var se=C;se<=N;++se)for(var ae=y;ae<=H;++ae)(se>C||ae>y)&&(e.dense?(f[ae]||(f[ae]=[]),f[ae][se]={t:"z"}):f[ei(se)+di(ae)]={t:"z"});C=N+1}else++C;else p=pM(o[0]),p.Index&&(C=+p.Index-1),C<x.s.c&&(x.s.c=C),C>x.e.c&&(x.e.c=C),o[0].slice(-2)==="/>"&&++C,K=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<x.s.r&&(x.s.r=y),y>x.e.r&&(x.e.r=y),o[0].slice(-2)==="/>"&&(v=gs(o[0]),v.Index&&(y=+v.Index-1)),C=0,++y):(v=gs(o[0]),v.Index&&(y=+v.Index-1),we={},(v.AutoFitHeight=="0"||v.Height)&&(we.hpx=parseInt(v.Height,10),we.hpt=ah(we.hpx),de[y]=we),v.Hidden=="1"&&(we.hidden=!0,de[y]=we));break;case"worksheet":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"));c.push(d),x.s.r<=x.e.r&&x.s.c<=x.e.c&&(f["!ref"]=ct(x),e.sheetRows&&e.sheetRows<=x.e.r&&(f["!fullref"]=f["!ref"],x.e.r=e.sheetRows-1,f["!ref"]=ct(x))),A.length&&(f["!merges"]=A),ee.length>0&&(f["!cols"]=ee),de.length>0&&(f["!rows"]=de),u[d]=f}else x={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=C=0,l.push([o[3],!1]),h=gs(o[0]),d=Dt(h.Name),f=e.dense?[]:{},A=[],j=[],de=[],_={name:d,Hidden:0},L.Sheets.push(_);break;case"table":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ee=[],re=!1}break;case"style":o[1]==="/"?bM(w,S,e):S=gs(o[0]);break;case"numberformat":S.nf=Dt(gs(o[0]).Format||"General"),Hl[S.nf]&&(S.nf=Hl[S.nf]);for(var oe=0;oe!=392&&nt[oe]!=S.nf;++oe);if(oe==392){for(oe=57;oe!=392;++oe)if(nt[oe]==null){Fs(S.nf,oe);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(J=gs(o[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!re&&J.wpx>10){re=!0,er=gC;for(var me=0;me<ee.length;++me)ee[me]&&Ln(ee[me])}re&&Ln(J),ee[J.Index-1||ee.length]=J;for(var Re=0;Re<+J.Span;++Re)ee[ee.length]=Ut(J);break;case"namedrange":if(o[1]==="/")break;L.Names||(L.Names=[]);var V=lt(o[0]),$e={Name:V.Name,Ref:bo(V.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&($e.Sheet=L.Sheets.length-1),L.Names.push($e);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=i.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!e.cellStyles)break;S.Interior=gs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?$O(z,U,i.slice(T,o.index)):T=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"));xM(te),K.push(te)}else l.push([o[3],!1]),h=gs(o[0]),te={a:h.Author};break;case"autofilter":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Me=gs(o[0]);f["!autofilter"]={ref:bo(Me.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Ng(i,e);var Ze=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ze=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ze=!1}break;case"excelworkbook":switch(o[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ze=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ze=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(i.slice(T,o.index)){case"SheetHidden":_.Hidden=1;break;case"SheetVeryHidden":_.Hidden=2;break}else T=o.index+o[0].length;break;case"header":f["!margins"]||fa(f["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(f["!margins"].header=+lt(o[0]).Margin);break;case"footer":f["!margins"]||fa(f["!margins"]={},"xlml"),isNaN(+lt(o[0]).Margin)||(f["!margins"].footer=+lt(o[0]).Margin);break;case"pagemargins":var Je=lt(o[0]);f["!margins"]||fa(f["!margins"]={},"xlml"),isNaN(+Je.Top)||(f["!margins"].top=+Je.Top),isNaN(+Je.Left)||(f["!margins"].left=+Je.Left),isNaN(+Je.Right)||(f["!margins"].right=+Je.Right),isNaN(+Je.Bottom)||(f["!margins"].bottom=+Je.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ze=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ze=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ze=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ze=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ze=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ze=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ze=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ze=!1}break;case"smarttags":break;default:Ze=!1;break}if(Ze||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?vM(D,U,M,i.slice(T,o.index)):(M=o,T=o.index+o[0].length);break}if(e.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Le={};return!e.bookSheets&&!e.bookProps&&(Le.Sheets=u),Le.SheetNames=c,Le.Workbook=L,Le.SSF=Ut(nt),Le.Props=z,Le.Custprops=D,Le}function np(s,t){switch(Zm(t=t||{}),t.type||"base64"){case"base64":return _f(qr(s),t);case"binary":case"buffer":case"file":return _f(s,t);case"array":return _f(Nn(s),t)}}function CM(s,t){var e=[];return s.Props&&e.push(qO(s.Props,t)),s.Custprops&&e.push(GO(s.Props,s.Custprops)),e.join("")}function wM(){return""}function EM(s,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(i,r){var n=[];n.push(Be("NumberFormat",null,{"ss:Format":Pt(nt[i.numFmtId])}));var a={"ss:ID":"s"+(21+r)};e.push(Be("Style",n.join(""),a))}),Be("Styles",e.join(""))}function $C(s){return Be("NamedRange",null,{"ss:Name":s.Name,"ss:RefersTo":"="+qm(s.Ref,{r:0,c:0})})}function SM(s){if(!((s||{}).Workbook||{}).Names)return"";for(var t=s.Workbook.Names,e=[],i=0;i<t.length;++i){var r=t[i];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||e.push($C(r)))}return Be("Names",e.join(""))}function kM(s,t,e,i){if(!s||!((i||{}).Workbook||{}).Names)return"";for(var r=i.Workbook.Names,n=[],a=0;a<r.length;++a){var o=r[a];o.Sheet==e&&(o.Name.match(/^_xlfn\./)||n.push($C(o)))}return n.join("")}function TM(s,t,e,i){if(!s)return"";var r=[];if(s["!margins"]&&(r.push("<PageSetup>"),s["!margins"].header&&r.push(Be("Header",null,{"x:Margin":s["!margins"].header})),s["!margins"].footer&&r.push(Be("Footer",null,{"x:Margin":s["!margins"].footer})),r.push(Be("PageMargins",null,{"x:Bottom":s["!margins"].bottom||"0.75","x:Left":s["!margins"].left||"0.7","x:Right":s["!margins"].right||"0.7","x:Top":s["!margins"].top||"0.75"})),r.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[e])if(i.Workbook.Sheets[e].Hidden)r.push(Be("Visible",i.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<e&&!(i.Workbook.Sheets[n]&&!i.Workbook.Sheets[n].Hidden);++n);n==e&&r.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),s["!protect"]&&(r.push(qi("ProtectContents","True")),s["!protect"].objects&&r.push(qi("ProtectObjects","True")),s["!protect"].scenarios&&r.push(qi("ProtectScenarios","True")),s["!protect"].selectLockedCells!=null&&!s["!protect"].selectLockedCells?r.push(qi("EnableSelection","NoSelection")):s["!protect"].selectUnlockedCells!=null&&!s["!protect"].selectUnlockedCells&&r.push(qi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){s["!protect"][a[0]]&&r.push("<"+a[1]+"/>")})),r.length==0?"":Be("WorksheetOptions",r.join(""),{xmlns:Hr.x})}function AM(s){return s.map(function(t){var e=KA(t.t||""),i=Be("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",i,{"ss:Author":t.a})}).join("")}function OM(s,t,e,i,r,n,a){if(!s||s.v==null&&s.f==null)return"";var o={};if(s.f&&(o["ss:Formula"]="="+Pt(qm(s.f,a))),s.F&&s.F.slice(0,t.length)==t){var l=oi(s.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(s.l&&s.l.Target&&(o["ss:HRef"]=Pt(s.l.Target),s.l.Tooltip&&(o["x:HRefScreenTip"]=Pt(s.l.Tooltip))),e["!merges"])for(var h=e["!merges"],u=0;u!=h.length;++u)h[u].s.c!=a.c||h[u].s.r!=a.r||(h[u].e.c>h[u].s.c&&(o["ss:MergeAcross"]=h[u].e.c-h[u].s.c),h[u].e.r>h[u].s.r&&(o["ss:MergeDown"]=h[u].e.r-h[u].s.r));var c="",f="";switch(s.t){case"z":if(!i.sheetStubs)return"";break;case"n":c="Number",f=String(s.v);break;case"b":c="Boolean",f=s.v?"1":"0";break;case"e":c="Error",f=on[s.v];break;case"d":c="DateTime",f=new Date(s.v).toISOString(),s.z==null&&(s.z=s.z||nt[14]);break;case"s":c="String",f=XA(s.v||"");break}var d=Pn(i.cellXfs,s,i);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var p=s.v!=null?f:"",v=s.t=="z"?"":'<Data ss:Type="'+c+'">'+p+"</Data>";return(s.c||[]).length>0&&(v+=AM(s.c)),Be("Cell",v,o)}function DM(s,t){var e='<Row ss:Index="'+(s+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Oo(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function LM(s,t,e,i){if(!s["!ref"])return"";var r=Et(s["!ref"]),n=s["!merges"]||[],a=0,o=[];s["!cols"]&&s["!cols"].forEach(function(g,b){Ln(g);var C=!!g.width,y=Uc(b,g),x={"ss:Index":b+1};C&&(x["ss:Width"]=sh(y.width)),g.hidden&&(x["ss:Hidden"]="1"),o.push(Be("Column",null,x))});for(var l=Array.isArray(s),h=r.s.r;h<=r.e.r;++h){for(var u=[DM(h,(s["!rows"]||[])[h])],c=r.s.c;c<=r.e.c;++c){var f=!1;for(a=0;a!=n.length;++a)if(!(n[a].s.c>c)&&!(n[a].s.r>h)&&!(n[a].e.c<c)&&!(n[a].e.r<h)){(n[a].s.c!=c||n[a].s.r!=h)&&(f=!0);break}if(!f){var d={r:h,c},p=ot(d),v=l?(s[h]||[])[c]:s[p];u.push(OM(v,p,s,t,e,i,d))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function RM(s,t,e){var i=[],r=e.SheetNames[s],n=e.Sheets[r],a=n?kM(n,t,s,e):"";return a.length>0&&i.push("<Names>"+a+"</Names>"),a=n?LM(n,t,s,e):"",a.length>0&&i.push("<Table>"+a+"</Table>"),i.push(TM(n,t,s,e)),i.join("")}function IM(s,t){t||(t={}),s.SSF||(s.SSF=Ut(nt)),s.SSF&&(Fo(),vh(s.SSF),t.revssf=Bc(s.SSF),t.revssf[s.SSF[65535]]=0,t.ssf=s.SSF,t.cellXfs=[],Pn(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(CM(s,t)),e.push(wM()),e.push(""),e.push("");for(var i=0;i<s.SheetNames.length;++i)e.push(Be("Worksheet",RM(i,t,s),{"ss:Name":Pt(s.SheetNames[i])}));return e[2]=EM(s,t),e[3]=SM(s),yi+Be("Workbook",e.join(""),{xmlns:Hr.ss,"xmlns:o":Hr.o,"xmlns:x":Hr.x,"xmlns:ss":Hr.ss,"xmlns:dt":Hr.dt,"xmlns:html":Hr.html})}function _M(s){var t={},e=s.content;if(e.l=28,t.AnsiUserType=e.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=kO(e),e.length-e.l<=4)return t;var i=e.read_shift(4);if(i==0||i>40||(e.l-=4,t.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(i=e.read_shift(4),i!==1907505652)||(t.UnicodeClipboardFormat=TO(e),i=e.read_shift(4),i==0||i>40))return t;e.l-=4,t.Reserved2=e.read_shift(0,"lpwstr")}var FM=[60,1084,2066,2165,2175];function NM(s,t,e,i,r){var n=i,a=[],o=e.slice(e.l,e.l+n);if(r&&r.enc&&r.enc.insitu&&o.length>0)switch(s){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:r.enc.insitu(o)}a.push(o),e.l+=n;for(var l=Js(e,e.l),h=ap[l],u=0;h!=null&&FM.indexOf(l)>-1;)n=Js(e,e.l+2),u=e.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=e.slice(u,e.l+4+n),a.push(o),e.l+=4+n,h=ap[l=Js(e,e.l)];var c=Hi(a);$i(c,0);var f=0;c.lens=[];for(var d=0;d<a.length;++d)c.lens.push(f),f+=a[d].length;if(c.length<i)throw"XLS Record 0x"+s.toString(16)+" Truncated: "+c.length+" < "+i;return t.f(c,c.length,r)}function As(s,t,e){if(s.t!=="z"&&s.XF){var i=0;try{i=s.z||s.XF.numFmtId||0,t.cellNF&&(s.z=nt[i])}catch(n){if(t.WTF)throw n}if(!t||t.cellText!==!1)try{s.t==="e"?s.w=s.w||on[s.v]:i===0||i=="General"?s.t==="n"?(s.v|0)===s.v?s.w=s.v.toString(10):s.w=Ql(s.v):s.w=ba(s.v):s.w=Gr(i,s.v,{date1904:!!e,dateNF:t&&t.dateNF})}catch(n){if(t.WTF)throw n}if(t.cellDates&&i&&s.t=="n"&&Aa(nt[i]||String(i))){var r=Sn(s.v);r&&(s.t="d",s.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}}function hu(s,t,e){return{v:s,ixfe:t,t:e}}function MM(s,t){var e={opts:{}},i={},r=t.dense?[]:{},n={},a={},o=null,l=[],h="",u={},c,f="",d,p,v,g,b={},C=[],y,x,w=[],S=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},A=function(ge){return ge<8?ha[ge]:ge<64&&S[ge-8]||ha[ge]},z=function(ge,Ee,ke){var et=Ee.XF.data;if(!(!et||!et.patternType||!ke||!ke.cellStyles)){Ee.s={},Ee.s.patternType=et.patternType;var At;(At=rh(A(et.icvFore)))&&(Ee.s.fgColor={rgb:At}),(At=rh(A(et.icvBack)))&&(Ee.s.bgColor={rgb:At})}},D=function(ge,Ee,ke){if(!(we>1)&&!(ke.sheetRows&&ge.r>=ke.sheetRows)){if(ke.cellStyles&&Ee.XF&&Ee.XF.data&&z(ge,Ee,ke),delete Ee.ixfe,delete Ee.XF,c=ge,f=ot(ge),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ge.r<a.s.r&&(a.s.r=ge.r),ge.c<a.s.c&&(a.s.c=ge.c),ge.r+1>a.e.r&&(a.e.r=ge.r+1),ge.c+1>a.e.c&&(a.e.c=ge.c+1),ke.cellFormula&&Ee.f){for(var et=0;et<C.length;++et)if(!(C[et][0].s.c>ge.c||C[et][0].s.r>ge.r)&&!(C[et][0].e.c<ge.c||C[et][0].e.r<ge.r)){Ee.F=ct(C[et][0]),(C[et][0].s.c!=ge.c||C[et][0].s.r!=ge.r)&&delete Ee.f,Ee.f&&(Ee.f=""+Qi(C[et][1],a,ge,j,T));break}}ke.dense?(r[ge.r]||(r[ge.r]=[]),r[ge.r][ge.c]=Ee):r[f]=Ee}},T={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var M,K=[],te=[],ee=[],J=[],re=!1,j=[];j.SheetNames=T.snames,j.sharedf=T.sharedf,j.arrayf=T.arrayf,j.names=[],j.XTI=[];var de=0,we=0,N=0,H=[],L=[],_;T.codepage=1200,ls(1200);for(var U=!1;s.l<s.length-1;){var se=s.l,ae=s.read_shift(2);if(ae===0&&de===10)break;var oe=s.l===s.length?0:s.read_shift(2),me=ap[ae];if(me&&me.f){if(t.bookSheets&&de===133&&ae!==133)break;if(de=ae,me.r===2||me.r==12){var Re=s.read_shift(2);if(oe-=2,!T.enc&&Re!==ae&&((Re&255)<<8|Re>>8)!==ae)throw new Error("rt mismatch: "+Re+"!="+ae);me.r==12&&(s.l+=10,oe-=10)}var V={};if(ae===10?V=me.f(s,oe,T):V=NM(ae,me,s,oe,T),we==0&&[9,521,1033,2057].indexOf(de)===-1)continue;switch(ae){case 34:e.opts.Date1904=E.WBProps.date1904=V;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(T.enc||(s.l=0),T.enc=V,!t.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=V;break;case 66:var $e=Number(V);switch($e){case 21010:$e=1200;break;case 32768:$e=1e4;break;case 32769:$e=1252;break}ls(T.codepage=$e),U=!0;break;case 317:T.rrtabid=V;break;case 25:T.winlocked=V;break;case 439:e.opts.RefreshAll=V;break;case 12:e.opts.CalcCount=V;break;case 16:e.opts.CalcDelta=V;break;case 17:e.opts.CalcIter=V;break;case 13:e.opts.CalcMode=V;break;case 14:e.opts.CalcPrecision=V;break;case 95:e.opts.CalcSaveRecalc=V;break;case 15:T.CalcRefMode=V;break;case 2211:e.opts.FullCalc=V;break;case 129:V.fDialog&&(r["!type"]="dialog"),V.fBelow||((r["!outline"]||(r["!outline"]={})).above=!0),V.fRight||((r["!outline"]||(r["!outline"]={})).left=!0);break;case 224:w.push(V);break;case 430:j.push([V]),j[j.length-1].XTI=[];break;case 35:case 547:j[j.length-1].push(V);break;case 24:case 536:_={Name:V.Name,Ref:Qi(V.rgce,a,null,j,T)},V.itab>0&&(_.Sheet=V.itab-1),j.names.push(_),j[0]||(j[0]=[],j[0].XTI=[]),j[j.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(L[V.itab-1]={ref:ct(V.rgce[0][0][1][2])});break;case 22:T.ExternCount=V;break;case 23:j.length==0&&(j[0]=[],j[0].XTI=[]),j[j.length-1].XTI=j[j.length-1].XTI.concat(V),j.XTI=j.XTI.concat(V);break;case 2196:if(T.biff<8)break;_!=null&&(_.Comment=V[1]);break;case 18:r["!protect"]=V;break;case 19:V!==0&&T.WTF&&console.error("Password verifier: "+V);break;case 133:n[V.pos]=V,T.snames.push(V.name);break;case 10:{if(--we)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,r["!ref"]=ct(a),t.sheetRows&&t.sheetRows<=a.e.r){var Me=a.e.r;a.e.r=t.sheetRows-1,r["!fullref"]=r["!ref"],r["!ref"]=ct(a),a.e.r=Me}a.e.r++,a.e.c++}K.length>0&&(r["!merges"]=K),te.length>0&&(r["!objects"]=te),ee.length>0&&(r["!cols"]=ee),J.length>0&&(r["!rows"]=J),E.Sheets.push(k)}h===""?u=r:i[h]=r,r=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),T.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(T.biff=5,U=!0,ls(T.codepage=28591)),T.biff==8&&V.BIFFVer==0&&V.dt==16&&(T.biff=2),we++)break;if(r=t.dense?[]:{},T.biff<8&&!U&&(U=!0,ls(T.codepage=t.codepage||1252)),T.biff<5||V.BIFFVer==0&&V.dt==4096){h===""&&(h="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Ze={pos:s.l-oe,name:h};n[Ze.pos]=Ze,T.snames.push(h)}else h=(n[se]||{name:""}).name;V.dt==32&&(r["!type"]="chart"),V.dt==64&&(r["!type"]="macro"),K=[],te=[],T.arrayf=C=[],ee=[],J=[],re=!1,k={Hidden:(n[se]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:r["!type"]=="chart"&&(t.dense?(r[V.r]||[])[V.c]:r[ot({c:V.c,r:V.r})])&&++V.c,y={ixfe:V.ixfe,XF:w[V.ixfe]||{},v:V.val,t:"n"},N>0&&(y.z=H[y.ixfe>>8&63]),As(y,t,e.opts.Date1904),D({c:V.c,r:V.r},y,t);break;case 5:case 517:y={ixfe:V.ixfe,XF:w[V.ixfe],v:V.val,t:V.t},N>0&&(y.z=H[y.ixfe>>8&63]),As(y,t,e.opts.Date1904),D({c:V.c,r:V.r},y,t);break;case 638:y={ixfe:V.ixfe,XF:w[V.ixfe],v:V.rknum,t:"n"},N>0&&(y.z=H[y.ixfe>>8&63]),As(y,t,e.opts.Date1904),D({c:V.c,r:V.r},y,t);break;case 189:for(var Je=V.c;Je<=V.C;++Je){var Le=V.rkrec[Je-V.c][0];y={ixfe:Le,XF:w[Le],v:V.rkrec[Je-V.c][1],t:"n"},N>0&&(y.z=H[y.ixfe>>8&63]),As(y,t,e.opts.Date1904),D({c:Je,r:V.r},y,t)}break;case 6:case 518:case 1030:{if(V.val=="String"){o=V;break}if(y=hu(V.val,V.cell.ixfe,V.tt),y.XF=w[y.ixfe],t.cellFormula){var Ct=V.formula;if(Ct&&Ct[0]&&Ct[0][0]&&Ct[0][0][0]=="PtgExp"){var si=Ct[0][0][1][0],Wt=Ct[0][0][1][1],li=ot({r:si,c:Wt});b[li]?y.f=""+Qi(V.formula,a,V.cell,j,T):y.F=((t.dense?(r[si]||[])[Wt]:r[li])||{}).F}else y.f=""+Qi(V.formula,a,V.cell,j,T)}N>0&&(y.z=H[y.ixfe>>8&63]),As(y,t,e.opts.Date1904),D(V.cell,y,t),o=V}break;case 7:case 519:if(o)o.val=V,y=hu(V,o.cell.ixfe,"s"),y.XF=w[y.ixfe],t.cellFormula&&(y.f=""+Qi(o.formula,a,o.cell,j,T)),N>0&&(y.z=H[y.ixfe>>8&63]),As(y,t,e.opts.Date1904),D(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(V);var ar=ot(V[0].s);if(d=t.dense?(r[V[0].s.r]||[])[V[0].s.c]:r[ar],t.cellFormula&&d){if(!o||!ar||!d)break;d.f=""+Qi(V[1],a,V[0],j,T),d.F=ct(V[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!o)break;b[ot(o.cell)]=V[0],d=t.dense?(r[o.cell.r]||[])[o.cell.c]:r[ot(o.cell)],(d||{}).f=""+Qi(V[0],a,c,j,T)}}break;case 253:y=hu(l[V.isst].t,V.ixfe,"s"),l[V.isst].h&&(y.h=l[V.isst].h),y.XF=w[y.ixfe],N>0&&(y.z=H[y.ixfe>>8&63]),As(y,t,e.opts.Date1904),D({c:V.c,r:V.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:V.ixfe,XF:w[V.ixfe],t:"z"},N>0&&(y.z=H[y.ixfe>>8&63]),As(y,t,e.opts.Date1904),D({c:V.c,r:V.r},y,t));break;case 190:if(t.sheetStubs)for(var xi=V.c;xi<=V.C;++xi){var Tt=V.ixfe[xi-V.c];y={ixfe:Tt,XF:w[Tt],t:"z"},N>0&&(y.z=H[y.ixfe>>8&63]),As(y,t,e.opts.Date1904),D({c:xi,r:V.r},y,t)}break;case 214:case 516:case 4:y=hu(V.val,V.ixfe,"s"),y.XF=w[y.ixfe],N>0&&(y.z=H[y.ixfe>>8&63]),As(y,t,e.opts.Date1904),D({c:V.c,r:V.r},y,t);break;case 0:case 512:we===1&&(a=V);break;case 252:l=V;break;case 1054:if(T.biff==4){H[N++]=V[1];for(var Ni=0;Ni<N+163&&nt[Ni]!=V[1];++Ni);Ni>=163&&Fs(V[1],N+163)}else Fs(V[1],V[0]);break;case 30:{H[N++]=V;for(var Di=0;Di<N+163&&nt[Di]!=V;++Di);Di>=163&&Fs(V,N+163)}break;case 229:K=K.concat(V);break;case 93:te[V.cmo[0]]=T.lastobj=V;break;case 438:T.lastobj.TxO=V;break;case 127:T.lastobj.ImData=V;break;case 440:for(g=V[0].s.r;g<=V[0].e.r;++g)for(v=V[0].s.c;v<=V[0].e.c;++v)d=t.dense?(r[g]||[])[v]:r[ot({c:v,r:g})],d&&(d.l=V[1]);break;case 2048:for(g=V[0].s.r;g<=V[0].e.r;++g)for(v=V[0].s.c;v<=V[0].e.c;++v)d=t.dense?(r[g]||[])[v]:r[ot({c:v,r:g})],d&&d.l&&(d.l.Tooltip=V[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;d=t.dense?(r[V[0].r]||[])[V[0].c]:r[ot(V[0])];var F=te[V[2]];d||(t.dense?(r[V[0].r]||(r[V[0].r]=[]),d=r[V[0].r][V[0].c]={t:"z"}):d=r[ot(V[0])]={t:"z"},a.e.r=Math.max(a.e.r,V[0].r),a.s.r=Math.min(a.s.r,V[0].r),a.e.c=Math.max(a.e.c,V[0].c),a.s.c=Math.min(a.s.c,V[0].c)),d.c||(d.c=[]),p={a:V[1],t:F.TxO.t},d.c.push(p)}break;case 2173:SR(w[V.ixfe],V.ext);break;case 125:{if(!T.cellStyles)break;for(;V.e>=V.s;)ee[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},re||(re=!0,jm(V.w/256)),Ln(ee[V.e+1])}break;case 520:{var Q={};V.level!=null&&(J[V.r]=Q,Q.level=V.level),V.hidden&&(J[V.r]=Q,Q.hidden=!0),V.hpt&&(J[V.r]=Q,Q.hpt=V.hpt,Q.hpx=Oo(V.hpt))}break;case 38:case 39:case 40:case 41:r["!margins"]||fa(r["!margins"]={}),r["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=V;break;case 161:r["!margins"]||fa(r["!margins"]={}),r["!margins"].header=V.header,r["!margins"].footer=V.footer;break;case 574:V.RTL&&(E.Views[0].RTL=!0);break;case 146:S=V;break;case 2198:M=V;break;case 140:x=V;break;case 442:h?k.CodeName=V||k.name:E.WBProps.CodeName=V||"ThisWorkbook";break}}else me||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),s.l+=oe}return e.SheetNames=mi(n).sort(function(pe,ge){return Number(pe)-Number(ge)}).map(function(pe){return n[pe].name}),t.bookSheets||(e.Sheets=i),!e.SheetNames.length&&u["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=u)):e.Preamble=u,e.Sheets&&L.forEach(function(pe,ge){e.Sheets[e.SheetNames[ge]]["!autofilter"]=pe}),e.Strings=l,e.SSF=Ut(nt),T.enc&&(e.Encryption=T.enc),M&&(e.Themes=M),e.Metadata={},x!==void 0&&(e.Metadata.Country=x),j.names.length>0&&(E.Names=j.names),e.Workbook=E,e}var Vl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function PM(s,t,e){var i=rt.find(s,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var r=cg(i,Zd,Vl.DSI);for(var n in r)t[n]=r[n]}catch(h){if(e.WTF)throw h}var a=rt.find(s,"/!SummaryInformation");if(a&&a.size>0)try{var o=cg(a,ep,Vl.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(h){if(e.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&(jx(t.HeadingPairs,t.TitlesOfParts,t,e),delete t.HeadingPairs,delete t.TitlesOfParts)}function BM(s,t){var e=[],i=[],r=[],n=0,a,o=W0(Zd,"n"),l=W0(ep,"n");if(s.Props)for(a=mi(s.Props),n=0;n<a.length;++n)(Object.prototype.hasOwnProperty.call(o,a[n])?e:Object.prototype.hasOwnProperty.call(l,a[n])?i:r).push([a[n],s.Props[a[n]]]);if(s.Custprops)for(a=mi(s.Custprops),n=0;n<a.length;++n)Object.prototype.hasOwnProperty.call(s.Props||{},a[n])||(Object.prototype.hasOwnProperty.call(o,a[n])?e:Object.prototype.hasOwnProperty.call(l,a[n])?i:r).push([a[n],s.Custprops[a[n]]]);var h=[];for(n=0;n<r.length;++n)Yx.indexOf(r[n][0])>-1||zx.indexOf(r[n][0])>-1||r[n][1]!=null&&h.push(r[n]);i.length&&rt.utils.cfb_add(t,"/SummaryInformation",fg(i,Vl.SI,l,ep)),(e.length||h.length)&&rt.utils.cfb_add(t,"/DocumentSummaryInformation",fg(e,Vl.DSI,o,Zd,h.length?h:null,Vl.UDI))}function Jm(s,t){t||(t={}),Zm(t),Mc(),t.codepage&&Nc(t.codepage);var e,i;if(s.FullPaths){if(rt.find(s,"/encryption"))throw new Error("File is password-protected");e=rt.find(s,"!CompObj"),i=rt.find(s,"/Workbook")||rt.find(s,"/Book")}else{switch(t.type){case"base64":s=Vr(qr(s));break;case"binary":s=Vr(s);break;case"buffer":break;case"array":Array.isArray(s)||(s=Array.prototype.slice.call(s));break}$i(s,0),i={content:s}}var r,n;if(e&&_M(e),t.bookProps&&!t.bookSheets)r={};else{var a=vt?"buffer":"array";if(i&&i.content)r=MM(i.content,t);else if((n=rt.find(s,"PerfectOffice_MAIN"))&&n.content)r=ca.to_workbook(n.content,(t.type=a,t));else if((n=rt.find(s,"NativeContent_MAIN"))&&n.content)r=ca.to_workbook(n.content,(t.type=a,t));else throw(n=rt.find(s,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&s.FullPaths&&rt.find(s,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=QR(s))}var o={};return s.FullPaths&&PM(s,o,t),r.Props=r.Custprops=o,t.bookFiles&&(r.cfb=s),r}function HM(s,t){var e=t||{},i=rt.utils.cfb_new({root:"R"}),r="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":r="/Workbook",e.biff=8;break;case"biff5":r="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return rt.utils.cfb_add(i,r,qC(s,e)),e.biff==8&&(s.Props||s.Custprops)&&BM(s,i),e.biff==8&&s.vbaraw&&ZR(i,rt.read(s.vbaraw,{type:typeof s.vbaraw=="string"?"binary":"buffer"})),i}var oh={0:{f:uF},1:{f:bF},2:{f:PF},3:{f:TF},4:{f:wF},5:{f:FF},6:{f:zF},7:{f:LF},8:{f:KF},9:{f:XF},10:{f:qF},11:{f:GF},12:{f:xF},13:{f:HF},14:{f:OF},15:{f:SF},16:{f:PC},17:{f:UF},18:{f:IF},19:{f:_m},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:jN},40:{},42:{},43:{f:zL},44:{f:VL},45:{f:$L},46:{f:GL},47:{f:qL},48:{},49:{f:dO},50:{},51:{f:AR},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:oC},62:{f:WF},63:{f:MR},64:{f:cN},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:sr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:oN},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:vF},148:{f:dF,p:16},151:{f:tN},152:{},153:{f:VN},154:{},155:{},156:{f:BN},157:{},158:{},159:{T:1,f:rL},160:{T:-1},161:{T:1,f:Ia},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:YF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:kR},336:{T:-1},337:{f:LR,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:aC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:iN},427:{f:rN},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nN},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:mF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:ZF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:GR},633:{T:1},634:{T:-1},635:{T:1,f:$R},636:{T:-1},637:{f:gO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:ON},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:fN},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ap={6:{f:Rf},10:{f:ln},12:{f:Ai},13:{f:Ai},14:{f:gi},15:{f:gi},16:{f:tr},17:{f:gi},18:{f:gi},19:{f:Ai},20:{f:bg},21:{f:bg},23:{f:aC},24:{f:xg},25:{f:gi},26:{},27:{},28:{f:f2},29:{},34:{f:gi},35:{f:yg},38:{f:tr},39:{f:tr},40:{f:tr},41:{f:tr},42:{f:gi},43:{f:gi},47:{f:SL},49:{f:HD},51:{f:Ai},60:{},61:{f:FD},64:{f:gi},65:{f:BD},66:{f:Ai},77:{},80:{},81:{},82:{},85:{f:Ai},89:{},90:{},91:{},92:{f:ED},93:{f:m2},94:{},95:{f:gi},96:{},97:{},99:{f:gi},125:{f:oC},128:{f:e2},129:{f:kD},130:{f:Ai},131:{f:gi},132:{f:gi},133:{f:TD},134:{},140:{f:E2},141:{f:Ai},144:{},146:{f:T2},151:{},152:{},153:{},154:{},155:{},156:{f:Ai},157:{},158:{},160:{f:_2},161:{f:D2},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:YD},190:{f:JD},193:{f:ln},197:{},198:{},199:{},200:{},201:{},202:{f:gi},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ai},220:{},221:{f:gi},222:{},224:{f:ZD},225:{f:wD},226:{f:ln},227:{},229:{f:d2},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:OD},253:{f:WD},255:{f:LD},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Jx},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gi},353:{f:ln},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:n2},431:{f:gi},432:{},433:{},434:{},437:{},438:{f:b2},439:{f:gi},440:{f:y2},441:{},442:{f:yh},443:{},444:{f:Ai},445:{},446:{},448:{f:ln},449:{f:_D,r:2},450:{f:ln},512:{f:mg},513:{f:I2},515:{f:r2},516:{f:jD},517:{f:gg},519:{f:F2},520:{f:RD},523:{},545:{f:Cg},549:{f:pg},566:{},574:{f:MD},638:{f:KD},659:{},1048:{},1054:{f:$D},1084:{},1212:{f:h2},2048:{f:C2},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:au},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ln},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:A2,r:12},2173:{f:ER,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gi,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:l2,r:12},2197:{},2198:{f:gR,r:12},2199:{},2200:{},2201:{},2202:{f:u2,r:12},2203:{f:ln},2204:{},2205:{},2206:{},2207:{},2211:{f:ID},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ai},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:L2},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:k2},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:mg},1:{},2:{f:H2},3:{f:P2},4:{f:M2},5:{f:gg},7:{f:W2},8:{},9:{f:au},11:{},22:{f:Ai},30:{f:GD},31:{},32:{},33:{f:Cg},36:{},37:{f:pg},50:{f:z2},62:{},52:{},67:{},68:{f:Ai},69:{},86:{},126:{},127:{f:N2},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:j2},223:{},234:{},354:{},421:{},518:{f:Rf},521:{f:au},536:{f:xg},547:{f:yg},561:{},579:{},1030:{f:Rf},1033:{f:au},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ve(s,t,e,i){var r=t;if(!isNaN(r)){var n=i||(e||[]).length||0,a=s.next(4);a.write_shift(2,r),a.write_shift(2,n),n>0&&Lm(e)&&s.push(e)}}function VM(s,t,e,i){var r=(e||[]).length||0;if(r<=8224)return Ve(s,t,e,r);var n=t;if(!isNaN(n)){for(var a=e.parts||[],o=0,l=0,h=0;h+(a[o]||8224)<=8224;)h+=a[o]||8224,o++;var u=s.next(4);for(u.write_shift(2,n),u.write_shift(2,h),s.push(e.slice(l,l+h)),l+=h;l<r;){for(u=s.next(4),u.write_shift(2,60),h=0;h+(a[o]||8224)<=8224;)h+=a[o]||8224,o++;u.write_shift(2,h),s.push(e.slice(l,l+h)),l+=h}}}function Eh(s,t,e){return s||(s=Ce(7)),s.write_shift(2,t),s.write_shift(2,e),s.write_shift(2,0),s.write_shift(1,0),s}function WM(s,t,e,i){var r=Ce(9);return Eh(r,s,t),Qx(e,i||"b",r),r}function zM(s,t,e){var i=Ce(8+2*e.length);return Eh(i,s,t),i.write_shift(1,e.length),i.write_shift(e.length,e,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function jM(s,t,e,i){if(t.v!=null)switch(t.t){case"d":case"n":var r=t.t=="d"?Fi(ti(t.v)):t.v;r==(r|0)&&r>=0&&r<65536?Ve(s,2,V2(e,i,r)):Ve(s,3,B2(e,i,r));return;case"b":case"e":Ve(s,5,WM(e,i,t.v,t.t));return;case"s":case"str":Ve(s,4,zM(e,i,(t.v||"").slice(0,255)));return}Ve(s,1,Eh(null,e,i))}function UM(s,t,e,i){var r=Array.isArray(t),n=Et(t["!ref"]||"A1"),a,o="",l=[];if(n.e.c>255||n.e.r>16383){if(i.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");n.e.c=Math.min(n.e.c,255),n.e.r=Math.min(n.e.c,16383),a=ct(n)}for(var h=n.s.r;h<=n.e.r;++h){o=di(h);for(var u=n.s.c;u<=n.e.c;++u){h===n.s.r&&(l[u]=ei(u)),a=l[u]+o;var c=r?(t[h]||[])[u]:t[a];c&&jM(s,c,h,u)}}}function $M(s,t){for(var e=t||{},i=Dr(),r=0,n=0;n<s.SheetNames.length;++n)s.SheetNames[n]==e.sheet&&(r=n);if(r==0&&e.sheet&&s.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return Ve(i,e.biff==4?1033:e.biff==3?521:9,Vm(s,16,e)),UM(i,s.Sheets[s.SheetNames[r]],r,e),Ve(i,10),i.end()}function qM(s,t,e){Ve(s,49,VD({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}function GM(s,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&Ve(s,1054,qD(r,t[r],e))})}function XM(s,t){var e=Ce(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),Ve(s,2151,e),e=Ce(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),rC(Et(t["!ref"]||"A1"),e),e.write_shift(4,4),Ve(s,2152,e)}function KM(s,t){for(var e=0;e<16;++e)Ve(s,224,vg({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(i){Ve(s,224,vg(i,0,t))})}function YM(s,t){for(var e=0;e<t["!links"].length;++e){var i=t["!links"][e];Ve(s,440,x2(i)),i[1].Tooltip&&Ve(s,2048,w2(i))}delete t["!links"]}function JM(s,t){if(t){var e=0;t.forEach(function(i,r){++e<=256&&i&&Ve(s,125,O2(Uc(r,i),r))})}}function QM(s,t,e,i,r){var n=16+Pn(r.cellXfs,t,r);if(t.v==null&&!t.bf){Ve(s,513,wa(e,i,n));return}if(t.bf)Ve(s,6,k_(t,e,i,r,n));else switch(t.t){case"d":case"n":var a=t.t=="d"?Fi(ti(t.v)):t.v;Ve(s,515,s2(e,i,a,n));break;case"b":case"e":Ve(s,517,i2(e,i,t.v,n,r,t.t));break;case"s":case"str":if(r.bookSST){var o=Xm(r.Strings,t.v,r.revStrings);Ve(s,253,zD(e,i,o,n))}else Ve(s,516,UD(e,i,(t.v||"").slice(0,255),n,r));break;default:Ve(s,513,wa(e,i,n))}}function ZM(s,t,e){var i=Dr(),r=e.SheetNames[s],n=e.Sheets[r]||{},a=(e||{}).Workbook||{},o=(a.Sheets||[])[s]||{},l=Array.isArray(n),h=t.biff==8,u,c="",f=[],d=Et(n["!ref"]||"A1"),p=h?65536:16384;if(d.e.c>255||d.e.r>=p){if(t.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,p-1)}Ve(i,2057,Vm(e,16,t)),Ve(i,13,ss(1)),Ve(i,12,ss(100)),Ve(i,15,dr(!0)),Ve(i,17,dr(!1)),Ve(i,16,xa(.001)),Ve(i,95,dr(!0)),Ve(i,42,dr(!1)),Ve(i,43,dr(!1)),Ve(i,130,ss(1)),Ve(i,128,t2()),Ve(i,131,dr(!1)),Ve(i,132,dr(!1)),h&&JM(i,n["!cols"]),Ve(i,512,XD(d,t)),h&&(n["!links"]=[]);for(var v=d.s.r;v<=d.e.r;++v){c=di(v);for(var g=d.s.c;g<=d.e.c;++g){v===d.s.r&&(f[g]=ei(g)),u=f[g]+c;var b=l?(n[v]||[])[g]:n[u];b&&(QM(i,b,v,g,t),h&&b.l&&n["!links"].push([u,b.l]))}}var C=o.CodeName||o.name||r;return h&&Ve(i,574,PD((a.Views||[])[0])),h&&(n["!merges"]||[]).length&&Ve(i,229,p2(n["!merges"])),h&&YM(i,n),Ve(i,442,Zx(C)),h&&XM(i,n),Ve(i,10),i.end()}function eP(s,t,e){var i=Dr(),r=(s||{}).Workbook||{},n=r.Sheets||[],a=r.WBProps||{},o=e.biff==8,l=e.biff==5;if(Ve(i,2057,Vm(s,5,e)),e.bookType=="xla"&&Ve(i,135),Ve(i,225,o?ss(1200):null),Ve(i,193,iD(2)),l&&Ve(i,191),l&&Ve(i,192),Ve(i,226),Ve(i,92,SD("SheetJS",e)),Ve(i,66,ss(o?1200:1252)),o&&Ve(i,353,ss(0)),o&&Ve(i,448),Ve(i,317,R2(s.SheetNames.length)),o&&s.vbaraw&&Ve(i,211),o&&s.vbaraw){var h=a.CodeName||"ThisWorkbook";Ve(i,442,Zx(h))}Ve(i,156,ss(17)),Ve(i,25,dr(!1)),Ve(i,18,dr(!1)),Ve(i,19,ss(0)),o&&Ve(i,431,dr(!1)),o&&Ve(i,444,ss(0)),Ve(i,61,ND()),Ve(i,64,dr(!1)),Ve(i,141,ss(0)),Ve(i,34,dr(_N(s)=="true")),Ve(i,14,dr(!0)),o&&Ve(i,439,dr(!1)),Ve(i,218,ss(0)),qM(i,s,e),GM(i,s.SSF,e),KM(i,e),o&&Ve(i,352,dr(!1));var u=i.end(),c=Dr();o&&Ve(c,140,S2()),o&&e.Strings&&VM(c,252,DD(e.Strings)),Ve(c,10);var f=c.end(),d=Dr(),p=0,v=0;for(v=0;v<s.SheetNames.length;++v)p+=(o?12:11)+(o?2:1)*s.SheetNames[v].length;var g=u.length+p+f.length;for(v=0;v<s.SheetNames.length;++v){var b=n[v]||{};Ve(d,133,AD({pos:g,hs:b.Hidden||0,dt:0,name:s.SheetNames[v]},e)),g+=t[v].length}var C=d.end();if(p!=C.length)throw new Error("BS8 "+p+" != "+C.length);var y=[];return u.length&&y.push(u),C.length&&y.push(C),f.length&&y.push(f),Hi(y)}function tP(s,t){var e=t||{},i=[];s&&!s.SSF&&(s.SSF=Ut(nt)),s&&s.SSF&&(Fo(),vh(s.SSF),e.revssf=Bc(s.SSF),e.revssf[s.SSF[65535]]=0,e.ssf=s.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ev(e),e.cellXfs=[],Pn(e.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={});for(var r=0;r<s.SheetNames.length;++r)i[i.length]=ZM(r,e,s);return i.unshift(eP(s,i,e)),Hi(i)}function qC(s,t){for(var e=0;e<=s.SheetNames.length;++e){var i=s.Sheets[s.SheetNames[e]];if(!(!i||!i["!ref"])){var r=yr(i["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+s.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var n=t||{};switch(n.biff||2){case 8:case 5:return tP(s,t);case 4:case 3:case 2:return $M(s,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}function Rg(s,t){var e=t||{},i=e.dense?[]:{};s=s.replace(/<!--.*?-->/g,"");var r=s.match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");var n=s.match(/<\/table/i),a=r.index,o=n&&n.index||s.length,l=VA(s.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,u=0,c=0,f=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(a=0;a<l.length;++a){var v=l[a].trim(),g=v.slice(0,3).toLowerCase();if(g=="<tr"){if(++h,e.sheetRows&&e.sheetRows<=h){--h;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var b=v.split(/<\/t[dh]>/i);for(o=0;o<b.length;++o){var C=b[o].trim();if(C.match(/<t[dh]/i)){for(var y=C,x=0;y.charAt(0)=="<"&&(x=y.indexOf(">"))>-1;)y=y.slice(x+1);for(var w=0;w<p.length;++w){var S=p[w];S.s.c==u&&S.s.r<h&&h<=S.e.r&&(u=S.e.c+1,w=-1)}var E=lt(C.slice(0,C.indexOf(">")));f=E.colspan?+E.colspan:1,((c=+E.rowspan)>1||f>1)&&p.push({s:{r:h,c:u},e:{r:h+(c||1)-1,c:u+f-1}});var k=E.t||E["data-t"]||"";if(!y.length){u+=f;continue}if(y=xx(y),d.s.r>h&&(d.s.r=h),d.e.r<h&&(d.e.r=h),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),!y.length){u+=f;continue}var A={t:"s",v:y};e.raw||!y.trim().length||k=="s"||(y==="TRUE"?A={t:"b",v:!0}:y==="FALSE"?A={t:"b",v:!1}:isNaN(Es(y))?isNaN(To(y).getDate())||(A={t:"d",v:ti(y)},e.cellDates||(A={t:"n",v:Fi(A.v)}),A.z=e.dateNF||nt[14]):A={t:"n",v:Es(y)}),e.dense?(i[h]||(i[h]=[]),i[h][u]=A):i[ot({r:h,c:u})]=A,u+=f}}}}return i["!ref"]=ct(d),p.length&&(i["!merges"]=p),i}function GC(s,t,e,i){for(var r=s["!merges"]||[],n=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,h=0;h<r.length;++h)if(!(r[h].s.r>e||r[h].s.c>a)&&!(r[h].e.r<e||r[h].e.c<a)){if(r[h].s.r<e||r[h].s.c<a){o=-1;break}o=r[h].e.r-r[h].s.r+1,l=r[h].e.c-r[h].s.c+1;break}if(!(o<0)){var u=ot({r:e,c:a}),c=i.dense?(s[e]||[])[a]:s[u],f=c&&c.v!=null&&(c.h||Em(c.w||(Ms(c),c.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),i.editable?f='<span contenteditable="true">'+f+"</span>":c&&(d["data-t"]=c&&c.t||"z",c.v!=null&&(d["data-v"]=c.v),c.z!=null&&(d["data-z"]=c.z),c.l&&(c.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+c.l.Target+'">'+f+"</a>")),d.id=(i.id||"sjs")+"-"+u,n.push(Be("td",f,d))}}var p="<tr>";return p+n.join("")+"</tr>"}var XC='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',KC="</body></html>";function iP(s,t){var e=s.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return Mn(Rg(e[0],t),t);var i=nv();return e.forEach(function(r,n){av(i,Rg(r,t),"Sheet"+(n+1))}),i}function YC(s,t,e){var i=[];return i.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function JC(s,t){var e=t||{},i=e.header!=null?e.header:XC,r=e.footer!=null?e.footer:KC,n=[i],a=yr(s["!ref"]);e.dense=Array.isArray(s),n.push(YC(s,a,e));for(var o=a.s.r;o<=a.e.r;++o)n.push(GC(s,a,o,e));return n.push("</table>"+r),n.join("")}function QC(s,t,e){var i=e||{},r=0,n=0;if(i.origin!=null)if(typeof i.origin=="number")r=i.origin;else{var a=typeof i.origin=="string"?oi(i.origin):i.origin;r=a.r,n=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(i.sheetRows||1e7,o.length),h={s:{r:0,c:0},e:{r,c:n}};if(s["!ref"]){var u=yr(s["!ref"]);h.s.r=Math.min(h.s.r,u.s.r),h.s.c=Math.min(h.s.c,u.s.c),h.e.r=Math.max(h.e.r,u.e.r),h.e.c=Math.max(h.e.c,u.e.c),r==-1&&(h.e.r=r=u.e.r+1)}var c=[],f=0,d=s["!rows"]||(s["!rows"]=[]),p=0,v=0,g=0,b=0,C=0,y=0;for(s["!cols"]||(s["!cols"]=[]);p<o.length&&v<l;++p){var x=o[p];if(Ig(x)){if(i.display)continue;d[v]={hidden:!0}}var w=x.children;for(g=b=0;g<w.length;++g){var S=w[g];if(!(i.display&&Ig(S))){var E=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):xx(S.innerHTML),k=S.getAttribute("data-z")||S.getAttribute("z");for(f=0;f<c.length;++f){var A=c[f];A.s.c==b+n&&A.s.r<v+r&&v+r<=A.e.r&&(b=A.e.c+1-n,f=-1)}y=+S.getAttribute("colspan")||1,((C=+S.getAttribute("rowspan")||1)>1||y>1)&&c.push({s:{r:v+r,c:b+n},e:{r:v+r+(C||1)-1,c:b+n+(y||1)-1}});var z={t:"s",v:E},D=S.getAttribute("data-t")||S.getAttribute("t")||"";E!=null&&(E.length==0?z.t=D||"z":i.raw||E.trim().length==0||D=="s"||(E==="TRUE"?z={t:"b",v:!0}:E==="FALSE"?z={t:"b",v:!1}:isNaN(Es(E))?isNaN(To(E).getDate())||(z={t:"d",v:ti(E)},i.cellDates||(z={t:"n",v:Fi(z.v)}),z.z=i.dateNF||nt[14]):z={t:"n",v:Es(E)})),z.z===void 0&&k!=null&&(z.z=k);var T="",M=S.getElementsByTagName("A");if(M&&M.length)for(var K=0;K<M.length&&!(M[K].hasAttribute("href")&&(T=M[K].getAttribute("href"),T.charAt(0)!="#"));++K);T&&T.charAt(0)!="#"&&(z.l={Target:T}),i.dense?(s[v+r]||(s[v+r]=[]),s[v+r][b+n]=z):s[ot({c:b+n,r:v+r})]=z,h.e.c<b+n&&(h.e.c=b+n),b+=y}}++v}return c.length&&(s["!merges"]=(s["!merges"]||[]).concat(c)),h.e.r=Math.max(h.e.r,v-1+r),s["!ref"]=ct(h),v>=l&&(s["!fullref"]=ct((h.e.r=o.length-p+v-1+r,h))),s}function ZC(s,t){var e=t||{},i=e.dense?[]:{};return QC(i,s,t)}function rP(s,t){return Mn(ZC(s,t),t)}function Ig(s){var t="",e=sP(s);return e&&(t=e(s).getPropertyValue("display")),t||(t=s.style&&s.style.display),t==="none"}function sP(s){return s.ownerDocument.defaultView&&typeof s.ownerDocument.defaultView.getComputedStyle=="function"?s.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function nP(s){var t=s.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,r){return Array(parseInt(r,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,"\n"),e=Dt(t.replace(/<[^>]*>/g,""));return[e]}var _g={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ew(s,t){var e=t||{},i=Sm(s),r=[],n,a,o={name:""},l="",h=0,u,c,f={},d=[],p=e.dense?[]:{},v,g,b={value:""},C="",y=0,x=[],w=-1,S=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,A={},z=[],D={},T=0,M=0,K=[],te=1,ee=1,J=[],re={Names:[]},j={},de=["",""],we=[],N={},H="",L=0,_=!1,U=!1,se=0;for(th.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=th.exec(i);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?p["!ref"]=ct(E):p["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=e.sheetRows-1,p["!ref"]=ct(E)),z.length&&(p["!merges"]=z),K.length&&(p["!rows"]=K),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),d.push(u.name),f[u.name]=p,U=!1):v[0].charAt(v[0].length-2)!=="/"&&(u=lt(v[0],!1),w=S=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,p=e.dense?[]:{},z=[],K=[],U=!0);break;case"table-row-group":v[1]==="/"?--k:++k;break;case"table-row":case"":if(v[1]==="/"){w+=te,te=1;break}if(c=lt(v[0],!1),c.?w=c.-1:w==-1&&(w=0),te=+c["number-rows-repeated"]||1,te<10)for(se=0;se<te;++se)k>0&&(K[w+se]={level:k});S=-1;break;case"covered-table-cell":v[1]!=="/"&&++S,e.sheetStubs&&(e.dense?(p[w]||(p[w]=[]),p[w][S]={t:"z"}):p[ot({r:w,c:S})]={t:"z"}),C="",x=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++S,b=lt(v[0],!1),ee=parseInt(b["number-columns-repeated"]||"1",10),g={t:"z",v:null},b.formula&&e.cellFormula!=!1&&(g.f=Og(Dt(b.formula))),(b.||b["value-type"])=="string"&&(g.t="s",g.v=Dt(b["string-value"]||""),e.dense?(p[w]||(p[w]=[]),p[w][S]=g):p[ot({r:w,c:S})]=g),S+=ee-1;else if(v[1]!=="/"){++S,C="",y=0,x=[],ee=1;var ae=te?w+te-1:w;if(S>E.e.c&&(E.e.c=S),S<E.s.c&&(E.s.c=S),w<E.s.r&&(E.s.r=w),ae>E.e.r&&(E.e.r=ae),b=lt(v[0],!1),we=[],N={},g={t:b.||b["value-type"],v:null},e.cellFormula)if(b.formula&&(b.formula=Dt(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(T=parseInt(b["number-matrix-rows-spanned"],10)||0,M=parseInt(b["number-matrix-columns-spanned"],10)||0,D={s:{r:w,c:S},e:{r:w+T-1,c:S+M-1}},g.F=ct(D),J.push([D,g.F])),b.formula)g.f=Og(b.formula);else for(se=0;se<J.length;++se)w>=J[se][0].s.r&&w<=J[se][0].e.r&&S>=J[se][0].s.c&&S<=J[se][0].e.c&&(g.F=J[se][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(T=parseInt(b["number-rows-spanned"],10)||0,M=parseInt(b["number-columns-spanned"],10)||0,D={s:{r:w,c:S},e:{r:w+T-1,c:S+M-1}},z.push(D)),b["number-columns-repeated"]&&(ee=parseInt(b["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Zt(b["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(b.value);break;case"percentage":g.t="n",g.v=parseFloat(b.value);break;case"currency":g.t="n",g.v=parseFloat(b.value);break;case"date":g.t="d",g.v=ti(b["date-value"]),e.cellDates||(g.t="n",g.v=Fi(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=PA(b["time-value"])/86400,e.cellDates&&(g.t="d",g.v=Hc(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(b.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",b["string-value"]!=null&&(C=Dt(b["string-value"]),x=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(_=!1,g.t==="s"&&(g.v=C||"",x.length&&(g.R=x),_=y==0),j.Target&&(g.l=j),we.length>0&&(g.c=we,we=[]),C&&e.cellText!==!1&&(g.w=C),_&&(g.t="z",delete g.v),(!_||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=w))for(var oe=0;oe<te;++oe){if(ee=parseInt(b["number-columns-repeated"]||"1",10),e.dense)for(p[w+oe]||(p[w+oe]=[]),p[w+oe][S]=oe==0?g:Ut(g);--ee>0;)p[w+oe][S+ee]=Ut(g);else for(p[ot({r:w+oe,c:S})]=g;--ee>0;)p[ot({r:w+oe,c:S+ee})]=Ut(g);E.e.c<=S&&(E.e.c=S)}ee=parseInt(b["number-columns-repeated"]||"1",10),S+=ee-1,ee=0,g={},C="",x=[]}j={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((n=r.pop())[0]!==v[3])throw"Bad state: "+n}else v[0].charAt(v[0].length-2)!=="/"&&r.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((n=r.pop())[0]!==v[3])throw"Bad state: "+n;N.t=C,x.length&&(N.R=x),N.a=H,we.push(N)}else v[0].charAt(v[0].length-2)!=="/"&&r.push([v[3],!1]);H="",L=0,C="",y=0,x=[];break;case"creator":v[1]==="/"?H=i.slice(L,v.index):L=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((n=r.pop())[0]!==v[3])throw"Bad state: "+n}else v[0].charAt(v[0].length-2)!=="/"&&r.push([v[3],!1]);C="",y=0,x=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(A[o.name]=l,(n=r.pop())[0]!==v[3])throw"Bad state: "+n}else v[0].charAt(v[0].length-2)!=="/"&&(l="",o=lt(v[0],!1),r.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(r[r.length-1][0]){case"time-style":case"date-style":a=lt(v[0],!1),l+=_g[v[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(r[r.length-1][0]){case"time-style":case"date-style":a=lt(v[0],!1),l+=_g[v[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(r[r.length-1][0]){case"number-style":case"date-style":case"time-style":l+=i.slice(h,v.index);break}else h=v.index+v[0].length;break;case"named-range":a=lt(v[0],!1),de=If(a["cell-range-address"]);var me={Name:a.name,Ref:de[0]+"!"+de[1]};U&&(me.Sheet=d.length),re.Names.push(me);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(r[r.length-1][0])>-1)break;if(v[1]==="/"&&(!b||!b["string-value"])){var Re=nP(i.slice(y,v.index));C=(C.length>0?C+"\n":"")+Re[0]}else lt(v[0],!1),y=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{de=If(lt(v[0])["target-range-address"]),f[de[0]]["!autofilter"]={ref:de[1]}}catch($e){}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(j=lt(v[0],!1),!j.href)break;j.Target=Dt(j.href),delete j.href,j.Target.charAt(0)=="#"&&j.Target.indexOf(".")>-1?(de=If(j.Target.slice(1)),j.Target="#"+de[0]+"!"+de[1]):j.Target.match(/^\.\.[\\\/]/)&&(j.Target=j.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(e.WTF)throw new Error(v)}}var V={Sheets:f,SheetNames:d,Workbook:re};return e.bookSheets&&delete V.Sheets,V}function Fg(s,t){t=t||{},rs(s,"META-INF/manifest.xml")&&PO(Ti(s,"META-INF/manifest.xml"),t);var e=Wr(s,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var i=ew(Ht(e),t);return rs(s,"meta.xml")&&(i.Props=Vx(Ti(s,"meta.xml"))),i}function Ng(s,t){return ew(s,t)}var aP=function(){var s=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+eh({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+s+"</office:document-styles>";return function(){return yi+t}}(),Mg=function(){var s=function(n){return Pt(n).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",e="          <table:covered-table-cell/>\n",i=function(n,a,o){var l=[];l.push('      <table:table table:name="'+Pt(a.SheetNames[o])+'" table:style-name="ta1">\n');var h=0,u=0,c=yr(n["!ref"]||"A1"),f=n["!merges"]||[],d=0,p=Array.isArray(n);if(n["!cols"])for(u=0;u<=c.e.c;++u)l.push("        <table:table-column"+(n["!cols"][u]?' table:style-name="co'+n["!cols"][u].ods+'"':"")+"></table:table-column>\n");var v="",g=n["!rows"]||[];for(h=0;h<c.s.r;++h)v=g[h]?' table:style-name="ro'+g[h].ods+'"':"",l.push("        <table:table-row"+v+"></table:table-row>\n");for(;h<=c.e.r;++h){for(v=g[h]?' table:style-name="ro'+g[h].ods+'"':"",l.push("        <table:table-row"+v+">\n"),u=0;u<c.s.c;++u)l.push(t);for(;u<=c.e.c;++u){var b=!1,C={},y="";for(d=0;d!=f.length;++d)if(!(f[d].s.c>u)&&!(f[d].s.r>h)&&!(f[d].e.c<u)&&!(f[d].e.r<h)){(f[d].s.c!=u||f[d].s.r!=h)&&(b=!0),C["table:number-columns-spanned"]=f[d].e.c-f[d].s.c+1,C["table:number-rows-spanned"]=f[d].e.r-f[d].s.r+1;break}if(b){l.push(e);continue}var x=ot({r:h,c:u}),w=p?(n[h]||[])[u]:n[x];if(w&&w.f&&(C["table:formula"]=Pt(R_(w.f)),w.F&&w.F.slice(0,x.length)==x)){var S=yr(w.F);C["table:number-matrix-columns-spanned"]=S.e.c-S.s.c+1,C["table:number-matrix-rows-spanned"]=S.e.r-S.s.r+1}if(!w){l.push(t);continue}switch(w.t){case"b":y=w.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=w.v?"true":"false";break;case"n":y=w.w||String(w.v||0),C["office:value-type"]="float",C["office:value"]=w.v||0;break;case"s":case"str":y=w.v==null?"":w.v,C["office:value-type"]="string";break;case"d":y=w.w||ti(w.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=ti(w.v).toISOString(),C["table:style-name"]="ce1";break;default:l.push(t);continue}var E=s(y);if(w.l&&w.l.Target){var k=w.l.Target;k=k.charAt(0)=="#"?"#"+I_(k.slice(1)):k,k.charAt(0)!="#"&&!k.match(/^\w+:/)&&(k="../"+k),E=Be("text:a",E,{"xlink:href":k.replace(/&/g,"&amp;")})}l.push("          "+Be("table:table-cell",Be("text:p",E,{}),C)+"\n")}l.push("        </table:table-row>\n")}return l.push("      </table:table>\n"),l.join("")},r=function(n,a){n.push(" <office:automatic-styles>\n"),n.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),n.push('   <number:month number:style="long"/>\n'),n.push("   <number:text>/</number:text>\n"),n.push('   <number:day number:style="long"/>\n'),n.push("   <number:text>/</number:text>\n"),n.push("   <number:year/>\n"),n.push("  </number:date-style>\n");var o=0;a.SheetNames.map(function(h){return a.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var u=0;u<h["!cols"].length;++u)if(h["!cols"][u]){var c=h["!cols"][u];if(c.width==null&&c.wpx==null&&c.wch==null)continue;Ln(c),c.ods=o;var f=h["!cols"][u].wpx+"px";n.push('  <style:style style:name="co'+o+'" style:family="table-column">\n'),n.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+'"/>\n'),n.push("  </style:style>\n"),++o}}});var l=0;a.SheetNames.map(function(h){return a.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var u=0;u<h["!rows"].length;++u)if(h["!rows"][u]){h["!rows"][u].ods=l;var c=h["!rows"][u].hpx+"px";n.push('  <style:style style:name="ro'+l+'" style:family="table-row">\n'),n.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+c+'"/>\n'),n.push("  </style:style>\n"),++l}}}),n.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),n.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),n.push("  </style:style>\n"),n.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),n.push(" </office:automatic-styles>\n")};return function(a,o){var l=[yi],h=eh({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=eh({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+h+u+">\n"),l.push(Hx().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+h+">\n"),r(l,a),l.push("  <office:body>\n"),l.push("    <office:spreadsheet>\n");for(var c=0;c!=a.SheetNames.length;++c)l.push(i(a.Sheets[a.SheetNames[c]],a,c));return l.push("    </office:spreadsheet>\n"),l.push("  </office:body>\n"),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function tw(s,t){if(t.bookType=="fods")return Mg(s,t);var e=xm(),i="",r=[],n=[];return i="mimetype",ft(e,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",ft(e,i,Mg(s,t)),r.push([i,"text/xml"]),n.push([i,"ContentFile"]),i="styles.xml",ft(e,i,aP(s,t)),r.push([i,"text/xml"]),n.push([i,"StylesFile"]),i="meta.xml",ft(e,i,yi+Hx()),r.push([i,"text/xml"]),n.push([i,"MetadataFile"]),i="manifest.rdf",ft(e,i,VO(n)),r.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",ft(e,i,BO(r)),e}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ea(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function op(s){return typeof TextDecoder<"u"?new TextDecoder().decode(s):Ht(Nn(s))}function oP(s){return typeof TextEncoder<"u"?new TextEncoder().encode(s):Vr(Rs(s))}function lP(s,t){e:for(var e=0;e<=s.length-t.length;++e){for(var i=0;i<t.length;++i)if(s[e+i]!=t[i])continue e;return!0}return!1}function In(s){var t=s.reduce(function(r,n){return r+n.length},0),e=new Uint8Array(t),i=0;return s.forEach(function(r){e.set(r,i),i+=r.length}),e}function Pg(s){return s-=s>>1&1431655765,s=(s&858993459)+(s>>2&858993459),(s+(s>>4)&252645135)*16843009>>>24}function hP(s,t){for(var e=(s[t+15]&127)<<7|s[t+14]>>1,i=s[t+14]&1,r=t+13;r>=t;--r)i=i*256+s[r];return(s[t+15]&128?-i:i)*Math.pow(10,e-6176)}function uP(s,t,e){var i=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,r=e/Math.pow(10,i-6176);s[t+15]|=i>>7,s[t+14]|=(i&127)<<1;for(var n=0;r>=1;++n,r/=256)s[t+n]=r&255;s[t+15]|=e>=0?0:128}function lh(s,t){var e=t?t[0]:0,i=s[e]&127;e:if(s[e++]>=128&&(i|=(s[e]&127)<<7,s[e++]<128||(i|=(s[e]&127)<<14,s[e++]<128)||(i|=(s[e]&127)<<21,s[e++]<128)||(i+=(s[e]&127)*Math.pow(2,28),++e,s[e++]<128)||(i+=(s[e]&127)*Math.pow(2,35),++e,s[e++]<128)||(i+=(s[e]&127)*Math.pow(2,42),++e,s[e++]<128)))break e;return t&&(t[0]=e),i}function Nt(s){var t=new Uint8Array(7);t[0]=s&127;var e=1;e:if(s>127){if(t[e-1]|=128,t[e]=s>>7&127,++e,s<=16383||(t[e-1]|=128,t[e]=s>>14&127,++e,s<=2097151)||(t[e-1]|=128,t[e]=s>>21&127,++e,s<=268435455)||(t[e-1]|=128,t[e]=s/256>>>21&127,++e,s<=34359738367)||(t[e-1]|=128,t[e]=s/65536>>>21&127,++e,s<=4398046511103))break e;t[e-1]|=128,t[e]=s/16777216>>>21&127,++e}return t.slice(0,e)}function pi(s){var t=0,e=s[t]&127;e:if(s[t++]>=128){if(e|=(s[t]&127)<<7,s[t++]<128||(e|=(s[t]&127)<<14,s[t++]<128)||(e|=(s[t]&127)<<21,s[t++]<128))break e;e|=(s[t]&127)<<28}return e}function Rt(s){for(var t=[],e=[0];e[0]<s.length;){var i=e[0],r=lh(s,e),n=r&7;r=Math.floor(r/8);var a=0,o;if(r==0)break;switch(n){case 0:{for(var l=e[0];s[e[0]++]>=128;);o=s.slice(l,e[0])}break;case 5:a=4,o=s.slice(e[0],e[0]+a),e[0]+=a;break;case 1:a=8,o=s.slice(e[0],e[0]+a),e[0]+=a;break;case 2:a=lh(s,e),o=s.slice(e[0],e[0]+a),e[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(n," for Field ").concat(r," at offset ").concat(i))}var h={data:o,type:n};t[r]==null?t[r]=[h]:t[r].push(h)}return t}function Ui(s){var t=[];return s.forEach(function(e,i){e.forEach(function(r){r.data&&(t.push(Nt(i*8+r.type)),r.type==2&&t.push(Nt(r.data.length)),t.push(r.data))})}),In(t)}function Qm(s,t){return(s==null?void 0:s.map(function(e){return t(e.data)}))||[]}function es(s){for(var t,e=[],i=[0];i[0]<s.length;){var r=lh(s,i),n=Rt(s.slice(i[0],i[0]+r));i[0]+=r;var a={id:pi(n[1][0].data),messages:[]};n[2].forEach(function(o){var l=Rt(o.data),h=pi(l[3][0].data);a.messages.push({meta:l,data:s.slice(i[0],i[0]+h)}),i[0]+=h}),(t=n[3])!=null&&t[0]&&(a.merge=pi(n[3][0].data)>>>0>0),e.push(a)}return e}function za(s){var t=[];return s.forEach(function(e){var i=[];i[1]=[{data:Nt(e.id),type:0}],i[2]=[],e.merge!=null&&(i[3]=[{data:Nt(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(a){r.push(a.data),a.meta[3]=[{type:0,data:Nt(a.data.length)}],i[2].push({data:Ui(a.meta),type:2})});var n=Ui(i);t.push(Nt(n.length)),t.push(n),r.forEach(function(a){return t.push(a)})}),In(t)}function cP(s,t){if(s!=0)throw new Error("Unexpected Snappy chunk type ".concat(s));for(var e=[0],i=lh(t,e),r=[];e[0]<t.length;){var n=t[e[0]]&3;if(n==0){var a=t[e[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[e[0]],o>1&&(a|=t[e[0]+1]<<8),o>2&&(a|=t[e[0]+2]<<16),o>3&&(a|=t[e[0]+3]<<24),a>>>=0,a++,e[0]+=o}r.push(t.slice(e[0],e[0]+a)),e[0]+=a;continue}else{var l=0,h=0;if(n==1?(h=(t[e[0]]>>2&7)+4,l=(t[e[0]++]&224)<<3,l|=t[e[0]++]):(h=(t[e[0]++]>>2)+1,n==2?(l=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(l=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),r=[In(r)],l==0)throw new Error("Invalid offset 0");if(l>r[0].length)throw new Error("Invalid offset beyond length");if(h>=l)for(r.push(r[0].slice(-l)),h-=l;h>=r[r.length-1].length;)r.push(r[r.length-1]),h-=r[r.length-1].length;r.push(r[0].slice(-l,-l+h))}}var u=In(r);if(u.length!=i)throw new Error("Unexpected length: ".concat(u.length," != ").concat(i));return u}function ts(s){for(var t=[],e=0;e<s.length;){var i=s[e++],r=s[e]|s[e+1]<<8|s[e+2]<<16;e+=3,t.push(cP(i,s.slice(e,e+r))),e+=r}if(e!==s.length)throw new Error("data is not a valid framed stream!");return In(t)}function ja(s){for(var t=[],e=0;e<s.length;){var i=Math.min(s.length-e,268435455),r=new Uint8Array(4);t.push(r);var n=Nt(i),a=n.length;t.push(n),i<=60?(a++,t.push(new Uint8Array([i-1<<2]))):i<=256?(a+=2,t.push(new Uint8Array([240,i-1&255]))):i<=65536?(a+=3,t.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(a+=4,t.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(a+=5,t.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),t.push(s.slice(e,e+i)),a+=i,r[0]=0,r[1]=a&255,r[2]=a>>8&255,r[3]=a>>16&255,e+=i}return In(t)}function fP(s,t,e,i){var r=Ea(s),n=r.getUint32(4,!0),a=(i>1?12:8)+Pg(n&(i>1?3470:398))*4,o=-1,l=-1,h=NaN,u=new Date(2001,0,1);n&512&&(o=r.getUint32(a,!0),a+=4),a+=Pg(n&(i>1?12288:4096))*4,n&16&&(l=r.getUint32(a,!0),a+=4),n&32&&(h=r.getFloat64(a,!0),a+=8),n&64&&(u.setTime(u.getTime()+r.getFloat64(a,!0)*1e3),a+=8);var c;switch(s[2]){case 0:break;case 2:c={t:"n",v:h};break;case 3:c={t:"s",v:t[l]};break;case 5:c={t:"d",v:u};break;case 6:c={t:"b",v:h>0};break;case 7:c={t:"n",v:h/86400};break;case 8:c={t:"e",v:0};break;case 9:if(o>-1)c={t:"s",v:e[o]};else if(l>-1)c={t:"s",v:t[l]};else if(!isNaN(h))c={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(s.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(s.slice(0,4)))}return c}function dP(s,t,e){var i=Ea(s),r=i.getUint32(8,!0),n=12,a=-1,o=-1,l=NaN,h=NaN,u=new Date(2001,0,1);r&1&&(l=hP(s,n),n+=16),r&2&&(h=i.getFloat64(n,!0),n+=8),r&4&&(u.setTime(u.getTime()+i.getFloat64(n,!0)*1e3),n+=8),r&8&&(o=i.getUint32(n,!0),n+=4),r&16&&(a=i.getUint32(n,!0),n+=4);var c;switch(s[1]){case 0:break;case 2:c={t:"n",v:l};break;case 3:c={t:"s",v:t[o]};break;case 5:c={t:"d",v:u};break;case 6:c={t:"b",v:h>0};break;case 7:c={t:"n",v:h/86400};break;case 8:c={t:"e",v:0};break;case 9:if(a>-1)c={t:"s",v:e[a]};else throw new Error("Unsupported cell type ".concat(s[1]," : ").concat(r&31," : ").concat(s.slice(0,4)));break;case 10:c={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(s[1]," : ").concat(r&31," : ").concat(s.slice(0,4)))}return c}function Ff(s,t){var e=new Uint8Array(32),i=Ea(e),r=12,n=0;switch(e[0]=5,s.t){case"n":e[1]=2,uP(e,r,s.v),n|=1,r+=16;break;case"b":e[1]=6,i.setFloat64(r,s.v?1:0,!0),n|=2,r+=8;break;case"s":if(t.indexOf(s.v)==-1)throw new Error("Value ".concat(s.v," missing from SST!"));e[1]=3,i.setUint32(r,t.indexOf(s.v),!0),n|=8,r+=4;break;default:throw"unsupported cell type "+s.t}return i.setUint32(8,n,!0),e.slice(0,r)}function Nf(s,t){var e=new Uint8Array(32),i=Ea(e),r=12,n=0;switch(e[0]=3,s.t){case"n":e[2]=2,i.setFloat64(r,s.v,!0),n|=32,r+=8;break;case"b":e[2]=6,i.setFloat64(r,s.v?1:0,!0),n|=32,r+=8;break;case"s":if(t.indexOf(s.v)==-1)throw new Error("Value ".concat(s.v," missing from SST!"));e[2]=3,i.setUint32(r,t.indexOf(s.v),!0),n|=16,r+=4;break;default:throw"unsupported cell type "+s.t}return i.setUint32(4,n,!0),e.slice(0,r)}function pP(s,t,e){switch(s[0]){case 0:case 1:case 2:case 3:return fP(s,t,e,s[0]);case 5:return dP(s,t,e);default:throw new Error("Unsupported payload version ".concat(s[0]))}}function Yi(s){var t=Rt(s);return lh(t[1][0].data)}function Bg(s,t){var e=Rt(t.data),i=pi(e[1][0].data),r=e[3],n=[];return(r||[]).forEach(function(a){var o=Rt(a.data),l=pi(o[1][0].data)>>>0;switch(i){case 1:n[l]=op(o[3][0].data);break;case 8:{var h=s[Yi(o[9][0].data)][0],u=Rt(h.data),c=s[Yi(u[1][0].data)][0],f=pi(c.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var d=Rt(c.data);n[l]=d[3].map(function(p){return op(p.data)}).join("")}break}}),n}function mP(s,t){var e,i,r,n,a,o,l,h,u,c,f,d,p,v,g=Rt(s),b=pi(g[1][0].data)>>>0,C=pi(g[2][0].data)>>>0,y=((i=(e=g[8])==null?void 0:e[0])==null?void 0:i.data)&&pi(g[8][0].data)>0||!1,x,w;if((n=(r=g[7])==null?void 0:r[0])!=null&&n.data&&t!=0)x=(o=(a=g[7])==null?void 0:a[0])==null?void 0:o.data,w=(h=(l=g[6])==null?void 0:l[0])==null?void 0:h.data;else if((c=(u=g[4])==null?void 0:u[0])!=null&&c.data&&t!=1)x=(d=(f=g[4])==null?void 0:f[0])==null?void 0:d.data,w=(v=(p=g[3])==null?void 0:p[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var S=y?4:1,E=Ea(x),k=[],A=0;A<x.length/2;++A){var z=E.getUint16(A*2,!0);z<65535&&k.push([A,z])}if(k.length!=C)throw"Expected ".concat(C," cells, found ").concat(k.length);var D=[];for(A=0;A<k.length-1;++A)D[k[A][0]]=w.subarray(k[A][1]*S,k[A+1][1]*S);return k.length>=1&&(D[k[k.length-1][0]]=w.subarray(k[k.length-1][1]*S)),{R:b,cells:D}}function vP(s,t){var e,i=Rt(t.data),r=(e=i==null?void 0:i[7])!=null&&e[0]?pi(i[7][0].data)>>>0>0?1:0:-1,n=Qm(i[5],function(a){return mP(a,r)});return{nrows:pi(i[4][0].data)>>>0,data:n.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,h){if(a[o.R][h])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(h));a[o.R][h]=l}),a},[])}}function gP(s,t,e){var i,r=Rt(t.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(pi(r[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(r[6][0].data));if(n.e.c=(pi(r[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(r[7][0].data));e["!ref"]=ct(n);var a=Rt(r[4][0].data),o=Bg(s,s[Yi(a[4][0].data)][0]),l=(i=a[17])!=null&&i[0]?Bg(s,s[Yi(a[17][0].data)][0]):[],h=Rt(a[3][0].data),u=0;h[1].forEach(function(c){var f=Rt(c.data),d=s[Yi(f[2][0].data)][0],p=pi(d.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var v=vP(s,d);v.data.forEach(function(g,b){g.forEach(function(C,y){var x=ot({r:u+b,c:y}),w=pP(C,o,l);w&&(e[x]=w)})}),u+=v.nrows})}function bP(s,t){var e=Rt(t.data),i={"!ref":"A1"},r=s[Yi(e[2][0].data)],n=pi(r[0].meta[1][0].data);if(n!=6001)throw new Error("6000 unexpected reference to ".concat(n));return gP(s,r[0],i),i}function yP(s,t){var e,i=Rt(t.data),r={name:(e=i[1])!=null&&e[0]?op(i[1][0].data):"",sheets:[]},n=Qm(i[2],Yi);return n.forEach(function(a){s[a].forEach(function(o){var l=pi(o.meta[1][0].data);l==6e3&&r.sheets.push(bP(s,o))})}),r}function xP(s,t){var e=nv(),i=Rt(t.data),r=Qm(i[1],Yi);if(r.forEach(function(n){s[n].forEach(function(a){var o=pi(a.meta[1][0].data);if(o==2){var l=yP(s,a);l.sheets.forEach(function(h,u){av(e,h,u==0?l.name:l.name+"_"+u,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function Mf(s){var t,e,i,r,n={},a=[];if(s.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),s.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var h;try{h=ts(l.content)}catch(c){return console.log("?? "+l.content.length+" "+(c.message||c))}var u;try{u=es(h)}catch(c){return console.log("## "+(c.message||c))}u.forEach(function(c){n[c.id]=c.messages,a.push(c.id)})}}),!a.length)throw new Error("File has no messages");var o=((r=(i=(e=(t=n==null?void 0:n[1])==null?void 0:t[0])==null?void 0:e.meta)==null?void 0:i[1])==null?void 0:r[0].data)&&pi(n[1][0].meta[1][0].data)==1&&n[1][0];if(o||a.forEach(function(l){n[l].forEach(function(h){var u=pi(h.meta[1][0].data)>>>0;if(u==1)if(!o)o=h;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return xP(n,o)}function CP(s,t,e){var i,r,n,a;if(!((i=s[6])!=null&&i[0])||!((r=s[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(n=s[8])==null?void 0:n[0])==null?void 0:a.data)&&pi(s[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,h=Ea(s[7][0].data),u=0,c=[],f=Ea(s[4][0].data),d=0,p=[],v=0;v<t.length;++v){if(t[v]==null){h.setUint16(v*2,65535,!0),f.setUint16(v*2,65535);continue}h.setUint16(v*2,u,!0),f.setUint16(v*2,d,!0);var g,b;switch(typeof t[v]){case"string":g=Ff({t:"s",v:t[v]},e),b=Nf({t:"s",v:t[v]},e);break;case"number":g=Ff({t:"n",v:t[v]},e),b=Nf({t:"n",v:t[v]},e);break;case"boolean":g=Ff({t:"b",v:t[v]},e),b=Nf({t:"b",v:t[v]},e);break;default:throw new Error("Unsupported value "+t[v])}c.push(g),u+=g.length,p.push(b),d+=b.length,++l}for(s[2][0].data=Nt(l);v<s[7][0].data.length/2;++v)h.setUint16(v*2,65535,!0),f.setUint16(v*2,65535,!0);return s[6][0].data=In(c),s[3][0].data=In(p),l}function wP(s,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=s.Sheets[s.SheetNames[0]];s.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=yr(e["!ref"]);i.s.r=i.s.c=0;var r=!1;i.e.c>9&&(r=!0,i.e.c=9),i.e.r>49&&(r=!0,i.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(ct(i)));var n=fc(e,{range:i,header:1}),a=["~Sh33tJ5~"];n.forEach(function(H){return H.forEach(function(L){typeof L=="string"&&a.push(L)})});var o={},l=[],h=rt.read(t.numbers,{type:"base64"});h.FileIndex.map(function(H,L){return[H,h.FullPaths[L]]}).forEach(function(H){var L=H[0],_=H[1];if(L.type==2&&L.name.match(/\.iwa/)){var U=L.content,se=ts(U),ae=es(se);ae.forEach(function(oe){l.push(oe.id),o[oe.id]={deps:[],location:_,type:pi(oe.messages[0].meta[1][0].data)}})}}),l.sort(function(H,L){return H-L});var u=l.filter(function(H){return H>1}).map(function(H){return[H,Nt(H)]});h.FileIndex.map(function(H,L){return[H,h.FullPaths[L]]}).forEach(function(H){var L=H[0];if(H[1],!!L.name.match(/\.iwa/)){var _=es(ts(L.content));_.forEach(function(U){U.messages.forEach(function(se){u.forEach(function(ae){U.messages.some(function(oe){return pi(oe.meta[1][0].data)!=11006&&lP(oe.data,ae[1])})&&o[ae[0]].deps.push(U.id)})})})}});for(var c=rt.find(h,o[1].location),f=es(ts(c.content)),d,p=0;p<f.length;++p){var v=f[p];v.id==1&&(d=v)}var g=Yi(Rt(d.messages[0].data)[1][0].data);for(c=rt.find(h,o[g].location),f=es(ts(c.content)),p=0;p<f.length;++p)v=f[p],v.id==g&&(d=v);for(g=Yi(Rt(d.messages[0].data)[2][0].data),c=rt.find(h,o[g].location),f=es(ts(c.content)),p=0;p<f.length;++p)v=f[p],v.id==g&&(d=v);for(g=Yi(Rt(d.messages[0].data)[2][0].data),c=rt.find(h,o[g].location),f=es(ts(c.content)),p=0;p<f.length;++p)v=f[p],v.id==g&&(d=v);var b=Rt(d.messages[0].data);{b[6][0].data=Nt(i.e.r+1),b[7][0].data=Nt(i.e.c+1);var C=Yi(b[46][0].data),y=rt.find(h,o[C].location),x=es(ts(y.content));{for(var w=0;w<x.length&&x[w].id!=C;++w);if(x[w].id!=C)throw"Bad ColumnRowUIDMapArchive";var S=Rt(x[w].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var E=0;E<=i.e.c;++E){var k=[];k[1]=k[2]=[{type:0,data:Nt(E+420690)}],S[1].push({type:2,data:Ui(k)}),S[2].push({type:0,data:Nt(E)}),S[3].push({type:0,data:Nt(E)})}S[4]=[],S[5]=[],S[6]=[];for(var A=0;A<=i.e.r;++A)k=[],k[1]=k[2]=[{type:0,data:Nt(A+726270)}],S[4].push({type:2,data:Ui(k)}),S[5].push({type:0,data:Nt(A)}),S[6].push({type:0,data:Nt(A)});x[w].messages[0].data=Ui(S)}y.content=ja(za(x)),y.size=y.content.length,delete b[46];var z=Rt(b[4][0].data);{z[7][0].data=Nt(i.e.r+1);var D=Rt(z[1][0].data),T=Yi(D[2][0].data);y=rt.find(h,o[T].location),x=es(ts(y.content));{if(x[0].id!=T)throw"Bad HeaderStorageBucket";var M=Rt(x[0].messages[0].data);for(A=0;A<n.length;++A){var K=Rt(M[2][0].data);K[1][0].data=Nt(A),K[4][0].data=Nt(n[A].length),M[2][A]={type:M[2][0].type,data:Ui(K)}}x[0].messages[0].data=Ui(M)}y.content=ja(za(x)),y.size=y.content.length;var te=Yi(z[2][0].data);y=rt.find(h,o[te].location),x=es(ts(y.content));{if(x[0].id!=te)throw"Bad HeaderStorageBucket";for(M=Rt(x[0].messages[0].data),E=0;E<=i.e.c;++E)K=Rt(M[2][0].data),K[1][0].data=Nt(E),K[4][0].data=Nt(i.e.r+1),M[2][E]={type:M[2][0].type,data:Ui(K)};x[0].messages[0].data=Ui(M)}y.content=ja(za(x)),y.size=y.content.length;var ee=Yi(z[4][0].data);(function(){for(var H=rt.find(h,o[ee].location),L=es(ts(H.content)),_,U=0;U<L.length;++U){var se=L[U];se.id==ee&&(_=se)}var ae=Rt(_.messages[0].data);{ae[3]=[];var oe=[];a.forEach(function(V,$e){oe[1]=[{type:0,data:Nt($e)}],oe[2]=[{type:0,data:Nt(1)}],oe[3]=[{type:2,data:oP(V)}],ae[3].push({type:2,data:Ui(oe)})})}_.messages[0].data=Ui(ae);var me=za(L),Re=ja(me);H.content=Re,H.size=H.content.length})();var J=Rt(z[3][0].data);{var re=J[1][0];delete J[2];var j=Rt(re.data);{var de=Yi(j[2][0].data);(function(){for(var H=rt.find(h,o[de].location),L=es(ts(H.content)),_,U=0;U<L.length;++U){var se=L[U];se.id==de&&(_=se)}var ae=Rt(_.messages[0].data);{delete ae[6],delete J[7];var oe=new Uint8Array(ae[5][0].data);ae[5]=[];for(var me=0,Re=0;Re<=i.e.r;++Re){var V=Rt(oe);me+=CP(V,n[Re],a),V[1][0].data=Nt(Re),ae[5].push({data:Ui(V),type:2})}ae[1]=[{type:0,data:Nt(i.e.c+1)}],ae[2]=[{type:0,data:Nt(i.e.r+1)}],ae[3]=[{type:0,data:Nt(me)}],ae[4]=[{type:0,data:Nt(i.e.r+1)}]}_.messages[0].data=Ui(ae);var $e=za(L),Me=ja($e);H.content=Me,H.size=H.content.length})()}re.data=Ui(j)}z[3][0].data=Ui(J)}b[4][0].data=Ui(z)}d.messages[0].data=Ui(b);var we=za(f),N=ja(we);return c.content=N,c.size=c.content.length,h}function iw(s){return function(e){for(var i=0;i!=s.length;++i){var r=s[i];e[r[0]]===void 0&&(e[r[0]]=r[1]),r[2]==="n"&&(e[r[0]]=Number(e[r[0]]))}}}function Zm(s){iw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(s)}function ev(s){iw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(s)}function EP(s){return bt.WS.indexOf(s)>-1?"sheet":s==bt.CS?"chart":s==bt.DS?"dialog":s==bt.MS?"macro":s&&s.length?s:"sheet"}function SP(s,t){if(!s)return 0;try{s=t.map(function(i){return i.id||(i.id=i.strRelID),[i.name,s["!id"][i.id].Target,EP(s["!id"][i.id].Type)]})}catch(e){return null}return!s||s.length===0?null:s}function kP(s,t,e,i,r,n,a,o,l,h,u,c){try{n[i]=Ml(Wr(s,e,!0),t);var f=Ti(s,t),d;switch(o){case"sheet":d=JN(f,t,r,l,n[i],h,u,c);break;case"chart":if(d=QN(f,t,r,l,n[i],h,u,c),!d||!d["!drawel"])break;var p=kl(d["!drawel"].Target,t),v=ih(p),g=HR(Wr(s,p,!0),Ml(Wr(s,v,!0),p)),b=kl(g,p),C=ih(b);d=TN(Wr(s,b,!0),b,l,Ml(Wr(s,C,!0),b),h,d);break;case"macro":d=ZN(f,t,r,l,n[i],h,u,c);break;case"dialog":d=eM(f,t,r,l,n[i],h,u,c);break;default:throw new Error("Unrecognized sheet type "+o)}a[i]=d;var y=[];n&&n[i]&&mi(n[i]).forEach(function(x){var w="";if(n[i][x].Type==bt.CMNT){w=kl(n[i][x].Target,t);var S=sM(Ti(s,w,!0),w,l);if(!S||!S.length)return;Eg(d,S,!1)}n[i][x].Type==bt.TCMNT&&(w=kl(n[i][x].Target,t),y=y.concat(WR(Ti(s,w,!0),l)))}),y&&y.length&&Eg(d,y,!0,l.people||[])}catch(x){if(l.WTF)throw x}}function Xr(s){return s.charAt(0)=="/"?s.slice(1):s}function rw(s,t){if(Fo(),t=t||{},Zm(t),rs(s,"META-INF/manifest.xml")||rs(s,"objectdata.xml"))return Fg(s,t);if(rs(s,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Mf<"u"){if(s.FileIndex)return Mf(s);var e=rt.utils.cfb_new();return U0(s).forEach(function(K){ft(e,K,zA(s,K))}),Mf(e)}throw new Error("Unsupported NUMBERS file")}if(!rs(s,"[Content_Types].xml"))throw rs(s,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):rs(s,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=U0(s),r=NO(Wr(s,"[Content_Types].xml")),n=!1,a,o;if(r.workbooks.length===0&&(o="xl/workbook.xml",Ti(s,o,!0)&&r.workbooks.push(o)),r.workbooks.length===0){if(o="xl/workbook.bin",!Ti(s,o,!0))throw new Error("Could not find workbook");r.workbooks.push(o),n=!0}r.workbooks[0].slice(-3)=="bin"&&(n=!0);var l={},h={};if(!t.bookSheets&&!t.bookProps){if(Pl=[],r.sst)try{Pl=rM(Ti(s,Xr(r.sst)),r.sst,t)}catch(K){if(t.WTF)throw K}t.cellStyles&&r.themes.length&&(l=iM(Wr(s,r.themes[0].replace(/^\//,""),!0)||"",r.themes[0],t)),r.style&&(h=tM(Ti(s,Xr(r.style)),r.style,l,t))}r.links.map(function(K){try{var te=Ml(Wr(s,ih(Xr(K))),K);return aM(Ti(s,Xr(K)),te,K,t)}catch(ee){}});var u=YN(Ti(s,Xr(r.workbooks[0])),r.workbooks[0],t),c={},f="";r.coreprops.length&&(f=Ti(s,Xr(r.coreprops[0]),!0),f&&(c=Vx(f)),r.extprops.length!==0&&(f=Ti(s,Xr(r.extprops[0]),!0),f&&zO(f,c,t)));var d={};(!t.bookSheets||t.bookProps)&&r.custprops.length!==0&&(f=Wr(s,Xr(r.custprops[0]),!0),f&&(d=UO(f,t)));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?a=u.Sheets.map(function(te){return te.name}):c.Worksheets&&c.SheetNames.length>0&&(a=c.SheetNames),t.bookProps&&(p.Props=c,p.Custprops=d),t.bookSheets&&typeof a<"u"&&(p.SheetNames=a),t.bookSheets?p.SheetNames:t.bookProps))return p;a={};var v={};t.bookDeps&&r.calcchain&&(v=nM(Ti(s,Xr(r.calcchain)),r.calcchain));var g=0,b={},C,y;{var x=u.Sheets;c.Worksheets=x.length,c.SheetNames=[];for(var w=0;w!=x.length;++w)c.SheetNames[w]=x[w].name}var S=n?"bin":"xml",E=r.workbooks[0].lastIndexOf("/"),k=(r.workbooks[0].slice(0,E+1)+"_rels/"+r.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");rs(s,k)||(k="xl/_rels/workbook."+S+".rels");var A=Ml(Wr(s,k,!0),k.replace(/_rels.*/,"s5s"));(r.metadata||[]).length>=1&&(t.xlmeta=oM(Ti(s,Xr(r.metadata[0])),r.metadata[0],t)),(r.people||[]).length>=1&&(t.people=jR(Ti(s,Xr(r.people[0])),t)),A&&(A=SP(A,u.Sheets));var z=Ti(s,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=c.Worksheets;++g){var D="sheet";if(A&&A[g]?(C="xl/"+A[g][1].replace(/[\/]?xl\//,""),rs(s,C)||(C=A[g][1]),rs(s,C)||(C=k.replace(/_rels\/.*$/,"")+A[g][1]),D=A[g][2]):(C="xl/worksheets/sheet"+(g+1-z)+"."+S,C=C.replace(/sheet0\./,"sheet.")),y=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(c.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,M=0;M!=t.sheets.length;++M)typeof t.sheets[M]=="number"&&t.sheets[M]==g&&(T=1),typeof t.sheets[M]=="string"&&t.sheets[M].toLowerCase()==c.SheetNames[g].toLowerCase()&&(T=1);if(!T)continue e}}kP(s,C,y,c.SheetNames[g],g,b,a,D,t,u,l,h)}return p={Directory:r,Workbook:u,Props:c,Custprops:d,Deps:v,Sheets:a,SheetNames:c.SheetNames,Strings:Pl,Styles:h,Themes:l,SSF:Ut(nt)},t&&t.bookFiles&&(s.files?(p.keys=i,p.files=s.files):(p.keys=[],p.files={},s.FullPaths.forEach(function(K,te){K=K.replace(/^Root Entry[\/]/,""),p.keys.push(K),p.files[K]=s.FileIndex[te]}))),t&&t.bookVBA&&(r.vba.length>0?p.vbaraw=Ti(s,Xr(r.vba[0]),!0):r.defaults&&r.defaults.bin===JR&&(p.vbaraw=Ti(s,"xl/vbaProject.bin",!0))),p}function TP(s,t){var e=t||{},i="Workbook",r=rt.find(s,i);try{if(i="/!DataSpaces/Version",r=rt.find(s,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(lL(r.content),i="/!DataSpaces/DataSpaceMap",r=rt.find(s,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);var n=uL(r.content);if(n.length!==1||n[0].comps.length!==1||n[0].comps[0].t!==0||n[0].name!=="StrongEncryptionDataSpace"||n[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",r=rt.find(s,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);var a=cL(r.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",r=rt.find(s,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);dL(r.content)}catch(l){}if(i="/EncryptionInfo",r=rt.find(s,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);var o=pL(r.content);if(i="/EncryptedPackage",r=rt.find(s,i),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],r.content,e.password||"",e);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],r.content,e.password||"",e);throw new Error("File is password-protected")}function AP(s,t){return t.bookType=="ods"?tw(s,t):t.bookType=="numbers"?wP(s,t):t.bookType=="xlsb"?OP(s,t):sw(s,t)}function OP(s,t){oo=1024,s&&!s.SSF&&(s.SSF=Ut(nt)),s&&s.SSF&&(Fo(),vh(s.SSF),t.revssf=Bc(s.SSF),t.revssf[s.SSF[65535]]=0,t.ssf=s.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Bl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e=t.bookType=="xlsb"?"bin":"xml",i=kC.indexOf(t.bookType)>-1,r=Bm();ev(t=t||{});var n=xm(),a="",o=0;if(t.cellXfs=[],Pn(t.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={}),a="docProps/core.xml",ft(n,a,Wx(s.Props,t)),r.coreprops.push(a),Mt(t.rels,2,a,bt.CORE_PROPS),a="docProps/app.xml",!(s.Props&&s.Props.SheetNames))if(!s.Workbook||!s.Workbook.Sheets)s.Props.SheetNames=s.SheetNames;else{for(var l=[],h=0;h<s.SheetNames.length;++h)(s.Workbook.Sheets[h]||{}).Hidden!=2&&l.push(s.SheetNames[h]);s.Props.SheetNames=l}for(s.Props.Worksheets=s.Props.SheetNames.length,ft(n,a,Ux(s.Props)),r.extprops.push(a),Mt(t.rels,3,a,bt.EXT_PROPS),s.Custprops!==s.Props&&mi(s.Custprops||{}).length>0&&(a="docProps/custom.xml",ft(n,a,$x(s.Custprops)),r.custprops.push(a),Mt(t.rels,4,a,bt.CUST_PROPS)),o=1;o<=s.SheetNames.length;++o){var u={"!id":{}},c=s.Sheets[s.SheetNames[o-1]],f=(c||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+e,ft(n,a,hM(o-1,a,t,s,u)),r.sheets.push(a),Mt(t.wbrels,-1,"worksheets/sheet"+o+"."+e,bt.WS[0])}if(c){var d=c["!comments"],p=!1,v="";d&&d.length>0&&(v="xl/comments"+o+"."+e,ft(n,v,fM(d,v)),r.comments.push(v),Mt(u,-1,"../comments"+o+"."+e,bt.CMNT),p=!0),c["!legacy"]&&p&&ft(n,"xl/drawings/vmlDrawing"+o+".vml",EC(o,c["!comments"])),delete c["!comments"],delete c["!legacy"]}u["!id"].rId1&&ft(n,ih(a),go(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,ft(n,a,cM(t.Strings,a,t)),r.strs.push(a),Mt(t.wbrels,-1,"sharedStrings."+e,bt.SST)),a="xl/workbook."+e,ft(n,a,lM(s,a)),r.workbooks.push(a),Mt(t.rels,1,a,bt.WB),a="xl/theme/theme1.xml",ft(n,a,Um(s.Themes,t)),r.themes.push(a),Mt(t.wbrels,-1,"theme/theme1.xml",bt.THEME),a="xl/styles."+e,ft(n,a,uM(s,a,t)),r.styles.push(a),Mt(t.wbrels,-1,"styles."+e,bt.STY),s.vbaraw&&i&&(a="xl/vbaProject.bin",ft(n,a,s.vbaraw),r.vba.push(a),Mt(t.wbrels,-1,"vbaProject.bin",bt.VBA)),a="xl/metadata."+e,ft(n,a,dM(a)),r.metadata.push(a),Mt(t.wbrels,-1,"metadata."+e,bt.XLMETA),ft(n,"[Content_Types].xml",Bx(r,t)),ft(n,"_rels/.rels",go(t.rels)),ft(n,"xl/_rels/workbook."+e+".rels",go(t.wbrels)),delete t.revssf,delete t.ssf,n}function sw(s,t){oo=1024,s&&!s.SSF&&(s.SSF=Ut(nt)),s&&s.SSF&&(Fo(),vh(s.SSF),t.revssf=Bc(s.SSF),t.revssf[s.SSF[65535]]=0,t.ssf=s.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Bl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",i=kC.indexOf(t.bookType)>-1,r=Bm();ev(t=t||{});var n=xm(),a="",o=0;if(t.cellXfs=[],Pn(t.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={}),a="docProps/core.xml",ft(n,a,Wx(s.Props,t)),r.coreprops.push(a),Mt(t.rels,2,a,bt.CORE_PROPS),a="docProps/app.xml",!(s.Props&&s.Props.SheetNames))if(!s.Workbook||!s.Workbook.Sheets)s.Props.SheetNames=s.SheetNames;else{for(var l=[],h=0;h<s.SheetNames.length;++h)(s.Workbook.Sheets[h]||{}).Hidden!=2&&l.push(s.SheetNames[h]);s.Props.SheetNames=l}s.Props.Worksheets=s.Props.SheetNames.length,ft(n,a,Ux(s.Props)),r.extprops.push(a),Mt(t.rels,3,a,bt.EXT_PROPS),s.Custprops!==s.Props&&mi(s.Custprops||{}).length>0&&(a="docProps/custom.xml",ft(n,a,$x(s.Custprops)),r.custprops.push(a),Mt(t.rels,4,a,bt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=s.SheetNames.length;++o){var c={"!id":{}},f=s.Sheets[s.SheetNames[o-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+e,ft(n,a,MC(o-1,t,s,c)),r.sheets.push(a),Mt(t.wbrels,-1,"worksheets/sheet"+o+"."+e,bt.WS[0])}if(f){var p=f["!comments"],v=!1,g="";if(p&&p.length>0){var b=!1;p.forEach(function(C){C[1].forEach(function(y){y.T==!0&&(b=!0)})}),b&&(g="xl/threadedComments/threadedComment"+o+"."+e,ft(n,g,zR(p,u,t)),r.threadedcomments.push(g),Mt(c,-1,"../threadedComments/threadedComment"+o+"."+e,bt.TCMNT)),g="xl/comments"+o+"."+e,ft(n,g,SC(p)),r.comments.push(g),Mt(c,-1,"../comments"+o+"."+e,bt.CMNT),v=!0}f["!legacy"]&&v&&ft(n,"xl/drawings/vmlDrawing"+o+".vml",EC(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}c["!id"].rId1&&ft(n,ih(a),go(c))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,ft(n,a,cC(t.Strings,t)),r.strs.push(a),Mt(t.wbrels,-1,"sharedStrings."+e,bt.SST)),a="xl/workbook."+e,ft(n,a,zC(s)),r.workbooks.push(a),Mt(t.rels,1,a,bt.WB),a="xl/theme/theme1.xml",ft(n,a,Um(s.Themes,t)),r.themes.push(a),Mt(t.wbrels,-1,"theme/theme1.xml",bt.THEME),a="xl/styles."+e,ft(n,a,yC(s,t)),r.styles.push(a),Mt(t.wbrels,-1,"styles."+e,bt.STY),s.vbaraw&&i&&(a="xl/vbaProject.bin",ft(n,a,s.vbaraw),r.vba.push(a),Mt(t.wbrels,-1,"vbaProject.bin",bt.VBA)),a="xl/metadata."+e,ft(n,a,wC()),r.metadata.push(a),Mt(t.wbrels,-1,"metadata."+e,bt.XLMETA),u.length>1&&(a="xl/persons/person.xml",ft(n,a,UR(u)),r.people.push(a),Mt(t.wbrels,-1,"persons/person.xml",bt.PEOPLE)),ft(n,"[Content_Types].xml",Bx(r,t)),ft(n,"_rels/.rels",go(t.rels)),ft(n,"xl/_rels/workbook."+e+".rels",go(t.wbrels)),delete t.revssf,delete t.ssf,n}function tv(s,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]];case"base64":e=qr(s.slice(0,12));break;case"binary":e=s;break;case"array":return[s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function DP(s,t){return rt.find(s,"EncryptedPackage")?TP(s,t):Jm(s,t)}function LP(s,t){var e,i=s,r=t||{};return r.type||(r.type=vt&&Buffer.isBuffer(s)?"buffer":"base64"),e=gx(i,r),rw(e,r)}function nw(s,t){var e=0;e:for(;e<s.length;)switch(s.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return np(s.slice(e),t);default:break e}return Ao.to_workbook(s,t)}function RP(s,t){var e="",i=tv(s,t);switch(t.type){case"base64":e=qr(s);break;case"binary":e=s;break;case"buffer":e=s.toString("binary");break;case"array":e=ya(s);break;default:throw new Error("Unrecognized type "+t.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(e=Ht(e)),t.type="binary",nw(e,t)}function IP(s,t){var e=s;return t.type=="base64"&&(e=qr(e)),e=kt.utils.decode(1200,e.slice(2),"str"),t.type="binary",nw(e,t)}function _P(s){return s.match(/[^\x00-\x7F]/)?Rs(s):s}function Pf(s,t,e,i){return i?(e.type="string",Ao.to_workbook(s,e)):Ao.to_workbook(t,e)}function cc(s,t){Mc();var e=t||{};if(typeof ArrayBuffer<"u"&&s instanceof ArrayBuffer)return cc(new Uint8Array(s),(e=Ut(e),e.type="array",e));typeof Uint8Array<"u"&&s instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var i=s,r=[0,0,0,0],n=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),yo={},e.dateNF&&(yo.dateNF=e.dateNF),e.type||(e.type=vt&&Buffer.isBuffer(s)?"buffer":"base64"),e.type=="file"&&(e.type=vt?"buffer":"binary",i=FA(s),typeof Uint8Array<"u"&&!vt&&(e.type="array")),e.type=="string"&&(n=!0,e.type="binary",e.codepage=65001,i=_P(s)),e.type=="array"&&typeof Uint8Array<"u"&&s instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return e=Ut(e),e.type="array",cc(vm(i),e)}switch((r=tv(i,e))[0]){case 208:if(r[1]===207&&r[2]===17&&r[3]===224&&r[4]===161&&r[5]===177&&r[6]===26&&r[7]===225)return DP(rt.read(i,e),e);break;case 9:if(r[1]<=8)return Jm(i,e);break;case 60:return np(i,e);case 73:if(r[1]===73&&r[2]===42&&r[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(r[1]===68)return $2(i,e);break;case 84:if(r[1]===65&&r[2]===66&&r[3]===76)return hC.to_workbook(i,e);break;case 80:return r[1]===75&&r[2]<9&&r[3]<9?LP(i,e):Pf(s,i,e,n);case 239:return r[3]===60?np(i,e):Pf(s,i,e,n);case 255:if(r[1]===254)return IP(i,e);if(r[1]===0&&r[2]===2&&r[3]===0)return ca.to_workbook(i,e);break;case 0:if(r[1]===0&&(r[2]>=2&&r[3]===0||r[2]===0&&(r[3]===8||r[3]===9)))return ca.to_workbook(i,e);break;case 3:case 131:case 139:case 140:return sp.to_workbook(i,e);case 123:if(r[1]===92&&r[2]===114&&r[3]===116)return vC.to_workbook(i,e);break;case 10:case 13:case 32:return RP(i,e);case 137:if(r[1]===80&&r[2]===78&&r[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return U2.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?sp.to_workbook(i,e):Pf(s,i,e,n)}function Hg(s,t){var e=t||{};return e.type="file",cc(s,e)}function aw(s,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return gh(t.file,rt.write(s,{type:vt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return rt.write(s,t)}function FP(s,t){var e=Ut(t||{}),i=AP(s,e);return ow(i,e)}function NP(s,t){var e=Ut(t||{}),i=sw(s,e);return ow(i,e)}function ow(s,t){var e={},i=vt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=i;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=i;break;default:throw new Error("Unrecognized type "+t.type)}var r=s.FullPaths?rt.write(s,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):s.generate(e);if(typeof Deno<"u"&&typeof r=="string"){if(t.type=="binary"||t.type=="base64")return r;r=new Uint8Array(mh(r))}return t.password&&typeof encrypt_agile<"u"?aw(encrypt_agile(r,t.password),t):t.type==="file"?gh(t.file,r):t.type=="string"?Ht(r):r}function MP(s,t){var e=t||{},i=HM(s,e);return aw(i,e)}function Ls(s,t,e){e||(e="");var i=e+s;switch(t.type){case"base64":return Jl(Rs(i));case"binary":return Rs(i);case"string":return s;case"file":return gh(t.file,i,"utf8");case"buffer":return vt?nn(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Ls(i,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function PP(s,t){switch(t.type){case"base64":return Jl(s);case"binary":return s;case"string":return s;case"file":return gh(t.file,s,"binary");case"buffer":return vt?nn(s,"binary"):s.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function uu(s,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",i=0;i<s.length;++i)e+=String.fromCharCode(s[i]);return t.type=="base64"?Jl(e):t.type=="string"?Ht(e):e;case"file":return gh(t.file,s);case"buffer":return s;default:throw new Error("Unrecognized type "+t.type)}}function iv(s,t){Mc(),WC(s);var e=Ut(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var i=iv(s,e);return e.type="array",mh(i)}return NP(s,e)}function $c(s,t){Mc(),WC(s);var e=Ut(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var i=$c(s,e);return e.type="array",mh(i)}var r=0;if(e.sheet&&(typeof e.sheet=="number"?r=e.sheet:r=s.SheetNames.indexOf(e.sheet),!s.SheetNames[r]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Ls(IM(s,e),e);case"slk":case"sylk":return Ls(lC.from_sheet(s.Sheets[s.SheetNames[r]],e),e);case"htm":case"html":return Ls(JC(s.Sheets[s.SheetNames[r]],e),e);case"txt":return PP(uw(s.Sheets[s.SheetNames[r]],e),e);case"csv":return Ls(sv(s.Sheets[s.SheetNames[r]],e),e,"\uFEFF");case"dif":return Ls(hC.from_sheet(s.Sheets[s.SheetNames[r]],e),e);case"dbf":return uu(sp.from_sheet(s.Sheets[s.SheetNames[r]],e),e);case"prn":return Ls(Ao.from_sheet(s.Sheets[s.SheetNames[r]],e),e);case"rtf":return Ls(vC.from_sheet(s.Sheets[s.SheetNames[r]],e),e);case"eth":return Ls(uC.from_sheet(s.Sheets[s.SheetNames[r]],e),e);case"fods":return Ls(tw(s,e),e);case"wk1":return uu(ca.sheet_to_wk1(s.Sheets[s.SheetNames[r]],e),e);case"wk3":return uu(ca.book_to_wk3(s,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),uu(qC(s,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),MP(s,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return FP(s,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function rv(s){if(!s.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=s.file.slice(s.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(s.bookType=e.slice(1)),s.bookType=t[s.bookType]||s.bookType}}function Vg(s,t,e){var i=e||{};return i.type="file",i.file=t,rv(i),$c(s,i)}function BP(s,t,e){var i=e||{};return i.type="file",i.file=t,rv(i),iv(s,i)}function HP(s,t,e,i){var r=e||{};r.type="file",r.file=s,rv(r),r.type="buffer";var n=i;return n instanceof Function||(n=e),Tn.writeFile(s,$c(t,r),n)}function lw(s,t,e,i,r,n,a,o){var l=di(e),h=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),c=!0,f=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:e,enumerable:!1})}catch(g){f.__rowNum__=e}else f.__rowNum__=e;if(!a||s[e])for(var d=t.s.c;d<=t.e.c;++d){var p=a?s[e][d]:s[i[d]+l];if(p===void 0||p.t===void 0){if(h===void 0)continue;n[d]!=null&&(f[n[d]]=h);continue}var v=p.v;switch(p.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(n[d]!=null){if(v==null)if(p.t=="e"&&v===null)f[n[d]]=null;else if(h!==void 0)f[n[d]]=h;else if(u&&v===null)f[n[d]]=null;else continue;else f[n[d]]=u&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?v:Ms(p,v,o);v!=null&&(c=!1)}}return{row:f,isempty:c}}function fc(s,t){if(s==null||s["!ref"]==null)return[];var e={t:"n",v:0},i=0,r=1,n=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},u=h.range!=null?h.range:s["!ref"];switch(h.header===1?i=1:h.header==="A"?i=2:Array.isArray(h.header)?i=3:h.header==null&&(i=0),typeof u){case"string":l=Et(u);break;case"number":l=Et(s["!ref"]),l.s.r=u;break;default:l=u}i>0&&(r=0);var c=di(l.s.r),f=[],d=[],p=0,v=0,g=Array.isArray(s),b=l.s.r,C=0,y={};g&&!s[b]&&(s[b]=[]);var x=h.skipHidden&&s["!cols"]||[],w=h.skipHidden&&s["!rows"]||[];for(C=l.s.c;C<=l.e.c;++C)if(!(x[C]||{}).hidden)switch(f[C]=ei(C),e=g?s[b][C]:s[f[C]+c],i){case 1:n[C]=C-l.s.c;break;case 2:n[C]=f[C];break;case 3:n[C]=h.header[C-l.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),o=a=Ms(e,null,h),v=y[a]||0,!v)y[a]=1;else{do o=a+"_"+v++;while(y[o]);y[a]=v,y[o]=1}n[C]=o}for(b=l.s.r+r;b<=l.e.r;++b)if(!(w[b]||{}).hidden){var S=lw(s,l,b,f,i,n,g,h);(S.isempty===!1||(i===1?h.blankrows!==!1:h.blankrows))&&(d[p++]=S.row)}return d.length=p,d}var Wg=/"/g;function hw(s,t,e,i,r,n,a,o){for(var l=!0,h=[],u="",c=di(e),f=t.s.c;f<=t.e.c;++f)if(i[f]){var d=o.dense?(s[e]||[])[f]:s[i[f]+c];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:Ms(d,null,o));for(var p=0,v=0;p!==u.length;++p)if((v=u.charCodeAt(p))===r||v===n||v===34||o.forceQuotes){u='"'+u.replace(Wg,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(Wg,'""')+'"')):u="";h.push(u)}return o.blankrows===!1&&l?null:h.join(a)}function sv(s,t){var e=[],i=t==null?{}:t;if(s==null||s["!ref"]==null)return"";var r=Et(s["!ref"]),n=i.FS!==void 0?i.FS:",",a=n.charCodeAt(0),o=i.RS!==void 0?i.RS:"\n",l=o.charCodeAt(0),h=new RegExp((n=="|"?"\\|":n)+"+$"),u="",c=[];i.dense=Array.isArray(s);for(var f=i.skipHidden&&s["!cols"]||[],d=i.skipHidden&&s["!rows"]||[],p=r.s.c;p<=r.e.c;++p)(f[p]||{}).hidden||(c[p]=ei(p));for(var v=0,g=r.s.r;g<=r.e.r;++g)(d[g]||{}).hidden||(u=hw(s,r,g,c,a,l,n,i),u!=null&&(i.strip&&(u=u.replace(h,"")),(u||i.blankrows!==!1)&&e.push((v++?o:"")+u)));return delete i.dense,e.join("")}function uw(s,t){t||(t={}),t.FS="	",t.RS="\n";var e=sv(s,t);if(typeof kt>"u"||t.type=="string")return e;var i=kt.utils.encode(1200,e,"str");return""+i}function VP(s){var t="",e,i="";if(s==null||s["!ref"]==null)return[];var r=Et(s["!ref"]),n="",a=[],o,l=[],h=Array.isArray(s);for(o=r.s.c;o<=r.e.c;++o)a[o]=ei(o);for(var u=r.s.r;u<=r.e.r;++u)for(n=di(u),o=r.s.c;o<=r.e.c;++o)if(t=a[o]+n,e=h?(s[u]||[])[o]:s[t],i="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;i=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)i=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)i=""+e.v;else if(e.t=="b")i=e.v?"TRUE":"FALSE";else if(e.w!==void 0)i="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?i="'"+e.v:i=""+e.v}}l[l.length]=t+"="+i}return l}function cw(s,t,e){var i=e||{},r=+!i.skipHeader,n=s||{},a=0,o=0;if(n&&i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var l=typeof i.origin=="string"?oi(i.origin):i.origin;a=l.r,o=l.c}var h,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+r}};if(n["!ref"]){var c=Et(n["!ref"]);u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),a==-1&&(a=c.e.r+1,u.e.r=a+t.length-1+r)}else a==-1&&(a=0,u.e.r=t.length-1+r);var f=i.header||[],d=0;t.forEach(function(v,g){mi(v).forEach(function(b){(d=f.indexOf(b))==-1&&(f[d=f.length]=b);var C=v[b],y="z",x="",w=ot({c:o+d,r:a+g+r});h=hh(n,w),C&&typeof C=="object"&&!(C instanceof Date)?n[w]=C:(typeof C=="number"?y="n":typeof C=="boolean"?y="b":typeof C=="string"?y="s":C instanceof Date?(y="d",i.cellDates||(y="n",C=Fi(C)),x=i.dateNF||nt[14]):C===null&&i.nullError&&(y="e",C=0),h?(h.t=y,h.v=C,delete h.w,delete h.R,x&&(h.z=x)):n[w]=h={t:y,v:C},x&&(h.z=x))})}),u.e.c=Math.max(u.e.c,o+f.length-1);var p=di(a);if(r)for(d=0;d<f.length;++d)n[ei(d+o)+p]={t:"s",v:f[d]};return n["!ref"]=ct(u),n}function WP(s,t){return cw(null,s,t)}function hh(s,t,e){if(typeof t=="string"){if(Array.isArray(s)){var i=oi(t);return s[i.r]||(s[i.r]=[]),s[i.r][i.c]||(s[i.r][i.c]={t:"z"})}return s[t]||(s[t]={t:"z"})}return typeof t!="number"?hh(s,ot(t)):hh(s,ot({r:t,c:e||0}))}function zP(s,t){if(typeof t=="number"){if(t>=0&&s.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=s.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function nv(){return{SheetNames:[],Sheets:{}}}function av(s,t,e,i){var r=1;if(!e)for(;r<=65535&&s.SheetNames.indexOf(e="Sheet"+r)!=-1;++r,e=void 0);if(!e||s.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&s.SheetNames.indexOf(e)>=0){var n=e.match(/(^.*?)(\d+)$/);r=n&&+n[2]||0;var a=n&&n[1]||e;for(++r;r<=65535&&s.SheetNames.indexOf(e=a+r)!=-1;++r);}if(VC(e),s.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return s.SheetNames.push(e),s.Sheets[e]=t,e}function jP(s,t,e){s.Workbook||(s.Workbook={}),s.Workbook.Sheets||(s.Workbook.Sheets=[]);var i=zP(s,t);switch(s.Workbook.Sheets[i]||(s.Workbook.Sheets[i]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}s.Workbook.Sheets[i].Hidden=e}function UP(s,t){return s.z=t,s}function fw(s,t,e){return t?(s.l={Target:t},e&&(s.l.Tooltip=e)):delete s.l,s}function $P(s,t,e){return fw(s,"#"+t,e)}function qP(s,t,e){s.c||(s.c=[]),s.c.push({t,a:e||"SheetJS"})}function GP(s,t,e,i){for(var r=typeof t!="string"?t:Et(t),n=typeof t=="string"?t:ct(t),a=r.s.r;a<=r.e.r;++a)for(var o=r.s.c;o<=r.e.c;++o){var l=hh(s,a,o);l.t="n",l.F=n,delete l.v,a==r.s.r&&o==r.s.c&&(l.f=e,i&&(l.D=!0))}return s}var XP={encode_col:ei,encode_row:di,encode_cell:ot,encode_range:ct,decode_col:Im,decode_row:Rm,split_cell:fO,decode_cell:oi,decode_range:yr,format_cell:Ms,sheet_add_aoa:Rx,sheet_add_json:cw,sheet_add_dom:QC,aoa_to_sheet:Mo,json_to_sheet:WP,table_to_sheet:ZC,table_to_book:rP,sheet_to_csv:sv,sheet_to_txt:uw,sheet_to_json:fc,sheet_to_html:JC,sheet_to_formulae:VP,sheet_to_row_object_array:fc,sheet_get_cell:hh,book_new:nv,book_append_sheet:av,book_set_sheet_visibility:jP,cell_set_number_format:UP,cell_set_hyperlink:fw,cell_set_internal_link:$P,cell_add_comment:qP,sheet_set_array_formula:GP,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},qc;function KP(s){qc=s}function YP(s,t){var e=qc(),i=t==null?{}:t;if(s==null||s["!ref"]==null)return e.push(null),e;var r=Et(s["!ref"]),n=i.FS!==void 0?i.FS:",",a=n.charCodeAt(0),o=i.RS!==void 0?i.RS:"\n",l=o.charCodeAt(0),h=new RegExp((n=="|"?"\\|":n)+"+$"),u="",c=[];i.dense=Array.isArray(s);for(var f=i.skipHidden&&s["!cols"]||[],d=i.skipHidden&&s["!rows"]||[],p=r.s.c;p<=r.e.c;++p)(f[p]||{}).hidden||(c[p]=ei(p));var v=r.s.r,g=!1,b=0;return e._read=function(){if(!g)return g=!0,e.push("\uFEFF");for(;v<=r.e.r;)if(++v,!(d[v-1]||{}).hidden&&(u=hw(s,r,v-1,c,a,l,n,i),u!=null&&(i.strip&&(u=u.replace(h,"")),u||i.blankrows!==!1)))return e.push((b++?o:"")+u);return e.push(null)},e}function JP(s,t){var e=qc(),i=t||{},r=i.header!=null?i.header:XC,n=i.footer!=null?i.footer:KC;e.push(r);var a=yr(s["!ref"]);i.dense=Array.isArray(s),e.push(YC(s,a,i));var o=a.s.r,l=!1;return e._read=function(){if(o>a.e.r)return l||(l=!0,e.push("</table>"+n)),e.push(null);for(;o<=a.e.r;){e.push(GC(s,a,o,i)),++o;break}},e}function QP(s,t){var e=qc({objectMode:!0});if(s==null||s["!ref"]==null)return e.push(null),e;var i={t:"n",v:0},r=0,n=1,a=[],o=0,l="",h={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},c=u.range!=null?u.range:s["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)&&(r=3),typeof c){case"string":h=Et(c);break;case"number":h=Et(s["!ref"]),h.s.r=c;break;default:h=c}r>0&&(n=0);var f=di(h.s.r),d=[],p=0,v=Array.isArray(s),g=h.s.r,b=0,C={};v&&!s[g]&&(s[g]=[]);var y=u.skipHidden&&s["!cols"]||[],x=u.skipHidden&&s["!rows"]||[];for(b=h.s.c;b<=h.e.c;++b)if(!(y[b]||{}).hidden)switch(d[b]=ei(b),i=v?s[g][b]:s[d[b]+f],r){case 1:a[b]=b-h.s.c;break;case 2:a[b]=d[b];break;case 3:a[b]=u.header[b-h.s.c];break;default:if(i==null&&(i={w:"__EMPTY",t:"s"}),l=o=Ms(i,null,u),p=C[o]||0,!p)C[o]=1;else{do l=o+"_"+p++;while(C[l]);C[o]=p,C[l]=1}a[b]=l}return g=h.s.r+n,e._read=function(){for(;g<=h.e.r;)if(!(x[g-1]||{}).hidden){var w=lw(s,h,g,d,r,a,v,u);if(++g,w.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows)){e.push(w.row);return}}return e.push(null)},e}var ZP={to_json:QP,to_html:JP,to_csv:YP,set_readable:KP};const eB=Yl.version,tB=Object.freeze(Object.defineProperty({__proto__:null,CFB:rt,SSF:cx,parse_xlscfb:Jm,parse_zip:rw,read:cc,readFile:Hg,readFileSync:Hg,set_cptable:rA,set_fs:IA,stream:ZP,utils:XP,version:eB,write:$c,writeFile:Vg,writeFileAsync:HP,writeFileSync:Vg,writeFileXLSX:BP,writeXLSX:iv},Symbol.toStringTag,{value:"Module"})),VQ=ks(Ae.jsx("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"}),"FilterList");var We=function(){function s(t){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="",typeof t=="string"?this.fromTable=t:t&&t instanceof Array&&(this.lookups=t),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this.lazyLoad=[],this}return Object.defineProperty(s.prototype,"moduleName",{get:function(){return"query"},enumerable:!0,configurable:!0}),s.prototype.setKey=function(t){return this.key=t,this},s.prototype.using=function(t){return this.dataManager=t,this},s.prototype.execute=function(t,e,i,r){return t=t||this.dataManager,t?t.executeQuery(this,e,i,r):ue.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')},s.prototype.executeLocal=function(t){return t=t||this.dataManager,t?t.executeLocal(this):ue.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')},s.prototype.clone=function(){var t=new s;return t.queries=this.queries.slice(0),t.key=this.key,t.isChild=this.isChild,t.dataManager=this.dataManager,t.fromTable=this.fromTable,t.params=this.params.slice(0),t.expands=this.expands.slice(0),t.sortedColumns=this.sortedColumns.slice(0),t.groupedColumns=this.groupedColumns.slice(0),t.subQuerySelector=this.subQuerySelector,t.subQuery=this.subQuery,t.fKey=this.fKey,t.isCountRequired=this.isCountRequired,t.distincts=this.distincts.slice(0),t.lazyLoad=this.lazyLoad.slice(0),t},s.prototype.from=function(t){return this.fromTable=t,this},s.prototype.addParams=function(t,e){return typeof e=="function"?this.params.push({key:t,fn:e}):this.params.push({key:t,value:e}),this},s.prototype.distinct=function(t){return typeof t=="string"?this.distincts=[].slice.call([t],0):this.distincts=t.slice(0),this},s.prototype.expand=function(t){return typeof t=="string"?this.expands=[].slice.call([t],0):this.expands=t.slice(0),this},s.prototype.where=function(t,e,i,r,n,a){e=e?e.toLowerCase():null;var o=null;return typeof t=="string"?o=new ht(t,e,i,r,n,a):t instanceof ht&&(o=t),this.queries.push({fn:"onWhere",e:o}),this},s.prototype.search=function(t,e,i,r,n){typeof e=="string"&&(e=[e]),(!i||i==="none")&&(i="contains");var a=ue.fnOperators[i];return this.queries.push({fn:"onSearch",e:{fieldNames:e,operator:i,searchKey:t,ignoreCase:r,ignoreAccent:n,comparer:a}}),this},s.prototype.sortBy=function(t,e,i){return this.sortByForeignKey(t,e,i)},s.prototype.sortByForeignKey=function(t,e,i,r){var n=m(r)?"ascending":r,a,o;if(typeof t=="string"&&ue.endsWith(t.toLowerCase()," desc")&&(t=t.replace(/ desc$/i,""),e="descending"),(!e||typeof e=="string")&&(n=e?e.toLowerCase():"ascending",e=ue.fnSort(e)),i){a=s.filterQueries(this.queries,"onSortBy");for(var l=0;l<a.length;l++)if(o=a[l].e.fieldName,typeof o=="string"){if(o===t)return this}else if(o instanceof Array){for(var h=0;h<o.length;h++)if(o[h]===t||t.toLowerCase()===o[h]+" desc")return this}}return this.queries.push({fn:"onSortBy",e:{fieldName:t,comparer:e,direction:n}}),this},s.prototype.sortByDesc=function(t){return this.sortBy(t,"descending")},s.prototype.group=function(t,e,i){return this.sortBy(t,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:t,comparer:e||null,format:i||null}}),this},s.prototype.page=function(t,e){return this.queries.push({fn:"onPage",e:{pageIndex:t,pageSize:e}}),this},s.prototype.range=function(t,e){return this.queries.push({fn:"onRange",e:{start:t,end:e}}),this},s.prototype.take=function(t){return this.queries.push({fn:"onTake",e:{nos:t}}),this},s.prototype.skip=function(t){return this.queries.push({fn:"onSkip",e:{nos:t}}),this},s.prototype.select=function(t){return typeof t=="string"&&(t=[].slice.call([t],0)),this.queries.push({fn:"onSelect",e:{fieldNames:t}}),this},s.prototype.hierarchy=function(t,e){return this.subQuerySelector=e,this.subQuery=t,this},s.prototype.foreignKey=function(t){return this.fKey=t,this},s.prototype.requiresCount=function(){return this.isCountRequired=!0,this},s.prototype.aggregate=function(t,e){return this.queries.push({fn:"onAggregates",e:{field:e,type:t}}),this},s.filterQueries=function(t,e){return t.filter(function(i){return i.fn===e})},s.filterQueryLists=function(t,e){for(var i=t.filter(function(a){return e.indexOf(a.fn)!==-1}),r={},n=0;n<i.length;n++)r[i[n].fn]||(r[i[n].fn]=i[n].e);return r},s}(),ht=function(){function s(t,e,i,r,n,a){return r===void 0&&(r=!1),this.ignoreAccent=!1,this.isComplex=!1,typeof t=="string"?(this.field=t,this.operator=e.toLowerCase(),this.value=i,this.matchCase=a,this.ignoreCase=r,this.ignoreAccent=n,this.isComplex=!1,this.comparer=ue.fnOperators.processOperator(this.operator)):(t instanceof s&&i instanceof s||i instanceof Array)&&(this.isComplex=!0,this.condition=e.toLowerCase(),this.predicates=[t],this.matchCase=t.matchCase,this.ignoreCase=t.ignoreCase,this.ignoreAccent=t.ignoreAccent,i instanceof Array?[].push.apply(this.predicates,i):this.predicates.push(i)),this}return s.and=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.combinePredicates([].slice.call(t,0),"and")},s.prototype.and=function(t,e,i,r,n){return s.combine(this,t,e,i,"and",r,n)},s.or=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.combinePredicates([].slice.call(t,0),"or")},s.prototype.or=function(t,e,i,r,n){return s.combine(this,t,e,i,"or",r,n)},s.ornot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.combinePredicates([].slice.call(t,0),"or not")},s.prototype.ornot=function(t,e,i,r,n){return s.combine(this,t,e,i,"ornot",r,n)},s.andnot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.combinePredicates([].slice.call(t,0),"and not")},s.prototype.andnot=function(t,e,i,r,n){return s.combine(this,t,e,i,"andnot",r,n)},s.fromJson=function(t){if(t instanceof Array){for(var e=[],i=0,r=t.length;i<r;i++)e.push(this.fromJSONData(t[i]));return e}var n=t;return this.fromJSONData(n)},s.prototype.validate=function(t){var e=this.predicates?this.predicates:[],i,r;if(!this.isComplex&&this.comparer)return this.condition&&this.condition.indexOf("not")!==-1?(this.condition=this.condition.split("not")[0]===""?void 0:this.condition.split("not")[0],!this.comparer.call(this,ue.getObject(this.field,t),this.value,this.ignoreCase,this.ignoreAccent)):this.comparer.call(this,ue.getObject(this.field,t),this.value,this.ignoreCase,this.ignoreAccent);this.condition&&this.condition.indexOf("not")!==-1?r=this.condition.indexOf("and")!==-1:r=this.condition==="and";for(var n=0;n<e.length;n++)if(n>0&&this.condition&&this.condition.indexOf("not")!==-1&&(e[n].condition=e[n].condition?e[n].condition+"not":"not"),i=e[n].validate(t),r){if(!i)return!1}else if(i)return!0;return r},s.prototype.toJson=function(){var t,e;if(this.isComplex){t=[],e=this.predicates;for(var i=0;i<e.length;i++)t.push(e[i].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:t,matchCase:this.matchCase}},s.combinePredicates=function(t,e){if(t.length===1){if(!(t[0]instanceof Array))return t[0];t=t[0]}return new s(t[0],e,t.slice(1))},s.combine=function(t,e,i,r,n,a,o){return e instanceof s?s[n](t,e):typeof e=="string"?s[n](t,new s(e,i,r,a,o)):ue.throwError("Predicate - "+n+" : invalid arguments")},s.fromJSONData=function(t){for(var e=t.predicates||[],i=e.length,r=[],n,a=0;a<i;a++)r.push(this.fromJSONData(e[a]));return t.isComplex?n=new s(r[0],t.condition,r.slice(1)):n=new s(t.field,t.operator,t.value,t.ignoreCase,t.ignoreAccent),n},s}(),zg={GroupGuid:"{271bbba0-1ee7}"},ue=function(){function s(){}return s.getValue=function(t,e){return typeof t=="function"?t.call(e||{}):t},s.endsWith=function(t,e){return t.slice&&t.slice(-e.length)===e},s.notEndsWith=function(t,e){return t.slice&&t.slice(-e.length)!==e},s.startsWith=function(t,e){return t.slice(0,e.length)===e},s.notStartsWith=function(t,e){return t.slice(0,e.length)!==e},s.wildCard=function(t,e){var i,r;if(e.indexOf("[")!==-1&&(e=e.split("[").join("[[]")),e.indexOf("(")!==-1&&(e=e.split("(").join("[(]")),e.indexOf(")")!==-1&&(e=e.split(")").join("[)]")),e.indexOf("\\")!==-1&&(e=e.split("\\").join("[\\\\]")),e.indexOf("*")!==-1){e.charAt(0)!=="*"&&(e="^"+e),e.charAt(e.length-1)!=="*"&&(e=e+"$"),i=e.split("*");for(var n=0;n<i.length;n++)i[n].indexOf(".")===-1?i[n]=i[n]+".*":i[n]=i[n]+"*";e=i.join("")}(e.indexOf("%3f")!==-1||e.indexOf("?")!==-1)&&(r=e.indexOf("%3f")!==-1?e.split("%3f"):e.split("?"),e=r.join("."));var a=new RegExp(e,"g");return a.test(t)},s.like=function(t,e){return e.indexOf("%")!==-1?e.charAt(0)==="%"&&e.lastIndexOf("%")<2?(e=e.substring(1,e.length),s.startsWith(s.toLowerCase(t),s.toLowerCase(e))):e.charAt(e.length-1)==="%"&&e.indexOf("%")>e.length-3?(e=e.substring(0,e.length-1),s.endsWith(s.toLowerCase(t),s.toLowerCase(e))):(e.lastIndexOf("%")!==e.indexOf("%")&&e.lastIndexOf("%")>e.indexOf("%")+1&&(e=e.substring(e.indexOf("%")+1,e.lastIndexOf("%"))),t.indexOf(e)!==-1):!1},s.fnSort=function(t){return t=t?s.toLowerCase(t):"ascending",t==="ascending"?this.fnAscending:this.fnDescending},s.fnAscending=function(t,e){return m(t)&&m(e)?0:e==null?-1:typeof t=="string"?t.localeCompare(e):t==null?1:t-e},s.fnDescending=function(t,e){return m(t)&&m(e)?0:e==null?1:typeof t=="string"?t.localeCompare(e)*-1:t==null?-1:e-t},s.extractFields=function(t,e){for(var i={},r=0;r<e.length;r++)i=this.setValue(e[r],this.getObject(e[r],t),i);return i},s.select=function(t,e){for(var i=[],r=0;r<t.length;r++)i.push(this.extractFields(t[r],e));return i},s.group=function(t,e,i,r,n,a,o){r=r||1;var l=t,h="GroupGuid";if(l.GroupGuid===zg[h]){for(var u=function(y){if(m(n))l[y].items=c.group(l[y].items,e,i,l.level+1,null,a,o),l[y].count=l[y].items.length;else{var x=-1,w=n.filter(function(S){return S.key===l[y].key});x=n.indexOf(w[0]),l[y].items=c.group(l[y].items,e,i,l.level+1,n[x].items,a,o),l[y].count=n[x].count}},c=this,f=0;f<l.length;f++)u(f);return l.childLevels+=1,l}var d={},p=[];p.GroupGuid=zg[h],p.level=r,p.childLevels=0,p.records=l;for(var v=function(y){var x=g.getVal(l,y,e);if(m(a)||(x=a(x,e)),!d[x]&&(d[x]={key:x,count:0,items:[],aggregates:{},field:e},p.push(d[x]),!m(n))){var w=n.filter(function(S){return S.key===d[x].key});d[x].count=w[0].count}d[x].count=m(n)?d[x].count+=1:d[x].count,(!o||o&&i.length)&&d[x].items.push(l[y])},g=this,b=0;b<l.length;b++)v(b);if(i&&i.length)for(var C=function(y){for(var x={},w=void 0,S=i,E=0;E<i.length;E++)if(w=s.aggregates[i[E].type],m(n))w&&(x[S[E].field+" - "+S[E].type]=w(p[y].items,S[E].field));else{var k=n.filter(function(A){return A.key===p[y].key});w&&(x[S[E].field+" - "+S[E].type]=w(k[0].items,S[E].field))}p[y].aggregates=x},b=0;b<p.length;b++)C(b);if(o&&p.length&&i.length)for(var b=0;b<p.length;b++)p[b].items=[];return l.length&&p||l},s.buildHierarchy=function(t,e,i,r,n){var a,o={},l;for(r.result&&(r=r.result),r.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),a=0;a<r.length;a++){var h=this.getObject(t,r[a]);l=o[h]||(o[h]=[]),l.push(r[a])}for(a=0;a<i.length;a++){var h=this.getObject(n||t,i[a]);i[a][e]=o[h]}},s.getFieldList=function(t,e,i){if(i===void 0&&(i=""),e==null)return this.getFieldList(t,[],i);for(var r=t,n=Object.keys(t),a=0,o=n;a<o.length;a++){var l=o[a];typeof r[l]=="object"&&!(r[l]instanceof Array)?this.getFieldList(r[l],e,i+l+"."):e.push(i+l)}return e},s.getObject=function(t,e){if(!t)return e;if(e){if(t.indexOf(".")===-1)if(m(e[t])){var i=t.charAt(0).toLowerCase()+t.slice(1),r=t.charAt(0).toUpperCase()+t.slice(1);return m(e[i])?m(e[r])?null:e[r]:e[i]}else return e[t];for(var n=e,a=t.split("."),o=0;o<a.length&&n!=null;o++){if(n=n[a[o]],n===void 0){var l=a[o].charAt(0).toUpperCase()+a[o].slice(1);n=e[l]||e[l.charAt(0).toLowerCase()+l.slice(1)]||null}e=n}return n}},s.setValue=function(t,e,i){var r=t.toString().split("."),n=i||{},a=n,o,l=r.length,h;for(o=0;o<l;o++)h=r[o],o+1===l?a[h]=e===void 0?void 0:e:m(a[h])&&(a[h]={}),a=a[h];return n},s.sort=function(t,e,i){var r=this;return t.length<=1?t:t.slice().sort(function(n,a){return i(r.getVal([n],0,e),r.getVal([a],0,e),n,a)})},s.ignoreDiacritics=function(t){if(typeof t!="string")return t;var e=t.split(""),i=e.map(function(r){return r in s.diacritics?s.diacritics[r]:r});return i.join("")},s.ignoreDiacriticsForArrays=function(t){return Array.isArray(t)?t.map(function(e){return s.ignoreDiacritics(e)}):[]},s.merge=function(t,e,i,r){for(var n=[],a;t.length>0||e.length>0;)t.length>0&&e.length>0?r?a=r(this.getVal(t,0,i),this.getVal(e,0,i),t[0],e[0])<=0?t:e:a=t[0][i]<t[0][i]?t:e:a=t.length>0?t:e,n.push(a.shift());return n},s.getVal=function(t,e,i){return i?this.getObject(i,t[e]):t[e]},s.toLowerCase=function(t){return m(t)?"":typeof t=="string"?t.toLowerCase():t instanceof Date?t.toString().toLowerCase():t.toString()},s.callAdaptorFunction=function(t,e,i,r){if(e in t){var n=t[e](i,r);m(n)||(i=n)}return i},s.getAddParams=function(t,e,i){var r={};return s.callAdaptorFunction(t,"addParams",{dm:e,query:i,params:i?i.params:[],reqParams:r}),r},s.isPlainObject=function(t){return!!t&&t.constructor===Object},s.isCors=function(){var t=null,e="XMLHttpRequest";try{t=new window[e]}catch(i){}return!!t&&"withCredentials"in t},s.getGuid=function(t){var e="0123456789abcdef",i;return(t||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,function(r,n){if("crypto"in window&&"getRandomValues"in crypto){var a=new Uint8Array(1);window.crypto.getRandomValues(a),i=a[0]%16|0}else i=Math.random()*16|0;return e[n===19?i&3|8:i]})},s.isNull=function(t){return t==null},s.getItemFromComparer=function(t,e,i){var r,n,a,o=0,l=typeof s.getVal(t,0,e)=="string";if(t.length)for(;m(r)&&o<t.length;)r=s.getVal(t,o,e),a=t[o++];for(;o<t.length;o++)n=s.getVal(t,o,e),!m(n)&&(l&&(r=+r,n=+n),i(r,n)>0&&(r=n,a=t[o]));return a},s.distinct=function(t,e,i){i=m(i)?!1:i;var r=[],n,a={};return t.forEach(function(o,l){n=typeof t[l]=="object"?s.getVal(t,l,e):t[l],n in a||(r.push(i?t[l]:n),a[n]=1)}),r},s.processData=function(t,e){var i=this.prepareQuery(t),r=new fe(e);t.requiresCounts&&i.requiresCount();var n=r.executeLocal(i),a={result:t.requiresCounts?n.result:n,count:n.count,aggregates:JSON.stringify(n.aggregates)};return t.requiresCounts?a:n},s.prepareQuery=function(t){var e=this,i=new We;if(t.select&&i.select(t.select),t.where){var r=s.parse.parseJson(t.where);r.filter(function(a){if(m(a.condition))i.where(a.field,a.operator,a.value,a.ignoreCase,a.ignoreAccent);else{var o=[];a.field?o.push(new ht(a.field,a.operator,a.value,a.ignoreCase,a.ignoreAccent)):o=o.concat(e.getPredicate(a.predicates)),a.condition==="or"?i.where(ht.or(o)):a.condition==="and"&&i.where(ht.and(o))}})}if(t.search){var n=s.parse.parseJson(t.search);n.filter(function(a){return i.search(a.key,a.fields,a.operator,a.ignoreCase,a.ignoreAccent)})}return t.aggregates&&t.aggregates.filter(function(a){return i.aggregate(a.type,a.field)}),t.sorted&&t.sorted.filter(function(a){return i.sortBy(a.name,a.direction)}),t.skip&&i.skip(t.skip),t.take&&i.take(t.take),t.group&&t.group.filter(function(a){return i.group(a)}),i},s.getPredicate=function(t){for(var e=[],i=0;i<t.length;i++){var r=t[i];if(r.field)e.push(new ht(r.field,r.operator,r.value,r.ignoreCase,r.ignoreAccent));else{for(var n=[],a=this.getPredicate(r.predicates),o=0,l=Object.keys(a);o<l.length;o++){var h=l[o];n.push(a[h])}e.push(r.condition==="or"?ht.or(n):ht.and(n))}}return e},s.serverTimezoneOffset=null,s.timeZoneHandling=!0,s.throwError=function(t){try{throw new Error(t)}catch(e){throw e.message+"\n"+e.stack}},s.aggregates={sum:function(t,e){for(var i=0,r,n=typeof s.getVal(t,0,e)!="number",a=0;a<t.length;a++)r=s.getVal(t,a,e),!isNaN(r)&&r!==null&&(n&&(r=+r),i+=r);return i},average:function(t,e){return s.aggregates.sum(t,e)/t.length},min:function(t,e){var i;return typeof e=="function"&&(i=e,e=null),s.getObject(e,s.getItemFromComparer(t,e,i||s.fnAscending))},max:function(t,e){var i;return typeof e=="function"&&(i=e,e=null),s.getObject(e,s.getItemFromComparer(t,e,i||s.fnDescending))},truecount:function(t,e){return new fe(t).executeLocal(new We().where(e,"equal",!0,!0)).length},falsecount:function(t,e){return new fe(t).executeLocal(new We().where(e,"equal",!1,!0)).length},count:function(t,e){return t.length}},s.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},s.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},s.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof",doesnotendwith:"not endswith",doesnotstartwith:"not startswith",doesnotcontain:"not substringof",wildcard:"wildcard",like:"like"},s.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains",doesnotendwith:"not endswith",doesnotstartwith:"not startswith",doesnotcontain:"not contains",wildcard:"wildcard",like:"like"},s.diacritics={"":"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A","":"A","":"A","":"AA",:"AE",:"AE",:"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B",:"B",:"B",:"B",:"B","":"B",:"B",:"B","":"C",:"C",:"C",:"C",:"C",:"C",:"C",:"C",:"C","":"C","":"C","":"D",:"D",:"D",:"D",:"D",:"D",:"D",:"D",:"D",:"D",:"D",:"D","":"D",:"DZ",:"DZ",:"Dz",:"Dz","":"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E","":"F",:"F",:"F",:"F","":"F","":"G",:"G",:"G",:"G",:"G",:"G",:"G",:"G",:"G",:"G",:"G","":"G","":"G","":"G","":"H",:"H",:"H",:"H",:"H",:"H",:"H",:"H",:"H",:"H","":"H","":"H","":"H","":"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I","":"J",:"J",:"J","":"J","":"K",:"K",:"K",:"K",:"K",:"K",:"K",:"K","":"K","":"K","":"K","":"K","":"K","":"L",:"L",:"L",:"L",:"L",:"L",:"L",:"L",:"L",:"L",:"L","":"L","":"L","":"L","":"L","":"L","":"L",:"LJ",:"Lj","":"M",:"M",:"M",:"M",:"M","":"M",:"M","":"N",:"N",:"N",:"N",:"N",:"N",:"N",:"N",:"N",:"N",:"N","":"N",:"N","":"N","":"N",:"NJ",:"Nj","":"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O","":"O","":"O",:"OI","":"OO",:"OU","":"P",:"P",:"P",:"P",:"P","":"P","":"P","":"P","":"P","":"Q",:"Q","":"Q","":"Q","":"Q","":"R",:"R",:"R",:"R",:"R",:"R",:"R",:"R",:"R",:"R",:"R","":"R","":"R","":"R","":"R","":"R","":"S",:"S","":"S",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"S","":"S","":"S","":"S","":"T",:"T",:"T",:"T",:"T",:"T",:"T",:"T",:"T",:"T",:"T",:"T","":"T","":"T","":"TZ","":"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U","":"U","":"V",:"V",:"V",:"V",:"V","":"V","":"V","":"VY","":"W",:"W",:"W",:"W",:"W",:"W",:"W",:"W","":"W","":"X",:"X",:"X",:"X","":"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y","":"Y","":"Y","":"Z",:"Z",:"Z",:"Z",:"Z",:"Z",:"Z",:"Z",:"Z",:"Z","":"Z","":"Z","":"Z","":"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a","":"a",:"a","":"aa",:"ae",:"ae",:"ae","":"ao","":"au","":"av","":"av","":"ay","":"b",:"b",:"b",:"b",:"b",:"b",:"b",:"b","":"c",:"c",:"c",:"c",:"c",:"c",:"c",:"c",:"c","":"c","":"c","":"c","":"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d",:"d","":"d",:"dz",:"dz","":"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e","":"e",:"e",:"e","":"f",:"f",:"f",:"f","":"f","":"g",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"g","":"g","":"g","":"g","":"h",:"h",:"h",:"h",:"h",:"h",:"h",:"h",:"h",:"h",:"h","":"h","":"h",:"h",:"hv","":"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i","":"j",:"j",:"j",:"j","":"j","":"k",:"k",:"k",:"k",:"k",:"k",:"k",:"k","":"k","":"k","":"k","":"k","":"k","":"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l","":"l","":"l","":"l","":"l",:"lj","":"m",:"m",:"m",:"m",:"m",:"m",:"m","":"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n",:"n","":"n","":"n",:"nj","":"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o","":"o","":"o",:"o",:"oi",:"ou","":"oo","":"p",:"p",:"p",:"p",:"p","":"p","":"p","":"p","":"p","":"q",:"q","":"q","":"q","":"q","":"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r",:"r","":"r",:"r","":"r","":"r","":"r","":"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"s","":"s","":"s","":"s",:"s","":"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t",:"t","":"t","":"t","":"tz","":"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u","":"v",:"v",:"v",:"v",:"v","":"v",:"v","":"vy","":"w",:"w",:"w",:"w",:"w",:"w",:"w",:"w",:"w","":"w","":"x",:"x",:"x",:"x","":"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y","":"y","":"y","":"z",:"z",:"z",:"z",:"z",:"z",:"z",:"z",:"z",:"z","":"z","":"z","":"z",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""},s.fnOperators={equal:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacritics(e)),i?s.toLowerCase(t)===s.toLowerCase(e):t===e},notequal:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacritics(e)),!s.fnOperators.equal(t,e,i)},lessthan:function(t,e,i){return i?s.toLowerCase(t)<s.toLowerCase(e):(m(t)&&(t=void 0),t<e)},greaterthan:function(t,e,i){return i?s.toLowerCase(t)>s.toLowerCase(e):t>e},lessthanorequal:function(t,e,i){return i?s.toLowerCase(t)<=s.toLowerCase(e):(m(t)&&(t=void 0),t<=e)},greaterthanorequal:function(t,e,i){return i?s.toLowerCase(t)>=s.toLowerCase(e):(m(t)&&(t=void 0),t>=e)},contains:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacritics(e)),i?!m(t)&&!m(e)&&s.toLowerCase(t).indexOf(s.toLowerCase(e))!==-1:!m(t)&&!m(e)&&t.toString().indexOf(e)!==-1},doesnotcontain:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacritics(e)),i?!m(t)&&!m(e)&&s.toLowerCase(t).indexOf(s.toLowerCase(e))===-1:!m(t)&&!m(e)&&t.toString().indexOf(e)===-1},isnotnull:function(t){return t!=null},isnull:function(t){return t==null},startswith:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacritics(e)),i?t&&e&&s.startsWith(s.toLowerCase(t),s.toLowerCase(e)):t&&e&&s.startsWith(t,e)},doesnotstartwith:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacritics(e)),i?t&&e&&s.notStartsWith(s.toLowerCase(t),s.toLowerCase(e)):t&&e&&s.notStartsWith(t,e)},like:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacritics(e)),i?t&&e&&s.like(s.toLowerCase(t),s.toLowerCase(e)):t&&e&&s.like(t,e)},isempty:function(t){return t===void 0||t===""},isnotempty:function(t){return t!==void 0&&t!==""},wildcard:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacritics(e)),i?(t||typeof t=="boolean")&&e&&typeof t!="object"&&s.wildCard(s.toLowerCase(t),s.toLowerCase(e)):(t||typeof t=="boolean")&&e&&s.wildCard(t,e)},endswith:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacritics(e)),i?t&&e&&s.endsWith(s.toLowerCase(t),s.toLowerCase(e)):t&&e&&s.endsWith(t,e)},doesnotendwith:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacritics(e)),i?t&&e&&s.notEndsWith(s.toLowerCase(t),s.toLowerCase(e)):t&&e&&s.notEndsWith(t,e)},processSymbols:function(t){var e=s.operatorSymbols[t];if(e){var i=s.fnOperators[e];return i}return s.throwError("Query - Process Operator : Invalid operator")},processOperator:function(t){var e=s.fnOperators[t];return e||s.fnOperators.processSymbols(t)},in:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacriticsForArrays(e)),i?!m(t)&&e&&e.length>0&&e.map(function(n){return s.toLowerCase(n)}).indexOf(s.toLowerCase(t))>-1:t instanceof Date?!m(t)&&e&&e.length>0&&Array.isArray(e)&&e.some(function(n){return n instanceof Date&&n.getTime()===t.getTime()}):!m(t)&&e&&e.length>0&&e.indexOf(t)>-1},notin:function(t,e,i,r){return r&&(t=s.ignoreDiacritics(t),e=s.ignoreDiacriticsForArrays(e)),i?!m(t)&&e&&e.length>0&&e.map(function(n){return s.toLowerCase(n)}).indexOf(s.toLowerCase(t))===-1:t instanceof Date?!m(t)&&e&&e.length>0&&Array.isArray(e)&&e.every(function(n){return!(n instanceof Date)||n.getTime()!==t.getTime()}):!m(t)&&e&&e.length>0&&e.indexOf(t)===-1}},s.parse={parseJson:function(t){return typeof t=="string"&&(/^[\s]*\[|^[\s]*\{(.)+:/g.test(t)||t.indexOf('"')===-1)?t=JSON.parse(t,s.parse.jsonReviver):t instanceof Array?s.parse.iterateAndReviveArray(t):typeof t=="object"&&t!==null&&s.parse.iterateAndReviveJson(t),t},iterateAndReviveArray:function(t){for(var e=0;e<t.length;e++)typeof t[e]=="object"&&t[e]!==null?s.parse.iterateAndReviveJson(t[e]):typeof t[e]=="string"&&(!/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(t[e])||t[e].toString().indexOf('"')===-1)?t[e]=s.parse.jsonReviver("",t[e]):t[e]=s.parse.parseJson(t[e])},iterateAndReviveJson:function(t){for(var e,i=Object.keys(t),r=0,n=i;r<n.length;r++){var a=n[r];s.startsWith(a,"__")||(e=t[a],typeof e=="object"?e instanceof Array?s.parse.iterateAndReviveArray(e):e&&s.parse.iterateAndReviveJson(e):t[a]=s.parse.jsonReviver(t[a],e))}},jsonReviver:function(t,e){if(typeof e=="string"){var i=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(e),r=s.timeZoneHandling?s.serverTimezoneOffset:null;if(i)return s.dateParse.toTimeZone(new Date(parseInt(i[1],10)),r,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(e)){var n=e.indexOf("Z")>-1||e.indexOf("z")>-1,a=e.split(/[^0-9.]/);if(n){if(a[5].indexOf(".")>-1){var o=a[5].split(".");a[5]=o[0],a[6]=new Date(e).getUTCMilliseconds().toString()}else a[6]="00";e=s.dateParse.toTimeZone(new Date(parseInt(a[0],10),parseInt(a[1],10)-1,parseInt(a[2],10),parseInt(a[3],10),parseInt(a[4],10),parseInt(a[5]?a[5]:"00",10),parseInt(a[6],10)),s.serverTimezoneOffset,!1)}else{var l=new Date(parseInt(a[0],10),parseInt(a[1],10)-1,parseInt(a[2],10),parseInt(a[3],10),parseInt(a[4],10),parseInt(a[5]?a[5]:"00",10)),h=parseInt(a[6],10),u=parseInt(a[7],10);if(isNaN(h)&&isNaN(u))return l;e.indexOf("+")>-1?l.setHours(l.getHours()-h,l.getMinutes()-u):l.setHours(l.getHours()+h,l.getMinutes()+u),e=s.dateParse.toTimeZone(l,s.serverTimezoneOffset,!1)}s.serverTimezoneOffset==null&&(e=s.dateParse.addSelfOffset(e))}}return e},isJson:function(t){return typeof t[0]=="string"?t:s.parse.parseJson(t)},isGuid:function(t){var e=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i,i=e.exec(t);return i!=null},replacer:function(t,e){return s.isPlainObject(t)?s.parse.jsonReplacer(t,e):t instanceof Array?s.parse.arrayReplacer(t):t instanceof Date?s.parse.jsonReplacer({val:t},e).val:t},jsonReplacer:function(t,e){for(var i,r=Object.keys(t),n=0,a=r;n<a.length;n++){var o=a[n];if(i=t[o],i instanceof Date){var l=i;s.serverTimezoneOffset==null?t[o]=s.dateParse.toTimeZone(l,null).toJSON():(l=new Date(+l+s.serverTimezoneOffset*36e5),t[o]=s.dateParse.toTimeZone(s.dateParse.addSelfOffset(l),null).toJSON())}}return t},arrayReplacer:function(t){for(var e=0;e<t.length;e++)s.isPlainObject(t[e])?t[e]=s.parse.jsonReplacer(t[e]):t[e]instanceof Date&&(t[e]=s.parse.jsonReplacer({date:t[e]}).date);return t},jsonDateReplacer:function(t,e){if(t==="value"&&e){if(typeof e=="string"){var i=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(e);if(i)e=s.dateParse.toTimeZone(new Date(parseInt(i[1],10)),null,!0);else if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(e)){var r=e.split(/[^0-9]/);e=s.dateParse.toTimeZone(new Date(parseInt(r[0],10),parseInt(r[1],10)-1,parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10)),null,!0)}}if(e instanceof Date)return e=s.dateParse.addSelfOffset(e),s.serverTimezoneOffset===null?s.dateParse.toTimeZone(s.dateParse.addSelfOffset(e),null).toJSON():(e=s.dateParse.toTimeZone(e,e.getTimezoneOffset()/60-s.serverTimezoneOffset,!1),e.toJSON())}return e}},s.dateParse={addSelfOffset:function(t){return new Date(+t-t.getTimezoneOffset()*6e4)},toUTC:function(t){return new Date(+t+t.getTimezoneOffset()*6e4)},toTimeZone:function(t,e,i){if(e===null)return t;var r=i?s.dateParse.toUTC(t):t;return new Date(+r-e*36e5)},toLocalTime:function(t){var e=t,i=-e.getTimezoneOffset(),r=i>=0?"+":"-",n=function(o){var l=Math.floor(Math.abs(o));return(l<10?"0":"")+l},a=e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+"T"+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds())+r+n(i/60)+":"+n(i%60);return a}},s}(),Vs=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),iB={GroupGuid:"{271bbba0-1ee7}"},dw=function(){function s(t){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates",expand:"expand"},this.type=s,this.dataSource=t,this.pvt={}}return s.prototype.processResponse=function(t,e,i,r){return t},s}(),dc=function(s){Vs(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.processQuery=function(e,i){for(var r=e.dataSource.json.slice(0),n=r.length,a=!0,o,l,h={},u=0,c=[],f=[],d,p=0;p<i.lazyLoad.length;p++)u++,h[i.lazyLoad[p].key]=i.lazyLoad[p].value;var v={},g=!1;if(i.lazyLoad.length){for(var p=0;p<i.queries.length;p++)if(l=i.queries[p],l.fn==="onGroup"&&!m(l.e.format)){g=!0;break}}for(var p=0;p<i.queries.length;p++){if(l=i.queries[p],(l.fn==="onPage"||l.fn==="onGroup"||l.fn==="onSortBy"&&!g)&&i.lazyLoad.length){l.fn==="onGroup"&&c.push(l.e),l.fn==="onPage"&&(d=l.e),l.fn==="onSortBy"&&f.unshift(l.e);continue}o=this[l.fn].call(this,r,l.e,i),l.fn==="onAggregates"?v[l.e.field+" - "+l.e.type]=o:r=o!==void 0?o:r,(l.fn==="onPage"||l.fn==="onSkip"||l.fn==="onTake"||l.fn==="onRange")&&(a=!1),a&&(n=r.length)}if(u){var b={query:i,lazyLoad:h,result:r,group:c,page:d,sort:f},C=this.lazyLoadGroup(b);r=C.result,n=C.count}return i.isCountRequired&&(r={result:r,count:n,aggregates:v}),r},t.prototype.lazyLoadGroup=function(e){var i=0,r=this.getAggregate(e.query),n=e.result;if(m(e.lazyLoad.onDemandGroupInfo)){var u=e.group[0].fieldName;n=ue.group(n,u,r,null,null,e.group[0].comparer,!0),i=n.length;var h=n;if(e.sort.length){var c=e.sort.length>1?e.sort.filter(function(d){return d.fieldName===u})[0]:e.sort[0];n=this.onSortBy(n,c,e.query,!0)}e.page&&(n=this.onPage(n,e.page,e.query)),this.formGroupResult(n,h)}else{for(var a=e.lazyLoad.onDemandGroupInfo,o=a.where.length-1;o>=0;o--)n=this.onWhere(n,a.where[o]);if(e.group.length!==a.level){var l=e.group[a.level].fieldName;n=ue.group(n,l,r,null,null,e.group[a.level].comparer,!0),e.sort.length&&(n=this.onSortBy(n,e.sort[parseInt(a.level.toString(),10)],e.query,!0))}else for(var o=e.sort.length-1;o>=a.level;o--)n=this.onSortBy(n,e.sort[parseInt(o.toString(),10)],e.query,!1);i=n.length;var h=n;n=n.slice(a.skip),n=n.slice(0,a.take),e.group.length!==a.level&&this.formGroupResult(n,h)}return{result:n,count:i}},t.prototype.formGroupResult=function(e,i){if(e.length&&i.length){var r="GroupGuid",n="childLevels",a="level",o="records";e[r]=i[r],e[n]=i[n],e[a]=i[a],e[o]=i[o]}return e},t.prototype.getAggregate=function(e){var i=We.filterQueries(e.queries,"onAggregates"),r=[];if(i.length)for(var n=void 0,a=0;a<i.length;a++)n=i[a].e,r.push({type:n.type,field:ue.getValue(n.field,e)});return r},t.prototype.batchRequest=function(e,i,r){var n,a=i.deletedRecords.length;for(n=0;n<i.addedRecords.length;n++)this.insert(e,i.addedRecords[n]);for(n=0;n<i.changedRecords.length;n++)this.update(e,r.key,i.changedRecords[n]);for(n=0;n<a;n++)this.remove(e,r.key,i.deletedRecords[n]);return i},t.prototype.onWhere=function(e,i){return!e||!e.length?e:e.filter(function(r){if(i)return i.validate(r)})},t.prototype.onAggregates=function(e,i){var r=ue.aggregates[i.type];return!e||!r||e.length===0?null:r(e,i.field)},t.prototype.onSearch=function(e,i){return!e||!e.length?e:(i.fieldNames.length===0&&ue.getFieldList(e[0],i.fieldNames),e.filter(function(r){for(var n=0;n<i.fieldNames.length;n++)if(i.comparer.call(r,ue.getObject(i.fieldNames[n],r),i.searchKey,i.ignoreCase,i.ignoreAccent))return!0;return!1}))},t.prototype.onSortBy=function(e,i,r,n){if(!e||!e.length)return e;var a,o=ue.getValue(i.fieldName,r);if(!o)return e.sort(i.comparer);if(o instanceof Array){o=o.slice(0);for(var l=o.length-1;l>=0;l--)o[l]&&(a=i.comparer,ue.endsWith(o[l]," desc")&&(a=ue.fnSort("descending"),o[l]=o[l].replace(" desc","")),e=ue.sort(e,o[l],a));return e}return ue.sort(e,n?"key":o,i.comparer)},t.prototype.onGroup=function(e,i,r){if(!e||!e.length)return e;var n=this.getAggregate(r);return ue.group(e,ue.getValue(i.fieldName,r),n,null,null,i.comparer)},t.prototype.onPage=function(e,i,r){var n=ue.getValue(i.pageSize,r),a=(ue.getValue(i.pageIndex,r)-1)*n,o=a+n;return!e||!e.length?e:e.slice(a,o)},t.prototype.onRange=function(e,i){return!e||!e.length?e:e.slice(ue.getValue(i.start),ue.getValue(i.end))},t.prototype.onTake=function(e,i){return!e||!e.length?e:e.slice(0,ue.getValue(i.nos))},t.prototype.onSkip=function(e,i){return!e||!e.length?e:e.slice(ue.getValue(i.nos))},t.prototype.onSelect=function(e,i){return!e||!e.length?e:ue.select(e,ue.getValue(i.fieldNames))},t.prototype.insert=function(e,i,r,n,a){return m(a)?e.dataSource.json.push(i):e.dataSource.json.splice(a,0,i)},t.prototype.remove=function(e,i,r,n){var a=e.dataSource.json,o;for(typeof r=="object"&&!(r instanceof Date)&&(r=ue.getObject(i,r)),o=0;o<a.length&&ue.getObject(i,a[o])!==r;o++);return o!==a.length?a.splice(o,1):null},t.prototype.update=function(e,i,r,n){var a=e.dataSource.json,o,l;for(m(i)||(l=ie(i,r)),o=0;o<a.length&&!(!m(i)&&ie(i,a[o])===l);o++);return o<a.length?po(a[o],r):null},t}(dw),Sa=function(s){Vs(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.processQuery=function(e,i,r){var n=this.getQueryRequest(i),a=We.filterQueryLists(i.queries,["onSelect","onPage","onSkip","onTake","onRange"]),o=i.params,l=e.dataSource.url,h,u,c=null,f=this.options,d={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in a?(h=a.onPage,u=ue.getValue(h.pageIndex,i),c=ue.getValue(h.pageSize,i),u=(u-1)*c):"onRange"in a&&(h=a.onRange,u=h.start,c=h.end-h.start);for(var p=0;p<n.sorts.length;p++)h=ue.getValue(n.sorts[p].e.fieldName,i),d.sorts.push(ue.callAdaptorFunction(this,"onEachSort",{name:h,direction:n.sorts[p].e.direction},i));r&&(h=this.getFiltersFrom(r,i),h&&d.filters.push(ue.callAdaptorFunction(this,"onEachWhere",h.toJson(),i)));for(var p=0;p<n.filters.length;p++){var v=ue.callAdaptorFunction(this,"onEachWhere",n.filters[p].e.toJson(),i);this.getModuleName&&this.getModuleName()==="ODataV4Adaptor"&&!m(n.filters[p].e.key)&&n.filters.length>1&&(v="("+v+")"),d.filters.push(v);for(var g=typeof d.filters[p]=="object"?Object.keys(d.filters[p]):[],b=0,C=g;b<C.length;b++){var y=C[b];ue.isNull(d[y])&&delete d[y]}}for(var p=0;p<n.searches.length;p++)h=n.searches[p].e,d.searches.push(ue.callAdaptorFunction(this,"onEachSearch",{fields:h.fieldNames,operator:h.operator,key:h.searchKey,ignoreCase:h.ignoreCase,ignoreAccent:h.ignoreAccent},i));for(var p=0;p<n.groups.length;p++)d.groups.push(ue.getValue(n.groups[p].e.fieldName,i));for(var p=0;p<n.aggregates.length;p++)h=n.aggregates[p].e,d.aggregates.push({type:h.type,field:ue.getValue(h.field,i)});var x={};if(this.getRequestQuery(f,i,a,d,x),ue.callAdaptorFunction(this,"addParams",{dm:e,query:i,params:o,reqParams:x}),i.lazyLoad.length)for(var p=0;p<i.lazyLoad.length;p++)x[i.lazyLoad[p].key]=i.lazyLoad[p].value;for(var w=Object.keys(x),S=0,E=w;S<E.length;S++){var y=E[S];(ue.isNull(x[y])||x[y]===""||x[y].length===0)&&delete x[y]}!(f.skip in x&&f.take in x)&&c!==null&&(x[f.skip]=ue.callAdaptorFunction(this,"onSkip",u,i),x[f.take]=ue.callAdaptorFunction(this,"onTake",c,i));var k=this.pvt;return this.pvt={},this.options.requestType==="json"?{data:JSON.stringify(x,ue.parse.jsonDateReplacer),url:l,pvtData:k,type:"POST",contentType:"application/json; charset=utf-8"}:(h=this.convertToQueryString(x,i,e),h=(e.dataSource.url.indexOf("?")!==-1?"&":"/")+h,{type:"GET",url:h.length?l.replace(/\/*$/,h):l,pvtData:k})},t.prototype.getRequestQuery=function(e,i,r,n,a){var o="param",l=a;l[e.from]=i.fromTable,e.apply&&i.distincts.length&&(l[e.apply]="onDistinct"in this?ue.callAdaptorFunction(this,"onDistinct",i.distincts):""),!i.distincts.length&&e.expand&&(l[e.expand]="onExpand"in this&&"onSelect"in r?ue.callAdaptorFunction(this,"onExpand",{selects:ue.getValue(r.onSelect.fieldNames,i),expands:i.expands},i):i.expands),l[e.select]="onSelect"in r&&!i.distincts.length?ue.callAdaptorFunction(this,"onSelect",ue.getValue(r.onSelect.fieldNames,i),i):"",l[e.count]=i.isCountRequired?ue.callAdaptorFunction(this,"onCount",i.isCountRequired,i):"",l[e.search]=n.searches.length?ue.callAdaptorFunction(this,"onSearch",n.searches,i):"",l[e.skip]="onSkip"in r?ue.callAdaptorFunction(this,"onSkip",ue.getValue(r.onSkip.nos,i),i):"",l[e.take]="onTake"in r?ue.callAdaptorFunction(this,"onTake",ue.getValue(r.onTake.nos,i),i):"",l[e.where]=n.filters.length||n.searches.length?ue.callAdaptorFunction(this,"onWhere",n.filters,i):"",l[e.sortBy]=n.sorts.length?ue.callAdaptorFunction(this,"onSortBy",n.sorts,i):"",l[e.group]=n.groups.length?ue.callAdaptorFunction(this,"onGroup",n.groups,i):"",l[e.aggregates]=n.aggregates.length?ue.callAdaptorFunction(this,"onAggregates",n.aggregates,i):"",l[o]=[]},t.prototype.convertToQueryString=function(e,i,r){return""},t.prototype.processResponse=function(e,i,r,n,a,o){if(n&&n.headers.get("Content-Type")&&n.headers.get("Content-Type").indexOf("application/json")!==-1){var l=ue.timeZoneHandling;i&&!i.timeZoneHandling&&(ue.timeZoneHandling=!1),i.enableCache||(e=ue.parse.parseJson(e)),ue.timeZoneHandling=l}var h=a,u=h.pvtData||{},c=e?e.groupDs:[];if(n&&n.headers.get("Content-Type")&&n.headers.get("Content-Type").indexOf("xml")!==-1)return r.isCountRequired?{result:[],count:0}:[];var f=JSON.parse(h.data);if(f&&f.action==="batch"&&e&&e.addedRecords&&!m(o))return o.addedRecords=e.addedRecords,o;e&&e.d&&(e=e.d);var d={};e&&"count"in e&&(d.count=e.count),d.result=e&&e.result?e.result:e;var p=!1;if(Array.isArray(e.result)&&e.result.length){var v="key",g="value",b="level";if(m(e.result[0][v])||(d.result=this.formRemoteGroupedData(d.result,1,u.groups.length-1)),r&&r.lazyLoad.length&&u.groups.length){for(var C=0;C<r.lazyLoad.length;C++)if(r.lazyLoad[C][v]==="onDemandGroupInfo"){var y=r.lazyLoad[C][g][b];u.groups.length===y&&(p=!0)}}}return p||this.getAggregateResult(u,e,d,c,r),ue.isNull(d.count)?d.result:{result:d.result,count:d.count,aggregates:d.aggregates}},t.prototype.formRemoteGroupedData=function(e,i,r){for(var n=0;n<e.length;n++)e[n].items.length&&Object.keys(e[n].items[0]).indexOf("key")>-1&&this.formRemoteGroupedData(e[n].items,i+1,r-1);var a="GroupGuid",o="childLevels",l="level",h="records";return e[a]=iB[a],e[l]=i,e[o]=r,e[h]=e[0].items.length?this.getGroupedRecords(e,!m(e[0].items[h])):[],e},t.prototype.getGroupedRecords=function(e,i){for(var r=[],n="records",a=0;a<e.length;a++)if(i)r=r.concat(e[a].items[n]);else for(var o=0;o<e[a].items.length;o++)r.push(e[a].items[o]);return r},t.prototype.onGroup=function(e){return this.pvt.groups=e,e},t.prototype.onAggregates=function(e){this.pvt.aggregates=e},t.prototype.batchRequest=function(e,i,r,n,a){var o,l;return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.removeUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(Ue({},{changed:i.changedRecords,added:i.addedRecords,deleted:i.deletedRecords,action:"batch",table:r[o],key:r[l]},ue.getAddParams(this,e,n)))}},t.prototype.beforeSend=function(e,i,r){},t.prototype.insert=function(e,i,r,n){return{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Ue({},{value:i,table:r,action:"insert"},ue.getAddParams(this,e,n)))}},t.prototype.remove=function(e,i,r,n,a){return{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Ue({},{key:r,keyColumn:i,table:n,action:"remove"},ue.getAddParams(this,e,a)))}},t.prototype.update=function(e,i,r,n,a){return{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Ue({},{value:r,action:"update",keyColumn:i,key:ue.getObject(i,r),table:n},ue.getAddParams(this,e,a)))}},t.prototype.getFiltersFrom=function(e,i){var r=i.fKey,n,a=r,o=i.key,l=[];typeof e[0]!="object"&&(a=null);for(var h=0;h<e.length;h++)typeof e[0]=="object"?n=ue.getObject(o||a,e[h]):n=e[h],l.push(new ht(r,"equal",n));return ht.or(l)},t.prototype.getAggregateResult=function(e,i,r,n,a){var o=i;if(i&&i.result&&(o=i.result),e&&e.aggregates&&e.aggregates.length){var l=e.aggregates,h=void 0,u=o,c={};i.aggregate&&(u=i.aggregate);for(var f=0;f<l.length;f++)h=ue.aggregates[l[f].type],h&&(c[l[f].field+" - "+l[f].type]=h(u,l[f].field));r.aggregates=c}var d="key",p=Array.isArray(i.result)&&i.result.length&&!m(i.result[0][d]);if(e&&e.groups&&e.groups.length&&!p){for(var v=e.groups,f=0;f<v.length;f++){var g=null;m(n)||(n=ue.group(n,v[f]));var b=We.filterQueries(a.queries,"onGroup")[f].e;o=ue.group(o,v[f],e.aggregates,g,n,b.comparer)}r.result=o}return r},t.prototype.getQueryRequest=function(e){var i={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return i.sorts=We.filterQueries(e.queries,"onSortBy"),i.groups=We.filterQueries(e.queries,"onGroup"),i.filters=We.filterQueries(e.queries,"onWhere"),i.searches=We.filterQueries(e.queries,"onSearch"),i.aggregates=We.filterQueries(e.queries,"onAggregates"),i},t.prototype.addParams=function(e){var i=e.reqParams;e.params.length&&(i.params={});for(var r=0,n=e.params;r<n.length;r++){var a=n[r];if(i[a.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");i[a.key]=a.value,a.fn&&(i[a.key]=a.fn.call(e.query,a.key,e.query,e.dm)),i.params[a.key]=i[a.key]}},t}(dw),xo=function(s){Vs(t,s);function t(e){var i=s.call(this)||this;return i.options=Ue({},i.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),Ue(i.options,e||{}),i}return t.prototype.getModuleName=function(){return"ODataAdaptor"},t.prototype.onPredicate=function(e,i,r){var n="",a,o,l=e.value,h=typeof l,u=e.field?t.getField(e.field):null;if(l instanceof Date&&(l="datetime'"+ue.parse.replacer(l)+"'"),h==="string"&&(l=l.replace(/'/g,"''"),e.ignoreCase&&(l=l.toLowerCase()),e.operator!=="like"&&(l=encodeURIComponent(l)),e.operator!=="wildcard"&&e.operator!=="like"&&(l="'"+l+"'"),r&&(u="cast("+u+", 'Edm.String')"),ue.parse.isGuid(l)&&(o="guid"),e.ignoreCase&&(o||(u="tolower("+u+")"),l=l.toLowerCase())),e.operator==="isempty"||e.operator==="isnull"||e.operator==="isnotempty"||e.operator==="isnotnull"?(a=e.operator.indexOf("isnot")!==-1?ue.odBiOperator.notequal:ue.odBiOperator.equal,l=e.operator==="isnull"||e.operator==="isnotnull"?null:"''"):a=ue.odBiOperator[e.operator],a)return n+=u,n+=a,o&&(n+=o),n+l;if(!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?a=ue.odv4UniOperator[e.operator]:a=ue.odUniOperator[e.operator],a==="like")l=l,l.indexOf("%")!==-1&&(l.charAt(0)==="%"&&l.lastIndexOf("%")<2?(l=l.substring(1,l.length),a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ue.odv4UniOperator.startswith:ue.odUniOperator.startswith):l.charAt(l.length-1)==="%"&&l.indexOf("%")>l.length-3?(l=l.substring(0,l.length-1),a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ue.odv4UniOperator.endswith:ue.odUniOperator.endswith):l.lastIndexOf("%")!==l.indexOf("%")&&l.lastIndexOf("%")>l.indexOf("%")+1?(l=l.substring(l.indexOf("%")+1,l.lastIndexOf("%")),a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ue.odv4UniOperator.contains:ue.odUniOperator.contains):a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ue.odv4UniOperator.contains:ue.odUniOperator.contains),l=encodeURIComponent(l),l="'"+l+"'";else if(a==="wildcard")if(l=l,l.indexOf("*")!==-1){var c=l.split("*"),f=void 0,d=0;if(l.indexOf("*")!==0&&c[0].indexOf("%3f")===-1&&c[0].indexOf("?")===-1&&(f=c[0],f="'"+f+"'",a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ue.odv4UniOperator.startswith:ue.odUniOperator.startswith,n+=a+"(",n+=u+",",o&&(n+=o),n+=f+")",d++),l.lastIndexOf("*")!==l.length-1&&c[c.length-1].indexOf("%3f")===-1&&c[c.length-1].indexOf("?")===-1&&(f=c[c.length-1],f="'"+f+"'",a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ue.odv4UniOperator.endswith:ue.odUniOperator.endswith,d>0&&(n+=" and "),n+=a+"(",n+=u+",",o&&(n+=o),n+=f+")",d++),c.length>2){for(var p=1;p<c.length-1;p++)if(c[p].indexOf("%3f")===-1&&c[p].indexOf("?")===-1){if(f=c[p],f="'"+f+"'",a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ue.odv4UniOperator.contains:ue.odUniOperator.contains,d>0&&(n+=" and "),a==="substringof"||a==="not substringof"){var v=f;f=u,u=v}n+=a+"(",n+=u+",",o&&(n+=o),n+=f+")",d++}}d===0?(a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ue.odv4UniOperator.contains:ue.odUniOperator.contains,(l.indexOf("?")!==-1||l.indexOf("%3f")!==-1)&&(l=l.indexOf("?")!==-1?l.split("?").join(""):l.split("%3f").join("")),l="'"+l+"'"):a="wildcard"}else a=!m(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ue.odv4UniOperator.contains:ue.odUniOperator.contains,(l.indexOf("?")!==-1||l.indexOf("%3f")!==-1)&&(l=l.indexOf("?")!==-1?l.split("?").join(""):l.split("%3f").join("")),l="'"+l+"'";if(a==="substringof"||a==="not substringof"){var v=l;l=u,u=v}return a!=="wildcard"&&(n+=a+"(",n+=u+",",o&&(n+=o),n+=l+")"),n},t.prototype.addParams=function(e){s.prototype.addParams.call(this,e),delete e.reqParams.params},t.prototype.onComplexPredicate=function(e,i,r){for(var n=[],a=0;a<e.predicates.length;a++)n.push("("+this.onEachWhere(e.predicates[a],i,r)+")");return n.join(" "+e.condition+" ")},t.prototype.onEachWhere=function(e,i,r){return e.isComplex?this.onComplexPredicate(e,i,r):this.onPredicate(e,i,r)},t.prototype.onWhere=function(e){return this.pvt.search&&e.push(this.onEachWhere(this.pvt.search,null,!0)),e.join(" and ")},t.prototype.onEachSearch=function(e){e.fields&&e.fields.length===0&&ue.throwError("Query() - Search : oData search requires list of field names to search");for(var i=this.pvt.search||[],r=0;r<e.fields.length;r++)i.push(new ht(e.fields[r],e.operator,e.key,e.ignoreCase));this.pvt.search=i},t.prototype.onSearch=function(e){return this.pvt.search=ht.or(this.pvt.search),""},t.prototype.onEachSort=function(e){var i=[];if(e.name instanceof Array)for(var r=0;r<e.name.length;r++)i.push(t.getField(e.name[r])+(e.direction==="descending"?" desc":""));else i.push(t.getField(e.name)+(e.direction==="descending"?" desc":""));return i.join(",")},t.prototype.onSortBy=function(e){return e.reverse().join(",")},t.prototype.onGroup=function(e){return this.pvt.groups=e,[]},t.prototype.onSelect=function(e){for(var i=0;i<e.length;i++)e[i]=t.getField(e[i]);return e.join(",")},t.prototype.onAggregates=function(e){return this.pvt.aggregates=e,""},t.prototype.onCount=function(e){return e===!0?"allpages":""},t.prototype.beforeSend=function(e,i,r){ue.endsWith(r.url,this.options.batch)&&r.type.toLowerCase()==="post"?(i.headers.set("Accept",this.options.multipartAccept),i.headers.set("DataServiceVersion","2.0")):i.headers.set("Accept",this.options.accept),i.headers.set("DataServiceVersion","2.0"),i.headers.set("MaxDataServiceVersion","2.0")},t.prototype.processResponse=function(e,i,r,n,a,o){var l="odata.metadata";if(a&&a.type==="GET"&&!this.rootUrl&&e[l]){var h=e[l].split("/$metadata#");this.rootUrl=h[0],this.resourceTableName=h[1]}var u="pvtData";if(!m(e.d)){var c=r&&r.isCountRequired?e.d.results:e.d,f="__metadata";if(!m(c))for(var d=0;d<c.length;d++)m(c[d][f])||delete c[d][f]}var p=a&&a[u],v=this.processBatchResponse(e,r,n,a,o);if(v)return v;var g=n&&a.fetchRequest.headers.get("DataServiceVersion"),b=null,C=g&&parseInt(g,10)||2;if(r&&r.isCountRequired){var y="__count";(e[y]||e["odata.count"])&&(b=e[y]||e["odata.count"]),e.d&&(e=e.d),(e[y]||e["odata.count"])&&(b=e[y]||e["odata.count"])}C===3&&e.value&&(e=e.value),e.d&&(e=e.d),C<3&&e.results&&(e=e.results);var x={};return x.count=b,x.result=e,this.getAggregateResult(p,e,x,null,r),ue.isNull(b)?x.result:{result:x.result,count:x.count,aggregates:x.aggregates}},t.prototype.convertToQueryString=function(e,i,r){var n=[],a="table",o=e[a]||"",l="$format";delete e[a],r.dataSource.requiresFormat&&(e[l]="json");for(var h=Object.keys(e),u=0,c=h;u<c.length;u++){var f=c[u];n.push(f+"="+e[f])}return n=n.join("&"),r.dataSource.url&&r.dataSource.url.indexOf("?")!==-1&&!o?n:n.length?o+"?"+n:o||""},t.prototype.localTimeReplacer=function(e,i){for(var r=0,n=m(i)?[]:Object.keys(i);r<n.length;r++){var a=n[r];i[a]instanceof Date&&(i[a]=ue.dateParse.toLocalTime(i[a]))}return i},t.prototype.insert=function(e,i,r){return{url:(e.dataSource.insertUrl||e.dataSource.url).replace(/\/*$/,r?"/"+r:""),data:JSON.stringify(i,this.options.localTime?this.localTimeReplacer:null)}},t.prototype.remove=function(e,i,r,n){var a;return typeof r=="string"&&!ue.parse.isGuid(r)?a="('"+r+"')":a="("+r+")",{type:"DELETE",url:(e.dataSource.removeUrl||e.dataSource.url).replace(/\/*$/,n?"/"+n:"")+a}},t.prototype.update=function(e,i,r,n,a,o){this.options.updateType==="PATCH"&&!m(o)&&(r=this.compareAndRemove(r,o,i));var l;return typeof r[i]=="string"&&!ue.parse.isGuid(r[i])?l="('"+r[i]+"')":l="("+r[i]+")",{type:this.options.updateType,url:(e.dataSource.updateUrl||e.dataSource.url).replace(/\/*$/,n?"/"+n:"")+l,data:JSON.stringify(r,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}},t.prototype.batchRequest=function(e,i,r,n,a){var o=r.guid=ue.getGuid(this.options.batchPre),l=e.dataSource.batchUrl||this.rootUrl?(e.dataSource.batchUrl||this.rootUrl)+"/"+this.options.batch:(e.dataSource.batchUrl||e.dataSource.url).replace(/\/*$/,"/"+this.options.batch);r.url=this.resourceTableName?this.resourceTableName:r.url;var h={url:r.url,key:r.key,cid:1,cSet:ue.getGuid(this.options.changeSet)},u="--"+o+"\n";return u+="Content-Type: multipart/mixed; boundary="+h.cSet.replace("--","")+"\n",this.pvt.changeSet=0,u+=this.generateInsertRequest(i.addedRecords,h,e),u+=this.generateUpdateRequest(i.changedRecords,h,e,a?a.changedRecords:[]),u+=this.generateDeleteRequest(i.deletedRecords,h,e),u+=h.cSet+"--\n",u+="--"+o+"--",{type:"POST",url:l,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+o,data:u}},t.prototype.generateDeleteRequest=function(e,i,r){if(!e)return"";var n="",a={method:"DELETE ",url:function(o,l,h){var u=ue.getObject(h,o[l]);if(typeof u=="number"||ue.parse.isGuid(u))return"("+u+")";if(u instanceof Date){var c=o[l][h];return"("+c.toJSON()+")"}else return"('"+u+"')"},data:function(o,l){return""}};return n=this.generateBodyContent(e,i,a,r),n+"\n"},t.prototype.generateInsertRequest=function(e,i,r){if(!e)return"";var n="",a={method:"POST ",url:function(o,l,h){return""},data:function(o,l){return JSON.stringify(o[l])+"\n\n"}};return n=this.generateBodyContent(e,i,a,r),n},t.prototype.generateUpdateRequest=function(e,i,r,n){var a=this;if(!e)return"";var o="";e.forEach(function(h){return h=a.compareAndRemove(h,n.filter(function(u){return ue.getObject(i.key,u)===ue.getObject(i.key,h)})[0],i.key)});var l={method:this.options.updateType+" ",url:function(h,u,c){if(typeof h[u][c]=="number"||ue.parse.isGuid(h[u][c]))return"("+h[u][c]+")";if(h[u][c]instanceof Date){var f=h[u][c];return"("+f.toJSON()+")"}else return"('"+h[u][c]+"')"},data:function(h,u){return JSON.stringify(h[u])+"\n\n"}};return o=this.generateBodyContent(e,i,l,r),o},t.getField=function(e){return e.replace(/\./g,"/")},t.prototype.generateBodyContent=function(e,i,r,n){for(var a="",o=0;o<e.length;o++)a+="\n"+i.cSet+"\n",a+=this.options.changeSetContent+"\n\n",a+=r.method,r.method==="POST "?a+=(n.dataSource.insertUrl||n.dataSource.crudUrl||i.url)+r.url(e,o,i.key)+" HTTP/1.1\n":r.method==="PUT "||r.method==="PATCH "?a+=(n.dataSource.updateUrl||n.dataSource.crudUrl||i.url)+r.url(e,o,i.key)+" HTTP/1.1\n":r.method==="DELETE "&&(a+=(n.dataSource.removeUrl||n.dataSource.crudUrl||i.url)+r.url(e,o,i.key)+" HTTP/1.1\n"),a+="Accept: "+this.options.accept+"\n",a+="Content-Id: "+this.pvt.changeSet+++"\n",a+=this.options.batchChangeSetContentType+"\n",m(e[o]["@odata.etag"])?a+="\n":(a+="If-Match: "+e[o]["@odata.etag"]+"\n\n",delete e[o]["@odata.etag"]),a+=r.data(e,o);return a},t.prototype.processBatchResponse=function(e,i,r,n,a){if(r&&r.headers.get("Content-Type")&&r.headers.get("Content-Type").indexOf("xml")!==-1)return i.isCountRequired?{result:[],count:0}:[];if(n&&this.options.batch&&ue.endsWith(n.url,this.options.batch)&&n.type.toLowerCase()==="post"){var o=r.headers.get("Content-Type"),l=void 0,h=void 0,u=e+"";if(o=o.substring(o.indexOf("=batchresponse")+1),u=u.split(o),u.length<2)return{};u=u[1];var c=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(u);c&&u.replace(c[0],"");var f=c?c[1]:"";u=u.split(f);for(var d=u.length;d>-1;d--)!/\bContent-ID:/i.test(u[d])||!/\bHTTP.+201/.test(u[d])||(l=parseInt(/\bContent-ID: (\d+)/i.exec(u[d])[1],10),a.addedRecords[l]&&(h=ue.parse.parseJson(/^\{.+\}/m.exec(u[d])[0]),Ue({},a.addedRecords[l],this.processResponse(h))));return a}return null},t.prototype.compareAndRemove=function(e,i,r){var n=this;return m(i)||Object.keys(e).forEach(function(a){if(a!==r&&a!=="@odata.etag")if(ue.isPlainObject(e[a])){n.compareAndRemove(e[a],i[a]);var o=Object.keys(e[a]).filter(function(l){return l!=="@odata.etag"});o.length===0&&delete e[a]}else(e[a]===i[a]||e[a]&&i[a]&&e[a].valueOf()===i[a].valueOf())&&delete e[a]}),e},t}(Sa);(function(s){Vs(t,s);function t(e){var i=s.call(this,e)||this;return i.options=Ue({},i.options,{requestType:"get",accept:"application/json, text/javascript, */*; q=0.01",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$count",search:"$search",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PATCH",localTime:!1,apply:"$apply"}),Ue(i.options,e||{}),i}return t.prototype.getModuleName=function(){return"ODataV4Adaptor"},t.prototype.onCount=function(e){return e===!0?"true":""},t.prototype.onPredicate=function(e,i,r){var n="",a=e.value,o=a instanceof Date;if(i instanceof We)for(var l=this.getQueryRequest(i),h=0;h<l.filters.length;h++)l.filters[h].e.key===e.value&&(r=!0);return n=s.prototype.onPredicate.call(this,e,i,r),o&&(n=n.replace(/datetime'(.*)'$/,"$1")),ue.parse.isGuid(a)&&(n=n.replace("guid","").replace(/'/g,"")),n},t.prototype.onEachSearch=function(e){var i=this.pvt.searches||[];i.push(e.key),this.pvt.searches=i},t.prototype.onSearch=function(e){return this.pvt.searches.join(" OR ")},t.prototype.onExpand=function(e){var i=this,r={},n={},a=e.expands.slice(),o=[],l=e.selects.filter(function(h){return h.indexOf(".")>-1});return l.forEach(function(h){var u=h.split(".");if(u[0]in r||(r[u[0]]=[]),u.length===2)r[u[0]].length&&Object.keys(r).indexOf(u[0])!==-1?r[u[0]][0].indexOf("$expand")!==-1&&r[u[0]][0].indexOf(";$select=")===-1?r[u[0]][0]=r[u[0]][0]+";$select="+u[1]:r[u[0]][0]=r[u[0]][0]+","+u[1]:r[u[0]].push("$select="+u[1]);else{for(var c="$select="+u[u.length-1],f="",d="",p=1;p<u.length-1;p++)f=f+"$expand="+u[p]+"(",d=d+")";var v=f+c+d;if(r[u[0]].length&&Object.keys(r).indexOf(u[0])!==-1&&i.expandQueryIndex(r[u[0]],!0)){var g=i.expandQueryIndex(r[u[0]]);r[u[0]][g]=r[u[0]][g]+v.replace("$expand=",",")}else r[u[0]].push(v)}}),Object.keys(r).forEach(function(h){a.indexOf(h)===-1&&a.push(h)}),a.forEach(function(h){n[h]=h in r?h+"("+r[h].join(";")+")":h}),Object.keys(n).forEach(function(h){return o.push(n[h])}),o.join(",")},t.prototype.expandQueryIndex=function(e,i){for(var r=0;r<e.length;r++)if(e[r].indexOf("$expand")!==-1)return i?!0:r;return i?!1:0},t.prototype.onDistinct=function(e){var i=e.map(function(r){return xo.getField(r)}).join(",");return"groupby(("+i+"))"},t.prototype.onSelect=function(e){return s.prototype.onSelect.call(this,e.filter(function(i){return i.indexOf(".")===-1}))},t.prototype.beforeSend=function(e,i,r){(r.type==="POST"||r.type==="PUT"||r.type==="PATCH")&&i.headers.set("Prefer","return=representation"),i.headers.set("Accept",this.options.accept)},t.prototype.processResponse=function(e,i,r,n,a,o){var l="@odata.context",h="@context";if(a&&a.type==="GET"&&!this.rootUrl&&(e[l]||e[h])){var u=e[l]?e[l].split("/$metadata#"):e[h].split("/$metadata#");this.rootUrl=u[0],this.resourceTableName=u[1]}var c="pvtData",f=a&&a[c],d=s.prototype.processBatchResponse.call(this,e,r,n,a,o);if(d)return d;var p=null,v="@odata.count",g="@count";r&&r.isCountRequired&&(v in e?p=e[v]:g in e&&(p=e[g])),e=m(e.value)?e:e.value;var b={};return b.count=p,b.result=e,this.getAggregateResult(f,e,b,null,r),ue.isNull(p)?b.result:{result:b.result,count:p,aggregates:b.aggregates}},t})(xo);(function(s){Vs(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.getModuleName=function(){return"WebApiAdaptor"},t.prototype.insert=function(e,i,r){return{type:"POST",url:e.dataSource.url,data:JSON.stringify(i)}},t.prototype.remove=function(e,i,r,n){return{type:"DELETE",url:e.dataSource.url+"/"+r,data:JSON.stringify(r)}},t.prototype.update=function(e,i,r,n){return{type:"PUT",url:e.dataSource.url,data:JSON.stringify(r)}},t.prototype.batchRequest=function(e,i,r){var n=this,a=r.guid=ue.getGuid(this.options.batchPre),o=e.dataSource.url.replace(/\/*$/,"/"+this.options.batch);r.url=this.resourceTableName?this.resourceTableName:r.url;for(var l=[],h=function(p,v){i.addedRecords.forEach(function(g,b){var C={method:"POST ",url:function(y,x,w){return""},data:function(y,x){return JSON.stringify(y[x])+"\n\n"}};l.push("--"+a),l.push("Content-Type: application/http; msgtype=request",""),l.push("POST /api/"+(e.dataSource.insertUrl||e.dataSource.crudUrl||r.url)+C.url(i.addedRecords,p,r.key)+" HTTP/1.1"),l.push("Content-Type: application/json; charset=utf-8"),l.push("Host: "+location.host),l.push("",g?JSON.stringify(g):"")})},u=0,c=i.addedRecords.length;u<c;u++)h(u);for(var f=function(p,v){i.changedRecords.forEach(function(g,b){var C={method:n.options.updateType+" ",url:function(y,x,w){return""},data:function(y,x){return JSON.stringify(y[x])+"\n\n"}};l.push("--"+a),l.push("Content-Type: application/http; msgtype=request",""),l.push("PUT /api/"+(e.dataSource.updateUrl||e.dataSource.crudUrl||r.url)+C.url(i.changedRecords,p,r.key)+" HTTP/1.1"),l.push("Content-Type: application/json; charset=utf-8"),l.push("Host: "+location.host),l.push("",g?JSON.stringify(g):"")})},u=0,c=i.changedRecords.length;u<c;u++)f(u);for(var d=function(p,v){i.deletedRecords.forEach(function(g,b){var C={mtd:"DELETE ",url:function(y,x,w){var S=ue.getObject(w,y[x]);if(typeof S=="number"||ue.parse.isGuid(S))return"/"+S;if(S instanceof Date){var E=y[x][w];return"/"+E.toJSON()}else return"/'"+S+"'"},data:function(y,x){return""}};l.push("--"+a),l.push("Content-Type: application/http; msgtype=request",""),l.push("DELETE /api/"+(e.dataSource.removeUrl||e.dataSource.crudUrl||r.url)+C.url(i.deletedRecords,p,r.key)+" HTTP/1.1"),l.push("Content-Type: application/json; charset=utf-8"),l.push("Host: "+location.host),l.push("",g?JSON.stringify(g):"")})},u=0,c=i.deletedRecords.length;u<c;u++)d(u);return l.push("--"+a+"--",""),{type:"POST",url:o,contentType:"multipart/mixed; boundary="+a,data:l.join("\r\n")}},t.prototype.beforeSend=function(e,i,r){i.headers.set("Accept","application/json, text/javascript, */*; q=0.01")},t.prototype.processResponse=function(e,i,r,n,a,o){var l="pvtData",h=a&&a[l],u=null,c={};if(a&&a.type.toLowerCase()!=="post"){var f=n&&a.fetchRequest.headers.get("DataServiceVersion"),d=f&&parseInt(f,10)||2;r&&r.isCountRequired&&(ue.isNull(e.Count)||(u=e.Count)),d<3&&e.Items&&(e=e.Items),c.count=u,c.result=e,this.getAggregateResult(h,e,c,null,r)}return c.result=c.result||e,ue.isNull(u)?c.result:{result:c.result,count:c.count,aggregates:c.aggregates}},t})(xo);(function(s){Vs(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.processQuery=function(e,i,r){var n=new Sa().processQuery(e,i,r),a="data",o=ue.parse.parseJson(n[a]),l={},h="value";if(o.param)for(var u=0;u<o.param.length;u++){var c=o.param[u],f=Object.keys(c)[0];l[f]=c[f]}l[h]=o;var d="pvtData",p="url";return{data:JSON.stringify(l,ue.parse.jsonDateReplacer),url:n[p],pvtData:n[d],type:"POST",contentType:"application/json; charset=utf-8"}},t})(Sa);var rB=function(s){Vs(t,s);function t(){return s.call(this)||this}return t.prototype.insert=function(e,i,r,n,a){return this.pvt.position=a,this.updateType="add",{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Ue({},{value:i,table:r,action:"insert"},ue.getAddParams(this,e,n)))}},t.prototype.remove=function(e,i,r,n,a){return s.prototype.remove.call(this,e,i,r),{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Ue({},{key:r,keyColumn:i,table:n,action:"remove"},ue.getAddParams(this,e,a)))}},t.prototype.update=function(e,i,r,n,a){return this.updateType="update",this.updateKey=i,{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Ue({},{value:r,action:"update",keyColumn:i,key:r[i],table:n},ue.getAddParams(this,e,a)))}},t.prototype.processResponse=function(e,i,r,n,a,o,l){var h,u=a?JSON.parse(a.data):e;if(e=u.action==="batch"?ue.parse.parseJson(e):e,this.updateType==="add"&&s.prototype.insert.call(this,i,e,null,null,this.pvt.position),this.updateType==="update"&&s.prototype.update.call(this,i,this.updateKey,e),this.updateType=void 0,e.added)for(h=0;h<e.added.length;h++)s.prototype.insert.call(this,i,e.added[h]);if(e.changed)for(h=0;h<e.changed.length;h++)s.prototype.update.call(this,i,l.key,e.changed[h]);if(e.deleted)for(h=0;h<e.deleted.length;h++)s.prototype.remove.call(this,i,l.key,e.deleted[h]);return e},t.prototype.batchRequest=function(e,i,r,n,a){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(Ue({},{changed:i.changedRecords,added:i.addedRecords,deleted:i.deletedRecords,action:"batch",table:r.url,key:r.key},ue.getAddParams(this,e,n)))}},t.prototype.addParams=function(e){var i=new Sa;i.addParams(e)},t.prototype.beforeSend=function(e,i,r){},t}(dc),sB=function(s){Vs(t,s);function t(e){var i=s.call(this)||this;return i.options=Ue({},i.options,{getData:function(){},addRecord:function(){},updateRecord:function(){},deleteRecord:function(){},batchUpdate:function(){}}),Ue(i.options,e||{}),i}return t.prototype.getModuleName=function(){return"CustomDataAdaptor"},t}(Sa);(function(s){Vs(t,s);function t(e){var i=s.call(this)||this;return i.opt=e,i.schema=i.opt.response,i.query=i.opt.query,i.getVariables=i.opt.getVariables?i.opt.getVariables:function(){},i.getQuery=function(){return i.query},i}return t.prototype.getModuleName=function(){return"GraphQLAdaptor"},t.prototype.processQuery=function(e,i){var r=s.prototype.processQuery.apply(this,arguments),n=JSON.parse(r.data),a=["skip","take","sorted","table","select","where","search","requiresCounts","aggregates","params"],o={},l="searchwhereparams";a.filter(function(c){o[c]=l.indexOf(c)>-1?JSON.stringify(n[c]):n[c]});var h=this.getVariables()||{};h.datamanager=o;var u=JSON.stringify({query:this.getQuery(),variables:h});return r.data=u,r},t.prototype.processResponse=function(e,i,r,n,a){var o=e,l,h,u=ie(this.schema.result,o.data);this.schema.count&&(l=ie(this.schema.count,o.data)),this.schema.aggregates&&(h=ie(this.schema.aggregates,o.data),h=m(h)?h:ue.parse.parseJson(h));var c=a.pvtData||{},f={result:u,aggregates:h},d=f;return c&&c.groups&&c.groups.length&&this.getAggregateResult(c,d,f,null,r),m(l)?f.result:{result:f.result,count:l,aggregates:h}},t.prototype.insert=function(){var e=s.prototype.insert.apply(this,arguments);return this.generateCrudData(e,"insert")},t.prototype.update=function(){var e=s.prototype.update.apply(this,arguments);return this.generateCrudData(e,"update")},t.prototype.remove=function(){var e=s.prototype.remove.apply(this,arguments);return this.generateCrudData(e,"remove")},t.prototype.batchRequest=function(e,i,r,n,a){var o=s.prototype.batchRequest.apply(this,arguments),l=JSON.parse(o.data);return l.key=r.key,o.data=JSON.stringify(l),this.generateCrudData(o,"batch")},t.prototype.generateCrudData=function(e,i){var r=JSON.parse(e.data);return e.data=JSON.stringify({query:this.opt.getMutation(i),variables:r}),e},t})(Sa);var nB=function(s){Vs(t,s);function t(e,i,r){var n=s.call(this)||this;n.isCrudAction=!1,n.isInsertAction=!1,m(e)||(n.cacheAdaptor=e),n.pageSize=r,n.guidId=ue.getGuid("cacheAdaptor");var a={keys:[],results:[]};window.localStorage.setItem(n.guidId,JSON.stringify(a));var o=n.guidId;return m(i)||setInterval(function(){for(var l=ue.parse.parseJson(window.localStorage.getItem(o)),h=[],u=0;u<l.results.length;u++){var c=+new Date,f=+new Date(l.results[u].timeStamp);l.results[u].timeStamp=c-f,c-f>i&&h.push(u)}for(var u=0;u<h.length;u++)l.results.splice(h[u],1),l.keys.splice(h[u],1);window.localStorage.removeItem(o),window.localStorage.setItem(o,JSON.stringify(l))},i),n}return t.prototype.generateKey=function(e,i){var r=this.getQueryRequest(i),n=We.filterQueryLists(i.queries,["onSelect","onPage","onSkip","onTake","onRange"]),a=e,o="onPage";o in n&&(a+=n[o].pageIndex),r.sorts.forEach(function(f){a+=f.e.direction+f.e.fieldName}),r.groups.forEach(function(f){a+=f.e.fieldName}),r.searches.forEach(function(f){a+=f.e.searchKey});for(var l=0;l<r.filters.length;l++){var h=r.filters[l];if(h.e.isComplex){var u=i.clone();u.queries=[];for(var c=0;c<h.e.predicates.length;c++)u.queries.push({fn:"onWhere",e:h.e.predicates[c],filter:i.queries.filter});a+=h.e.condition+this.generateKey(e,u)}else a+=h.e.field+h.e.operator+h.e.value}return a},t.prototype.processQuery=function(e,i,r){var n=this.generateKey(e.dataSource.url,i),a=ue.parse.parseJson(window.localStorage.getItem(this.guidId)),o=a?a.results[a.keys.indexOf(n)]:null;return o!=null&&!this.isCrudAction&&!this.isInsertAction?o:(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0)))},t.prototype.processResponse=function(e,i,r,n,a,o){if(this.isInsertAction||a&&this.cacheAdaptor.options.batch&&ue.endsWith(a.url,this.cacheAdaptor.options.batch)&&a.type.toLowerCase()==="post")return this.cacheAdaptor.processResponse(e,i,r,n,a,o);e=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));var l=r?this.generateKey(i.dataSource.url,r):i.dataSource.url,h={};h=ue.parse.parseJson(window.localStorage.getItem(this.guidId));var u=h.keys.indexOf(l);for(u!==-1&&(h.results.splice(u,1),h.keys.splice(u,1)),h.results[h.keys.push(l)-1]={keys:l,result:e.result,timeStamp:new Date,count:e.count};h.results.length>this.pageSize;)h.results.splice(0,1),h.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(h)),e},t.prototype.beforeSend=function(e,i,r){!m(this.cacheAdaptor.options.batch)&&ue.endsWith(r.url,this.cacheAdaptor.options.batch)&&r.type.toLowerCase()==="post"&&i.headers.set("Accept",this.cacheAdaptor.options.multipartAccept),e.dataSource.crossDomain||i.headers.set("Accept",this.cacheAdaptor.options.accept)},t.prototype.update=function(e,i,r,n){return this.isCrudAction=!0,this.cacheAdaptor.update(e,i,r,n)},t.prototype.insert=function(e,i,r){return this.isInsertAction=!0,this.cacheAdaptor.insert(e,i,r)},t.prototype.remove=function(e,i,r,n){return this.isCrudAction=!0,this.cacheAdaptor.remove(e,i,r,n)},t.prototype.batchRequest=function(e,i,r){return this.cacheAdaptor.batchRequest(e,i,r)},t}(Sa),cu=function(s,t,e,i){return new(e||(e=Promise))(function(r,n){function a(h){try{l(i.next(h))}catch(u){n(u)}}function o(h){try{l(i.throw(h))}catch(u){n(u)}}function l(h){h.done?r(h.value):new e(function(u){u(h.value)}).then(a,o)}l((i=i.apply(s,t||[])).next())})},fu=function(s,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,r,n,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(h){return function(u){return l([h,u])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,r&&(n=h[0]&2?r.return:h[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,h[1])).done)return n;switch(r=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return e.label++,{value:h[1],done:!1};case 5:e.label++,r=h[1],h=[0];continue;case 7:h=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){e=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){e.label=h[1];break}if(h[0]===6&&e.label<n[1]){e.label=n[1],n=h;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(h);break}n[2]&&e.ops.pop(),e.trys.pop();continue}h=t.call(s,e)}catch(u){h=[6,u],r=0}finally{i=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},fe=function(){function s(t,e,i){var r=this;this.dateParse=!0,this.timeZoneHandling=!0,this.persistQuery={},this.isInitialLoad=!1,this.requests=[],this.isEnableCache=!1,this.isInitialLoad=!0,this.isEnableCache=!1,!t&&!this.dataSource&&(t=[]),i=i||t.adaptor,t&&t.timeZoneHandling===!1&&(this.timeZoneHandling=t.timeZoneHandling);var n;if(t instanceof Array?n={json:t,offline:!0}:typeof t=="object"?(t.json||(t.json=[]),t.enablePersistence||(t.enablePersistence=!1),t.id||(t.id=""),t.ignoreOnPersist||(t.ignoreOnPersist=[]),n={url:t.url,insertUrl:t.insertUrl,removeUrl:t.removeUrl,updateUrl:t.updateUrl,crudUrl:t.crudUrl,batchUrl:t.batchUrl,json:t.json,headers:t.headers,accept:t.accept,data:t.data,enableCache:t.enableCache,timeTillExpiration:t.timeTillExpiration,cachingPageSize:t.cachingPageSize,enableCaching:t.enableCaching,requestType:t.requestType,key:t.key,crossDomain:t.crossDomain,jsonp:t.jsonp,dataType:t.dataType,offline:t.offline!==void 0?t.offline:t.adaptor instanceof rB||t.adaptor instanceof sB?!1:!t.url,requiresFormat:t.requiresFormat,enablePersistence:t.enablePersistence,id:t.id,ignoreOnPersist:t.ignoreOnPersist}):ue.throwError("DataManager: Invalid arguments"),n.requiresFormat===void 0&&!ue.isCors()&&(n.requiresFormat=m(n.crossDomain)?!0:n.crossDomain),n.dataType===void 0&&(n.dataType="json"),this.isEnableCache=n.enableCache,this.dataSource=n,this.defaultQuery=e,this.dataSource.enablePersistence&&this.dataSource.id&&window.addEventListener("unload",this.setPersistData.bind(this)),n.url&&n.offline&&!n.json.length?(this.isDataAvailable=!1,this.adaptor=i||new xo,this.dataSource.offline=!1,this.ready=this.executeQuery(e||new We),this.ready.then(function(o){r.dataSource.offline=!0,r.isDataAvailable=!0,n.json=o.result,r.adaptor=new dc})):this.adaptor=n.offline?new dc:new xo,!n.jsonp&&this.adaptor instanceof xo&&(n.jsonp="callback"),this.adaptor=i||this.adaptor,this.isEnableCache){this.guidId=ue.getGuid("cacheAdaptor");var a={keys:[],results:[]};window.localStorage.setItem(this.guidId,JSON.stringify(a))}return n.enableCaching&&(this.adaptor=new nB(this.adaptor,n.timeTillExpiration,n.cachingPageSize)),this}return Object.defineProperty(s.prototype,"moduleName",{get:function(){return"datamanager"},enumerable:!0,configurable:!0}),s.prototype.getPersistedData=function(t){var e=localStorage.getItem(t||this.dataSource.id);return JSON.parse(e)},s.prototype.setPersistData=function(t,e,i){localStorage.setItem(e||this.dataSource.id,JSON.stringify(i||this.persistQuery))},s.prototype.setPersistQuery=function(t){var e=this,i=this.getPersistedData();if(this.isInitialLoad&&i&&Object.keys(i).length){this.persistQuery=i,this.persistQuery.queries=this.persistQuery.queries.filter(function(n){if(e.dataSource.ignoreOnPersist&&e.dataSource.ignoreOnPersist.length&&n.fn&&e.dataSource.ignoreOnPersist.some(function(l){return n.fn===l}))return!1;if(n.fn==="onWhere"){var a=n.e;if(a&&a.isComplex&&a.predicates instanceof Array){var o=a.predicates.map(function(l){if(l.predicates&&l.predicates instanceof Array){var h=l.predicates.map(function(g){var b=g.field,C=g.operator,y=g.value,x=g.ignoreCase,w=g.ignoreAccent,S=g.matchCase;return new ht(b,C,y,x,w,S)});return l.condition==="and"?ht.and(h):ht.or(h)}else{var u=l.field,c=l.operator,f=l.value,d=l.ignoreCase,p=l.ignoreAccent,v=l.matchCase;return new ht(u,c,f,d,p,v)}});n.e=new ht(o[0],a.condition,o.slice(1))}}return!0});var r=Ue(new We,this.persistQuery);return this.isInitialLoad=!1,r}else return this.persistQuery=t,this.isInitialLoad=!1,t},s.prototype.setDefaultQuery=function(t){return this.defaultQuery=t,this},s.prototype.executeLocal=function(t){!this.defaultQuery&&!(t instanceof We)&&ue.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||ue.throwError("DataManager - executeLocal() : Json data is required to execute"),this.dataSource.enablePersistence&&this.dataSource.id&&(t=this.setPersistQuery(t)),t=t||this.defaultQuery;var e=this.adaptor.processQuery(this,t);if(t.subQuery){var i=t.subQuery.fromTable,r=t.subQuery.lookups,n=t.isCountRequired?e.result:e;r&&r instanceof Array&&ue.buildHierarchy(t.subQuery.fKey,i,n,r,t.subQuery.key);for(var a=0;a<n.length;a++)n[a][i]instanceof Array&&(n[a]=Ue({},{},n[a]),n[a][i]=this.adaptor.processResponse(t.subQuery.using(new s(n[a][i].slice(0))).executeLocal(),this,t))}return this.adaptor.processResponse(e,this,t)},s.prototype.executeQuery=function(t,e,i,r){var n=this,a="makeRequest";this.dataSource.enablePersistence&&this.dataSource.id&&(t=this.setPersistQuery(t)),typeof t=="function"&&(r=i,i=e,e=t,t=null),t||(t=this.defaultQuery),t instanceof We||ue.throwError("DataManager - executeQuery() : A query is required to execute");var o=new dn,l={query:t};if(!this.dataSource.offline&&this.dataSource.url!==void 0&&this.dataSource.url!==""||!m(this.adaptor[a])||this.isCustomDataAdaptor(this.adaptor)){var h=this.isEnableCache?this.processQuery(t):this.adaptor.processQuery(this,t);m(this.adaptor[a])?!m(h.url)||this.isCustomDataAdaptor(this.adaptor)?(this.requests=[],this.makeRequest(h,o,l,t)):(l=s.getDeferedArgs(t,h,l),o.resolve(l)):this.adaptor[a](h,o,l,t)}else s.nextTick(function(){var u=n.executeLocal(t);l=s.getDeferedArgs(t,u,l),o.resolve(l)});return(e||i)&&o.promise.then(e,i),r&&o.promise.then(r,r),o.promise},s.prototype.getQueryRequest=function(t){var e={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return e.sorts=We.filterQueries(t.queries,"onSortBy"),e.groups=We.filterQueries(t.queries,"onGroup"),e.filters=We.filterQueries(t.queries,"onWhere"),e.searches=We.filterQueries(t.queries,"onSearch"),e.aggregates=We.filterQueries(t.queries,"onAggregates"),e},s.prototype.generateKey=function(t,e){var i=this.getQueryRequest(e),r=We.filterQueryLists(e.queries,["onSelect","onPage","onSkip","onTake","onRange"]),n=t,a="onPage";i.sorts.forEach(function(f){n+=f.e.direction+f.e.fieldName}),i.groups.forEach(function(f){n+=f.e.fieldName}),i.searches.forEach(function(f){n+=f.e.searchKey});for(var o=0;o<i.filters.length;o++){var l=i.filters[o];if(l.e.isComplex){var h=e.clone();h.queries=[];for(var u=0;u<l.e.predicates.length;u++)h.queries.push({fn:"onWhere",e:l.e.predicates[u],filter:e.queries.filter});n+=l.e.condition+this.generateKey(t,h)}else n+=l.e.field+l.e.operator+l.e.value}if(!m(this.previousCacheQuery)&&this.previousCacheQuery!==n){var c={keys:[],results:[]};window.localStorage.setItem(this.guidId,JSON.stringify(c))}return this.previousCacheQuery=n,a in r&&(n+=r[a].pageIndex),n},s.prototype.processQuery=function(t){var e=this.generateKey(this.dataSource.url,t),i=JSON.parse(window.localStorage.getItem(this.guidId)),r=i?i.results[i.keys.indexOf(e)]:null;return r!=null?ue.parse.parseJson(r):this.adaptor.processQuery(this,t)},s.getDeferedArgs=function(t,e,i){return t.isCountRequired?(i.result=e.result,i.count=e.count,i.aggregates=e.aggregates):i.result=e,i},s.nextTick=function(t){(window.setImmediate||window.setTimeout)(t,0)},s.prototype.extendRequest=function(t,e,i){return Ue({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:e,onFailure:i},t)},s.prototype.makeRequest=function(t,e,i,r){var n=this,a=!!r.subQuerySelector,o=function(g){i.error=g,e.reject(i)},l=function(g,b,C,y,x,w,S){i.xhr=C,i.count=b?parseInt(b.toString(),10):0,i.result=g,i.request=y,i.aggregates=w,i.actual=x,i.virtualSelectRecords=S,e.resolve(i)},h=function(g,b){var C=new dn,y={parent:i};r.subQuery.isChild=!0;var x=n.adaptor.processQuery(n,r.subQuery,g?n.adaptor.processResponse(g):b),w=n.makeRequest(x,C,y,r.subQuery);return a||C.then(function(S){g&&(ue.buildHierarchy(r.subQuery.fKey,r.subQuery.fromTable,g,S,r.subQuery.key),l(g,S.count,S.xhr))},o),w},u=function(g,b){if(n.isGraphQLAdaptor(n.adaptor)&&!m(g.errors))return o(g.errors);n.isCustomDataAdaptor(n.adaptor)&&(b=Ue({},n.fetchReqOption,b)),b.contentType.indexOf("xml")===-1&&n.dateParse&&!n.isEnableCache&&(g=ue.parse.parseJson(g));var C,y=n.afterReponseRequest(g);y.then(function(x){if(C=n.adaptor.processResponse(x,n,r,b.fetchRequest,b),n.isEnableCache){var w=r?n.generateKey(n.dataSource.url,r):n.dataSource.url,S={};S=JSON.parse(window.localStorage.getItem(n.guidId));var E=S.keys.indexOf(w);E!==-1&&(S.results.splice(E,1),S.keys.splice(E,1)),S.results[S.keys.push(w)-1]={keys:w,result:C.result,timeStamp:new Date,count:C.count},window.localStorage.setItem(n.guidId,JSON.stringify(S))}b.contentType.indexOf("xml")===-1&&n.dateParse&&n.isEnableCache&&(C=ue.parse.parseJson(C));var k=0,A=null,z="virtualSelectRecords",D=x[z];if(r.isCountRequired&&(k=C.count,A=C.aggregates,C=C.result),!r.subQuery){l(C,k,b.fetchRequest,b.type,x,A,D);return}a||h(C,b)}).catch(function(x){return n.dataManagerFailure(x,e,i)})},c=this.extendRequest(t,u,o);if(this.isCustomDataAdaptor(this.adaptor)){this.fetchReqOption=c;var p=c;this.adaptor.options.getData({data:p.data,onSuccess:p.onSuccess,onFailure:p.onFailure})}else{var f=this.useMiddleware(c),d;f.then(function(g){d=new Cf(c),d.beforeSend=function(){n.beforeSend(d.fetchRequest,d,g)},c=d.send(),c.catch(function(b){return!0}),n.requests.push(d)}).catch(function(g){return n.dataManagerFailure(g,e,i)})}if(a){var f=void 0,v=r.subQuerySelector.call(this,{query:r.subQuery,parent:r});v&&v.length?(f=Promise.all([c,h(null,v)]),f.then(function(){for(var b=[],C=0;C<arguments.length;C++)b[C]=arguments[C];var y=b[0],x=n.adaptor.processResponse(y[0],n,r,n.requests[0].fetchRequest,n.requests[0]),w=0;r.isCountRequired&&(w=x.count,x=x.result);var S=n.adaptor.processResponse(y[1],n,r.subQuery,n.requests[1].fetchRequest,n.requests[1]);w=0,r.subQuery.isCountRequired&&(w=S.count,S=S.result),ue.buildHierarchy(r.subQuery.fKey,r.subQuery.fromTable,x,S,r.subQuery.key),a=!1,l(x,w,n.requests[0].fetchRequest)})):a=!1}return c},s.prototype.dataManagerFailure=function(t,e,i){i.error=t,e.reject(i)},s.prototype.afterReponseRequest=function(t){return cu(this,void 0,void 0,function(){var e,i;return fu(this,function(r){switch(r.label){case 0:return[4,this.applyPostRequestMiddlewares(t)];case 1:return e=r.sent(),i=new dn,i.resolve(e),[2,i.promise]}})})},s.prototype.applyPostRequestMiddlewares=function(t){return cu(this,void 0,void 0,function(){return fu(this,function(e){return[2,t]})})},s.prototype.useMiddleware=function(t){return cu(this,void 0,void 0,function(){var e,i;return fu(this,function(r){switch(r.label){case 0:return[4,this.applyPreRequestMiddlewares(t)];case 1:return e=r.sent(),i=new dn,i.resolve(e),[2,i.promise]}})})},s.prototype.applyPreRequestMiddlewares=function(t){return cu(this,void 0,void 0,function(){return fu(this,function(e){return[2,t]})})},s.prototype.beforeSend=function(t,e,i){this.adaptor.beforeSend(this,t,e);var r=[];this.dataSource.headers&&(r=r.concat(this.dataSource.headers));var n;i&&i.headers&&(r=r.concat(i.headers));for(var a=0;r&&a<r.length;a++){n=[];for(var o=Object.keys(r[a]),l=0,h=o;l<h.length;l++){var u=h[l];n.push(u),t.headers.set(u,r[a][u])}}},s.prototype.saveChanges=function(t,e,i,r,n){var a=this;i instanceof We&&(r=i,i=null);var o={url:i,key:e||this.dataSource.key},l=this.adaptor.batchRequest(this,t,o,r||new We,n),h="dofetchRequest";if(this.dataSource.offline)return l;if(m(this.adaptor[h])){if(this.isCustomDataAdaptor(this.adaptor))return this.dofetchRequest(l,this.adaptor.options.batchUpdate,t);var u=new dn,c=new Cf(l);return c.beforeSend=function(){a.beforeSend(c.fetchRequest,c)},c.onSuccess=function(f,d){a.isGraphQLAdaptor(a.adaptor)&&(m(f.errors)||c.onFailure(JSON.stringify(f.errors))),u.resolve(a.adaptor.processResponse(f,a,null,d.fetchRequest,d,t,o))},c.onFailure=function(f){u.reject([{error:f}])},c.send().catch(function(f){return!0}),u.promise}else return this.adaptor[h](l)},s.prototype.insert=function(t,e,i,r){e instanceof We&&(i=e,e=null);var n=this.adaptor.insert(this,t,e,i,r),a="dofetchRequest";return this.dataSource.offline?n:m(this.adaptor[a])?this.dofetchRequest(n,this.adaptor.options.addRecord):this.adaptor[a](n)},s.prototype.remove=function(t,e,i,r){typeof e=="object"&&(e=ue.getObject(t,e)),i instanceof We&&(r=i,i=null);var n=this.adaptor.remove(this,t,e,i,r),a="dofetchRequest";if(this.dataSource.offline)return n;if(m(this.adaptor[a])){var o=this.adaptor.options.deleteRecord;return this.dofetchRequest(n,o)}else return this.adaptor[a](n)},s.prototype.update=function(t,e,i,r,n){i instanceof We&&(r=i,i=null),this.isEnableCache&&(this.cacheQuery=this.generateKey(this.dataSource.url,r));var a=this.adaptor.update(this,t,e,i,r,n),o="dofetchRequest";if(this.dataSource.offline)return a;if(m(this.adaptor[o])){var l=this.adaptor.options.updateRecord;return this.dofetchRequest(a,l)}else return this.adaptor[o](a)},s.prototype.isCustomDataAdaptor=function(t){return this.adaptor.getModuleName&&this.adaptor.getModuleName()==="CustomDataAdaptor"},s.prototype.isGraphQLAdaptor=function(t){return this.adaptor.getModuleName&&this.adaptor.getModuleName()==="GraphQLAdaptor"},s.prototype.successFunc=function(t,e,i){if(this.isGraphQLAdaptor(this.adaptor)){var r=typeof t=="object"?t:JSON.parse(t);m(r.errors)||this.failureFunc(JSON.stringify(r.errors))}this.isCustomDataAdaptor(this.adaptor)&&(e=Ue({},this.fetchReqOption,e));try{ue.parse.parseJson(t)}catch(u){t=[]}if(this.isEnableCache){var n=JSON.parse(e.data);if(n.action==="insert"||n.action==="remove"){var a={keys:[],results:[]};window.localStorage.setItem(this.guidId,JSON.stringify(a))}else if(n.action==="update"){var o=JSON.parse(window.localStorage.getItem(this.guidId)),r=o?o.results[o.keys.indexOf(this.cacheQuery)]:null;if(r&&r.result){for(var l=r.result,h=0;h<l.length;h++)if(l[h][n.keyColumn]===n.key){l[h]=n.value,window.localStorage.setItem(this.guidId,JSON.stringify(o));break}}}}t=this.adaptor.processResponse(ue.parse.parseJson(t),this,null,e.fetchRequest,e,i),this.fetchDeffered.resolve(t)},s.prototype.failureFunc=function(t){this.isEnableCache&&(this.cacheQuery=""),this.fetchDeffered.reject([{error:t}])},s.prototype.dofetchRequest=function(t,e,i){var r=this;if(t=Ue({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},t),this.fetchDeffered=new dn,this.isCustomDataAdaptor(this.adaptor))this.fetchReqOption=t,e.call(this,{data:t.data,onSuccess:this.successFunc.bind(this),onFailure:this.failureFunc.bind(this),changes:i});else{var n=new Cf(t);n.beforeSend=function(){r.beforeSend(n.fetchRequest,n)},n.onSuccess=this.successFunc.bind(this),n.onFailure=this.failureFunc.bind(this),n.send().catch(function(a){return!0})}return this.fetchDeffered.promise},s.prototype.clearPersistence=function(){window.removeEventListener("unload",this.setPersistData.bind(this)),this.dataSource.enablePersistence=!1,this.persistQuery={},window.localStorage.setItem(this.dataSource.id,"[]")},s}(),dn=function(){function s(){var t=this;this.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}return s}();const pw=(s,t)=>{if(s)return s.split(".").reduce((e,i)=>e==null?void 0:e[i],t)},aB=(s,t,e)=>{if(!s)return[];const i=s.split("."),r=(n,a)=>{if(n==null)return[];const o=i[a];if(a===i.length-1){if(Array.isArray(n))return n.flatMap(c=>{if(c==null)return[];const f=c[o];if(f===void 0)return[];const d=c[e];return[{groupKey:f,matchKeyValue:d}]});const h=n==null?void 0:n[o];if(h===void 0)return[];const u=n==null?void 0:n[e];return[{groupKey:h,matchKeyValue:u}]}const l=n==null?void 0:n[o];return l==null?[]:Array.isArray(l)?l.flatMap(h=>r(h,a+1)):r(l,a+1)};return r(t,0)},WQ=(s,t,e="n/a",i=void 0,r="key")=>{var a;const n=new Map;for(const o of s){const l=aB(t,o,r),h=l.length>0?l:[{groupKey:e,groupLabel:e,matchKeyValue:null}];for(const{groupKey:u,matchKeyValue:c}of h){const f=u!=null?u:e;if(!n.has(f)){const d=i&&(a=pw(i,o))!=null?a:f;n.set(f,{parentKey:c!=null?c:null,groupLabel:d,items:[]})}n.get(f).items.push(o)}}return n},zQ=(s,t)=>{if(!t||!t.columns||t.columns.length===0)return s.map(i=>Object.values(i).filter(r=>r!=null&&(typeof r=="string"||typeof r=="number"||typeof r=="boolean")).map(r=>String(r).toLowerCase()).join(" "));const e=t.columns.map(i=>typeof i.field=="string"?i.field:void 0).filter(Boolean);return s.map(i=>{const r=[];for(const n of e){const a=pw(n,i);if(a!=null)if(Array.isArray(a))for(const o of a)o!=null&&r.push(String(o).toLowerCase());else typeof a=="object"?Object.values(a).forEach(o=>o!=null&&r.push(String(o).toLowerCase())):r.push(String(a).toLowerCase())}return r.join(" ")})},oB=(s,t,e)=>{if(!e)return s;const i=e.trim().toLowerCase();return s.filter((r,n)=>{var a;return(a=t[n])==null?void 0:a.includes(i)})},jQ=(s,t,e,i=[])=>{let r=oB(s,i,t);return e&&(r=new fe(r).executeLocal(new We().where(e))),r},ji=[];for(let s=0;s<256;++s)ji.push((s+256).toString(16).slice(1));function lB(s,t=0){return(ji[s[t+0]]+ji[s[t+1]]+ji[s[t+2]]+ji[s[t+3]]+"-"+ji[s[t+4]]+ji[s[t+5]]+"-"+ji[s[t+6]]+ji[s[t+7]]+"-"+ji[s[t+8]]+ji[s[t+9]]+"-"+ji[s[t+10]]+ji[s[t+11]]+ji[s[t+12]]+ji[s[t+13]]+ji[s[t+14]]+ji[s[t+15]]).toLowerCase()}let Bf;const hB=new Uint8Array(16);function uB(){if(!Bf){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Bf=crypto.getRandomValues.bind(crypto)}return Bf(hB)}const cB=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),jg={randomUUID:cB};function fB(s,t,e){if(jg.randomUUID&&!t&&!s)return jg.randomUUID();s=s||{};const i=s.random||(s.rng||uB)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,lB(i)}var dB=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),pB=["alt","className","disabled","form","id","readOnly","style","tabIndex","title","type","name","onClick","onFocus","onBlur"],mB=["accordion","tab","splitter"],vB=/\]/,gB=function(s){dB(t,s);function t(){var e=s!==null&&s.apply(this,arguments)||this;return e.mountingState=!1,e.attrKeys=[],e.cachedTimeOut=0,e.isAppendCalled=!1,e.initRenderCalled=!1,e.isReactForeceUpdate=!1,e.isReact=!0,e.isshouldComponentUpdateCalled=!1,e.isCreated=!1,e}return t.prototype.componentDidMount=function(){this.refreshChild(!0),this.canDelayUpdate=mB.indexOf(this.getModuleName())!==-1,this.renderReactComponent(),this.portals&&this.portals.length&&(this.mountingState=!0,this.renderReactTemplates(),this.mountingState=!1)},t.prototype.componentDidUpdate=function(e){!this.isshouldComponentUpdateCalled&&this.initRenderCalled&&!this.isReactForeceUpdate&&e!==this.props&&(this.isshouldComponentUpdateCalled=!0,this.updateProperties(this.props,!1,e))},t.prototype.renderReactComponent=function(){var e=this.reactElement;e&&!this.isAppendCalled&&(this.isAppendCalled=!0,this.appendTo(e))},t.prototype.shouldComponentUpdate=function(e){return this.isshouldComponentUpdateCalled=!0,this.initRenderCalled?(this.isAppendCalled||(clearTimeout(this.cachedTimeOut),this.isAppendCalled=!0,this.appendTo(this.reactElement)),this.updateProperties(e),!0):(this.updateProperties(e,!0),!0)},t.prototype.updateProperties=function(e,i,r){for(var n=this,a=Ue({},e),o=Object.keys(e),l=Ue({},r||this.props),h=m(l.statelessTemplates)?m(this.statelessTemplateProps)?[]:this.statelessTemplateProps:l.statelessTemplates,u=0,c=o;u<c.length;u++){var f=c[u],d=f==="className";if(f!=="children")if(!d&&!m(this.htmlattributes[""+f])&&this.htmlattributes[""+f]!==a[""+f]&&(this.htmlattributes[""+f]=a[""+f]),this.compareValues(l[""+f],e[""+f]))delete a[""+f];else if(this.attrKeys.indexOf(f)!==-1)if(d){this.clsName=!0;for(var p=l[""+f].split(" "),v=0;v<p.length;v++)this.element.classList.remove(p[parseInt(v.toString(),10)]);for(var g=a[""+f].split(" "),b=0;b<g.length;b++)this.element.classList.add(g[parseInt(b.toString(),10)])}else f!=="disabled"&&!Object.prototype.hasOwnProperty.call(this.properties,f)&&delete a[""+f];else(f==="value"&&e[""+f]===this[""+f]||h.indexOf(f)>-1&&(f==="content"&&typeof a[""+f]=="function"||e[""+f].toString()===this[""+f].toString()))&&delete a[""+f]}a.children&&delete a.children,this.initRenderCalled&&(this.canDelayUpdate||l.delayUpdate)?setTimeout(function(){n.refreshProperties(a,e,i)}):this.refreshProperties(a,e,i)},t.prototype.refreshProperties=function(e,i,r){var n=m(this.props.statelessTemplates)?[]:this.props.statelessTemplates;Object.keys(e).length&&(r||this.processComplexTemplate(e,this),this.setProperties(e,r)),n.indexOf("directiveTemplates")===-1&&this.refreshChild(r,i)},t.prototype.processComplexTemplate=function(e,i){var r=i.complexTemplate;if(r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var a=r[""+n];e[""+n]&&It(a,ie(n,e),e)}}},t.prototype.getDefaultAttributes=function(){var e=this;this.isReact=!0;var i=Object.keys(this.props),r=["children","statelessTemplates","immediateRender","isLegacyTemplate","delayUpdate"];this.htmlattributes||(this.htmlattributes={}),this.attrKeys=pB.concat(this.controlAttributes||[]);for(var n=0,a=i;n<a.length;n++){var o=a[n];(o.indexOf("data-")!==-1||o.indexOf("aria-")!==-1||this.attrKeys.indexOf(o)!==-1||Object.keys(this.properties).indexOf(""+o)===-1&&r.indexOf(""+o)===-1)&&this.htmlattributes[""+o]!==this.props[""+o]&&(this.htmlattributes[""+o]=this.props[""+o])}if(!this.htmlattributes.ref){this.htmlattributes.ref=function(f){e.reactElement=f};var l=["autocomplete","combobox","dropdownlist","dropdowntree","multiselect","listbox","colorpicker","numerictextbox","textbox","smarttextarea","uploader","maskedtextbox","slider","datepicker","datetimepicker","daterangepicker","timepicker","checkbox","switch","radio","rating","textarea","multicolumncombobox"];l.indexOf(this.getModuleName())!==-1&&(this.htmlattributes.key=""+t.reactUid,t.reactUid++,this.type&&!this.htmlattributes.type&&(this.htmlattributes.type=this.multiline?"hidden":this.type),this.name&&!this.htmlattributes.name&&(this.htmlattributes.name=this.name))}if(this.clsName)for(var h=this.element.classList,u=this.htmlattributes.className,c=0;c<h.length;c++)u.indexOf(h[parseInt(c.toString(),10)])===-1&&(this.htmlattributes.className=this.htmlattributes.className+" "+h[parseInt(c.toString(),10)]);return this.htmlattributes},t.prototype.trigger=function(e,i,r){var n=this;if(this.isDestroyed!==!0&&this.modelObserver){if(vB.test(e)){var a=ie(e,this);a?(a.call(this,i),r&&r.call(this,i)):r&&r.call(this,i)}(e==="change"||e==="input")&&this.props.onChange&&i.event&&this.props.onChange.call(void 0,{syntheticEvent:i.event,nativeEvent:{text:i.value},value:i.value,target:this});var o=this.isProtectedOnChange;this.isProtectedOnChange=!1,e==="created"?setTimeout(function(){n.isCreated=!0,n.isDestroyed||n.modelObserver.notify(e,i,r)},10):this.modelObserver.notify(e,i,r),this.isProtectedOnChange=o}},t.prototype.compareValues=function(e,i){var r=typeof e,n=typeof i;if(r===n){if(e===i)return!0;if((!m(e)&&e.constructor)!==(!m(i)&&i.constructor))return!1;if(e instanceof Date||e instanceof RegExp||e instanceof String||e instanceof Number)return e.toString()===i.toString();if(m0(e)||Array.isArray(e)){var a=e,o=i;return m0(a)&&(a=[e],o=[i]),this.compareObjects(a,o).status}if(e.moduleName&&e.moduleName===i.moduleName&&(e.moduleName==="query"||e.moduleName==="datamanager")&&JSON.stringify(e)===JSON.stringify(i))return!0}return!1},t.prototype.compareObjects=function(e,i,r){var n=!0,a=e.length===i.length,o=[],l=m(this.templateProps)?[]:this.templateProps;if(a)for(var h=0,u=i.length;h<u;h++){var c={},f=e[parseInt(h.toString(),10)],d=i[parseInt(h.toString(),10)],p=Object.keys(d);if(p.length!==0)for(var v=0,g=p;v<g.length;v++){var b=g[v],C=f[""+b],y=d[""+b];if(b==="items"){for(var x=0;x<y.length;x++)if(this.getModuleName()==="richtexteditor"&&typeof y[parseInt(x.toString(),10)]=="object")return{status:!0}}if(this.getModuleName()==="grid"&&b==="field"&&(c[""+b]=y),!Object.prototype.hasOwnProperty.call(f,b)||!(l.length>0&&l.indexOf(""+b)===-1&&typeof y=="function"?this.compareValues(C.toString(),y.toString()):this.compareValues(C,y))){if(!r)return{status:!1};n=!1,c[""+b]=y}}else if(i[parseInt(h.toString(),10)]===e[parseInt(h.toString(),10)])n=!0;else{if(!r)return{status:!1};n=!1}this.getModuleName()==="grid"&&r==="columns"&&m(c.field)&&(c.field=void 0),Object.keys(c).length&&o.push({index:h,value:c,key:r})}else n=!1;return{status:n,changedProperties:o}},t.prototype.refreshChild=function(e,i){if(this.checkInjectedModules){for(var r=this.getInjectedModules()||[],n=this.getInjectedServices()||[],a=0,o=n;a<o.length;a++){var l=o[a];r.indexOf(l)===-1&&r.push(l)}this.injectedModules=r}if(this.directivekeys){var h=[],u="",c=this.validateChildren({},this.directivekeys,i||this.props);if(c&&Object.keys(c).length){if(!e&&this.skipRefresh)for(var f=0,d=this.skipRefresh;f<d.length;f++){var p=d[f];delete c[""+p]}if(this.prevProperties){for(var v=Object.keys(this.prevProperties),g=0;g<v.length;g++)if(u=v[parseInt(g.toString(),10)],!!Object.prototype.hasOwnProperty.call(c,u)){var b=this.compareObjects(this.prevProperties[""+u],c[""+u],u);if(b.status)delete c[""+u];else{b.changedProperties.length&&(h=h.concat(b.changedProperties));var C={};C[""+u]=c[""+u],this.prevProperties=Ue(this.prevProperties,C)}}}else this.prevProperties=Ue({},c,{},!0);if(h.length)if(this.getModuleName()==="grid"&&u==="columns")for(var y=0,x=this.columns;y<x.length;y++){var w=ie("field",x[parseInt(y.toString(),10)]),S=ie(y+".value.field",h);if(w===S){var E=ie(h[parseInt(y.toString(),10)].key+"."+h[parseInt(y.toString(),10)].index,this);E&&E.setProperties?E.setProperties(h[parseInt(y.toString(),10)].value):Ue(E,h[parseInt(y.toString(),10)].value)}else this.setProperties(c,e)}else for(var k=0,A=h;k<A.length;k++){var z=A[k],E=ie(z.key+"."+z.index,this);E&&E.setProperties?E.setProperties(z.value):Ue(E,z.value)}else this.setProperties(c,e)}}},t.prototype.componentWillUnmount=function(){clearTimeout(this.cachedTimeOut);var e=["dropdowntree","checkbox"],i=e.indexOf(this.getModuleName())?!0:document.body.contains(this.element);this.initRenderCalled&&this.isAppendCalled&&this.element&&i&&!this.isDestroyed&&this.isCreated&&this.destroy(),FS.offIntlEvents()},t.prototype.appendReactElement=function(e,i){var r=R1.createPortal(e,i);this.portals?this.portals.push(r):this.portals=[r]},t.prototype.renderReactTemplates=function(e){this.isReactForeceUpdate=!0,e?this.forceUpdate(e):this.forceUpdate(),this.isReactForeceUpdate=!1},t.prototype.clearTemplate=function(e,i,r){var n=this;e&&e.length?Array.prototype.forEach.call(e,function(a){if(n.portals.forEach(function(l){l.propName}),!m(i)&&n.portals[i]&&n.portals[i].propName===a)n.portals.splice(i,1);else for(var o=0;o<n.portals.length;o++)n.portals[parseInt(o.toString(),10)].propName===a&&(n.portals.splice(o,1),o--)}):this.portals=[],this.renderReactTemplates(r)},t.prototype.validateChildren=function(e,i,r){for(var n=!1,a=_e.Children.toArray(r.children),o=0,l=a;o<l.length;o++){var h=l[o],u=this.getChildType(h),c=i[""+u];if(u&&i){var f=this.getChildProps(_e.Children.toArray(h.props.children),c);f.length&&(n=!0,e[h.type.propertyName||u]=f)}}return n?e:null},t.prototype.getChildType=function(e){return e.type&&e.type.isDirective&&e.type.moduleName||""},t.prototype.getChildProps=function(e,i){for(var r=[],n=0,a=e;n<a.length;n++){var o=a[n],l=!1,h=void 0;typeof i=="string"?(l=!0,h=i):h=Object.keys(i)[0];var u=o.props,c=this.getChildType(o);if(c===h)if(l||!u.children){var f=Ue({},u,{},!0);this.processComplexTemplate(f,o.type),r.push(f)}else{var d=this.validateChildren(Ue({},u),i[""+h],u)||u;d.children&&delete d.children,this.processComplexTemplate(d,o.type),r.push(d)}}return r},t.prototype.getInjectedServices=function(){for(var e=_e.Children.toArray(this.props.children),i=0,r=e;i<r.length;i++){var n=r[i];if(n.type&&n.type.isService)return n.props.services}return[]},t.reactUid=1,t}(_e.Component);function bB(s,t){t.forEach(function(e){Object.getOwnPropertyNames(e.prototype).forEach(function(i){i!=="isMounted"&&i!=="replaceState"&&i!=="render"&&(s.prototype[""+i]=e.prototype[""+i])})})}var yB=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();(function(s){yB(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.render=function(){return null},t.isDirective=!0,t})(_e.PureComponent);var xB=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();(function(s){xB(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.render=function(){return null},t.isService=!0,t})(_e.PureComponent);var CB=NS();function wB(s,t){return typeof s=="string"||s.prototype&&s.prototype.CSPTemplate&&typeof s=="function"?CB(s,t):function(e,i,r,n){var a=s,o=e;typeof a=="object"&&(a=s.template,o=Ue({},e,s.data||{}));var l;n?l=n:l=document.createElement("div");var h=_e.createElement(a,o),u=R1.createPortal(h,l);if(u.propName=r,i.portals?i.portals.push(u):i.portals=[u],!n)return[l]}}MS({compile:wB});function mw(s,t,e,i,r,n){var a=i;if(i.tagName===t){var o=ie("ej2_instances",i);a=s("input",{attrs:{type:e}});for(var l=["change","cssClass","label","labelPosition","id"],h=0,u=i.attributes.length;h<u;h++)l.indexOf(i.attributes[h].nodeName)===-1&&a.setAttribute(i.attributes[h].nodeName,i.attributes[h].nodeValue);Pe(i,{class:r}),i.appendChild(a),i.classList.add(n),i.classList.remove(n),It("ej2_instances",o,a),I1(i,"ej2_instances")}return a}function EB(s){for(var t,e=s.childNodes,i=0;i<e.length;i++)if(t=e[i],t.nodeType===3)return t;return null}function ov(s,t,e){e===void 0&&(e={});var i=s("div",{className:"e-checkbox-wrapper e-css"});e.cssClass&&P([i],e.cssClass.split(" ")),e.enableRtl&&i.classList.add("e-rtl");{var r=s("span",{className:"e-ripple-container"});os(r,{isCenterRipple:!0,duration:400}),i.appendChild(r)}var n=s("span",{className:"e-frame e-icons"});if(e.checked&&n.classList.add("e-check"),i.appendChild(n),e.label){var a=s("span",{className:"e-label"});e.disableHtmlEncode?a.textContent=e.label:a.innerHTML=e.label,i.appendChild(a)}return i}function da(s,t){if(t){var e=document.createEvent("MouseEvents");e.initEvent(s.type,!1,!0),t.dispatchEvent(e)}}function SB(s,t){s.element.getAttribute("ejs-for")&&t.appendChild(s.createElement("input",{attrs:{name:s.name||s.element.name,value:"false",type:"hidden"}}))}var kB=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),bs=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Ug;(function(s){s.Left="Left",s.Right="Right",s.Top="Top",s.Bottom="Bottom"})(Ug||(Ug={}));var Kr={RTL:"e-rtl",BUTTON:"e-btn",PRIMARY:"e-primary",ICONBTN:"e-icon-btn"},Tl=function(s){kB(t,s);function t(e,i){return s.call(this,e,i)||this}return t.prototype.preRender=function(){},t.prototype.render=function(){this.initialize(),this.removeRippleEffect=os(this.element,{selector:"."+Kr.BUTTON}),this.renderComplete()},t.prototype.initialize=function(){this.cssClass&&P([this.element],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPrimary&&this.element.classList.add(Kr.PRIMARY);{if(this.content){var e=this.enableHtmlSanitizer?mr.sanitize(this.content):this.content;this.element.innerHTML=e}this.setIconCss()}this.enableRtl&&this.element.classList.add(Kr.RTL),this.disabled?this.controlStatus(this.disabled):this.wireEvents()},t.prototype.controlStatus=function(e){this.element.disabled=e},t.prototype.setIconCss=function(){if(this.iconCss){var e=this.createElement("span",{className:"e-btn-icon "+this.iconCss});this.element.textContent.trim()?(e.classList.add("e-icon-"+this.iconPosition.toLowerCase()),(this.iconPosition==="Top"||this.iconPosition==="Bottom")&&this.element.classList.add("e-"+this.iconPosition.toLowerCase()+"-icon-btn")):this.element.classList.add(Kr.ICONBTN);var i=this.element.childNodes[0];i&&(this.iconPosition==="Left"||this.iconPosition==="Top")?this.element.insertBefore(e,i):this.element.appendChild(e)}},t.prototype.wireEvents=function(){this.isToggle&&R.add(this.element,"click",this.btnClickHandler,this)},t.prototype.unWireEvents=function(){this.isToggle&&R.remove(this.element,"click",this.btnClickHandler)},t.prototype.btnClickHandler=function(){this.element.classList.contains("e-active")?this.element.classList.remove("e-active"):this.element.classList.add("e-active")},t.prototype.destroy=function(){var e=[Kr.PRIMARY,Kr.RTL,Kr.ICONBTN,"e-success","e-info","e-danger","e-warning","e-flat","e-outline","e-small","e-bigger","e-active","e-round","e-top-icon-btn","e-bottom-icon-btn"];this.cssClass&&(e=e.concat(this.cssClass.split(/\s+/).filter(function(r){return r.length>0}))),s.prototype.destroy.call(this),Z([this.element],e),this.element.getAttribute("class")||this.element.removeAttribute("class"),this.disabled&&this.element.removeAttribute("disabled"),this.content&&(this.element.innerHTML=this.element.innerHTML.replace(this.content,""));var i=this.element.querySelector("span.e-btn-icon");i&&Oe(i),this.unWireEvents()},t.prototype.getModuleName=function(){return"btn"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.Inject=function(){},t.prototype.onPropertyChanged=function(e,i){for(var r=this.element.querySelector("span.e-btn-icon"),n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];switch(o){case"isPrimary":e.isPrimary?this.element.classList.add(Kr.PRIMARY):this.element.classList.remove(Kr.PRIMARY);break;case"disabled":this.controlStatus(e.disabled);break;case"iconCss":{r=this.element.querySelector("span.e-btn-icon"),r?e.iconCss?(r.className="e-btn-icon "+e.iconCss,this.element.textContent.trim()&&(this.iconPosition==="Left"?r.classList.add("e-icon-left"):r.classList.add("e-icon-right"))):Oe(r):this.setIconCss();break}case"iconPosition":Z([this.element],["e-top-icon-btn","e-bottom-icon-btn"]),r=this.element.querySelector("span.e-btn-icon"),r&&Oe(r),this.setIconCss();break;case"cssClass":i.cssClass&&Z([this.element],i.cssClass.split(/\s+/).filter(function(h){return h.length>0})),e.cssClass&&P([this.element],e.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":e.enableRtl?this.element.classList.add(Kr.RTL):this.element.classList.remove(Kr.RTL);break;case"content":{var l=EB(this.element);l||this.element.classList.remove(Kr.ICONBTN),this.enableHtmlSanitizer&&(e.content=mr.sanitize(e.content)),this.element.innerHTML=e.content,this.setIconCss();break}case"isToggle":e.isToggle?R.add(this.element,"click",this.btnClickHandler,this):(R.remove(this.element,"click",this.btnClickHandler),Z([this.element],["e-active"]));break}}},t.prototype.click=function(){this.element.click()},t.prototype.focusIn=function(){this.element.focus()},bs([O("Left")],t.prototype,"iconPosition",void 0),bs([O("")],t.prototype,"iconCss",void 0),bs([O(!1)],t.prototype,"disabled",void 0),bs([O(!1)],t.prototype,"isPrimary",void 0),bs([O("")],t.prototype,"cssClass",void 0),bs([O("")],t.prototype,"content",void 0),bs([O(!1)],t.prototype,"isToggle",void 0),bs([O()],t.prototype,"locale",void 0),bs([O(!0)],t.prototype,"enableHtmlSanitizer",void 0),bs([Se()],t.prototype,"created",void 0),t=bs([Wi],t),t}(Rr),TB=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Fr=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Hf="e-check",$g="e-checkbox-disabled",tl="e-frame",Vf="e-stop",Wf="e-label",zf="e-ripple-container",jf="e-rtl",Uf="e-checkbox-wrapper",AB=["title","class","style","disabled","readonly","name","value","id","tabindex","aria-label","required"],OB=function(s){TB(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.isFocused=!1,r.isMouseClick=!1,r.clickTriggered=!1,r.validCheck=!0,r.type="checkbox",r}return t.prototype.changeState=function(e,i,r){var n=this.getWrapper(),a=null;n&&(a=n.getElementsByClassName(tl)[0]),e==="check"?(a&&(a.classList.remove(Vf),a.classList.add(Hf)),this.element.checked=!0,(this.element.required||X(this.element,"form")&&X(this.element,"form").classList.contains("e-formvalidator"))&&this.validCheck&&!i&&r?(this.element.checked=!1,this.validCheck=!1):(this.element.required||X(this.element,"form")&&X(this.element,"form").classList.contains("e-formvalidator"))&&(this.validCheck=!0)):e==="uncheck"?(a&&Z([a],[Hf,Vf]),this.element.checked=!1,(this.element.required||X(this.element,"form")&&X(this.element,"form").classList.contains("e-formvalidator"))&&this.validCheck&&!i&&r?(this.element.checked=!0,this.validCheck=!1):(this.element.required||X(this.element,"form")&&X(this.element,"form").classList.contains("e-formvalidator"))&&(this.validCheck=!0)):(a&&(a.classList.remove(Hf),a.classList.add(Vf)),this.element.indeterminate=!0,this.indeterminate=!0)},t.prototype.clickHandler=function(e){if(e.target.tagName==="INPUT"&&this.clickTriggered){this.changeState(this.checked?"check":"uncheck"),this.clickTriggered=!1;return}(e.target.tagName==="SPAN"||e.target.tagName==="LABEL"||X(e.target,".e-label"))&&(this.clickTriggered=!0),this.isMouseClick&&(this.focusOutHandler(),this.isMouseClick=!1),this.indeterminate?(this.changeState(this.checked?"check":"uncheck",!1,!0),this.indeterminate=!1,this.element.indeterminate=!1):this.checked?(this.changeState("uncheck",!1,!0),this.checked=!1):(this.changeState("check",!1,!0),this.checked=!0);var i={checked:this.updateVueArrayModel(!1),event:e};this.trigger("change",i),e.stopPropagation()},t.prototype.destroy=function(){var e=this,i=this.getWrapper();s.prototype.destroy.call(this),this.wrapper&&(i=this.wrapper,this.disabled||this.unWireEvents(),this.tagName==="INPUT"?(this.getWrapper()&&i.parentNode&&i.parentNode.insertBefore(this.element,i),Oe(i),this.element.checked=!1,this.indeterminate&&(this.element.indeterminate=!1),["name","value","disabled"].forEach(function(r){e.element.removeAttribute(r)})):(["class"].forEach(function(r){i.removeAttribute(r)}),i.innerHTML="",this.element=i,this.refreshing&&(["e-control","e-checkbox","e-lib"].forEach(function(r){e.element.classList.add(r)}),It("ej2_instances",[this],this.element))))},t.prototype.focusHandler=function(){this.isFocused=!0},t.prototype.focusOutHandler=function(){var e=this.getWrapper();e&&e.classList.remove("e-focus"),this.isFocused=!1},t.prototype.getModuleName=function(){return"checkbox"},t.prototype.getPersistData=function(){return this.addOnPersist(["checked","indeterminate"])},t.prototype.getWrapper=function(){return this.element&&this.element.parentElement?this.element.parentElement.parentElement:null},t.prototype.getLabel=function(){return this.element?this.element.parentElement:null},t.prototype.initialize=function(){m(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.name&&this.element.setAttribute("name",this.name),this.element.setAttribute("tabindex","0"),this.value&&(this.element.setAttribute("value",this.value),this.isVue&&typeof this.value=="boolean"&&this.value===!0&&this.setProperties({checked:!0},!0)),this.checked&&this.changeState("check",!0),this.indeterminate&&this.changeState(),this.disabled&&this.setDisabled()},t.prototype.initWrapper=function(){var e=this.element.parentElement;e.classList.contains(Uf)||(e=this.createElement("div",{className:Uf}),this.element.parentNode&&this.element.parentNode.insertBefore(e,this.element));var i=this.createElement("label",{attrs:{for:this.htmlAttributes.id?this.htmlAttributes.id:this.element.id}}),r=this.createElement("span",{className:"e-icons "+tl});e.classList.add("e-wrapper"),this.enableRtl&&e.classList.add(jf),this.cssClass&&P([e],this.cssClass.replace(/\s+/g," ").trim().split(" ")),e.appendChild(i),i.appendChild(this.element),SB(this,i),i.appendChild(r),this.label&&this.setText(this.label)},t.prototype.keyUpHandler=function(){this.isFocused&&this.getWrapper().classList.add("e-focus")},t.prototype.labelMouseDownHandler=function(e){this.isMouseClick=!0;var i=this.getWrapper().getElementsByClassName(zf)[0];da(e,i)},t.prototype.labelMouseLeaveHandler=function(e){var i=this.getLabel().getElementsByClassName(zf)[0];if(i){for(var r=i.querySelectorAll(".e-ripple-element"),n=r.length-1;n>0;n--)i.removeChild(i.childNodes[n]);da(e,i)}},t.prototype.labelMouseUpHandler=function(e){this.isMouseClick=!0;var i=this.getWrapper().getElementsByClassName(zf)[0];if(i){for(var r=i.querySelectorAll(".e-ripple-element"),n=0;n<r.length-1;n++)i.removeChild(i.childNodes[n]);da(e,i)}},t.prototype.onPropertyChanged=function(e,i){for(var r=this.getWrapper(),n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];switch(o){case"checked":this.indeterminate=!1,this.element.indeterminate=!1,this.changeState(e.checked?"check":"uncheck");break;case"indeterminate":e.indeterminate?this.changeState():(this.element.indeterminate=!1,this.changeState(this.checked?"check":"uncheck"));break;case"disabled":e.disabled?(this.setDisabled(),this.wrapper=this.getWrapper(),this.unWireEvents()):(this.element.disabled=!1,r.classList.remove($g),r.setAttribute("aria-disabled","false"),this.wireEvents());break;case"cssClass":i.cssClass&&Z([r],i.cssClass.split(/\s+/).filter(function(u){return u.length>0})),e.cssClass&&P([r],e.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":e.enableRtl?r.classList.add(jf):r.classList.remove(jf);break;case"label":this.setText(e.label);break;case"labelPosition":{var l=r.getElementsByClassName(Wf)[0],h=r.getElementsByTagName("label")[0];Oe(l),e.labelPosition==="After"?h.appendChild(l):h.insertBefore(l,r.getElementsByClassName(tl)[0]);break}case"name":this.element.setAttribute("name",e.name);break;case"value":if(this.isVue&&typeof e.value=="object")break;this.element.setAttribute("value",e.value);break;case"htmlAttributes":this.updateHtmlAttributeToWrapper();break}}},t.prototype.preRender=function(){var e=this.element;this.tagName=this.element.tagName,e=mw(this.createElement,"EJS-CHECKBOX","checkbox",e,Uf,"checkbox"),this.element=e,this.element.getAttribute("type")!=="checkbox"&&this.element.setAttribute("type","checkbox"),this.element.id||(this.element.id=fi("e-"+this.getModuleName()))},t.prototype.render=function(){this.initWrapper(),this.initialize(),this.disabled||this.wireEvents(),this.updateHtmlAttributeToWrapper(),this.updateVueArrayModel(!0),this.renderComplete(),this.wrapper=this.getWrapper()},t.prototype.setDisabled=function(){var e=this.getWrapper();this.element.disabled=!0,e.classList.add($g),e.setAttribute("aria-disabled","true")},t.prototype.setText=function(e){var i=this.getWrapper();if(i){var r=i.getElementsByClassName(Wf)[0];if(r)r.innerHTML=this.enableHtmlSanitizer?mr.sanitize(e):e;else{e=this.enableHtmlSanitizer?mr.sanitize(e):e,r=this.createElement("span",{className:Wf,innerHTML:e});var n=i.getElementsByTagName("label")[0];this.labelPosition==="Before"?n.insertBefore(r,i.getElementsByClassName(tl)[0]):n.appendChild(r)}}},t.prototype.changeHandler=function(e){e.stopPropagation()},t.prototype.formResetHandler=function(){this.checked=this.initialCheckedValue,this.element.checked=this.initialCheckedValue},t.prototype.unWireEvents=function(){var e=this.wrapper;R.remove(e,"click",this.clickHandler),R.remove(this.element,"keyup",this.keyUpHandler),R.remove(this.element,"focus",this.focusHandler),R.remove(this.element,"focusout",this.focusOutHandler);var i=e.getElementsByTagName("label")[0];i&&(R.remove(i,"mousedown",this.labelMouseDownHandler),R.remove(i,"mouseup",this.labelMouseUpHandler),R.remove(i,"mouseleave",this.labelMouseLeaveHandler));var r=X(this.element,"form");r&&R.remove(r,"reset",this.formResetHandler),this.tagName==="EJS-CHECKBOX"&&R.remove(this.element,"change",this.changeHandler)},t.prototype.wireEvents=function(){var e=this.getWrapper();R.add(e,"click",this.clickHandler,this),R.add(this.element,"keyup",this.keyUpHandler,this),R.add(this.element,"focus",this.focusHandler,this),R.add(this.element,"focusout",this.focusOutHandler,this);var i=e.getElementsByTagName("label")[0];R.add(i,"mousedown",this.labelMouseDownHandler,this),R.add(i,"mouseup",this.labelMouseUpHandler,this),R.add(i,"mouseleave",this.labelMouseLeaveHandler,this);var r=X(this.element,"form");r&&R.add(r,"reset",this.formResetHandler,this),this.tagName==="EJS-CHECKBOX"&&R.add(this.element,"change",this.changeHandler,this)},t.prototype.updateVueArrayModel=function(e){if(this.isVue&&typeof this.value=="object"){var i=this.element.value;if(i&&this.value)if(e)for(var r=0;r<this.value.length;r++)i===this.value[r]&&(this.changeState("check"),this.setProperties({checked:!0},!0));else{var n=this.value.indexOf(i);return this.checked?n<0&&this.value.push(i):n>-1&&this.value.splice(n,1),this.value}}return this.validCheck?this.element.checked:!this.element.checked},t.prototype.updateHtmlAttributeToWrapper=function(){if(!m(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e],n=this.getWrapper();if(AB.indexOf(r)>-1)if(r==="class")P([n],this.htmlAttributes[""+r].split(" "));else if(r==="title")n.setAttribute(r,this.htmlAttributes[""+r]);else if(r==="style"){var a=this.getWrapper().getElementsByClassName(tl)[0];a.setAttribute(r,this.htmlAttributes[""+r])}else r==="disabled"?(this.htmlAttributes[""+r]==="true"&&this.setDisabled(),this.element.setAttribute(r,this.htmlAttributes[""+r])):this.element.setAttribute(r,this.htmlAttributes[""+r]);else n.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.click=function(){this.element.click()},t.prototype.focusIn=function(){this.element.focus()},Fr([Se()],t.prototype,"change",void 0),Fr([Se()],t.prototype,"created",void 0),Fr([O(!1)],t.prototype,"checked",void 0),Fr([O("")],t.prototype,"cssClass",void 0),Fr([O(!1)],t.prototype,"disabled",void 0),Fr([O(!1)],t.prototype,"indeterminate",void 0),Fr([O("")],t.prototype,"label",void 0),Fr([O("After")],t.prototype,"labelPosition",void 0),Fr([O("")],t.prototype,"name",void 0),Fr([O("")],t.prototype,"value",void 0),Fr([O(!0)],t.prototype,"enableHtmlSanitizer",void 0),Fr([O({})],t.prototype,"htmlAttributes",void 0),t=Fr([Wi],t),t}(Rr),DB=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Yr=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},$f="e-label",qf="e-ripple-container",Gf="e-rtl",Xf="e-radio-wrapper",LB=["title","class","style","disabled","readonly","name","value","id"],qg=function(s){DB(t,s);function t(i,r){var n=s.call(this,i,r)||this;return n.isFocused=!1,n.type="radio",n}e=t,t.prototype.changeHandler=function(i){this.checked=!0,this.dataBind();var r=this.element.getAttribute("value");r=this.isVue&&r?this.element.value:this.value;var n=typeof this.value;this.isVue&&n==="boolean"&&(r=r==="true"),this.trigger("change",{value:r,event:i}),this.isAngular&&i.stopPropagation()},t.prototype.updateChange=function(){for(var i,r,n=this.getRadioGroup(),a=0;a<n.length;a++)i=n[a],i!==this.element&&(r=fn(i,e),r.checked=!1,this.tagName==="EJS-RADIOBUTTON"&&(r.angularValue=this.value))},t.prototype.destroy=function(){var i=this,r=this.wrapper;s.prototype.destroy.call(this),r&&(this.disabled||this.unWireEvents(),this.tagName==="INPUT"?(r.parentNode&&r.parentNode.insertBefore(this.element,r),Oe(r),this.element.checked=!1,["name","value","disabled"].forEach(function(n){i.element.removeAttribute(n)})):(["role","aria-checked","class"].forEach(function(n){r.removeAttribute(n)}),r.innerHTML="",this.element=this.wrapper,this.refreshing&&(["e-control","e-radio","e-lib"].forEach(function(n){i.element.classList.add(n)}),It("ej2_instances",[this],this.element))))},t.prototype.focusHandler=function(){this.isFocused=!0},t.prototype.focusOutHandler=function(){var i=this.getLabel();i&&i.classList.remove("e-focus")},t.prototype.getModuleName=function(){return"radio"},t.prototype.getSelectedValue=function(){for(var i,r=this.getRadioGroup(),n=0,a=r.length;n<a;n++)if(i=r[n],i.checked)return i.value;return""},t.prototype.getRadioGroup=function(){return document.querySelectorAll('input.e-radio[name="'+this.element.getAttribute("name")+'"]')},t.prototype.getPersistData=function(){return this.addOnPersist(["checked"])},t.prototype.getWrapper=function(){return this.element.parentElement?this.element.parentElement:null},t.prototype.getLabel=function(){return this.element.nextElementSibling?this.element.nextElementSibling:null},t.prototype.initialize=function(){m(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.initWrapper(),this.updateHtmlAttribute(),this.name&&this.element.setAttribute("name",this.name);var i=this.element.getAttribute("value"),r=typeof this.value;this.isVue&&r==="boolean"&&(i=i==="true"),(this.isVue?this.value&&r!=="boolean"&&!i:this.value)&&this.element.setAttribute("value",this.value),this.checked&&(this.element.checked=!0),this.disabled&&this.setDisabled()},t.prototype.initWrapper=function(){var i=this.element.parentElement;i.classList.contains(Xf)||(i=this.createElement("div",{className:Xf}),this.element.parentNode&&this.element.parentNode.insertBefore(i,this.element));var r=this.createElement("label",{attrs:{for:this.element.id}});i.appendChild(this.element),i.appendChild(r),i.classList.add("e-wrapper"),this.enableRtl&&r.classList.add(Gf),this.cssClass&&P([i],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.label&&this.setText(this.label)},t.prototype.keyUpHandler=function(){this.isFocused&&this.getLabel().classList.add("e-focus")},t.prototype.labelMouseDownHandler=function(i){var r=this.getLabel().getElementsByClassName(qf)[0];da(i,r)},t.prototype.labelMouseLeaveHandler=function(i){var r=this.getLabel().getElementsByClassName(qf)[0];if(r){for(var n=r.querySelectorAll(".e-ripple-element"),a=n.length-1;a>0;a--)r.removeChild(r.childNodes[a]);da(i,r)}},t.prototype.labelMouseUpHandler=function(i){var r=this.getLabel().getElementsByClassName(qf)[0];if(r){for(var n=r.querySelectorAll(".e-ripple-element"),a=n.length-1;a>0;a--)r.removeChild(r.childNodes[a]);da(i,r)}},t.prototype.formResetHandler=function(){this.checked=this.initialCheckedValue,this.initialCheckedValue&&Pe(this.element,{checked:"true"})},t.prototype.onPropertyChanged=function(i,r){for(var n=this.getWrapper(),a=this.getLabel(),o=0,l=Object.keys(i);o<l.length;o++){var h=l[o];switch(h){case"checked":i.checked&&this.updateChange(),this.element.checked=i.checked;break;case"disabled":i.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,this.wireEvents());break;case"cssClass":r.cssClass&&Z([n],r.cssClass.split(/\s+/).filter(function(c){return c.length>0})),i.cssClass&&P([n],i.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":i.enableRtl?a.classList.add(Gf):a.classList.remove(Gf);break;case"label":this.setText(i.label);break;case"labelPosition":i.labelPosition==="Before"?a.classList.add("e-right"):a.classList.remove("e-right");break;case"name":this.element.setAttribute("name",i.name);break;case"value":var u=typeof this.htmlAttributes.value;if(!m(this.htmlAttributes)&&(this.htmlAttributes.value||u==="boolean"&&!this.htmlAttributes.value))break;this.element.setAttribute("value",i.value);break;case"htmlAttributes":this.updateHtmlAttribute();break}}},t.prototype.preRender=function(){var i=this.element;if(this.formElement=X(this.element,"form"),this.tagName=this.element.tagName,i=mw(this.createElement,"EJS-RADIOBUTTON","radio",i,Xf,"radio"),this.element=i,this.element.getAttribute("type")!=="radio"&&this.element.setAttribute("type","radio"),this.element.id||(this.element.id=fi("e-"+this.getModuleName())),this.tagName==="EJS-RADIOBUTTON"){var r=this.element.getAttribute("formcontrolname");r&&(this.setProperties({name:r},!0),this.element.setAttribute("name",r))}},t.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete(),this.wrapper=this.getWrapper()},t.prototype.setDisabled=function(){this.element.disabled=!0},t.prototype.setText=function(i){var r=this.getLabel(),n=r.getElementsByClassName($f)[0];n?n.textContent=i:(i=this.enableHtmlSanitizer?mr.sanitize(i):i,n=this.createElement("span",{className:$f,innerHTML:i}),r.appendChild(n)),this.labelPosition==="Before"?this.getLabel().classList.add("e-right"):this.getLabel().classList.remove("e-right")},t.prototype.updateHtmlAttribute=function(){if(!m(this.htmlAttributes))for(var i=0,r=Object.keys(this.htmlAttributes);i<r.length;i++){var n=r[i],a=this.element.parentElement;LB.indexOf(n)>-1?n==="class"?P([a],this.htmlAttributes[""+n].replace(/\s+/g," ").trim().split(" ")):n==="title"||n==="style"?a.setAttribute(n,this.htmlAttributes[""+n]):this.element.setAttribute(n,this.htmlAttributes[""+n]):a.setAttribute(n,this.htmlAttributes[""+n])}},t.prototype.unWireEvents=function(){var i=this.wrapper;R.remove(this.element,"change",this.changeHandler),R.remove(this.element,"focus",this.focusHandler),R.remove(this.element,"focusout",this.focusOutHandler),R.remove(this.element,"keyup",this.keyUpHandler);var r=i.getElementsByTagName("label")[0];r&&(R.remove(r,"mousedown",this.labelMouseDownHandler),R.remove(r,"mouseup",this.labelMouseUpHandler),R.remove(r,"mouseleave",this.labelMouseLeaveHandler)),this.formElement&&R.remove(this.formElement,"reset",this.formResetHandler)},t.prototype.wireEvents=function(){var i=this.getLabel();R.add(this.element,"change",this.changeHandler,this),R.add(this.element,"keyup",this.keyUpHandler,this),R.add(this.element,"focus",this.focusHandler,this),R.add(this.element,"focusout",this.focusOutHandler,this);var r=i.getElementsByClassName($f)[0];r&&(R.add(r,"mousedown",this.labelMouseDownHandler,this),R.add(r,"mouseup",this.labelMouseUpHandler,this),R.add(r,"mouseleave",this.labelMouseLeaveHandler,this)),this.formElement&&R.add(this.formElement,"reset",this.formResetHandler,this)},t.prototype.click=function(){this.element.click()},t.prototype.focusIn=function(){this.element.focus()};var e;return Yr([Se()],t.prototype,"change",void 0),Yr([Se()],t.prototype,"created",void 0),Yr([O(!1)],t.prototype,"checked",void 0),Yr([O("")],t.prototype,"cssClass",void 0),Yr([O(!1)],t.prototype,"disabled",void 0),Yr([O("")],t.prototype,"label",void 0),Yr([O("After")],t.prototype,"labelPosition",void 0),Yr([O("")],t.prototype,"name",void 0),Yr([O("")],t.prototype,"value",void 0),Yr([O(!0)],t.prototype,"enableHtmlSanitizer",void 0),Yr([O({})],t.prototype,"htmlAttributes",void 0),t=e=Yr([Wi],t),t}(Rr),Mr="",zu="",il="",ki=[],RB="e-active",pc="";function rl(s,t,e,i,r,n,a,o,l){!n||Mr===""?il!==""?(Mr=il+String.fromCharCode(s),il=""):Mr+=String.fromCharCode(s):Mr===zu&&(il=String.fromCharCode(s)),o?(setTimeout(function(){il=""},700),setTimeout(function(){Mr=""},3e3)):setTimeout(function(){Mr=""},1e3);var h;if(Mr=Mr.toLowerCase(),pc===r&&zu===Mr&&!l){for(var u=0;u<ki.length;u++){if(ki[u].classList.contains(RB)){h=u;break}if(a&&ki[u].textContent.toLowerCase()===a.toLowerCase()){h=u;break}}return h=h+1,o?ki[h]&&ki.length-1!==h?ki[h]:ki[ki.length]:ki[h]?ki[h]:ki[0]}else{var c=t,f=Mr.length,d=void 0,p=void 0;e=e?e+1:0;var u=e;ki=[];do u===c.length&&(u=-1),u===-1?h=0:h=u,p=c[h],d=p.innerText.toLowerCase(),d.substr(0,f)===Mr&&ki.push(c[h]),u++;while(u!==e);if(zu=Mr,pc=r,o){for(var v=!1,g=0;g<ki.length;g++)if(a&&ki[g].textContent.toLowerCase()===a.toLowerCase()){h=g,v=!0;break}return a&&v&&(h=h+1),ki[h]?ki[h]:ki[0]}return ki[0]}}function Ua(s,t,e,i,r,n,a,o){var l=t;i=i!=null?i:!0;var h={item:null,index:null};if(s&&s.length){var u=s.length,c=i?s.toLocaleLowerCase():s;c=IB(c);for(var f=function(g,b){var C=b[g],y;if(t&&r){var x=C,w=n.text.split(".");r.filter(function(E){Array.prototype.slice.call(w).forEach(function(k){(a==="object"&&!E.isHeader&&x.textContent.toString().indexOf(E[k])!==-1&&E[n.value]!=null&&x.getAttribute("data-value")===E[n.value].toString()||a==="string"&&x.textContent.toString().indexOf(E)!==-1)&&(y=a==="object"?E[k]:E)})})}var S=r&&y?(i?y.toString().toLocaleLowerCase():y).replace(/^\s+|\s+$/g,""):(i?C.textContent.toLocaleLowerCase():C.textContent).replace(/^\s+|\s+$/g,"");if(e==="Equal"&&S===c||e==="StartsWith"&&S.substr(0,u)===c||e==="EndsWith"&&S.substr(S.length-c.length)===c||e==="Contains"&&new RegExp(c,"g").test(S))return h.item=C,h.index=g,{value:{item:C,index:g}}},d=0,p=l;d<p.length;d++){var v=f(d,p);if(typeof v=="object")return v.value}return h}return h}function IB(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function _B(s){pc===s&&(pc="",zu="",Mr="",ki=[])}var yt={li:"e-list-item",ul:"e-list-parent e-ul",group:"e-list-group-item",icon:"e-list-icon",text:"e-list-text",check:"e-list-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-list-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-list-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"},Ft;(function(s){s.defaultMappedFields={id:"id",text:"text",url:"url",value:"value",isChecked:"isChecked",enabled:"enabled",expanded:"expanded",selected:"selected",iconCss:"iconCss",child:"child",isVisible:"isVisible",hasChildren:"hasChildren",tooltip:"tooltip",htmlAttributes:"htmlAttributes",urlAttributes:"urlAttributes",imageAttributes:"imageAttributes",imageUrl:"imageUrl",groupBy:null,sortBy:null};var t={level:1,listRole:"presentation",itemRole:"presentation",groupItemRole:"group",itemText:"list-item",wrapperRole:"presentation"},e={showCheckBox:!1,showIcon:!1,enableHtmlSanitizer:!1,expandCollapse:!1,fields:s.defaultMappedFields,ariaAttributes:t,listClass:"",itemClass:"",processSubChild:!1,sortOrder:"None",template:null,groupTemplate:null,headerTemplate:null,expandIconClass:"e-icon-collapsible",moduleName:"list",expandIconPosition:"Right",itemNavigable:!1};function i(D,T,M,K,te){var ee=Ue({},e,M),J=Ue({},t,ee.ariaAttributes),re=p(T).typeof;return re==="string"||re==="number"?r(D,T,K,M,te):o(D,T,M,J.level,K,te)}s.createList=i;function r(D,T,M,K,te){var ee=n(D,T,M,K,te);return A(D,ee,null,K)}s.createListFromArray=r;function n(D,T,M,K,te){var ee=[],J=Ue({},e,K);yt=S(J.moduleName);for(var re=y(),j=0;j<T.length;j++)if(!m(T[j])){var de=void 0;if(J.itemCreating&&typeof J.itemCreating=="function"){var we={dataSource:T,curData:T[j],text:T[j],options:J};J.itemCreating(we)}if(M?de=w(D,T[j],void 0,null,null,[],null,re,j,K):de=k(D,T[j],void 0,null,null,K,te),J.itemCreated&&typeof J.itemCreated=="function"){var we={dataSource:T,curData:T[j],text:T[j],item:de,options:J};J.itemCreated(we)}ee.push(de)}return ee}s.createListItemFromArray=n;function a(D,T,M,K,te,ee){var J=Ue({},e,M);yt=S(J.moduleName);var re=ee&&(ee.getModuleName()==="listview"||ee.getModuleName()==="multiselect")?J.fields:Ue({},s.defaultMappedFields,J.fields),j=Ue({},t,J.ariaAttributes),de,we=[];K&&(j.level=K);var N=[],H,L;T&&T.length&&!m(p(T).item)&&!Object.prototype.hasOwnProperty.call(p(T).item,re.id)&&(de=y());for(var _=0;_<T.length;_++){var U=sl(T[_],re);if(!m(T[_])){if(J.itemCreating&&typeof J.itemCreating=="function"){var se={dataSource:T,curData:T[_],text:U[re.text],options:J,fields:re};J.itemCreating(se)}var ae=T[_];J.itemCreating&&typeof J.itemCreating=="function"&&(U=sl(T[_],re)),Object.prototype.hasOwnProperty.call(U,re.id)&&!m(U[re.id])&&(de=U[re.id]);var oe=[];if(J.showCheckBox&&(J.itemNavigable&&(U[re.url]||U[re.urlAttributes])?we.push(D("input",{className:yt.check,attrs:{type:"checkbox"}})):oe.push(D("input",{className:yt.check,attrs:{type:"checkbox"}}))),te===!0){if(J.showIcon&&Object.prototype.hasOwnProperty.call(U,re.iconCss)&&!m(U[re.iconCss])&&oe.push(D("span",{className:yt.icon+" "+U[re.iconCss]})),H=w(D,ae,U,re,J.itemClass,oe,!!(Object.prototype.hasOwnProperty.call(ae,"isHeader")&&ae.isHeader),de,_,M),L=H.querySelector("."+yt.anchorWrap),Object.prototype.hasOwnProperty.call(U,re.tooltip)){var me=U[re.tooltip];if(M&&M.enableHtmlSanitizer)me=mr.sanitize(me);else{var Re=D("span",{innerHTML:me});me=Re.innerText,Re=null}H.setAttribute("title",me)}J.itemNavigable&&we.length&&Ii(we,H.firstElementChild)}else{if(H=k(D,ae,U,re,J.itemClass,M,ee),H.classList.add(yt.level+"-"+j.level),H.setAttribute("aria-level",j.level.toString()),(j.groupItemRole==="presentation"||j.itemRole==="presentation")&&H.removeAttribute("aria-level"),L=H.querySelector("."+yt.anchorWrap),Object.prototype.hasOwnProperty.call(U,re.tooltip)){var me=U[re.tooltip];if(M&&M.enableHtmlSanitizer)me=mr.sanitize(me);else{var Re=D("span",{innerHTML:me});me=Re.innerText,Re=null}H.setAttribute("title",me)}if(Object.prototype.hasOwnProperty.call(U,re.htmlAttributes)&&U[re.htmlAttributes]){var V=U[re.htmlAttributes];"class"in V&&typeof V.class=="string"&&V.class.trim()===""&&delete V.class,v(H,V)}if(Object.prototype.hasOwnProperty.call(U,re.enabled)&&U[re.enabled]===!1&&H.classList.add(yt.disabled),Object.prototype.hasOwnProperty.call(U,re.isVisible)&&U[re.isVisible]===!1&&(H.style.display="none"),Object.prototype.hasOwnProperty.call(U,re.imageUrl)&&!m(U[re.imageUrl])&&!J.template){var $e={src:U[re.imageUrl],alt:m(U.name)?"Displaying Image":"Displaying "+U.name+" Image"};po($e,U[re.imageAttributes]);var Me=D("img",{className:yt.image,attrs:$e});L?L.insertAdjacentElement("afterbegin",Me):Ii([Me],H.firstElementChild)}if(J.showIcon&&Object.prototype.hasOwnProperty.call(U,re.iconCss)&&!m(U[re.iconCss])&&!J.template){var Ze=D("div",{className:yt.icon+" "+U[re.iconCss]});L?L.insertAdjacentElement("afterbegin",Ze):Ii([Ze],H.firstElementChild)}oe.length&&Ii(oe,H.firstElementChild),J.itemNavigable&&we.length&&Ii(we,H.firstElementChild),x(D,U,re,T,J,H,j.level)}if(L&&P([H],[yt.navigable]),J.itemCreated&&typeof J.itemCreated=="function"){var se={dataSource:T,curData:T[_],text:U[re.text],item:H,options:J,fields:re};J.itemCreated(se)}we=[],N.push(H)}}return N}s.createListItemFromJson=a;function o(D,T,M,K,te,ee){var J=Ue({},e,M),re=a(D,T,M,K,te,ee);return A(D,re,J.listClass,M)}s.createListFromJson=o;function l(D,T,M){if(yt=S(e.moduleName),!(!D||!D.length)){var K,te,ee=Array.prototype.slice.call(D);for(T?te=h(T,ee):te=M===!0?ee.length:-1,K=ee[te+(M===!0?-1:1)];K&&(!ea(K)||K.classList.contains(yt.disabled));)te=te+(M===!0?-1:1),K=ee[te];return K}}s.getSiblingLI=l;function h(D,T){if(!(!T||!D)){var M=T;return M=Array.prototype.slice.call(T),M.indexOf(D)}}s.indexOf=h;function u(D,T,M){M===void 0&&(M="None");var K=Ue({},s.defaultMappedFields,T),te=new We().group(K.groupBy);te=c(M,"key",te);var ee=f(D,te);D=[];for(var J=0;J<ee.length;J++){var re=ee[J].items,j={},de="isHeader";j[K.text]=ee[J].key,j[""+de]=!0;var we=K.text;we==="id"&&(we="text",j[""+we]=ee[J].key),j._id="group-list-item-"+(ee[J].key?ee[J].key.toString().trim():"undefined"),j.items=re,D.push(j);for(var N=0;N<re.length;N++)D.push(re[N])}return D}s.groupDataSource=u;function c(D,T,M){if(M===void 0&&(M=new We),D==="Ascending")M.sortBy(T,"ascending",!0);else if(D==="Descending")M.sortBy(T,"descending",!0);else for(var K=0;K<M.queries.length;K++)M.queries[K].fn==="onSortBy"&&M.queries.splice(K,1);return M}s.addSorting=c;function f(D,T){return new fe(D).executeLocal(T)}s.getDataSource=f;function d(D,T){var M=Ue({},e,T),K=Ue({},s.defaultMappedFields,M.fields),te=D.cloneNode(!0),ee=[];te.classList.add("json-parent");var J=te.querySelectorAll(".json-parent>li");te.classList.remove("json-parent");for(var re=0;re<J.length;re++){for(var j=J[re],de=j.querySelector("a"),we=j.querySelector("ul"),N={},H=de?de.childNodes:j.childNodes,L=Object.keys(H),_=0;_<H.length;_++)H[Number(L[_])].hasChildNodes()||(N[K.text]=H[Number(L[_])].textContent);var U=g(j);U.id?(N[K.id]=U.id,delete U.id):N[K.id]=y(),Object.keys(U).length&&(N[K.htmlAttributes]=U),de&&(U=g(de),Object.keys(U).length&&(N[K.urlAttributes]=U)),we&&(N[K.child]=d(we,T)),ee.push(N)}return ee}s.createJsonFromElement=d;function p(D){for(var T={typeof:null,item:null},M=0;M<D.length;M++)if(!m(D[M]))return T={typeof:typeof D[M],item:D[M]};return T}function v(D,T){var M={};po(M,T),M.class&&(P([D],M.class.split(" ")),delete M.class),Pe(D,M)}function g(D){for(var T={},M=D.attributes,K=0;K<M.length;K++)T[M[K].nodeName]=M[K].nodeValue;return T}function b(D,T,M,K,te,ee){yt=S(e.moduleName);for(var J=D("ul",{className:yt.ul,attrs:{role:"presentation"}}),re=Ue({},e,te),j=Ue({},s.defaultMappedFields,K),de=du(T),we=[],N,H=y(),L=0;L<M.length;L++){var _=sl(M[L],j),U=M[L],se=U.isHeader;if(typeof M[L]=="string"||typeof M[L]=="number"?N=U:N=_[j.value],re.itemCreating&&typeof re.itemCreating=="function"){var ae={dataSource:M,curData:U,text:N,options:re,fields:j};re.itemCreating(ae)}re.itemCreating&&typeof re.itemCreating=="function"&&(_=sl(M[L],j),typeof M[L]=="string"||typeof M[L]=="number"?N=U:N=_[j.value]);var oe=D("li",{id:H+"-"+L,className:se?yt.group:yt.li,attrs:{role:"presentation"}});if(se)typeof M[L]=="string"||typeof M[L]=="number"?oe.innerText=U:oe.innerText=_[j.text];else{var me=se?re.groupTemplateID:re.templateID;if(se)if(ee&&ee.getModuleName()!=="listview"){var Re=de(U,ee,"headerTemplate",me,!!re.isStringTemplate,null,oe);Re&&at(Re,oe)}else at(de(U,ee,"headerTemplate",me,!!re.isStringTemplate),oe);else if(ee&&ee.getModuleName()!=="listview"){var Re=de(U,ee,"template",me,!!re.isStringTemplate,null,oe);Re&&at(Re,oe)}else at(de(U,ee,"template",me,!!re.isStringTemplate),oe);oe.setAttribute("data-value",m(N)?"null":N),oe.setAttribute("role","option")}if(re.itemCreated&&typeof re.itemCreated=="function"){var ae={dataSource:M,curData:U,text:N,item:oe,options:re,fields:j};re.itemCreated(ae)}we.push(oe)}return at(we,J),J}s.renderContentTemplate=b;function C(D,T,M,K,te,ee){for(var J=du(D),re=Ue({},s.defaultMappedFields,M),j=Ue({},e,te),de=re.groupBy,we=0,N=K;we<N.length;we++){var H=N[we],L={};if(L[""+de]=H.textContent,H.innerHTML="",ee&&ee.getModuleName()!=="listview"){var _=J(L,ee,"groupTemplate",j.groupTemplateID,!!j.isStringTemplate,null,H);_&&at(_,H)}else at(J(L,ee,"groupTemplate",j.groupTemplateID,!!j.isStringTemplate),H)}return K}s.renderGroupTemplate=C;function y(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}s.generateId=y;function x(D,T,M,K,te,ee,J){var re=T[M.child]||[],j=T[M.hasChildren];if(re.length&&(j=!0,ee.classList.add(yt.hasChild),te.processSubChild)){var de=o(D,re,te,++J);ee.appendChild(de)}if(te.expandCollapse&&j&&!te.template){ee.firstElementChild.classList.add(yt.iconWrapper);var we=te.expandIconPosition==="Left"?Ii:at;we([D("div",{className:"e-icons "+te.expandIconClass})],ee.querySelector("."+yt.textContent))}}function w(D,T,M,K,te,ee,J,re,j,de){var we=Ue({},e,de),N=Ue({},t,we.ariaAttributes),H=T,L=T,_;typeof T!="string"&&typeof T!="number"&&typeof T!="boolean"&&(_=T,H=typeof M[K.text]=="boolean"||typeof M[K.text]=="number"?M[K.text]:M[K.text]||"",L=M[K.value]);var U;!m(_)&&!m(M[K.id])&&M[K.id]!==""?U=re:U=re+"-"+j;var se=D("li",{className:(J===!0?yt.group:yt.li)+" "+(m(te)?"":te),id:U,attrs:N.groupItemRole!==""&&N.itemRole!==""?{role:J===!0?N.groupItemRole:N.itemRole}:{}});return _&&Object.prototype.hasOwnProperty.call(M,K.enabled)&&M[K.enabled].toString()==="false"&&se.classList.add(yt.disabled),de&&de.enableHtmlSanitizer&&(H=mr.sanitize(H)),J?se.innerText=H:(se.setAttribute("data-value",m(L)?"null":L),se.setAttribute("role","option"),_&&Object.prototype.hasOwnProperty.call(M,K.htmlAttributes)&&M[K.htmlAttributes]&&v(se,M[K.htmlAttributes]),ee.length&&!we.itemNavigable&&at(ee,se),_&&(M[K.url]||M[K.urlAttributes]&&M[K.urlAttributes].href)?se.appendChild(E(D,_,K,H,ee,we.itemNavigable)):(ee.length&&we.itemNavigable&&at(ee,se),se.appendChild(document.createTextNode(H)))),se}function S(D){return{li:"e-"+D+"-item",ul:"e-"+D+"-parent e-ul",group:"e-"+D+"-group-item",icon:"e-"+D+"-icon",text:"e-"+D+"-text",check:"e-"+D+"-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-"+D+"-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-"+D+"-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"}}function E(D,T,M,K,te,ee){var J=sl(T,M),re={href:J[M.url]};Object.prototype.hasOwnProperty.call(J,M.urlAttributes)&&J[M.urlAttributes]&&(po(re,J[M.urlAttributes]),re.href=J[M.url]?J[M.url]:J[M.urlAttributes].href);var j;if(!ee)j=D("a",{className:yt.text+" "+yt.url,innerHTML:K});else{j=D("a",{className:yt.text+" "+yt.url});var de=D("div",{className:yt.anchorWrap});te&&te.length&&at(te,de),de.appendChild(document.createTextNode(K)),at([de],j)}return v(j,re),j}function k(D,T,M,K,te,ee,J){var re=Ue({},e,ee),j=Ue({},t,re.ariaAttributes),de=T,we,N,H;typeof T!="string"&&typeof T!="number"&&(H=T,de=M[K.text]||"",we=m(M._id)?M[K.id]:M._id,N=!!(Object.prototype.hasOwnProperty.call(T,"isHeader")&&T.isHeader)),ee&&ee.enableHtmlSanitizer&&(de=mr.sanitize(de));var L=D("li",{className:(N===!0?yt.group:yt.li)+" "+(m(te)?"":te),attrs:j.groupItemRole!==""&&j.itemRole!==""?{role:N===!0?j.groupItemRole:j.itemRole}:{}});if(m(we)?L.setAttribute("data-uid",y()):L.setAttribute("data-uid",we),N&&ee&&ee.groupTemplate){var _=du(ee.groupTemplate);if(J&&J.getModuleName()!=="listview"){var U=_(T,J,"groupTemplate",re.groupTemplateID,!!re.isStringTemplate,null,L);U&&at(U,L)}else at(_(T,J,"groupTemplate",re.groupTemplateID,!!re.isStringTemplate),L)}else if(!N&&ee&&ee.template){var _=du(ee.template);if(J&&J.getModuleName()!=="listview"){var U=_(T,J,"template",re.templateID,!!re.isStringTemplate,null,L);U&&at(U,L)}else at(_(T,J,"template",re.templateID,!!re.isStringTemplate),L)}else{var se=D("div",{className:yt.textContent,attrs:j.wrapperRole!==""?{role:j.wrapperRole}:{}});if(H&&(M[K.url]||M[K.urlAttributes]&&M[K.urlAttributes].href))se.appendChild(E(D,H,K,de,null,re.itemNavigable));else{var ae=D("span",{className:yt.text,attrs:j.itemText!==""?{role:j.itemText}:{}});ee&&ee.enableHtmlSanitizer?ae.innerText=de:ae.innerHTML=de,se.appendChild(ae)}L.appendChild(se)}return L}function A(D,T,M,K){var te=Ue({},e,K),ee=Ue({},t,te.ariaAttributes);yt=S(te.moduleName);var J=D("ul",{className:yt.ul+" "+(m(M)?"":M),attrs:ee.listRole!==""?{role:ee.listRole}:{}});return at(T,J),J}s.generateUL=A;function z(D,T,M,K){var te=Ue({},e,K);yt=S(te.moduleName);var ee=te.expandIconPosition==="Left"?Ii:at;return ee([D("div",{className:"e-icons "+te.expandIconClass+" "+(m(M)?"":M)})],T.querySelector("."+yt.textContent)),T}s.generateIcon=z})(Ft||(Ft={}));function sl(s,t){var e={};if(m(s)||typeof s=="string"||typeof s=="number"||!m(s.isHeader))return s;for(var i=0,r=Object.keys(t);i<r.length;i++){var n=r[i],a=t[""+n],o=!m(a)&&typeof a=="string"?ie(a,s):void 0;m(o)||(e[""+a]=o)}return e}function du(s){if(s)try{return typeof s!="function"&&document.querySelector(s)?wt(document.querySelector(s).innerHTML.trim()):wt(s)}catch(t){return wt(s)}}var Ps,pn,Br,uh,lv=!1;function FB(s,t){var e=!1,i={left:0,top:0},r=s;if(!s||!t)return i;for(m(t.offsetParent)&&t.style.position==="fixed"&&(e=!0);(t.offsetParent||e)&&s&&t.offsetParent!==s;)i.left+=s.offsetLeft,i.top+=s.offsetTop,s=s.offsetParent;for(s=r;(t.offsetParent||e)&&s&&t.offsetParent!==s;)i.left-=s.scrollLeft,i.top-=s.scrollTop,s=s.parentElement;return i}function Tr(s,t,e,i,r){if(pn=void 0,pn=r,lv=!!i,!s)return{left:0,top:0};t||(t="left"),e||(e="top"),uh=s.ownerDocument,Br=s;var n={left:0,top:0};return NB(t.toLowerCase(),e.toLowerCase(),n)}function js(s,t){t.left=s}function Us(s,t){t.top=s}function NB(s,t,e){switch(Ps=Br.getBoundingClientRect(),t+s){case"topcenter":js(Qf(),e),Us(ju(),e);break;case"topright":js(Jf(),e),Us(ju(),e);break;case"centercenter":js(Qf(),e),Us(Yf(),e);break;case"centerright":js(Jf(),e),Us(Yf(),e);break;case"centerleft":js(Uu(),e),Us(Yf(),e);break;case"bottomcenter":js(Qf(),e),Us(Kf(),e);break;case"bottomright":js(Jf(),e),Us(Kf(),e);break;case"bottomleft":js(Uu(),e),Us(Kf(),e);break;default:case"topleft":js(Uu(),e),Us(ju(),e);break}return Br=null,e}function vw(){return uh.documentElement.scrollTop||uh.body.scrollTop}function gw(){return uh.documentElement.scrollLeft||uh.body.scrollLeft}function Kf(){return lv?Ps.bottom:Ps.bottom+vw()}function Yf(){return ju()+Ps.height/2}function ju(){return lv?Ps.top:Ps.top+vw()}function Uu(){return Ps.left+gw()}function Jf(){var s=Br&&((Br.classList.contains("e-date-wrapper")||Br.classList.contains("e-datetime-wrapper"))&&Br.classList.contains("e-rtl")||Br.classList.contains("e-ddl")&&Br.classList.contains("e-rtl")||Br.classList.contains("e-date-range-wrapper"))?pn?pn.width:0:pn&&Ps.width>=pn.width?pn.width:0;return Br&&Br.classList.contains("e-rtl")&&Br.classList.contains("e-multiselect")&&(s=pn.width),Ps.right+gw()-s}function Qf(){return Uu()+Ps.width/2}var _n,Lr;function bw(s,t,e,i){if(t===void 0&&(t=null),e===void 0&&(e={X:!1,Y:!1}),!e.Y&&!e.X)return{left:0,top:0};var r=s.getBoundingClientRect();if(Lr=t,_n=s.ownerDocument,i||(i=Tr(s,"left","top")),e.X){var n=Lr?Sw():Dw(),a=fv(),o=dv(),l=a-i.left,h=i.left+r.width-o;r.width>n?l>0&&h<=0?i.left=o-r.width:h>0&&l<=0?i.left=a:i.left=l>h?o-r.width:a:l>0?i.left+=l:h>0&&(i.left-=h)}if(e.Y){var u=Lr?kw():Ow(),c=cv(),f=pv(),d=c-i.top,p=i.top+r.height-f;r.height>u?d>0&&p<=0?i.top=f-r.height:p>0&&d<=0?i.top=c:i.top=d>p?f-r.height:c:d>0?i.top+=d:p>0&&(i.top-=p)}return i}function Gc(s,t,e,i){t===void 0&&(t=null);var r=Tr(s,"left","top");e&&(r.left=e),i&&(r.top=i);var n=[];Lr=t,_n=s.ownerDocument;var a=s.getBoundingClientRect(),o=r.top,l=r.left,h=r.left+a.width,u=r.top+a.height,c=Ew(o,u),f=xw(l,h);return c.topSide&&n.push("top"),f.rightSide&&n.push("right"),f.leftSide&&n.push("left"),c.bottomSide&&n.push("bottom"),n}function MB(s,t,e,i,r,n,a,o,l){if(a===void 0&&(a=null),o===void 0&&(o={X:!0,Y:!0}),!(!t||!s||!r||!n||!o.X&&!o.Y)){var h={TL:null,TR:null,BL:null,BR:null},u={TL:null,TR:null,BL:null,BR:null},c;if(window.getComputedStyle(s).display==="none"){var f=s.style.visibility;s.style.visibility="hidden",s.style.display="block",c=s.getBoundingClientRect(),s.style.removeProperty("display"),s.style.visibility=f}else c=s.getBoundingClientRect();var d={posX:r,posY:n,offsetX:e,offsetY:i,position:{left:0,top:0}};Lr=a,_n=t.ownerDocument,BB(t,h,d,l,c),uv(u,d,c),o.X&&Cw(t,u,h,d,c,!0),o.Y&&h.TL.top>-1&&ww(t,u,h,d,c,!0),PB(s,d,c)}}function PB(s,t,e){var i=0,r=0;if(s.offsetParent!=null&&(getComputedStyle(s.offsetParent).position==="absolute"||getComputedStyle(s.offsetParent).position==="relative")){var n=Tr(s.offsetParent,"left","top",!1,e);i=n.left,r=n.top}var a=1,o=1,l=yw(s);if(l){var h=getComputedStyle(l).transform;if(h!=="none"){var u=new DOMMatrix(h);a=u.a,o=u.d}var c=getComputedStyle(l).zoom;if(c!=="none"){var f=hv(document.body);a=f*a,o=f*o}}s.style.top=t.position.top/o+t.offsetY-r/o+"px",s.style.left=t.position.left/a+t.offsetX-i/a+"px"}function hv(s){var t=getComputedStyle(s).zoom;return parseFloat(t)||1}function yw(s){for(;s;){var t=window.getComputedStyle(s).transform,e=hv(document.body);if(t&&t!=="none"||e&&e!==1)return s;if(s===document.body)return null;s=s.offsetParent||s.parentElement}return null}function BB(s,t,e,i,r){e.position=Tr(s,e.posX,e.posY,i,r),t.TL=Tr(s,"left","top",i,r),t.TR=Tr(s,"right","top",i,r),t.BR=Tr(s,"left","bottom",i,r),t.BL=Tr(s,"right","bottom",i,r)}function uv(s,t,e){s.TL={top:t.position.top+t.offsetY,left:t.position.left+t.offsetX},s.TR={top:s.TL.top,left:s.TL.left+e.width},s.BL={top:s.TL.top+e.height,left:s.TL.left},s.BR={top:s.TL.top+e.height,left:s.TL.left+e.width}}function xw(s,t){var e=!1,i=!1;return s-vc()<fv()&&(e=!0),t>dv()&&(i=!0),{leftSide:e,rightSide:i}}function Cw(s,t,e,i,r,n){var a=xw(t.TL.left,t.TR.left);e.TL.left-vc()<=fv()&&(a.leftSide=!1),e.TR.left>dv()&&(a.rightSide=!1),(a.leftSide&&!a.rightSide||!a.leftSide&&a.rightSide)&&(i.posX==="right"?i.posX="left":i.posX="right",i.offsetX=i.offsetX+r.width,i.offsetX=-1*i.offsetX,i.position=Tr(s,i.posX,i.posY,!1),uv(t,i,r),n&&Cw(s,t,e,i,r,!1))}function ww(s,t,e,i,r,n){var a=Ew(t.TL.top,t.BL.top);e.TL.top-mc()<=cv()&&(a.topSide=!1),e.BL.top>=pv()&&s.getBoundingClientRect().bottom<window.innerHeight&&(a.bottomSide=!1),(a.topSide&&!a.bottomSide||!a.topSide&&a.bottomSide)&&(i.posY==="top"?i.posY="bottom":i.posY="top",i.offsetY=i.offsetY+r.height,i.offsetY=-1*i.offsetY,i.position=Tr(s,i.posX,i.posY,!1,r),uv(t,i,r),n&&ww(s,t,e,i,r,!1))}function Ew(s,t){var e=!1,i=!1;return s-mc()<cv()&&(e=!0),t>pv()&&(i=!0),{topSide:e,bottomSide:i}}function Sw(){return Lr.getBoundingClientRect().width}function kw(){return Lr.getBoundingClientRect().height}function Tw(){return Lr.getBoundingClientRect().left}function Aw(){return Lr.getBoundingClientRect().top}function cv(){return Lr?Aw():0}function fv(){return Lr?Tw():0}function dv(){return Lr?vc()+Tw()+Sw():vc()+Dw()}function pv(){return Lr?mc()+Aw()+kw():mc()+Ow()}function mc(){return _n.documentElement.scrollTop||_n.body.scrollTop}function vc(){return _n.documentElement.scrollLeft||_n.body.scrollLeft}function Ow(){return window.innerHeight}function Dw(){var s=window.innerWidth,t=document.documentElement.getBoundingClientRect(),e=m(document.documentElement)?0:t.width;return s-(s-e)}function Lw(){Lr=null,_n=null}var Rw=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),bi=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},HB=function(s){Rw(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return bi([O("left")],t.prototype,"X",void 0),bi([O("top")],t.prototype,"Y",void 0),t}(Ir),Li={ROOT:"e-popup",RTL:"e-rtl",OPEN:"e-popup-open",CLOSE:"e-popup-close"},Bo=function(s){Rw(t,s);function t(e,i){return s.call(this,i,e)||this}return t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];switch(a){case"width":ia(this.element,{width:st(e.width)});break;case"height":ia(this.element,{height:st(e.height)});break;case"zIndex":ia(this.element,{zIndex:e.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":{var o=e.offsetX-i.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+o).toString()+"px";break}case"offsetY":{var l=e.offsetY-i.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+l).toString()+"px";break}case"content":this.setContent();break;case"actionOnScroll":e.actionOnScroll!=="none"?this.wireScrollEvents():this.unwireScrollEvents();break}}},t.prototype.getModuleName=function(){return"popup"},t.prototype.resolveCollision=function(){this.checkCollision()},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.destroy=function(){this.element.classList.contains("e-popup-open")&&this.unwireEvents(),this.element.classList.remove(Li.ROOT,Li.RTL,Li.OPEN,Li.CLOSE),this.content=null,this.relateTo=null,Lw(),s.prototype.destroy.call(this)},t.prototype.render=function(){this.element.classList.add(Li.ROOT);var e={};this.zIndex!==1e3&&(e.zIndex=this.zIndex),this.width!=="auto"&&(e.width=st(this.width)),this.height!=="auto"&&(e.height=st(this.height)),ia(this.element,e),this.fixedParent=!1,this.setEnableRtl(),this.setContent()},t.prototype.wireEvents=function(){xe.isDevice&&R.add(window,"orientationchange",this.orientationOnChange,this),this.actionOnScroll!=="none"&&this.wireScrollEvents()},t.prototype.wireScrollEvents=function(){if(this.getRelateToElement())for(var e=0,i=this.getScrollableParent(this.getRelateToElement());e<i.length;e++){var r=i[e];R.add(r,"scroll",this.scrollRefresh,this)}},t.prototype.unwireEvents=function(){xe.isDevice&&R.remove(window,"orientationchange",this.orientationOnChange),this.actionOnScroll!=="none"&&this.unwireScrollEvents()},t.prototype.unwireScrollEvents=function(){if(this.getRelateToElement())for(var e=0,i=this.getScrollableParent(this.getRelateToElement());e<i.length;e++){var r=i[e];R.remove(r,"scroll",this.scrollRefresh)}},t.prototype.getRelateToElement=function(){var e=this.relateTo===""||m(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:e},!0),typeof this.relateTo=="string"?document.querySelector(this.relateTo):this.relateTo},t.prototype.scrollRefresh=function(e){if(this.actionOnScroll==="reposition"?!m(this.element)&&!(this.element.offsetParent===e.target||this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&e.target.parentElement==null)&&this.refreshPosition():this.actionOnScroll==="hide"&&this.hide(),this.actionOnScroll!=="none"&&this.getRelateToElement()){var i=this.isElementOnViewport(this.getRelateToElement(),e.target);!i&&!this.targetInvisibleStatus?(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0):i&&(this.targetInvisibleStatus=!1)}},t.prototype.isElementOnViewport=function(e,i){for(var r=this.getScrollableParent(e),n=0;n<r.length;n++)if(!this.isElementVisible(e,r[n]))return!1;return!0},t.prototype.isElementVisible=function(e,i){var r=this.checkGetBoundingClientRect(e);if(!r.height||!r.width)return!1;if(m(this.checkGetBoundingClientRect(i))){var a=window,o={top:a.scrollY,left:a.scrollX,right:a.scrollX+a.outerWidth,bottom:a.scrollY+a.outerHeight},l=Tr(e),h={top:l.top,left:l.left,right:l.left+r.width,bottom:l.top+r.height},u={top:o.bottom-h.top,left:o.right-h.left,bottom:h.bottom-o.top,right:h.right-o.left};return u.top>0&&u.left>0&&u.right>0&&u.bottom>0}else{var n=i.getBoundingClientRect();return!(r.bottom<n.top)&&!(r.bottom>n.bottom)&&!(r.right>n.right)&&!(r.left<n.left)}},t.prototype.preRender=function(){},t.prototype.setEnableRtl=function(){this.reposition(),this.enableRtl?this.element.classList.add(Li.RTL):this.element.classList.remove(Li.RTL)},t.prototype.setContent=function(){if(!m(this.content))if(this.element.innerHTML="",typeof this.content=="string")this.element.textContent=this.content;else{var e=this.getRelateToElement(),i=this.content.props;(!e.classList.contains("e-dropdown-btn")||m(i))&&this.element.appendChild(this.content)}},t.prototype.orientationOnChange=function(){var e=this;setTimeout(function(){e.refreshPosition()},200)},t.prototype.refreshPosition=function(e,i){m(e)||this.checkFixedParent(e),this.reposition(),i||this.checkCollision()},t.prototype.reposition=function(){var e,i,r=this.getRelateToElement();if(typeof this.position.X=="number"&&typeof this.position.Y=="number")e={left:this.position.X,top:this.position.Y};else if(typeof this.position.X=="string"&&typeof this.position.Y=="number"||typeof this.position.X=="number"&&typeof this.position.Y=="string"){var n=void 0,a=this.element.style.display;this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(n=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),i=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY),typeof this.position.X=="string"?e={left:i.left,top:this.position.Y}:e={left:this.position.X,top:i.top},this.element.style.display=a,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=n)}else if(r){var o=this.element.clientHeight,a=this.element.style.display;this.element.style.display="block",e=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY,o),this.element.style.display=a}else e={left:0,top:0};m(e)||(this.element.style.left=e.left+"px",this.element.style.top=e.top+"px")},t.prototype.checkGetBoundingClientRect=function(e){var i;try{return i=e.getBoundingClientRect(),i}catch(r){return null}},t.prototype.getAnchorPosition=function(e,i,r,n,a,o){o===void 0&&(o=0);var l=this.checkGetBoundingClientRect(i),h=this.checkGetBoundingClientRect(e);if(m(l)||m(h))return null;var u=e,c={left:0,top:0};switch(i.offsetParent&&i.offsetParent.tagName==="BODY"&&e.tagName==="BODY"?c=Tr(e):(i.classList.contains("e-dlg-modal")&&u.tagName!=="BODY"&&(i=i.parentElement),c=FB(u,i)),r.X){default:case"left":break;case"center":i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container"?c.left+=window.innerWidth/2-l.width/2:this.targetType==="container"?c.left+=h.width/2-l.width/2:c.left+=h.width/2;break;case"right":if(i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container")c.left+=window.innerWidth-l.width;else if(this.targetType==="container"){var f=1,d=yw(i);if(d){var p=getComputedStyle(d).transform;if(p!=="none"){var v=new DOMMatrix(p);f=v.a}var g=getComputedStyle(d).zoom;if(g!=="none"){var b=hv(document.body);f=b*f}}c.left+=(h.width-l.width)/f}else c.left+=h.width;break}switch(r.Y){default:case"top":break;case"center":i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container"?c.top+=window.innerHeight/2-l.height/2:this.targetType==="container"?c.top+=h.height/2-l.height/2:c.top+=h.height/2;break;case"bottom":i.classList.contains("e-dlg-modal")&&u.tagName==="BODY"&&this.targetType==="container"?c.top+=window.innerHeight-l.height:this.targetType==="container"&&!i.classList.contains("e-dialog")?c.top+=h.height-l.height:this.targetType==="container"&&i.classList.contains("e-dialog")?c.top+=h.height-o:c.top+=h.height;break}return c.left+=n,c.top+=a,c},t.prototype.callFlip=function(e){var i=this.getRelateToElement();MB(this.element,i,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,e,this.fixedParent)},t.prototype.callFit=function(e){if(Gc(this.element,this.viewPortElement).length!==0)if(m(this.viewPortElement)){var i=bw(this.element,this.viewPortElement,e);e.X&&(this.element.style.left=i.left+"px"),e.Y&&(this.element.style.top=i.top+"px")}else{var r=this.checkGetBoundingClientRect(this.element),n=this.checkGetBoundingClientRect(this.viewPortElement);if(m(r)||m(n))return null;e&&e.Y===!0&&(n.top>r.top?this.element.style.top="0px":n.bottom<r.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(r.bottom-n.bottom)+"px")),e&&e.X===!0&&(n.right<r.right?this.element.style.left=parseInt(this.element.style.left,10)-(r.right-n.right)+"px":n.left>r.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(n.left-r.left)+"px"))}},t.prototype.checkCollision=function(){var e=this.collision.X,i=this.collision.Y;e==="none"&&i==="none"||(e==="flip"&&i==="flip"?this.callFlip({X:!0,Y:!0}):e==="fit"&&i==="fit"?this.callFit({X:!0,Y:!0}):(e==="flip"?this.callFlip({X:!0,Y:!1}):i==="flip"&&this.callFlip({Y:!0,X:!1}),e==="fit"?this.callFit({X:!0,Y:!1}):i==="fit"&&this.callFit({X:!1,Y:!0})))},t.prototype.show=function(e,i){var r=this;if(this.wireEvents(),this.zIndex===1e3||!m(i)){var n=m(i)?this.element:i;this.zIndex=WB(n),ia(this.element,{zIndex:this.zIndex})}e=!m(e)&&typeof e=="object"?e:this.showAnimation,(this.collision.X!=="none"||this.collision.Y!=="none")&&(Z([this.element],Li.CLOSE),P([this.element],Li.OPEN),this.checkCollision(),Z([this.element],Li.OPEN),P([this.element],Li.CLOSE)),m(e)?(Z([this.element],Li.CLOSE),P([this.element],Li.OPEN),this.trigger("open")):(e.begin=function(){r.isDestroyed||(Z([r.element],Li.CLOSE),P([r.element],Li.OPEN))},e.end=function(){r.isDestroyed||r.trigger("open")},new vr(e).animate(this.element))},t.prototype.hide=function(e){var i=this;e=!m(e)&&typeof e=="object"?e:this.hideAnimation,m(e)?(Z([this.element],Li.OPEN),P([this.element],Li.CLOSE),this.trigger("close")):(e.end=function(){i.isDestroyed||(Z([i.element],Li.OPEN),P([i.element],Li.CLOSE),i.trigger("close"))},new vr(e).animate(this.element)),this.unwireEvents()},t.prototype.getScrollableParent=function(e){return this.checkFixedParent(e),VB(e,this.fixedParent)},t.prototype.checkFixedParent=function(e){for(var i=e.parentElement;i&&i.tagName!=="HTML";){var r=getComputedStyle(i);(r.position==="fixed"||r.position==="sticky")&&!m(this.element)&&this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&getComputedStyle(this.element.offsetParent).overflow!=="hidden"&&(this.element.style.top=window.scrollY>parseInt(this.element.style.top,10)?st(window.scrollY-parseInt(this.element.style.top,10)):st(parseInt(this.element.style.top,10)-window.scrollY),this.element.style.position="fixed",this.fixedParent=!0),i=i.parentElement,!m(this.element)&&m(this.element.offsetParent)&&r.position==="fixed"&&this.element.style.position==="fixed"&&(this.fixedParent=!0)}},bi([O("auto")],t.prototype,"height",void 0),bi([O("auto")],t.prototype,"width",void 0),bi([O(null)],t.prototype,"content",void 0),bi([O("container")],t.prototype,"targetType",void 0),bi([O(null)],t.prototype,"viewPortElement",void 0),bi([O({X:"none",Y:"none"})],t.prototype,"collision",void 0),bi([O("")],t.prototype,"relateTo",void 0),bi([Ur({},HB)],t.prototype,"position",void 0),bi([O(0)],t.prototype,"offsetX",void 0),bi([O(0)],t.prototype,"offsetY",void 0),bi([O(1e3)],t.prototype,"zIndex",void 0),bi([O(!1)],t.prototype,"enableRtl",void 0),bi([O("reposition")],t.prototype,"actionOnScroll",void 0),bi([O(null)],t.prototype,"showAnimation",void 0),bi([O(null)],t.prototype,"hideAnimation",void 0),bi([Se()],t.prototype,"open",void 0),bi([Se()],t.prototype,"close",void 0),bi([Se()],t.prototype,"targetExitViewport",void 0),t=bi([Wi],t),t}(Rr);function VB(s,t){for(var e=getComputedStyle(s),i=[],r=/(auto|scroll)/,n=s.parentElement;n&&n.tagName!=="HTML";){var a=getComputedStyle(n);!(e.position==="absolute"&&a.position==="static")&&r.test(a.overflow+a.overflowY+a.overflowX)&&i.push(n),n=n.parentElement}return t||i.push(document),i}function WB(s){for(var t=s.parentElement,e=[];t&&t.tagName!=="BODY";){var i=document.defaultView.getComputedStyle(t,null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(t,null).getPropertyValue("position");i!=="auto"&&r!=="static"&&e.push(i),t=t.parentElement}for(var n=[],a=0;a<document.body.children.length;a++)if(!s.isEqualNode(document.body.children[a])){var i=document.defaultView.getComputedStyle(document.body.children[a],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(document.body.children[a],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&n.push(i)}n.push("999");var o=[];if(!m(s.parentElement)&&s.parentElement.tagName!=="BODY"){for(var l=[].slice.call(s.parentElement.children),a=0;a<l.length;a++)if(!s.isEqualNode(l[a])){var i=document.defaultView.getComputedStyle(l[a],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(l[a],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&o.push(i)}}var h=e.concat(n,o),u=Math.max.apply(Math,h)+1;return u>2147483647?2147483647:u}var Iw=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Lt=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},zB=1500,jB=500,Gg=0,Xg=8,UB=2,Os=2,Zf="e-tooltip",Kg="e-rtl",$B="e-bigger",Yg="e-icons",Jg="e-tooltip-close",ed="e-tooltip-wrap",Qg="e-tip-content",$a="e-arrow-tip",Zg="e-arrow-tip-outer",pu="e-arrow-tip-inner",nl="e-tip-bottom",td="e-tip-top",eb="e-tip-left",id="e-tip-right",rd="e-popup",al="e-popup-open",sd="e-popup-close",mu="e-lib",qB="e-hidden",tb="e-tooltip-popup-container",GB=function(s){Iw(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return Lt([O({effect:"FadeIn",duration:150,delay:0})],t.prototype,"open",void 0),Lt([O({effect:"FadeOut",duration:150,delay:0})],t.prototype,"close",void 0),t}(Ir),XB=function(s){Iw(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.mouseMoveEvent=null,r.mouseMoveTarget=null,r.containerElement=null,r.isBodyContainer=!0,r}return t.prototype.initialize=function(){this.formatPosition(),P([this.element],Zf)},t.prototype.formatPosition=function(){var e,i;this.position&&(this.position.indexOf("Top")===0||this.position.indexOf("Bottom")===0?(e=this.position.split(/(?=[A-Z])/),this.tooltipPositionY=e[0],this.tooltipPositionX=e[1]):(i=this.position.split(/(?=[A-Z])/),this.tooltipPositionX=i[0],this.tooltipPositionY=i[1]))},t.prototype.renderArrow=function(){this.setTipClass(this.position);var e=this.createElement("div",{className:$a+" "+this.tipClass});e.appendChild(this.createElement("div",{className:Zg+" "+this.tipClass})),e.appendChild(this.createElement("div",{className:pu+" "+this.tipClass})),this.tooltipEle.appendChild(e)},t.prototype.setTipClass=function(e){e.indexOf("Right")===0?this.tipClass=eb:e.indexOf("Bottom")===0?this.tipClass=td:e.indexOf("Left")===0?this.tipClass=id:this.tipClass=nl},t.prototype.renderPopup=function(e){var i=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(e);this.tooltipEle.classList.remove(mu),this.popupObj=new Bo(this.tooltipEle,{height:this.height,width:this.width,position:{X:i.left,Y:i.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})},t.prototype.getScalingFactor=function(e){if(!e)return{x:1,y:1};var i={x:1,y:1},r=e.closest('[style*="transform: scale"]');if(r&&r!==this.tooltipEle&&r.contains(this.tooltipEle)){var n=window.getComputedStyle(r),a=n.getPropertyValue("transform"),o=a.match(/matrix\(([^)]+)\)/)[1].split(",").map(parseFloat);i.x=o[0],i.y=o[3]}return i},t.prototype.getTooltipPosition=function(e){this.tooltipEle.style.display="block";var i=this.element.closest('[style*="zoom"]');i&&(i.contains(this.tooltipEle)||(this.tooltipEle.style.zoom=getComputedStyle(i).zoom));var r=Tr(e,this.tooltipPositionX,this.tooltipPositionY,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect()),n=this.getScalingFactor(e),a=this.calculateTooltipOffset(this.position,n.x,n.y),o=this.calculateElementPosition(r,a),l=o[0],h=o[1],u=this.collisionFlipFit(e,l,h);return u.left=u.left/n.x,u.top=u.top/n.y,this.tooltipEle.style.display="",u},t.prototype.windowResize=function(){this.reposition(this.findTarget())},t.prototype.reposition=function(e){if(this.popupObj&&e){var i=this.getTooltipPosition(e);this.popupObj.position={X:i.left,Y:i.top},this.popupObj.dataBind()}},t.prototype.openPopupHandler=function(){!this.mouseTrail&&this.needTemplateReposition()&&this.reposition(this.findTarget()),this.trigger("afterOpen",this.tooltipEventArgs),this.tooltipEventArgs=null},t.prototype.closePopupHandler=function(){this.isReact&&!(this.opensOn==="Click"||typeof this.content=="function")&&this.clearTemplate(["content"]),this.clear();var e={type:this.tooltipEventArgs.event?this.tooltipEventArgs.event.type:null,cancel:!1,target:this.tooltipEventArgs.target,event:this.tooltipEventArgs.event?this.tooltipEventArgs.event:null,element:this.tooltipEle,isInteracted:!m(this.tooltipEventArgs.event)};this.trigger("afterClose",e),e=null},t.prototype.calculateTooltipOffset=function(e,i,r){i===void 0&&(i=1),r===void 0&&(r=1);var n={top:0,left:0},a,o,l,h,u,c,f,d;if(i!==1||r!==1){var p=this.tooltipEle.getBoundingClientRect(),v=void 0;l=Math.round(p.width),h=Math.round(p.height),u=ye("."+$a,this.tooltipEle),u&&(v=u.getBoundingClientRect()),a=u?Math.round(v.width):0,o=u?Math.round(v.height):0,c=this.showTipPointer?Gg:Xg,f=o/2+Os+(h-this.tooltipEle.clientHeight*r),d=a/2+Os+(l-this.tooltipEle.clientWidth*i)}else l=this.tooltipEle.offsetWidth,h=this.tooltipEle.offsetHeight,u=ye("."+$a,this.tooltipEle),a=u?u.offsetWidth:0,o=u?u.offsetHeight:0,c=this.showTipPointer?Gg:Xg,f=o/2+Os+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),d=a/2+Os+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(c+=UB),e){case"RightTop":n.left+=a+c,n.top-=h-f;break;case"RightCenter":n.left+=a+c,n.top-=h/2;break;case"RightBottom":n.left+=a+c,n.top-=f;break;case"BottomRight":n.top+=o+c,n.left-=d;break;case"BottomCenter":n.top+=o+c,n.left-=l/2;break;case"BottomLeft":n.top+=o+c,n.left-=l-d;break;case"LeftBottom":n.left-=a+l+c,n.top-=f;break;case"LeftCenter":n.left-=a+l+c,n.top-=h/2;break;case"LeftTop":n.left-=a+l+c,n.top-=h-f;break;case"TopLeft":n.top-=h+o+c,n.left-=l-d;break;case"TopRight":n.top-=h+o+c,n.left-=d;break;default:n.top-=h+o+c,n.left-=l/2;break}return n.left+=this.offsetX,n.top+=this.offsetY,n},t.prototype.updateTipPosition=function(e){var i=dt("."+$a+",."+Zg+",."+pu,this.tooltipEle),r=[nl,td,eb,id];Z(i,r),this.setTipClass(e),P(i,this.tipClass)},t.prototype.adjustArrow=function(e,i,r,n){var a=ye("."+$a,this.tooltipEle);if(!(this.showTipPointer===!1||a===null)){this.updateTipPosition(i);var o,l;this.tooltipEle.style.display="block";var h=this.tooltipEle.clientWidth,u=this.tooltipEle.clientHeight,c=ye("."+pu,this.tooltipEle),f=a.offsetWidth,d=a.offsetHeight;if(this.tooltipEle.style.display="",this.tipClass===nl||this.tipClass===td){if(this.tipClass===nl?(l="99.9%",c.style.top="-"+(d-2)+"px"):(l=-(d-1)+"px",c.style.top="-"+(d-6)+"px"),e){var p=r!=="Center"||h>e.offsetWidth||this.mouseTrail;p&&r==="Left"||!p&&this.tipPointerPosition==="End"?o=h-f-Os+"px":p&&r==="Right"||!p&&this.tipPointerPosition==="Start"?o=Os+"px":p&&(this.tipPointerPosition==="End"||this.tipPointerPosition==="Start")?o=this.tipPointerPosition==="End"?e.offsetWidth+(this.tooltipEle.offsetWidth-e.offsetWidth)/2-f/2-Os+"px":(this.tooltipEle.offsetWidth-e.offsetWidth)/2-f/2+Os+"px":o=h/2-f/2+"px"}}else{this.tipClass===id?(o="99.9%",c.style.left="-"+(f-2)+"px"):(o=-(f-1)+"px",c.style.left=-f+(f-2)+"px");var p=n!=="Center"||u>e.offsetHeight||this.mouseTrail;p&&n==="Top"||!p&&this.tipPointerPosition==="End"?l=u-d-Os+"px":p&&n==="Bottom"||!p&&this.tipPointerPosition==="Start"?l=Os+"px":l=u/2-d/2+"px"}a.style.top=l,a.style.left=o}},t.prototype.renderContent=function(e){var i=this,r=ye("."+Qg,this.tooltipEle);if(this.cssClass&&P([this.tooltipEle],this.cssClass.split(" ")),e&&!m(e.getAttribute("title"))&&(e.setAttribute("data-content",e.getAttribute("title")),e.removeAttribute("title")),m(this.content))e&&!m(e.getAttribute("data-content"))&&(r.innerHTML=e.getAttribute("data-content"));else if(r.innerHTML="",this.content instanceof HTMLElement)r.appendChild(this.content);else if(typeof this.content=="string")if(this.isAngular?this.setProperties({content:mr.sanitize(this.content)},!0):this.content=this.enableHtmlSanitizer?mr.sanitize(this.content):this.content,this.enableHtmlParse){var n=wt(this.content),a=n({},this,"content",this.element.id+"content",void 0,void 0,r,this.root);a&&at(a,r)}else r.textContent=this.content;else{var o=wt(this.content),a=o({},this,"content",this.element.id+"content",void 0,void 0,r);a&&(this.isAngular&&setTimeout(function(){i.reposition(e)},1),at(a,r)),this.renderReactTemplates()}},t.prototype.renderCloseIcon=function(){if(!this.isSticky){var e=this.tooltipEle.querySelector("."+Yg+"."+Jg);e&&Zi(e);return}var i=this.createElement("div",{className:Yg+" "+Jg,attrs:{role:"button","aria-label":"Press escape to close the Tooltip"}});this.tooltipEle.appendChild(i),R.add(i,xe.touchStartEvent,this.onStickyClose,this)},t.prototype.addDescribedBy=function(e,i){var r=(e.getAttribute("aria-describedby")||"").split(/\s+/);r.indexOf(i)<0&&r.push(i),Pe(e,{"aria-describedby":r.join(" ").trim(),"data-tooltip-id":i})},t.prototype.removeDescribedBy=function(e){var i=e.getAttribute("data-tooltip-id"),r=(e.getAttribute("aria-describedby")||"").split(/\s+/),n=r.indexOf(i);n!==-1&&r.splice(n,1),e.removeAttribute("data-tooltip-id");var a=r.join(" ").trim();a?e.setAttribute("aria-describedby",a):e.removeAttribute("aria-describedby")},t.prototype.tapHoldHandler=function(e){clearTimeout(this.autoCloseTimer),this.targetHover(e.originalEvent)},t.prototype.touchEndHandler=function(){var e=this;if(!this.isSticky){var i=function(){e.close()};this.autoCloseTimer=setTimeout(i,zB)}},t.prototype.targetClick=function(e){var i;if(this.target?i=X(e.target,this.target):i=this.element,!m(i)){var r=e;i.getAttribute("data-tooltip-id")===null?r.type==="mousedown"&&r.button===2||this.targetHover(e):this.isSticky||this.hideTooltip(this.animation.close,e,i)}},t.prototype.targetHover=function(e){var i;if(this.target?i=X(e.target,this.target):i=this.element,!(m(i)||i.getAttribute("data-tooltip-id")!==null&&this.closeDelay===0)){!m(this.tooltipEle)&&this.tooltipEle.getAttribute("e-animation-id")&&(vr.stop(this.tooltipEle),this.clear());for(var r=[].slice.call(dt('[data-tooltip-id= "'+this.ctrlId+'_content"]',document)),n=0,a=r;n<a.length;n++){var o=a[n];this.restoreElement(o)}this.showTooltip(i,this.animation.open,e)}},t.prototype.mouseMoveBeforeOpen=function(e){this.mouseMoveEvent=e},t.prototype.mouseMoveBeforeRemove=function(){this.mouseMoveTarget&&R.remove(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen)},t.prototype.showTooltip=function(e,i,r){var n=this;clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.openDelay&&this.mouseTrail&&(this.mouseMoveBeforeRemove(),this.mouseMoveTarget=e,R.add(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen,this)),this.tooltipEventArgs={type:r?r.type:null,cancel:!1,target:e,event:r||null,element:this.tooltipEle,isInteracted:!m(r)};var a=function(o){n.beforeRenderCallback(o,e,r,i)};this.trigger("beforeRender",this.tooltipEventArgs,a.bind(this))},t.prototype.beforeRenderCallback=function(e,i,r,n){e.cancel?(this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove()):(this.isHidden=!1,m(this.tooltipEle)?(this.ctrlId=this.element.getAttribute("id")?fi(this.element.getAttribute("id")):fi("tooltip"),this.tooltipEle=this.createElement("div",{className:ed+" "+rd+" "+mu,attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"}}),this.tooltipEle.style.width=st(this.width),this.tooltipEle.style.height=st(this.height),this.tooltipEle.style.position="absolute",this.tooltipBeforeRender(i,this),this.tooltipAfterRender(i,r,n,this)):i&&(this.adjustArrow(i,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(i,this.ctrlId+"_content"),this.renderContent(i),vr.stop(this.tooltipEle),this.reposition(i),this.tooltipAfterRender(i,r,n,this)))},t.prototype.appendContainer=function(e){typeof this.container=="string"?this.container==="body"?this.containerElement=document.body:(this.isBodyContainer=!1,this.containerElement=ye(this.container,document)):this.container instanceof HTMLElement&&(this.containerElement=this.container,this.isBodyContainer=this.containerElement.tagName==="BODY"),this.isBodyContainer||P([this.containerElement],tb),this.containerElement.appendChild(e.tooltipEle)},t.prototype.tooltipBeforeRender=function(e,i){e&&(xe.isDevice&&P([i.tooltipEle],$B),i.width!=="auto"&&(i.tooltipEle.style.maxWidth=st(i.width)),i.tooltipEle.appendChild(i.createElement("div",{className:Qg})),this.appendContainer(i),Z([i.tooltipEle],qB),i.addDescribedBy(e,i.ctrlId+"_content"),i.renderContent(e),P([i.tooltipEle],al),i.showTipPointer&&i.renderArrow(),i.renderCloseIcon(),i.renderPopup(e),i.adjustArrow(e,i.position,i.tooltipPositionX,i.tooltipPositionY),vr.stop(i.tooltipEle),i.reposition(e))},t.prototype.tooltipAfterRender=function(e,i,r,n){if(e){Z([n.tooltipEle],al),P([n.tooltipEle],sd),n.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:e,event:i||null,element:n.tooltipEle,isInteracted:!m(i)},n.needTemplateReposition()&&!n.mouseTrail&&(r.effect==="None"||r.effect==="FadeIn"||this.isReact&&typeof n.content!="string")&&(n.tooltipEle.style.display="none");var a=function(o){n.beforeOpenCallback(o,e,r,i)};n.trigger("beforeOpen",n.tooltipEventArgs,a.bind(n))}},t.prototype.beforeOpenCallback=function(e,i,r,n){var a=this;if(e.cancel)this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove(),this.restoreElement(i);else{var o={name:r.effect==="None"&&Yu==="Enable"?"FadeIn":this.animation.open.effect,duration:r.duration,delay:r.delay,timingFunction:"easeOut"};if(r.effect==="None"&&(o=void 0),this.openDelay>0){var l=function(){a.mouseTrail&&R.add(i,"mousemove touchstart mouseenter",a.onMouseMove,a),a.popupObj&&(a.popupObj.show(o,i),a.mouseMoveEvent&&a.mouseTrail&&a.onMouseMove(a.mouseMoveEvent))};this.showTimer=setTimeout(l,this.openDelay)}else this.popupObj&&this.popupObj.show(o,i)}n&&this.wireMouseEvents(n,i)},t.prototype.needTemplateReposition=function(){var e=this;return!m(e.viewContainerRef)&&typeof e.viewContainerRef!="string"||this.isReact},t.prototype.checkCollision=function(e,i,r){var n={left:i,top:r,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},a=Gc(this.tooltipEle,this.checkCollideTarget(),i,r);return a.length>0&&(n.horizontal=a.indexOf("left")>=0?"Right":a.indexOf("right")>=0?"Left":this.tooltipPositionX,n.vertical=a.indexOf("top")>=0?"Bottom":a.indexOf("bottom")>=0?"Top":this.tooltipPositionY),n},t.prototype.calculateElementPosition=function(e,i){return[this.isBodyContainer?e.left+i.left:e.left-this.containerElement.getBoundingClientRect().left+i.left+window.pageXOffset+this.containerElement.scrollLeft,this.isBodyContainer?e.top+i.top:e.top-this.containerElement.getBoundingClientRect().top+i.top+window.pageYOffset+this.containerElement.scrollTop]},t.prototype.collisionFlipFit=function(e,i,r){var n=this.checkCollision(e,i,r),a=n.position;if(this.tooltipPositionY!==n.vertical&&(a=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?n.vertical+this.tooltipPositionX:this.tooltipPositionX+n.vertical),this.tooltipPositionX!==n.horizontal&&(a.indexOf("Left")===0&&(n.vertical=a==="LeftTop"||a==="LeftCenter"?"Top":"Bottom",a=n.vertical+"Left"),a.indexOf("Right")===0&&(n.vertical=a==="RightTop"||a==="RightCenter"?"Top":"Bottom",a=n.vertical+"Right"),n.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:e,event:null,element:this.tooltipEle,collidedPosition:a},this.trigger("beforeCollision",this.tooltipEventArgs),this.tooltipEventArgs.cancel)a=this.position;else{var o=n.vertical,l=n.horizontal;if(n.position!==a){var h=Tr(e,l,o,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect());this.adjustArrow(e,a,l,o);var u=this.getScalingFactor(e),c=this.calculateTooltipOffset(a,u.x,u.y);c.top-=this.getOffSetPosition("TopBottom",a,this.offsetY),c.left-=this.getOffSetPosition("RightLeft",a,this.offsetX),n.position=a;var f=this.calculateElementPosition(h,c);n.left=f[0],n.top=f[1]}else this.adjustArrow(e,a,l,o)}var d={left:n.left,top:n.top},p=this.isBodyContainer?bw(this.tooltipEle,this.checkCollideTarget(),{X:!0,Y:this.windowCollision},d):d;this.tooltipEle.style.display="block";var v=ye("."+$a,this.tooltipEle);if(this.showTipPointer&&v!=null&&(a.indexOf("Bottom")===0||a.indexOf("Top")===0)){var g=parseInt(v.style.left,10)-(p.left-n.left);g<0?g=0:g+v.offsetWidth>this.tooltipEle.clientWidth&&(g=this.tooltipEle.clientWidth-v.offsetWidth),v.style.left=g.toString()+"px"}return this.tooltipEle.style.display="",d.left=p.left,d.top=p.top,d},t.prototype.getOffSetPosition=function(e,i,r){return e.indexOf(this.position.split(/(?=[A-Z])/)[0])!==-1&&e.indexOf(i.split(/(?=[A-Z])/)[0])!==-1?2*r:0},t.prototype.checkCollideTarget=function(){return!this.windowCollision&&this.target?this.element:null},t.prototype.hideTooltip=function(e,i,r){var n=this;if(this.closeDelay>0){clearTimeout(this.hideTimer),clearTimeout(this.showTimer);var a=function(){n.closeDelay&&n.tooltipEle&&n.isTooltipOpen||n.tooltipHide(e,i,r)};this.hideTimer=setTimeout(a,this.closeDelay)}else this.tooltipHide(e,i,r)},t.prototype.tooltipHide=function(e,i,r){var n=this,a;i?a=this.target?r||i.target:this.element:a=ye('[data-tooltip-id= "'+this.ctrlId+'_content"]',document),this.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:a,event:i||null,element:this.tooltipEle,isInteracted:!m(i)},this.trigger("beforeClose",this.tooltipEventArgs,function(o){o.cancel?n.isHidden=!1:(n.mouseMoveBeforeRemove(),n.popupHide(e,a,i))})},t.prototype.popupHide=function(e,i,r){i&&r&&this.restoreElement(i),this.isHidden=!0;var n={name:e.effect==="None"&&Yu==="Enable"?"FadeOut":this.animation.close.effect,duration:e.duration,delay:e.delay,timingFunction:"easeIn"};e.effect==="None"&&(n=void 0),this.popupObj&&this.popupObj.hide(n)},t.prototype.restoreElement=function(e){this.unwireMouseEvents(e),m(e.getAttribute("data-content"))||(e.setAttribute("title",e.getAttribute("data-content")),e.removeAttribute("data-content")),this.removeDescribedBy(e)},t.prototype.clear=function(){var e=this.findTarget();e&&this.restoreElement(e),this.tooltipEle&&(Z([this.tooltipEle],sd),P([this.tooltipEle],al)),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&Zi(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)},t.prototype.tooltipHover=function(){this.tooltipEle&&(this.isTooltipOpen=!0)},t.prototype.tooltipMouseOut=function(e){this.isTooltipOpen=!1,this.hideTooltip(this.animation.close,e,this.findTarget())},t.prototype.onMouseOut=function(e){var i=e.relatedTarget;if(i&&!this.mouseTrail){var r=X(i,"."+ed+"."+mu+"."+rd);r?R.add(r,"mouseleave",this.tooltipElementMouseOut,this):(this.hideTooltip(this.animation.close,e,this.findTarget()),this.closeDelay===0&&(this.animation.close.effect==="None"||this.isReact&&typeof this.content!="string")&&this.clear())}else this.hideTooltip(this.animation.close,e,this.findTarget()),this.clear();this.popupObj&&!this.popupObj.element.classList.contains(al)&&this.clear()},t.prototype.tooltipElementMouseOut=function(e){this.hideTooltip(this.animation.close,e,this.findTarget()),R.remove(this.element,"mouseleave",this.tooltipElementMouseOut),this.clear()},t.prototype.onStickyClose=function(){this.close()},t.prototype.onMouseMove=function(e){var i=0,r=0;if(e.type.indexOf("touch")>-1?(e.preventDefault(),i=e.touches[0].pageX,r=e.touches[0].pageY):(i=e.pageX,r=e.pageY),!m(this.tooltipEle)){vr.stop(this.tooltipEle),Z([this.tooltipEle],sd),P([this.tooltipEle],al),this.adjustArrow(e.target,this.position,this.tooltipPositionX,this.tooltipPositionY);var n=this.getScalingFactor(e.target),a=this.calculateTooltipOffset(this.position,n.x,n.y),o=i+a.left+this.offsetX,l=r+a.top+this.offsetY,h=this.checkCollision(e.target,o,l);if(this.tooltipPositionX!==h.horizontal||this.tooltipPositionY!==h.vertical){var u=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?h.vertical+h.horizontal:h.horizontal+h.vertical;h.position=u,this.adjustArrow(e.target,h.position,h.horizontal,h.vertical);var c=this.calculateTooltipOffset(h.position,n.x,n.y);h.left=i+c.left-this.offsetX,h.top=r+c.top-this.offsetY}this.tooltipEle.style.left=h.left+"px",this.tooltipEle.style.top=h.top+"px"}},t.prototype.keyDown=function(e){this.tooltipEle&&e.keyCode===27&&this.close()},t.prototype.touchEnd=function(e){this.tooltipEle&&X(e.target,"."+Zf)===null&&!this.isSticky&&this.close()},t.prototype.scrollHandler=function(e){this.tooltipEle&&!this.isSticky&&!X(e.target,"."+ed+"."+mu+"."+rd)&&!this.isSticky&&this.close()},t.prototype.render=function(){this.initialize(),this.wireEvents(this.opensOn),this.renderComplete()},t.prototype.preRender=function(){this.tipClass=nl,this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0},t.prototype.wireEvents=function(e){for(var i=this.getTriggerList(e),r=0,n=i;r<n.length;r++){var a=n[r];if(a==="Custom")return;a==="Focus"&&this.wireFocusEvents(),a==="Click"&&R.add(this.element,xe.touchStartEvent,this.targetClick,this),a==="Hover"&&(xe.isDevice?(this.touchModule=new Dl(this.element,{tapHoldThreshold:jB,tapHold:this.tapHoldHandler.bind(this)}),R.add(this.element,xe.touchEndEvent,this.touchEndHandler,this)):R.add(this.element,"mouseover",this.targetHover,this))}this.windowResizeBound=this.windowResize.bind(this),this.keyDownBound=this.keyDown.bind(this),this.touchEndBound=this.touchEnd.bind(this),this.scrollWheelBound=this.scrollHandler.bind(this),document.addEventListener("wheel",this.scrollWheelBound),document.addEventListener("scroll",this.scrollWheelBound),document.addEventListener("touchend",this.touchEndBound),document.addEventListener("keydown",this.keyDownBound),window.addEventListener("resize",this.windowResizeBound)},t.prototype.getTriggerList=function(e){return e?(e==="Auto"&&(e=xe.isDevice?"Hover":"Hover Focus"),e.split(" ")):[]},t.prototype.wireFocusEvents=function(){if(m(this.target))R.add(this.element,"focusin",this.targetHover,this);else{var e=[].slice.call(dt(this.target,this.element));if(this.targetsList=e,!m(this.targetsList)&&this.targetsList.length>0)for(var i=0,r=e;i<r.length;i++){var n=r[i];R.add(n,"focus",this.targetHover,this)}else R.add(this.element,"focusin",this.targetHover,this)}},t.prototype.wireMouseEvents=function(e,i){this.tooltipEle&&(this.isSticky||(e.type==="focus"&&R.add(i,"blur",this.onMouseOut,this),e.type==="focusin"&&R.add(i,"focusout",this.onMouseOut,this),e.type==="mouseover"&&R.add(i,"mouseleave",this.onMouseOut,this),this.closeDelay&&(R.add(this.tooltipEle,"mouseenter",this.tooltipHover,this),R.add(this.tooltipEle,"mouseleave",this.tooltipMouseOut,this))),this.mouseTrail&&this.openDelay===0&&R.add(i,"mousemove touchstart mouseenter",this.onMouseMove,this))},t.prototype.unwireEvents=function(e){for(var i=this.getTriggerList(e),r=0,n=i;r<n.length;r++){var a=n[r];if(a==="Custom")return;a==="Focus"&&this.unwireFocusEvents(),a==="Click"&&R.remove(this.element,xe.touchStartEvent,this.targetClick),a==="Hover"&&(xe.isDevice?(this.touchModule&&this.touchModule.destroy(),R.remove(this.element,xe.touchEndEvent,this.touchEndHandler)):R.remove(this.element,"mouseover",this.targetHover))}document.removeEventListener("touchend",this.touchEndBound),this.touchEndBound=null,document.removeEventListener("wheel",this.scrollWheelBound),document.removeEventListener("scroll",this.scrollWheelBound),this.scrollWheelBound=null,window.removeEventListener("resize",this.windowResizeBound),this.windowResizeBound=null,document.removeEventListener("keydown",this.keyDownBound),this.keyDownBound=null},t.prototype.unwireFocusEvents=function(){if(m(this.target))R.remove(this.element,"focusin",this.targetHover);else{var e=[].slice.call(dt(this.target,this.element));if(!m(this.targetsList)&&this.targetsList.length>0)for(var i=0,r=e;i<r.length;i++){var n=r[i];R.remove(n,"focus",this.targetHover)}else R.remove(this.element,"focusin",this.targetHover)}},t.prototype.unwireMouseEvents=function(e){if(!this.isSticky){for(var i=this.getTriggerList(this.opensOn),r=0,n=i;r<n.length;r++){var a=n[r];a==="Focus"&&(R.remove(e,"blur",this.onMouseOut),R.remove(e,"focusout",this.onMouseOut)),a==="Hover"&&!xe.isDevice&&R.remove(e,"mouseleave",this.onMouseOut)}this.closeDelay&&(R.remove(e,"mouseenter",this.tooltipHover),R.remove(e,"mouseleave",this.tooltipMouseOut))}this.mouseTrail&&R.remove(e,"mousemove touchstart mouseenter",this.onMouseMove)},t.prototype.findTarget=function(){var e=ye('[data-tooltip-id= "'+this.ctrlId+'_content"]',document);return e},t.prototype.getModuleName=function(){return"tooltip"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.onPropertyChanged=function(e,i){for(var r=this.findTarget(),n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];switch(o){case"width":this.tooltipEle&&r&&(this.tooltipEle.style.width=this.tooltipEle.style.maxWidth=st(e.width),this.reposition(r));break;case"height":this.tooltipEle&&r&&(this.tooltipEle.style.height=st(e.height),this.reposition(r));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(i.opensOn),this.wireEvents(e.opensOn);break;case"position":if(this.formatPosition(),this.tooltipEle&&r){var l=ye("."+pu,this.tooltipEle);l&&(l.style.top=l.style.left=null),this.reposition(r)}break;case"tipPointerPosition":this.tooltipEle&&r&&this.reposition(r);break;case"offsetX":if(this.tooltipEle){var h=e.offsetX-i.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+h).toString()+"px"}break;case"offsetY":if(this.tooltipEle){var u=e.offsetY-i.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+u).toString()+"px"}break;case"cssClass":this.tooltipEle&&(i.cssClass&&Z([this.tooltipEle],i.cssClass.split(" ")),e.cssClass&&P([this.tooltipEle],e.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?P([this.tooltipEle],Kg):Z([this.tooltipEle],Kg));break;case"isSticky":this.tooltipEle&&r&&(this.renderCloseIcon(),this.reposition(r));break;case"container":m(this.containerElement)||Z([this.containerElement],tb),this.container=e.container,this.tooltipEle&&r&&(this.appendContainer(this),this.reposition(r))}}},t.prototype.open=function(e,i){m(i)&&(i=this.animation.open),m(e)&&(e=this.element),e.style.display!=="none"&&this.showTooltip(e,i)},t.prototype.close=function(e){e||(e=this.animation.close),this.hideTooltip(e)},t.prototype.refresh=function(e){if(this.tooltipEle&&this.renderContent(e),this.popupObj&&e&&this.reposition(e),!m(this.targetsList)&&!m(this.target)){var i=dt(this.target,this.element);i.length!==this.targetsList.length&&(this.unwireEvents(this.opensOn),this.wireEvents(this.opensOn))}},t.prototype.destroy=function(){s.prototype.destroy.call(this),this.tooltipEle&&Zi(this.tooltipEle),this.popupObj&&this.popupObj.destroy(),Lw(),Z([this.element],Zf),this.unwireEvents(this.opensOn),this.unwireMouseEvents(this.element),this.tooltipEle=null,this.popupObj=null;for(var e=dt('[data-tooltip-id= "'+this.ctrlId+'_content"]',this.element),i=0,r=e;i<r.length;i++){var n=r[i];this.restoreElement(n)}this.containerElement=null,this.tipClass=null,this.tooltipPositionX=null,this.tooltipPositionY=null,this.ctrlId=null,this.tooltipEventArgs=null,this.touchModule=null,this.mouseMoveEvent=null,this.mouseMoveTarget=null,this.containerElement=null,this.targetsList=null},Lt([O("auto")],t.prototype,"width",void 0),Lt([O("auto")],t.prototype,"height",void 0),Lt([O()],t.prototype,"content",void 0),Lt([O("body")],t.prototype,"container",void 0),Lt([O()],t.prototype,"target",void 0),Lt([O("TopCenter")],t.prototype,"position",void 0),Lt([O(0)],t.prototype,"offsetX",void 0),Lt([O(0)],t.prototype,"offsetY",void 0),Lt([O(!0)],t.prototype,"showTipPointer",void 0),Lt([O(!0)],t.prototype,"enableHtmlParse",void 0),Lt([O(!1)],t.prototype,"windowCollision",void 0),Lt([O("Auto")],t.prototype,"tipPointerPosition",void 0),Lt([O("Auto")],t.prototype,"opensOn",void 0),Lt([O(!1)],t.prototype,"mouseTrail",void 0),Lt([O(!1)],t.prototype,"isSticky",void 0),Lt([Ur({},GB)],t.prototype,"animation",void 0),Lt([O(0)],t.prototype,"openDelay",void 0),Lt([O(0)],t.prototype,"closeDelay",void 0),Lt([O()],t.prototype,"cssClass",void 0),Lt([O(!0)],t.prototype,"enableHtmlSanitizer",void 0),Lt([O("")],t.prototype,"htmlAttributes",void 0),Lt([Se()],t.prototype,"beforeRender",void 0),Lt([Se()],t.prototype,"beforeOpen",void 0),Lt([Se()],t.prototype,"afterOpen",void 0),Lt([Se()],t.prototype,"beforeClose",void 0),Lt([Se()],t.prototype,"afterClose",void 0),Lt([Se()],t.prototype,"beforeCollision",void 0),Lt([Se()],t.prototype,"created",void 0),Lt([Se()],t.prototype,"destroyed",void 0),t=Lt([Wi],t),t}(Rr),Oi={},KB=30,YB=30,ib=30,JB=30,QB=30,ZB=30,e4=36,t4=36,nd="e-spin-show",$u="e-spin-hide",rb="e-spin-material",sb="e-spin-material3",nb="e-spin-tailwind3",ab="e-spin-fabric",ob="e-spin-fluent",lb="e-spin-fluent2",hb="e-spin-tailwind",i4="e-spin-bootstrap",ub="e-spin-bootstrap4",cb="e-spin-bootstrap5",fb="e-spin-high-contrast",lp="e-spinner-pane",mv="e-spinner-inner",Xc="e-path-circle",r4="e-path-arc",s4="e-spin-label",hp="e-spin-template",db=null,n4=null;function Kc(s,t){var e;if(s.target){var i,r=m(t)?Cs:t,n=O4(s.target,r);if(!m(s.cssClass)){var a=s.cssClass.split(" ").filter(function(u){return u.trim()!==""});(e=n.wrap.classList).add.apply(e,a)}if(!m(s.template)||!m(db)){var o=m(s.template)?db:s.template;n.wrap.classList.add(hp),k4(n.wrap,o,n4)}else{var l=m(s.type)?b4(n.wrap):s.type,h=m(s.width)?void 0:s.width;i=T4(h,l),y4(l,n.wrap,i,r),m(s.label)||a4(n.inner_wrap,s.label,r)}n.wrap.classList.add($u),n=null}}function a4(s,t,e){var i=e("div",{});return i.classList.add(s4),i.innerHTML=t,s.appendChild(i),i}function o4(s,t,e){var i=Ts();Oi[""+i]={timeOut:0,type:"Material",radius:t},kh(s,i,e,rb),Th(t,s,"Material",rb)}function l4(s,t,e){var i=Ts();Oi[""+i]={timeOut:0,type:"Tailwind3",radius:t},kh(s,i,e,nb),Th(t,s,"Tailwind3",nb)}function h4(s,t,e){var i=Ts();Oi[""+i]={timeOut:0,type:"Material3",radius:t},kh(s,i,e,sb),Th(t,s,"Material3",sb)}function u4(s,t,e){var i=Ts();Oi[""+i]={timeOut:0,type:"Bootstrap4",radius:t},kh(s,i,e,ub),Th(t,s,"Bootstrap4",ub)}function c4(s,t,e){var i=Ts();Oi[""+i]={timeOut:0,type:"Bootstrap5",radius:t},kh(s,i,e,cb),Th(t,s,"Bootstrap5",cb)}function f4(s,t,e){var i={},r=0;Oi[""+t].timeOut=0,i[""+t]=A4(t,e,0,0);var n={uniqueID:t,container:s,globalInfo:i,timeOutVar:r};_w(n)}function d4(s,t,e){var i=Ts();Oi[""+i]={timeOut:0,type:"Fabric",radius:t},Sh(s,i,ab),Ah(t,s,ab)}function p4(s,t,e){var i=Ts();Oi[""+i]={timeOut:0,type:"Fluent",radius:t},Sh(s,i,ob),Ah(t,s,ob)}function m4(s,t,e){var i=Ts();Oi[""+i]={timeOut:0,type:"Fluent2",radius:t},Sh(s,i,lb),Ah(t,s,lb)}function v4(s,t,e){var i=Ts();Oi[""+i]={timeOut:0,type:"Tailwind",radius:t},Sh(s,i,hb),Ah(t,s,hb)}function g4(s,t,e){var i=Ts();Oi[""+i]={timeOut:0,type:"HighContrast",radius:t},Sh(s,i,fb),Ah(t,s,fb)}function b4(s){var t=window.getComputedStyle(s,":after").getPropertyValue("content");return t.replace(/['"]+/g,"")}function y4(s,t,e,i){var r=t.querySelector("."+mv),n=r.querySelector("svg");switch(m(n)||r.removeChild(n),s){case"Material":o4(r,e,i);break;case"Material3":h4(r,e,i);break;case"Fabric":d4(r,e);break;case"Fluent":p4(r,e);break;case"Fluent2":m4(r,e);break;case"Bootstrap":x4(r,e);break;case"HighContrast":g4(r,e);break;case"Bootstrap4":u4(r,e,i);break;case"Bootstrap5":c4(r,e,i);break;case"Tailwind":case"Tailwind-dark":v4(r,e);break;case"Tailwind3":l4(r,e,i);break}}function x4(s,t,e){var i=Ts();Oi[""+i]={timeOut:0,type:"Bootstrap",radius:t},C4(s,i),w4(s,t)}function C4(s,t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=64,n=32,a=2;i.setAttribute("id",t),i.setAttribute("class",i4),i.setAttribute("viewBox","0 0 "+r+" "+r),s.insertBefore(i,s.firstChild);for(var o=0;o<=7;o++){var l=document.createElementNS("http://www.w3.org/2000/svg","circle");l.setAttribute("class",Xc+"_"+o),l.setAttribute("r",a+""),l.setAttribute("transform","translate("+n+","+n+")"),i.appendChild(l)}}function w4(s,t){var e=s.querySelector("svg.e-spin-bootstrap"),i=0,r=0,n=24;e.style.width=e.style.height=t+"px";for(var a=90,o=0;o<=7;o++){var l=up(i,r,n,a),h=e.querySelector("."+Xc+"_"+o);h.setAttribute("cx",l.x+""),h.setAttribute("cy",l.y+""),a=a>=360?0:a,a=a+45}}function E4(s,t){var e=[],i=s,r=t,n=!1,a=1;o(i);function o(l){e.push(l),(l!==r||a===1)&&(l<=i&&l>1&&!n?l=parseFloat((l-.2).toFixed(2)):l===1?(l=7,l=parseFloat((l+.2).toFixed(2)),n=!0):l<8&&n?(l=parseFloat((l+.2).toFixed(2)),l===8&&(n=!1)):l<=8&&!n&&(l=parseFloat((l-.2).toFixed(2))),++a,o(l))}return e}function S4(s){for(var t=s.querySelector("svg.e-spin-bootstrap"),e=t.getAttribute("id"),i=1;i<=8;i++){var r=s.getElementsByClassName("e-path-circle_"+(i===8?0:i))[0];n(r,i,i,E4(i,i),e)}function n(a,o,l,h,u){var c=0;f(o);function f(d){Oi[""+u].isAnimate&&(++c,a.setAttribute("r",d+""),c>=h.length&&(c=0),Oi[u].timeOut=setTimeout(f.bind(null,h[c]),18))}}}function k4(s,t,e){m(e)||s.classList.add(e);var i=s.querySelector(".e-spinner-inner");i.innerHTML=t}function T4(s,t){var e;switch(t){case"Material":e=KB;break;case"Material3":e=YB;break;case"Fabric":e=ib;break;case"Tailwind":case"Tailwind-dark":case"Tailwind3":e=ib;break;case"Fluent":e=JB;break;case"Fluent2":e=QB;break;case"Bootstrap4":e=e4;break;case"Bootstrap5":e=t4;break;default:e=ZB}return s=s?parseFloat(s+""):e,t==="Bootstrap"?s:s/2}function A4(s,t,e,i){return{radius:t,count:e,previousId:i}}function Ts(){for(var s="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=0;e<5;e++)s+=t.charAt(Math.floor(Math.random()*t.length));return s}function Sh(s,t,e,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("id",t),r.setAttribute("class",e);var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("class",Xc);var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("class",r4),s.insertBefore(r,s.firstChild),r.appendChild(n),r.appendChild(a)}function kh(s,t,e,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("class",i),r.setAttribute("id",t),n.setAttribute("class",Xc),s.insertBefore(r,s.firstChild),r.appendChild(n)}function O4(s,t){var e=t("div",{}),i=t("div",{});return e.classList.add(lp),i.classList.add(mv),i.setAttribute("aria-disabled","true"),s.appendChild(e),e.appendChild(i),{wrap:e,inner_wrap:i}}function _w(s){var t=1,e=149,i=1333,r=75;D4(t,e,I4,i,s.globalInfo[s.uniqueID].count,r,s),s.globalInfo[s.uniqueID].count=++s.globalInfo[s.uniqueID].count%4}function D4(s,t,e,i,r,n,a){var o=++a.globalInfo[a.uniqueID].previousId,l=new Date().getTime(),h=t-s,u=L4(a.globalInfo[a.uniqueID].radius*2+""),c=Fw(u),f=-90*(a.globalInfo[a.uniqueID].count||0);d(a);function d(v){var g=Math.max(0,Math.min(new Date().getTime()-l,i));p(e(g,s,h,i),v.container),o===v.globalInfo[v.uniqueID].previousId&&g<i?Oi[v.uniqueID].timeOut=setTimeout(d.bind(null,v),1):_w(v)}function p(v,g){if(!m(g.querySelector("svg.e-spin-material"))||!m(g.querySelector("svg.e-spin-material3"))||!m(g.querySelector("svg.e-spin-tailwind3"))){var b=void 0;if(!m(g.querySelector("svg.e-spin-material"))&&!m(g.querySelector("svg.e-spin-material").querySelector("path.e-path-circle"))?b=g.querySelector("svg.e-spin-material"):!m(g.querySelector("svg.e-spin-material3"))&&!m(g.querySelector("svg.e-spin-material3").querySelector("path.e-path-circle"))?b=g.querySelector("svg.e-spin-material3"):!m(g.querySelector("svg.e-spin-tailwind3"))&&!m(g.querySelector("svg.e-spin-tailwind3").querySelector("path.e-path-circle"))&&(b=g.querySelector("svg.e-spin-tailwind3")),!m(b)){var C=b.querySelector("path.e-path-circle");C.setAttribute("stroke-dashoffset",Nw(u,c,v,n)+""),C.setAttribute("transform","rotate("+f+" "+u/2+" "+u/2+")")}}}}function Th(s,t,e,i){var r=s*2,n=t.querySelector("svg."+i),a=n.querySelector("path.e-path-circle"),o=Fw(r),l=r/2+"px";n.setAttribute("viewBox","0 0 "+r+" "+r),n.style.width=n.style.height=r+"px",n.style.transformOrigin=l+" "+l+" "+l,a.setAttribute("d",R4(r,o)),(e==="Material"||e==="Material3"||e==="Fluent2"||e==="Tailwind3")&&(a.setAttribute("stroke-width",o+""),a.setAttribute("stroke-dasharray",(r-o)*Math.PI*.75+""),a.setAttribute("stroke-dashoffset",Nw(r,o,1,75)+""))}function L4(s){var t=parseFloat(s);return t}function R4(s,t){var e=s/2,i=t/2;return"M"+e+","+i+"A"+(e-i)+","+(e-i)+" 0 1 1 "+i+","+e}function Fw(s){return 10/100*s}function Nw(s,t,e,i){return(s-t)*Math.PI*(3*i/100-e/100)}function I4(s,t,e,i){var r=(s/=i)*s,n=r*s;return t+e*(6*n*r+-15*r*r+10*n)}function Ah(s,t,e){var i=s,r=s,n=s*2,a=315,o=45,l=t.querySelector("."+e),h=l.querySelector(".e-path-circle"),u=l.querySelector(".e-path-arc"),c=n/2+"px";h.setAttribute("d",F4(i,r,s)),u.setAttribute("d",_4(i,r,s,a,o)),l.setAttribute("viewBox","0 0 "+n+" "+n),l.style.transformOrigin=c+" "+c+" "+c,l.style.width=l.style.height=n+"px"}function up(s,t,e,i){var r=(i-90)*Math.PI/180;return{x:s+e*Math.cos(r),y:t+e*Math.sin(r)}}function _4(s,t,e,i,r){var n=up(s,t,e,r),a=up(s,t,e,i),o=["M",n.x,n.y,"A",e,e,0,0,0,a.x,a.y].join(" ");return o}function F4(s,t,e){var i=["M",s,t,"m",-e,0,"a",e,e,0,1,0,e*2,0,"a",e,e,0,1,0,-e*2,0].join(" ");return i}function Yc(s){Mw(s,!1),s=null}function Mw(s,t){var e;if(s)if(s.classList.contains(lp))e=s;else{var i=s.querySelectorAll("."+lp);if(xe.isIE){for(var r=0;r<i.length;r++)if(i[r].parentElement&&i[r].parentElement===s){e=i[r];break}}else e=Array.from(i).find(function(h){return h.parentElement===s})||null}if(s&&e){var n=e.querySelector("."+mv),a=t?!e.classList.contains(hp)&&!e.classList.contains($u):!e.classList.contains(hp)&&!e.classList.contains(nd);if(a){var o=e.querySelector("svg");if(m(o))return;var l=o.getAttribute("id");switch(Oi[""+l].isAnimate=!t,Oi[""+l].type){case"Material":case"Material3":case"Tailwind3":t?clearTimeout(Oi[l].timeOut):f4(n,l,Oi[l].radius);break;case"Bootstrap":t?clearTimeout(Oi[l].timeOut):S4(n);break}}t?On(e,[$u],[nd]):On(e,[nd],[$u]),s=null}}function Jc(s){Mw(s,!0),s=null}var N4=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),hn=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},ad={TEXTSHAPE:"e-skeleton-text",CIRCLESHAPE:"e-skeleton-circle",SQUARESHAPE:"e-skeleton-square",RECTANGLESHAPE:"e-skeleton-rectangle",WAVEEFFECT:"e-shimmer-wave",PULSEEFFECT:"e-shimmer-pulse",FADEEFFECT:"e-shimmer-fade",VISIBLENONE:"e-visible-none"},pb;(function(s){s.Text="Text",s.Circle="Circle",s.Square="Square",s.Rectangle="Rectangle"})(pb||(pb={}));var mb;(function(s){s.Wave="Wave",s.Fade="Fade",s.Pulse="Pulse",s.None="None"})(mb||(mb={}));var M4=function(s){N4(t,s);function t(e,i){return s.call(this,e,i)||this}return t.prototype.getModuleName=function(){return"skeleton"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.preRender=function(){this.element.id||(this.element.id=fi("e-"+this.getModuleName())),this.updateCssClass(),Pe(this.element,{role:"alert","aria-busy":"true","aria-live":"polite","aria-label":this.label})},t.prototype.render=function(){this.initialize()},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];switch(a){case"width":case"height":this.updateDimension();break;case"shape":this.updateShape();break;case"shimmerEffect":this.updateEffect();break;case"visible":this.updateVisibility();break;case"label":this.element.setAttribute("aria-label",this.label);break;case"cssClass":i.cssClass&&Z([this.element],i.cssClass.split(" ")),this.updateCssClass();break}}},t.prototype.destroy=function(){s.prototype.destroy.call(this);var e=["role","aria-live","aria-busy","aria-label"],i=[];this.cssClass&&(i=i.concat(this.cssClass.split(" ")));for(var r=0;r<e.length;r++)this.element.removeAttribute(e[parseInt(r.toString(),10)]);i=i.concat(this.element.classList.value.match(/(e-skeleton-[^\s]+)/g)||[]),i=i.concat(this.element.classList.value.match(/(e-shimmer-[^\s]+)/g)||[]),Z([this.element],i)},t.prototype.initialize=function(){this.updateShape(),this.updateEffect(),this.updateVisibility()},t.prototype.updateShape=function(){if(!m(this.shape)){var e=ad[this.shape.toUpperCase()+"SHAPE"],i=this.element.classList.value.match(/(e-skeleton-[^\s]+)/g)||[];this.updateDimension(),i&&Z([this.element],i),P([this.element],[e])}},t.prototype.updateDimension=function(){var e=!this.width&&["Text","Rectangle"].indexOf(this.shape)>-1?"100%":st(this.width),i=["Circle","Square"].indexOf(this.shape)>-1?e:st(this.height);this.element.style.width=e,this.element.style.height=i},t.prototype.updateEffect=function(){var e=this.element.classList.value.match(/(e-shimmer-[^\s]+)/g)||[];e&&Z([this.element],e),m(this.shimmerEffect)||P([this.element],[ad[this.shimmerEffect.toUpperCase()+"EFFECT"]])},t.prototype.updateVisibility=function(){this.element.classList[this.visible?"remove":"add"](ad.VISIBLENONE)},t.prototype.updateCssClass=function(){this.cssClass&&P([this.element],this.cssClass.split(" "))},hn([O("")],t.prototype,"width",void 0),hn([O("")],t.prototype,"height",void 0),hn([O(!0)],t.prototype,"visible",void 0),hn([O("Text")],t.prototype,"shape",void 0),hn([O("Wave")],t.prototype,"shimmerEffect",void 0),hn([O("Loading...")],t.prototype,"label",void 0),hn([O("")],t.prototype,"cssClass",void 0),t=hn([Wi],t),t}(Rr),Pw=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),jt=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Bw=function(s){Pw(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return jt([O()],t.prototype,"text",void 0),jt([O()],t.prototype,"value",void 0),jt([O()],t.prototype,"iconCss",void 0),jt([O()],t.prototype,"groupBy",void 0),jt([O()],t.prototype,"htmlAttributes",void 0),jt([O()],t.prototype,"disabled",void 0),t}(Ir),ne={root:"e-dropdownbase",rtl:"e-rtl",content:"e-content",selected:"e-active",hover:"e-hover",noData:"e-nodata",fixedHead:"e-fixed-head",focus:"e-item-focus",li:"e-list-item",group:"e-list-group-item",disabled:"e-disabled",grouping:"e-dd-group",virtualList:"e-list-item e-virtual-list"},P4="ItemTemplate",B4="DisplayTemplate",H4="SpinnerTemplate",V4="ValueTemplate",W4="GroupTemplate",z4="HeaderTemplate",j4="FooterTemplate",U4="NoRecordsTemplate",$4="ActionFailureTemplate",q4="e-hide-group-header",Hw=function(s){Pw(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.preventChange=!1,r.isPreventChange=!1,r.isDynamicDataChange=!1,r.addedNewItem=!1,r.isAddNewItemTemplate=!1,r.isRequesting=!1,r.isVirtualizationEnabled=!1,r.isCustomDataUpdated=!1,r.isAllowFiltering=!1,r.virtualizedItemsCount=0,r.isCheckBoxSelection=!1,r.totalItemCount=0,r.dataCount=0,r.remoteDataCount=-1,r.isRemoteDataUpdated=!1,r.isIncrementalRequest=!1,r.itemCount=30,r.virtualListHeight=0,r.isVirtualScrolling=!1,r.isPreventScrollAction=!1,r.scrollPreStartIndex=0,r.isScrollActionTriggered=!1,r.previousStartIndex=0,r.isMouseScrollAction=!1,r.isKeyBoardAction=!1,r.isScrollChanged=!1,r.isUpwardScrolling=!1,r.startIndex=0,r.currentPageNumber=0,r.pageCount=0,r.isPreventKeyAction=!1,r.generatedDataObject={},r.skeletonCount=32,r.isVirtualTrackHeight=!1,r.virtualSelectAll=!1,r.isVirtualReorder=!1,r.incrementalQueryString="",r.incrementalEndIndex=0,r.incrementalStartIndex=0,r.incrementalPreQueryString="",r.isObjectCustomValue=!1,r.appendUncheckList=!1,r.getInitialData=!1,r.preventPopupOpen=!0,r.virtualSelectAllState=!1,r.CurrentEvent=null,r.isDynamicData=!1,r.isPrimitiveData=!1,r.isCustomFiltering=!1,r.virtualListInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r.selectedValueInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r}return t.prototype.getPropObject=function(e,i,r){var n=new Object,a=new Object,o=function(h){return h};n[o(e)]=i[o(e)],a[o(e)]=r[o(e)];var l=new Object;return l.newProperty=n,l.oldProperty=a,l},t.prototype.getValueByText=function(e,i,r){var n=null;return m(this.listData)||(i?n=this.checkValueCase(e,!0,r):n=this.checkValueCase(e,!1,r)),n},t.prototype.checkValueCase=function(e,i,r,n){var a=this,o=null;if(n&&(o=e),!m(this.listData)){var l=this.listData,h=this.fields,u=this.typeOfData(l).typeof;if(u==="string"||u==="number"||u==="boolean")for(var c=0,f=l;c<f.length;c++){var d=f[c];m(d)||(r?o=this.checkingAccent(String(d),e,i):i?this.checkIgnoreCase(String(d),e)&&(o=this.getItemValue(String(d),e,i)):this.checkNonIgnoreCase(String(d),e)&&(o=this.getItemValue(String(d),e,i,n)))}else if(i)l.filter(function(v){var g=ie(h.value,v);!m(g)&&a.checkIgnoreCase(ie(h.text,v).toString(),e)&&(o=ie(h.value,v))});else if(n){var p=null;p=o,l.filter(function(v){var g=ie(h.value,v);!m(g)&&!m(o)&&g.toString()===p.toString()&&(o=ie(h.text,v))})}else l.filter(function(v){a.checkNonIgnoreCase(ie(h.text,v),e)&&(o=ie(h.value,v))})}return o},t.prototype.checkingAccent=function(e,i,r){var n=ue.ignoreDiacritics(String(e)),a=ue.ignoreDiacritics(i.toString()),o=null;return r?this.checkIgnoreCase(n,a)&&(o=this.getItemValue(String(e),i,r)):this.checkNonIgnoreCase(String(e),i)&&(o=this.getItemValue(String(e),i,r)),o},t.prototype.checkIgnoreCase=function(e,i){return String(e).toLowerCase()===i.toString().toLowerCase()},t.prototype.checkNonIgnoreCase=function(e,i){return String(e)===i.toString()},t.prototype.getItemValue=function(e,i,r,n){var a=null,o=this.listData,l=this.typeOfData(o).typeof;return n?a=e.toString():r?a=l==="string"?String(e):this.getFormattedValue(String(e)):a=l==="string"?i:this.getFormattedValue(i),a},t.prototype.templateCompiler=function(e){var i=!1;if(typeof e!="function"&&e)try{i=!!dt(e,document).length}catch(r){i=!1}return i},t.prototype.l10nUpdate=function(e){var i=this.getModuleName()==="listbox"?this.ulElement:this.list;if(!m(this.noRecordsTemplate)&&this.noRecordsTemplate!=="No records found"||this.actionFailureTemplate!=="Request failed"){var r=e?this.actionFailureTemplate:this.noRecordsTemplate,n=void 0,a=e?this.actionFailureTemplateId:this.noRecordsTemplateId;i.innerHTML="";var o=this.templateCompiler(r);typeof r!="function"&&o?n=wt(ye(r,document).innerHTML.trim()):n=wt(r);var l=e?"actionFailureTemplate":"noRecordsTemplate",h=void 0;if(this.isReact&&typeof r=="function"?h=n({},this,l,a,this.isStringTemplate,null):h=n({},this,l,a,this.isStringTemplate,null,i),h&&h.length>0)for(var u=0;u<h.length;u++)if(this.getModuleName()==="listbox"&&l==="noRecordsTemplate")if(h[u].nodeName==="#text"){var c=this.createElement("li");c.textContent=h[u].textContent,c.classList.add("e-list-nrt"),c.setAttribute("role","option"),i.appendChild(c)}else h[u].classList.add("e-list-nr-template"),i.appendChild(h[u]);else(h[u]instanceof HTMLElement||h[u]instanceof Text&&h[u].textContent!=="")&&i.appendChild(h[u]);this.renderReactTemplates()}else{var f={noRecordsTemplate:"No records found",actionFailureTemplate:"Request failed"},d=new br(this.getLocaleName(),{},this.locale);d.getConstant("actionFailureTemplate")!==""||d.getConstant("noRecordsTemplate")!==""?this.l10n=d:this.l10n=new br(this.getModuleName()==="listbox"?"listbox":this.getModuleName()==="mention"?"mention":"dropdowns",f,this.locale);var p=e?this.l10n.getConstant("actionFailureTemplate"):this.l10n.getConstant("noRecordsTemplate");if(this.getModuleName()==="listbox"){var c=this.createElement("li");c.textContent=p,i.appendChild(c),c.classList.add("e-list-nrt"),c.setAttribute("role","option")}else m(i)||(i.innerHTML=p)}},t.prototype.checkAndResetCache=function(){this.isVirtualizationEnabled&&(this.generatedDataObject={},this.virtualItemStartIndex=this.virtualItemEndIndex=0,this.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount},this.selectedValueInfo=null)},t.prototype.updateIncrementalInfo=function(e,i){this.viewPortInfo.startIndex=e,this.viewPortInfo.endIndex=i,this.updateVirtualItemIndex(),this.isIncrementalRequest=!0,this.resetList(this.dataSource,this.fields,this.query),this.isIncrementalRequest=!1},t.prototype.updateIncrementalView=function(e,i){this.viewPortInfo.startIndex=e,this.viewPortInfo.endIndex=i,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+ne.li),this.ulElement=this.list.querySelector("ul")},t.prototype.updateVirtualItemIndex=function(){this.virtualItemStartIndex=this.viewPortInfo.startIndex,this.virtualItemEndIndex=this.viewPortInfo.endIndex,this.virtualListInfo=this.viewPortInfo},t.prototype.getFilteringSkeletonCount=function(){var e=this.skeletonCount;this.getSkeletonCount(!0),this.skeletonCount=this.dataCount<this.itemCount*2&&(!(this.dataSource instanceof fe)||this.dataSource instanceof fe&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount;var i=!0;if((this.getModuleName()==="autocomplete"||this.getModuleName()==="multiselect")&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof fe)||this.dataSource instanceof fe&&this.totalItemCount<=this.itemCount)&&(this.skeletonCount=0,i=!1),!this.list.classList.contains(ne.noData)){if(e!==this.skeletonCount&&i?this.UpdateSkeleton(!0,Math.abs(e-this.skeletonCount)):this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl").length>0)this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.skeletonCount>0&&this.list.querySelector(".e-dropdownbase")){var r=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl",styles:this.GetVirtualTrackHeight()});this.list.querySelector(".e-dropdownbase").appendChild(r)}this.list.getElementsByClassName("e-virtual-ddl-content").length>0&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues())}},t.prototype.getSkeletonCount=function(e){this.virtualListHeight=this.listContainerHeight!=null?parseInt(this.listContainerHeight,10):this.virtualListHeight;var i=this.virtualListHeight>0&&this.listItemHeight>0?Math.floor(this.virtualListHeight/this.listItemHeight):0;this.skeletonCount=i*4<this.itemCount?this.itemCount:i*4,this.itemCount=e?this.itemCount:this.skeletonCount,this.virtualItemCount=this.itemCount,this.skeletonCount=Math.floor(this.skeletonCount/2)},t.prototype.GetVirtualTrackHeight=function(){var e=this.totalItemCount===this.viewPortInfo.endIndex?this.totalItemCount*this.listItemHeight-this.itemCount*this.listItemHeight:this.totalItemCount*this.listItemHeight;e=this.isVirtualTrackHeight?0:e;var i="height: "+(e-this.itemCount*this.listItemHeight)+"px;";return(this.getModuleName()==="autocomplete"||this.getModuleName()==="multiselect")&&this.skeletonCount===0?"height: 0px;":i},t.prototype.getTransformValues=function(){var e=this.viewPortInfo.startIndex*this.listItemHeight;e=e-this.skeletonCount*this.listItemHeight,e=this.viewPortInfo.startIndex===0&&this.listData&&this.listData.length===0||this.skeletonCount===0?0:e;var i="transform: translate(0px, "+e+"px);";return i},t.prototype.UpdateSkeleton=function(e,i){var r=this.list.querySelector(".e-virtual-ddl-content"),n=this.list.querySelector(".e-virtual-list");if(r&&(!n||e)&&this.isVirtualizationEnabled)for(var a=e?i:this.skeletonCount,o=0;o<a;o++){var l=this.createElement("li",{className:ne.virtualList,styles:"overflow: inherit"});this.isVirtualizationEnabled&&this.itemTemplate&&(l.style.height=this.listItemHeight-parseInt(window.getComputedStyle(this.getItems()[1]).marginBottom,10)+"px");var h=new M4({shape:"Text",height:"10px",width:"95%",cssClass:"e-skeleton-text"});h.appendTo(this.createElement("div")),l.appendChild(h.element),r.firstChild&&r.firstChild.insertBefore(l,r.firstChild.children[0])}},t.prototype.getLocaleName=function(){return"drop-down-base"},t.prototype.getTextByValue=function(e){var i=this.checkValueCase(e,!1,!1,!0);return i},t.prototype.getFormattedValue=function(e){if(this.listData&&this.listData.length){var i=void 0;if(this.properties.allowCustomValue&&this.properties.value&&this.properties.value instanceof Array&&this.properties.value.length>0?i=this.typeOfData(this.properties.value):i=this.typeOfData(this.listData),typeof ie(this.fields.value?this.fields.value:"value",i.item)=="number"||i.typeof==="number")return parseFloat(e);if(typeof ie(this.fields.value?this.fields.value:"value",i.item)=="boolean"||i.typeof==="boolean")return e==="true"||""+e=="true"}return e},t.prototype.setEnableRtl=function(){m(this.enableRtlElements)||(this.list&&this.enableRtlElements.push(this.list),this.enableRtl?P(this.enableRtlElements,ne.rtl):Z(this.enableRtlElements,ne.rtl))},t.prototype.initialize=function(e){if(this.bindEvent=!0,this.preventPopupOpen=!0,this.actionFailureTemplateId=""+this.element.id+$4,this.element.tagName==="UL"){var i=Ft.createJsonFromElement(this.element);this.setProperties({fields:{text:"text",value:"text"}},!0),this.resetList(i,this.fields)}else if(this.element.tagName==="SELECT"){var r=this.dataSource instanceof Array?this.dataSource.length>0:!m(this.dataSource);r?this.isDynamicDataChange&&this.setListData(this.dataSource,this.fields,this.query):this.renderItemsBySelect()}else this.setListData(this.dataSource,this.fields,this.query,e)},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.updateDataAttribute=function(e){for(var i=["class","style","id","type","aria-expanded","aria-autocomplete","aria-readonly"],r={},n=0;n<this.element.attributes.length;n++)i.indexOf(this.element.attributes[n].name)===-1&&!(this.getModuleName()==="dropdownlist"&&this.element.attributes[n].name==="readonly")&&(r[this.element.attributes[n].name]=this.element.getAttribute(this.element.attributes[n].name));Ue(r,e,r),this.setProperties({htmlAttributes:r},!0)},t.prototype.renderItemsBySelect=function(){var e=this.element,i=e.querySelectorAll("select>optgroup"),r,n=this.getModuleName()==="multiselect"&&this.isGroupChecking&&i.length>0;r=n?{value:"value",text:"text",groupBy:"categeory"}:r={value:"value",text:"text"};var a=[],o=e.querySelectorAll("select>option");if(this.getJSONfromOption(a,o,r),i.length){for(var l=0;l<i.length;l++){var h=i[l],u={};u[r.text]=h.label,u.isHeader=!0;var c=h.querySelectorAll("option");n?this.getJSONfromOption(a,c,r,h.label):(a.push(u),this.getJSONfromOption(a,c,r))}e.querySelectorAll("select>option")}this.updateFields(r.text,r.value,n?r.groupBy:this.fields.groupBy,this.fields.htmlAttributes,this.fields.iconCss,this.fields.disabled),this.resetList(a,r)},t.prototype.updateFields=function(e,i,r,n,a,o){var l={fields:{text:e,value:i,groupBy:m(r)?this.fields&&this.fields.groupBy:r,htmlAttributes:m(n)?this.fields&&this.fields.htmlAttributes:n,iconCss:m(a)?this.fields&&this.fields.iconCss:a,disabled:m(o)?this.fields&&this.fields.disabled:o}};this.setProperties(l,!0)},t.prototype.getJSONfromOption=function(e,i,r,n){n===void 0&&(n=null);for(var a=0,o=i;a<o.length;a++){var l=o[a],h={};h[r.text]=l.innerText,h[r.value]=m(l.getAttribute(r.value))?l.innerText:l.getAttribute(r.value),m(n)||(h[r.groupBy]=n),e.push(h)}},t.prototype.preRender=function(){this.scrollTimer=-1,this.enableRtlElements=[],this.isRequested=!1,this.isDataFetched=!1,this.itemTemplateId=""+this.element.id+P4,this.displayTemplateId=""+this.element.id+B4,this.spinnerTemplateId=""+this.element.id+H4,this.valueTemplateId=""+this.element.id+V4,this.groupTemplateId=""+this.element.id+W4,this.headerTemplateId=""+this.element.id+z4,this.footerTemplateId=""+this.element.id+j4,this.noRecordsTemplateId=""+this.element.id+U4},t.prototype.setListData=function(e,i,r,n){var a=this;i=i||this.fields;var o;this.isActive=!0;var l={cancel:!1,data:e,query:r};this.isPreventChange=this.isAngular&&this.preventChange?!0:this.isPreventChange,this.isRequesting||this.trigger("actionBegin",l,function(h){if(!h.cancel)if(a.isRequesting=!0,a.showSpinner(),e instanceof fe){a.isRequested=!0;var u=!1;if(a.isDataFetched){a.emptyDataRequest(i);return}h.data.executeQuery(a.getQuery(h.query)).then(function(C){a.isPreventChange=a.isAngular&&a.preventChange?!0:a.isPreventChange;var y=!0;if(!a.virtualSelectAll){for(var x=a.getQuery(h.query),w=0;w<x.queries.length;w++)x.queries[w].fn==="onWhere"&&(u=!0);if(a.isVirtualizationEnabled&&C.count!==0&&C.count<a.itemCount*2){if(x)for(var w=0;w<x.queries.length;w++)x.queries[w].fn==="onTake"&&(x.queries[w].e.nos=C.count),a.getModuleName()==="multiselect"&&(x.queries[w].e.condition==="or"||x.queries[w].e.operator==="equal")&&!a.isCustomFiltering&&(y=!1)}else if(a.isVirtualTrackHeight=!1,x)for(var w=0;w<x.queries.length;w++)a.getModuleName()==="multiselect"&&(x.queries[w].e&&x.queries[w].e.condition==="or"||x.queries[w].e&&x.queries[w].e.operator==="equal")&&(y=!1)}y&&(a.dataCount=a.totalItemCount=C.count),a.trigger("actionComplete",C,function(S){if(!S.cancel){a.isRequesting=!1,a.isCustomFiltering=!1;var E=S.result;if(a.isIncrementalRequest){o=a.renderItems(E,i);return}if((!a.isVirtualizationEnabled&&E.length===0||a.isVirtualizationEnabled&&E.length===0&&!u)&&(a.isDataFetched=!0),u||(a.remoteDataCount=S.count),a.dataCount=a.virtualSelectAll?a.dataCount:S.count,a.totalItemCount=a.virtualSelectAll?a.totalItemCount:S.count,o=a.renderItems(E,i),a.appendUncheckList=!1,a.onActionComplete(o,E,S),a.groupTemplate&&a.renderGroupTemplate(o),a.isRequested=!1,a.bindChildItems(E,o,i,S),a.getInitialData){a.getInitialData=!1,a.preventPopupOpen=!1;return}a.isVirtualizationEnabled&&a.setCurrentView&&a.notify("setCurrentViewDataAsync",{module:"VirtualScroll"}),a.keyboardEvent!=null&&a.handleVirtualKeyboardActions(a.keyboardEvent,a.pageCount),a.isVirtualizationEnabled&&(a.getFilteringSkeletonCount(),a.updatePopupPosition()),a.virtualSelectAll&&a.virtualSelectAllData&&(a.virtualSelectionAll(a.virtualSelectAllState,a.liCollections,a.CurrentEvent),a.virtualSelectAllState=!1,a.CurrentEvent=null,a.virtualSelectAll=!1)}})}).catch(function(C){a.isRequested=!1,a.isRequesting=!1,a.onActionFailure(C),a.hideSpinner()})}else{a.isRequesting=!1;var c=!0,f=void 0;if(a.isVirtualizationEnabled&&!a.virtualGroupDataSource&&a.fields.groupBy){var d=new fe(a.dataSource).executeLocal(new We().group(a.fields.groupBy));a.virtualGroupDataSource=d.records}var p=a.isVirtualizationEnabled&&a.virtualGroupDataSource&&!a.isCustomDataUpdated?new fe(a.virtualGroupDataSource):new fe(h.data);if(f=a.getQuery(h.query).executeLocal(p),!a.virtualSelectAll){var v=a.getQuery(h.query);if(a.isVirtualizationEnabled&&f.count!==0&&f.count<a.itemCount*2&&!a.appendUncheckList){if(v){for(var g=0;g<v.queries.length;g++)v.queries[g].fn==="onTake"&&(v.queries[g].e.nos=f.count,f=v.executeLocal(p)),a.getModuleName()==="multiselect"&&(v.queries[g].e.condition==="or"||v.queries[g].e.operator==="equal")&&!a.isCustomFiltering&&(c=!1);c&&(f=v.executeLocal(p),a.isVirtualTrackHeight=!(a.dataSource instanceof fe)&&!a.isCustomDataUpdated)}}else if(a.isVirtualTrackHeight=!1,v)for(var g=0;g<v.queries.length;g++)a.getModuleName()==="multiselect"&&(v.queries[g].e&&v.queries[g].e.condition==="or"||v.queries[g].e&&v.queries[g].e.operator==="equal")&&(c=!1)}c&&!(a.dataSource instanceof fe)&&!a.isCustomDataUpdated&&!a.virtualSelectAll&&(a.dataCount=a.totalItemCount=a.virtualSelectAll?f.length:f.count),f=a.isVirtualizationEnabled?f.result:f;var b={cancel:!1,result:f};a.isPreventChange=a.isAngular&&a.preventChange?!0:a.isPreventChange,a.trigger("actionComplete",b,function(C){if(a.isCustomFiltering=!1,a.isIncrementalRequest){o=a.renderItems(C.result,i);return}if(!C.cancel){if(o=a.renderItems(C.result,i),a.onActionComplete(o,C.result,n),a.groupTemplate&&a.renderGroupTemplate(o),a.bindChildItems(C.result,o,i),a.getInitialData){a.getInitialData=!1,a.preventPopupOpen=!1;return}setTimeout(function(){a.getModuleName()==="multiselect"&&a.itemTemplate!=null&&o.childElementCount>0&&(o.children[0].childElementCount>0||a.fields.groupBy&&o.children[1]&&o.children[1].childElementCount>0)&&a.updateDataList()})}})}})},t.prototype.handleVirtualKeyboardActions=function(e,i){},t.prototype.updatePopupState=function(){},t.prototype.updatePopupPosition=function(){},t.prototype.virtualSelectionAll=function(e,i,r){},t.prototype.updateRemoteData=function(){this.setListData(this.dataSource,this.fields,this.query)},t.prototype.bindChildItems=function(e,i,r,n){var a=this;e.length>=100&&this.getModuleName()==="autocomplete"?setTimeout(function(){var o=a.remainingItems(a.sortedData,r);at(o,i),a.liCollections=a.list.querySelectorAll("."+ne.li),a.updateListValues(),a.raiseDataBound(e,n)},0):this.raiseDataBound(e,n)},t.prototype.isObjectInArray=function(e,i){return i.some(function(r){return Object.keys(e).every(function(n){return Object.prototype.hasOwnProperty.call(r,n)&&r[n]===e[n]})})},t.prototype.updateListValues=function(){},t.prototype.findListElement=function(e,i,r,n){var a=null;if(e){for(var o=[].slice.call(e.querySelectorAll(i)),l=0;l<o.length;l++)if(o[l].getAttribute(r)===n+""){a=o[l];break}}return a},t.prototype.raiseDataBound=function(e,i){this.hideSpinner();var r={items:e,e:i};this.trigger("dataBound",r)},t.prototype.remainingItems=function(e,i){var r=new fe(e).executeLocal(new We().skip(100));if(this.itemTemplate){var n=this.templateListItem(r,i);return[].slice.call(n.childNodes)}var a=this.typeOfData(r).typeof;return a==="string"||a==="number"||a==="boolean"?Ft.createListItemFromArray(this.createElement,r,!0,this.listOption(r,i),this):Ft.createListItemFromJson(this.createElement,r,this.listOption(r,i),1,!0,this)},t.prototype.emptyDataRequest=function(e){var i=[];this.onActionComplete(this.renderItems(i,e),i),this.isRequested=!1,this.isRequesting=!1,this.hideSpinner()},t.prototype.showSpinner=function(){},t.prototype.hideSpinner=function(){},t.prototype.onActionFailure=function(e){this.liCollections=[],this.trigger("actionFailure",e),this.l10nUpdate(!0),m(this.list)||P([this.list],ne.noData)},t.prototype.onActionComplete=function(e,i,r){if(this.listData=i,this.isVirtualizationEnabled&&!this.isCustomDataUpdated&&!this.virtualSelectAll&&this.notify("setGeneratedData",{module:"VirtualScroll"}),this.getModuleName()!=="listbox"&&e.setAttribute("tabindex","0"),this.isReact&&this.clearTemplate(["itemTemplate","groupTemplate","actionFailureTemplate","noRecordsTemplate"]),this.isVirtualizationEnabled||(this.fixedHeaderElement=m(this.fixedHeaderElement)?this.fixedHeaderElement:null),this.getModuleName()==="multiselect"&&this.properties.allowCustomValue&&this.fields.groupBy)for(var n=0;n<e.childElementCount;n++)e.children[n].classList.contains("e-list-group-item")&&(m(e.children[n].innerHTML)||e.children[n].innerHTML==="")&&P([e.children[n]],q4),e.children[0].classList.contains("e-hide-group-header")&&ia(e.children[1],{zIndex:11});m(this.list)||this.isVirtualizationEnabled||(this.list.innerHTML="",this.list.appendChild(e),this.liCollections=this.list.querySelectorAll("."+ne.li),this.ulElement=this.list.querySelector("ul"),this.postRender(this.list,i,this.bindEvent))},t.prototype.postRender=function(e,i,r){if(this.fields.disabled){for(var n=e.querySelectorAll("."+ne.li),a=0;a<n.length;a++)if(JSON.parse(JSON.stringify(this.listData[a]))[this.fields.disabled])if(m(this.fields.groupBy))this.disableListItem(n[a]);else{var o=this.listData[a],l=ie(this.fields.value?this.fields.value:"value",o),h=e.querySelector('li[data-value="'+l+'"]');m(h)||this.disableListItem(h)}}var u=this.fields.disabled?e.querySelector("."+ne.li+":not(.e-disabled"):e.querySelector("."+ne.li),c=e.querySelector("."+ne.selected);if(u&&!c){if(this.isVirtualizationEnabled&&this.viewPortInfo.startIndex!==0){var f=this.ulElement.querySelectorAll("li."+ne.li+":not(.e-virtual-list):not(.e-hide-listitem)");u=f&&f.length>0?f[2]:u}u&&u.classList.add(ne.focus)}i.length<=0?(this.l10nUpdate(),P([e],ne.noData)):e.classList.remove(ne.noData)},t.prototype.getQuery=function(e){return e||(this.query?this.query:new We)},t.prototype.updateVirtualizationProperties=function(e,i,r){this.isVirtualizationEnabled=!0,this.virtualizedItemsCount=e,this.isAllowFiltering=i,this.isCheckBoxSelection=r},t.prototype.renderGroupTemplate=function(e){if(this.fields.groupBy!==null&&this.dataSource||this.element.querySelector("."+ne.group)){var i=this.dataSource,r={groupTemplateID:this.groupTemplateId,isStringTemplate:this.isStringTemplate},n=e.querySelectorAll("."+ne.group),a=this.templateCompiler(this.groupTemplate);if(typeof this.groupTemplate!="function"&&a){var o=ye(this.groupTemplate,document).innerHTML.trim(),l=Ft.renderGroupTemplate(o,i,this.fields.properties,n,r,this);if(this.isGroupChecking)for(var h=0;h<l.length;h++)this.notify("addItem",{module:"CheckBoxSelection",item:l[h]})}else{var l=Ft.renderGroupTemplate(this.groupTemplate,i,this.fields.properties,n,r,this);if(this.isGroupChecking)for(var h=0;h<l.length;h++)this.notify("addItem",{module:"CheckBoxSelection",item:l[h]})}this.renderReactTemplates()}},t.prototype.createListItems=function(e,i){if(e){if(i.groupBy||this.element.querySelector("optgroup")){if(i.groupBy){this.sortOrder!=="None"&&(e=this.getSortedDataSource(e));var r=i.properties||i;e=Ft.groupDataSource(e,r,this.sortOrder)}P([this.list],ne.grouping)}else(this.getModuleName()!=="listbox"||this.getModuleName()==="listbox"&&!this.preventDefActionFilter)&&(e=this.getSortedDataSource(e));var n=this.listOption(e,i),a=e.length>100?new fe(e).executeLocal(new We().take(100)):e;return this.sortedData=e,Ft.createList(this.createElement,this.getModuleName()==="autocomplete"?a:e,n,!0,this)}return null},t.prototype.listOption=function(e,i){var r=!m(i.iconCss),n=m(i.properties)?i:i.properties,a=i.text!==null||i.value!==null?{fields:n,showIcon:r,ariaAttributes:{groupItemRole:"presentation"}}:{fields:{value:"text"}};return Ue({},a,i,!0)},t.prototype.setFloatingHeader=function(e){!m(this.list)&&!this.list.classList.contains(ne.noData)&&(m(this.fixedHeaderElement)&&(this.fixedHeaderElement=this.createElement("div",{className:ne.fixedHead}),!m(this.list)&&!this.list.querySelector("li").classList.contains(ne.group)&&(this.fixedHeaderElement.style.display="none"),!m(this.fixedHeaderElement)&&!m(this.list)&&Ii([this.fixedHeaderElement],this.list),this.setFixedHeader()),!m(this.fixedHeaderElement)&&this.fixedHeaderElement.style.zIndex==="0"&&this.setFixedHeader(),this.scrollStop(e))},t.prototype.scrollStop=function(e,i){for(var r=m(e)?this.list:e.target,n=getComputedStyle(this.getValidLi(),null).getPropertyValue("height"),a=getComputedStyle(this.getValidLi(),null).getPropertyValue("margin-bottom"),o=parseInt(a,10),l=this.getModuleName()==="multiselect"?parseFloat(n):parseInt(n,10),h=Math.round(r.scrollTop/(l+o)),u=this.list.querySelectorAll("li:not(.e-hide-listitem)"),c=this.list.querySelectorAll(".e-virtual-list").length,f=h;f>-1;f--){var d=this.isVirtualizationEnabled?f+c:f;if(this.isVirtualizationEnabled){if(this.fixedHeaderElement&&this.updateGroupHeader(d,u,r))break;i&&(!m(u[d])&&u[d].classList.contains(ne.selected)&&this.getModuleName()!=="autocomplete"||!m(u[d])&&u[d].classList.contains(ne.focus)&&this.getModuleName())}else if(this.updateGroupHeader(d,u,r))break}},t.prototype.getPageCount=function(e){if(this.list){var i=this.list.classList.contains(ne.noData)?null:getComputedStyle(this.getItems()[0],null).getPropertyValue("height"),r=Math.round(this.list.getBoundingClientRect().height/parseInt(i,10));return e?r:Math.round(r)}else return 0},t.prototype.updateGroupHeader=function(e,i,r){return!m(i[e])&&i[e].classList.contains(ne.group)?(this.updateGroupFixedHeader(i[e],r),!0):(this.fixedHeaderElement.style.display="none",this.fixedHeaderElement.style.top="none",!1)},t.prototype.updateGroupFixedHeader=function(e,i){this.fixedHeaderElement&&(m(e.innerHTML)||(this.fixedHeaderElement.innerHTML=e.innerHTML),this.fixedHeaderElement.style.position="fixed",this.fixedHeaderElement.style.top=this.list.parentElement.offsetTop+this.list.offsetTop-window.scrollY+"px",this.fixedHeaderElement.style.display="block")},t.prototype.getValidLi=function(){return this.isVirtualizationEnabled?this.liCollections[0].classList.contains("e-virtual-list")?this.liCollections[this.skeletonCount]:this.liCollections[0]:this.liCollections[0]},t.prototype.renderItems=function(e,i,r){var n;if(this.itemTemplate&&e){this.getModuleName()==="multiselect"&&this.virtualSelectAll&&(this.virtualSelectAllData=e,e=e.slice(this.virtualItemStartIndex,this.virtualItemEndIndex));var a=e;a&&i.groupBy?(this.sortOrder!=="None"&&(a=this.getSortedDataSource(a)),a=Ft.groupDataSource(a,i.properties,this.sortOrder)):(this.getModuleName()!=="listbox"||this.getModuleName()==="listbox"&&!this.preventDefActionFilter)&&(a=this.getSortedDataSource(a)),this.sortedData=a;var o=a.length>100?new fe(a).executeLocal(new We().take(100)):a;if(n=this.templateListItem(this.getModuleName()==="autocomplete"?o:a,i),this.isIncrementalRequest)return this.incrementalLiCollections=n.querySelectorAll("."+ne.li),this.incrementalUlElement=n,this.incrementalListData=e,n;if(this.isVirtualizationEnabled){var l=this.list.querySelector(".e-list-parent"),h=this.list.querySelector(".e-virtual-ddl-content");if(e.length>=this.virtualizedItemsCount&&l&&h||l&&h&&this.isAllowFiltering||l&&h&&this.getModuleName()==="autocomplete"){this.getModuleName()==="multiselect"&&this.isCheckBoxSelection&&this.appendUncheckList&&this.list&&this.list.querySelector(".e-active")?(h.appendChild(n),r=!0):h.replaceChild(n,l);var u=this.list.querySelectorAll(".e-reorder");this.list.querySelector(".e-virtual-ddl-content")&&u&&u.length>0&&!r&&this.list.querySelector(".e-virtual-ddl-content").removeChild(u[0]),this.updateListElements(e)}else h||(this.list.innerHTML="",this.createVirtualContent(),this.list.querySelector(".e-virtual-ddl-content").appendChild(n),this.updateListElements(e))}}else{if(this.getModuleName()==="multiselect"&&this.virtualSelectAll&&(this.virtualSelectAllData=e,e=e.slice(this.virtualItemStartIndex,this.virtualItemEndIndex)),n=this.createListItems(e,i),this.isIncrementalRequest)return this.incrementalLiCollections=n.querySelectorAll("."+ne.li),this.incrementalUlElement=n,this.incrementalListData=e,n;if(this.isVirtualizationEnabled){var l=this.list.querySelector(".e-list-parent:not(.e-reorder)"),h=this.list.querySelector(".e-virtual-ddl-content"),c=!1;(!l&&this.list.querySelector(".e-list-parent.e-reorder")||l&&this.isVirtualReorder&&this.list.querySelector(".e-list-parent.e-reorder"))&&(l=this.list.querySelector(".e-list-parent.e-reorder")),e.length>=this.virtualizedItemsCount&&l&&h||l&&h&&this.isAllowFiltering||l&&h&&(this.getModuleName()==="autocomplete"||this.getModuleName()==="multiselect")||c?(this.appendUncheckList?h.appendChild(n):h.replaceChild(n,l),this.updateListElements(e)):(!h||!h.firstChild)&&(this.list.innerHTML="",this.createVirtualContent(),this.list.querySelector(".e-virtual-ddl-content").appendChild(n),this.updateListElements(e))}}return n},t.prototype.createVirtualContent=function(){this.list.querySelector(".e-virtual-ddl-content")||this.list.appendChild(this.createElement("div",{className:"e-virtual-ddl-content"}))},t.prototype.updateListElements=function(e){this.liCollections=this.list.querySelectorAll("."+ne.li),this.ulElement=this.list.querySelector("ul"),this.listData=e,this.postRender(this.list,e,this.bindEvent)},t.prototype.templateListItem=function(e,i){var r=this.listOption(e,i);r.templateID=this.itemTemplateId,r.isStringTemplate=this.isStringTemplate;var n=this.templateCompiler(this.itemTemplate),a;if(typeof this.itemTemplate!="function"&&n){var o=ye(this.itemTemplate,document).innerHTML.trim();return a=Ft.renderContentTemplate(this.createElement,o,e,i.properties,r,this),this.isVirtualizationEnabled&&this.isReact&&this.renderReactTemplates(),a}else return a=Ft.renderContentTemplate(this.createElement,this.itemTemplate,e,i.properties,r,this),this.isVirtualizationEnabled&&this.isReact&&this.renderReactTemplates(),a},t.prototype.typeOfData=function(e){for(var i={typeof:null,item:null},r=0;!m(e)&&r<e.length;r++)if(!m(e[r])){var n=typeof e[r]=="string"||typeof e[r]=="number"||typeof e[r]=="boolean",a=n?m(e[r]):m(ie(this.fields.value?this.fields.value:"value",e[r]));if(!a)return i={typeof:typeof e[r],item:e[r]}}return i},t.prototype.setFixedHeader=function(){m(this.list)||(this.list.parentElement.style.display="block");var e=0;if(this.list&&this.list.parentElement&&(e=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-width"),10),isNaN(e))){var i=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-top-width"),10),r=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-bottom-width"),10),n=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-left-width"),10),a=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-right-width"),10);e=i+r+n+a}if(!m(this.liCollections)){var o=this.getValidLi().offsetWidth-e;this.fixedHeaderElement.style.width=o.toString()+"px"}ia(this.fixedHeaderElement,{zIndex:10});var l=this.ulElement.querySelector("."+ne.group+":not(.e-hide-listitem)");m(l)||(this.fixedHeaderElement.innerHTML=l.innerHTML)},t.prototype.getSortedDataSource=function(e){if(e&&this.sortOrder!=="None"){var i=this.fields.text?this.fields.text:"text";(this.typeOfData(e).typeof==="string"||this.typeOfData(e).typeof==="number"||this.typeOfData(e).typeof==="boolean")&&(i=""),e=Ft.getDataSource(e,Ft.addSorting(this.sortOrder,i))}return e},t.prototype.getIndexByValue=function(e){var i,r=[];this.fields.disabled&&this.getModuleName()==="multiselect"&&this.liCollections?r=this.liCollections:r=this.getItems();for(var n=0;n<r.length;n++)if(!m(e)&&r[n].getAttribute("data-value")===e.toString()){i=n;break}return i},t.prototype.getIndexByValueFilter=function(e,i){var r;if(!i)return null;var n=i.querySelectorAll("li:not(.e-list-group-item)");if(n){for(var a=0;a<n.length;a++)if(!m(e)&&n[a].getAttribute("data-value")===e.toString()){r=a;break}}return r},t.prototype.dispatchEvent=function(e,i){var r=document.createEvent("HTMLEvents");r.initEvent(i,!1,!0),e&&e.dispatchEvent(r)},t.prototype.setFields=function(){this.fields.value&&!this.fields.text?this.updateFields(this.fields.value,this.fields.value):!this.fields.value&&this.fields.text?this.updateFields(this.fields.text,this.fields.text):!this.fields.value&&!this.fields.text&&(this.isPrimitiveData=!0,this.updateFields("text","text"))},t.prototype.resetList=function(e,i,r,n){if(this.list){if(this.element.tagName==="SELECT"&&this.element.options.length>0||this.element.tagName==="UL"&&this.element.childNodes.length>0){var a=e instanceof Array?e.length>0:!m(e);!a&&this.selectData&&this.selectData.length>0&&(e=this.selectData)}e=this.getModuleName()==="combobox"&&this.selectData&&e instanceof Array&&e.length<this.selectData.length&&this.addedNewItem?this.selectData:e,this.addedNewItem=!1,this.setListData(e,i,r,n)}},t.prototype.updateSelectElementData=function(e){(e||this.isVirtualizationEnabled)&&m(this.selectData)&&this.listData&&this.listData.length>0&&(this.selectData=this.listData)},t.prototype.updateSelection=function(){},t.prototype.renderList=function(){this.render()},t.prototype.updateDataSource=function(e,i){this.resetList(this.dataSource),this.totalItemCount=this.dataSource instanceof fe?this.dataSource.dataSource.json.length:0},t.prototype.setUpdateInitial=function(e,i,r){this.isDataFetched=!1,this.isPrimitiveData=!1;for(var n={},a=0;e.length>a;a++)i[e[a]]&&e[a]==="fields"?(this.setFields(),n[e[a]]=i[e[a]]):i[e[a]]&&(n[e[a]]=i[e[a]]);Object.keys(n).length>0&&(Object.keys(n).indexOf("dataSource")===-1&&(n.dataSource=this.dataSource),this.getModuleName()==="listbox"?(!this.isReact||this.isReact&&(!m(i.dataSource)||!m(i.sortOrder)))&&this.updateDataSource(n,r):(this.isDynamicData=!0,this.updateDataSource(n,r)))},t.prototype.onPropertyChanged=function(e,i){this.getModuleName()==="dropdownbase"&&this.setUpdateInitial(["fields","query","dataSource"],e),this.setUpdateInitial(["sortOrder","itemTemplate"],e);for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];switch(a){case"query":case"sortOrder":case"dataSource":case"itemTemplate":break;case"enableRtl":this.setEnableRtl();break;case"groupTemplate":if(this.renderGroupTemplate(this.list),this.ulElement&&this.fixedHeaderElement){var o=this.ulElement.querySelector("."+ne.group);this.fixedHeaderElement.innerHTML=o.innerHTML}break;case"locale":this.list&&!m(this.liCollections)&&this.liCollections.length===0&&this.l10nUpdate();break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0),this.setZIndex();break}}},t.prototype.render=function(e,i){this.getModuleName()==="listbox"?this.list=this.createElement("div",{className:ne.content,attrs:{tabindex:"0"}}):this.list=this.createElement("div",{className:ne.content}),this.list.classList.add(ne.root),this.setFields();var r={duration:300,selector:"."+ne.li};this.rippleFun=os(this.list,r);var n=this.element.querySelector("select>optgroup");if((this.fields.groupBy||!m(n))&&!this.isGroupChecking){R.add(this.list,"scroll",this.setFloatingHeader,this);for(var a=this.getScrollableParent(),o=0;o<a.length;o++){var l=a[o];R.add(l,"scroll",this.updateGroupFixedHeader,this)}}if(this.getModuleName()==="dropdownbase"){this.element.getAttribute("tabindex")&&this.list.setAttribute("tabindex",this.element.getAttribute("tabindex")),Z([this.element],ne.root),this.element.style.display="none";var h=this.createElement("div");this.element.parentElement.insertBefore(h,this.element),h.appendChild(this.element),h.appendChild(this.list)}this.setEnableRtl(),i||this.initialize(e)},t.prototype.getScrollableParent=function(){for(var e=getComputedStyle(this.element),i=[],r=/(auto|scroll)/,n=this.element.parentElement;n&&n.tagName!=="HTML";){var a=getComputedStyle(n);!(e.position==="absolute"&&a.position==="static")&&r.test(a.overflow+a.overflowY+a.overflowX)&&i.push(n),n=n.parentElement}return i.push(document),i},t.prototype.removeScrollEvent=function(){this.list&&R.remove(this.list,"scroll",this.setFloatingHeader)},t.prototype.getModuleName=function(){return"dropdownbase"},t.prototype.getItems=function(){return this.ulElement.querySelectorAll("."+ne.li)},t.prototype.addItem=function(e,i){if((!this.list||this.list.textContent===this.noRecordsTemplate&&this.getModuleName()!=="listbox")&&this.renderList(),this.sortOrder!=="None"&&m(i)){var r=[].slice.call(this.listData);r.push(e),r=this.getSortedDataSource(r),this.fields.groupBy&&(r=Ft.groupDataSource(r,this.fields.properties,this.sortOrder)),i=r.indexOf(e)}var n=this.getItems().length,a=n===0,o=this.list.querySelector("."+ne.selected);e=e instanceof Array?e:[e];var l;l=m(i)||i<0||i>n-1?n:i;var h=this.fields;e&&h.groupBy&&(e=Ft.groupDataSource(e,h.properties));for(var u=[],c=0;c<e.length;c++){var f=e[c],d=f.isHeader,p=this.createElement("li",{className:d?ne.group:ne.li,id:"option-add-"+c}),v=f instanceof Object?ie(h.text,f):f;if(d&&(p.innerText=v),this.itemTemplate&&!d){var g=this.templateCompiler(this.itemTemplate),b=typeof this.itemTemplate!="function"&&g?wt(ye(this.itemTemplate,document).innerHTML.trim()):wt(this.itemTemplate),C=b(f,this,"itemTemplate",this.itemTemplateId,this.isStringTemplate,null,p);C&&at(C,p)}else d||p.appendChild(document.createTextNode(v));p.setAttribute("data-value",f instanceof Object?ie(h.value,f):f),p.setAttribute("role","option"),this.notify("addItem",{module:"CheckBoxSelection",item:p}),u.push(p),this.getModuleName()==="listbox"?(this.listData.splice(a?this.listData.length:l,0,f),this.listData.length!==this.sortedData.length&&(this.sortedData=this.listData)):this.listData.push(f),this.sortOrder==="None"&&m(i)&&l===0&&(l=null),this.getModuleName()==="listbox"?this.updateActionCompleteData(p,f,a?null:l+c):this.updateActionCompleteData(p,f,l),this.trigger("beforeItemRender",{element:p,item:f})}if(n===0&&m(this.list.querySelector("ul")))m(this.list)||(this.list.innerHTML="",this.list.classList.remove(ne.noData),this.isAddNewItemTemplate=!0,m(this.ulElement)||this.list.appendChild(this.ulElement)),this.liCollections=u,!m(u)&&!m(this.ulElement)&&at(u,this.ulElement),this.updateAddItemList(this.list,n);else{this.getModuleName()==="listbox"&&n===0&&(this.ulElement.innerHTML="");for(var y=[],c=0;c<e.length;c++){for(var x=this.ulElement.querySelectorAll(".e-list-group-item"),w=0;w<x.length;w++)y[w]=x[w].innerText;if(y.indexOf(u[c].innerText)>-1&&h.groupBy){for(var w=0;w<x.length;w++)if(y[w]===u[c].innerText){this.sortOrder==="None"?this.ulElement.insertBefore(u[c+1],x[w+1]):this.ulElement.insertBefore(u[c+1],this.ulElement.childNodes[i]),c=c+1;break}}else this.liCollections[l]&&this.liCollections[l].parentNode?this.liCollections[l].parentNode.insertBefore(u[c],this.liCollections[l]):i&&this.getModuleName()==="listbox"?this.ulElement.insertBefore(u[c],this.ulElement.childNodes[i+c]):this.ulElement.appendChild(u[c]);var S=[].slice.call(this.liCollections);S.splice(l,0,u[c]),this.liCollections=S,l+=1,this.getModuleName()==="multiselect"&&this.updateDataList()}}this.getModuleName()==="listbox"&&this.isReact&&this.renderReactTemplates(),(o||i===0)&&this.updateSelection(),this.addedNewItem=!0},t.prototype.isDisabledElement=function(e){return!!(e&&e.classList.contains("e-disabled"))},t.prototype.isDisabledItemByIndex=function(e){return this.fields.disabled&&this.liCollections?this.isDisabledElement(this.liCollections[e]):!1},t.prototype.disableListItem=function(e){e.classList.add("e-disabled"),e.setAttribute("aria-disabled","true"),e.setAttribute("aria-selected","false")},t.prototype.validationAttribute=function(e,i){var r=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");i.setAttribute("name",r),e.removeAttribute("name");for(var n=["required","aria-required","form"],a=0;a<n.length;a++)if(e.getAttribute(n[a])){var o=e.getAttribute(n[a]);i.setAttribute(n[a],o),e.removeAttribute(n[a])}},t.prototype.setZIndex=function(){},t.prototype.updateActionCompleteData=function(e,i,r){},t.prototype.updateAddItemList=function(e,i){},t.prototype.updateDataList=function(){},t.prototype.getDataByValue=function(e){if(!m(this.listData)){var i=this.typeOfData(this.listData).typeof;if(i==="string"||i==="number"||i==="boolean")for(var r=0,n=this.listData;r<n.length;r++){var a=n[r];if(!m(a)&&a===e)return a}else for(var o=0,l=this.listData;o<l.length;o++){var a=l[o];if(!m(a)&&ie(this.fields.value?this.fields.value:"value",a)===e)return a}}return null},t.prototype.destroy=function(){document&&(R.remove(document,"scroll",this.updateGroupFixedHeader),document.body.contains(this.list)&&(R.remove(this.list,"scroll",this.setFloatingHeader),m(this.rippleFun)||this.rippleFun(),Oe(this.list))),this.liCollections=null,this.ulElement=null,this.list=null,this.enableRtlElements=null,this.rippleFun=null,s.prototype.destroy.call(this)},jt([Ur({text:null,value:null,iconCss:null,groupBy:null,disabled:null},Bw)],t.prototype,"fields",void 0),jt([O(null)],t.prototype,"itemTemplate",void 0),jt([O(null)],t.prototype,"groupTemplate",void 0),jt([O("No records found")],t.prototype,"noRecordsTemplate",void 0),jt([O("Request failed")],t.prototype,"actionFailureTemplate",void 0),jt([O("None")],t.prototype,"sortOrder",void 0),jt([O([])],t.prototype,"dataSource",void 0),jt([O(null)],t.prototype,"query",void 0),jt([O("StartsWith")],t.prototype,"filterType",void 0),jt([O(!0)],t.prototype,"ignoreCase",void 0),jt([O(1e3)],t.prototype,"zIndex",void 0),jt([O(!1)],t.prototype,"ignoreAccent",void 0),jt([O()],t.prototype,"locale",void 0),jt([Se()],t.prototype,"actionBegin",void 0),jt([Se()],t.prototype,"actionComplete",void 0),jt([Se()],t.prototype,"actionFailure",void 0),jt([Se()],t.prototype,"select",void 0),jt([Se()],t.prototype,"dataBound",void 0),jt([Se()],t.prototype,"created",void 0),jt([Se()],t.prototype,"destroyed",void 0),t=jt([Wi],t),t}(Rr),je={RTL:"e-rtl",DISABLE:"e-disabled",INPUT:"e-input",TEXTAREA:"e-multi-line-input",INPUTGROUP:"e-input-group",FLOATINPUT:"e-float-input",FLOATLINE:"e-float-line",FLOATTEXT:"e-float-text",FLOATTEXTCONTENT:"e-float-text-content",CLEARICON:"e-clear-icon",CLEARICONHIDE:"e-clear-icon-hide",LABELTOP:"e-label-top",LABELBOTTOM:"e-label-bottom",NOFLOATLABEL:"e-no-float-label",INPUTCUSTOMTAG:"e-input-custom-tag",FLOATCUSTOMTAG:"e-float-custom-tag"},cp=["title","style","class"],vb="e-input-focus",Te;(function(s){var t=!0;function e(F,Q){F.element.__eventHandlers={};var pe=m(Q)?Cs:Q,ge={container:null,buttons:[],clearButton:null};if(F.floatLabelType,t=F.bindClearAction,m(F.floatLabelType)||F.floatLabelType==="Never"?(ge.container=te(F,je.INPUTGROUP,je.INPUTCUSTOMTAG,"span",pe),F.element.parentNode.insertBefore(ge.container,F.element),P([F.element],je.INPUT),ge.container.appendChild(F.element)):v(F,ge,pe),a(F),!m(F.properties)&&!m(F.properties.showClearButton)&&F.properties.showClearButton&&(_(F.properties.showClearButton,F.element,ge,!0,pe),ge.clearButton.setAttribute("role","button"),ge.container.classList.contains(je.FLOATINPUT)&&P([ge.container],je.INPUTGROUP)),!m(F.buttons))for(var Ee=0;Ee<F.buttons.length;Ee++)ge.buttons.push(Wt(F.buttons[Ee],ge.container,pe));return!m(F.element)&&F.element.tagName==="TEXTAREA"&&P([ge.container],je.TEXTAREA),li(ge.container,F.element),ge=C(F,ge),me(ge.container,pe),ge}s.createInput=e;function i(F){var Q=w(F.element);(Q.classList.contains("e-input-group")||Q.classList.contains("e-outline")||Q.classList.contains("e-filled"))&&Q.classList.add("e-input-focus"),F.floatLabelType!=="Never"&&setTimeout(function(){s.calculateWidth(F.element,Q)},80)}function r(F){var Q=w(F.element);(Q.classList.contains("e-input-group")||Q.classList.contains("e-outline")||Q.classList.contains("e-filled"))&&Q.classList.remove("e-input-focus"),F.floatLabelType!=="Never"&&setTimeout(function(){s.calculateWidth(F.element,Q)},80)}function n(F){l(F.floatLabelType,F.element)}function a(F){l(F.floatLabelType,F.element);var Q=function(){return i(F)},pe=function(){return r(F)},ge=function(){return n(F)};F.element.addEventListener("focus",Q),F.element.addEventListener("blur",pe),F.element.addEventListener("input",ge),F.element.__eventHandlers.inputFocusHandler={focusHandler:Q},F.element.__eventHandlers.inputBlurHandler={blurHandler:pe},F.element.__eventHandlers.inputHandler={inputHandler:ge}}s.bindInitialEvent=a;function o(F){if(!m(F.element)&&!m(F.element.__eventHandlers)&&!m(F.element.__eventHandlers.inputFocusHandler)&&!m(F.element.__eventHandlers.inputBlurHandler)&&!m(F.element.__eventHandlers.inputHandler)){var Q=F.element.__eventHandlers.inputFocusHandler.focusHandler,pe=F.element.__eventHandlers.inputBlurHandler.blurHandler,ge=F.element.__eventHandlers.inputHandler.inputHandler;F.element.removeEventListener("focus",Q),F.element.removeEventListener("blur",pe),F.element.removeEventListener("input",ge),delete F.element.__eventHandlers.inputFocusHandler,delete F.element.__eventHandlers.inputBlurHandler,delete F.element.__eventHandlers.inputHandler}}function l(F,Q){var pe=Q.value,ge=Q.parentElement,Ee=ge&&ge.parentElement;pe!==""&&!m(pe)?ge&&ge.classList.contains("e-input-group")?ge.classList.add("e-valid-input"):Ee&&Ee.classList.contains("e-input-group")&&Ee.classList.add("e-valid-input"):F!=="Always"&&(ge&&ge.classList.contains("e-input-group")?ge.classList.remove("e-valid-input"):Ee&&Ee.classList.contains("e-input-group")&&Ee.classList.remove("e-valid-input"))}function h(){var F=w(this).getElementsByClassName("e-float-text")[0];m(F)||(P([F],je.LABELTOP),F.classList.contains(je.LABELBOTTOM)&&Z([F],je.LABELBOTTOM))}function u(){var F=w(this);if(F.getElementsByTagName("textarea")[0]?F.getElementsByTagName("textarea")[0].value==="":F.getElementsByTagName("input")[0].value===""){var Q=F.getElementsByClassName("e-float-text")[0];m(Q)||(Q.classList.contains(je.LABELTOP)&&Z([Q],je.LABELTOP),P([Q],je.LABELBOTTOM))}}function c(F){F.addEventListener("focus",h),F.addEventListener("blur",u)}s.wireFloatingEvents=c;function f(F){m(F)||(F.removeEventListener("focus",h),F.removeEventListener("blur",u))}function d(F){K(F.element,F.floatLabelType)}function p(F){K(F.element,F.floatLabelType)}function v(F,Q,pe){var ge=m(pe)?Cs:pe;F.floatLabelType==="Auto"&&c(F.element),m(Q.container)?(Q.container=te(F,je.FLOATINPUT,je.FLOATCUSTOMTAG,"div",ge),Q.container.classList.add(je.INPUTGROUP),F.element.parentNode&&F.element.parentNode.insertBefore(Q.container,F.element)):(m(F.customTag)||Q.container.classList.add(je.FLOATCUSTOMTAG),Q.container.classList.add(je.FLOATINPUT));var Ee=ge("span",{className:je.FLOATLINE}),ke=ge("label",{className:je.FLOATTEXT});if(!m(F.element.id)&&F.element.id!==""&&(ke.id="label_"+F.element.id.replace(/ /g,"_"),Pe(F.element,{"aria-labelledby":ke.id})),!m(F.element.placeholder)&&F.element.placeholder!==""&&(ke.innerText=ee(F.element.placeholder),F.element.removeAttribute("placeholder")),!m(F.properties)&&!m(F.properties.placeholder)&&F.properties.placeholder!==""&&(ke.innerText=ee(F.properties.placeholder)),ke.innerText||Q.container.classList.add(je.NOFLOATLABEL),Q.container.classList.contains("e-float-icon-left")){var et=Q.container.querySelector(".e-input-in-wrap");et.appendChild(F.element),et.appendChild(Ee),et.appendChild(ke)}else Q.container.appendChild(F.element),Q.container.appendChild(Ee),Q.container.appendChild(ke);if(x(F.element.value,ke),F.floatLabelType==="Always"&&(ke.classList.contains(je.LABELBOTTOM)&&Z([ke],je.LABELBOTTOM),P([ke],je.LABELTOP)),F.floatLabelType==="Auto"){var At=function(){return d(F)},qt=function(){return p(F)};F.element.addEventListener("input",At),F.element.addEventListener("blur",qt),F.element.__eventHandlers.floatInputHandler={inputFloatHandler:At},F.element.__eventHandlers.floatBlurHandler={blurFloatHandler:qt}}else g(F);m(F.element.getAttribute("id"))||ke.setAttribute("for",F.element.getAttribute("id"))}function g(F){if(!m(F.element)&&!m(F.element.__eventHandlers)&&!m(F.element.__eventHandlers.floatInputHandler)&&!m(F.element.__eventHandlers.floatBlurHandler)){var Q=F.element.__eventHandlers.floatInputHandler.inputFloatHandler,pe=F.element.__eventHandlers.floatBlurHandler.blurFloatHandler;F.element.removeEventListener("input",Q),F.element.removeEventListener("blur",pe),delete F.element.__eventHandlers.floatInputHandler,delete F.element.__eventHandlers.floatBlurHandler}}function b(F,Q){F==="Always"&&Q.classList.contains("e-outline")&&Q.classList.add("e-valid-input")}function C(F,Q){if(!m(F.properties))for(var pe=0,ge=Object.keys(F.properties);pe<ge.length;pe++){var Ee=ge[pe];switch(Ee){case"cssClass":re(F.properties.cssClass,[Q.container]),b(F.floatLabelType,Q.container);break;case"enabled":L(F.properties.enabled,F.element,F.floatLabelType,Q.container);break;case"enableRtl":H(F.properties.enableRtl,[Q.container]);break;case"placeholder":we(F.properties.placeholder,F.element);break;case"readonly":N(F.properties.readonly,F.element);break}}return Q}function y(F,Q,pe){m(Q)||(F&&!pe?Z([Q],je.CLEARICONHIDE):P([Q],je.CLEARICONHIDE))}function x(F,Q,pe){if(pe===void 0&&(pe=null),F)P([Q],je.LABELTOP),Q.classList.contains(je.LABELBOTTOM)&&Z([Q],je.LABELBOTTOM);else{var ge=pe!=null?pe!==document.activeElement:!0;ge&&(Q.classList.contains(je.LABELTOP)&&Z([Q],je.LABELTOP),P([Q],je.LABELBOTTOM))}}function w(F){var Q=m(F.parentNode)?F:F.parentNode;return Q&&Q.classList.contains("e-input-in-wrap")&&(Q=Q.parentNode),Q}function S(F,Q,pe,ge){var Ee=m(ge)?Cs:ge,ke=Ee("span",{className:je.CLEARICON}),et=Q.container;if(!m(pe))et.appendChild(ke);else{var At=Q.container.classList.contains(je.FLOATINPUT)?Q.container.querySelector("."+je.FLOATTEXT):F;At.insertAdjacentElement("afterend",ke)}return P([ke],je.CLEARICONHIDE),D(F,ke),ke.setAttribute("aria-label","close"),ke}function E(F,Q,pe){Q.classList.contains(je.DISABLE)||Q.readOnly||(F.preventDefault(),Q!==document.activeElement&&Q.focus(),Q.value="",P([pe],je.CLEARICONHIDE))}function k(F,Q){y(F.value,Q)}function A(F,Q){y(F.value,Q,F.readOnly)}function z(F,Q){setTimeout(function(){m(Q)||(P([Q],je.CLEARICONHIDE),Q=!m(F)&&F.classList.contains("e-combobox")?null:Q)},200)}function D(F,Q,pe){if(t===void 0||t){var ge=function(At){return E(At,F,Q)};Q.addEventListener("click",ge),F.__eventHandlers.clearClickHandler={clickHandlerEvent:ge}}var Ee=function(){return k(F,Q)},ke=function(){return A(F,Q)},et=function(){return z(F,Q)};F.addEventListener("input",Ee),F.addEventListener("focus",ke),F.addEventListener("blur",et),F.__eventHandlers.clearInputHandler={inputHandlerEvent:Ee},F.__eventHandlers.clearFocusHandler={focusHandlerEvent:ke},F.__eventHandlers.clearBlurHandler={blurHandlerEvent:et}}s.wireClearBtnEvents=D;function T(F,Q){if(!m(F)&&!m(F.__eventHandlers)){if(!m(F.__eventHandlers.clearClickHandler)){var pe=F.__eventHandlers.clearClickHandler.clickHandlerEvent;(t===void 0||t)&&(m(Q)||Q.removeEventListener("click",pe)),delete F.__eventHandlers.clearClickHandler}if(!m(F.__eventHandlers.clearInputHandler)&&!m(F.__eventHandlers.clearFocusHandler)&&!m(F.__eventHandlers.clearBlurHandler)){var ge=F.__eventHandlers.clearInputHandler.inputHandlerEvent,Ee=F.__eventHandlers.clearFocusHandler.focusHandlerEvent,ke=F.__eventHandlers.clearBlurHandler.blurHandlerEvent;F.removeEventListener("input",ge),F.removeEventListener("focus",Ee),F.removeEventListener("blur",ke),delete F.__eventHandlers.clearInputHandler,delete F.__eventHandlers.clearFocusHandler,delete F.__eventHandlers.clearBlurHandler}}}function M(F,Q){Q===void 0&&(Q=null),o(F),F.floatLabelType==="Auto"&&g(F),F.properties.showClearButton&&T(F.element,Q),m(F.buttons)||V(!1,null,F.buttons),f(F.element),m(F.element)||(delete F.element.__eventHandlers,F.element.classList.contains(je.INPUT)&&F.element.classList.remove(je.INPUT))}s.destroy=M;function K(F,Q){var pe=w(F);if(pe.classList.contains(je.FLOATINPUT)&&Q==="Auto"){var ge=w(F).getElementsByClassName("e-float-text")[0];x(F.value,ge,F)}}function te(F,Q,pe,ge,Ee){var ke=m(Ee)?Cs:Ee,et;return m(F.customTag)?et=ke(ge,{className:Q}):(et=ke(F.customTag,{className:Q}),et.classList.add(pe)),et.classList.add("e-control-wrapper"),et}function ee(F){var Q="";if(!m(F)&&F!==""){var pe=document.createElement("span");pe.innerHTML='<input  placeholder="'+F+'"/>';var ge=pe.children[0];Q=ge.placeholder}return Q}function J(F,Q,pe,ge){if(Q.value=F,pe!=="Never"&&j(Q,Q.parentElement),!m(pe)&&pe==="Auto"&&K(Q,pe),!m(ge)&&ge){var Ee=w(Q);if(!m(Ee)){var ke=Ee.getElementsByClassName(je.CLEARICON)[0];m(ke)||(Q.value&&!m(Ee)&&Ee.classList.contains("e-input-focus")?Z([ke],je.CLEARICONHIDE):P([ke],je.CLEARICONHIDE))}}l(pe,Q)}s.setValue=J;function re(F,Q,pe){!m(pe)&&pe!==""&&Z(Q,pe.split(" ")),!m(F)&&F!==""&&P(Q,F.split(" "))}s.setCssClass=re;function j(F,Q,pe){if(!(pe!=="multiselect"&&!Me(F))){var ge=pe==="multiselect"?F:F.clientWidth-parseInt(getComputedStyle(F,null).getPropertyValue("padding-left"),10);!m(Q)&&!m(Q.getElementsByClassName("e-float-text-content")[0])&&(Q.getElementsByClassName("e-float-text-content")[0].classList.contains("e-float-text-overflow")&&Q.getElementsByClassName("e-float-text-content")[0].classList.remove("e-float-text-overflow"),(ge<Q.getElementsByClassName("e-float-text-content")[0].clientWidth||ge===Q.getElementsByClassName("e-float-text-content")[0].clientWidth)&&Q.getElementsByClassName("e-float-text-content")[0].classList.add("e-float-text-overflow"))}}s.calculateWidth=j;function de(F,Q){typeof F=="number"?Q.style.width=st(F):typeof F=="string"&&(Q.style.width=F.match(/px|%|em/)?F:st(F)),j(Q.firstChild,Q)}s.setWidth=de;function we(F,Q){F=ee(F);var pe=w(Q);if(pe.classList.contains(je.FLOATINPUT))if(!m(F)&&F!==""){var ge=pe.getElementsByClassName("e-float-text-content")[0];ge&&ge.children[0]?ge.children[0].textContent=F:pe.getElementsByClassName(je.FLOATTEXT)[0].textContent=F,pe.classList.remove(je.NOFLOATLABEL),Q.removeAttribute("placeholder")}else{pe.classList.add(je.NOFLOATLABEL);var ge=pe.getElementsByClassName("e-float-text-content")[0];ge?ge.children[0].textContent="":pe.getElementsByClassName(je.FLOATTEXT)[0].textContent=""}else!m(F)&&F!==""?Pe(Q,{placeholder:F}):Q.removeAttribute("placeholder")}s.setPlaceholder=we;function N(F,Q,pe){F?Pe(Q,{readonly:""}):Q.removeAttribute("readonly"),m(pe)||K(Q,pe)}s.setReadonly=N;function H(F,Q){F?P(Q,je.RTL):Z(Q,je.RTL)}s.setEnableRtl=H;function L(F,Q,pe,ge){var Ee={disabled:"","aria-disabled":"true"},ke=!m(ge);F?(Q.classList.remove(je.DISABLE),U(Ee,Q),ke&&Z([ge],je.DISABLE)):(Q.classList.add(je.DISABLE),se(Ee,Q),ke&&P([ge],je.DISABLE)),m(pe)||K(Q,pe)}s.setEnabled=L;function _(F,Q,pe,ge,Ee){var ke=m(Ee)?Cs:Ee;F?pe.clearButton=S(Q,pe,ge,ke):(Zi(pe.clearButton),pe.clearButton=null)}s.setClearButton=_;function U(F,Q){for(var pe=0,ge=Object.keys(F);pe<ge.length;pe++){var Ee=ge[pe],ke=w(Q);Ee==="disabled"&&Q.classList.remove(je.DISABLE),Ee==="disabled"&&ke.classList.contains(je.INPUTGROUP)&&ke.classList.remove(je.DISABLE),Ee==="placeholder"&&ke.classList.contains(je.FLOATINPUT)?ke.getElementsByClassName(je.FLOATTEXT)[0].textContent="":Q.removeAttribute(Ee)}}s.removeAttributes=U;function se(F,Q){for(var pe=0,ge=Object.keys(F);pe<ge.length;pe++){var Ee=ge[pe],ke=w(Q);Ee==="disabled"&&Q.classList.add(je.DISABLE),Ee==="disabled"&&ke.classList.contains(je.INPUTGROUP)&&ke.classList.add(je.DISABLE),Ee==="placeholder"&&ke.classList.contains(je.FLOATINPUT)?ke.getElementsByClassName(je.FLOATTEXT)[0].textContent=F[""+Ee]:Q.setAttribute(Ee,F[""+Ee])}}s.addAttributes=se;function ae(F){var Q=F.container;if(!m(Q)&&Q.classList.contains(je.FLOATINPUT)){var pe=Q.querySelector("textarea")?Q.querySelector("textarea"):Q.querySelector("input"),ge=Q.querySelector("."+je.FLOATTEXT).textContent,Ee=Q.querySelector(".e-clear-icon")!==null;Oe(Q.querySelector("."+je.FLOATLINE)),Oe(Q.querySelector("."+je.FLOATTEXT)),On(Q,[je.INPUTGROUP],[je.FLOATINPUT]),f(pe),Pe(pe,{placeholder:ge}),pe.classList.add(je.INPUT),!Ee&&pe.tagName==="INPUT"&&pe.removeAttribute("required")}}s.removeFloating=ae;function oe(F,Q,pe,ge){var Ee=m(ge)?Cs:ge,ke=X(F,"."+je.INPUTGROUP),et=ke.tagName;et=et!=="DIV"&&et!=="SPAN"?et:null;var At={element:F,floatLabelType:Q,customTag:et,properties:{placeholder:pe}};if(Q!=="Never"){var qt=ke.querySelector(".e-clear-icon"),or={container:ke};F.classList.remove(je.INPUT),v(At,or,Ee),me(or.container,Ee),j(At.element,or.container);var lr=ke.classList.contains("e-float-icon-left");if(m(qt))if(lr){var Hn=ke.querySelector(".e-input-in-wrap");qt=Hn.querySelector(".e-input-group-icon")}else qt=ke.querySelector(".e-input-group-icon");if(m(qt))lr&&(qt=ke.querySelector(".e-input-group-icon"));else{var Vn=ke.querySelector("."+je.FLOATLINE),Ba=ke.querySelector("."+je.FLOATTEXT),Wn=lr?ke.querySelector(".e-input-in-wrap"):ke;Wn.insertBefore(F,qt),Wn.insertBefore(Vn,qt),Wn.insertBefore(Ba,qt)}}else g(At);b(Q,F.parentElement)}s.addFloating=oe;function me(F,Q){if(F.classList.contains("e-outline")&&F.getElementsByClassName("e-float-text")[0]){var pe=Q("span",{className:je.FLOATTEXTCONTENT});pe.innerHTML=F.getElementsByClassName("e-float-text")[0].innerHTML,F.getElementsByClassName("e-float-text")[0].innerHTML="",F.getElementsByClassName("e-float-text")[0].appendChild(pe)}}s.createSpanElement=me;function Re(F,Q){for(var pe=0;pe<Q.length;pe++)V(F,Q[parseInt(pe.toString(),10)].container)}s.setRipple=Re;function V(F,Q,pe){var ge=[];ge.push(pe);var Ee=m(pe)?Q.querySelectorAll(".e-input-group-icon"):ge;if(F&&Ee.length>0)for(var ke=0;ke<Ee.length;ke++)Ee[parseInt(ke.toString(),10)].addEventListener("mousedown",Ze,!1),Ee[parseInt(ke.toString(),10)].addEventListener("mouseup",Je,!1);else if(Ee.length>0)for(var ke=0;ke<Ee.length;ke++)Ee[parseInt(ke.toString(),10)].removeEventListener("mousedown",Ze,this),Ee[parseInt(ke.toString(),10)].removeEventListener("mouseup",Je,this)}function $e(F,Q){!F.classList.contains("e-disabled")&&!F.querySelector("input").readOnly&&Q.classList.add("e-input-btn-ripple")}function Me(F){if(!F)return!1;for(var Q=F;Q&&Q!==document.body;){var pe=window.getComputedStyle(Q);if(pe.display==="none")return!1;Q=Q.parentElement}return!0}function Ze(){for(var F=this,Q=this.parentElement;!Q.classList.contains("e-input-group");)Q=Q.parentElement;$e(Q,F)}function Je(){var F=this;setTimeout(function(){F.classList.remove("e-input-btn-ripple")},500)}function Le(F,Q){var pe=Q("span",{className:F});return pe.classList.add("e-input-group-icon"),pe}function Ct(F,Q,pe,ge,Ee){var ke=typeof Q=="string"?Q.split(","):Q;if(F.toLowerCase()==="append")for(var et=0,At=ke;et<At.length;et++){var qt=At[et];Wt(qt,pe,Ee)}else for(var or=0,lr=ke;or<lr.length;or++){var qt=lr[or];si(qt,pe,ge,Ee)}pe.getElementsByClassName("e-input-group-icon")[0]&&pe.getElementsByClassName("e-float-text-overflow")[0]&&pe.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon")}s.addIcon=Ct;function si(F,Q,pe,ge){var Ee=m(ge)?Cs:ge,ke=Le(F,Ee);Q.classList.add("e-float-icon-left");var et=Q.querySelector(".e-input-in-wrap");if(m(et)){et=Ee("span",{className:"e-input-in-wrap"}),pe.parentNode.insertBefore(et,pe);var At=Q.querySelectorAll(pe.tagName+" ~ *");et.appendChild(pe);for(var qt=0;qt<At.length;qt++){var or=At[parseInt(qt.toString(),10)],lr=et.parentElement;(!or.classList.contains("e-float-line")||!(lr&&lr.classList.contains("e-filled"))&&lr)&&et.appendChild(or)}}return et.parentNode.insertBefore(ke,et),V(!0,Q,ke),ke}s.prependSpan=si;function Wt(F,Q,pe){var ge=m(pe)?Cs:pe,Ee=Le(F,ge),ke=Q.classList.contains("e-float-icon-left")?Q.querySelector(".e-input-in-wrap"):Q;return ke.appendChild(Ee),V(!0,Q,Ee),Ee}s.appendSpan=Wt;function li(F,Q){Q.type==="hidden"?F.classList.add("e-hidden"):F.classList.contains("e-hidden")&&F.classList.remove("e-hidden")}s.validateInputType=li;function ar(F,Q){if(!m(F))for(var pe=0,ge=Object.keys(F);pe<ge.length;pe++){var Ee=ge[pe];cp.indexOf(Ee)<0&&Q.setAttribute(Ee,F[""+Ee])}}s.updateHTMLAttributesToElement=ar;function xi(F,Q,pe){re(Tt(F),[pe],Tt(Q))}s.updateCssClass=xi;function Tt(F){var Q=F;return!m(F)&&F!==""&&(Q=F.replace(/\s+/g," ").trim()),Q}s.getInputValidClassList=Tt;function Ni(F,Q){if(!m(F))for(var pe=0,ge=Object.keys(F);pe<ge.length;pe++){var Ee=ge[pe];if(cp.indexOf(Ee)>-1)if(Ee==="class"){var ke=this.getInputValidClassList(F[""+Ee]);ke!==""&&P([Q],ke.split(" "))}else if(Ee==="style"){var et=Q.getAttribute(Ee);et=m(et)?F[""+Ee]:et+F[""+Ee],Q.setAttribute(Ee,et)}else Q.setAttribute(Ee,F[""+Ee])}}s.updateHTMLAttributesToWrapper=Ni;function Di(F){return!F||/^\s*$/.test(F)}s.isBlank=Di})(Te||(Te={}));var G4=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Gt=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},X4="e-control-wrapper e-numeric",od="e-input-group-icon",ld="e-spin-up",K4="e-spin-down",gb="e-error",qa="increment",ol="decrement",Y4=new RegExp("^(-)?(\\d*)$"),J4=".",Q4="e-numerictextbox",Z4="e-control",bb="e-input-focus",eH="e-numeric-hidden",yb=["title","style","class"],xb=0,hd=function(s){G4(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.preventChange=!1,r.isDynamicChange=!1,r.numericOptions=e,r}return t.prototype.preRender=function(){this.isPrevFocused=!1,this.decimalSeparator=".",this.intRegExp=new RegExp("/^(-)?(d*)$/"),this.isCalled=!1;var e=ie("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),Z([this.cloneElement],[Z4,Q4,"e-lib"]),this.angularTagName=null,this.formEle=X(this.element,"form"),this.element.tagName==="EJS-NUMERICTEXTBOX"){this.angularTagName=this.element.tagName;var i=this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;n!=="id"&&n!=="class"?(i.setAttribute(this.element.attributes[r].nodeName,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML):n==="class"&&i.setAttribute(n,this.element.className.split(" ").filter(function(o){return o.indexOf("ng-")!==0}).join(" "))}this.element.hasAttribute("name")&&this.element.removeAttribute("name"),this.element.classList.remove("e-control","e-numerictextbox"),this.element.appendChild(i),this.element=i,It("ej2_instances",e,this.element)}Pe(this.element,{role:"spinbutton",tabindex:"0",autocomplete:"off"});var a={incrementTitle:"Increment value",decrementTitle:"Decrement value",placeholder:this.placeholder};this.l10n=new br("numerictextbox",a,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",fi("numerictextbox")),this.isValidState=!0,this.inputStyle=null,this.inputName=null,this.cultureInfo={},this.initCultureInfo(),this.initCultureFunc(),this.prevValue=this.value,this.updateHTMLAttrToElement(),this.checkAttributes(!1),this.formEle&&(this.inputEleValue=this.value),this.validateMinMax(),this.validateStep(),this.placeholder===null&&this.updatePlaceholder()},t.prototype.render=function(){this.element.tagName.toLowerCase()==="input"&&(this.createWrapper(),this.showSpinButton&&this.spinBtnCreation(),this.setElementWidth(this.width),this.container.classList.contains("e-input-group")||this.container.classList.add("e-input-group"),this.changeValue(this.value===null||isNaN(this.value)?null:this.strictMode?this.trimValue(this.value):this.value),this.wireEvents(),this.value!==null&&!isNaN(this.value)&&this.decimals&&this.setProperties({value:this.roundNumber(this.value,this.decimals)},!0),(this.element.getAttribute("value")||this.value)&&(this.element.setAttribute("value",this.element.value),this.hiddenInput.setAttribute("value",this.hiddenInput.value)),this.elementPrevValue=this.element.value,this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),!this.element.hasAttribute("aria-labelledby")&&!this.element.hasAttribute("placeholder")&&!this.element.hasAttribute("aria-label")&&this.element.setAttribute("aria-label","numerictextbox"),!m(X(this.element,"fieldset"))&&X(this.element,"fieldset").disabled&&(this.enabled=!1),this.renderComplete())},t.prototype.checkAttributes=function(e){for(var i=e?m(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","step","disabled","readonly","style","name","placeholder"],r=0,n=i;r<n.length;r++){var a=n[r];if(!m(this.element.getAttribute(a)))switch(a){case"disabled":if(m(this.numericOptions)||this.numericOptions.enabled===void 0||e){var o=!(this.element.getAttribute(a)==="disabled"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true");this.setProperties({enabled:o},!e)}break;case"readonly":if(m(this.numericOptions)||this.numericOptions.readonly===void 0||e){var l=this.element.getAttribute(a)==="readonly"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true";this.setProperties({readonly:l},!e)}break;case"placeholder":(m(this.numericOptions)||this.numericOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.element.placeholder},!e);break;case"value":if(m(this.numericOptions)||this.numericOptions.value===void 0||e){var h=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));this.setProperties(It(a,h,{}),!e)}break;case"min":if(m(this.numericOptions)||this.numericOptions.min===void 0||e){var u=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));u!==null&&!isNaN(u)&&this.setProperties(It(a,u,{}),!e)}break;case"max":if(m(this.numericOptions)||this.numericOptions.max===void 0||e){var c=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));c!==null&&!isNaN(c)&&this.setProperties(It(a,c,{}),!e)}break;case"step":if(m(this.numericOptions)||this.numericOptions.step===void 0||e){var f=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));f!==null&&!isNaN(f)&&this.setProperties(It(a,f,{}),!e)}break;case"style":this.inputStyle=this.element.getAttribute(a);break;case"name":this.inputName=this.element.getAttribute(a);break;default:{var d=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));(d!==null&&!isNaN(d)||a==="value")&&this.setProperties(It(a,d,{}),!0)}break}}},t.prototype.updatePlaceholder=function(){this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0)},t.prototype.initCultureFunc=function(){this.instance=new Ji(this.locale)},t.prototype.initCultureInfo=function(){this.cultureInfo.format=this.format,ie("currency",this)!==null&&(It("currency",this.currency,this.cultureInfo),this.setProperties({currencyCode:this.currency},!0))},t.prototype.createWrapper=function(){var e=this.cssClass;!m(this.cssClass)&&this.cssClass!==""&&(e=this.getNumericValidClassList(this.cssClass));var i=Te.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:e,enableRtl:this.enableRtl,showClearButton:this.showClearButton,enabled:this.enabled}},this.createElement);this.inputWrapper=i,this.container=i.container,this.container.setAttribute("class",X4+" "+this.container.getAttribute("class")),this.updateHTMLAttrToWrapper(),this.readonly&&Pe(this.element,{"aria-readonly":"true"}),this.hiddenInput=this.createElement("input",{attrs:{type:"text",validateHidden:"true","aria-label":"hidden",class:eH}}),this.inputName=this.inputName!==null?this.inputName:this.element.id,this.element.removeAttribute("name"),this.isAngular&&this.angularTagName==="EJS-NUMERICTEXTBOX"&&this.cloneElement.id.length>0?Pe(this.hiddenInput,{name:this.cloneElement.id}):Pe(this.hiddenInput,{name:this.inputName}),this.container.insertBefore(this.hiddenInput,this.container.childNodes[1]),this.updateDataAttribute(!1),this.inputStyle!==null&&Pe(this.container,{style:this.inputStyle})},t.prototype.updateDataAttribute=function(e){var i={};if(e)i=this.htmlAttributes;else for(var r=0;r<this.element.attributes.length;r++)i[this.element.attributes[r].name]=this.element.getAttribute(this.element.attributes[r].name);for(var n=0,a=Object.keys(i);n<a.length;n++){var o=a[n];o.indexOf("data")===0&&this.hiddenInput.setAttribute(o,i[""+o])}},t.prototype.updateHTMLAttrToElement=function(){if(!m(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];yb.indexOf(r)<0&&this.element.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.updateCssClass=function(e,i){Te.setCssClass(this.getNumericValidClassList(e),[this.container],this.getNumericValidClassList(i))},t.prototype.getNumericValidClassList=function(e){var i=e;return!m(e)&&e!==""&&(i=e.replace(/\s+/g," ").trim()),i},t.prototype.updateHTMLAttrToWrapper=function(){if(!m(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(yb.indexOf(r)>-1)if(r==="class"){var n=this.getNumericValidClassList(this.htmlAttributes[""+r]);n!==""&&P([this.container],n.split(" "))}else if(r==="style"){var a=this.container.getAttribute(r);a=m(a)?this.htmlAttributes[""+r]:a+this.htmlAttributes[""+r],this.container.setAttribute(r,a)}else this.container.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.setElementWidth=function(e){m(e)||(typeof e=="number"?this.container.style.width=st(e):typeof e=="string"&&(this.container.style.width=e.match(/px|%|em/)?e:st(e)))},t.prototype.spinBtnCreation=function(){this.spinDown=Te.appendSpan(od+" "+K4,this.container,this.createElement),Pe(this.spinDown,{title:this.l10n.getConstant("decrementTitle")}),this.spinUp=Te.appendSpan(od+" "+ld,this.container,this.createElement),Pe(this.spinUp,{title:this.l10n.getConstant("incrementTitle")}),this.wireSpinBtnEvents()},t.prototype.validateMinMax=function(){typeof this.min=="number"&&!isNaN(this.min)||this.setProperties({min:-Number.MAX_VALUE},!0),typeof this.max=="number"&&!isNaN(this.max)||this.setProperties({max:Number.MAX_VALUE},!0),this.decimals!==null&&(this.min!==-Number.MAX_VALUE&&this.setProperties({min:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.min))},!0),this.max!==Number.MAX_VALUE&&this.setProperties({max:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.max))},!0)),this.setProperties({min:this.min>this.max?this.max:this.min},!0),this.min!==-Number.MAX_VALUE&&Pe(this.element,{"aria-valuemin":this.min.toString()}),this.max!==Number.MAX_VALUE&&Pe(this.element,{"aria-valuemax":this.max.toString()})},t.prototype.formattedValue=function(e,i){return this.instance.getNumberFormat({maximumFractionDigits:e,minimumFractionDigits:e,useGrouping:!1})(i)},t.prototype.validateStep=function(){this.decimals!==null&&this.setProperties({step:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.step))},!0)},t.prototype.action=function(e,i){this.isInteract=!0;var r=this.isFocused?this.instance.getNumberParser({format:"n"})(this.element.value):this.value;this.changeValue(this.performAction(r,this.step,e)),this.raiseChangeEvent(i)},t.prototype.checkErrorClass=function(){this.isValidState?Z([this.container],gb):P([this.container],gb),Pe(this.element,{"aria-invalid":this.isValidState?"false":"true"})},t.prototype.bindClearEvent=function(){this.showClearButton&&R.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},t.prototype.resetHandler=function(e){e.preventDefault(),(!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")||this.inputWrapper.container.classList.contains("e-static-clear"))&&this.clear(e),this.isInteract=!0,this.raiseChangeEvent(e)},t.prototype.clear=function(e){this.setProperties({value:null},!0),this.setElementValue(""),this.hiddenInput.value="";var i=X(this.element,"form");if(i){var r=this.element.nextElementSibling,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}},t.prototype.resetFormHandler=function(){this.element.tagName==="EJS-NUMERICTEXTBOX"?this.updateValue(null):this.updateValue(this.inputEleValue)},t.prototype.setSpinButton=function(){m(this.spinDown)||Pe(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),m(this.spinUp)||Pe(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")})},t.prototype.wireEvents=function(){R.add(this.element,"focus",this.focusHandler,this),R.add(this.element,"blur",this.focusOutHandler,this),R.add(this.element,"keydown",this.keyDownHandler,this),R.add(this.element,"keyup",this.keyUpHandler,this),R.add(this.element,"input",this.inputHandler,this),R.add(this.element,"keypress",this.keyPressHandler,this),R.add(this.element,"change",this.changeHandler,this),R.add(this.element,"paste",this.pasteHandler,this),this.enabled&&(this.bindClearEvent(),this.formEle&&R.add(this.formEle,"reset",this.resetFormHandler,this))},t.prototype.wireSpinBtnEvents=function(){R.add(this.spinUp,xe.touchStartEvent,this.mouseDownOnSpinner,this),R.add(this.spinDown,xe.touchStartEvent,this.mouseDownOnSpinner,this),R.add(this.spinUp,xe.touchEndEvent,this.mouseUpOnSpinner,this),R.add(this.spinDown,xe.touchEndEvent,this.mouseUpOnSpinner,this),R.add(this.spinUp,xe.touchMoveEvent,this.touchMoveOnSpinner,this),R.add(this.spinDown,xe.touchMoveEvent,this.touchMoveOnSpinner,this)},t.prototype.unwireEvents=function(){R.remove(this.element,"focus",this.focusHandler),R.remove(this.element,"blur",this.focusOutHandler),R.remove(this.element,"keyup",this.keyUpHandler),R.remove(this.element,"input",this.inputHandler),R.remove(this.element,"keydown",this.keyDownHandler),R.remove(this.element,"keypress",this.keyPressHandler),R.remove(this.element,"change",this.changeHandler),R.remove(this.element,"paste",this.pasteHandler),this.formEle&&R.remove(this.formEle,"reset",this.resetFormHandler)},t.prototype.unwireSpinBtnEvents=function(){R.remove(this.spinUp,xe.touchStartEvent,this.mouseDownOnSpinner),R.remove(this.spinDown,xe.touchStartEvent,this.mouseDownOnSpinner),R.remove(this.spinUp,xe.touchEndEvent,this.mouseUpOnSpinner),R.remove(this.spinDown,xe.touchEndEvent,this.mouseUpOnSpinner),R.remove(this.spinUp,xe.touchMoveEvent,this.touchMoveOnSpinner),R.remove(this.spinDown,xe.touchMoveEvent,this.touchMoveOnSpinner)},t.prototype.changeHandler=function(e){e.stopPropagation(),this.element.value.length||this.setProperties({value:null},!0);var i=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(i,e)},t.prototype.raiseChangeEvent=function(e){if(this.inputValue=m(this.inputValue)||isNaN(this.inputValue)?null:this.inputValue,this.prevValue!==this.value||this.prevValue!==this.inputValue){var i={};this.changeEventArgs={value:this.value,previousValue:this.prevValue,isInteracted:this.isInteract,isInteraction:this.isInteract,event:e},e&&(this.changeEventArgs.event=e),this.changeEventArgs.event===void 0&&(this.changeEventArgs.isInteracted=!1,this.changeEventArgs.isInteraction=!1),po(i,this.changeEventArgs),this.prevValue=this.value,this.isInteract=!1,this.elementPrevValue=this.element.value,this.preventChange=!1,this.trigger("change",i)}},t.prototype.pasteHandler=function(){var e=this;if(!(!this.enabled||this.readonly)){var i=this.element.value;setTimeout(function(){e.numericRegex().test(e.element.value)||e.setElementValue(i)})}},t.prototype.preventHandler=function(){var e=this,i=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);setTimeout(function(){if(e.element.selectionStart>0){var r=e.element.selectionStart,n=e.element.selectionStart-1,a=0,o=e.element.value.split(""),l=to(e.locale),h=ie("decimal",l),u=h.charCodeAt(0);e.element.value[n]===" "&&e.element.selectionStart>0&&!i?(m(e.prevVal)?e.element.value=e.element.value.trim():n!==0?e.element.value=e.prevVal:n===0&&(e.element.value=e.element.value.trim()),e.element.setSelectionRange(n,n)):isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&e.element.value[e.element.selectionStart-1].charCodeAt(0)!==45?(o.indexOf(e.element.value[e.element.selectionStart-1])!==o.lastIndexOf(e.element.value[e.element.selectionStart-1])&&e.element.value[e.element.selectionStart-1].charCodeAt(0)===u||e.element.value[e.element.selectionStart-1].charCodeAt(0)!==u)&&(e.element.value=e.element.value.substring(0,n)+e.element.value.substring(r,e.element.value.length),e.element.setSelectionRange(n,n),isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&e.element.selectionStart>0&&e.element.value.length&&e.preventHandler()):isNaN(parseFloat(e.element.value[e.element.selectionStart-2]))&&e.element.selectionStart>1&&e.element.value[e.element.selectionStart-2].charCodeAt(0)!==45&&(o.indexOf(e.element.value[e.element.selectionStart-2])!==o.lastIndexOf(e.element.value[e.element.selectionStart-2])&&e.element.value[e.element.selectionStart-2].charCodeAt(0)===u||e.element.value[e.element.selectionStart-2].charCodeAt(0)!==u)&&(e.element.setSelectionRange(n,n),e.nextEle=e.element.value[e.element.selectionStart],e.cursorPosChanged=!0,e.preventHandler()),e.cursorPosChanged===!0&&e.element.value[e.element.selectionStart]===e.nextEle&&isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&(e.element.setSelectionRange(e.element.selectionStart+1,e.element.selectionStart+1),e.cursorPosChanged=!1,e.nextEle=null),e.element.value.trim()===""&&e.element.setSelectionRange(a,a),e.element.selectionStart>0&&(e.element.value[e.element.selectionStart-1].charCodeAt(0)===45&&e.element.selectionStart>1&&(m(e.prevVal)||(e.element.value=e.prevVal),e.element.setSelectionRange(e.element.selectionStart,e.element.selectionStart)),e.element.value[e.element.selectionStart-1]===h&&e.decimals===0&&e.validateDecimalOnType&&(e.element.value=e.element.value.substring(0,n)+e.element.value.substring(r,e.element.value.length))),e.prevVal=e.element.value}})},t.prototype.keyUpHandler=function(){if(!(!this.enabled||this.readonly)){var e=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);!e&&xe.isDevice&&this.preventHandler();var i=this.instance.getNumberParser({format:"n"})(this.element.value);i=i===null||isNaN(i)?null:i,this.hiddenInput.value=i||i===0?i.toString():null;var r=X(this.element,"form");if(r){var n=this.element.nextElementSibling,a=document.createEvent("KeyboardEvent");a.initEvent("keyup",!1,!0),n.dispatchEvent(a)}}},t.prototype.inputHandler=function(e){var i=this;if(!(!this.enabled||this.readonly)){var r=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if((n||r)&&xe.isDevice&&this.preventHandler(),this.isAngular&&this.element.value!==ie("decimal",to(this.locale))&&this.element.value!==ie("minusSign",to(this.locale))){var a=this.instance.getNumberParser({format:"n"})(this.element.value);a=isNaN(a)?null:a,i.localChange({value:a}),this.preventChange=!0}if(this.isVue){var o=this.instance.getNumberParser({format:"n"})(this.element.value),l=this.instance.getNumberParser({format:"n"})(this.elementPrevValue),h=new RegExp("[^0-9]+$");(h.test(this.element.value)||(this.elementPrevValue.indexOf(".")!==-1||this.elementPrevValue.indexOf("-")!==-1)&&this.element.value[this.element.value.length-1]==="0")&&(o=this.value);var u={event:e,value:o===null||isNaN(o)?null:o,previousValue:l===null||isNaN(l)?null:l};this.preventChange=!0,this.elementPrevValue=this.element.value,this.trigger("input",u)}}},t.prototype.keyDownHandler=function(e){if(!this.readonly)switch(e.keyCode){case 38:e.preventDefault(),this.action(qa,e);break;case 40:e.preventDefault(),this.action(ol,e);break}},t.prototype.performAction=function(e,i,r){(e===null||isNaN(e))&&(e=0);var n=r===qa?e+i:e-i;return n=this.correctRounding(e,i,n),this.strictMode?this.trimValue(n):n},t.prototype.correctRounding=function(e,i,r){var n=new RegExp("[,.](.*)"),a=n.test(e.toString()),o=n.test(i.toString());if(a||o){var l=a?n.exec(e.toString())[0].length:0,h=o?n.exec(i.toString())[0].length:0,u=Math.max(l,h);return e=this.roundValue(r,u)}return r},t.prototype.roundValue=function(e,i){i=i||0;var r=Math.pow(10,i);return e*=r,e=Math.round(e)/r},t.prototype.updateValue=function(e,i){i&&(this.isInteract=!0),e!==null&&!isNaN(e)&&this.decimals&&(e=this.roundNumber(e,this.decimals)),this.inputValue=e,this.isVue&&this.element&&this.element.hasAttribute("modelvalue")&&this.isDynamicChange||this.changeValue(e===null||isNaN(e)?null:this.strictMode?this.trimValue(e):e),this.isDynamicChange||this.raiseChangeEvent(i)},t.prototype.updateCurrency=function(e,i){It(e,i,this.cultureInfo),this.updateValue(this.value)},t.prototype.changeValue=function(e){if(!(e||e===0))e=null,this.setProperties({value:e},!0);else{var i=this.getNumberOfDecimals(e);this.setProperties({value:this.roundNumber(e,i)},!0)}this.modifyText(),this.strictMode||this.validateState()},t.prototype.modifyText=function(){if(this.value||this.value===0){var e=this.formatNumber(),i=this.isFocused?e:this.instance.getNumberFormat(this.cultureInfo)(this.value);this.setElementValue(i),Pe(this.element,{"aria-valuenow":e}),m(this.hiddenInput)||(this.hiddenInput.value=this.value.toString(),this.value!==null&&this.serverDecimalSeparator&&(this.hiddenInput.value=this.hiddenInput.value.replace(".",this.serverDecimalSeparator)))}else this.setElementValue(""),this.element.removeAttribute("aria-valuenow"),this.hiddenInput.value=null},t.prototype.setElementValue=function(e,i){Te.setValue(e,i||this.element,this.floatLabelType,this.showClearButton)},t.prototype.validateState=function(){this.isValidState=!0,(this.value||this.value===0)&&(this.isValidState=!(this.value>this.max||this.value<this.min)),this.checkErrorClass()},t.prototype.getNumberOfDecimals=function(e){var i,r=new RegExp("[eE][-+]?([0-9]+)"),n=e.toString();if(r.test(n)){var a=r.exec(n);m(a)||(n=e.toFixed(Math.min(parseInt(a[1],10),20)))}var o=n.split(".")[1];return i=!o||!o.length?0:o.length,this.decimals!==null&&(i=i<this.decimals?i:this.decimals),i},t.prototype.formatNumber=function(){var e=this.getNumberOfDecimals(this.value);return this.instance.getNumberFormat({maximumFractionDigits:e,minimumFractionDigits:e,useGrouping:!1})(this.value)},t.prototype.trimValue=function(e){return e>this.max?this.max:e<this.min?this.min:e},t.prototype.roundNumber=function(e,i){var r=e,n=i||0,a=r.toString().split("e");r=Math.round(+(a[0]+"e"+(a[1]?Number(a[1])+n:n)));var o=r.toString().split("e");return r=+(o[0]+"e"+(o[1]?Number(o[1])-n:-n)),Number(r.toFixed(n))},t.prototype.cancelEvent=function(e){return e.preventDefault(),!1},t.prototype.keyPressHandler=function(e){if(!this.enabled||this.readonly)return!0;if(!xe.isDevice&&xe.info.version==="11.0"&&e.keyCode===13){var i=this.instance.getNumberParser({format:"n"})(this.element.value);return this.updateValue(i,e),!0}if(e.which===0||e.metaKey||e.ctrlKey||e.keyCode===8||e.keyCode===13)return!0;var r=String.fromCharCode(e.which),n=ie("decimal",to(this.locale)),a=e.code==="NumpadDecimal"&&r!==n;a&&(r=n);var o=this.element.value;if(o=o.substring(0,this.element.selectionStart)+r+o.substring(this.element.selectionEnd),this.numericRegex().test(o)){if(a){var l=this.element.selectionStart+1;this.element.value=o,this.element.setSelectionRange(l,l),e.preventDefault(),e.stopPropagation()}return!0}else return e.preventDefault(),e.stopPropagation(),!1},t.prototype.numericRegex=function(){var e=to(this.locale),i=ie("decimal",e),r="*";return i===J4&&(i="\\"+i),this.decimals===0&&this.validateDecimalOnType?Y4:(this.decimals&&this.validateDecimalOnType&&(r="{0,"+this.decimals+"}"),new RegExp("^\\s*(-)?(((\\d+("+i+"\\d"+r+")?)|("+i+"\\d"+r+")))?$"))},t.prototype.mouseWheel=function(e){e.preventDefault();var i,r=e;r.wheelDelta?i=r.wheelDelta/120:r.detail&&(i=-r.detail/3),i>0?this.action(qa,e):i<0&&this.action(ol,e),this.cancelEvent(e)},t.prototype.focusHandler=function(e){var i=this;if(clearTimeout(xb),this.focusEventArgs={event:e,value:this.value,container:this.container},this.trigger("focus",this.focusEventArgs),!(!this.enabled||this.readonly)){if(this.isFocused=!0,this.prevValue=this.value,this.value||this.value===0){var r=this.formatNumber();if(this.setElementValue(r),!this.isPrevFocused)if(!xe.isDevice&&xe.info.version==="11.0")this.element.setSelectionRange(0,r.length);else{var n=xe.isDevice&&xe.isIos?600:0;xb=setTimeout(function(){i.element.setSelectionRange(0,r.length)},n)}}xe.isDevice||R.add(this.element,"mousewheel DOMMouseScroll",this.mouseWheel,this)}},t.prototype.focusOutHandler=function(e){var i=this;if(this.blurEventArgs={event:e,value:this.value,container:this.container},this.trigger("blur",this.blurEventArgs),!(!this.enabled||this.readonly)){if(this.isPrevFocused){if(e.preventDefault(),xe.isDevice){var r=this.element.value;this.element.focus(),this.isPrevFocused=!1;var n=this.element;setTimeout(function(){i.setElementValue(r,n)},200)}}else{this.isFocused=!1,this.element.value.length||this.setProperties({value:null},!0);var a=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(a),xe.isDevice||R.remove(this.element,"mousewheel DOMMouseScroll",this.mouseWheel)}var o=X(this.element,"form");if(o){var l=this.element.nextElementSibling,h=document.createEvent("FocusEvent");h.initEvent("focusout",!1,!0),l.dispatchEvent(h)}}},t.prototype.mouseDownOnSpinner=function(e){var i=this;if(this.isFocused&&(this.isPrevFocused=!0,e.preventDefault()),!!this.getElementData(e)){this.getElementData(e);var r=e.currentTarget,n=r.classList.contains(ld)?qa:ol;R.add(r,"mouseleave",this.mouseUpClick,this),this.timeOut=setInterval(function(){i.isCalled=!0,i.action(n,e)},150),R.add(document,"mouseup",this.mouseUpClick,this)}},t.prototype.touchMoveOnSpinner=function(e){var i;if(e.type==="touchmove"){var r=e.touches;i=r.length&&document.elementFromPoint(r[0].pageX,r[0].pageY)}else i=document.elementFromPoint(e.clientX,e.clientY);i.classList.contains(od)||clearInterval(this.timeOut)},t.prototype.mouseUpOnSpinner=function(e){if(this.prevValue=this.value,this.isPrevFocused&&(this.element.focus(),xe.isDevice||(this.isPrevFocused=!1)),xe.isDevice||e.preventDefault(),!!this.getElementData(e)){var i=e.currentTarget,r=i.classList.contains(ld)?qa:ol;R.remove(i,"mouseleave",this.mouseUpClick),this.isCalled||this.action(r,e),this.isCalled=!1,R.remove(document,"mouseup",this.mouseUpClick);var n=X(this.element,"form");if(n){var a=this.element.nextElementSibling,o=document.createEvent("KeyboardEvent");o.initEvent("keyup",!1,!0),a.dispatchEvent(o)}}},t.prototype.getElementData=function(e){return e.which&&e.which===3||e.button&&e.button===2||!this.enabled||this.readonly?!1:(clearInterval(this.timeOut),!0)},t.prototype.floatLabelTypeUpdate=function(){Te.removeFloating(this.inputWrapper);var e=this.hiddenInput;this.hiddenInput.remove(),Te.addFloating(this.element,this.floatLabelType,this.placeholder,this.createElement),this.container.insertBefore(e,this.container.childNodes[1])},t.prototype.mouseUpClick=function(e){e.stopPropagation(),clearInterval(this.timeOut),this.isCalled=!1,this.spinUp&&R.remove(this.spinUp,"mouseleave",this.mouseUpClick),this.spinDown&&R.remove(this.spinDown,"mouseleave",this.mouseUpClick)},t.prototype.increment=function(e){e===void 0&&(e=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,e,qa)),this.raiseChangeEvent()},t.prototype.decrement=function(e){e===void 0&&(e=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,e,ol)),this.raiseChangeEvent()},t.prototype.destroy=function(){this.unwireEvents(),this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),Oe(this.hiddenInput),this.showSpinButton&&(this.unwireSpinBtnEvents(),Oe(this.spinUp),Oe(this.spinDown));for(var e=["aria-labelledby","role","autocomplete","aria-readonly","aria-disabled","autocapitalize","spellcheck","aria-autocomplete","tabindex","aria-valuemin","aria-valuemax","aria-valuenow","aria-invalid"],i=0;i<e.length;i++)this.element.removeAttribute(e[i]);this.element.classList.remove("e-input"),this.container.insertAdjacentElement("afterend",this.element),Oe(this.container),this.spinUp=null,this.spinDown=null,this.container=null,this.hiddenInput=null,this.changeEventArgs=null,this.blurEventArgs=null,this.focusEventArgs=null,this.inputWrapper=null,Te.destroy({element:this.element,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),s.prototype.destroy.call(this)},t.prototype.getText=function(){return this.element.value},t.prototype.focusIn=function(){document.activeElement!==this.element&&this.enabled&&(this.element.focus(),P([this.container],[bb]))},t.prototype.focusOut=function(){document.activeElement===this.element&&this.enabled&&(this.element.blur(),Z([this.container],[bb]))},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];switch(a){case"width":this.setElementWidth(e.width),Te.calculateWidth(this.element,this.container);break;case"cssClass":this.updateCssClass(e.cssClass,i.cssClass);break;case"enabled":Te.setEnabled(e.enabled,this.element),this.bindClearEvent();break;case"enableRtl":Te.setEnableRtl(e.enableRtl,[this.container]);break;case"readonly":Te.setReadonly(e.readonly,this.element),this.readonly?Pe(this.element,{"aria-readonly":"true"}):this.element.removeAttribute("aria-readonly");break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.updateDataAttribute(!0),this.checkAttributes(!0),Te.validateInputType(this.container,this.element);break;case"placeholder":Te.setPlaceholder(e.placeholder,this.element),Te.calculateWidth(this.element,this.container);break;case"step":this.step=e.step,this.validateStep();break;case"showSpinButton":this.updateSpinButton(e);break;case"showClearButton":this.updateClearButton(e);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,this.floatLabelTypeUpdate();break;case"value":this.isDynamicChange=(this.isAngular||this.isVue)&&this.preventChange,this.updateValue(e.value),this.isDynamicChange&&(this.preventChange=!1,this.isDynamicChange=!1);break;case"min":case"max":It(a,ie(a,e),this),this.validateMinMax(),this.updateValue(this.value);break;case"strictMode":this.strictMode=e.strictMode,this.updateValue(this.value),this.validateState();break;case"locale":this.initCultureFunc(),this.l10n.setLocale(this.locale),this.setSpinButton(),this.updatePlaceholder(),Te.setPlaceholder(this.placeholder,this.element),this.updateValue(this.value);break;case"currency":{var o=ie(a,e);this.setProperties({currencyCode:o},!0),this.updateCurrency(a,o)}break;case"currencyCode":{var l=ie(a,e);this.setProperties({currency:l},!0),this.updateCurrency("currency",l)}break;case"format":It(a,ie(a,e),this),this.initCultureInfo(),this.updateValue(this.value);break;case"decimals":this.decimals=e.decimals,this.updateValue(this.value)}}},t.prototype.updateClearButton=function(e){Te.setClearButton(e.showClearButton,this.element,this.inputWrapper,void 0,this.createElement),this.bindClearEvent()},t.prototype.updateSpinButton=function(e){e.showSpinButton?this.spinBtnCreation():(Oe(this.spinUp),Oe(this.spinDown))},t.prototype.getModuleName=function(){return"numerictextbox"},Gt([O("")],t.prototype,"cssClass",void 0),Gt([O(null)],t.prototype,"value",void 0),Gt([O(-Number.MAX_VALUE)],t.prototype,"min",void 0),Gt([O(Number.MAX_VALUE)],t.prototype,"max",void 0),Gt([O(1)],t.prototype,"step",void 0),Gt([O(null)],t.prototype,"width",void 0),Gt([O(null)],t.prototype,"placeholder",void 0),Gt([O({})],t.prototype,"htmlAttributes",void 0),Gt([O(!0)],t.prototype,"showSpinButton",void 0),Gt([O(!1)],t.prototype,"readonly",void 0),Gt([O(!0)],t.prototype,"enabled",void 0),Gt([O(!1)],t.prototype,"showClearButton",void 0),Gt([O(!1)],t.prototype,"enablePersistence",void 0),Gt([O("n2")],t.prototype,"format",void 0),Gt([O(null)],t.prototype,"decimals",void 0),Gt([O(null)],t.prototype,"currency",void 0),Gt([O(null)],t.prototype,"currencyCode",void 0),Gt([O(!0)],t.prototype,"strictMode",void 0),Gt([O(!1)],t.prototype,"validateDecimalOnType",void 0),Gt([O("Never")],t.prototype,"floatLabelType",void 0),Gt([Se()],t.prototype,"created",void 0),Gt([Se()],t.prototype,"destroyed",void 0),Gt([Se()],t.prototype,"change",void 0),Gt([Se()],t.prototype,"focus",void 0),Gt([Se()],t.prototype,"blur",void 0),t=Gt([Wi],t),t}(Rr),tH=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ga=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n};function Cb(s,t){for(var e=Ue({},s),i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];t.indexOf(n)<0&&I1(e,n)}return e}function iH(s,t){var e=t===40?0:s.childElementCount-1,i=e,r,n=s.querySelector(".e-selected");n&&n.classList.remove("e-selected");for(var a=0,o=s.children.length;a<o;a++)s.children[a].classList.contains("e-focused")&&(r=s.children[a],i=a,r.classList.remove("e-focused"),t===40?i++:i--,i===(t===40?s.childElementCount:-1)&&(i=e));r=s.children[i],i=Vw(s,r,i,t),i!==-1&&(P([s.children[i]],"e-focused"),s.children[i].focus())}function Vw(s,t,e,i,r){if(r===void 0&&(r=0),(t.classList.contains("e-separator")||t.classList.contains("e-disabled"))&&(e===(i===40?s.childElementCount-1:0)?e=i===40?0:s.childElementCount-1:i===40?e++:e--),t=s.children[e],t.classList.contains("e-separator")||t.classList.contains("e-disabled")){if(r++,r===s.childElementCount)return e=-1;e=Vw(s,t,e,i,r)}return e}function rH(s,t){var e=[].slice.call(s.getElementsByClassName("e-blank-icon"));if(e.length){var i=s.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)");if(!m(i)){i.classList.contains("e-url")&&(i=i.querySelector(".e-menu-url"));var r=i.querySelector(".e-menu-icon"),n,a=s.classList.contains("e-rtl");a?n={padding:"paddingRight",margin:"marginLeft"}:n={padding:"paddingLeft",margin:"marginRight"};var o=parseInt(getComputedStyle(r).fontSize,10)+parseInt(getComputedStyle(r)[n.margin],10)+parseInt(getComputedStyle(i).paddingLeft,10)+"px";e.forEach(function(l){l.classList.contains("e-url")&&l.querySelector(".e-menu-url")?l.querySelector(".e-menu-url").style[n.padding]=o:l.style[n.padding]=o})}}}var wb=function(s){tH(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return Ga([O("")],t.prototype,"iconCss",void 0),Ga([O("")],t.prototype,"id",void 0),Ga([O(!1)],t.prototype,"separator",void 0),Ga([O("")],t.prototype,"text",void 0),Ga([O("")],t.prototype,"url",void 0),Ga([O(!1)],t.prototype,"disabled",void 0),t}(Ir),Ww=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ri=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},hr={DISABLED:"e-disabled",FOCUS:"e-focused",ICON:"e-menu-icon",ITEM:"e-item",POPUP:"e-dropdown-popup",RTL:"e-rtl",SEPARATOR:"e-separator",VERTICAL:"e-vertical",POPUPWIDTH:"e-dropdown-popup-width"},sH=function(s){Ww(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return ri([O("SlideDown")],t.prototype,"effect",void 0),ri([O(400)],t.prototype,"duration",void 0),ri([O("ease")],t.prototype,"easing",void 0),t}(Ir),nH=function(s){Ww(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.isPopupCreated=!0,r}return t.prototype.preRender=function(){},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.createPopupOnClick&&!this.isPopupCreated?(this.createPopup(),this.openPopUp()):this.closePopup()},t.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete()},t.prototype.addItems=function(e,i){for(var r,n=this.items.length,a=0,o=this.items.length;a<o;a++)if(i===this.items[a].text){n=a;break}for(var l=e.length-1;l>=0;l--)r=new wb(this,"items",e[l],!0),this.items.splice(n,0,r);this.canOpen()||this.createItems()},t.prototype.removeItems=function(e,i){for(var r=!1,n=0,a=e.length;n<a;n++)for(var o=0,l=this.items.length;o<l;o++)if(e[n]===(i?this.items[o].id:this.items[o].text)){this.items.splice(o,1),r=!0;break}r&&this.getULElement()&&this.createItems()},t.prototype.createPopup=function(){var e,i=this.createElement("div",{className:this.popupWidth!=="auto"?hr.POPUP+" "+hr.POPUPWIDTH:hr.POPUP,id:this.element.id+"-popup"});if(document.body.appendChild(i),this.dropDown=new Bo(i,{width:this.popupWidth,relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl}),this.dropDown.element.setAttribute("role","dialog"),this.dropDown.element.setAttribute("aria-label","dropdown menu"),m(this.popupContent)||(this.popupContent.style.display=""),this.dropDown.element.style.position==="fixed"&&this.dropDown.refreshPosition(this.element),this.dropDown.hide(),Pe(this.element,(e={},e["aria-haspopup"]=this.items.length||this.target?"true":"false",e["aria-expanded"]="false",e.type="button",e)),this.cssClass&&P([i],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPopupCreated=!0,this.createPopupOnClick){var r=He(this.activeElem[0],"split-btn");r&&(r.isPopupCreated=!0)}},t.prototype.getTargetElement=function(){return this.createPopupOnClick&&!this.isColorPicker()&&!m(this.popupContent)?this.popupContent:typeof this.target=="string"?ye(this.target):this.target},t.prototype.createItems=function(e){var i=this,r=this.items,n=this.hasIcon(this.items,"iconCss"),a,o,l,h,u=this.getULElement();if(u?u.innerHTML="":u=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}}),this.itemTemplate){var c=this.compiletemplate(this.itemTemplate);r.forEach(function(g){var b=i.createElement("li",{className:g.separator?hr.ITEM+" "+hr.SEPARATOR:hr.ITEM,attrs:g.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":g.text},id:g.id?g.id:fi("e-"+i.getModuleName()+"-item")}),C=c(g,i,"template",null,!1,null,b);C&&at(C,b),g.disabled&&b.classList.add("e-disabled");var y={item:g,element:b};i.trigger("beforeItemRender",y),y.item.disabled!==g.disabled&&b.classList[y.item.disabled?"add":"remove"]("e-disabled"),u.appendChild(b)}),this.isReact&&this.renderReactTemplates()}else for(var f=0;f<r.length;f++){o=r[f],this.enableHtmlSanitizer&&(o.text=mr.sanitize(o.text));var d=o.text;l=this.createElement("li",{innerHTML:o.url?"":d,className:o.separator?hr.ITEM+" "+hr.SEPARATOR:hr.ITEM,attrs:o.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":d},id:o.id?o.id:fi("e-"+this.getModuleName()+"-item")}),this.enableHtmlSanitizer?l.textContent=o.url?"":d:l.innerHTML=o.url?"":d,o.url&&(l.appendChild(this.createAnchor(o)),l.classList.add("e-url")),o.iconCss?(a=this.createElement("span",{className:hr.ICON+" "+o.iconCss}),o.url?l.childNodes[0].appendChild(a):l.insertBefore(a,l.childNodes[0])):n&&!o.separator&&l.classList.add("e-blank-icon");var p=o.disabled;o.disabled&&l.classList.add("e-disabled"),h={item:o,element:l},this.trigger("beforeItemRender",h);var v=h.item.disabled;p!==v&&(h.item.disabled?l.classList.add("e-disabled"):l.classList.remove("e-disabled")),u.appendChild(l)}e&&this.getPopUpElement().appendChild(u),n&&rH(this.getPopUpElement())},t.prototype.compiletemplate=function(e){if(this.itemTemplate)try{if(typeof this.itemTemplate!="function"){var i=document.querySelector(this.itemTemplate);if(i)return wt(i.innerHTML.trim())}return wt(e)}catch(r){return wt(e)}},t.prototype.hasIcon=function(e,i){for(var r=0,n=e.length;r<n;r++)if(e[r][""+i])return!0;return!1},t.prototype.createAnchor=function(e){var i=e.text,r=this.createElement("a",{className:"e-menu-text e-menu-url",attrs:{href:e.url}});return this.enableHtmlSanitizer?r.textContent=i:r.innerHTML=i,r},t.prototype.initialize=function(){this.button=new Tl({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence}),this.button.createElement=this.createElement,this.button.appendTo(this.element),this.element.id||(this.element.id=fi("e-"+this.getModuleName())),this.appendArrowSpan(),this.setActiveElem([this.element]),this.element.setAttribute("tabindex","0"),this.element.setAttribute("aria-label",this.element.textContent?this.element.textContent:"dropdownbutton"),this.target&&!this.isColorPicker()&&!this.createPopupOnClick||!this.createPopupOnClick?this.createPopup():(this.isPopupCreated=!1,this.target&&!this.isColorPicker()&&this.createPopupOnClick&&(this.popupContent=this.getTargetElement(),this.popupContent.style.display="none"))},t.prototype.isColorPicker=function(){if(!this.element)return!1;var e=this.element.previousSibling;return!!(e&&e.classList&&e.classList.contains("e-split-colorpicker"))},t.prototype.appendArrowSpan=function(){this.cssClass=m(this.cssClass)?"":this.cssClass,this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(hr.VERTICAL)>-1?"bottom":"right")+" e-caret"}))},t.prototype.setActiveElem=function(e){this.activeElem=e},t.prototype.getModuleName=function(){return"dropdown-btn"},t.prototype.canOpen=function(){var e=!1;return this.isPopupCreated&&(e=this.getPopUpElement().classList.contains("e-popup-close")),e},t.prototype.destroy=function(){var e=this;if(s.prototype.destroy.call(this),this.getModuleName()==="dropdown-btn"){var i;this.element.querySelector("span.e-caret")&&Oe(this.element.querySelector("span.e-caret")),this.cssClass&&(i=this.cssClass.split(" ")),this.button.destroy(),i&&Z([this.element],i),Z(this.activeElem,["e-active"]);var r=this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"];r.forEach(function(n){e.element.removeAttribute(n)}),this.popupUnWireEvents(),this.destroyPopup(),this.isPopupCreated=!1,this.disabled||this.unWireEvents()}},t.prototype.destroyPopup=function(){if(this.isPopupCreated){if(this.dropDown.destroy(),this.getPopUpElement()){var e=document.getElementById(this.getPopUpElement().id);e&&(Z([e],["e-popup-open","e-popup-close"]),Oe(e))}R.remove(this.getPopUpElement(),"click",this.clickHandler),R.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.isPopupCreated&&this.dropDown&&(this.dropDown.element=null,this.dropDown=void 0)}this.isPopupCreated=!1;var i=He(this.activeElem[0],"split-btn");if(this.createPopupOnClick&&i){var r=He(this.activeElem[1],"dropdown-btn");r&&(r.isPopupCreated=!1)}},t.prototype.getPopUpElement=function(){var e=null;if(!this.dropDown&&this.activeElem[0].classList.contains("e-split-btn")){var i=He(this.activeElem[1],"dropdown-btn");i&&(this.dropDown=i.dropDown)}return this.dropDown&&(e=this.dropDown.element),e},t.prototype.getULElement=function(){var e=null;return this.getPopUpElement()&&(e=this.getPopUpElement().children[0]),e},t.prototype.wireEvents=function(){this.delegateMousedownHandler=this.mousedownHandler.bind(this),this.createPopupOnClick||R.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),R.add(this.element,"click",this.clickHandler,this),R.add(this.element,"keydown",this.keyBoardHandler,this),R.add(window,"resize",this.windowResize,this)},t.prototype.windowResize=function(){!this.canOpen()&&this.dropDown&&this.dropDown.refreshPosition(this.element)},t.prototype.popupWireEvents=function(){this.delegateMousedownHandler||(this.delegateMousedownHandler=this.mousedownHandler.bind(this));var e=this.getPopUpElement();this.createPopupOnClick&&R.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),e&&(R.add(e,"click",this.clickHandler,this),R.add(e,"keydown",this.keyBoardHandler,this),this.closeActionEvents&&R.add(e,this.closeActionEvents,this.focusoutHandler,this)),this.rippleFn=os(e,{selector:"."+hr.ITEM})},t.prototype.popupUnWireEvents=function(){var e=this.getPopUpElement();this.createPopupOnClick&&R.remove(document,"mousedown touchstart",this.delegateMousedownHandler),e&&e.parentElement&&(R.remove(e,"click",this.clickHandler),R.remove(e,"keydown",this.keyBoardHandler),this.closeActionEvents&&R.remove(e,this.closeActionEvents,this.focusoutHandler))},t.prototype.keyBoardHandler=function(e){if(!(e.target===this.element&&(e.keyCode===9||!e.altKey&&e.keyCode===40||e.keyCode===38)))switch(e.target&&(e.target.classList.contains("e-item")||e.target.parentElement&&e.target.parentElement.classList.contains("e-split-btn-wrapper"))&&e.keyCode===13&&e.preventDefault(),e.keyCode){case 38:case 40:e.altKey&&(e.keyCode===38||e.keyCode===40)?this.keyEventHandler(e):this.upDownKeyHandler(e);break;case 9:case 13:case 27:case 32:this.keyEventHandler(e);break}},t.prototype.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},t.prototype.upDownKeyHandler=function(e){this.target&&(e.keyCode===38||e.keyCode===40)||(e.preventDefault(),iH(this.getULElement(),e.keyCode))},t.prototype.keyEventHandler=function(e){if(!(this.target&&(e.keyCode===13||e.keyCode===9))){if(e.keyCode===13&&this.activeElem[0].classList.contains("e-split-btn")){this.triggerSelect(e),this.activeElem[0].focus();return}e.target&&e.target.className.indexOf("e-edit-template")>-1&&e.keyCode===32||(e.keyCode!==9&&e.preventDefault(),e.keyCode===27||e.keyCode===38||e.keyCode===9?this.canOpen()||this.closePopup(e,this.element):this.clickHandler(e))}},t.prototype.getLI=function(e){return e.tagName==="LI"?e:X(e,"li")},t.prototype.mousedownHandler=function(e){var i=e.target;this.dropDown&&!this.canOpen()&&this.getPopUpElement()&&!(X(i,'[id="'+this.getPopUpElement().id+'"]')||X(i,'[id="'+this.element.id+'"]'))&&this.closePopup(e)},t.prototype.focusoutHandler=function(e){if(this.isPopupCreated&&!this.canOpen()){var i=e.relatedTarget||e.target;if(i&&i.className.indexOf("e-item")>-1){var r=this.getLI(i);if(r){var n=Array.prototype.indexOf.call(this.getULElement().children,r),a=this.items[n];if(a){var o={element:r,item:a,event:e};this.trigger("select",o)}}}this.closePopup(e)}},t.prototype.clickHandler=function(e){var i=e.target;if(X(i,'[id="'+this.element.id+'"]'))!this.createPopupOnClick||this.target&&this.target!==""&&!this.isColorPicker()&&!this.createPopupOnClick?this.getPopUpElement().classList.contains("e-popup-close")?this.openPopUp(e):this.closePopup(e):this.isPopupCreated?this.closePopup(e,this.activeElem[0]):(this.createPopup(),this.openPopUp(e));else if(X(i,'[id="'+this.getPopUpElement().id+'"]')){var r=this.getLI(e.target);r&&(this.triggerSelect(e),this.closePopup(e,this.activeElem[0]))}},t.prototype.triggerSelect=function(e){var i,r,n,a=this.getLI(e.target);a&&(r=Array.prototype.indexOf.call(this.getULElement().children,a),n=this.items[r],n&&(i={element:a,item:n,event:e},this.trigger("select",i)))},t.prototype.openPopUp=function(e){var i=this;e===void 0&&(e=null);var r=this.getPopUpElement();if(this.activeElem[0]&&this.activeElem[0].classList.contains("e-dropdown-btn")&&r.style.width&&r.style.width!=="auto"&&this.setWidth(r),!this.target)this.createItems(!0);else if(this.activeElem.length>1){var n=He(this.activeElem[0],"split-btn");n.isReact&&r.childNodes.length<1&&(n.appendReactElement&&n.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates())}else this.isReact&&r.childNodes.length<1&&(this.appendReactElement&&this.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates());var a=this.getULElement();this.popupWireEvents();var o={element:a,items:this.items,event:e,cancel:!1};this.trigger("beforeOpen",o,function(l){if(!l.cancel){var h=i.getULElement(),u=i.animationSettings.effect!=="None"?{name:i.animationSettings.effect,duration:i.animationSettings.duration,timingFunction:i.animationSettings.easing}:null;if(u&&i.animatePopup(u,h),i.dropDown.show(null,i.element),P([i.element],"e-active"),i.element.setAttribute("aria-expanded","true"),i.element.setAttribute("aria-owns",i.getPopUpElement().id),h&&!i.isSafari()&&h.focus(),i.enableRtl&&h.parentElement.style.left!=="0px"){var c=void 0;i.element.parentElement&&i.element.parentElement.classList.contains("e-split-btn-wrapper")?c=i.element.parentElement.offsetWidth:c=i.element.offsetWidth;var f=h.parentElement.offsetWidth-c,d=parseFloat(h.parentElement.style.left)-f;d<0&&(d=0),h.parentElement.style.left=d+"px"}var p={element:h,items:i.items};i.trigger("open",p),h&&i.isSafari()&&h.focus()}})},t.prototype.animatePopup=function(e,i){new vr(e).animate(i,{begin:function(r){r.element.parentElement.style.height=r.element.parentElement.offsetHeight+"px"}})},t.prototype.setWidth=function(e){var i=st(e.style.width);if(i.indexOf("%")>-1){var r=this.element.offsetWidth*parseFloat(i)/100;e.style.width=r+"px"}},t.prototype.closePopup=function(e,i){var r=this;e===void 0&&(e=null);var n=this.getULElement(),a={element:n,items:this.items,event:e,cancel:!1};this.trigger("beforeClose",a,function(o){if(o.cancel)n&&n.focus();else{var l=r.getPopUpElement();l&&R.remove(l,"keydown",r.keyBoardHandler),r.popupUnWireEvents();var h=r.getULElement(),u=void 0;h&&(u=h.querySelector(".e-selected")),u&&u.classList.remove("e-selected"),r.dropDown&&r.dropDown.hide(),Z(r.activeElem,"e-active"),r.element.setAttribute("aria-expanded","false"),r.element.removeAttribute("aria-owns"),i&&(r.isSafari()?i.focus({preventScroll:!0}):i.focus());var c={element:h,items:r.items};r.trigger("close",c),!r.target&&h&&Oe(h),(!r.target||r.isColorPicker()||r.target&&!r.isColorPicker())&&r.createPopupOnClick&&r.destroyPopup()}})},t.prototype.unWireEvents=function(){this.createPopupOnClick||R.remove(document,"mousedown touchstart",this.delegateMousedownHandler),R.remove(this.element,"click",this.clickHandler),R.remove(this.element,"keydown",this.keyBoardHandler),this.isPopupCreated&&(R.remove(this.getPopUpElement(),"click",this.clickHandler),R.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler)),R.remove(window,"resize",this.windowResize)},t.prototype.onPropertyChanged=function(e,i){var r=["content","cssClass","iconCss","iconPosition","disabled","enableRtl"];this.button.setProperties(Cb(e,r));var n;this.isPopupCreated&&(n=this.getPopUpElement(),this.dropDown.setProperties(Cb(e,["enableRtl"])));for(var a=0,o=Object.keys(e);a<o.length;a++){var l=o[a];switch(l){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":e.disabled?(this.unWireEvents(),this.isPopupCreated&&!this.canOpen()&&this.closePopup()):this.wireEvents();break;case"cssClass":if(i.cssClass=m(i.cssClass)?"":i.cssClass,e.cssClass.indexOf(hr.VERTICAL)>-1||i.cssClass.indexOf(hr.VERTICAL)>-1){this.element.querySelector("span.e-caret")||this.appendArrowSpan();var h=this.element.querySelector("span.e-caret");e.cssClass.indexOf(hr.VERTICAL)>-1?On(h,["e-icon-bottom"],["e-icon-right"]):On(h,["e-icon-right"],["e-icon-bottom"])}this.isPopupCreated&&(i.cssClass&&Z([n],i.cssClass.split(" ")),e.cssClass&&P([n],e.cssClass.replace(/\s+/g," ").trim().split(" ")));break;case"target":this.dropDown.content=this.getTargetElement(),this.dropDown.dataBind();break;case"items":this.isPopupCreated&&this.getULElement()&&this.createItems();break;case"createPopupOnClick":e.createPopupOnClick?this.destroyPopup():this.createPopup();break}}},t.prototype.focusIn=function(){this.element.focus()},ri([O("")],t.prototype,"content",void 0),ri([O("")],t.prototype,"cssClass",void 0),ri([O(!1)],t.prototype,"disabled",void 0),ri([O("")],t.prototype,"iconCss",void 0),ri([O("Left")],t.prototype,"iconPosition",void 0),ri([O(!0)],t.prototype,"enableHtmlSanitizer",void 0),ri([_1([],wb)],t.prototype,"items",void 0),ri([O(!1)],t.prototype,"createPopupOnClick",void 0),ri([O("")],t.prototype,"target",void 0),ri([O("")],t.prototype,"closeActionEvents",void 0),ri([O(null)],t.prototype,"itemTemplate",void 0),ri([O("auto")],t.prototype,"popupWidth",void 0),ri([Ur({effect:"None"},sH)],t.prototype,"animationSettings",void 0),ri([Se()],t.prototype,"beforeItemRender",void 0),ri([Se()],t.prototype,"beforeOpen",void 0),ri([Se()],t.prototype,"beforeClose",void 0),ri([Se()],t.prototype,"close",void 0),ri([Se()],t.prototype,"open",void 0),ri([Se()],t.prototype,"select",void 0),ri([Se()],t.prototype,"created",void 0),t=ri([Wi],t),t}(Rr),aH=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),wi=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},oH="e-clear-icon-hide",qu=function(s){aH(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.previousValue=null,r.isHiddenInput=!1,r.isForm=!1,r.inputPreviousValue=null,r.textboxOptions=e,r}return t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];switch(a){case"floatLabelType":Te.removeFloating(this.textboxWrapper),Te.addFloating(this.respectiveElement,this.floatLabelType,this.placeholder);break;case"enabled":Te.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container),this.bindClearEvent();break;case"width":Te.setWidth(e.width,this.textboxWrapper.container);break;case"value":{var o=this.isProtectedOnChange;this.isProtectedOnChange=!0,Te.isBlank(this.value)||(this.value=this.value.toString()),this.isProtectedOnChange=o,Te.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.inputPreviousValue=this.respectiveElement.value,(this.isAngular||this.isVue)&&this.preventChange===!0?(this.previousValue=this.isAngular?this.value:this.previousValue,this.preventChange=!1):(m(this.isAngular)||!this.isAngular||this.isAngular&&!this.preventChange||this.isAngular&&m(this.preventChange))&&this.raiseChangeEvent()}break;case"htmlAttributes":this.updateHTMLAttributesToElement(),this.updateHTMLAttributesToWrapper(),this.checkAttributes(!0),this.multiline&&!m(this.textarea)?Te.validateInputType(this.textboxWrapper.container,this.textarea):Te.validateInputType(this.textboxWrapper.container,this.element);break;case"readonly":Te.setReadonly(this.readonly,this.respectiveElement);break;case"type":this.respectiveElement.tagName!=="TEXTAREA"&&(this.respectiveElement.setAttribute("type",this.type),Te.validateInputType(this.textboxWrapper.container,this.element),this.raiseChangeEvent());break;case"showClearButton":Te.setClearButton(this.showClearButton,this.respectiveElement,this.textboxWrapper),this.bindClearEvent();break;case"enableRtl":Te.setEnableRtl(this.enableRtl,[this.textboxWrapper.container]);break;case"placeholder":Te.setPlaceholder(this.placeholder,this.respectiveElement),Te.calculateWidth(this.respectiveElement,this.textboxWrapper.container);break;case"autocomplete":this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:this.removeAttributes(["autocomplete"]);break;case"cssClass":Te.updateCssClass(e.cssClass,i.cssClass,this.textboxWrapper.container);break;case"locale":this.globalize=new Ji(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),Te.setPlaceholder(this.placeholder,this.respectiveElement);break}}},t.prototype.getModuleName=function(){return"textbox"},t.prototype.preRender=function(){if(this.cloneElement=this.element.cloneNode(!0),this.formElement=X(this.element,"form"),m(this.formElement)||(this.isForm=!0),this.element.tagName==="EJS-TEXTBOX"){var e=ie("ej2_instances",this.element),i=this.multiline?this.createElement("textarea"):this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;n!=="id"&&n!=="class"?(i.setAttribute(n,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML,n==="name"&&this.element.removeAttribute("name")):n==="class"&&i.setAttribute(n,this.element.className.split(" ").filter(function(l){return l.indexOf("ng-")!==0}).join(" "))}this.element.appendChild(i),this.element=i,It("ej2_instances",e,this.element)}this.updateHTMLAttributesToElement(),this.checkAttributes(!1),(m(this.textboxOptions)||this.textboxOptions.value===void 0)&&this.element.value!==""&&this.setProperties({value:this.element.value},!0),this.element.tagName!=="TEXTAREA"&&this.element.setAttribute("type",this.type),(this.type==="text"||this.element.tagName==="INPUT"&&this.multiline&&this.isReact)&&this.element.setAttribute("role","textbox"),this.globalize=new Ji(this.locale);var a={placeholder:this.placeholder};if(this.l10n=new br("textbox",a,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",fi("textbox")),this.element.hasAttribute("name")||this.element.setAttribute("name",this.element.getAttribute("id")),this.element.tagName==="INPUT"&&this.multiline){this.isHiddenInput=!0,this.textarea=this.createElement("textarea"),this.element.parentNode.insertBefore(this.textarea,this.element),this.element.setAttribute("type","hidden"),this.textarea.setAttribute("name",this.element.getAttribute("name")),this.element.removeAttribute("name"),this.textarea.setAttribute("role",this.element.getAttribute("role")),this.element.removeAttribute("role"),this.textarea.setAttribute("id",fi("textarea"));for(var o=["placeholder","disabled","value","readonly","type","autocomplete"],r=0;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;this.element.hasAttribute(n)&&cp.indexOf(n)<0&&!(n==="id"||n==="type"||n==="e-mappinguid")&&(this.textarea.setAttribute(n,this.element.attributes[r].nodeValue),o.indexOf(n)<0&&(this.element.removeAttribute(n),r--))}}},t.prototype.checkAttributes=function(e){for(var i=e?m(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["placeholder","disabled","value","readonly","type","autocomplete"],r=0,n=i;r<n.length;r++){var a=n[r];if(!m(this.element.getAttribute(a)))switch(a){case"disabled":if(m(this.textboxOptions)||this.textboxOptions.enabled===void 0||e){var o=!(this.element.getAttribute(a)==="disabled"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true");this.setProperties({enabled:o},!e)}break;case"readonly":if(m(this.textboxOptions)||this.textboxOptions.readonly===void 0||e){var l=this.element.getAttribute(a)==="readonly"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true";this.setProperties({readonly:l},!e)}break;case"placeholder":(m(this.textboxOptions)||this.textboxOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.element.placeholder},!e);break;case"autocomplete":if(m(this.textboxOptions)||this.textboxOptions.autocomplete===void 0||e){var h=this.element.autocomplete==="off"?"off":"on";this.setProperties({autocomplete:h},!e)}break;case"value":(m(this.textboxOptions)||this.textboxOptions.value===void 0||e)&&this.element.value!==""&&this.setProperties({value:this.element.value},!e);break;case"type":(m(this.textboxOptions)||this.textboxOptions.type===void 0||e)&&this.setProperties({type:this.element.type},!e);break}}},t.prototype.render=function(){var e=this.cssClass;!m(this.cssClass)&&this.cssClass!==""&&(e=Te.getInputValidClassList(this.cssClass)),this.respectiveElement=this.isHiddenInput?this.textarea:this.element,this.textboxWrapper=Te.createInput({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:{enabled:this.enabled,enableRtl:this.enableRtl,cssClass:e,readonly:this.readonly,placeholder:this.placeholder,showClearButton:this.showClearButton}}),this.updateHTMLAttributesToWrapper(),this.isHiddenInput&&this.respectiveElement.parentNode.insertBefore(this.element,this.respectiveElement),this.wireEvents(),m(this.value)||(Te.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value)),m(this.value)||(this.initialValue=this.value,this.setInitialValue()),this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:!m(this.textboxOptions)&&this.textboxOptions.autocomplete!==void 0&&this.removeAttributes(["autocomplete"]),this.previousValue=this.value,this.inputPreviousValue=this.value,this.respectiveElement.defaultValue=this.respectiveElement.value,Te.setWidth(this.width,this.textboxWrapper.container),!m(X(this.element,"fieldset"))&&X(this.element,"fieldset").disabled&&(this.enabled=!1),!this.element.hasAttribute("aria-labelledby")&&!this.element.hasAttribute("placeholder")&&!this.element.hasAttribute("aria-label")&&this.element.setAttribute("aria-label","textbox"),this.renderComplete()},t.prototype.updateHTMLAttributesToWrapper=function(){Te.updateHTMLAttributesToWrapper(this.htmlAttributes,this.textboxWrapper.container)},t.prototype.updateHTMLAttributesToElement=function(){Te.updateHTMLAttributesToElement(this.htmlAttributes,this.respectiveElement?this.respectiveElement:this.multiline&&!m(this.textarea)?this.textarea:this.element)},t.prototype.setInitialValue=function(){this.isAngular||this.respectiveElement.setAttribute("value",this.initialValue)},t.prototype.wireEvents=function(){R.add(this.respectiveElement,"focus",this.focusHandler,this),R.add(this.respectiveElement,"blur",this.focusOutHandler,this),R.add(this.respectiveElement,"keydown",this.keydownHandler,this),R.add(this.respectiveElement,"input",this.inputHandler,this),R.add(this.respectiveElement,"change",this.changeHandler,this),this.isForm&&R.add(this.formElement,"reset",this.resetForm,this),this.bindClearEvent(),!m(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-autofill")&&this.textboxWrapper.container.classList.contains("e-outline")&&R.add(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler,this)},t.prototype.animationHandler=function(){this.textboxWrapper.container.classList.add("e-valid-input");var e=this.textboxWrapper.container.querySelector(".e-float-text");m(e)||(e.classList.add("e-label-top"),e.classList.contains("e-label-bottom")&&e.classList.remove("e-label-bottom"))},t.prototype.resetValue=function(e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.value=e,e==null&&this.textboxWrapper.container.classList.contains("e-valid-input")&&!(this.floatLabelType==="Always"&&this.textboxWrapper.container.classList.contains("e-outline"))&&this.textboxWrapper.container.classList.remove("e-valid-input"),this.isProtectedOnChange=i},t.prototype.resetForm=function(){if(this.isAngular?this.resetValue(""):this.resetValue(this.initialValue),!m(this.textboxWrapper)){var e=this.textboxWrapper.container.querySelector(".e-float-text");!m(e)&&this.floatLabelType!=="Always"&&(m(this.initialValue)||this.initialValue===""?(e.classList.add("e-label-bottom"),e.classList.remove("e-label-top")):this.initialValue!==""&&(e.classList.add("e-label-top"),e.classList.remove("e-label-bottom")))}},t.prototype.focusHandler=function(e){var i={container:this.textboxWrapper.container,event:e,value:this.value};this.trigger("focus",i)},t.prototype.focusOutHandler=function(e){!(this.previousValue===null&&this.value===null&&this.respectiveElement.value==="")&&this.previousValue!==this.value&&this.raiseChangeEvent(e,!0);var i={container:this.textboxWrapper.container,event:e,value:this.value};this.trigger("blur",i)},t.prototype.keydownHandler=function(e){(e.keyCode===13||e.keyCode===9)&&!((this.previousValue===null||this.previousValue==="")&&(this.value===null||this.value==="")&&this.respectiveElement.value==="")&&this.setProperties({value:this.respectiveElement.value},!0)},t.prototype.inputHandler=function(e){var i=this,r={event:e,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};this.inputPreviousValue=this.respectiveElement.value,this.isAngular&&(i.localChange({value:this.respectiveElement.value}),this.preventChange=!0),this.isVue&&(this.preventChange=!0),this.trigger("input",r),e.stopPropagation()},t.prototype.changeHandler=function(e){this.setProperties({value:this.respectiveElement.value},!0),this.previousValue!==this.value&&this.raiseChangeEvent(e,!0),e.stopPropagation()},t.prototype.raiseChangeEvent=function(e,i){var r={event:e,value:this.value,previousValue:this.previousValue,container:this.textboxWrapper.container,isInteraction:i||!1,isInteracted:i||!1};this.preventChange=!1,this.trigger("change",r),this.previousValue=this.value,this.element.tagName==="INPUT"&&this.multiline&&xe.info.name==="mozilla"&&(this.element.value=this.respectiveElement.value)},t.prototype.bindClearEvent=function(){this.showClearButton&&(this.enabled?R.add(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler,this):R.remove(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler))},t.prototype.resetInputHandler=function(e){if(e.preventDefault(),!this.textboxWrapper.clearButton.classList.contains(oH)||this.textboxWrapper.container.classList.contains("e-static-clear")){Te.setValue("",this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.setProperties({value:this.respectiveElement.value},!0);var i={event:e,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};if(this.trigger("input",i),this.inputPreviousValue=this.respectiveElement.value,this.raiseChangeEvent(e,!0),X(this.element,"form")){var r=this.element,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}}},t.prototype.unWireEvents=function(){R.remove(this.respectiveElement,"focus",this.focusHandler),R.remove(this.respectiveElement,"blur",this.focusOutHandler),R.remove(this.respectiveElement,"keydown",this.keydownHandler),R.remove(this.respectiveElement,"input",this.inputHandler),R.remove(this.respectiveElement,"change",this.changeHandler),this.isForm&&R.remove(this.formElement,"reset",this.resetForm),!m(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-outline")&&this.textboxWrapper.container.classList.contains("e-autofill")&&R.remove(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler)},t.prototype.destroy=function(){this.unWireEvents(),this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),this.element.tagName==="INPUT"&&this.multiline&&(Oe(this.textboxWrapper.container.getElementsByTagName("textarea")[0]),this.respectiveElement=this.element,this.element.removeAttribute("type")),this.respectiveElement.value=this.respectiveElement.defaultValue,this.respectiveElement.classList.remove("e-input"),this.removeAttributes(["aria-disabled","aria-readonly","aria-labelledby"]),m(this.textboxWrapper)||(this.textboxWrapper.container.insertAdjacentElement("afterend",this.respectiveElement),Oe(this.textboxWrapper.container)),this.textboxWrapper=null,Te.destroy({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),s.prototype.destroy.call(this)},t.prototype.addIcon=function(e,i){Te.addIcon(e,i,this.textboxWrapper.container,this.respectiveElement,this.createElement)},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.addAttributes=function(e){for(var i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];n==="disabled"?(this.setProperties({enabled:!1},!0),Te.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):n==="readonly"?(this.setProperties({readonly:!0},!0),Te.setReadonly(this.readonly,this.respectiveElement)):n==="class"?this.respectiveElement.classList.add(e[""+n]):n==="placeholder"?(this.setProperties({placeholder:e[""+n]},!0),Te.setPlaceholder(this.placeholder,this.respectiveElement)):n==="rows"&&this.respectiveElement.tagName==="TEXTAREA"?this.respectiveElement.setAttribute(n,e[""+n]):this.respectiveElement.setAttribute(n,e[""+n])}},t.prototype.removeAttributes=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n==="disabled"?(this.setProperties({enabled:!0},!0),Te.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):n==="readonly"?(this.setProperties({readonly:!1},!0),Te.setReadonly(this.readonly,this.respectiveElement)):n==="placeholder"?(this.setProperties({placeholder:null},!0),Te.setPlaceholder(this.placeholder,this.respectiveElement)):this.respectiveElement.removeAttribute(n)}},t.prototype.focusIn=function(){document.activeElement!==this.respectiveElement&&this.enabled&&(this.respectiveElement.focus(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&P([this.textboxWrapper.container],[vb]))},t.prototype.focusOut=function(){document.activeElement===this.respectiveElement&&this.enabled&&(this.respectiveElement.blur(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&Z([this.textboxWrapper.container],[vb]))},wi([O("text")],t.prototype,"type",void 0),wi([O(!1)],t.prototype,"readonly",void 0),wi([O(null)],t.prototype,"value",void 0),wi([O("Never")],t.prototype,"floatLabelType",void 0),wi([O("")],t.prototype,"cssClass",void 0),wi([O(null)],t.prototype,"placeholder",void 0),wi([O("on")],t.prototype,"autocomplete",void 0),wi([O({})],t.prototype,"htmlAttributes",void 0),wi([O(!1)],t.prototype,"multiline",void 0),wi([O(!0)],t.prototype,"enabled",void 0),wi([O(!1)],t.prototype,"showClearButton",void 0),wi([O(!1)],t.prototype,"enablePersistence",void 0),wi([O(null)],t.prototype,"width",void 0),wi([Se()],t.prototype,"created",void 0),wi([Se()],t.prototype,"destroyed",void 0),wi([Se()],t.prototype,"change",void 0),wi([Se()],t.prototype,"blur",void 0),wi([Se()],t.prototype,"focus",void 0),wi([Se()],t.prototype,"input",void 0),t=wi([Wi],t),t}(Rr),lH=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),St=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},tt={root:"e-dropdownlist",hover:ne.hover,selected:ne.selected,rtl:ne.rtl,li:ne.li,disable:ne.disabled,base:ne.root,focus:ne.focus,content:ne.content,input:"e-input-group",inputFocus:"e-input-focus",icon:"e-input-group-icon e-ddl-icon",iconAnimation:"e-icon-anim",value:"e-input-value",device:"e-ddl-device",backIcon:"e-input-group-icon e-back-icon e-icons",filterBarClearIcon:"e-input-group-icon e-clear-icon e-icons",filterInput:"e-input-filter",resizeIcon:"e-resizer-right e-icons",filterParent:"e-filter-parent",mobileFilter:"e-ddl-device-filter",footer:"e-ddl-footer",header:"e-ddl-header",clearIcon:"e-clear-icon",clearIconHide:"e-clear-icon-hide",popupFullScreen:"e-popup-full-page",disableIcon:"e-ddl-disable-icon",hiddenElement:"e-ddl-hidden",virtualList:"e-list-item e-virtual-list"},hH={container:null,buttons:[]},vu=function(s){lH(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.isListSearched=!1,r.preventChange=!1,r.isTouched=!1,r.isFocused=!1,r.autoFill=!1,r.isUpdateHeaderHeight=!1,r.isUpdateFooterHeight=!1,r.isReactTemplateUpdate=!1,r}return t.prototype.preRender=function(){this.valueTempElement=null,this.element.style.opacity="0",this.initializeData(),s.prototype.preRender.call(this),this.activeIndex=this.index,this.queryString=""},t.prototype.initializeData=function(){this.isPopupOpen=!1,this.isDocumentClick=!1,this.isInteracted=!1,this.isFilterFocus=!1,this.beforePopupOpen=!1,this.initial=!0,this.initialRemoteRender=!1,this.isNotSearchList=!1,this.isTyped=!1,this.isSelected=!1,this.preventFocus=!1,this.preventAutoFill=!1,this.isValidKey=!1,this.typedString="",this.isEscapeKey=!1,this.isPreventBlur=!1,this.isTabKey=!1,this.actionCompleteData={isUpdated:!1},this.actionData={isUpdated:!1},this.prevSelectPoints={},this.isSelectCustom=!1,this.isDropDownClick=!1,this.preventAltUp=!1,this.isCustomFilter=!1,this.isSecondClick=!1,this.previousValue=null,this.keyConfigure={tab:"tab",enter:"13",escape:"27",end:"35",home:"36",down:"40",up:"38",pageUp:"33",pageDown:"34",open:"alt+40",close:"shift+tab",hide:"alt+38",space:"32"},this.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount}},t.prototype.setZIndex=function(){this.popupObj&&this.popupObj.setProperties({zIndex:this.zIndex})},t.prototype.requiredModules=function(){var e=[];return this.enableVirtualization&&e.push({args:[this],member:"VirtualScroll"}),e},t.prototype.renderList=function(e,i){s.prototype.render.call(this,e,i),this.dataSource instanceof fe||(this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0),this.enableVirtualization&&this.isFiltering()&&this.getModuleName()==="combobox"&&(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+ne.li),this.ulElement=this.list.querySelector("ul")),this.unWireListEvents(),this.wireListEvents()},t.prototype.floatLabelChange=function(){if(this.getModuleName()==="dropdownlist"&&this.floatLabelType==="Auto"){var e=this.inputWrapper.container.querySelector(".e-float-text");this.inputElement.value!==""||this.isInteracted?On(e,["e-label-top"],["e-label-bottom"]):On(e,["e-label-bottom"],["e-label-top"])}},t.prototype.resetHandler=function(e){e.preventDefault(),this.clearAll(e),this.enableVirtualization&&(this.list.scrollTop=0,this.virtualListInfo=null,this.previousStartIndex=0,this.previousEndIndex=0)},t.prototype.resetFocusElement=function(){if(this.removeHover(),this.removeSelection(),this.removeFocus(),this.list.scrollTop=0,this.getModuleName()!=="autocomplete"&&!m(this.ulElement)){var e=this.fields.disabled?this.ulElement.querySelector("."+tt.li+":not(.e-disabled)"):this.ulElement.querySelector("."+tt.li);this.enableVirtualization&&(e=this.liCollections[this.skeletonCount]),e&&e.classList.add(tt.focus)}},t.prototype.clearAll=function(e,i){this.previousItemData=m(this.itemData)?null:this.itemData,(m(i)||!m(i)&&(m(i.dataSource)||!(i.dataSource instanceof fe)&&i.dataSource.length===0))&&(this.isActive=!0,this.resetSelection(i));var r=this.getItemData();if(!this.allowObjectBinding&&this.previousValue===r.value||this.allowObjectBinding&&this.previousValue&&this.isObjectInArray(this.previousValue,[this.allowCustom?this.value?this.value:r:r.value?this.getDataByValue(r.value):r])){this.checkAndResetCache(),this.enableVirtualization&&this.list&&this.updateInitialData();return}this.onChangeEvent(e),this.checkAndResetCache(),this.enableVirtualization&&this.updateInitialData()},t.prototype.resetSelection=function(e){this.list&&(!m(e)&&(m(e.dataSource)||!(e.dataSource instanceof fe)&&e.dataSource.length===0)?(this.selectedLI=null,this.actionCompleteData.isUpdated=!1,this.actionCompleteData.ulElement=null,this.actionCompleteData.list=null,this.resetList(e.dataSource)):(this.allowFiltering&&this.getModuleName()!=="autocomplete"&&!m(this.actionCompleteData.ulElement)&&!m(this.actionCompleteData.list)&&this.actionCompleteData.list.length>0&&this.onActionComplete(this.actionCompleteData.ulElement.cloneNode(!0),this.actionCompleteData.list),this.resetFocusElement())),m(this.hiddenElement)||(this.hiddenElement.innerHTML=""),m(this.inputElement)||(this.inputElement.value=""),this.value=null,this.itemData=null,this.text=null,this.index=null,this.activeIndex=null,this.item=null,this.queryString="",this.valueTempElement&&(Oe(this.valueTempElement),this.inputElement.style.display="block",this.valueTempElement=null),this.setSelection(null,null),this.isSelectCustom=!1,this.updateIconState(),this.cloneElements()},t.prototype.setHTMLAttributes=function(){if(Object.keys(this.htmlAttributes).length)for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(r==="class"){var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&P([this.inputWrapper.container],n.split(" "))}else if(r==="disabled"&&this.htmlAttributes[""+r]==="disabled")this.enabled=!1,this.setEnable();else if(r==="readonly"&&!m(this.htmlAttributes[""+r]))this.readonly=!0,this.dataBind();else if(r==="style")this.inputWrapper.container.setAttribute("style",this.htmlAttributes[""+r]);else if(r==="aria-label")(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&!this.readonly?this.inputElement.setAttribute("aria-label",this.htmlAttributes[""+r]):this.getModuleName()==="dropdownlist"&&this.inputWrapper.container.setAttribute("aria-label",this.htmlAttributes[""+r]);else{var a=["title","id","placeholder","role","autocomplete","autocapitalize","spellcheck","minlength","maxlength"],o=["name","required"];(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&a.push("tabindex"),o.indexOf(r)>-1||r.indexOf("data")===0?this.hiddenElement.setAttribute(r,this.htmlAttributes[""+r]):a.indexOf(r)>-1?r==="placeholder"?Te.setPlaceholder(this.htmlAttributes[""+r],this.inputElement):this.inputElement.setAttribute(r,this.htmlAttributes[""+r]):this.inputWrapper.container.setAttribute(r,this.htmlAttributes[""+r])}}(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&this.inputWrapper.container.removeAttribute("tabindex")},t.prototype.getAriaAttributes=function(){return{"aria-disabled":"false",role:"combobox","aria-expanded":"false","aria-live":"polite","aria-labelledby":this.hiddenElement.id}},t.prototype.setEnableRtl=function(){!m(this.inputElement)&&!m(this.inputElement.parentElement)&&Te.setEnableRtl(this.enableRtl,[this.inputElement.parentElement]),this.popupObj&&(this.popupObj.enableRtl=this.enableRtl,this.popupObj.dataBind())},t.prototype.setEnable=function(){Te.setEnabled(this.enabled,this.inputElement),this.enabled?(Z([this.inputWrapper.container],tt.disable),this.inputElement.setAttribute("aria-disabled","false"),this.targetElement().setAttribute("tabindex",this.tabIndex),this.inputWrapper&&this.inputWrapper.container&&(this.inputWrapper.container.setAttribute("aria-disabled","false"),this.inputWrapper.container.removeAttribute("disabled"))):(this.hidePopup(),P([this.inputWrapper.container],tt.disable),this.inputElement.setAttribute("aria-disabled","true"),this.targetElement().tabIndex=-1,this.inputWrapper&&this.inputWrapper.container&&(this.inputWrapper.container.setAttribute("aria-disabled","true"),this.inputWrapper.container.setAttribute("disabled","")))},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.getLocaleName=function(){return"drop-down-list"},t.prototype.preventTabIndex=function(e){this.getModuleName()==="dropdownlist"&&(e.tabIndex=-1)},t.prototype.targetElement=function(){return m(this.inputWrapper)?null:this.inputWrapper.container},t.prototype.getNgDirective=function(){return"EJS-DROPDOWNLIST"},t.prototype.getElementByText=function(e){return this.getElementByValue(this.getValueByText(e))},t.prototype.getElementByValue=function(e){for(var i,r=this.getItems(),n=0,a=r;n<a.length;n++){var o=a[n];if(this.getFormattedValue(o.getAttribute("data-value"))===e){i=o;break}}return i},t.prototype.initValue=function(){this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.itemCount,this.renderList(),this.dataSource instanceof fe?this.initialRemoteRender=!0:this.updateValues()},t.prototype.isDisableItemValue=function(e){if(typeof e=="object"){var i=JSON.parse(JSON.stringify(e))[this.fields.value];return this.isDisabledItemByIndex(this.getIndexByValue(i))}return this.isDisabledItemByIndex(this.getIndexByValue(e))},t.prototype.updateValues=function(){if(this.fields.disabled&&(this.value!=null&&(this.value=this.isDisableItemValue(this.value)?null:this.value),this.text!=null&&(this.text=this.isDisabledItemByIndex(this.getIndexByValue(this.getValueByText(this.text)))?null:this.text),this.index!=null&&(this.index=this.isDisabledItemByIndex(this.index)?null:this.index,this.activeIndex=this.index)),this.selectedValueInfo=this.viewPortInfo,m(this.value))if(this.text&&m(this.value)){var i=this.getElementByText(this.text);if(m(i)){this.setProperties({text:null});return}else this.setSelection(i,null)}else this.setSelection(this.liCollections[this.activeIndex],null);else{var e=this.allowObjectBinding&&!m(this.value)?ie(this.fields.value?this.fields.value:"",this.value):this.value;this.setSelection(this.getElementByValue(e),null)}this.setHiddenValue(),Te.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.onBlurHandler=function(e){if(this.enabled){var i=e.relatedTarget,r=e.target,n=this.isPreventBlur;if(this.isPreventBlur=!1,n&&!this.isDocumentClick&&this.isPopupOpen&&(!m(r)||!this.isFilterLayout()&&m(i))){this.getModuleName()==="dropdownlist"&&this.allowFiltering&&this.isPopupOpen?this.filterInput.focus():this.targetElement().focus();return}if(this.isDocumentClick||!m(this.popupObj)&&document.body.contains(this.popupObj.element)&&this.popupObj.element.classList.contains(tt.mobileFilter)){this.beforePopupOpen||(this.isDocumentClick=!1);return}(this.getModuleName()==="dropdownlist"&&!this.isFilterFocus&&i!==this.inputElement&&(document.activeElement!==i||document.activeElement===i&&r.classList.contains(tt.inputFocus))||m(i)&&this.getModuleName()==="dropdownlist"&&this.allowFiltering&&r!==this.inputWrapper.container||this.getModuleName()!=="dropdownlist"&&!this.inputWrapper.container.contains(i)||this.isTabKey)&&(this.isDocumentClick=!!this.isPopupOpen,this.focusOutAction(e),this.isTabKey=!1),this.isRequested&&!this.isPopupOpen&&!this.isPreventBlur&&(this.isActive=!1,this.beforePopupOpen=!1),this.isFocused=!1}},t.prototype.focusOutAction=function(e){this.isInteracted=!1,this.focusOut(e),this.onFocusOut(e)},t.prototype.onFocusOut=function(e){this.enabled&&(this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(e)),this.floatLabelChange(),this.dispatchEvent(this.hiddenElement,"change"),this.getModuleName()==="dropdownlist"&&this.element.tagName!=="INPUT"&&this.dispatchEvent(this.inputElement,"blur"),this.inputWrapper.clearButton&&P([this.inputWrapper.clearButton],tt.clearIconHide),this.trigger("blur"))},t.prototype.onFocus=function(e){if(!this.isInteracted){this.isInteracted=!0;var i={isInteracted:!!e,event:e};this.trigger("focus",i)}this.updateIconState(),this.isFocused=!0},t.prototype.resizingWireEvent=function(){R.add(document,"mousemove",this.resizePopup,this),R.add(document,"mouseup",this.stopResizing,this),R.add(document,"touchmove",this.resizePopup,this),R.add(document,"touchend",this.stopResizing,this)},t.prototype.resizingUnWireEvent=function(){R.remove(document,"mousemove",this.resizePopup),R.remove(document,"mouseup",this.stopResizing),R.remove(document,"touchmove",this.resizePopup),R.remove(document,"touchend",this.stopResizing)},t.prototype.resetValueHandler=function(e){var i=X(this.inputElement,"form");if(i&&e.target===i){var r=this.element.tagName===this.getNgDirective()?null:this.inputElement.getAttribute("value");this.text=r}},t.prototype.wireEvent=function(){R.add(this.inputWrapper.container,"mousedown",this.dropDownClick,this),R.add(this.inputWrapper.container,"focus",this.focusIn,this),R.add(this.inputWrapper.container,"keypress",this.onSearch,this),R.add(window,"resize",this.windowResize,this),this.bindCommonEvent()},t.prototype.bindCommonEvent=function(){R.add(this.targetElement(),"blur",this.onBlurHandler,this);var e=X(this.inputElement,"form");e&&R.add(e,"reset",this.resetValueHandler,this),xe.isDevice?this.keyboardModule=new gr(this.targetElement(),{keyAction:this.mobileKeyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}):this.keyboardModule=new gr(this.targetElement(),{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),this.bindClearEvent()},t.prototype.windowResize=function(){this.isPopupOpen&&this.popupObj.refreshPosition(this.inputWrapper.container)},t.prototype.bindClearEvent=function(){this.showClearButton&&R.add(this.inputWrapper.clearButton,"mousedown",this.resetHandler,this)},t.prototype.unBindCommonEvent=function(){!m(this.inputWrapper)&&this.targetElement()&&R.remove(this.targetElement(),"blur",this.onBlurHandler);var e=this.inputElement&&X(this.inputElement,"form");e&&R.remove(e,"reset",this.resetValueHandler),xe.isDevice||this.keyboardModule.destroy(),this.showClearButton&&R.remove(this.inputWrapper.clearButton,"mousedown",this.resetHandler)},t.prototype.updateIconState=function(){this.showClearButton&&(this.inputElement.value!==""&&!this.readonly?Z([this.inputWrapper.clearButton],tt.clearIconHide):P([this.inputWrapper.clearButton],tt.clearIconHide))},t.prototype.wireListEvents=function(){m(this.list)||(R.add(this.list,"click",this.onMouseClick,this),R.add(this.list,"mouseover",this.onMouseOver,this),R.add(this.list,"mouseout",this.onMouseLeave,this))},t.prototype.onSearch=function(e){e.charCode!==32&&e.charCode!==13&&(this.list===void 0&&this.renderList(),this.searchKeyEvent=e,this.onServerIncrementalSearch(e))},t.prototype.onServerIncrementalSearch=function(e){!this.isRequested&&!m(this.list)&&!m(this.list.querySelector("li"))&&this.enabled&&!this.readonly&&this.incrementalSearch(e)},t.prototype.startResizing=function(e){this.isResizing=!0,this.trigger("resizeStart",e);var i=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,r=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;this.list&&this.list.parentElement&&(this.originalWidth=this.list.parentElement.offsetWidth,this.originalHeight=this.list.parentElement.offsetHeight,this.originalMouseX=i,this.originalMouseY=r),this.resizingWireEvent(),e&&e.preventDefault()},t.prototype.resizePopup=function(e){if(this.isResizing){this.trigger("resizing",e);var i=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,r=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,n=i-this.originalMouseX,a=r-this.originalMouseY;if(this.list&&this.list.parentElement){var o=parseInt(window.getComputedStyle(this.list.parentElement).minWidth,10),l=parseInt(window.getComputedStyle(this.list.parentElement).minHeight,10);o=o||100,l=l||120,this.resizeWidth=Math.max(this.originalWidth+n,o),this.resizeHeight=Math.max(this.originalHeight+a,l),this.list.parentElement.style.width=this.resizeWidth+"px",this.list.parentElement.style.height=this.resizeHeight+"px",this.list.parentElement.style.maxHeight=this.resizeHeight+"px",this.list.style.maxHeight=this.resizeHeight+"px",this.fixedHeaderElement&&this.ulElement&&(this.fixedHeaderElement.style.width=this.ulElement.offsetWidth+"px")}e&&e.preventDefault()}},t.prototype.stopResizing=function(e){this.isResizing&&(this.isResizing=!1,this.trigger("resizeStop",e),this.resizingUnWireEvent()),e&&e.preventDefault()},t.prototype.onMouseClick=function(e){var i=e.target;this.keyboardEvent=null;var r=X(i,"."+ne.li);if(!(!this.isValidLI(r)||this.isDisabledElement(r)))if(this.setSelection(r,e),xe.isDevice&&this.isFilterLayout())history.back();else{var n=100;this.closePopup(n,e)}},t.prototype.onMouseOver=function(e){var i=X(e.target,"."+ne.li);this.setHover(i)},t.prototype.setHover=function(e){this.enabled&&this.isValidLI(e)&&!e.classList.contains(ne.hover)&&(this.removeHover(),P([e],ne.hover))},t.prototype.onMouseLeave=function(){this.removeHover()},t.prototype.removeHover=function(){if(this.list){var e=this.list.querySelectorAll("."+ne.hover);e&&e.length&&Z(e,ne.hover)}},t.prototype.isValidLI=function(e){return e&&e.hasAttribute("role")&&e.getAttribute("role")==="option"},t.prototype.updateIncrementalItemIndex=function(e,i){this.incrementalStartIndex=e,this.incrementalEndIndex=i},t.prototype.incrementalSearch=function(e){if(this.liCollections.length>0)if(this.enableVirtualization){var i=!1,r=!1,n=this.ulElement.getElementsByClassName("e-active")[0],a=n?n.textContent:null;this.incrementalQueryString===""?(this.incrementalQueryString=String.fromCharCode(e.charCode),this.incrementalPreQueryString=this.incrementalQueryString):String.fromCharCode(e.charCode).toLocaleLowerCase()===this.incrementalPreQueryString.toLocaleLowerCase()?r=!0:this.incrementalQueryString=String.fromCharCode(e.charCode),(this.viewPortInfo.endIndex>=this.incrementalEndIndex&&this.incrementalEndIndex<=this.totalItemCount||this.incrementalEndIndex===0)&&(i=!0,this.incrementalStartIndex=this.incrementalEndIndex,this.incrementalEndIndex===0?this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100:this.incrementalEndIndex=this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0),(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount);for(var o=rl(e.charCode,this.incrementalLiCollections,this.activeIndex,!0,this.element.id,r,a,!0);m(o)&&this.incrementalEndIndex<this.totalItemCount&&(this.updateIncrementalItemIndex(this.incrementalEndIndex,this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100),this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0,(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount),o=rl(e.charCode,this.incrementalLiCollections,0,!0,this.element.id,r,a,!0,!0),!!m(o));)if(m(o)&&this.incrementalEndIndex>=this.totalItemCount){this.updateIncrementalItemIndex(0,100>this.totalItemCount?this.totalItemCount:100);break}m(o)&&this.incrementalEndIndex>=this.totalItemCount&&(this.updateIncrementalItemIndex(0,100>this.totalItemCount?this.totalItemCount:100),this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0,(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount),o=rl(e.charCode,this.incrementalLiCollections,0,!0,this.element.id,r,a,!0,!0));var l=o&&this.getIndexByValue(o.getAttribute("data-value"));if(l)l=l-this.skeletonCount;else for(var h=0;h<this.incrementalLiCollections.length;h++)if(!m(o)&&!m(o.getAttribute("data-value"))&&this.incrementalLiCollections[h].getAttribute("data-value")===o.getAttribute("data-value").toString()){l=h,l=this.incrementalStartIndex+l;break}if(l&&(!(this.viewPortInfo.startIndex>=l)||!(l>=this.viewPortInfo.endIndex))){var u=l-(this.itemCount/2-2)>0?l-(this.itemCount/2-2):0,c=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(u,c)}if(m(o))this.updateIncrementalView(0,this.itemCount),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.list.scrollTop=0;else{var f=this.getIndexByValue(o.getAttribute("data-value"))-this.skeletonCount;if(f>this.itemCount/2){var u=this.viewPortInfo.startIndex+(this.itemCount/2-2)<this.totalItemCount?this.viewPortInfo.startIndex+(this.itemCount/2-2):this.totalItemCount,c=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(u,c)}if(o=this.getElementByValue(o.getAttribute("data-value")),this.setSelection(o,e),this.setScrollPosition(),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.enableVirtualization&&!this.fields.groupBy){var d=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop;this.list.scrollTop=d-this.list.querySelectorAll(".e-virtual-list").length*this.selectedLI.offsetHeight}this.incrementalPreQueryString=this.incrementalQueryString}}else{var o=void 0;if(this.fields.disabled){var p=this.list.querySelectorAll("."+ne.li+":not(.e-disabled)");o=rl(e.charCode,p,this.activeIndex,!0,this.element.id)}else o=rl(e.charCode,this.liCollections,this.activeIndex,!0,this.element.id);m(o)||(this.setSelection(o,e),this.setScrollPosition())}},t.prototype.hideSpinner=function(){m(this.spinnerElement)||(Jc(this.spinnerElement),Z([this.spinnerElement],tt.disableIcon),this.spinnerElement.innerHTML="",this.spinnerElement=null)},t.prototype.showSpinner=function(){m(this.spinnerElement)&&(this.spinnerElement=xe.isDevice&&!m(this.filterInputObj)&&this.filterInputObj.buttons[1]||!m(this.filterInputObj)&&this.filterInputObj.buttons[0]||this.inputWrapper.buttons[0],P([this.spinnerElement],tt.disableIcon),Kc({target:this.spinnerElement,width:xe.isDevice?"16px":"14px"},this.createElement),Yc(this.spinnerElement))},t.prototype.keyActionHandler=function(e){if(this.enabled){this.keyboardEvent=e,this.isPreventKeyAction&&this.enableVirtualization&&e.preventDefault();var i=e.action==="pageUp"||e.action==="pageDown",r=this.getModuleName()!=="dropdownlist"&&(e.action==="home"||e.action==="end");this.isEscapeKey=e.action==="escape",this.isTabKey=!this.isPopupOpen&&e.action==="tab";var n=e.action==="down"||e.action==="up"||e.action==="pageUp"||e.action==="pageDown"||e.action==="home"||e.action==="end";if(!((this.isEditTextBox()||i||r)&&!this.isPopupOpen)&&!this.readonly){var a=e.action==="tab"||e.action==="close";if(m(this.list)&&!this.isRequested&&!a&&e.action!=="escape"&&(this.searchKeyEvent=e,(!this.enableVirtualization||this.enableVirtualization&&this.getModuleName()!=="autocomplete"&&e.type!=="mousedown"&&(e.keyCode===40||e.keyCode===38))&&(this.renderList(e),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+ne.li),this.ulElement=this.list.querySelector("ul"))),m(this.list)||!m(this.liCollections)&&n&&this.liCollections.length===0||this.isRequested)return;switch((a&&this.getModuleName()!=="autocomplete"&&this.isPopupOpen||e.action==="escape")&&e.preventDefault(),this.isSelected=e.action==="escape"?!1:this.isSelected,this.isTyped=n||e.action==="escape"?!1:this.isTyped,e.action){case"down":case"up":this.updateUpDownAction(e);break;case"pageUp":this.pageUpSelection(this.activeIndex-this.getPageCount(),e),e.preventDefault();break;case"pageDown":this.pageDownSelection(this.activeIndex+this.getPageCount(),e),e.preventDefault();break;case"home":this.isMouseScrollAction=!0,this.updateHomeEndAction(e);break;case"end":this.isMouseScrollAction=!0,this.updateHomeEndAction(e);break;case"space":this.getModuleName()==="dropdownlist"&&(this.beforePopupOpen||(this.showPopup(),e.preventDefault()));break;case"open":this.showPopup(e);break;case"hide":this.preventAltUp=this.isPopupOpen,this.hidePopup(e),this.focusDropDown(e);break;case"enter":this.selectCurrentItem(e);break;case"tab":this.selectCurrentValueOnTab(e);break;case"escape":case"close":this.isPopupOpen&&(this.hidePopup(e),this.focusDropDown(e));break}}}},t.prototype.updateUpDownAction=function(e,i){if(!(this.fields.disabled&&this.list&&this.list.querySelectorAll(".e-list-item:not(.e-disabled)").length===0)){if(this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var r=this.getItemData().value;m(r)&&(r="null");var n=this.getIndexByValue(r);m(n)||(this.activeIndex=n)}var a=this.list.querySelector("."+tt.focus);if(this.isSelectFocusItem(a)&&!i){if(this.setSelection(a,e),this.enableVirtualization){var o=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop;this.fields.groupBy&&(o=this.virtualListInfo&&this.virtualListInfo.startIndex===0?this.selectedLI.offsetHeight-o:o-this.selectedLI.offsetHeight),this.list.scrollTop=o-this.list.querySelectorAll(".e-virtual-list").length*this.selectedLI.offsetHeight}}else if(!m(this.liCollections)){var l=this.activeIndex,h=e.action==="down"?this.activeIndex+1:this.activeIndex-1;h=i?l:h;var u=0;this.getModuleName()==="autocomplete"&&(u=e.action==="down"&&m(this.activeIndex)?0:this.liCollections.length-1,h=h<0?this.liCollections.length-1:h===this.liCollections.length?0:h);var c=void 0;if(this.getModuleName()!=="autocomplete"||this.getModuleName()==="autocomplete"&&this.isPopupOpen)if(!this.enableVirtualization)c=m(this.activeIndex)?this.liCollections[u]:this.liCollections[h];else if(!i)c=m(this.activeIndex)?this.liCollections[this.skeletonCount]:this.liCollections[h],c=!m(c)&&!c.classList.contains("e-virtual-list")?c:null;else if(this.getModuleName()==="autocomplete"){var r=this.getFormattedValue(this.selectedLI.getAttribute("data-value"));c=this.getElementByValue(r)}else c=this.getElementByValue(this.getItemData().value);if(m(c)){if(this.enableVirtualization&&!this.isPopupOpen&&this.getModuleName()!=="autocomplete"&&(this.viewPortInfo.endIndex!==this.totalItemCount&&e.action==="down"||this.viewPortInfo.startIndex!==0&&e.action==="up")){if(e.action==="down"){this.viewPortInfo.startIndex=this.viewPortInfo.startIndex+this.itemCount<this.totalItemCount-this.itemCount?this.viewPortInfo.startIndex+this.itemCount:this.totalItemCount-this.itemCount,this.viewPortInfo.endIndex=this.viewPortInfo.startIndex+this.itemCount,this.updateVirtualItemIndex(),this.isCustomFilter=this.getModuleName()==="combobox"?!0:this.isCustomFilter,this.resetList(this.dataSource,this.fields,this.query),this.isCustomFilter=this.getModuleName()==="combobox"?!1:this.isCustomFilter;var r=this.liCollections[0].getAttribute("data-value")!=="null"?this.getFormattedValue(this.liCollections[0].getAttribute("data-value")):null,d=this.getDataByValue(r);d&&(this.itemData=d)}else if(e.action==="up"){this.viewPortInfo.startIndex=this.viewPortInfo.startIndex-this.itemCount>0?this.viewPortInfo.startIndex-this.itemCount:0,this.viewPortInfo.endIndex=this.viewPortInfo.startIndex+this.itemCount,this.updateVirtualItemIndex(),this.isCustomFilter=this.getModuleName()==="combobox"?!0:this.isCustomFilter,this.resetList(this.dataSource,this.fields,this.query),this.isCustomFilter=this.getModuleName()==="combobox"?!1:this.isCustomFilter;var r=this.liCollections[this.liCollections.length-1].getAttribute("data-value")!=="null"?this.getFormattedValue(this.liCollections[this.liCollections.length-1].getAttribute("data-value")):null,d=this.getDataByValue(r);d&&(this.itemData=d)}this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+ne.li),this.ulElement=this.list.querySelector("ul"),this.handleVirtualKeyboardActions(e,this.pageCount)}}else{var f=this.liCollections[this.skeletonCount]&&this.liCollections[this.skeletonCount].classList.contains("e-item-focus");if(this.setSelection(c,e),f&&this.enableVirtualization&&this.getModuleName()==="autocomplete"&&!i){var o=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop;o=this.virtualListInfo&&this.virtualListInfo.startIndex===0&&this.fields.groupBy?this.selectedLI.offsetHeight-o:o-this.selectedLI.offsetHeight,this.list.scrollTop=o-this.list.querySelectorAll(".e-virtual-list").length*this.selectedLI.offsetHeight}}}if(this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var r=this.getItemData().value,n=this.getIndexByValueFilter(r,this.actionCompleteData.ulElement);m(n)||(this.activeIndex=n)}this.allowFiltering&&this.getModuleName()==="dropdownlist"&&this.filterInput&&(!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-item-focus")[0])?Pe(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-active")[0])&&Pe(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}));for(var p,h=0;h<this.liCollections.length;h++)if(this.liCollections[h].classList.contains(tt.focus)||this.liCollections[h].classList.contains(tt.selected)){p=h;break}p!=null&&this.isDisabledElement(this.liCollections[p])&&(this.getModuleName()!=="autocomplete"&&(this.liCollections.length-1===p&&e.action==="down"&&(e.action="up"),p===0&&e.action==="up"&&(e.action="down")),this.updateUpDownAction(e)),e.preventDefault()}},t.prototype.updateHomeEndAction=function(e,i){if(this.getModuleName()==="dropdownlist"){var r=0;if(e.action==="home"?(r=0,this.enableVirtualization&&this.isPopupOpen?r=this.skeletonCount:this.enableVirtualization&&!this.isPopupOpen&&this.viewPortInfo.startIndex!==0&&(this.viewPortInfo.startIndex=0,this.viewPortInfo.endIndex=this.itemCount,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query))):(this.enableVirtualization&&!this.isPopupOpen&&this.viewPortInfo.endIndex!==this.totalItemCount&&(this.viewPortInfo.startIndex=this.totalItemCount-this.itemCount,this.viewPortInfo.endIndex=this.totalItemCount,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query)),r=this.getItems().length-1),e.preventDefault(),this.activeIndex===r){i&&this.setSelection(this.liCollections[r],e);return}if(!this.enableVirtualization&&this.liCollections[r]&&this.liCollections[r].classList.contains("e-disabled"))return;this.setSelection(this.liCollections[r],e)}},t.prototype.selectCurrentValueOnTab=function(e){this.getModuleName()==="autocomplete"?this.selectCurrentItem(e):this.isPopupOpen&&(this.hidePopup(e),this.focusDropDown(e))},t.prototype.mobileKeyActionHandler=function(e){if(this.enabled&&!(this.isEditTextBox()&&!this.isPopupOpen)&&!this.readonly){if(this.list===void 0&&!this.isRequested&&(this.searchKeyEvent=e,this.renderList()),m(this.list)||!m(this.liCollections)&&this.liCollections.length===0||this.isRequested)return;e.action==="enter"&&this.selectCurrentItem(e)}},t.prototype.handleVirtualKeyboardActions=function(e,i){switch(e.action){case"down":case"up":(this.itemData!=null||this.getModuleName()==="autocomplete")&&this.updateUpDownAction(e,!0);break;case"pageUp":this.activeIndex=this.getModuleName()==="autocomplete"?this.getIndexByValue(this.selectedLI.getAttribute("data-value"))+this.getPageCount()-1:this.getIndexByValue(this.previousValue),this.pageUpSelection(this.activeIndex-this.getPageCount(),e,!0),e.preventDefault();break;case"pageDown":this.activeIndex=this.getModuleName()==="autocomplete"?this.getIndexByValue(this.selectedLI.getAttribute("data-value"))-this.getPageCount():this.getIndexByValue(this.previousValue),this.pageDownSelection(m(this.activeIndex)?2*this.getPageCount():this.activeIndex+this.getPageCount(),e,!0),e.preventDefault();break;case"home":this.isMouseScrollAction=!0,this.updateHomeEndAction(e,!0);break;case"end":this.isMouseScrollAction=!0,this.updateHomeEndAction(e,!0);break}this.keyboardEvent=null},t.prototype.selectCurrentItem=function(e){if(this.isPopupOpen){var i=this.list.querySelector("."+tt.focus);if(this.isDisabledElement(i))return;i&&(this.setSelection(i,e),this.isTyped=!1),this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(e)),this.hidePopup(e),this.focusDropDown(e)}else this.showPopup()},t.prototype.isSelectFocusItem=function(e){return!m(e)},t.prototype.pageUpSelection=function(e,i,r){var n=e>=0?this.liCollections[e+1]:this.liCollections[0];if(!this.enableVirtualization&&n&&n.classList.contains("e-disabled")){for(var a=e>=0?e+1:0;a<this.liCollections.length&&(n=this.liCollections[a],!(n&&!n.classList.contains("e-disabled")));)if(a--,a<0)return}this.enableVirtualization&&this.activeIndex==null&&(n=this.liCollections.length>=e&&e>=0?this.liCollections[e+this.skeletonCount+1]:this.liCollections[0]),!m(n)&&n.classList.contains("e-virtual-list")&&(n=this.liCollections[this.skeletonCount]),this.PageUpDownSelection(n,i),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-item-focus")[0])?Pe(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-active")[0])&&Pe(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},t.prototype.PageUpDownSelection=function(e,i){this.enableVirtualization?!m(e)&&(this.getModuleName()!=="autocomplete"&&!e.classList.contains("e-active")||this.getModuleName()==="autocomplete"&&!e.classList.contains("e-item-focus"))&&this.setSelection(e,i):this.setSelection(e,i)},t.prototype.pageDownSelection=function(e,i,r){var n=this.getItems(),a=e<=n.length?this.liCollections[e-1]:this.liCollections[n.length-1];if(!this.enableVirtualization&&a&&a.classList.contains("e-disabled"))for(;e>=0&&e<this.liCollections.length&&(a=e<=n.length?this.liCollections[e-1]:this.liCollections[n.length-1],!(a&&!a.classList.contains("e-disabled")));)e++;this.enableVirtualization&&this.skeletonCount>0&&(e=this.getModuleName()==="dropdownlist"&&this.allowFiltering?e+1:e,a=e<n.length?this.liCollections[e]:this.liCollections[n.length-1]),this.enableVirtualization&&this.activeIndex==null&&(a=e<=n.length?this.liCollections[e+this.skeletonCount-1]:this.liCollections[n.length-1]),this.PageUpDownSelection(a,i),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-item-focus")[0])?Pe(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-active")[0])&&Pe(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},t.prototype.unWireEvent=function(){m(this.inputWrapper)||(R.remove(this.inputWrapper.container,"mousedown",this.dropDownClick),R.remove(this.inputWrapper.container,"keypress",this.onSearch),R.remove(this.inputWrapper.container,"focus",this.focusIn),R.remove(window,"resize",this.windowResize)),this.unBindCommonEvent()},t.prototype.unWireListEvents=function(){this.list&&(R.remove(this.list,"click",this.onMouseClick),R.remove(this.list,"mouseover",this.onMouseOver),R.remove(this.list,"mouseout",this.onMouseLeave))},t.prototype.checkSelector=function(e){return'[id="'+e.replace(/(:|\.|\[|\]|,|=|@|\\|\/|#)/g,"\\$1")+'"]'},t.prototype.onDocumentClick=function(e){var i=e.target;if(!(!m(this.popupObj)&&X(i,this.checkSelector(this.popupObj.element.id)))&&!m(this.inputWrapper)&&!this.inputWrapper.container.contains(e.target)){if(this.inputWrapper.container.classList.contains(tt.inputFocus)||this.isPopupOpen){this.isDocumentClick=!0;var r=this.isRequested;this.getModuleName()==="combobox"&&this.isTyped&&(this.isInteracted=!1),this.hidePopup(e),this.isInteracted=!1,r||(this.onFocusOut(e),this.inputWrapper.container.classList.remove(tt.inputFocus))}}else i!==this.inputElement&&!(this.allowFiltering&&i===this.filterInput)&&!(this.getModuleName()==="combobox"&&!this.allowFiltering&&xe.isDevice&&i===this.inputWrapper.buttons[0])&&(this.isPreventBlur=(xe.isIE||xe.info.name==="edge")&&(document.activeElement===this.targetElement()||document.activeElement===this.filterInput),e.preventDefault())},t.prototype.activeStateChange=function(){this.isDocumentClick&&(this.hidePopup(),this.onFocusOut(),this.inputWrapper.container.classList.remove(tt.inputFocus))},t.prototype.focusDropDown=function(e){!this.initial&&this.isFilterLayout()&&this.focusIn(e)},t.prototype.dropDownClick=function(e){if(!(e.which===3||e.button===2)&&(this.keyboardEvent=null,!(this.targetElement().classList.contains(tt.disable)||this.inputWrapper.clearButton===e.target))){var i=e.target;if(i!==this.inputElement&&!(this.allowFiltering&&i===this.filterInput)&&this.getModuleName()!=="combobox"&&e.preventDefault(),this.readonly)this.focusIn(e);else{this.isPopupOpen?(this.hidePopup(e),this.isFilterLayout()&&this.focusDropDown(e)):(this.focusIn(e),this.floatLabelChange(),this.queryString=this.inputElement.value.trim()===""?null:this.inputElement.value,this.isDropDownClick=!0,this.showPopup(e));var r=this,n=this.element.tagName===this.getNgDirective()&&this.itemTemplate?500:100;this.isSecondClick||setTimeout(function(){r.cloneElements(),r.isSecondClick=!0,r.isSecondClick=!(r.isReact&&r.isFiltering()&&r.dataSource instanceof fe&&!r.list.querySelector("ul"))},n)}}},t.prototype.cloneElements=function(){if(this.list){var e=this.list.querySelector("ul");e&&(e=e.cloneNode?e.cloneNode(!0):e,this.actionCompleteData.ulElement=e)}},t.prototype.updateSelectedItem=function(e,i,r,n){var a=this;this.removeSelection(),e.classList.add(ne.selected),this.removeHover();var o=e.getAttribute("data-value")!==null?this.getFormattedValue(e.getAttribute("data-value")):null,l=this.getDataByValue(o);if(!this.initial&&!r&&!m(i)){var h=this.detachChanges(l);this.isSelected=!0;var u={e:i,item:e,itemData:h,isInteracted:!!i,cancel:!1};this.trigger("select",u,function(c){c.cancel?e.classList.remove(ne.selected):(a.selectEventCallback(e,i,r,l,o),n&&a.setSelectOptions(e,i))})}else this.selectEventCallback(e,i,r,l,o),n&&this.setSelectOptions(e,i)},t.prototype.selectEventCallback=function(e,i,r,n,a){this.previousItemData=m(this.itemData)?null:this.itemData,this.itemData!==n&&(this.previousValue=m(this.itemData)?null:typeof this.itemData=="object"&&!this.allowObjectBinding?this.checkFieldValue(this.itemData,this.fields.value.split(".")):this.itemData),this.item=e,this.itemData=n;var o=this.list.querySelector("."+ne.focus);if(o&&Z([o],ne.focus),e.setAttribute("aria-selected","true"),m(a)&&(a="null"),this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var l=this.getIndexByValueFilter(a,this.actionCompleteData.ulElement);m(l)?this.activeIndex=this.getIndexByValue(a):this.activeIndex=l}else this.enableVirtualization&&this.activeIndex==null&&this.dataSource instanceof fe&&(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+ne.li),this.ulElement=this.list.querySelector("ul")),this.activeIndex=this.getIndexByValue(a)},t.prototype.activeItem=function(e){this.isValidLI(e)&&!e.classList.contains(ne.selected)&&(this.removeSelection(),e.classList.add(ne.selected),this.removeHover(),e.setAttribute("aria-selected","true"))},t.prototype.setValue=function(e){var i=this.getItemData();this.isTouched=!m(e),i.value===null?Te.setValue(null,this.inputElement,this.floatLabelType,this.showClearButton):Te.setValue(i.text,this.inputElement,this.floatLabelType,this.showClearButton),this.valueTemplate&&this.itemData!==null?this.setValueTemplate():!m(this.valueTempElement)&&this.inputElement.previousSibling===this.valueTempElement&&(Oe(this.valueTempElement),this.inputElement.style.display="block"),!m(i.value)&&!this.enableVirtualization&&this.allowFiltering&&(this.activeIndex=this.getIndexByValueFilter(i.value,this.actionCompleteData.ulElement));var r=tt.clearIcon,n=this.isFiltering()&&this.filterInput&&this.getModuleName()==="combobox",a=n&&this.filterInput.parentElement.querySelector("."+r);return this.isFiltering()&&a&&a.style.removeProperty("visibility"),!this.allowObjectBinding&&this.previousValue===i.value||this.allowObjectBinding&&this.previousValue!=null&&this.isObjectInArray(this.previousValue,[this.allowCustom&&this.isObjectCustomValue?this.value?this.value:i:i.value?this.getDataByValue(i.value):i])?(this.isSelected=!1,!0):(this.isSelected=!this.initial,this.isSelectCustom=!1,this.getModuleName()==="dropdownlist"&&this.updateIconState(),!1)},t.prototype.setSelection=function(e,i){if(this.isValidLI(e)&&(!e.classList.contains(ne.selected)||this.isPopupOpen&&this.isSelected&&e.classList.contains(ne.selected)))this.updateSelectedItem(e,i,!1,!0);else if(this.setSelectOptions(e,i),this.enableVirtualization&&this.value){var r=this.isPrimitiveData?"":this.fields.value,n=this.allowObjectBinding&&!m(this.value)?ie(this.fields.value?this.fields.value:"",this.value):this.value;if(this.dataSource instanceof fe){var a=new fe(this.virtualGroupDataSource).executeLocal(new We().where(new ht(r,"equal",n)));if(a&&a.length>0){this.itemData=a[0];var o=this.getItemData(),l=this.allowObjectBinding?this.getDataByValue(o.value):o.value;(this.value===o.value&&this.text!==o.text||this.value!==o.value&&this.text===o.text)&&this.setProperties({text:o.text?o.text.toString():o.text,value:l})}}else{var a=new fe(this.dataSource).executeLocal(new We().where(new ht(r,"equal",n)));if(a&&a.length>0){this.itemData=a[0];var o=this.getItemData(),l=this.allowObjectBinding?this.getDataByValue(o.value):o.value;(this.value===o.value&&this.text!==o.text||this.value!==o.value&&this.text===o.text)&&(this.setProperties({text:o.text?o.text.toString():o.text,value:l}),m(e)&&(this.previousValue=this.value))}}}},t.prototype.setSelectOptions=function(e,i){this.list&&this.removeHover(),this.previousSelectedLI=m(this.selectedLI)?null:this.selectedLI,this.selectedLI=e,!this.setValue(i)&&((!this.isPopupOpen&&!m(e)||this.isPopupOpen&&!m(i)&&(i.type!=="keydown"||i.type==="keydown"&&i.action==="enter"))&&(this.isSelectCustom=!1,this.onChangeEvent(i)),this.isPopupOpen&&!m(this.selectedLI)&&this.itemData!==null&&(!i||i.type!=="click")&&this.setScrollPosition(i),xe.info.name!=="mozilla"&&this.targetElement()&&(Pe(this.targetElement(),{"aria-describedby":this.inputElement.id!==""?this.inputElement.id:this.element.id}),this.targetElement().removeAttribute("aria-live")),this.isPopupOpen&&!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-item-focus")[0])?Pe(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):this.isPopupOpen&&!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-active")[0])&&Pe(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},t.prototype.dropdownCompiler=function(e){var i=!1;if(typeof e!="function"&&e)try{i=!!document.querySelectorAll(e).length}catch(r){i=!1}return i},t.prototype.setValueTemplate=function(){var e;this.isReact&&(this.clearTemplate(["valueTemplate"]),this.valueTempElement&&(Oe(this.valueTempElement),this.inputElement.style.display="block",this.valueTempElement=null)),this.valueTempElement||(this.valueTempElement=this.createElement("span",{className:tt.value}),this.inputElement.parentElement.insertBefore(this.valueTempElement,this.inputElement),this.inputElement.style.display="none"),this.isReact||(this.valueTempElement.innerHTML="");var i=this.dropdownCompiler(this.valueTemplate);typeof this.valueTemplate!="function"&&i?e=wt(document.querySelector(this.valueTemplate).innerHTML.trim()):e=wt(this.valueTemplate);var r=e(this.itemData,this,"valueTemplate",this.valueTemplateId,this.isStringTemplate,null,this.valueTempElement);r&&r.length>0&&at(r,this.valueTempElement),this.renderReactTemplates()},t.prototype.removeSelection=function(){if(this.list){var e=this.list.querySelectorAll("."+ne.selected);e.length&&(Z(e,ne.selected),e[0].removeAttribute("aria-selected"))}},t.prototype.getItemData=function(){var e=this.fields,i=null;i=this.itemData;var r,n;m(i)||(r=ie(e.value,i),n=ie(e.text,i));var a=!m(i)&&!Cn(r)?r:i,o=!m(i)&&!Cn(r)?n:i;return{value:a,text:o}},t.prototype.onChangeEvent=function(e,i){var r=this,n=this.getItemData(),a=this.isSelectCustom?null:this.activeIndex;if(this.enableVirtualization){var o=this.dataSource instanceof fe?this.virtualGroupDataSource:this.dataSource;if(n.value&&o&&o.length>0){var l=o.findIndex(function(u){return!m(n.value)&&ie(r.fields.value,u)===n.value});l!==-1&&(a=l)}}var h=this.allowObjectBinding?i?this.value:this.getDataByValue(n.value):n.value;this.setProperties({index:a,text:n.text?n.text.toString():n.text,value:h},!0),this.detachChangeEvent(e)},t.prototype.detachChanges=function(e){var i;return typeof e=="string"||typeof e=="boolean"||typeof e=="number"?i=Object.defineProperties({},{value:{value:e,enumerable:!0},text:{value:e,enumerable:!0}}):i=e,i},t.prototype.detachChangeEvent=function(e){if(this.isSelected=!1,this.previousValue=this.value,this.activeIndex=this.enableVirtualization?this.getIndexByValue(this.value):this.index,this.typedString=m(this.text)?"":this.text,!this.initial){var i=this.detachChanges(this.itemData),r=void 0;typeof this.previousItemData=="string"||typeof this.previousItemData=="boolean"||typeof this.previousItemData=="number"?r=Object.defineProperties({},{value:{value:this.previousItemData,enumerable:!0},text:{value:this.previousItemData,enumerable:!0}}):r=this.previousItemData,this.setHiddenValue();var n={e,item:this.item,itemData:i,previousItem:this.previousSelectedLI,previousItemData:r,isInteracted:!!e,value:this.value,element:this.element,event:e};this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",n)}(m(this.value)||this.value==="")&&this.floatLabelType!=="Always"&&Z([this.inputWrapper.container],"e-valid-input")},t.prototype.setHiddenValue=function(){if(m(this.value))this.hiddenElement.innerHTML="";else{var e=this.allowObjectBinding&&!m(this.value)?ie(this.fields.value?this.fields.value:"",this.value):this.value;if(this.hiddenElement.querySelector("option")){var i=this.hiddenElement.querySelector("option");i.textContent=this.text,i.setAttribute("value",e.toString())}else if(!m(this.hiddenElement)){var r=document.createElement("option");r.text=this.text,r.setAttribute("selected",""),this.hiddenElement.appendChild(r);var i=this.hiddenElement.querySelector("option");i.setAttribute("value",e.toString())}}},t.prototype.onFilterUp=function(e){if(!(e.ctrlKey&&e.keyCode===86)&&(this.isValidKey||e.keyCode===40||e.keyCode===38))switch(this.isValidKey=!1,this.filterArgs=e,this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null,e.keyCode){case 38:case 40:this.getModuleName()==="autocomplete"&&!this.isPopupOpen&&!this.preventAltUp&&!this.isRequested?(this.preventAutoFill=!0,this.searchLists(e)):this.preventAutoFill=!1,this.preventAltUp=!1,this.getModuleName()==="autocomplete"&&!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-item-focus")[0])&&Pe(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}),e.preventDefault();break;case 46:case 8:this.typedString=this.filterInput.value,!this.isPopupOpen&&this.typedString!==""||this.isPopupOpen&&this.queryString.length>0?(this.preventAutoFill=!0,this.searchLists(e)):this.typedString===""&&this.queryString===""&&this.getModuleName()!=="autocomplete"?(this.preventAutoFill=!0,this.searchLists(e)):this.typedString===""&&(this.list&&this.resetFocusElement(),this.activeIndex=null,this.getModuleName()!=="dropdownlist"&&(this.preventAutoFill=!0,this.searchLists(e),this.getModuleName()==="autocomplete"&&this.hidePopup())),e.preventDefault();break;default:this.isFiltering()&&this.getModuleName()==="combobox"&&m(this.list)&&(this.getInitialData=!0,this.renderList(),!this.isSecondClick&&!this.isDropDownClick&&this.executeCloneElements()),this.typedString=this.filterInput.value,this.preventAutoFill=!1,this.getInitialData||this.searchLists(e),(this.enableVirtualization&&this.getModuleName()!=="autocomplete"||this.getModuleName()==="autocomplete"&&!(this.dataSource instanceof fe)||this.getModuleName()==="autocomplete"&&this.dataSource instanceof fe&&this.totalItemCount!==0)&&this.getFilteringSkeletonCount();break}else this.isValidKey=!1},t.prototype.onFilterDown=function(e){switch(e.keyCode){case 13:break;case 40:case 38:this.queryString=this.filterInput.value,e.preventDefault();break;case 9:this.isPopupOpen&&this.getModuleName()!=="autocomplete"&&e.preventDefault();break;default:this.prevSelectPoints=this.getSelectionPoints(),this.queryString=this.filterInput.value;break}},t.prototype.removeFillSelection=function(){if(this.isInteracted){var e=this.getSelectionPoints();this.inputElement.setSelectionRange(e.end,e.end)}},t.prototype.getQuery=function(e){var i;if(!this.isCustomFilter&&this.allowFiltering&&this.filterInput){i=e?e.clone():this.query?this.query.clone():new We;var r=this.typedString===""?"contains":this.filterType,n=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof fe)&&n==="string"||n==="number")i.where("",r,this.typedString,this.ignoreCase,this.ignoreAccent);else if(this.getModuleName()!=="combobox"||this.isFiltering()&&this.getModuleName()==="combobox"&&this.typedString!==""){var a=this.fields.text?this.fields.text:"";i.where(a,r,this.typedString,this.ignoreCase,this.ignoreAccent)}}else i=this.enableVirtualization&&!m(this.customFilterQuery)?this.customFilterQuery.clone():e?e.clone():this.query?this.query.clone():new We;if(this.enableVirtualization&&this.viewPortInfo.endIndex!==0){var o=this.getTakeValue(),l=!1;if(i){for(var h=0;h<i.queries.length;h++)if(i.queries[h].fn==="onSkip"){l=!0;break}}var u=0,c=0;if(i&&i.queries.length>0)for(var h=0;h<i.queries.length;h++)i.queries[h].fn==="onSkip"&&(c=i.queries[h].e.nos),i.queries[h].fn==="onTake"&&(u=o<=i.queries[h].e.nos?i.queries[h].e.nos:o);if(u<=0&&this.query&&this.query.queries.length>0)for(var h=0;h<this.query.queries.length;h++)this.query.queries[h].fn==="onTake"&&(u=o<=this.query.queries[h].e.nos?this.query.queries[h].e.nos:o);var f=!1;if(i&&i.queries.length>0)for(var h=0;h<i.queries.length;h++){if(i.queries[h].fn==="onSkip"){c=i.queries[h].e.nos,i.queries.splice(h,1),l=!1,--h;continue}i.queries[h].fn==="onTake"&&(u=i.queries[h].e.nos<=u?u:i.queries[h].e.nos,i.queries.splice(h,1),--h)}!f&&(this.allowFiltering||!this.isPopupOpen||!l)&&(c>0?i.skip(c):i.skip(this.virtualItemStartIndex)),this.isIncrementalRequest?i.take(this.incrementalEndIndex):u>0?i.take(u):i.take(o),i.requiresCount()}return i},t.prototype.getSelectionPoints=function(){var e=this.inputElement;return{start:Math.abs(e.selectionStart),end:Math.abs(e.selectionEnd)}},t.prototype.searchLists=function(e){var i=this;if(this.isTyped=!0,this.activeIndex=null,this.isListSearched=!0,this.filterInput.parentElement.querySelector("."+tt.clearIcon)){var r=this.filterInput.parentElement.querySelector("."+tt.clearIcon);r.style.visibility=this.filterInput.value===""?"hidden":"visible"}if(this.isDataFetched=!1,this.isFiltering()){this.checkAndResetCache(),this.isRequesting=!1;var n={preventDefaultAction:!1,text:this.filterInput.value,updateData:function(a,o,l){n.cancel||(i.isCustomFilter=!0,i.customFilterQuery=o&&o.clone(),i.filteringAction(a,o,l))},baseEventArgs:e,cancel:!1};this.trigger("filtering",n,function(a){!a.cancel&&!i.isCustomFilter&&!a.preventDefaultAction&&i.filteringAction(i.dataSource,null,i.fields)})}},t.prototype.filter=function(e,i,r){this.isCustomFilter=!0,this.filteringAction(e,i,r)},t.prototype.filteringAction=function(e,i,r){if(!m(this.filterInput)){this.beforePopupOpen=!(!this.isPopupOpen&&this.getModuleName()==="combobox"&&this.filterInput.value===""||this.getInitialData);var n=this.list.classList.contains(ne.noData);if(this.filterInput.value.trim()===""&&!this.itemTemplate){if(this.actionCompleteData.isUpdated=!1,this.isTyped=!1,!m(this.actionCompleteData.ulElement)&&!m(this.actionCompleteData.list)){if(this.enableVirtualization&&(this.isFiltering()&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.resetList(e,r,i),n&&!this.list.classList.contains(ne.noData))){if(!this.list.querySelector(".e-virtual-ddl-content")){var a=this.createElement("div",{className:"e-virtual-ddl-content"});a.style.cssText=this.getTransformValues(),this.list.appendChild(a).appendChild(this.list.querySelector(".e-list-parent"))}if(!this.list.querySelector(".e-virtual-ddl")){var o=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});o.style.cssText=this.GetVirtualTrackHeight(),this.list.parentElement.querySelector(".e-dropdownbase").appendChild(o)}}this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list)}this.isTyped=!0,!m(this.itemData)&&this.getModuleName()==="dropdownlist"&&(this.focusIndexItem(),this.setScrollPosition()),this.isNotSearchList=!0}else if(this.isNotSearchList=!1,i=this.filterInput.value.trim()===""?null:i,this.enableVirtualization&&this.isFiltering()&&this.isTyped&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.resetList(e,r,i),this.getModuleName()==="dropdownlist"&&this.list.classList.contains(ne.noData)&&(this.popupContentElement.setAttribute("role","status"),this.popupContentElement.setAttribute("id","no-record"),Pe(this.filterInputObj.container,{"aria-activedescendant":"no-record"})),this.enableVirtualization&&n&&!this.list.classList.contains(ne.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")){var a=this.createElement("div",{className:"e-virtual-ddl-content"});a.style.cssText=this.getTransformValues(),this.list.appendChild(a).appendChild(this.list.querySelector(".e-list-parent"))}if(!this.list.querySelector(".e-virtual-ddl")){var o=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});o.style.cssText=this.GetVirtualTrackHeight(),this.list.parentElement.querySelector(".e-dropdownbase").appendChild(o)}}this.enableVirtualization&&this.getFilteringSkeletonCount(),this.renderReactTemplates(),this.filterInput&&this.filterInput.value===""&&this.getModuleName()==="combobox"&&this.executeCloneElements()}},t.prototype.setSearchBox=function(e){if(this.isFiltering()){var i=e.querySelector("."+tt.filterParent)?e.querySelector("."+tt.filterParent):this.createElement("span",{className:tt.filterParent});this.filterInput=this.createElement("input",{attrs:{type:"text"},className:tt.filterInput}),this.element.parentNode.insertBefore(this.filterInput,this.element);var r=!1;return xe.isDevice&&this.isDeviceFullScreen&&(r=!0),this.filterInputObj=Te.createInput({element:this.filterInput,buttons:r?[tt.backIcon,tt.filterBarClearIcon]:[tt.filterBarClearIcon],properties:{placeholder:this.filterBarPlaceholder}},this.createElement),m(this.cssClass)||(this.cssClass.split(" ").indexOf("e-outline")!==-1?P([this.filterInputObj.container],"e-outline"):this.cssClass.split(" ").indexOf("e-filled")!==-1&&P([this.filterInputObj.container],"e-filled")),at([this.filterInputObj.container],i),Ii([i],e),Pe(this.filterInput,{"aria-disabled":"false",role:"combobox",autocomplete:"off",autocapitalize:"off",spellcheck:"false"}),this.clearIconElement=this.filterInput.parentElement.querySelector("."+tt.clearIcon),!xe.isDevice&&this.clearIconElement&&(R.add(this.clearIconElement,"click",this.clearText,this),this.clearIconElement.style.visibility="hidden"),xe.isDevice?this.searchKeyModule=new gr(this.filterInput,{keyAction:this.mobileKeyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}):this.searchKeyModule=new gr(this.filterInput,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),R.add(this.filterInput,"input",this.onInput,this),R.add(this.filterInput,"keyup",this.onFilterUp,this),R.add(this.filterInput,"keydown",this.onFilterDown,this),R.add(this.filterInput,"blur",this.onBlurHandler,this),R.add(this.filterInput,"paste",this.pasteHandler,this),this.filterInputObj}else return hH},t.prototype.onInput=function(e){!m(e)&&!m(e.data)&&e.data.length>1&&this.autoFill&&(this.getModuleName()==="combobox"||this.getModuleName()==="autocomplete")&&(this.inputElement.value=e.data),this.isValidKey=!0,this.getModuleName()==="combobox"&&this.updateIconState(),xe.isDevice&&xe.info.name==="mozilla"&&(this.typedString=this.filterInput.value,this.preventAutoFill=!0,this.searchLists(e))},t.prototype.pasteHandler=function(e){var i=this;setTimeout(function(){i.typedString=i.filterInput.value,i.getModuleName()==="combobox"&&i.isFiltering()&&m(i.list)&&i.renderList(),i.searchLists(e)})},t.prototype.onActionFailure=function(e){s.prototype.onActionFailure.call(this,e),this.beforePopupOpen&&this.renderPopup()},t.prototype.getTakeValue=function(){return this.allowFiltering&&this.getModuleName()==="dropdownlist"&&xe.isDevice?Math.round(window.outerHeight/this.listItemHeight):this.itemCount},t.prototype.onActionComplete=function(e,i,r,n){var a=this;if(this.dataSource instanceof fe&&!m(r)&&!this.virtualGroupDataSource&&(this.totalItemCount=r.count),this.isNotSearchList&&!this.enableVirtualization){this.isNotSearchList=!1;return}if(this.getInitialData){this.updateActionCompleteDataValues(e,i),this.getInitialData=!1,this.isReactTemplateUpdate=!0,this.searchLists(this.filterArgs);return}var o=this.itemCount;if(this.isActive||!m(e)){var l=this.selectedLI?this.selectedLI.cloneNode(!0):null;if(s.prototype.onActionComplete.call(this,e,i,r),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof fe)||this.dataSource instanceof fe&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.updateSelectElementData(this.allowFiltering),this.isRequested&&!m(this.searchKeyEvent)&&this.searchKeyEvent.type==="keydown"&&(this.isRequested=!1,this.keyActionHandler(this.searchKeyEvent),this.searchKeyEvent=null),this.isRequested&&!m(this.searchKeyEvent)&&(this.incrementalSearch(this.searchKeyEvent),this.searchKeyEvent=null),this.enableVirtualization||(this.list.scrollTop=0),m(e)||Pe(e,{id:this.element.id+"_options",role:"listbox","aria-hidden":"false","aria-label":"listbox"}),this.initialRemoteRender){if(this.initial=!0,this.activeIndex=this.index,this.initialRemoteRender=!1,this.value&&this.dataSource instanceof fe){var h=m(this.fields.value)?this.fields.text:this.fields.value,u=this.allowObjectBinding&&!m(this.value)?ie(h,this.value):this.value,c=this.fields.value.split("."),f=i.some(function(b){return m(b[h])&&c.length>1?a.checkFieldValue(b,c)===u:b[h]===u});this.enableVirtualization&&this.virtualGroupDataSource&&(f=this.virtualGroupDataSource.some(function(b){return m(b[h])&&c.length>1?a.checkFieldValue(b,c)===u:b[h]===u})),f?this.updateValues():this.dataSource.executeQuery(this.getQuery(this.query).where(new ht(h,"equal",u))).then(function(b){b.result.length>0&&a.addItem(b.result,i.length),a.updateValues()})}else this.updateValues();this.initial=!1}else this.getModuleName()==="autocomplete"&&this.value&&this.setInputValue();if(this.getModuleName()!=="autocomplete"&&this.isFiltering()&&!this.isTyped){if((!this.actionCompleteData.isUpdated||!this.isCustomFilter&&!this.isFilterFocus||m(this.itemData)&&this.allowFiltering&&(this.dataSource instanceof fe||!m(this.dataSource)&&!m(this.dataSource.length)&&this.dataSource.length!==0))&&(this.itemTemplate&&(this.element.tagName==="EJS-COMBOBOX"||this.isReact)&&this.allowFiltering?setTimeout(function(){a.updateActionCompleteDataValues(e,i)},0):this.updateActionCompleteDataValues(e,i)),this.isDynamicData){var d=this.allowObjectBinding&&!m(this.value)?ie(this.fields.value?this.fields.value:"",this.value):this.value;this.itemData=this.getDataByValue(d),this.selectedLI=this.getElementByValue(d),this.isDynamicData=!1}if((this.allowCustom||this.allowFiltering&&!this.isValueInList(i,this.value)&&this.dataSource instanceof fe)&&!this.enableVirtualization)this.addNewItem(i,l);else if((this.allowCustom||this.allowFiltering&&this.isValueInList(i,this.value))&&!this.enableVirtualization){var p=this.allowObjectBinding&&!m(this.value)?ie(this.fields.value?this.fields.value:"",this.value):this.value,v=!m(this.value)&&l&&l.getAttribute("data-value")===p.toString();v&&this.addNewItem(i,l)}(!m(this.itemData)||m(this.itemData)&&this.enableVirtualization)&&(this.getSkeletonCount(),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof fe)||this.dataSource instanceof fe&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.UpdateSkeleton(),this.focusIndexItem()),this.enableVirtualization&&this.updateActionCompleteDataValues(e,i)}else if(this.enableVirtualization&&this.getModuleName()!=="autocomplete"&&!this.isFiltering()){var p=this.getItemData().value;this.activeIndex=this.getIndexByValue(p);var g=this.findListElement(this.list,"li","data-value",p);this.selectedLI=g}else this.enableVirtualization&&this.getModuleName()==="autocomplete"&&(this.activeIndex=this.skeletonCount);this.beforePopupOpen&&(this.renderPopup(r),this.enableVirtualization&&(this.list.querySelector(".e-virtual-list")||(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"))),this.enableVirtualization&&o!==this.itemCount&&this.resetList(this.dataSource,this.fields))}},t.prototype.isValueInList=function(e,i){if(Array.isArray(e)){for(var r=0;r<e.length;r++)if(e[r]===i)return!0}else if(typeof e=="object"&&e!==null){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&e[n]===i)return!0}return!1},t.prototype.checkFieldValue=function(e,i){var r=e;return i.forEach(function(n){r=r[n]}),r},t.prototype.updateActionCompleteDataValues=function(e,i){this.actionCompleteData={ulElement:e.cloneNode(!0),list:i,isUpdated:!0},this.actionData.list!==this.actionCompleteData.list&&this.actionCompleteData.ulElement&&this.actionCompleteData.list&&(this.actionData=this.actionCompleteData)},t.prototype.addNewItem=function(e,i){var r=this;if(!m(this.itemData)&&!m(i)){var n=this.getItemData().value,a=e.some(function(o){return(typeof o=="string"||typeof o=="number"||typeof o=="boolean")&&o===n||ie(r.fields.value,o)===n});a||this.addItem(this.itemData)}},t.prototype.updateActionCompleteData=function(e,i,r){var n=this;this.getModuleName()!=="autocomplete"&&this.actionCompleteData.ulElement&&(this.itemTemplate&&this.element.tagName==="EJS-COMBOBOX"&&this.allowFiltering?setTimeout(function(){n.actionCompleteDataUpdate(e,i,r)},0):this.actionCompleteDataUpdate(e,i,r))},t.prototype.actionCompleteDataUpdate=function(e,i,r){r!==null?this.actionCompleteData.ulElement.insertBefore(e.cloneNode(!0),this.actionCompleteData.ulElement.childNodes[r]):this.actionCompleteData.ulElement.appendChild(e.cloneNode(!0)),this.isFiltering()&&this.actionCompleteData.list&&this.actionCompleteData.list.indexOf(i)<0&&this.actionCompleteData.list.push(i)},t.prototype.focusIndexItem=function(){var e=this.getItemData().value;this.activeIndex=this.enableVirtualization&&!m(e)||!this.enableVirtualization?this.getIndexByValue(e):this.activeIndex;var i=this.findListElement(this.list,"li","data-value",e);this.selectedLI=i,this.activeItem(i),this.enableVirtualization&&m(i)||this.removeFocus()},t.prototype.updateSelection=function(){var e=this.list.querySelector("."+ne.selected);e?(this.setProperties({index:this.getIndexByValue(e.getAttribute("data-value"))}),this.activeIndex=this.index):(this.removeFocus(),this.list.querySelector("."+ne.li).classList.add(tt.focus))},t.prototype.updateSelectionList=function(){var e=this.list&&this.list.querySelector(".e-active");if(!e&&!m(this.value)&&this.getModuleName()!=="autocomplete"){var i=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value):this.value,r=this.findListElement(this.list,"li","data-value",i);r&&r.classList.add("e-active")}},t.prototype.removeFocus=function(){var e=this.list.querySelectorAll("."+tt.focus);e&&e.length&&Z(e,tt.focus)},t.prototype.renderPopup=function(e){var i=this;if(this.popupObj&&document.body.contains(this.popupObj.element)){this.refreshPopup();return}var r={cancel:!1};this.trigger("beforeOpen",r,function(n){var a;if(n.cancel)i.beforePopupOpen=!1;else{var o=i.createElement("div",{id:i.element.id+"_popup",className:"e-ddl e-popup "+(i.cssClass!==null?i.cssClass:"")});o.setAttribute("aria-label",i.element.id),o.setAttribute("role","dialog");var l=i.setSearchBox(o);if(i.listContainerHeight=i.allowFiltering&&i.getModuleName()==="dropdownlist"&&xe.isDevice?st(Math.round(window.outerHeight).toString()+"px"):st(i.popupHeight),i.headerTemplate&&(i.setHeaderTemplate(o),i.isUpdateHeaderHeight=i.header.offsetHeight!==0),at([i.list],o),i.footerTemplate&&(i.setFooterTemplate(o),i.isUpdateFooterHeight=i.footer.offsetHeight!==0),document.body.appendChild(o),o.style.top="0px",a=o.clientHeight,i.enableVirtualization&&i.itemTemplate){var h=o.querySelectorAll("li.e-list-item:not(.e-virtual-list)");i.listItemHeight=h.length>0?Math.ceil(h[0].getBoundingClientRect().height)+parseInt(window.getComputedStyle(h[0]).marginBottom,10):0}if(i.enableVirtualization&&!i.list.classList.contains(ne.noData)){if(i.getSkeletonCount(),i.skeletonCount=i.totalItemCount<i.itemCount*2&&(!(i.dataSource instanceof fe)||i.dataSource instanceof fe&&i.totalItemCount<=i.itemCount)?0:i.skeletonCount,i.list.querySelector(".e-virtual-ddl-content"))i.list.getElementsByClassName("e-virtual-ddl-content")[0].style=i.getTransformValues();else{var u=i.createElement("div",{className:"e-virtual-ddl-content"});u.style.cssText=i.getTransformValues(),i.list.appendChild(u).appendChild(i.list.querySelector(".e-list-parent"))}if(i.UpdateSkeleton(),i.liCollections=i.list.querySelectorAll("."+ne.li),i.virtualItemCount=i.itemCount,i.list.querySelector(".e-virtual-ddl"))i.list.getElementsByClassName("e-virtual-ddl")[0].style=i.GetVirtualTrackHeight();else{var c=i.createElement("div",{id:i.element.id+"_popup",className:"e-virtual-ddl"});c.style.cssText=i.GetVirtualTrackHeight(),o.querySelector(".e-dropdownbase").appendChild(c)}}if(o.style.visibility="hidden",i.popupHeight!=="auto"){if(i.searchBoxHeight=0,!m(l.container)&&i.getModuleName()!=="combobox"&&i.getModuleName()!=="autocomplete"&&(i.searchBoxHeight=l.container.parentElement.getBoundingClientRect().height,i.listContainerHeight=(parseInt(i.listContainerHeight,10)-i.searchBoxHeight).toString()+"px"),i.headerTemplate){i.header=i.header?i.header:o.querySelector(".e-ddl-header");var f=Math.round(i.header.getBoundingClientRect().height);i.listContainerHeight=(parseInt(i.listContainerHeight,10)-(f+i.searchBoxHeight)).toString()+"px"}if(i.footerTemplate){i.footer=i.footer?i.footer:o.querySelector(".e-ddl-footer");var f=Math.round(i.footer.getBoundingClientRect().height);i.listContainerHeight=(parseInt(i.listContainerHeight,10)-(f+i.searchBoxHeight)).toString()+"px"}i.list.style.maxHeight=(parseInt(i.listContainerHeight,10)-2).toString()+"px",o.style.maxHeight=st(i.popupHeight)}else o.style.height="auto";var d=0,p=void 0;if(i.isPreventScrollAction=!0,!m(i.selectedLI)&&!m(i.activeIndex)&&i.activeIndex>=0||i.enableVirtualization?i.setScrollPosition():i.list.scrollTop=0,xe.isDevice&&i.isDeviceFullScreen&&!i.allowFiltering&&(i.getModuleName()==="dropdownlist"||i.isDropDownClick&&i.getModuleName()==="combobox")){d=i.getOffsetValue(o);var v=i.isEmptyList()?i.list:i.liCollections[0];m(i.inputElement)||(p=-(parseInt(getComputedStyle(v).textIndent,10)-parseInt(getComputedStyle(i.inputElement).paddingLeft,10)+parseInt(getComputedStyle(i.inputElement.parentElement).borderLeftWidth,10)))}i.createPopup(o,d,p),i.popupContentElement=i.popupObj.element.querySelector(".e-content"),i.getFocusElement(),i.checkCollision(o),xe.isDevice&&(parseInt(i.popupWidth.toString(),10)>window.outerWidth&&!(i.getModuleName()==="dropdownlist"&&i.allowFiltering)&&i.popupObj.element.classList.add("e-wide-popup"),i.popupObj.element.classList.add(tt.device),(i.getModuleName()==="dropdownlist"||i.getModuleName()==="combobox"&&!i.allowFiltering&&i.isDropDownClick)&&(i.popupObj.collision={X:"fit",Y:"fit"}),i.isFilterLayout()&&i.isDeviceFullScreen&&(i.popupObj.element.classList.add(tt.mobileFilter),i.popupObj.position={X:0,Y:0},i.popupObj.dataBind(),Pe(i.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),P([document.body,i.popupObj.element],tt.popupFullScreen),i.setSearchBoxPosition(),i.backIconElement=l.container.querySelector(".e-back-icon"),i.clearIconElement=l.container.querySelector("."+tt.clearIcon),R.add(i.backIconElement,"click",i.clickOnBackIcon,i),R.add(i.clearIconElement,"click",i.clearText,i))),o.style.visibility="visible",P([o],"e-popup-close");for(var g=i.popupObj.getScrollableParent(i.inputWrapper.container),b=0,C=g;b<C.length;b++){var y=C[b];R.add(y,"scroll",i.scrollHandler,i)}m(i.list)||(i.unWireListEvents(),i.wireListEvents()),i.selectedElementID=i.selectedLI?i.selectedLI.id:null,i.enableVirtualization&&(i.notify("bindScrollEvent",{module:"VirtualScroll",component:i.getModuleName(),enable:i.enableVirtualization}),setTimeout(function(){(i.value||i.list.querySelector(".e-active"))&&(i.updateSelectionList(),i.selectedValueInfo&&i.viewPortInfo&&i.viewPortInfo.offsets.top?i.list.scrollTop=i.viewPortInfo.offsets.top:i.scrollBottom(!0,!0))},5)),Pe(i.targetElement(),{"aria-expanded":"true","aria-owns":i.element.id+"_popup","aria-controls":i.element.id}),i.getModuleName()!=="dropdownlist"&&i.list.classList.contains("e-nodata")&&(Pe(i.targetElement(),{"aria-activedescendant":"no-record"}),i.popupContentElement.setAttribute("role","status"),i.popupContentElement.setAttribute("id","no-record")),i.inputElement.setAttribute("aria-expanded","true"),i.inputElement.setAttribute("aria-controls",i.element.id+"_popup");var x=i.isFiltering()?i.filterInput.parentElement:i.inputWrapper.container;P([x],[tt.inputFocus]);var w={name:"FadeIn",duration:100};i.beforePopupOpen=!0;var S=i.popupObj,E={popup:S,event:e,cancel:!1,animation:w};if(i.trigger("open",E,function(A){A.cancel?(i.beforePopupOpen=!1,i.destroyPopup()):(m(i.inputWrapper)||P([i.inputWrapper.container],[tt.iconAnimation]),i.renderReactTemplates(),i.isReact&&i.isFiltering()&&i.dataSource instanceof fe&&i.list.querySelector("ul")&&!i.isSecondClick&&i.executeCloneElements(),m(i.popupObj)||i.popupObj.show(new vr(A.animation),i.zIndex===1e3?i.element:null),i.isReact&&setTimeout(function(){if(i.popupHeight&&i.list&&i.popupHeight!=="auto"&&!(i.getModuleName()==="dropdownlist"&&i.allowFiltering)){var z=typeof i.popupHeight=="string"?parseInt(i.popupHeight,10):i.popupHeight;if(!i.isUpdateHeaderHeight&&i.headerTemplate&&i.header){var D=i.list.style.maxHeight===""?z:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(D-i.header.offsetHeight).toString()+"px",i.isUpdateHeaderHeight=!0}if(!i.isUpdateFooterHeight&&i.footerTemplate&&i.footer){var D=i.list.style.maxHeight===""?z:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(D-i.footer.offsetHeight).toString()+"px",i.isUpdateFooterHeight=!0}}},15))}),i.allowResize&&(i.getModuleName()!=="dropdownlist"||!(xe.isDevice&&i.isDeviceFullScreen&&i.allowFiltering))){var k=16;i.resizer=i.createElement("div",{id:i.element.id+"_resize-popup",className:tt.resizeIcon}),i.list&&i.list.parentElement&&(i.list.parentElement.classList.add("e-resize"),i.popupHeight.toString().toLowerCase()!=="auto"&&a>=parseInt(i.popupHeight.toString(),10)-2&&(i.list.parentElement.style.height="100%"),i.list.parentElement.style.paddingBottom=i.getModuleName()==="dropdownlist"&&i.allowFiltering&&i.searchBoxHeight?(i.searchBoxHeight+k).toString()+"px":k.toString()+"px",(i.header||i.footer||i.itemTemplate)&&(i.list.parentElement.style.paddingBottom=(parseInt(i.list.parentElement.style.maxHeight,10)-parseInt(i.list.style.maxHeight,10)+k).toString()+"px"),i.list.parentElement.appendChild(i.resizer),i.list.parentElement.style.width=i.resizeWidth+"px",i.list.parentElement.style.height=i.resizeHeight+"px",i.list.parentElement.style.maxHeight=i.resizeHeight+"px",i.list.style.maxHeight=i.resizeHeight+"px"),R.add(i.resizer,"mousedown",i.startResizing,i),R.add(i.resizer,"touchstart",i.startResizing,i)}}})},t.prototype.checkCollision=function(e){if(!xe.isDevice||xe.isDevice&&!(this.getModuleName()==="dropdownlist"||this.isDropDownClick)){var i=Gc(e);i.length>0&&(e.style.marginTop=-parseInt(getComputedStyle(e).marginTop,10)+"px"),this.popupObj.resolveCollision()}},t.prototype.getOffsetValue=function(e){var i=getComputedStyle(e),r=parseInt(i.borderTopWidth,10),n=parseInt(i.borderBottomWidth,10);return this.setPopupPosition(r+n)},t.prototype.createPopup=function(e,i,r){var n=this;this.popupObj=new Bo(e,{width:this.setWidth(),targetType:"relative",relateTo:this.inputWrapper.container,collision:this.enableRtl?{X:"fit",Y:"flip"}:{X:"flip",Y:"flip"},offsetY:i,enableRtl:this.enableRtl,offsetX:r,position:this.enableRtl?{X:"right",Y:"bottom"}:{X:"left",Y:"bottom"},zIndex:this.zIndex,close:function(){n.isDocumentClick||n.focusDropDown(),n.isReact&&n.clearTemplate(["headerTemplate","footerTemplate"]),n.isNotSearchList=!1,n.isDocumentClick=!1,n.destroyPopup(),n.isFiltering()&&n.actionCompleteData.list&&n.actionCompleteData.list.length>0?(n.isActive=!0,n.isReactTemplateUpdate&&n.isReact&&n.itemTemplate&&!n.enableVirtualization&&(n.actionCompleteData.ulElement=n.renderItems(n.actionCompleteData.list,n.fields),n.isReactTemplateUpdate=!1),n.enableVirtualization?n.onActionComplete(n.ulElement,n.listData,null,!0):n.onActionComplete(n.actionCompleteData.ulElement,n.actionCompleteData.list,null,!0)):n.enableVirtualization&&n.focusIndexItem()},open:function(){R.add(document,"mousedown",n.onDocumentClick,n),n.isPopupOpen=!0;var a=n.actionCompleteData&&n.actionCompleteData.ulElement&&n.actionCompleteData.ulElement.querySelector("li"),o=n.list.querySelector("ul li");!m(n.ulElement)&&!m(n.ulElement.getElementsByClassName("e-item-focus")[0])?Pe(n.targetElement(),{"aria-activedescendant":n.ulElement.getElementsByClassName("e-item-focus")[0].id}):!m(n.ulElement)&&!m(n.ulElement.getElementsByClassName("e-active")[0])&&Pe(n.targetElement(),{"aria-activedescendant":n.ulElement.getElementsByClassName("e-active")[0].id}),n.isFiltering()&&n.itemTemplate&&n.element.tagName===n.getNgDirective()&&a&&o&&a.textContent!==o.textContent&&n.element.tagName!=="EJS-COMBOBOX"&&n.cloneElements(),n.isFilterLayout()&&(Z([n.inputWrapper.container],[tt.inputFocus]),n.isFilterFocus=!0,n.filterInput.focus(),n.inputWrapper.clearButton&&P([n.inputWrapper.clearButton],tt.clearIconHide)),n.activeStateChange()},targetExitViewport:function(){xe.isDevice||n.hidePopup()}})},t.prototype.isEmptyList=function(){return!m(this.liCollections)&&this.liCollections.length===0},t.prototype.getFocusElement=function(){},t.prototype.isFilterLayout=function(){return this.getModuleName()==="dropdownlist"&&this.allowFiltering},t.prototype.scrollHandler=function(){xe.isDevice&&(this.getModuleName()==="dropdownlist"&&!this.isFilterLayout()||this.getModuleName()==="combobox"&&!this.allowFiltering&&this.isDropDownClick)&&this.element&&!this.isElementInViewport(this.element)&&this.hidePopup()},t.prototype.isElementInViewport=function(e){var i=e.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=window.innerHeight&&i.right<=window.innerWidth},t.prototype.setSearchBoxPosition=function(){var e=this.filterInput.parentElement.getBoundingClientRect().height;this.popupObj.element.style.maxHeight="100%",this.popupObj.element.style.width="100%",this.list.style.maxHeight=window.innerHeight-e+"px",this.list.style.height=window.innerHeight-e+"px";var i=this.filterInput.parentElement.querySelector("."+tt.clearIcon);Oe(this.filterInput),i.parentElement.insertBefore(this.filterInput,i)},t.prototype.setPopupPosition=function(e){var i,r=e,n=this.list.querySelector("."+tt.focus)||this.selectedLI,a=this.isEmptyList()?this.list:this.liCollections[0],o=this.isEmptyList()?this.list:this.liCollections[this.getItems().length-1],l=a.getBoundingClientRect().height;this.listItemHeight=l+parseInt(window.getComputedStyle(a).marginBottom,10);var h=this.list.offsetHeight/2,u=m(n)?a.offsetTop:n.offsetTop,c=o.offsetTop;if(c-h<u&&!m(this.liCollections)&&this.liCollections.length>0&&!m(n)){var f=this.list.offsetHeight/l,d=parseInt(getComputedStyle(this.list).paddingBottom,10);i=(f-(this.liCollections.length-this.activeIndex))*l-r+d,this.list.scrollTop=n.offsetTop}else u>h&&!this.enableVirtualization?(i=h-l/2,this.list.scrollTop=u-h+l/2):i=u;var p=this.inputWrapper.container.offsetHeight;return i=i+l+r-(l-p)/2,-i},t.prototype.setWidth=function(){var e=st(this.popupWidth);if(e.indexOf("%")>-1){var i=this.inputWrapper.container.offsetWidth*parseFloat(e)/100;e=i.toString()+"px"}if(xe.isDevice&&e.indexOf("px")>-1&&!this.allowFiltering&&(this.getModuleName()==="dropdownlist"||this.isDropDownClick&&this.getModuleName()==="combobox")){var r=this.isEmptyList()?this.list:this.liCollections[0];e=parseInt(e,10)+(parseInt(getComputedStyle(r).textIndent,10)-parseInt(getComputedStyle(this.inputElement).paddingLeft,10)+parseInt(getComputedStyle(this.inputElement.parentElement).borderLeftWidth,10))*2+"px"}return e},t.prototype.scrollBottom=function(e,i,r){var n=this;if(i===void 0&&(i=!1),r===void 0&&(r=null),m(this.selectedLI)&&this.enableVirtualization&&(this.selectedLI=this.list.querySelector("."+ne.li),!m(this.selectedLI)&&this.selectedLI.classList.contains("e-virtual-list")&&(this.selectedLI=this.liCollections[this.skeletonCount])),!m(this.selectedLI)){var a=this.selectedLI&&!isNaN(parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10))?parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10):0;this.isUpwardScrolling=!1;var o=this.list.querySelectorAll(".e-virtual-list").length,l=this.list.querySelector("li:last-of-type")?this.list.querySelector("li:last-of-type").getAttribute("data-value"):null,h=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*(this.selectedLI.offsetHeight+a):this.selectedLI.offsetTop,u=this.list.offsetHeight,c=h-o*(this.selectedLI.offsetHeight+a)+(this.selectedLI.offsetHeight+a)-this.list.scrollTop,f=this.list.scrollTop+c-u,d=!1;f=e?f+parseInt(getComputedStyle(this.list).paddingTop,10)*2:f+parseInt(getComputedStyle(this.list).paddingTop,10);var p=h-o*(this.selectedLI.offsetHeight+a)+(this.selectedLI.offsetHeight+a)-this.list.scrollTop;if(p=this.fields.groupBy&&!m(this.fixedHeaderElement)?p-this.fixedHeaderElement.offsetHeight:p,this.activeIndex===0&&!this.enableVirtualization)this.list.scrollTop=0,d=this.isKeyBoardAction;else if(c>u||!(p>0&&this.list.offsetHeight>p)){var v=this.selectedLI?this.selectedLI.getAttribute("data-value"):null,g=r==="pageDown"?this.getPageCount()-2:1;!this.enableVirtualization||this.isKeyBoardAction||i?this.isKeyBoardAction&&this.enableVirtualization&&l&&v===l&&r!=="end"&&!this.isVirtualScrolling?(this.isPreventKeyAction=!0,this.enableVirtualization&&this.itemTemplate?this.list.scrollTop+=f:(this.enableVirtualization&&(g=r==="pageDown"?this.getPageCount()+1:g),this.list.scrollTop+=(this.selectedLI.offsetHeight+a)*g),this.isPreventKeyAction=this.IsScrollerAtEnd()?!1:this.isPreventKeyAction,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1):this.enableVirtualization&&r==="end"?(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1,this.list.scrollTop=this.list.scrollHeight):(r==="pageDown"&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=f):this.list.scrollTop=this.virtualListInfo&&this.virtualListInfo.startIndex?e&&this.virtualListInfo.startIndex?this.virtualListInfo.startIndex*this.listItemHeight+this.listItemHeight*2:this.virtualListInfo.startIndex*this.listItemHeight:0,d=this.isKeyBoardAction}this.isKeyBoardAction=d,this.enableVirtualization&&this.fields.groupBy&&this.fixedHeaderElement&&r==="down"&&setTimeout(function(){n.scrollStop(null,!0)},100)}},t.prototype.scrollTop=function(e){if(e===void 0&&(e=null),!m(this.selectedLI)){var i=this.selectedLI&&!isNaN(parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10))?parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10):0,r=this.list.querySelectorAll(".e-virtual-list").length,n=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*(this.selectedLI.offsetHeight+i):this.selectedLI.offsetTop,a=n-r*(this.selectedLI.offsetHeight+i)-this.list.scrollTop,o=this.list.querySelector("li.e-list-item:not(.e-virtual-list)")?this.list.querySelector("li.e-list-item:not(.e-virtual-list)").getAttribute("data-value"):null;a=this.fields.groupBy&&!m(this.fixedHeaderElement)?a-this.fixedHeaderElement.offsetHeight:a;var l=n-r*(this.selectedLI.offsetHeight+i)+(this.selectedLI.offsetHeight+i)-this.list.scrollTop,h=this.enableVirtualization&&this.getModuleName()==="autocomplete"&&a<=0;if(this.activeIndex===0&&!this.enableVirtualization)this.list.scrollTop=0;else if(a<0||h){var u=this.selectedLI?this.selectedLI.getAttribute("data-value"):null,c=e==="pageUp"?this.getPageCount()-2:1;this.enableVirtualization&&(c=e==="pageUp"?this.getPageCount():c),this.enableVirtualization&&this.isKeyBoardAction&&o&&u===o&&e!=="home"&&!this.isVirtualScrolling?(this.isUpwardScrolling=!0,this.isPreventKeyAction=!0,this.list.scrollTop-=(this.selectedLI.offsetHeight+i)*c,this.isPreventKeyAction=this.list.scrollTop!==0?this.isPreventKeyAction:!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1):this.enableVirtualization&&e==="home"?(this.isPreventScrollAction=!1,this.isPreventKeyAction=!0,this.isKeyBoardAction=!1,this.list.scrollTo(0,0)):(e==="pageUp"&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=this.list.scrollTop+a)}else l>0&&this.list.offsetHeight>l||(this.list.scrollTop=this.selectedLI.offsetTop-(this.fields.groupBy&&!m(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))}},t.prototype.IsScrollerAtEnd=function(){return this.list&&this.list.scrollTop+this.list.clientHeight>=this.list.scrollHeight},t.prototype.isEditTextBox=function(){return!1},t.prototype.isFiltering=function(){return this.allowFiltering},t.prototype.isPopupButton=function(){return!0},t.prototype.setScrollPosition=function(e){if(this.isPreventScrollAction=!0,m(e))this.scrollBottom(!0);else switch(e.action){case"pageDown":case"down":case"end":this.isKeyBoardAction=!0,this.scrollBottom(!1,!1,e.action);break;default:this.isKeyBoardAction=e.action==="up"||e.action==="pageUp"||e.action==="open",this.scrollTop(e.action);break}this.isKeyBoardAction=!1},t.prototype.clearText=function(){this.filterInput.value=this.typedString="",this.searchLists(null),this.enableVirtualization&&(this.list.scrollTop=0,this.totalItemCount=this.dataCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.list.getElementsByClassName("e-virtual-ddl")[0]&&(this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight()),this.getSkeletonCount(),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues()))},t.prototype.setEleWidth=function(e){m(e)||(typeof e=="number"?this.inputWrapper.container.style.width=st(e):typeof e=="string"&&(this.inputWrapper.container.style.width=e.match(/px|%|em/)?e:st(e)))},t.prototype.closePopup=function(e,i){var r=this,n=!m(this.filterInput)&&!m(this.filterInput.value)&&this.filterInput.value!=="";if(this.getModuleName()==="combobox"&&this.typedString,this.isTyped=!1,this.isVirtualTrackHeight=!1,!!(this.popupObj&&document.body.contains(this.popupObj.element)&&this.beforePopupOpen)){this.keyboardEvent=null,R.remove(document,"mousedown",this.onDocumentClick),this.isActive=!1,this.isDropDownClick=!1,this.preventAutoFill=!1;for(var a=this.popupObj.getScrollableParent(this.inputWrapper.container),o=0,l=a;o<l.length;o++){var h=l[o];R.remove(h,"scroll",this.scrollHandler)}xe.isDevice&&this.isFilterLayout()&&this.isDeviceFullScreen&&Z([document.body,this.popupObj.element],tt.popupFullScreen),this.isFilterLayout()&&(xe.isDevice||(this.searchKeyModule.destroy(),this.clearIconElement&&R.remove(this.clearIconElement,"click",this.clearText)),this.backIconElement&&(R.remove(this.backIconElement,"click",this.clickOnBackIcon),R.remove(this.clearIconElement,"click",this.clearText)),m(this.filterInput)||(R.remove(this.filterInput,"input",this.onInput),R.remove(this.filterInput,"keyup",this.onFilterUp),R.remove(this.filterInput,"keydown",this.onFilterDown),R.remove(this.filterInput,"blur",this.onBlurHandler),R.remove(this.filterInput,"paste",this.pasteHandler)),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(this.filterInput.removeAttribute("aria-activedescendant"),this.filterInput.removeAttribute("aria-disabled"),this.filterInput.removeAttribute("role"),this.filterInput.removeAttribute("autocomplete"),this.filterInput.removeAttribute("autocapitalize"),this.filterInput.removeAttribute("spellcheck")),this.filterInput=null),Pe(this.targetElement(),{"aria-expanded":"false"}),this.inputElement.setAttribute("aria-expanded","false"),this.targetElement().removeAttribute("aria-owns"),this.targetElement().removeAttribute("aria-activedescendant"),this.inputWrapper.container.classList.remove(tt.iconAnimation),this.isFiltering()&&(this.actionCompleteData.isUpdated=!1),this.enableVirtualization&&(this.value==null||this.isTyped?(this.viewPortInfo.endIndex=this.viewPortInfo&&this.viewPortInfo.endIndex>0?this.viewPortInfo.endIndex:this.itemCount,(this.getModuleName()==="autocomplete"||this.getModuleName()==="dropdownlist"&&!m(this.typedString)&&this.typedString!==""||this.getModuleName()==="combobox"&&this.allowFiltering&&!m(this.typedString)&&this.typedString!=="")&&this.checkAndResetCache()):this.getModuleName()==="autocomplete"&&this.checkAndResetCache(),(this.getModuleName()==="dropdownlist"||this.getModuleName()==="combobox")&&this.skeletonCount!==0&&this.getSkeletonCount(!0)),this.beforePopupOpen=!1;var u={name:"FadeOut",duration:100,delay:e||0},c=this.popupObj,f={popup:c,cancel:!1,animation:u,event:i||null};this.trigger("close",f,function(p){if(r.getModuleName()==="dropdownlist"&&Te.destroy({element:r.filterInput,floatLabelType:r.floatLabelType,properties:{placeholder:r.filterBarPlaceholder},buttons:r.clearIconElement},r.clearIconElement),r.filterInputObj=null,!m(r.popupObj)&&!m(r.popupObj.element.querySelector(".e-fixed-head"))){var v=r.popupObj.element.querySelector(".e-fixed-head");v.parentNode.removeChild(v),r.fixedHeaderElement=null}p.cancel||(r.getModuleName()==="autocomplete"&&r.rippleFun(),r.isPopupOpen?r.popupObj.hide(new vr(p.animation)):r.destroyPopup())}),xe.isDevice&&!f.cancel&&this.popupObj.element.classList.contains("e-wide-popup")&&this.popupObj.element.classList.remove("e-wide-popup");var d;this.dataSource instanceof fe?d=this.virtualGroupDataSource&&this.virtualGroupDataSource.length?this.virtualGroupDataSource.length:0:d=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.enableVirtualization&&this.isFiltering()&&n&&this.totalItemCount!==d&&(this.updateInitialData(),this.checkAndResetCache())}},t.prototype.updateInitialData=function(){var e=this.selectData;if(!m(e)){var i=this.renderItems(e,this.fields);if(this.list.scrollTop=0,this.virtualListInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount},this.getModuleName()==="combobox"&&(this.typedString=""),this.previousStartIndex=0,this.previousEndIndex=0,this.dataSource instanceof fe?this.remoteDataCount>=0?this.totalItemCount=this.dataCount=this.remoteDataCount:this.resetList(this.dataSource):this.totalItemCount=this.dataCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.list.getElementsByClassName("e-virtual-ddl")[0])this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.list.parentElement){var r=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});r.style.cssText=this.GetVirtualTrackHeight(),this.list.parentElement.querySelector(".e-dropdownbase").appendChild(r)}this.getModuleName()!=="autocomplete"&&this.totalItemCount!==0&&this.totalItemCount>this.itemCount*2&&this.getSkeletonCount(),this.UpdateSkeleton(),this.listData=e,this.updateActionCompleteDataValues(i,e),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues())}},t.prototype.destroyPopup=function(){this.isPopupOpen=!1,this.isFilterFocus=!1,this.inputElement.removeAttribute("aria-controls"),this.popupObj&&(this.resizer&&(R.remove(this.resizer,"mousedown",this.startResizing),R.remove(this.resizer,"touchstart",this.startResizing)),this.popupObj.destroy(),Oe(this.popupObj.element))},t.prototype.clickOnBackIcon=function(){this.hidePopup(),this.focusIn()},t.prototype.render=function(){this.preselectedIndex=m(this.index)?null:this.index,this.element.tagName==="INPUT"?(this.inputElement=this.element,m(this.inputElement.getAttribute("role"))&&this.inputElement.setAttribute("role","combobox"),m(this.inputElement.getAttribute("type"))&&this.inputElement.setAttribute("type","text"),this.inputElement.setAttribute("aria-expanded","false")):(this.inputElement=this.createElement("input",{attrs:{role:"combobox",type:"text"}}),this.element.tagName!==this.getNgDirective()&&(this.element.style.display="none"),this.element.parentElement.insertBefore(this.inputElement,this.element),this.preventTabIndex(this.inputElement));var e=this.cssClass;!m(this.cssClass)&&this.cssClass!==""&&(e=this.cssClass.replace(/\s+/g," ").trim()),!m(X(this.element,"fieldset"))&&X(this.element,"fieldset").disabled&&(this.enabled=!1),this.inputWrapper=Te.createInput({element:this.inputElement,buttons:this.isPopupButton()?[tt.icon]:null,floatLabelType:this.floatLabelType,properties:{readonly:this.getModuleName()==="dropdownlist"?!0:this.readonly,placeholder:this.placeholder,cssClass:e,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton}},this.createElement),this.element.tagName===this.getNgDirective()?this.element.appendChild(this.inputWrapper.container):this.inputElement.parentElement.insertBefore(this.element,this.inputElement),this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true",tabindex:"-1",class:tt.hiddenElement}}),Ii([this.hiddenElement],this.inputWrapper.container),this.hiddenElement.hasAttribute("aria-label")||this.hiddenElement.setAttribute("aria-label",this.getModuleName()),this.validationAttribute(this.element,this.hiddenElement),this.setReadOnly(),this.setFields(),this.inputWrapper.container.style.width=st(this.width),this.inputWrapper.container.classList.add("e-ddl"),this.floatLabelType!=="Never"&&Te.calculateWidth(this.inputElement,this.inputWrapper.container),!m(this.inputWrapper.buttons[0])&&this.inputWrapper.container.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.wireEvent(),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex");var i=this.element.getAttribute("id")?this.element.getAttribute("id"):fi("ej2_dropdownlist");if(this.element.id=i,this.hiddenElement.id=i+"_hidden",this.targetElement().setAttribute("tabindex",this.tabIndex),(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&!this.readonly?this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName()):this.getModuleName()==="dropdownlist"&&(this.targetElement().hasAttribute("aria-label")||Pe(this.targetElement(),{"aria-label":this.getModuleName()}),this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName()),this.inputElement.setAttribute("aria-expanded","false")),Pe(this.targetElement(),this.getAriaAttributes()),this.updateDataAttribute(this.htmlAttributes),this.setHTMLAttributes(),this.targetElement()===this.inputElement&&this.inputElement.removeAttribute("aria-labelledby"),this.value!==null||this.activeIndex!==null||this.text!==null)this.enableVirtualization&&(this.listItemHeight=this.getListHeight(),this.getSkeletonCount(),this.updateVirtualizationProperties(this.itemCount,this.allowFiltering),this.index!==null&&(this.activeIndex=this.index+this.skeletonCount)),this.initValue(),this.selectedValueInfo=this.viewPortInfo,this.enableVirtualization&&(this.activeIndex=this.activeIndex+this.skeletonCount);else if(this.element.tagName==="SELECT"&&this.element.options[0]){var r=this.element;this.value=this.allowObjectBinding?this.getDataByValue(r.options[r.selectedIndex].value):r.options[r.selectedIndex].value,this.text=m(this.value)?null:r.options[r.selectedIndex].textContent,this.initValue()}this.setEnabled(),this.preventTabIndex(this.element),this.enabled||(this.targetElement().tabIndex=-1),this.initial=!1,this.element.style.opacity="",this.inputElement.onselect=function(a){a.stopImmediatePropagation()},this.inputElement.onchange=function(a){a.stopImmediatePropagation()},this.element.hasAttribute("autofocus")&&this.focusIn(),m(this.text)||this.inputElement.setAttribute("value",this.text),this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false");var n=this.inputWrapper.container.getElementsByClassName("e-float-text")[0];!m(this.element.id)&&this.element.id!==""&&!m(n)&&(n.id="label_"+this.element.id.replace(/ /g,"_"),Pe(this.inputElement,{"aria-labelledby":n.id})),this.renderComplete(),this.listItemHeight=this.getListHeight(),this.getSkeletonCount(),this.enableVirtualization&&this.updateVirtualizationProperties(this.itemCount,this.allowFiltering),this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.viewPortInfo.startIndex>0?this.viewPortInfo.endIndex:this.itemCount},t.prototype.getListHeight=function(){var e=this.createElement("div",{className:"e-dropdownbase"}),i=this.createElement("li",{className:"e-list-item"}),r=st(this.popupHeight);e.style.height=parseInt(r,10).toString()+"px",e.appendChild(i),document.body.appendChild(e),this.virtualListHeight=e.getBoundingClientRect().height;var n=Math.ceil(i.getBoundingClientRect().height)+parseInt(window.getComputedStyle(i).marginBottom,10);return e.remove(),n},t.prototype.setFooterTemplate=function(e){var i;this.footer?this.isReact&&typeof this.footerTemplate=="function"?this.clearTemplate(["footerTemplate"]):this.footer.innerHTML="":(this.footer=this.createElement("div"),P([this.footer],tt.footer));var r=this.dropdownCompiler(this.footerTemplate);typeof this.footerTemplate!="function"&&r?i=wt(ye(this.footerTemplate,document).innerHTML.trim()):i=wt(this.footerTemplate);var n=i({},this,"footerTemplate",this.footerTemplateId,this.isStringTemplate,null,this.footer);n&&n.length>0&&at(n,this.footer),at([this.footer],e)},t.prototype.setHeaderTemplate=function(e){var i;this.header?this.header.innerHTML="":(this.header=this.createElement("div"),P([this.header],tt.header));var r=this.dropdownCompiler(this.headerTemplate);typeof this.headerTemplate!="function"&&r?i=wt(ye(this.headerTemplate,document).innerHTML.trim()):i=wt(this.headerTemplate);var n=i({},this,"headerTemplate",this.headerTemplateId,this.isStringTemplate,null,this.header);n&&n.length&&at(n,this.header);var a=e.querySelector("div.e-content");e.insertBefore(this.header,a)},t.prototype.setEnabled=function(){this.element.setAttribute("aria-disabled",this.enabled?"false":"true")},t.prototype.setOldText=function(e){this.text=e},t.prototype.setOldValue=function(e){this.value=e},t.prototype.refreshPopup=function(){!m(this.popupObj)&&document.body.contains(this.popupObj.element)&&(this.allowFiltering&&!(xe.isDevice&&this.isFilterLayout())||this.getModuleName()==="autocomplete")&&(Z([this.popupObj.element],"e-popup-close"),this.popupObj.refreshPosition(this.inputWrapper.container),this.popupObj.resolveCollision())},t.prototype.checkData=function(e){e.dataSource&&!m(Object.keys(e.dataSource))&&this.itemTemplate&&this.allowFiltering&&!(this.isListSearched&&e.dataSource instanceof fe)&&(this.list&&!this.isReact?this.list.innerHTML="":this.list=null,this.actionCompleteData={ulElement:null,list:null,isUpdated:!1}),this.isListSearched=!1;var i=Object.keys(e).indexOf("value")!==-1&&m(e.value),r=Object.keys(e).indexOf("text")!==-1&&m(e.text);this.getModuleName()!=="autocomplete"&&this.allowFiltering&&(i||r)&&(this.itemData=null),this.allowFiltering&&e.dataSource&&!m(Object.keys(e.dataSource))?(this.actionCompleteData={ulElement:null,list:null,isUpdated:!1},this.actionData=this.actionCompleteData):this.allowFiltering&&e.query&&!m(Object.keys(e.query))&&(this.actionCompleteData=this.getModuleName()==="combobox"?{ulElement:null,list:null,isUpdated:!1}:this.actionCompleteData,this.actionData=this.actionCompleteData)},t.prototype.updateDataSource=function(e,i){(this.inputElement.value!==""||!m(e)&&(m(e.dataSource)||!(e.dataSource instanceof fe)&&e.dataSource.length===0))&&this.clearAll(null,e),this.fields.groupBy&&e.fields&&!this.isGroupChecking&&this.list&&(R.remove(this.list,"scroll",this.setFloatingHeader),R.add(this.list,"scroll",this.setFloatingHeader,this)),(!(!m(e)&&(m(e.dataSource)||!(e.dataSource instanceof fe)&&e.dataSource.length===0))||e.dataSource instanceof fe||!m(e)&&Array.isArray(e.dataSource)&&!m(i)&&Array.isArray(i.dataSource)&&e.dataSource.length!==i.dataSource.length)&&(this.typedString="",this.resetList(this.dataSource)),!this.isCustomFilter&&!this.isFilterFocus&&document.activeElement!==this.filterInput&&this.checkCustomValue()},t.prototype.checkCustomValue=function(){var e=this.allowObjectBinding&&!m(this.value)?ie(this.fields.value?this.fields.value:"",this.value):this.value;this.itemData=this.getDataByValue(e);var i=this.getItemData(),r=this.allowObjectBinding?this.itemData:i.value,n=m(r)?null:this.index;m(n)&&e===r||this.isAngular?this.setProperties({text:i.text?i.text.toString():i.text,value:r}):this.setProperties({text:i.text?i.text.toString():i.text,index:n,value:r})},t.prototype.updateInputFields=function(){this.getModuleName()==="dropdownlist"&&Te.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.onPropertyChanged=function(e,i){var r=this;!m(e.dataSource)&&!this.isTouched&&m(e.value)&&m(e.index)&&!m(this.preselectedIndex)&&!m(this.index)&&(e.index=this.index),(!m(e.value)||!m(e.index))&&(this.isTouched=!0),this.getModuleName()==="dropdownlist"&&(this.checkData(e),this.setUpdateInitial(["fields","query","dataSource"],e));for(var n=function(c){switch(c){case"query":case"dataSource":a.getSkeletonCount(),a.checkAndResetCache();break;case"htmlAttributes":a.setHTMLAttributes();break;case"width":a.setEleWidth(e.width),Te.calculateWidth(a.inputElement,a.inputWrapper.container);break;case"placeholder":Te.setPlaceholder(e.placeholder,a.inputElement);break;case"filterBarPlaceholder":a.filterInput&&Te.setPlaceholder(e.filterBarPlaceholder,a.filterInput);break;case"readonly":a.getModuleName()!=="dropdownlist"&&Te.setReadonly(e.readonly,a.inputElement),a.setReadOnly();break;case"cssClass":a.setCssClass(e.cssClass,i.cssClass),Te.calculateWidth(a.inputElement,a.inputWrapper.container);break;case"enableRtl":a.setEnableRtl();break;case"enabled":a.setEnable();break;case"text":if(a.fields.disabled&&(e.text=e.text&&!a.isDisabledItemByIndex(a.getIndexByValue(a.getValueByText(e.text)))?e.text:null),e.text===null){a.clearAll();break}if(a.enableVirtualization){a.updateValues(),a.updateInputFields(),a.notify("setCurrentViewDataAsync",{module:"VirtualScroll"});break}if(a.list||(a.dataSource instanceof fe&&(a.initialRemoteRender=!0),a.renderList()),!a.initialRemoteRender){var f=a.getElementByText(e.text);if(!a.checkValidLi(f))if(a.liCollections&&a.liCollections.length===100&&a.getModuleName()==="autocomplete"&&a.listData.length>100)a.setSelectionData(e.text,i.text,"text");else if(e.text&&a.dataSource instanceof fe){var d=a.getItems().length,p=m(a.fields.text)?a.fields.value:a.fields.text;a.typedString="",a.dataSource.executeQuery(a.getQuery(a.query).where(new ht(p,"equal",e.text))).then(function(w){w.result.length>0?(r.addItem(w.result,d),r.updateValues()):r.setOldText(i.text)})}else a.getModuleName()==="autocomplete"?a.setInputValue(e,i):a.setOldText(i.text);a.updateInputFields()}break;case"value":if(a.fields.disabled&&(e.value=e.value!=null&&!a.isDisableItemValue(e.value)?e.value:null),e.value===null){a.clearAll();break}if(a.allowObjectBinding&&!m(e.value)&&!m(i.value)&&a.isObjectInArray(e.value,[i.value]))return{value:void 0};if(a.enableVirtualization){a.updateValues(),a.updateInputFields(),a.notify("setCurrentViewDataAsync",{module:"VirtualScroll"}),a.preventChange=a.isAngular&&a.preventChange?!a.preventChange:a.preventChange;break}if(a.notify("beforeValueChange",{newProp:e}),a.list||(a.dataSource instanceof fe&&(a.initialRemoteRender=!0),a.renderList()),!a.initialRemoteRender){var v=a.allowObjectBinding&&!m(e.value)?ie(a.fields.value?a.fields.value:"",e.value):e.value,g=a.getElementByValue(v);if(!a.checkValidLi(g))if(a.liCollections&&a.liCollections.length===100&&a.getModuleName()==="autocomplete"&&a.listData.length>100)a.setSelectionData(e.value,i.value,"value");else if(e.value&&a.dataSource instanceof fe){var b=a.getItems().length,p=m(a.fields.value)?a.fields.text:a.fields.value;a.typedString="";var C=a.allowObjectBinding&&!m(e.value)?ie(p,e.value):e.value;a.dataSource.executeQuery(a.getQuery(a.query).where(new ht(p,"equal",C))).then(function(S){S.result.length>0?(r.addItem(S.result,b),r.updateValues()):r.setOldValue(i.value)})}else a.getModuleName()==="autocomplete"?a.setInputValue(e,i):a.setOldValue(i.value);a.updateInputFields(),a.preventChange=a.isAngular&&a.preventChange?!a.preventChange:a.preventChange}break;case"index":if(a.fields.disabled&&(e.index=e.index!=null&&!a.isDisabledItemByIndex(e.index)?e.index:null),e.index===null){a.clearAll();break}if(a.list||(a.dataSource instanceof fe&&(a.initialRemoteRender=!0),a.renderList()),!a.initialRemoteRender&&a.liCollections){var y=a.liCollections[e.index];a.checkValidLi(y)||(a.liCollections&&a.liCollections.length===100&&a.getModuleName()==="autocomplete"&&a.listData.length>100?a.setSelectionData(e.index,i.index,"index"):a.index=i.index),a.updateInputFields()}break;case"footerTemplate":a.popupObj&&a.setFooterTemplate(a.popupObj.element);break;case"headerTemplate":a.popupObj&&a.setHeaderTemplate(a.popupObj.element);break;case"valueTemplate":!m(a.itemData)&&a.valueTemplate!==null&&a.setValueTemplate();break;case"allowFiltering":a.allowFiltering&&(a.actionCompleteData={ulElement:a.ulElement,list:a.listData,isUpdated:!0},a.actionData=a.actionCompleteData,a.updateSelectElementData(a.allowFiltering));break;case"floatLabelType":Te.removeFloating(a.inputWrapper),Te.addFloating(a.inputElement,e.floatLabelType,a.placeholder,a.createElement),!m(a.inputWrapper.buttons[0])&&a.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0]&&a.floatLabelType!=="Never"&&a.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"showClearButton":a.inputWrapper.clearButton||(Te.setClearButton(e.showClearButton,a.inputElement,a.inputWrapper,null,a.createElement),a.bindClearEvent());break;default:{var x=a.getPropObject(c,e,i);s.prototype.onPropertyChanged.call(a,x.newProperty,x.oldProperty)}break}},a=this,o=0,l=Object.keys(e);o<l.length;o++){var h=l[o],u=n(h);if(typeof u=="object")return u.value}},t.prototype.checkValidLi=function(e){return this.isValidLI(e)?(this.setSelection(e,null),!0):!1},t.prototype.setSelectionData=function(e,i,r){var n=this,a;this.updateListValues=function(){if(r==="text")a=n.getElementByText(e),n.checkValidLi(a)||n.setOldText(i);else if(r==="value"){var o=n.fields.value?n.fields.value:"";n.allowObjectBinding&&!m(e)&&ie(o,e),a=n.getElementByValue(e),n.checkValidLi(a)||n.setOldValue(i)}else r==="index"&&(a=n.liCollections[e],n.checkValidLi(a)||(n.index=i))}},t.prototype.updatePopupState=function(){this.beforePopupOpen&&(this.beforePopupOpen=!1,this.showPopup())},t.prototype.setReadOnly=function(){this.readonly?P([this.inputWrapper.container],["e-readonly"]):Z([this.inputWrapper.container],["e-readonly"])},t.prototype.setInputValue=function(e,i){},t.prototype.setCssClass=function(e,i){m(i)||(i=i.replace(/\s+/g," ").trim()),m(e)||(e=e.replace(/\s+/g," ").trim()),Te.setCssClass(e,[this.inputWrapper.container],i),this.popupObj&&Te.setCssClass(e,[this.popupObj.element],i)},t.prototype.getModuleName=function(){return"dropdownlist"},t.prototype.showPopup=function(e){if(this.enabled){if(this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null,this.isReact&&this.getModuleName()==="combobox"&&this.itemTemplate&&this.isCustomFilter&&this.isAddNewItemTemplate&&(this.renderList(),this.isAddNewItemTemplate=!1),this.isFiltering()&&this.dataSource instanceof fe&&this.actionData.list!==this.actionCompleteData.list&&this.actionData.list&&this.actionData.ulElement&&(this.actionCompleteData=this.actionData,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0)),this.beforePopupOpen){this.refreshPopup();return}this.beforePopupOpen=!0,this.isFiltering()&&!this.isActive&&this.actionCompleteData.list&&this.actionCompleteData.list[0]?(this.isActive=!0,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0)):(m(this.list)||!Cn(this.list)&&(this.list.classList.contains(ne.noData)||this.list.querySelectorAll("."+ne.li).length<=0))&&(this.isReact&&this.isFiltering()&&this.itemTemplate!=null&&(this.isSecondClick=!1),this.renderList(e)),this.enableVirtualization&&this.listData&&this.listData.length&&(!m(this.value)&&(this.getModuleName()==="dropdownlist"||this.getModuleName()==="combobox")&&this.removeHover(),this.beforePopupOpen||this.notify("setCurrentViewDataAsync",{module:"VirtualScroll"})),this.beforePopupOpen&&this.invokeRenderPopup(e),this.enableVirtualization&&!this.allowFiltering&&this.selectedValueInfo!=null&&this.selectedValueInfo.startIndex>0&&this.value!=null&&this.notify("dataProcessAsync",{module:"VirtualScroll",isOpen:!0}),!this.isSecondClick&&!this.isDropDownClick&&this.executeCloneElements()}},t.prototype.executeCloneElements=function(){var e=this,i=this.element.tagName===this.getNgDirective()&&this.itemTemplate?500:100;this.isReact&&this.isFiltering()&&this.itemTemplate!=null&&setTimeout(function(){e.cloneElements(),e.isSecondClick=!(e.isReact&&e.isFiltering()&&e.dataSource instanceof fe&&!e.list.querySelector("ul"))},i)},t.prototype.invokeRenderPopup=function(e){if(xe.isDevice&&this.isFilterLayout()){var i=this;window.onpopstate=function(){i.hidePopup()},history.pushState({},"")}!m(this.list)&&(!m(this.list.children[0])||this.list.classList.contains(ne.noData))&&this.renderPopup(e)},t.prototype.renderHightSearch=function(){},t.prototype.hidePopup=function(e){if(this.isEscapeKey&&this.getModuleName()==="dropdownlist")if(m(this.inputElement)||Te.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.isEscapeKey=!1,m(this.index))this.resetSelection();else{var i=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value):this.value,r=this.findListElement(this.ulElement,"li","data-value",i);this.selectedLI=this.liCollections[this.index]||r,this.selectedLI&&(this.updateSelectedItem(this.selectedLI,null,!0),this.valueTemplate&&this.itemData!==null&&this.setValueTemplate())}this.isVirtualTrackHeight=!1,this.customFilterQuery=null,this.closePopup(0,e);var n=this.getItemData(),a=!m(this.selectedLI);a&&this.enableVirtualization&&this.selectedLI.classList&&(a=this.selectedLI.classList.contains("e-active")),this.inputElement&&this.inputElement.value===""&&!this.isInteracted&&(this.isSelectCustom||a&&this.inputElement.value!==n.text)&&(this.isSelectCustom=!1,this.clearAll(e))},t.prototype.focusIn=function(e){if(this.enabled&&!this.targetElement().classList.contains(tt.disable)){var i=!1;this.preventFocus&&xe.isDevice&&(this.inputWrapper.container.tabIndex=1,this.inputWrapper.container.focus(),this.preventFocus=!1,i=!0),i||this.targetElement().focus(),P([this.inputWrapper.container],[tt.inputFocus]),this.onFocus(e),this.floatLabelType!=="Never"&&Te.calculateWidth(this.inputElement,this.inputWrapper.container)}},t.prototype.focusOut=function(e){this.enabled&&(!this.enableVirtualization&&(this.getModuleName()==="combobox"||this.getModuleName()==="autocomplete")&&(this.isTyped=!0),this.hidePopup(e),this.targetElement()&&this.targetElement().blur(),Z([this.inputWrapper.container],[tt.inputFocus]),this.floatLabelType!=="Never"&&Te.calculateWidth(this.inputElement,this.inputWrapper.container))},t.prototype.disableItem=function(e){if(this.fields.disabled){this.list||this.renderList();var i=-1;if(this.liCollections&&this.liCollections.length>0&&this.listData&&this.fields.disabled){if(typeof e=="string")i=this.getIndexByValue(e);else if(typeof e=="object"){if(e instanceof HTMLLIElement){for(var r=0;r<this.liCollections.length;r++)if(this.liCollections[r]===e){i=this.getIndexByValue(e.getAttribute("data-value"));break}}else for(var n=JSON.parse(JSON.stringify(e))[this.fields.value],r=0;r<this.listData.length;r++)if(JSON.parse(JSON.stringify(this.listData[r]))[this.fields.value]===n){i=this.getIndexByValue(n);break}}else i=e;var a=i<this.liCollections.length&&i>-1;if(a&&!JSON.parse(JSON.stringify(this.listData[i]))[this.fields.disabled]){var o=this.liCollections[i];if(o){this.disableListItem(o);var l=JSON.parse(JSON.stringify(this.listData[i]));l[this.fields.disabled]=!0,this.listData[i]=l,this.dataSource=this.listData,o.classList.contains(tt.focus)&&this.removeFocus(),o.classList.contains(tt.selected)&&this.clear()}}}}},t.prototype.destroy=function(){if(this.isActive=!1,this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),_B(this.element.id),this.isReact&&this.clearTemplate(),this.hidePopup(),this.popupObj&&this.popupObj.hide(),this.unWireEvent(),this.list&&this.unWireListEvents(),!(this.element&&!this.element.classList.contains("e-"+this.getModuleName()))){if(this.inputElement){for(var e=["readonly","aria-disabled","placeholder","aria-labelledby","aria-expanded","autocomplete","aria-readonly","autocapitalize","spellcheck","aria-autocomplete","aria-live","aria-describedby","aria-label"],i=0;i<e.length;i++)this.inputElement.removeAttribute(e[i]);this.inputElement.setAttribute("tabindex",this.tabIndex),this.inputElement.classList.remove("e-input"),Te.setValue("",this.inputElement,this.floatLabelType,this.showClearButton)}this.element.style.display="block",this.inputWrapper.container&&this.inputWrapper.container.parentElement&&(this.inputWrapper.container.parentElement.tagName===this.getNgDirective()?Oe(this.inputWrapper.container):(this.inputWrapper.container.parentElement.insertBefore(this.element,this.inputWrapper.container),Oe(this.inputWrapper.container))),delete this.hiddenElement,this.filterInput=null,this.keyboardModule=null,this.ulElement=null,this.list=null,this.clearIconElement=null,this.popupObj=null,this.popupContentElement=null,this.rippleFun=null,this.selectedLI=null,this.liCollections=null,this.item=null,this.footer=null,this.header=null,this.previousSelectedLI=null,this.valueTempElement=null,this.actionData.ulElement=null,this.inputElement&&!m(this.inputElement.onchange)&&(this.inputElement.onchange=null),this.inputElement&&!m(this.inputElement.onselect)&&(this.inputElement.onselect=null),Te.destroy({element:this.inputElement,floatLabelType:this.floatLabelType,properties:this.properties,buttons:this.inputWrapper.container.querySelectorAll(".e-input-group-icon")[0]},this.clearButton),this.clearButton=null,this.inputElement=null,this.inputWrapper=null,s.prototype.destroy.call(this)}},t.prototype.getItems=function(){return this.list||(this.dataSource instanceof fe&&(this.initialRemoteRender=!0),this.renderList()),this.ulElement?s.prototype.getItems.call(this):[]},t.prototype.getDataByValue=function(e){return s.prototype.getDataByValue.call(this,e)},t.prototype.clear=function(){this.value=null},St([O(null)],t.prototype,"cssClass",void 0),St([O("100%")],t.prototype,"width",void 0),St([O(!0)],t.prototype,"enabled",void 0),St([O(!1)],t.prototype,"enablePersistence",void 0),St([O("300px")],t.prototype,"popupHeight",void 0),St([O("100%")],t.prototype,"popupWidth",void 0),St([O(null)],t.prototype,"placeholder",void 0),St([O(null)],t.prototype,"filterBarPlaceholder",void 0),St([O({})],t.prototype,"htmlAttributes",void 0),St([O(null)],t.prototype,"query",void 0),St([O(null)],t.prototype,"valueTemplate",void 0),St([O(null)],t.prototype,"headerTemplate",void 0),St([O(null)],t.prototype,"footerTemplate",void 0),St([O(!1)],t.prototype,"allowFiltering",void 0),St([O(!0)],t.prototype,"isDeviceFullScreen",void 0),St([O(!1)],t.prototype,"readonly",void 0),St([O(!1)],t.prototype,"enableVirtualization",void 0),St([O(!1)],t.prototype,"allowResize",void 0),St([O(null)],t.prototype,"text",void 0),St([O(null)],t.prototype,"value",void 0),St([O(!1)],t.prototype,"allowObjectBinding",void 0),St([O(null)],t.prototype,"index",void 0),St([O("Never")],t.prototype,"floatLabelType",void 0),St([O(!1)],t.prototype,"showClearButton",void 0),St([Se()],t.prototype,"filtering",void 0),St([Se()],t.prototype,"change",void 0),St([Se()],t.prototype,"beforeOpen",void 0),St([Se()],t.prototype,"open",void 0),St([Se()],t.prototype,"close",void 0),St([Se()],t.prototype,"blur",void 0),St([Se()],t.prototype,"focus",void 0),St([Se()],t.prototype,"resizeStop",void 0),St([Se()],t.prototype,"resizing",void 0),St([Se()],t.prototype,"resizeStart",void 0),t=St([Wi],t),t}(Hw),Qc=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ye=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Jr="e-treeview",Eb="e-control",Xt="e-icon-collapsible",gt="e-icon-expandable",it="e-list-item",Un="e-list-text",uH="e-text-wrap",cH="e-ie-wrap",mt="e-list-parent",gu="e-hover",xr="e-active",bu="e-icons-spinner",$s="e-process",vi="e-icons",Ei="e-text-content",yu="e-input",Sb="e-input-group",xu="e-tree-input",ud="e-editing",kb="e-rtl",Tb="e-interaction",fH="e-drag-item",Ab="e-droppable",cd="e-dragging",ll="e-sibling",Cu="e-drop-in",hl="e-drop-next",fd="e-drop-out",dd="e-no-drop",dH="e-fullrow-wrap",qs="e-fullrow",Xa="e-selected",wu="e-expanded",Ob="e-node-collapsed",Ka="e-disable",pH="e-drop-count",zi="e-check",Qr="e-stop",ur="e-treeview-checkbox",Gs="e-frame",mH="e-ripple-container",Db="e-ripple",vH="e-ripple-element",$n="e-node-focus",Lb="e-list-img",gH="e-bigger",bH="e-small",yH="e-has-child",Eu="e-animation-active",Rb="e-disabled",ul="e-prevent",Ib={treeRole:"group",itemRole:"treeitem",listRole:"group",itemText:"",wrapperRole:""},xH=function(s){Qc(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return Ye([O("child")],t.prototype,"child",void 0),Ye([O([])],t.prototype,"dataSource",void 0),Ye([O("expanded")],t.prototype,"expanded",void 0),Ye([O("hasChildren")],t.prototype,"hasChildren",void 0),Ye([O("htmlAttributes")],t.prototype,"htmlAttributes",void 0),Ye([O("iconCss")],t.prototype,"iconCss",void 0),Ye([O("id")],t.prototype,"id",void 0),Ye([O("imageUrl")],t.prototype,"imageUrl",void 0),Ye([O("isChecked")],t.prototype,"isChecked",void 0),Ye([O("parentID")],t.prototype,"parentID",void 0),Ye([O(null)],t.prototype,"query",void 0),Ye([O("selectable")],t.prototype,"selectable",void 0),Ye([O("selected")],t.prototype,"selected",void 0),Ye([O(null)],t.prototype,"tableName",void 0),Ye([O("text")],t.prototype,"text",void 0),Ye([O("tooltip")],t.prototype,"tooltip",void 0),Ye([O("navigateUrl")],t.prototype,"navigateUrl",void 0),t}(Ir),_b=function(s){Qc(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return Ye([O("SlideDown")],t.prototype,"effect",void 0),Ye([O(400)],t.prototype,"duration",void 0),Ye([O("linear")],t.prototype,"easing",void 0),t}(Ir),CH=function(s){Qc(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return Ye([Ur({effect:"SlideUp",duration:400,easing:"linear"},_b)],t.prototype,"collapse",void 0),Ye([Ur({effect:"SlideDown",duration:400,easing:"linear"},_b)],t.prototype,"expand",void 0),t}(Ir),wH=function(s){Qc(t,s);function t(i,r){var n=s.call(this,i,r)||this;return n.isRefreshed=!1,n.preventExpand=!1,n.checkedElement=[],n.disableNode=[],n.validArr=[],n.validNodes=[],n.expandChildren=[],n.isFieldChange=!1,n.changeDataSource=!1,n.hasTemplate=!1,n.isFirstRender=!1,n.isNodeDropped=!1,n.isInteracted=!1,n.isRightClick=!1,n.mouseDownStatus=!1,n.isDropIn=!1,n.OldCheckedData=[],n.isHiddenItem=!1,n}e=t,t.prototype.getModuleName=function(){return"treeview"},t.prototype.preRender=function(){var i=this;this.checkActionNodes=[],this.parentNodeCheck=[],this.dragStartAction=!1,this.isAnimate=!1,this.keyConfigs={escape:"escape",end:"end",enter:"enter",f2:"f2",home:"home",moveDown:"downarrow",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",ctrlDown:"ctrl+downarrow",ctrlUp:"ctrl+uparrow",ctrlEnter:"ctrl+enter",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",ctrlA:"ctrl+A",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftEnter:"shift+enter",shiftHome:"shift+home",shiftEnd:"shift+end",csDown:"ctrl+shift+downarrow",csUp:"ctrl+shift+uparrow",csEnter:"ctrl+shift+enter",csHome:"ctrl+shift+home",csEnd:"ctrl+shift+end",space:"space",shiftSpace:"shift+space",ctrlSpace:"ctrl+space"},this.listBaseOption={expandCollapse:!0,showIcon:!0,expandIconClass:gt,ariaAttributes:Ib,expandIconPosition:"Left",itemCreated:function(r){i.beforeNodeCreate(r)},enableHtmlSanitizer:this.enableHtmlSanitizer,itemNavigable:this.fullRowNavigable},this.updateListProp(this.fields),this.aniObj=new vr({}),this.treeList=[],this.isLoaded=!1,this.isInitalExpand=!1,this.expandChildren=[],this.index=0,this.setTouchClass(),this.DDTTreeData=JSON.parse(JSON.stringify(this.fields.dataSource)),m(this.selectedNodes)&&this.setProperties({selectedNodes:[]},!0),m(this.checkedNodes)&&this.setProperties({checkedNodes:[]},!0),m(this.expandedNodes)?this.setProperties({expandedNodes:[]},!0):this.isInitalExpand=!0},t.prototype.getPersistData=function(){var i=["selectedNodes","checkedNodes","expandedNodes"];return this.addOnPersist(i)},t.prototype.render=function(){this.initialRender=!0,this.initialize(),this.setDataBinding(!1),this.setDisabledMode(),this.setExpandOnType(),this.disabled||this.setRipple(),this.wireEditingEvents(this.allowEditing),this.setDragAndDrop(this.allowDragAndDrop),this.disabled||this.wireEvents(),this.initialRender=!1,this.renderComplete()},t.prototype.initialize=function(){this.element.setAttribute("role","tree"),!m(this.fields.dataSource)&&Array.isArray(this.fields.dataSource)&&this.fields.dataSource.length!==0&&this.element.setAttribute("aria-activedescendant",this.element.id+"_active"),this.setCssClass(null,this.cssClass),this.setEnableRtl(),this.setFullRow(this.fullRowSelect),this.setTextWrap(),this.nodeTemplateFn=this.templateComplier(this.nodeTemplate)},t.prototype.setDisabledMode=function(){this.disabled?(this.element.classList.add(Rb),this.element.setAttribute("aria-disabled","true")):(this.element.classList.remove(Rb),this.element.setAttribute("aria-disabled","false"))},t.prototype.setEnableRtl=function(){(this.enableRtl?P:Z)([this.element],kb)},t.prototype.setRipple=function(){var i="."+qs+",."+Ei,r={selector:i,ignore:"."+Ei+" > ."+vi+",."+Sb+",."+yu+", ."+ur};this.rippleFn=os(this.element,r);var n={selector:"."+Ei+" > ."+vi,isCenterRipple:!0};this.rippleIconFn=os(this.element,n)},t.prototype.setFullRow=function(i){(i?P:Z)([this.element],dH)},t.prototype.setMultiSelect=function(i){i?this.element.setAttribute("aria-multiselectable","true"):this.element.setAttribute("aria-multiselectable","false")},t.prototype.templateComplier=function(i){if(i){this.hasTemplate=!0,this.element.classList.add(Tb);try{return typeof i!="function"&&document.querySelectorAll(i).length?wt(document.querySelector(i).innerHTML.trim()):wt(i)}catch(r){return wt(i)}}this.element.classList.remove(Tb)},t.prototype.setDataBinding=function(i){var r=this;this.treeList.push("false"),this.fields.dataSource instanceof fe?(this.isOffline=this.fields.dataSource.dataSource.offline,this.fields.dataSource.ready?this.fields.dataSource.ready.then(function(n){r.isOffline=r.fields.dataSource.dataSource.offline,r.fields.dataSource instanceof fe&&r.isOffline&&(r.treeList.pop(),r.treeData=n.result,r.isNumberTypeId=r.getType(),r.setRootData(),r.renderItems(!0),r.treeList.length===0&&!r.isLoaded&&r.finalize())}).catch(function(n){r.trigger("actionFailure",{error:n})}):this.fields.dataSource.executeQuery(this.getQuery(this.fields)).then(function(n){r.treeList.pop(),r.treeData=n.result,r.isNumberTypeId=r.getType(),r.setRootData(),i&&(r.changeDataSource=!0),r.renderItems(!0),r.changeDataSource=!1,r.treeList.length===0&&!r.isLoaded&&r.finalize()}).catch(function(n){r.trigger("actionFailure",{error:n})})):(this.treeList.pop(),m(this.fields.dataSource)?this.rootData=this.treeData=[]:(this.treeData=JSON.parse(JSON.stringify(this.fields.dataSource)),this.setRootData()),this.isNumberTypeId=this.getType(),this.renderItems(!1)),this.treeList.length===0&&!this.isLoaded&&this.finalize()},t.prototype.getQuery=function(i,r){r===void 0&&(r=null);var n=[],a;if(i.query)a=i.query.clone();else{a=new We;for(var o=this.getActualProperties(i),l=0,h=Object.keys(o);l<h.length;l++){var u=h[l];u!=="dataSource"&&u!=="tableName"&&u!=="child"&&i[""+u]&&u!=="url"&&n.indexOf(i[""+u])===-1&&n.push(i[""+u])}a.select(n),Object.prototype.hasOwnProperty.call(o,"tableName")&&a.from(i.tableName)}return Ft.addSorting(this.sortOrder,i.text,a),!m(r)&&!m(i.parentID)&&a.where(i.parentID,"equal",this.isNumberTypeId?parseFloat(r):r),a},t.prototype.getType=function(){return this.treeData[0]?typeof ie(this.fields.id,this.treeData[0])=="number":!1},t.prototype.setRootData=function(){if(this.dataType=this.getDataType(this.treeData,this.fields),this.dataType===1){this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID);var i=this.getChildNodes(this.treeData,void 0,!0);m(i)?this.rootData=[]:this.rootData=i}else this.rootData=this.treeData},t.prototype.isChildObject=function(){return typeof this.fields.child=="object"},t.prototype.renderItems=function(i){this.listBaseOption.ariaAttributes.level=1;var r=this.getSortedData(this.rootData);this.ulElement=Ft.createList(this.createElement,i?this.rootData:r,this.listBaseOption),this.element.appendChild(this.ulElement);var n=this.ulElement.querySelectorAll(".e-list-item");if(this.loadOnDemand===!1)for(var a=0;a<n.length;)this.renderChildNodes(n[parseInt(a.toString(),10)],!0,null,!0),a++;var o=dt("."+mt,this.element);(o.length===1&&n&&n.length!==0||this.loadOnDemand)&&this.finalizeNode(this.element),this.parentNodeCheck=[],this.parentCheckData=[],this.updateCheckedStateFromDS(),this.autoCheck&&this.showCheckBox&&!this.isLoaded&&this.updateParentCheckState()},t.prototype.updateCheckedStateFromDS=function(){if(this.validNodes=[],this.treeData&&this.showCheckBox){if(this.dataType===1){for(var i=this.fields,r=new fe(this.treeData).executeLocal(new We().where(i.isChecked,"equal",!0,!1)),n=0;n<r.length;n++){var a=r[parseInt(n.toString(),10)][this.fields.id]?r[parseInt(n.toString(),10)][this.fields.id].toString():null;if(this.checkedNodes.indexOf(a)===-1&&!this.isLoaded&&this.checkDisabledState(a,r[n]),r[parseInt(n.toString(),10)][this.fields.hasChildren])for(var o=r[parseInt(n.toString(),10)][this.fields.id],l=new fe(this.treeData).executeLocal(new We().where(i.parentID,"equal",o,!1)),h=0;h<l.length;h++){var u=l[parseInt(h.toString(),10)][this.fields.id]?l[parseInt(h.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(u)===-1&&this.autoCheck&&this.checkDisabledState(u,l[h])}}for(var n=0;n<this.checkedNodes.length;n++){var c=this.fields,f=new fe(this.treeData).executeLocal(new We().where(c.id,"equal",this.checkedNodes[parseInt(n.toString(),10)],!0));if(f[0]&&this.autoCheck&&(this.getCheckedNodeDetails(c,f),this.checkIndeterminateState(f[0])),f.length>0){var d=f[0][this.fields.id]?f[0][this.fields.id].toString():null;this.checkedNodes.indexOf(d)>-1&&this.validNodes.indexOf(d)===-1&&this.validNodes.push(d)}for(var p=new fe(this.treeData).executeLocal(new We().where(c.parentID,"equal",this.checkedNodes[parseInt(n.toString(),10)],!0)),v=0;v<p.length;v++){var d=p[parseInt(v.toString(),10)][this.fields.id]?p[parseInt(v.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(d)===-1&&this.autoCheck&&this.checkDisabledState(d,p[v]),this.checkedNodes.indexOf(d)>-1&&this.validNodes.indexOf(d)===-1&&this.validNodes.push(d)}}}else if(this.dataType===2||this.fields.dataSource instanceof fe&&this.isOffline){for(var v=0;v<this.treeData.length;v++){var g=this.treeData[parseInt(v.toString(),10)][this.fields.id]?this.treeData[parseInt(v.toString(),10)][this.fields.id].toString():"";this.treeData[parseInt(v.toString(),10)][this.fields.isChecked]&&!this.isLoaded&&this.checkedNodes.indexOf(g)===-1&&this.checkDisabledState(g,this.treeData[v]),this.checkedNodes.indexOf(g)>-1&&this.validNodes.indexOf(g)===-1&&this.validNodes.push(g);var b=ie(this.fields.child.toString(),this.treeData[parseInt(v.toString(),10)]);b&&this.updateChildCheckState(b,this.treeData[parseInt(v.toString(),10)])}this.validNodes=this.enablePersistence?this.checkedNodes:this.validNodes}this.setProperties({checkedNodes:this.validNodes},!0)}},t.prototype.getCheckedNodeDetails=function(i,r){var n=r[0][this.fields.parentID]?r[0][this.fields.parentID].toString():null,a=0,o=this.element.querySelector('[data-uid="'+r[0][this.fields.id]+'"]'),l=this.element.querySelector('[data-uid="'+r[0][this.fields.parentID]+'"]');if(!o&&!l){this.parentNodeCheck.indexOf(n)===-1&&this.parentNodeCheck.push(n);for(var h=this.getChildNodes(this.treeData,n),u=0;u<h.length;u++){var c=h[parseInt(u.toString(),10)][this.fields.id]?h[parseInt(u.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(c)!==-1&&a++,a===h.length&&this.checkedNodes.indexOf(n)===-1&&this.checkDisabledState(n)}var f=new fe(this.treeData).executeLocal(new We().where(i.id,"equal",n,!0));this.getCheckedNodeDetails(i,f)}else if(l){var d=ye("."+zi,l);d||this.changeState(l,"indeterminate",null,!0,!0)}},t.prototype.updateParentCheckState=function(){var i=dt("."+Qr,this.element),r,n=this.treeData;this.element.classList.contains("e-filtering")&&(n=this.DDTTreeData);for(var a=0;a<i.length;a++){var o=X(i[parseInt(a.toString(),10)],"."+it),l=o.getAttribute("data-uid").toString(),h=void 0;this.element.classList.contains("e-filtering")&&(h=new fe(this.OldCheckedData).executeLocal(new We().where("parentID","equal",l,!0))),this.dataType===1?r=new fe(n).executeLocal(new We().where(this.fields.parentID,"equal",l,!0)):r=this.getChildNodes(n,l);var u=0;if(r){for(var c=function(v){var g=r[parseInt(v.toString(),10)][f.fields.id].toString();(f.checkedNodes.indexOf(g)!==-1||f.element.classList.contains("e-filtering")&&h.findIndex(function(b){return b.id===g})!==-1)&&u++},f=this,d=0;d<r.length;d++)c(d);if(u===r.length){var p=o.getAttribute("data-uid");this.checkedNodes.indexOf(p)===-1&&this.checkDisabledState(p),this.changeState(o,"check",null,!0,!0)}else u===0&&this.checkedNodes.length===0&&this.changeState(o,"uncheck",null,!0,!0)}}},t.prototype.checkIndeterminateState=function(i){var r;if(this.dataType===1?r=this.element.querySelector('[data-uid="'+i[this.fields.parentID]+'"]'):r=this.element.querySelector('[data-uid="'+i[this.fields.id]+'"]'),r){var n=r.getAttribute("aria-checked");n!=="true"&&this.changeState(r,"indeterminate",null,!0,!0)}else this.dataType===2&&this.parentNodeCheck.indexOf(i[this.fields.id].toString())===-1&&this.parentNodeCheck.push(i[this.fields.id].toString())},t.prototype.updateChildCheckState=function(i,r){for(var n=0,a=r[this.fields.id]?r[this.fields.id].toString():"",o=0;o<i.length;o++){var l=i[parseInt(o.toString(),10)][this.fields.id]?i[parseInt(o.toString(),10)][this.fields.id].toString():"";i[parseInt(o.toString(),10)][this.fields.isChecked]&&!this.isLoaded&&this.checkedNodes.indexOf(l)===-1&&this.checkDisabledState(l,i[o]),this.checkedNodes.indexOf(a)!==-1&&this.checkedNodes.indexOf(l)===-1&&this.autoCheck&&this.checkDisabledState(l,i[o]),this.checkedNodes.indexOf(l)!==-1&&this.autoCheck&&n++,this.checkedNodes.indexOf(l)>-1&&this.validNodes.indexOf(l)===-1&&this.validNodes.push(l);var h=ie(this.fields.child.toString(),i[parseInt(o.toString(),10)]);h&&h.length&&(this.parentCheckData.indexOf(r)===-1&&this.parentCheckData.push(r),this.updateChildCheckState(h,i[parseInt(o.toString(),10)])),n===i.length&&this.autoCheck&&this.checkedNodes.indexOf(a)===-1&&this.checkDisabledState(a,r)}if(n!==0&&this.autoCheck){this.checkIndeterminateState(r);for(var u=0;u<this.parentCheckData.length;u++)r!==this.parentCheckData[parseInt(u.toString(),10)]&&this.parentCheckData[parseInt(u.toString(),10)]&&this.checkIndeterminateState(this.parentCheckData[parseInt(u.toString(),10)])}this.parentCheckData=[]},t.prototype.beforeNodeCreate=function(i){if(this.showCheckBox){var r=ov(this.createElement,!0,{cssClass:this.touchClass});r.classList.add(ur);var n=ye("div."+gt+", div."+Xt,i.item),a=i.item.getAttribute("data-uid");i.item.childNodes[0].insertBefore(r,i.item.childNodes[0].childNodes[m(n)?0:1]);var o=ie(i.fields.isChecked,i.curData);this.checkedNodes.indexOf(a)>-1?(ye("."+Gs,r).classList.add(zi),i.item.setAttribute("aria-checked","true"),this.addCheck(i.item)):!m(o)&&o.toString()==="true"?(ye("."+Gs,r).classList.add(zi),i.item.setAttribute("aria-checked","true"),this.addCheck(i.item)):i.item.setAttribute("aria-checked","false");var l=ye("."+Gs,r);R.add(l,"mousedown",this.frameMouseHandler,this),R.add(l,"mouseup",this.frameMouseHandler,this)}this.fullRowSelect&&this.createFullRow(i.item),this.allowMultiSelection&&!i.item.classList.contains(Xa)&&i.item.setAttribute("aria-selected","false");var h=i.fields;if(this.addActionClass(i,h.selected,Xa),this.addActionClass(i,h.expanded,wu),i.item.setAttribute("tabindex","-1"),R.add(i.item,"focus",this.focusIn,this),!m(this.nodeTemplateFn)){var u=i.item.querySelector("."+Un),c=i.item.getAttribute("data-uid");u.innerHTML="",this.renderNodeTemplate(i.curData,u,c)}var f={node:i.item,nodeData:i.curData,text:i.text};if(!this.isRefreshed&&(this.trigger("drawNode",f),i.curData[this.fields.selectable]===!1&&!this.showCheckBox)){i.item.classList.add(ul);var d=i.item.firstElementChild;d.style.cursor="not-allowed"}},t.prototype.frameMouseHandler=function(i){var r=ye("."+mH,i.target.parentElement);da(i,r)},t.prototype.addActionClass=function(i,r,n){var a=i.curData,o=ie(r,a);!m(o)&&o.toString()!=="false"&&i.item.classList.add(n)},t.prototype.getDataType=function(i,r){if(this.fields.dataSource instanceof fe){for(var n=0;n<i.length;n++)if(this.isOffline){if(typeof r.child=="string"&&m(ie(r.child,i[parseInt(n.toString(),10)]))&&!m(ie(r.parentID,i[parseInt(n.toString(),10)])))return 1}else if(typeof r.child=="string"&&m(ie(r.child,i[parseInt(n.toString(),10)])))return 1;return 2}for(var n=0,a=i.length;n<a;n++){if(typeof r.child=="string"&&(!m(ie(r.child,i[parseInt(n.toString(),10)]))||Object.prototype.hasOwnProperty.call(i[parseInt(n.toString(),10)],r.child))||this.isChildObject())return 2;if(!m(ie(r.parentID,i[parseInt(n.toString(),10)]))||!m(ie(r.hasChildren,i[parseInt(n.toString(),10)])))return 1}return 1},t.prototype.getGroupedData=function(i,r){for(var n=new We().group(r),a=Ft.getDataSource(i,n),o=[],l=0;l<a.length;l++){var h=a[parseInt(l.toString(),10)].items;o.push(h)}return o},t.prototype.getSortedData=function(i){return i&&this.sortOrder!=="None"&&(i=Ft.getDataSource(i,Ft.addSorting(this.sortOrder,this.fields.text))),i},t.prototype.finalizeNode=function(i,r,n){var a=this;if(r||this.updateAttributes(i),!n){var o=dt("."+wu,i);if(!this.loadOnDemand&&this.fields.dataSource instanceof fe&&(this.isInitalExpand=this.treeData.filter(function(h){return h[a.fields.expanded]===!0}).length>0?!0:this.isInitalExpand),!this.isInitalExpand)for(var l=0;l<o.length;l++)this.renderChildNodes(o[parseInt(l.toString(),10)]);Z(o,wu)}r||this.updateList(),this.isLoaded&&this.updateCheckedProp()},t.prototype.updateAttributes=function(i){for(var r=dt("."+Lb,i),n=0;n<r.length;n++)r[parseInt(n.toString(),10)].setAttribute("alt",Lb);if(this.isLoaded){for(var a=dt("."+Xa,i),o=0;o<a.length;o++){this.selectNode(a[parseInt(o.toString(),10)],null);break}Z(a,Xa)}for(var l=dt("."+it+":not(."+wu+")",i),h=0;h<l.length;h++){var u=ye("div."+vi,l[parseInt(h.toString(),10)]);u&&u.classList.contains(gt)&&this.disableExpandAttr(l[parseInt(h.toString(),10)])}},t.prototype.updateCheckedProp=function(){if(this.showCheckBox){var i=[].concat([],this.checkedNodes);this.setProperties({checkedNodes:i},!0)}},t.prototype.ensureIndeterminate=function(){if(this.autoCheck)for(var i=dt("li",this.element),r=void 0,n=0;n<i.length;n++)i[parseInt(n.toString(),10)].classList.contains(it)&&(r=ye("."+mt,i[parseInt(n.toString(),10)]),r?this.ensureParentCheckState(i[parseInt(n.toString(),10)]):this.ensureChildCheckState(i[parseInt(n.toString(),10)]));else for(var a=dt("."+Qr,this.element),n=0;n<a.length;n++)a[parseInt(n.toString(),10)].classList.remove(Qr)},t.prototype.ensureParentCheckState=function(i){if(!m(i)){if(i.classList.contains(Jr))return;var r=i;i.classList.contains(it)&&(r=ye("."+mt,i));var n=dt("."+ur+" ."+zi,r),a=dt("."+Qr,r),o=dt(this.checkDisabledChildren?"."+it:"."+it+":not(."+Ka+")",r),l=i.getElementsByClassName(ur)[0],h=o.length,u=n.length,c=[],f=[],d=i.getAttribute("data-uid"),p=!0,v=!1;o.forEach(function(E){if(E instanceof HTMLElement){var k=E.getAttribute("aria-checked");k==="true"?v=!0:p=!1}});var g=!1;if(this.element.classList.contains("e-filtering")){var b=new fe(this.OldCheckedData).executeLocal(new We().where("parentID","equal",d,!0));u=b.length;var C=new fe(this.OldCheckedData).executeLocal(new We().where("hasChildren","equal",!0,!0));C.length>0&&v&&(this.OldCheckedData.some(function(E){return E.id===d})||this.parentNodeCheck.indexOf(d)!==-1)&&(u=C.length,g=!0);var y=[];this.dataType===1?y=new fe(this.DDTTreeData).executeLocal(new We().where(this.fields.parentID,"equal",d,!0)):y=this.getChildNodes(this.DDTTreeData,d),h=y.length}if(this.autoCheck&&this.showCheckBox&&!(this.fields.dataSource instanceof fe)){var x=this.getSelectedChildNodeDetails(d);c=x,f=new fe(this.checkActionNodes).executeLocal(new We().where("parentID","equal",d,!0))}if(h===0&&u===0)return;h===u||g&&h>0&&(f.length===c.length||f.length!==c.length)&&f.length!==0&&c.length!==0&&p&&this.autoCheck&&this.showCheckBox?this.changeState(l,"check",null,!0,!0):u>0&&!g&&this.autoCheck&&this.showCheckBox?this.changeState(l,"indeterminate",null,!0,!0):u>0||a.length>0?this.changeState(l,"indeterminate",null,!0,!0):u===0&&this.changeState(l,"uncheck",null,!0,!0);var w=X(i,"."+mt);if(!m(w)){var S=X(w,"."+it);this.ensureParentCheckState(S)}}},t.prototype.getSelectedChildNodeDetails=function(i){var r=this,n=typeof this.fields.child=="string"?this.fields.child:null,a=this.fields.id,o=this.fields.parentID,l=function(h){if(!m(n)&&n in h&&Array.isArray(h[n])){var u=h[a];if(!m(u))return u.toString()===i}else{var c=h[o];if(!m(c))return c.toString()===i}return!1};return this.checkedNodes.map(function(h){return r.getNodeObject(h)}).filter(function(h){return h&&typeof h=="object"&&n in h||r.dataType!==2&&typeof h=="object"&&(o in h||n in h)?l(h):!1})},t.prototype.ensureChildCheckState=function(i,r,n){var a=this;if(!m(i)){var o=ye("."+mt,i),l=void 0;if(!m(o)){var h=Array.from(o.querySelectorAll("li"));l=dt("."+ur,o),this.isFilter&&(l=Array.from(l).filter(function(g){var b=g.closest("li").getAttribute("data-uid");return b!==null&&a.checkedNodes.indexOf(b)!==-1}),h=Array.from(h).filter(function(g){var b=g.getAttribute("data-uid");return b!==null&&a.checkedNodes.indexOf(b)!==-1}),l.length===0&&(l=dt("."+ur,o),h=Array.from(o.querySelectorAll("li"))));for(var u=i.getElementsByClassName(Gs)[0].classList.contains(zi),c=i.getElementsByClassName(Gs)[0].classList.contains(Qr),f=void 0,d=0;d<l.length;d++){var p=h[parseInt(d.toString(),10)].getAttribute("data-uid");if(!m(this.currentLoadData)&&!m(ie(this.fields.isChecked,this.currentLoadData[parseInt(d.toString(),10)])))f=ie(this.fields.isChecked,this.currentLoadData[parseInt(d.toString(),10)])?"check":"uncheck",this.ele!==-1&&(f=u?"check":"uncheck"),f==="uncheck"&&!Cn(this.parentNodeCheck)&&this.autoCheck&&this.parentNodeCheck.indexOf(p)!==-1&&(this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(p),1),f="indeterminate");else{var v=l[parseInt(d.toString(),10)].getElementsByClassName(Gs)[0].classList.contains(zi);u||v&&!this.isLoaded||this.checkedNodes.indexOf(p)!==-1&&this.isLoaded&&(c||u)?f="check":h[parseInt(d.toString(),10)].classList.contains(yH)&&!Cn(this.parentNodeCheck)&&this.autoCheck&&(u||c)&&this.parentNodeCheck.indexOf(p)!==-1?(f="indeterminate",this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(p),1)):this.dataType===1&&!Cn(this.parentNodeCheck)&&this.autoCheck&&(u||c)&&this.parentNodeCheck.indexOf(p)!==-1?(f="indeterminate",this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(p),1)):f="uncheck"}this.changeState(l[parseInt(d.toString(),10)],f,r,!0,!0)}}this.autoCheck&&this.isLoaded&&!n&&this.updateParentCheckState()}},t.prototype.doCheckBoxAction=function(i,r){if(m(i)){var d=dt("."+ur,this.element);if(this.loadOnDemand)for(var p=0;p<d.length;p++){var a=X(d[parseInt(p.toString(),10)],"."+it);this.updateFieldChecked(d[parseInt(p.toString(),10)],r),this.changeState(d[parseInt(p.toString(),10)],r?"check":"uncheck",null,null,null,r),this.updateOldCheckedData([this.getNodeData(a)])}else for(var p=0;p<d.length;p++){var a=X(d[parseInt(p.toString(),10)],"."+it);this.updateFieldChecked(d[parseInt(p.toString(),10)],r),this.changeState(d[parseInt(p.toString(),10)],r?"check":"uncheck"),this.updateOldCheckedData([this.getNodeData(a)])}}else{i.reverse();for(var n=i.length-1;n>=0;n--){var a=this.getElement(i[parseInt(n.toString(),10)]);if(m(a)){var o=i[n-i.length]?i[n-i.length].toString():i[parseInt(n.toString(),10)]?i[parseInt(n.toString(),10)].toString():null;if(o!==""&&r&&o)this.setValidCheckedNode(o,i),this.dynamicCheckState(o,r);else if(this.checkedNodes.indexOf(o)!==-1&&o!==""&&!r){this.checkedNodes.splice(this.checkedNodes.indexOf(o),1);var l=this.getChildNodes(this.treeData,o);if(l){for(var h=0;h<l.length;h++){var u=l[parseInt(h.toString(),10)][this.fields.id]?l[parseInt(h.toString(),10)][this.fields.id].toString():null;if(this.checkedNodes.indexOf(u)!==-1){this.checkedNodes.splice(this.checkedNodes.indexOf(u),1);var c=this.element.querySelector('[data-uid="'+u+'"]');c&&this.changeState(c,"uncheck",null)}}this.parentNodeCheck.indexOf(o)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(o),1)}o&&this.dynamicCheckState(o,r),this.updateField(this.treeData,this.fields,o,"isChecked",null)}continue}var f=ye("."+mt+" ."+ur,a);this.validateCheckNode(f,!r,a,null)}}if(i)for(var v=0;v<i.length-1;v++){var o=i[parseInt(v.toString(),10)]?i[parseInt(v.toString(),10)].toString():"";r||this.updateField(this.treeData,this.fields,o,"isChecked",null)}this.autoCheck&&this.updateParentCheckState()},t.prototype.updateFieldChecked=function(i,r){var n=X(i,"."+it),a=n.getAttribute("data-uid"),o=this.getNodeData(n);o.isChecked==="true"&&!r&&this.updateField(this.treeData,this.fields,a,"isChecked",null)},t.prototype.dynamicCheckState=function(i,r){if(this.dataType===1){var n=0,a=new fe(this.treeData).executeLocal(new We().where(this.fields.id,"equal",i,!0));if(a[0]){var o=a[0][this.fields.id]?a[0][this.fields.id].toString():null,l=a[0][this.fields.parentID]?a[0][this.fields.parentID].toString():null,h=this.element.querySelector('[data-uid="'+l+'"]'),u=this.element.querySelector('[data-uid="'+o+'"]'),c=this.getChildNodes(this.treeData,l);if(c)for(var f=0;f<c.length;f++){var d=c[parseInt(f.toString(),10)][this.fields.id]?c[parseInt(f.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(d)!==-1&&n++}this.checkedNodes.indexOf(i)!==-1&&h&&o===i&&this.autoCheck?this.changeState(h,"indeterminate",null):this.checkedNodes.indexOf(i)===-1&&u&&o===i&&!r?this.changeState(u,"uncheck",null):this.checkedNodes.indexOf(i)!==-1&&u&&o===i&&r?this.changeState(u,"check",null):this.checkedNodes.indexOf(i)===-1&&!u&&h&&o===i&&this.autoCheck&&n!==0?this.changeState(h,"indeterminate",null):this.checkedNodes.indexOf(i)===-1&&!u&&h&&o===i&&this.autoCheck&&n===0?this.changeState(h,"uncheck",null):!u&&!h&&o===i&&this.autoCheck&&this.updateIndeterminate(i,r)}}else if(this.dataType===2||this.fields.dataSource instanceof fe&&this.isOffline)for(var o=void 0,h=void 0,p=void 0,f=0;f<this.treeData.length;f++){o=this.treeData[parseInt(f.toString(),10)][this.fields.id]?this.treeData[parseInt(f.toString(),10)][this.fields.id].toString():"",h=this.element.querySelector('[data-uid="'+o+'"]'),p=h?ye("."+zi,h):null,this.checkedNodes.indexOf(o)===-1&&h&&p&&!r&&this.changeState(h,"uncheck",null);var v=ie(this.fields.child.toString(),this.treeData[parseInt(f.toString(),10)]);v&&this.updateChildIndeterminate(v,o,i,r,o)}},t.prototype.updateIndeterminate=function(i,r){var n=this.getTreeData(i),a=0,o;this.dataType===1&&(o=n[0][this.fields.parentID]?n[0][this.fields.parentID].toString():null);var l=this.getChildNodes(this.treeData,o);if(l)for(var h=0;h<l.length;h++){var u=l[parseInt(h.toString(),10)][this.fields.id]?l[parseInt(h.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(u)!==-1&&a++}var c=this.element.querySelector('[data-uid="'+o+'"]');c&&r?this.changeState(c,"indeterminate",null):!r&&c&&this.parentNodeCheck.indexOf(o)===-1&&a!==0?this.changeState(c,"indeterminate",null):!r&&c&&this.parentNodeCheck.indexOf(o)===-1&&a===0?this.changeState(c,"uncheck",null):c||(!r&&this.checkedNodes.indexOf(o)===-1&&this.parentNodeCheck.indexOf(o)!==-1?this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(o),1):r&&this.checkedNodes.indexOf(o)===-1&&this.parentNodeCheck.indexOf(o)===-1?this.parentNodeCheck.push(o):!r&&this.checkedNodes.indexOf(o)!==-1&&this.parentNodeCheck.indexOf(o)===-1&&a!==0&&this.parentNodeCheck.push(o),this.updateIndeterminate(o,r),this.checkedNodes.indexOf(o)!==-1&&!r&&this.checkedNodes.splice(this.checkedNodes.indexOf(o),1))},t.prototype.updateChildIndeterminate=function(i,r,n,a,o){for(var l=0,h=0;h<i.length;h++){var u=i[parseInt(h.toString(),10)][this.fields.id]?i[parseInt(h.toString(),10)][this.fields.id].toString():"";this.checkedNodes.indexOf(u)!==-1&&l++;var c=this.element.querySelector('[data-uid="'+r+'"]'),f=c?ye("."+Qr,c):null,d=c?ye("."+zi,c):null,p=this.element.querySelector('[data-uid="'+u+'"]'),v=p?ye("."+zi,p):null;if(this.checkedNodes.indexOf(n)!==-1&&c&&u===n&&this.autoCheck)this.changeState(c,"indeterminate",null);else if(this.checkedNodes.indexOf(n)===-1&&c&&!p&&u===n&&!a)this.autoCheck?this.changeState(c,"uncheck",null):l!==0?this.changeState(c,"indeterminate",null):this.changeState(c,"uncheck",null);else if(this.checkedNodes.indexOf(n)===-1&&p&&u===n&&!a)this.changeState(p,"uncheck",null);else if(this.checkedNodes.indexOf(n)===-1&&f&&u===n&&this.autoCheck&&l===0&&!a)f.classList.remove(Qr);else if(this.checkedNodes.indexOf(n)===-1&&!p&&d&&u===n&&l===0)this.changeState(c,"uncheck",null);else if(this.checkedNodes.indexOf(u)===-1&&p&&v&&l===0)this.changeState(p,"uncheck",null);else if(!p&&!c&&u===n||this.parentNodeCheck.indexOf(r)!==-1&&this.autoCheck){var g=this.element.querySelector('[data-uid="'+o+'"]');a&&l!==0?this.changeState(g,"indeterminate",null):a&&l===i.length&&this.checkedNodes.indexOf(r)===-1?this.checkDisabledState(r):!a&&l===0&&this.parentNodeCheck.indexOf(r)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(r)),this.parentNodeCheck.indexOf(r)===-1&&this.parentNodeCheck.push(r)}var b=ie(this.fields.child.toString(),i[parseInt(h.toString(),10)]);b&&this.updateChildIndeterminate(b,u,n,a,o)}},t.prototype.changeState=function(i,r,n,a,o,l){var h=this,u,c=X(i,"."+it);!this.checkDisabledChildren&&c&&(c.classList.contains(Ka)||this.disableNode&&this.disableNode.indexOf(c.getAttribute("data-uid"))!==-1)||(i===c&&(i=ye("."+ur,c)),a?this.nodeCheckAction(i,r,c,u,n,a,o,l):(this.checkActionNodes=[],u=this.getCheckEvent(c,r,n),this.trigger("nodeChecking",u,function(f){f.cancel||h.nodeCheckAction(i,r,c,f,n,a,o,l)})))},t.prototype.nodeCheckAction=function(i,r,n,a,o,l,h,u){var c,f=i.getElementsByClassName(Gs)[0];if(r==="check"&&!f.classList.contains(zi)?(f.classList.remove(Qr),f.classList.add(zi),this.addCheck(n),c="true"):r==="uncheck"&&(f.classList.contains(zi)||f.classList.contains(Qr))?(Z([f],[zi,Qr]),this.removeCheck(n),c="false"):r==="indeterminate"&&this.autoCheck&&(f.classList.remove(zi),f.classList.add(Qr),this.removeCheck(n),c="mixed"),c=r==="check"?"true":r==="uncheck"?"false":c,m(c)||n.setAttribute("aria-checked",c),h){var d=[].concat([],this.checkActionNodes);a=this.getCheckEvent(n,r,o),Cn(l)&&(a.data=d)}u!==void 0&&this.ensureStateChange(n,u),l||m(c)||(n.setAttribute("aria-checked",c),a.data[0].checked=c,this.trigger("nodeChecked",a),this.checkActionNodes=[])},t.prototype.addCheck=function(i){var r=i.getAttribute("data-uid");!m(r)&&this.checkedNodes.indexOf(r)===-1&&this.checkDisabledState(r)},t.prototype.removeCheck=function(i){var r=this.checkedNodes.indexOf(i.getAttribute("data-uid"));r>-1&&this.checkedNodes.splice(r,1)},t.prototype.getCheckEvent=function(i,r,n){this.checkActionNodes.push(this.getNodeData(i));var a=this.checkActionNodes;return{action:r,cancel:!1,isInteracted:!m(n),node:i,data:a}},t.prototype.finalize=function(){var i=ye("."+mt,this.element);m(i)||(i.setAttribute("role",Ib.treeRole),this.setMultiSelect(this.allowMultiSelection),this.setNodeFocusable(),this.allowTextWrap&&this.updateWrap(),this.renderReactTemplates(),this.hasPid=this.rootData[0]?Object.prototype.hasOwnProperty.call(this.rootData[0],this.fields.parentID):!1,this.doExpandAction())},t.prototype.setTextWrap=function(){(this.allowTextWrap?P:Z)([this.element],uH),xe.isIE&&(this.allowTextWrap?P:Z)([this.element],cH)},t.prototype.updateWrap=function(i){if(this.fullRowSelect)for(var r=i?dt("."+it,i):this.liList,n=r.length,a=0;a<n;a++)this.calculateWrap(r[parseInt(a.toString(),10)])},t.prototype.calculateWrap=function(i){var r=ye("."+qs,i);r&&r.nextElementSibling&&(r.style.height=this.allowTextWrap?r.nextElementSibling.offsetHeight+"px":"")},t.prototype.doExpandAction=function(){var i=this,r=this.expandedNodes;if(!this.loadOnDemand&&this.fields.dataSource instanceof fe&&(this.isInitalExpand=this.treeData.filter(function(l){return l[i.fields.expanded]===!0}).length>0?!0:this.isInitalExpand),this.isInitalExpand&&r.length>0)if(this.setProperties({expandedNodes:[]},!0),this.fields.dataSource instanceof fe)this.expandGivenNodes(r);else{for(var n=0;n<r.length;n++){var a=ye('[data-uid="'+r[parseInt(n.toString(),10)]+'"]',this.element);if(m(a)){r[parseInt(n.toString(),10)]&&this.expandChildren.indexOf(r[parseInt(n.toString(),10)])===-1&&this.expandChildren.push(r[parseInt(n.toString(),10)].toString());continue}else{var o=ye("."+gt,ye("."+Ei,a));m(o)||this.expandAction(a,o,null)}}this.afterFinalized()}else this.afterFinalized()},t.prototype.expandGivenNodes=function(i){var r=this;this.expandCallback(i[this.index],function(){r.index++,r.index<i.length?r.expandGivenNodes(i):r.afterFinalized()}),this.index>0&&(this.index=0)},t.prototype.expandCallback=function(i,r){var n=ye('[data-uid="'+i+'"]',this.element);if(m(n))r();else{var a=ye("."+gt,ye("."+Ei,n));m(a)||this.expandAction(n,a,null,!1,r),r()}},t.prototype.afterFinalized=function(){if(this.doSelectionAction(),this.updateCheckedProp(),this.isAnimate=!0,this.isInitalExpand=!1,(!this.isLoaded||this.isFieldChange)&&!this.isNodeDropped){var i={data:this.treeData};this.trigger("dataBound",i)}this.isLoaded=!0,this.isNodeDropped=!1},t.prototype.doSelectionAction=function(){var i=dt("."+Xa,this.element),r=this.selectedNodes;if(r.length>0){this.setProperties({selectedNodes:[]},!0);for(var n=0;n<r.length;n++){var a=ye('[data-uid="'+r[parseInt(n.toString(),10)]+'"]',this.element);if(a&&!a.classList.contains("e-active")?this.selectNode(a,null,!0):this.selectedNodes.push(r[parseInt(n.toString(),10)]),!this.allowMultiSelection)break}}else this.selectGivenNodes(i);Z(i,Xa)},t.prototype.selectGivenNodes=function(i){for(var r=0;r<i.length&&(i[parseInt(r.toString(),10)].classList.contains("e-disable")||this.selectNode(i[parseInt(r.toString(),10)],null,!0),!!this.allowMultiSelection);r++);},t.prototype.clickHandler=function(i){var r=xe.isDevice&&i.originalEvent.changedTouches&&!xe.isIos?document.elementFromPoint(i.originalEvent.changedTouches[0].clientX,i.originalEvent.changedTouches[0].clientY):i.originalEvent.target;if(R.remove(this.element,"contextmenu",this.preventContextMenu),!(!r||this.dragStartAction)){var n=r.classList,a=X(r,"."+it);if(!a||a.classList.contains(ul)&&!(n.contains(gt)||n.contains(Xt)))return;if(i.originalEvent.which!==3){var o=ye("."+vH,a),l=ye("."+vi,a);if(this.removeHover(),this.setFocusElement(a),this.showCheckBox&&!a.classList.contains("e-disable")){var h=X(r,"."+ur);if(!m(h)){var u=ye("."+Gs,h);this.validateCheckNode(h,u.classList.contains(zi),a,i.originalEvent),this.triggerClickEvent(i.originalEvent,a);return}}n.contains(gt)?this.expandAction(a,r,i):n.contains(Xt)?this.collapseNode(a,r,i):o&&l?l.classList.contains(Db)&&l.classList.contains(gt)?this.expandAction(a,l,i):l.classList.contains(Db)&&l.classList.contains(Xt)?this.collapseNode(a,l,i):!n.contains(mt)&&!n.contains(it)&&this.toggleSelect(a,i.originalEvent,!1):!n.contains(mt)&&!n.contains(it)&&this.toggleSelect(a,i.originalEvent,!1)}i.originalEvent.which===3&&(this.isRightClick=!0),this.triggerClickEvent(i.originalEvent,a)}},t.prototype.nodeCheckedEvent=function(i,r,n){var a=this.getCheckEvent(i,r?"uncheck":"check",n);a.data=a.data.splice(0,a.data.length-1),this.trigger("nodeChecked",a)},t.prototype.updateOldCheckedData=function(i){var r=this,n=new fe(i),a=n.executeLocal(new We().where("isChecked","equal","true",!0)),o=n.executeLocal(new We().where("isChecked","equal","false",!0));if(o.length>0){var l=this.OldCheckedData.findIndex(function(u){return u.id===o[0].id});if(l!==-1){this.OldCheckedData.splice(l,1);var h=this.OldCheckedData.filter(function(u){return u.parentID===o[0].id});h.length>0&&h.forEach(function(u){var c=r.OldCheckedData.findIndex(function(f){return f.id===u.id});c!==-1&&r.OldCheckedData.splice(c,1)});return}}if(a.length>0){var l=this.OldCheckedData.findIndex(function(c){return c.id===a[0].id});if(l===-1){this.OldCheckedData.push(a[0]);return}}},t.prototype.triggerClickEvent=function(i,r){var n={event:i,node:r};this.trigger("nodeClicked",n)},t.prototype.expandNode=function(i,r,n){var a=this;if(this.renderReactTemplates(),r.classList.contains(bu)&&this.hideSpinner(r),this.initialRender||r.classList.add("interaction"),n!==!0||n===!0&&i.classList.contains("e-expanded")){if(this.preventExpand!==!0){Z([r],gt),P([r],Xt);var o=0,l=0,h=ye("."+mt,i),u=i;if(this.isAnimate&&!this.isRefreshed){this.setHeight(u,h);var c=ye("."+it+"."+xr,i);this.aniObj.animate(h,{name:this.animation.expand.effect,duration:this.animation.expand.duration===0&&Yu==="Enable"?400:this.animation.expand.duration,timingFunction:this.animation.expand.easing,begin:function(){u.style.overflow="hidden",!m(c)&&c instanceof HTMLElement&&c.classList.add(Eu),o=u.offsetHeight,l=ye("."+Ei,i).offsetHeight},progress:function(d){d.element.style.display="block",a.animateHeight(d,o,l)},end:function(d){d.element.style.display="block",!m(c)&&c instanceof HTMLElement&&c.classList.remove(Eu),a.expandedNode(u,h,r)}})}else this.expandedNode(u,h,r)}}else{var f=ye("."+mt,i);f.style.display="none",this.fields.dataSource instanceof fe&&(this.preventExpand=!1)}this.initialRender&&r.classList.add("interaction")},t.prototype.expandedNode=function(i,r,n){r.style.display="block",i.style.display="block",i.style.overflow="",i.style.height="",Z([n],$s),this.addExpand(i),this.allowTextWrap&&this.isLoaded&&this.isFirstRender&&(this.updateWrap(i),this.isFirstRender=!1),this.isLoaded&&this.expandArgs&&!this.isRefreshed&&(this.expandArgs=this.getExpandEvent(i,null),this.expandArgs.isInteracted=this.isInteracted,this.trigger("nodeExpanded",this.expandArgs)),this.isHiddenItem&&this.collapseAll([this.getNodeData(i).id])},t.prototype.addExpand=function(i){i.setAttribute("aria-expanded","true"),Z([i],Ob);var r=i.getAttribute("data-uid");!m(r)&&this.expandedNodes.indexOf(r)===-1&&this.expandedNodes.push(r)},t.prototype.collapseNode=function(i,r,n){var a=this;if(!r.classList.contains($s)){P([r],$s);var o;this.isLoaded?(o=this.getExpandEvent(i,n),this.isInteracted=o.isInteracted,this.trigger("nodeCollapsing",o,function(l){l.cancel?Z([r],$s):a.nodeCollapseAction(i,r,l)})):this.nodeCollapseAction(i,r,o)}},t.prototype.nodeCollapseAction=function(i,r,n){var a=this;Z([r],Xt),P([r],gt);var o=0,l=0,h=ye("."+mt,i),u=i,c=ye("."+it+"."+xr,i);this.isAnimate?this.aniObj.animate(h,{name:this.animation.collapse.effect,duration:this.animation.collapse.duration===0&&Yu==="Enable"?400:this.animation.collapse.duration,timingFunction:this.animation.collapse.easing,begin:function(){u.style.overflow="hidden",!m(c)&&c instanceof HTMLElement&&c.classList.add(Eu),o=ye("."+Ei,i).offsetHeight,l=u.offsetHeight},progress:function(f){a.animateHeight(f,o,l)},end:function(f){f.element.style.display="none",!m(c)&&c instanceof HTMLElement&&c.classList.remove(Eu),a.collapsedNode(u,h,r,n)}}):this.collapsedNode(u,h,r,n)},t.prototype.collapsedNode=function(i,r,n,a){r.style.display="none",i.style.overflow="",i.style.height="",Z([n],$s),this.removeExpand(i),this.isLoaded&&(a=this.getExpandEvent(i,null),a.isInteracted=this.isInteracted,this.trigger("nodeCollapsed",a))},t.prototype.removeExpand=function(i,r){r?i.removeAttribute("aria-expanded"):this.disableExpandAttr(i);var n=this.expandedNodes.indexOf(i.getAttribute("data-uid"));n>-1&&this.expandedNodes.splice(n,1)},t.prototype.disableExpandAttr=function(i){i.setAttribute("aria-expanded","false"),P([i],Ob)},t.prototype.setHeight=function(i,r){r.style.display="block",r.style.visibility="hidden",i.style.height=i.offsetHeight+"px",r.style.display="none",r.style.visibility=""},t.prototype.animateHeight=function(i,r,n){if(!m(i.element.parentElement)){var a=(i.duration-i.timeStamp)/i.duration,o=(n-r)*a+r;i.element.parentElement.style.height=o+"px"}},t.prototype.renderChildNodes=function(i,r,n,a,o){var l=this,h=ye("div."+vi,i);if(!m(h)){this.showSpinner(h);var u;if(this.fields.dataSource instanceof fe){var c=this.parents(i,"."+mt).length,f=this.getChildFields(this.fields,c,1);if(m(f)||m(f.dataSource)){Oe(h),this.removeExpand(i,!0);return}this.treeList.push("false"),this.fields.dataSource instanceof fe&&this.isOffline?(this.treeList.pop(),u=this.getChildNodes(this.treeData,i.getAttribute("data-uid")),this.loadChild(u,f,h,i,r,n,a)):f.dataSource.executeQuery(this.getQuery(f,i.getAttribute("data-uid"))).then(function(d){l.treeList.pop(),u=d.result,l.dataType===1&&(l.dataType=2),l.loadChild(u,f,h,i,r,n,a)}).catch(function(d){l.trigger("actionFailure",{error:d})})}else if(u=this.getChildNodes(this.treeData,i.getAttribute("data-uid"),!1,parseFloat(i.getAttribute("aria-level"))+1),this.currentLoadData=this.getSortedData(u),m(u)||u.length===0){Oe(h),h.classList.contains(bu)&&this.hideSpinner(h),this.removeExpand(i,!0);return}else this.listBaseOption.ariaAttributes.level=parseFloat(i.getAttribute("aria-level"))+1,i.appendChild(Ft.createList(this.createElement,this.currentLoadData,this.listBaseOption)),this.expandNode(i,h,a),this.setSelectionForChildNodes(u),this.ensureCheckNode(i,o),this.finalizeNode(i,o,r),this.disableTreeNodes(u),this.renderSubChild(i,r,a,o)}},t.prototype.loadChild=function(i,r,n,a,o,l,h){if(this.currentLoadData=i,m(i)||i.length===0)Oe(n),this.removeExpand(a,!0);else{if(this.updateListProp(r),this.fields.dataSource instanceof fe&&!this.isOffline){var u=a.getAttribute("data-uid"),c=this.getNodeObject(u);It("child",i,c)}this.listBaseOption.ariaAttributes.level=parseFloat(a.getAttribute("aria-level"))+1,a.appendChild(Ft.createList(this.createElement,i,this.listBaseOption)),this.expandNode(a,n,h),this.setSelectionForChildNodes(i),this.ensureCheckNode(a),this.finalizeNode(a),this.disableTreeNodes(i),this.renderSubChild(a,o,h)}l&&l(),o&&this.expandedNodes.push(a.getAttribute("data-uid")),this.treeList.length===0&&!this.isLoaded&&this.finalize()},t.prototype.disableTreeNodes=function(i){if(!(m(this.disableNode)||this.disableNode.length===0))for(var r=0;r<i.length;){var n=i[parseInt(r.toString(),10)][this.fields.id]?i[parseInt(r.toString(),10)][this.fields.id].toString():null;this.disableNode!==void 0&&this.disableNode.indexOf(n)!==-1&&this.doDisableAction([n]),r++}},t.prototype.setSelectionForChildNodes=function(i){if(!(m(this.selectedNodes)||this.selectedNodes.length===0)){var r;for(r=0;r<i.length;r++){var n=i[parseInt(r.toString(),10)][this.fields.id]?i[parseInt(r.toString(),10)][this.fields.id].toString():null;this.selectedNodes!==void 0&&this.selectedNodes.indexOf(n)!==-1&&this.doSelectionAction()}}},t.prototype.ensureCheckNode=function(i,r){this.showCheckBox&&(this.ele=this.checkedElement?this.checkedElement.indexOf(i.getAttribute("data-uid")):null,this.autoCheck&&(this.ensureChildCheckState(i,null,r),(!r||ye("."+zi,this.element)||ye("."+Qr,this.element))&&this.ensureParentCheckState(i))),this.currentLoadData=null},t.prototype.getFields=function(i,r,n){return r===n?i:this.getFields(this.getChildMapper(i),r,n+1)},t.prototype.getChildFields=function(i,r,n){return r===n?this.getChildMapper(i):this.getChildFields(this.getChildMapper(i),r,n+1)},t.prototype.getChildMapper=function(i){return typeof i.child=="string"||m(i.child)?i:i.child},t.prototype.getChildNodes=function(i,r,n,a){var o=this;n===void 0&&(n=!1);var l;if(m(i))return l;if(this.dataType===1)return this.getChildGroup(this.groupedData,r,n);if(typeof this.fields.child=="string")return this.findChildNodes(i,this.fields.id,r)||this.findNestedChildNodes(i,r,a)||[];if(this.isChildObject()){for(var h=m(a)?this.fields.child:this.fields,u=1;u<a&&!m(h.child);){h=h.child;u++}this.updateListProp(h);var c=i.findIndex(function(g){return ie(o.fields.id,g)&&ie(o.fields.id,g).toString()===r});if(c!==-1)return ie("child",i[parseInt(c.toString(),10)]);if(c===-1)for(var f=0,d=i.length;f<d;f++){var p=ie("child",i[parseInt(f.toString(),10)]),v=m(p)?-1:p.findIndex(function(g){return ie(o.fields.child.id,g)&&ie(o.fields.child.id,g).toString()===r});if(v!==-1)return ie("child",p[parseInt(v.toString(),10)]);if(!m(p)&&(l=this.getChildNodes(p,r,!1,a),l!==void 0))break}}return l},t.prototype.findChildNodes=function(i,r,n){var a=i.findIndex(function(o){var l=ie(r,o);return l&&l.toString()===n});return a!==-1?ie(this.fields.child,i[a]):null},t.prototype.findNestedChildNodes=function(i,r,n){for(var a=0,o=i;a<o.length;a++){var l=o[a],h=ie(this.fields.child,l);if(!m(h)){var u=this.findChildNodes(h,this.fields.id,r);if(u)return u;var c=this.getChildNodes(h,r,!1,n);if(c&&c.length>0)return c}}},t.prototype.getChildGroup=function(i,r,n){var a=[];if(m(i))return a;for(var o=0,l=i.length;o<l;o++)if(!m(i[parseInt(o.toString(),10)][0])&&!m(ie(this.fields.parentID,i[parseInt(o.toString(),10)][0]))){if(ie(this.fields.parentID,i[parseInt(o.toString(),10)][0]).toString()===r)return i[parseInt(o.toString(),10)]}else if(n)return i[parseInt(o.toString(),10)];return a},t.prototype.renderSubChild=function(i,r,n,a){if(r)for(var o=dt("."+gt,i),l=0,h=o.length;l<h;l++){var u=o[parseInt(l.toString(),10)];if(i.querySelector(".e-icons")!==o[parseInt(l.toString(),10)]){var c=X(u,"."+it);this.expandArgs=this.getExpandEvent(c,null),n!==!0&&this.trigger("nodeExpanding",this.expandArgs),this.renderChildNodes(c,r,null,n,a)}}},t.prototype.toggleSelect=function(i,r,n){i.classList.contains("e-disable")||(this.allowMultiSelection&&(r&&r.ctrlKey||n)&&this.isActive(i)?this.unselectNode(i,r):this.selectNode(i,r,n))},t.prototype.isActive=function(i){return!!i.classList.contains(xr)},t.prototype.selectNode=function(i,r,n){var a=this;if(m(i)||!this.allowMultiSelection&&this.isActive(i)&&!m(r)){this.setFocusElement(i);return}var o;this.isLoaded?(o=this.getSelectEvent(i,"select",r),this.trigger("nodeSelecting",o,function(l){!l.cancel&&!l.node.classList.contains(ul)&&a.nodeSelectAction(i,r,l,n)})):this.nodeSelectAction(i,r,o,n)},t.prototype.nodeSelectAction=function(i,r,n,a){if((!this.allowMultiSelection||!a&&(!r||r&&!(r.ctrlKey||r.metaKey)))&&this.removeSelectAll(),this.allowMultiSelection&&r&&r.shiftKey){this.startNode||(this.startNode=i);var o=this.liList.indexOf(this.startNode),l=this.liList.indexOf(i);if(o>l){var h=o;o=l,l=h}for(var u=o;u<=l;u++){var c=this.liList[parseInt(u.toString(),10)];ea(c)&&!c.classList.contains("e-disable")&&this.addSelect(c)}}else this.startNode=i,this.addSelect(i);this.isLoaded&&(n.nodeData=this.getNodeData(i),this.trigger("nodeSelected",n),this.isRightClick=!1),this.isRightClick=!1},t.prototype.unselectNode=function(i,r){var n=this,a;this.isLoaded?(a=this.getSelectEvent(i,"un-select",r),this.trigger("nodeSelecting",a,function(o){o.cancel||n.nodeUnselectAction(i,o)})):this.nodeUnselectAction(i,a)},t.prototype.nodeUnselectAction=function(i,r){this.removeSelect(i),this.setFocusElement(i),this.isLoaded&&(r.nodeData=this.getNodeData(i),this.trigger("nodeSelected",r))},t.prototype.setFocusElement=function(i){if(!m(i)){var r=this.getFocusedNode();r&&(Z([r],$n),r.setAttribute("tabindex","-1")),P([i],$n),i.setAttribute("tabindex","0"),R.add(i,"blur",this.focusOut,this),this.updateIdAttr(r,i)}},t.prototype.addSelect=function(i){i.setAttribute("aria-selected","true"),P([i],xr);var r=i.getAttribute("data-uid");!m(r)&&this.selectedNodes.indexOf(r)===-1&&this.selectedNodes.push(r)},t.prototype.removeSelect=function(i){this.allowMultiSelection?i.setAttribute("aria-selected","false"):i.removeAttribute("aria-selected"),Z([i],xr);var r=this.selectedNodes.indexOf(i.getAttribute("data-uid"));r>-1&&this.selectedNodes.splice(r,1)},t.prototype.removeSelectAll=function(){for(var i=this.element.querySelectorAll("."+xr),r=0,n=i;r<n.length;r++){var a=n[r];this.allowMultiSelection?a.setAttribute("aria-selected","false"):a.removeAttribute("aria-selected")}Z(i,xr),this.setProperties({selectedNodes:[]},!0)},t.prototype.getSelectEvent=function(i,r,n){var a=this.getNodeData(i);return{action:r,cancel:!1,isInteracted:!m(n),node:i,nodeData:a}},t.prototype.setExpandOnType=function(){this.expandOnType=this.expandOn==="Auto"?xe.isDevice?"Click":"DblClick":this.expandOn},t.prototype.expandHandler=function(i){var r=xe.isDevice&&i.originalEvent.changedTouches&&!xe.isIos?document.elementFromPoint(i.originalEvent.changedTouches[0].clientX,i.originalEvent.changedTouches[0].clientY):i.originalEvent.target;!r||r.classList.contains(yu)||r.classList.contains(Jr)||r.classList.contains(mt)||r.classList.contains(it)||r.classList.contains(vi)||this.showCheckBox&&X(r,"."+ur)||this.expandCollapseAction(X(r,"."+it),i)},t.prototype.expandCollapseAction=function(i,r){var n=ye("div."+vi,i);if(!(!n||n.classList.contains($s))){var a=n.classList;a.contains(gt)?this.expandAction(i,n,r):a.contains(Xt)&&this.collapseNode(i,n,r)}},t.prototype.expandAction=function(i,r,n,a,o,l){var h=this;r.classList.contains($s)||(P([r],$s),this.isLoaded&&!this.isRefreshed?(this.expandArgs=this.getExpandEvent(i,n),this.isInteracted=this.expandArgs.isInteracted,this.trigger("nodeExpanding",this.expandArgs,function(u){u.cancel?Z([r],$s):h.nodeExpandAction(i,r,a,o,l)})):this.nodeExpandAction(i,r,a,o,l))},t.prototype.nodeExpandAction=function(i,r,n,a,o){var l=ye("."+mt,i);if(l&&l.nodeName==="UL")this.expandNode(i,r);else{this.isFirstRender=!0,this.renderChildNodes(i,n,a,null,o);for(var h=dt("."+it,i),u=0;u<h.length;u++){var c=this.getId(h[parseInt(u.toString(),10)]);if(this.expandChildren.indexOf(c)!==-1&&this.expandChildren!==void 0){var f=ye("."+gt,ye("."+Ei,h[parseInt(u.toString(),10)]));m(f)||this.expandAction(h[parseInt(u.toString(),10)],f,null),this.expandChildren.splice(this.expandChildren.indexOf(c),1)}}}},t.prototype.keyActionHandler=function(i){var r=this,n=i.target,a=this.getFocusedNode();if(n&&n.classList.contains(yu)){var o=n;i.action==="enter"?o.blur():i.action==="escape"&&(o.value=this.oldText,o.blur());return}i.preventDefault();var l={cancel:!1,event:i,node:a};this.trigger("keyPress",l,function(h){if(!h.cancel)switch(i.action){case"space":r.showCheckBox?r.checkNode(i):r.toggleSelect(a,i);break;case"moveRight":r.openNode(!r.enableRtl,i);break;case"moveLeft":r.openNode(!!r.enableRtl,i);break;case"shiftDown":r.shiftKeySelect(!0,i);break;case"moveDown":case"ctrlDown":case"csDown":r.navigateNode(!0);break;case"shiftUp":r.shiftKeySelect(!1,i);break;case"moveUp":case"ctrlUp":case"csUp":r.navigateNode(!1);break;case"home":case"shiftHome":case"ctrlHome":case"csHome":r.navigateRootNode(!0);break;case"end":case"shiftEnd":case"ctrlEnd":case"csEnd":r.navigateRootNode(!1);break;case"enter":case"ctrlEnter":case"shiftEnter":case"csEnter":case"shiftSpace":case"ctrlSpace":r.toggleSelect(a,i);break;case"f2":r.allowEditing&&!a.classList.contains("e-disable")&&r.createTextbox(a);break;case"ctrlA":if(r.allowMultiSelection){var u=dt("."+it+":not(."+xr+")",r.element);r.selectGivenNodes(u)}break}})},t.prototype.navigateToFocus=function(i){var r=this.getFocusedNode().querySelector("."+Ei),n=r.getBoundingClientRect(),a=this.getScrollParent(this.element);if(!m(a)){var o=a.getBoundingClientRect();n.bottom>o.bottom?a.scrollTop+=n.bottom-o.bottom:n.top<o.top&&(a.scrollTop-=o.top-n.top)}var l=this.isVisibleInViewport(r);l||r.scrollIntoView(i)},t.prototype.isVisibleInViewport=function(i){var r=i.getBoundingClientRect();return r.top>=0&&r.left>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth)},t.prototype.getScrollParent=function(i){return m(i)?null:i.scrollHeight>i.clientHeight?i:this.getScrollParent(i.parentElement)},t.prototype.shiftKeySelect=function(i,r){if(this.allowMultiSelection){var n=this.getFocusedNode(),a=i?this.getNextNode(n):this.getPrevNode(n);this.removeHover(),this.setFocusElement(a),this.toggleSelect(a,r,!1),this.navigateToFocus(!i)}else this.navigateNode(i)},t.prototype.checkNode=function(i){var r=this.getFocusedNode(),n=ye("."+ur,r),a=ye(" ."+Gs,n).classList.contains(zi);r.classList.contains("e-disable")||r.getElementsByClassName("e-checkbox-disabled").length===0&&this.validateCheckNode(n,a,r,i)},t.prototype.validateCheckNode=function(i,r,n,a){var o=this,l=X(i,"."+it);this.checkActionNodes=[];var h=r?"false":"true";m(h)||l.setAttribute("aria-checked",h);var u=this.getCheckEvent(l,r?"uncheck":"check",a);this.trigger("nodeChecking",u,function(c){c.cancel||o.nodeCheckingAction(i,r,n,c,a)})},t.prototype.nodeCheckingAction=function(i,r,n,a,o){if(this.checkedElement.indexOf(n.getAttribute("data-uid"))===-1&&(this.checkedElement.push(n.getAttribute("data-uid")),this.autoCheck)){var l=this.getChildNodes(this.treeData,n.getAttribute("data-uid"));l!==null?this.allCheckNode(l,this.checkedElement,null,null,!1):l=null}if(this.changeState(i,r?"uncheck":"check",o,!0),this.autoCheck){this.ensureChildCheckState(n),this.updateOldCheckedData([this.getNodeData(n)]),this.ensureParentCheckState(X(X(n,"."+mt),"."+it));var h=void 0;a.action==="check"?h=!0:a.action==="uncheck"&&(h=!1),this.ensureStateChange(n,h)}this.nodeCheckedEvent(i,r,o)},t.prototype.ensureStateChange=function(i,r){var n=this,a=ye("."+mt,i),o=i.getAttribute("data-uid"),l=this.fields;if(this.dataType===1&&this.autoCheck){var h=new fe(this.treeData).executeLocal(new We().where(l.parentID,"equal",o,!0)),u=h.filter(function(x){return n.checkedNodes.indexOf(x[l.id].toString())!==-1},this);this.checkedNodes.indexOf(o)!==-1&&u.length!==h.length&&this.isFilter&&u.length>0&&(h=u);for(var c=0;c<h.length;c++){var f=h[parseInt(c.toString(),10)][this.fields.id]?h[parseInt(c.toString(),10)][this.fields.id].toString():null,d=h[parseInt(c.toString(),10)][this.fields.isChecked]?h[parseInt(c.toString(),10)][this.fields.isChecked].toString():null;if(this.checkedNodes.indexOf(o)!==-1&&this.checkedNodes.indexOf(f)===-1){this.checkDisabledState(f,h[c]);var p=this.getChildNodes(this.treeData,f);this.getChildItems(p,r),this.parentNodeCheck.indexOf(f)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(f),1)}else if(this.checkedNodes.indexOf(o)===-1&&a===null&&this.checkedNodes.indexOf(f)!==-1){if(this.checkedNodes.splice(this.checkedNodes.indexOf(f),1),d==="true"&&this.updateField(this.treeData,this.fields,f,"isChecked",null),this.checkedNodes.indexOf(o)===-1&&a===null||this.parentNodeCheck.indexOf(f)!==-1){var v=this.getChildNodes(this.treeData,f);this.getChildItems(v,r),this.parentNodeCheck.indexOf(f)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(f),1)}}else{var p=this.getChildNodes(this.treeData,f);this.getChildItems(p,r)}}}else if(this.dataType===1&&!this.autoCheck)if(r)for(var c=0;c<this.treeData.length;c++){var C=this.treeData[parseInt(c.toString(),10)][this.fields.id]?this.treeData[parseInt(c.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(C)===-1&&this.checkDisabledState(C,this.treeData[c])}else{for(var g=new fe(this.treeData).executeLocal(new We().where(l.isChecked,"equal",!0,!1)),c=0;c<g.length;c++){var b=g[parseInt(c.toString(),10)][this.fields.id]?g[parseInt(c.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(b)!==-1&&this.checkedNodes.splice(this.checkedNodes.indexOf(b),1),this.updateField(this.treeData,this.fields,b,"isChecked",null)}this.checkedNodes=[]}else{var p=this.getChildNodes(this.treeData,o);if(p){var y=p.filter(function(w){var S=String(w[Object.keys(w)[0]]);return n.checkedNodes.indexOf(S)!==-1});y.length>0&&p.length&&this.isFilter&&(p=y),this.childStateChange(p,o,a,r)}}},t.prototype.checkDisabledState=function(i,r){var n=this.checkDisabledChildren;if(!n){var a=!0;if(this.loadOnDemand&&this.fields.htmlAttributes&&(r=m(r)?r:this.getNodeObject(i),!m(r))){var o=r[this.fields.htmlAttributes];o&&!m(o.class)&&o.class.indexOf(Ka)!==-1&&(a=!1)}var l=ye('[data-uid="'+i+'"]',this.element);n=l?!l.classList.contains(Ka):this.disableNode.indexOf(i)===-1&&a}n&&this.checkedNodes.push(i)},t.prototype.getChildItems=function(i,r){for(var n=0;n<i.length;n++){var a=i[parseInt(n.toString(),10)][this.fields.id]?i[parseInt(n.toString(),10)][this.fields.id].toString():null,o=i[parseInt(n.toString(),10)][this.fields.isChecked]?i[parseInt(n.toString(),10)][this.fields.isChecked].toString():null;this.checkedNodes.indexOf(a)!==-1&&!r&&this.checkedNodes.splice(this.checkedNodes.indexOf(a),1),this.checkedNodes.indexOf(a)===-1&&r&&this.checkDisabledState(a,i[n]),o==="true"&&!r&&this.updateField(this.treeData,this.fields,a,"isChecked",null);var l=this.getChildNodes(this.treeData,a);l.length>0&&this.getChildItems(l,r)}},t.prototype.childStateChange=function(i,r,n,a){for(var o=0;o<i.length;o++){var l=i[parseInt(o.toString(),10)][this.fields.id]?i[parseInt(o.toString(),10)][this.fields.id].toString():"",h=i[parseInt(o.toString(),10)][this.fields.isChecked]?i[parseInt(o.toString(),10)][this.fields.isChecked].toString():null;this.autoCheck?this.checkedNodes.indexOf(r)!==-1&&this.checkedNodes.indexOf(l)===-1?(this.checkDisabledState(l,i[o]),this.parentNodeCheck.indexOf(l)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(l),1)):this.checkedNodes.indexOf(r)===-1&&this.checkedNodes.indexOf(l)!==-1&&!a&&(this.checkedNodes.splice(this.checkedNodes.indexOf(l),1),h==="true"&&this.updateField(this.treeData,this.fields,l,"isChecked",null)):this.autoCheck||(a?this.checkedNodes.indexOf(l)===-1&&this.checkDisabledState(l,i[o]):(this.checkedNodes.indexOf(l)!==-1&&this.checkedNodes.splice(this.checkedNodes.indexOf(l),1),this.updateField(this.treeData,this.fields,l,"isChecked",null),this.checkedNodes=[]));var u=this.getChildNodes([i[parseInt(o.toString(),10)]],l);u&&this.childStateChange(u,r,n,a)}},t.prototype.allCheckNode=function(i,r,n,a,o){if(i)for(var l=0;l<i.length;l++){var h=ie(this.fields.id,i[parseInt(l.toString(),10)]),u=this.element.querySelector('[data-uid="'+h+'"]');o!==!1&&this.checkedElement.indexOf(h.toString())===-1&&(u===null&&!m(i[parseInt(l.toString(),10)][this.fields.isChecked])&&r.indexOf(h.toString())===-1||a===0||n===2)&&(i[parseInt(l.toString(),10)][this.fields.isChecked]!==!1||n===2?r.push(h.toString()):a=null,a=i[parseInt(l.toString(),10)][this.fields.isChecked]!==!1||n===2?0:null),r.indexOf(h.toString())===-1&&m(n)&&r.push(h.toString());var c=ie(this.fields.child.toString(),i[parseInt(l.toString(),10)]);if(ie(this.fields.hasChildren,i[parseInt(l.toString(),10)])===!0||c){var f=ie(this.fields.id,i[parseInt(l.toString(),10)]),d=void 0;this.dataType===1?d=this.getChildNodes(this.treeData,f.toString()):d=c,d&&(m(o)?this.allCheckNode(d,r,n,a):this.allCheckNode(d,r,n,a,o),a=null)}a=null}},t.prototype.openNode=function(i,r){var n=this.getFocusedNode(),a=ye("div."+vi,n);if(i)if(a)a.classList.contains(gt)?this.expandAction(n,a,r):this.focusNextNode(n,!0);else return;else if(a&&a.classList.contains(Xt))this.collapseNode(n,a,r);else{var o=X(X(n,"."+mt),"."+it);if(o)o.classList.contains("e-disable")||(this.setFocus(n,o),this.navigateToFocus(!0));else return}},t.prototype.navigateNode=function(i){var r=this.getFocusedNode();this.focusNextNode(r,i)},t.prototype.navigateRootNode=function(i){var r=this.getFocusedNode(),n=i?this.getRootNode():this.getEndNode();n.classList.contains("e-disable")||(this.setFocus(r,n),this.navigateToFocus(i))},t.prototype.getFocusedNode=function(){var i,r=ye("."+it+'[tabindex="0"]',this.element);if(!m(r)){var n=r.getAttribute("aria-checked");(n==="mixed"||n==="false")&&(this.isFilter=!1)}return m(r)&&(i=ye("."+it,this.element)),m(r)?m(i)?this.element.firstElementChild:i:r},t.prototype.focusNextNode=function(i,r){var n=r?this.getNextNode(i):this.getPrevNode(i);if(this.setFocus(i,n),this.navigateToFocus(!r),n.classList.contains("e-disable")){var a=n.lastChild;n.previousSibling==null&&n.classList.contains("e-level-1")?this.focusNextNode(n,!0):n.nextSibling==null&&n.classList.contains("e-node-collapsed")?this.focusNextNode(n,!1):n.nextSibling==null&&a.classList.contains(Ei)?this.focusNextNode(n,!1):this.focusNextNode(n,r)}},t.prototype.getNextNode=function(i){var r=this.liList.indexOf(i),n;do if(r++,n=this.liList[parseInt(r.toString(),10)],m(n))return i;while(!ea(n));return n},t.prototype.getPrevNode=function(i){var r=this.liList.indexOf(i),n;do if(r--,n=this.liList[parseInt(r.toString(),10)],m(n))return i;while(!ea(n));return n},t.prototype.getRootNode=function(){var i=0,r;do r=this.liList[parseInt(i.toString(),10)],i++;while(!ea(r));return r},t.prototype.getEndNode=function(){var i=this.liList.length-1,r;do r=this.liList[parseInt(i.toString(),10)],i--;while(!ea(r));return r},t.prototype.setFocus=function(i,r){Z([i],$n),i.setAttribute("tabindex","-1"),r.classList.contains("e-disable")||(P([r],$n),r.setAttribute("tabindex","0"),r.focus(),R.add(r,"blur",this.focusOut,this),this.updateIdAttr(i,r))},t.prototype.updateIdAttr=function(i,r){this.element.removeAttribute("aria-activedescendant"),i&&i.removeAttribute("id"),r.setAttribute("id",this.element.id+"_active"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active")},t.prototype.focusIn=function(){if(!this.mouseDownStatus){var i=this.getFocusedNode();i.classList.contains("e-disable")?(i.setAttribute("tabindex","-1"),this.navigateNode(!0)):(i.setAttribute("tabindex","0"),P([i],$n),R.add(i,"blur",this.focusOut,this)),this.mouseDownStatus=!1}},t.prototype.focusOut=function(i){var r=this.getFocusedNode();i.target===r&&(Z([r],$n),R.remove(r,"blur",this.focusOut))},t.prototype.onMouseOver=function(i){if(!xe.isDevice){var r=i.target,n=r.classList,a=X(r,"."+it);if(!a||n.contains(mt)||n.contains(it)){this.removeHover();return}else a&&!a.classList.contains("e-disable")&&this.setHover(a)}},t.prototype.setHover=function(i){!i.classList.contains(gu)&&!i.classList.contains(ul)&&(this.removeHover(),P([i],gu))},t.prototype.onMouseLeave=function(){this.removeHover()},t.prototype.removeHover=function(){var i=dt("."+gu,this.element);i&&i.length&&Z(i,gu)},t.prototype.getNodeData=function(i,r){if(!m(i)&&i.classList.contains(it)&&!m(X(i,"."+Eb))&&X(i,"."+Eb).classList.contains(Jr)){var n=i.getAttribute("data-uid"),a=this.getText(i,r),o=X(i.parentNode,"."+it),l=o?o.getAttribute("data-uid"):null,h=i.classList.contains(xr),u=!i.classList.contains(ul),c=i.getAttribute("aria-expanded")==="true",f=i.getAttribute("aria-expanded")!==null?!0:(ye("."+gt,i)||ye("."+Xt,i))!=null,d=null,p=ye("."+ur,i);return this.showCheckBox&&p&&(d=i.getAttribute("aria-checked")),{id:n,text:a,parentID:l,selected:h,selectable:u,expanded:c,isChecked:d,hasChildren:f}}return{id:"",text:"",parentID:"",selected:!1,expanded:!1,isChecked:"",hasChildren:!1}},t.prototype.getText=function(i,r){if(r){var n=this.getNodeObject(i.getAttribute("data-uid")),a=parseFloat(i.getAttribute("aria-level")),o=this.getFields(this.fields,a,1);return ie(o.text,n)}return ye("."+Un,i).textContent},t.prototype.getExpandEvent=function(i,r){var n=this.getNodeData(i);return{cancel:!1,isInteracted:!m(r),node:i,nodeData:n,event:r}},t.prototype.renderNodeTemplate=function(i,r,n){var a=this.nodeTemplateFn(i,this,"nodeTemplate"+n,this.element.id+"nodeTemplate",this.isStringTemplate,void 0,r,this.root);a&&(a=Array.prototype.slice.call(a),at(a,r))},t.prototype.destroyTemplate=function(i){this.clearTemplate(["nodeTemplate"+i.getAttribute("data-uid")])},t.prototype.reRenderNodes=function(){this.updateListProp(this.fields),xe.isIE?(this.ulElement=this.element.querySelector(".e-list-parent.e-ul"),this.ulElement.parentElement.removeChild(this.ulElement)):this.element.innerHTML="",m(this.nodeTemplateFn)||this.clearTemplate(),this.setTouchClass(),this.setProperties({selectedNodes:[],checkedNodes:[],expandedNodes:[]},!0),this.checkedElement=[],this.isLoaded=!1,this.setDataBinding(!0)},t.prototype.setCssClass=function(i,r){!m(i)&&i!==""&&Z([this.element],i.split(" ")),!m(r)&&r!==""&&P([this.element],r.split(" "))},t.prototype.editingHandler=function(i){var r=i.target;if(!(!r||r.classList.contains(Jr)||r.classList.contains(mt)||r.classList.contains(it)||r.classList.contains(vi)||r.classList.contains(yu)||r.classList.contains(Sb))){var n=X(r,"."+it);this.createTextbox(n)}},t.prototype.createTextbox=function(i){var r=this,n=ye("."+xu,this.element);n&&n.blur();var a=ye("."+Un,i);this.updateOldText(i);var o=this.createElement("input",{className:xu,attrs:{value:this.oldText}}),l=this.getEditEvent(i,null,o.outerHTML);this.trigger("nodeEditing",l,function(h){if(!h.cancel){var u=a.offsetWidth+5,c=u+"px";P([i],ud),m(r.nodeTemplateFn)||r.destroyTemplate(i),r.isReact?setTimeout(function(){r.renderTextBox(l,a,c)},5):r.renderTextBox(l,a,c)}})},t.prototype.renderTextBox=function(i,r,n){r.innerHTML=i.innerHtml;var a=ye("."+xu,r);this.inputObj=Te.createInput({element:a,properties:{enableRtl:this.enableRtl}},this.createElement),this.inputObj.container.style.width=n,a.focus();var o=a;o.setSelectionRange(0,o.value.length),this.wireInputEvents(a)},t.prototype.updateOldText=function(i){var r=i.getAttribute("data-uid");this.editData=this.getNodeObject(r);var n=parseFloat(i.getAttribute("aria-level"));this.editFields=this.getFields(this.fields,n,1),this.oldText=ie(this.editFields.text,this.editData)},t.prototype.inputFocusOut=function(i){if(ye("."+xu,this.element)){var r=i.target,n=r.value,a=X(r,"."+Un),o=X(r,"."+it);Oe(this.inputObj.container),Te.destroy({element:r,properties:this.properties}),this.fields.dataSource instanceof fe&&!this.isOffline?this.crudOperation("update",null,o,n,null,null,!0):this.appendNewText(o,a,n,!0),R.remove(r,"blur",this.inputFocusOut),this.inputObj=null,Oe(r),r=null}},t.prototype.appendNewText=function(i,r,n,a){var o=this,l=this.getEditEvent(i,n,null);this.trigger("nodeEdited",l,function(h){n=h.cancel?h.oldText:h.newText,o.updateText(i,r,n,a),h.oldText!==n&&o.triggerEvent("nodeEdited",[o.getNode(i)])})},t.prototype.updateText=function(i,r,n,a){var o=It(this.editFields.text,n,this.editData);if(m(this.nodeTemplateFn))this.enableHtmlSanitizer?r.innerText=mr.sanitize(n):r.innerHTML=n;else{r.innerText="";var l=i.getAttribute("data-uid");this.renderNodeTemplate(o,r,l),this.renderReactTemplates()}a&&(Z([i],ud),i.focus(),R.add(i,"blur",this.focusOut,this),P([i],$n)),this.allowTextWrap&&this.calculateWrap(i)},t.prototype.getElement=function(i){return m(i)?null:typeof i=="string"?this.element.querySelector('[data-uid="'+i+'"]'):typeof i=="object"?v0(i):null},t.prototype.getId=function(i){return m(i)?null:typeof i=="string"?i:typeof i=="object"?v0(i).getAttribute("data-uid"):null},t.prototype.getEditEvent=function(i,r,n){var a=this.getNodeData(i);return{cancel:!1,newText:r,node:i,nodeData:a,oldText:this.oldText,innerHtml:n}},t.prototype.getNodeObject=function(i){var r;if(m(i))return r;if(this.dataType===1)for(var n=0,a=this.treeData.length;n<a;n++){var o=ie(this.fields.id,this.treeData[parseInt(n.toString(),10)]);if(!m(this.treeData[parseInt(n.toString(),10)])&&!m(o)&&o.toString()===i)return this.treeData[parseInt(n.toString(),10)]}else return this.getChildNodeObject(this.treeData,this.fields,i);return r},t.prototype.getChildNodeObject=function(i,r,n){var a;if(m(i))return a;for(var o=0,l=i.length;o<l;o++){var h=ie(r.id,i[parseInt(o.toString(),10)]);if(i[parseInt(o.toString(),10)]&&h&&h.toString()===n)return i[parseInt(o.toString(),10)];if(typeof r.child=="string"&&!m(ie(r.child,i[parseInt(o.toString(),10)]))){var u=ie(r.child,i[parseInt(o.toString(),10)]);if(a=this.getChildNodeObject(u,this.getChildMapper(r),n),a!==void 0)break}else if(this.fields.dataSource instanceof fe&&!m(ie("child",i[parseInt(o.toString(),10)]))){var c="child";if(a=this.getChildNodeObject(ie(c,i[parseInt(o.toString(),10)]),this.getChildMapper(r),n),a!==void 0)break}else if(this.isChildObject()){var f="child",u=ie(f,i[parseInt(o.toString(),10)]);if(a=this.getChildNodeObject(u,this.getChildMapper(r),n),a!==void 0)break}}return a},t.prototype.setDragAndDrop=function(i){i&&!this.disabled?this.initializeDrag():this.destroyDrag()},t.prototype.initializeDrag=function(){var i=this,r;this.dragObj=new F1(this.element,{enableTailMode:!0,enableAutoScroll:!0,dragArea:this.dragArea,dragTarget:"."+Ei,enableTapHold:!0,tapHoldThreshold:100,helper:function(n){i.dragTarget=n.sender.target;var a=X(i.dragTarget,"."+Jr),o=X(i.dragTarget,"."+Ei);if(i.dragLi=X(i.dragTarget,"."+it),i.fullRowSelect&&!o&&i.dragTarget.classList.contains(qs)&&(o=i.dragTarget.nextElementSibling),!i.dragTarget||!n.element.isSameNode(a)||!o||i.dragTarget.classList.contains(Jr)||i.dragTarget.classList.contains(mt)||i.dragTarget.classList.contains(it)||i.dragLi.classList.contains("e-disable"))return!1;var l=o.cloneNode(!0);if(m(ye("div."+vi,l))){var h=i.createElement("div",{className:vi+" "+gt});l.insertBefore(h,l.children[0])}var u=fH+" "+Jr+" "+i.cssClass+" "+(i.enableRtl?kb:"");r=i.createElement("div",{className:u}),r.appendChild(l);var c=i.selectedNodes.length;if(c>1&&i.allowMultiSelection&&i.dragLi.classList.contains(xr)){var f=i.createElement("span",{className:pH,innerHTML:""+c});r.appendChild(f)}return document.body.appendChild(r),document.body.style.cursor="",i.dragData=i.getNodeData(i.dragLi),r},dragStart:function(n){P([i.element],cd);var a=X(n.target,".e-list-item"),o;a&&(o=parseInt(a.getAttribute("aria-level"),10));var l=i.getDragEvent(n.event,i,null,n.target,null,r,o);l.draggedNode.classList.contains(ud)?(i.dragObj.intDestroy(n.event),i.dragCancelAction(r)):i.trigger("nodeDragStart",l,function(h){h.cancel?(i.dragObj.intDestroy(n.event),i.dragCancelAction(r)):i.dragStartAction=!0})},drag:function(n){i.dragObj.setProperties({cursorAt:{top:!m(n.event.targetTouches)||xe.isDevice?60:-20}}),i.dragAction(n,r)},dragStop:function(n){Z([i.element],cd),n.target.classList.contains("e-sibling")||i.removeVirtualEle();var a=n.target,o=!1,l=X(a,"."+Ab);(!a||!l)&&(Oe(n.helper),document.body.style.cursor="");var h=X(a,".e-list-item"),u;h&&(u=parseInt(h.getAttribute("aria-level"),10));var c=i.getDragEvent(n.event,i,a,a,null,n.helper,u);c.preventTargetExpand=o,i.trigger("nodeDragStop",c,function(f){i.dragParent=f.draggedParentNode,i.preventExpand=f.preventTargetExpand,f.cancel&&(n.helper.parentNode&&Oe(n.helper),document.body.style.cursor="",a.classList.contains("e-sibling")&&i.removeVirtualEle()),i.dragStartAction=!1})}}),this.dropObj=new PS(this.element,{out:function(n){!m(n)&&!n.target.classList.contains(ll)&&i.dropObj.dragData.default&&i.dropObj.dragData.default.helper.classList.contains(Jr)&&(document.body.style.cursor="not-allowed")},over:function(){document.body.style.cursor=""},drop:function(n){i.dropAction(n),i.removeVirtualEle()}})},t.prototype.dragCancelAction=function(i){Oe(i),Z([this.element],cd),this.dragStartAction=!1},t.prototype.getOffsetX=function(i,r){var n=i.changedTouches;return n&&n.length>0?n[0].clientX-r.getBoundingClientRect().left:i.offsetX},t.prototype.getOffsetY=function(i,r){var n=i.changedTouches;return n&&n.length>0?n[0].clientY-r.getBoundingClientRect().top:i.offsetY},t.prototype.dragAction=function(i,r){var n=X(i.target,"."+Ab),a=X(i.target,"."+Ei),o=ye("div."+vi,r);Z([o],[Cu,hl,fd,dd]),this.isDropIn=!1,this.removeVirtualEle(),document.body.style.cursor="";var l=i.target.classList,h=i.event,u=this.getOffsetY(h,i.target),c=this.getOffsetX(h,i.target);if(this.fullRowSelect&&!a&&!m(l)&&l.contains(qs)&&(a=i.target.nextElementSibling),n){var f=X(i.target,"."+it),d=X(i.target,"."+ur),p=X(i.target,"."+Xt),v=X(i.target,"."+gt);if(!n.classList.contains(Jr)||a&&!f.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,f))if(this.hasTemplate&&f){var g=ye(this.fullRowSelect?"."+qs:"."+Ei,f);if(i&&!v&&!p&&u<7&&!d||v&&u<5||p&&c<3){var b=this.fullRowSelect?1:0;this.appendIndicator(f,o,b)}else if(i&&!v&&!p&&!d&&g&&u>g.offsetHeight-10||v&&u>19||p&&c>19){var b=this.fullRowSelect?2:1;this.appendIndicator(f,o,b)}else P([o],Cu),this.isDropIn=!0}else if(f&&i&&!v&&!p&&u<7&&!d||v&&u<5||p&&c<3){var b=this.fullRowSelect?1:0;this.appendIndicator(f,o,b)}else if(f&&i&&!v&&!p&&i.target.offsetHeight>0&&u>i.target.offsetHeight-10&&!d||v&&u>19||p&&c>19){var b=this.fullRowSelect?2:1;this.appendIndicator(f,o,b)}else P([o],Cu),this.isDropIn=!0;else i.target.nodeName==="LI"&&!f.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,f)?(P([o],hl),this.renderVirtualEle(i)):i.target.classList.contains(ll)?P([o],hl):P([o],fd)}else P([o],dd),document.body.style.cursor="not-allowed";var C=X(i.target,".e-list-item"),y;C&&(y=parseInt(C.getAttribute("aria-level"),10));var x=this.getDragEvent(i.event,this,i.target,i.target,null,r,y);x.dropIndicator&&Z([o],x.dropIndicator),this.trigger("nodeDragging",x),x.dropIndicator&&P([o],x.dropIndicator)},t.prototype.appendIndicator=function(i,r,n){P([r],hl);var a=this.createElement("div",{className:ll});i.insertBefore(a,i.children[parseInt(n.toString(),10)])},t.prototype.dropAction=function(i){for(var r=i.event,n=this.getOffsetY(r,i.target),a=i.target,o,l,h=!1,u=[],c=[],f=i.dragData.draggable,d=0;d<f.ej2_instances.length;d++)if(f.ej2_instances[parseInt(d.toString(),10)]instanceof e){o=f.ej2_instances[parseInt(d.toString(),10)];break}if(o&&o.dragTarget){var p=o.dragTarget,v=X(p,"."+it),g=X(a,"."+it);if(c.push(v),g==null&&a.classList.contains(Jr)&&(g=a.firstElementChild),Oe(i.droppedElement),document.body.style.cursor="",!g||g.isSameNode(v)||this.isDescendant(v,g)){this.fields.dataSource instanceof fe||(this.preventExpand=!1);return}if(o.allowMultiSelection&&v.classList.contains(xr)){var b=dt("."+xr,o.element);if(c=b,i.target.offsetHeight<=33&&n>i.target.offsetHeight-10&&n>6)for(var d=b.length-1;d>=0;d--)g.isSameNode(b[parseInt(d.toString(),10)])||this.isDescendant(b[parseInt(d.toString(),10)],g)||this.appendNode(a,b[parseInt(d.toString(),10)],g,i,o,n);else for(var d=0;d<b.length;d++)g.isSameNode(b[parseInt(d.toString(),10)])||this.isDescendant(b[parseInt(d.toString(),10)],g)||this.appendNode(a,b[parseInt(d.toString(),10)],g,i,o,n)}else this.appendNode(a,v,g,i,o,n);l=parseInt(v.getAttribute("aria-level"),10),h=!0}this.fields.dataSource instanceof fe||(this.preventExpand=!1);for(var d=0;d<c.length;d++)u.push(this.getNode(c[parseInt(d.toString(),10)]));this.trigger("nodeDropped",this.getDragEvent(i.event,o,a,i.target,i.dragData.draggedElement,null,l,h)),o.element.id!==this.element.id&&(o.triggerEvent("nodeDropped",u),this.isNodeDropped=!0,this.fields.dataSource=this.treeData),this.triggerEvent("nodeDropped",u)},t.prototype.appendNode=function(i,r,n,a,o,l){var h=X(i,"."+ur),u=X(a.target,"."+Xt),c=X(a.target,"."+gt);!r.classList.contains("e-disable")&&!h&&(c&&a.event.offsetY<5||u&&a.event.offsetX<3||c&&a.event.offsetY>19||u&&a.event.offsetX>19||!c&&!u)?i.nodeName==="LI"?this.dropAsSiblingNode(r,n,a,o):i.firstElementChild&&i.classList.contains(Jr)?i.firstElementChild.nodeName==="UL"&&this.dropAsSiblingNode(r,n,a,o):i.classList.contains("e-icon-collapsible")||i.classList.contains("e-icon-expandable")?this.dropAsSiblingNode(r,n,a,o):this.dropAsChildNode(r,n,o,null,a,l,null,i):this.dropAsChildNode(r,n,o,null,a,l,!0,i),this.showCheckBox&&this.ensureIndeterminate()},t.prototype.dropAsSiblingNode=function(i,r,n,a){var o=X(r,"."+mt),l=X(i,"."+mt),h=X(l,"."+it),u;if(n.target.offsetHeight>0&&n.event.offsetY>n.target.offsetHeight-2?u=!1:n.event.offsetY<2?u=!0:(n.target.classList.contains("e-icon-expandable")||n.target.classList.contains("e-icon-collapsible"))&&(n.event.offsetY<5||n.event.offsetX<3?u=!0:(n.event.offsetY>15||n.event.offsetX>17)&&(u=!1)),n.target.classList.contains("e-icon-expandable")||n.target.classList.contains("e-icon-collapsible")){var c=n.target.closest("li");o.insertBefore(i,u?c:c.nextElementSibling)}else o.insertBefore(i,u?n.target:n.target.nextElementSibling);this.moveData(i,r,o,u,a),this.updateElement(l,h),this.updateAriaLevel(i),a.element.id===this.element.id?this.updateList():(a.updateInstance(),this.updateInstance())},t.prototype.dropAsChildNode=function(i,r,n,a,o,l,h,u){var c=X(i,"."+mt),f=X(c,"."+it),d=X(r,"."+mt),p;if(o&&o.target&&(p=ye(this.fullRowSelect?"."+qs:"."+Ei,r)),o&&(l<7&&!u.classList.contains("e-sibling")||u.classList.contains("e-sibling")&&!r.lastChild.classList.contains("e-sibling"))&&!h)d.insertBefore(i,r),this.moveData(i,r,d,!0,n);else if(o&&o.target.offsetHeight>0&&l>o.target.offsetHeight-10&&!h&&!this.hasTemplate)d.insertBefore(i,r.nextElementSibling),this.moveData(i,r,d,!1,n);else if(this.hasTemplate&&p&&l>p.offsetHeight-10&&!h)d.insertBefore(i,r.nextElementSibling),this.moveData(i,r,d,!1,n);else{var v=this.expandParent(r),g=m(a)?null:v.childNodes[parseInt(a.toString(),10)];v.insertBefore(i,g),this.moveData(i,g,v,!0,n)}this.updateElement(c,f),this.updateAriaLevel(i),n.element.id===this.element.id?this.updateList():(n.updateInstance(),this.updateInstance())},t.prototype.moveData=function(i,r,n,a,o){var l=X(n,"."+it),h=this.getId(i),u=o.updateChildField(o.treeData,o.fields,h,null,null,!0),c=this.getId(r),f=this.getDataPos(this.treeData,this.fields,c),d=this.getId(l);if(this.dataType===1){this.updateField(this.treeData,this.fields,d,"hasChildren",!0);var p=m(f)?this.treeData.length:a?f:f+1;if(m(d)&&!this.hasPid)delete u[0][this.fields.parentID];else{var v=this.isNumberTypeId?parseFloat(d):d;It(this.fields.parentID,v,u[0])}if(this.treeData.splice(p,0,u[0]),o.element.id!==this.element.id){var g=o.removeChildNodes(h);p++;for(var b=0,C=g.length;b<C;b++)this.treeData.splice(p,0,g[parseInt(b.toString(),10)]),p++;o.groupedData=o.getGroupedData(o.treeData,o.fields.parentID)}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.addChildData(this.treeData,this.fields,d,u,a?f:f+1)},t.prototype.expandParent=function(i){var r=ye("div."+gt+", div."+Xt,i);r&&r.classList.contains(gt)&&this.preventExpand!==!0&&this.expandAction(i,r,null);var n=ye("."+mt,i);if(this.preventExpand===!0&&!n&&r&&this.renderChildNodes(i),n=ye("."+mt,i),!m(n)&&this.preventExpand&&i.getAttribute("aria-expanded")!=="true"&&(n.style.display="none"),!m(n)&&this.preventExpand===!1&&(n.style.display="block"),m(n)&&this.preventExpand===!0){m(r)&&Ft.generateIcon(this.createElement,i,gt,this.listBaseOption);var a=ye("div."+gt+", div."+Xt,i);a&&a.classList.add("e-icon-expandable"),n=Ft.generateUL(this.createElement,[],null,this.listBaseOption),i.appendChild(n),a?Z([a],Xt):Ft.generateIcon(this.createElement,i,gt,this.listBaseOption),i.setAttribute("aria-expanded","false"),n.style.display="none"}if(m(n)){var o=this.expandArgs;(m(o)||o&&o.name!=="nodeExpanding")&&this.trigger("nodeExpanding",this.getExpandEvent(i,null)),m(r)&&Ft.generateIcon(this.createElement,i,Xt,this.listBaseOption);var a=ye("div."+gt+", div."+Xt,i);a?Z([a],gt):(Ft.generateIcon(this.createElement,i,Xt,this.listBaseOption),a=ye("div."+vi,i),Z([a],gt)),n=Ft.generateUL(this.createElement,[],null,this.listBaseOption),i.appendChild(n),this.addExpand(i),this.trigger("nodeExpanded",this.getExpandEvent(i,null))}var l=ye("div."+Xt,i);return!m(n)&&l&&this.preventExpand&&i.getAttribute("aria-expanded")!=="true"&&(Z([l],Xt),i.setAttribute("aria-expanded","false"),P([l],gt)),n},t.prototype.updateElement=function(i,r){if(r&&i.childElementCount===0){var n=ye("div."+vi,r);Oe(i),Oe(n);var a=this.getId(r);this.updateField(this.treeData,this.fields,a,"hasChildren",!1),this.removeExpand(r,!0)}},t.prototype.updateAriaLevel=function(i){var r=this.parents(i,"."+mt).length;i.setAttribute("aria-level",""+r),this.updateChildAriaLevel(ye("."+mt,i),r+1)},t.prototype.updateChildAriaLevel=function(i,r){if(!m(i))for(var n=i.childNodes,a=0,o=n.length;a<o;a++){var l=n[parseInt(a.toString(),10)];l.setAttribute("aria-level",""+r),this.updateChildAriaLevel(ye("."+mt,l),r+1)}},t.prototype.renderVirtualEle=function(i){var r,n=i.event,a=this.getOffsetY(n,i.target);a>i.target.offsetHeight-2?r=!1:a<2&&(r=!0);var o=this.createElement("div",{className:ll}),l=this.fullRowSelect?r?1:2:r?0:1;i.target.insertBefore(o,i.target.children[parseInt(l.toString(),10)])},t.prototype.removeVirtualEle=function(){var i=ye("."+ll);i&&Oe(i)},t.prototype.destroyDrag=function(){this.dragObj&&this.dropObj&&(this.dragObj.destroy(),this.dropObj.destroy())},t.prototype.getDragEvent=function(i,r,n,a,o,l,h,u){var c=n?X(n,"."+it):null,f=c?this.getNodeData(c):null,d=r?r.dragLi:o,p=r?r.dragData:null,v=n?this.parents(n,"."+it):null,g=r.dragLi.parentElement,b=r.dragLi?X(g,"."+it):null,C=null,y=null,x=[hl,Cu,fd,dd],w=null,S=u===!0?d:c,E=S?X(S,".e-list-parent"):null,k=0,A=null;if(b=r.dragLi&&b===null?X(g,"."+Jr):b,b=u===!0?this.dragParent:b,l)for(;k<4;){if(ye("."+vi,l).classList.contains(x[parseInt(k.toString(),10)])){w=x[parseInt(k.toString(),10)];break}k++}if(E){var z=0;for(k=0;k<E.childElementCount;k++)if(z=u!==!0&&E.children[parseInt(k.toString(),10)]===d&&c!==d?++z:z,u!==!0&&E.children[parseInt(k.toString(),10)].classList.contains("e-hover")){y=i.offsetY>=23?k+1:k;break}else if(E.children[parseInt(k.toString(),10)]===S){y=(i.offsetY>=23,k);break}y=z!==0?--y:y,A=this.isDropIn?"Inside":i.offsetY<7?"Before":"After"}if(n&&(v.length===0?C=null:n.classList.contains(it)?C=v[0]:C=v[1]),c===d&&(C=c),n&&a.offsetHeight<=33&&i.offsetY<a.offsetHeight-10&&i.offsetY>6&&(C=c,u!==!0)){h=++h;var D=C?ye(".e-list-parent",C):null;if(y=D?D.children.length:0,!(this.fields.dataSource instanceof fe)&&D===null&&C){var T=C.hasAttribute("data-uid")?this.getChildNodes(this.fields.dataSource,C.getAttribute("data-uid").toString()):null;y=T?T.length:0}}return{cancel:!1,clonedNode:l,event:i,draggedNode:d,draggedNodeData:p,droppedNode:c,droppedNodeData:f,dropIndex:y,dropLevel:h,draggedParentNode:b,dropTarget:C,dropIndicator:w,target:a,position:A}},t.prototype.addFullRow=function(i){var r=this.liList.length;if(i)for(var n=0;n<r;n++)this.createFullRow(this.liList[parseInt(n.toString(),10)]);else for(var n=0;n<r;n++){var a=ye("."+qs,this.liList[parseInt(n.toString(),10)]);Oe(a)}},t.prototype.createFullRow=function(i){var r=this.createElement("div",{className:qs});i.insertBefore(r,i.childNodes[0])},t.prototype.addMultiSelect=function(i){if(i)for(var r=dt("."+it+':not([aria-selected="true"])',this.element),n=0,a=r;n<a.length;n++){var o=a[n];o.setAttribute("aria-selected","false")}else for(var r=dt("."+it+'[aria-selected="false"]',this.element),l=0,h=r;l<h.length;l++){var o=h[l];o.removeAttribute("aria-selected")}},t.prototype.collapseByLevel=function(i,r,n,a){if(a=m(a)?1:a,r>0&&!m(i))for(var o=this.getVisibleNodes(n,i.childNodes),l=0,h=o.length;l<h;l++){var u=o[parseInt(l.toString(),10)],c=ye("."+Xt,ye("."+Ei,u));a>=r&&!m(c)&&this.collapseNode(u,c,null),this.collapseByLevel(ye("."+mt,u),r,n,a+1)}},t.prototype.collapseAllNodes=function(i){for(var r=this.getVisibleNodes(i,dt("."+Xt,this.element)),n=0,a=r.length;n<a;n++){var o=r[parseInt(n.toString(),10)],l=X(o,"."+it);this.collapseNode(l,o,null)}},t.prototype.expandByLevel=function(i,r,n){if(r>0&&!m(i))for(var a=this.getVisibleNodes(n,i.childNodes),o=0,l=a.length;o<l;o++){var h=a[parseInt(o.toString(),10)],u=ye("."+gt,ye("."+Ei,h));m(u)||this.expandAction(h,u,null),this.expandByLevel(ye("."+mt,h),r-1,n)}},t.prototype.expandAllNodes=function(i){for(var r=this.getVisibleNodes(i,dt("."+gt,this.element)),n=0,a=r;n<a.length;n++){var o=a[n],l=X(o,"."+it);this.expandAction(l,o,null,!0,null,!0)}},t.prototype.getVisibleNodes=function(i,r){var n=Array.prototype.slice.call(r);if(i)for(var a=0;a<n.length;a++)ea(n[parseInt(a.toString(),10)])||(n.splice(a,1),a--);return n},t.prototype.removeNode=function(i){var r=X(i,"."+mt),n=X(r,"."+it);m(this.nodeTemplateFn)||this.destroyTemplate(i),Oe(i),this.updateElement(r,n),this.removeData(i)},t.prototype.updateInstance=function(){this.updateList(),this.updateSelectedNodes(),this.updateExpandedNodes()},t.prototype.updateList=function(){this.liList=Array.prototype.slice.call(dt("."+it,this.element))},t.prototype.updateSelectedNodes=function(){this.setProperties({selectedNodes:[]},!0);var i=dt("."+xr,this.element);this.selectGivenNodes(i)},t.prototype.updateExpandedNodes=function(){this.setProperties({expandedNodes:[]},!0);for(var i=dt('[aria-expanded="true"]',this.element),r=0,n=i.length;r<n;r++)this.addExpand(i[parseInt(r.toString(),10)])},t.prototype.removeData=function(i){if(this.dataType===1){var r=new fe(this.treeData),n=this.getId(i),a={},o=this.isNumberTypeId?parseFloat(n):n;a[this.fields.id]=o,r.remove(this.fields.id,a),this.removeChildNodes(n)}else{var n=this.getId(i);this.updateChildField(this.treeData,this.fields,n,null,null,!0)}},t.prototype.removeChildNodes=function(i){for(var r=this.getChildGroup(this.groupedData,i,!1),n=[],a=0,o=r.length;a<o;a++){var l=new fe(this.treeData),h=ie(this.fields.id,r[parseInt(a.toString(),10)]).toString(),u={},c=this.isNumberTypeId?parseFloat(h):h;u[this.fields.id]=c;var f=l.remove(this.fields.id,u);n.push(f[0]),this.removeChildNodes(h)}return n},t.prototype.doGivenAction=function(i,r,n){for(var a=0,o=i.length;a<o;a++){var l=this.getElement(i[parseInt(a.toString(),10)]);if(!m(l)){var h=ye("."+r,ye("."+Ei,l));m(h)||(n?this.expandAction(l,h,null):this.collapseNode(l,h,null))}}},t.prototype.addGivenNodes=function(i,r,n,a,o){if(i.length!==0){var l=this.getSortedData(i),h=r?parseFloat(r.getAttribute("aria-level"))+1:1;a&&this.updateMapper(h);var u=Ft.createListItemFromJson(this.createElement,l,this.listBaseOption,h),c=this.getId(r),f;m(r)||(f=ye("div."+vi,r)),this.dataType===1&&f&&f.classList.contains(gt)&&this.preventExpand&&!m(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")&&(this.preventExpand=!0),this.dataType!==1&&(this.addChildData(this.treeData,this.fields,c,i,n),this.isFirstRender=!1);var d;o?d=o:d=r?this.expandParent(r):ye("."+mt,this.element);var p=m(n)?null:d.childNodes[parseInt(n.toString(),10)];if(!this.isFirstRender||this.dataType===1){var v=this.expandArgs;if(p||this.sortOrder==="None"){for(var g=0;g<u.length;g++)d.insertBefore(u[parseInt(g.toString(),10)],p);if(this.dataType===1&&!m(r)&&!this.preventExpand&&!m(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")){this.preventExpand=!1;var b=ye("div."+vi,r);b&&b.classList.contains(gt)&&(m(v)||v.name!=="nodeExpanding")&&this.expandAction(r,b,null)}}if(!p&&(this.sortOrder==="Ascending"||this.sortOrder==="Descending"))if(d.childNodes.length===0){for(var g=0;g<u.length;g++)d.insertBefore(u[parseInt(g.toString(),10)],p);if(this.dataType===1&&!m(r)&&!this.preventExpand&&!m(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")){this.preventExpand=!1;var b=ye("div."+vi,r);b&&b.classList.contains(gt)&&(m(v)||v.name!=="nodeExpanding")&&this.expandAction(r,b,null)}}else for(var C=d.childNodes,g=0;g<u.length;g++)for(var y=0;y<C.length;y++){var x=this.sortOrder==="Ascending"?C[parseInt(y.toString(),10)].textContent.toUpperCase()>u[parseInt(g.toString(),10)].innerText.toUpperCase():C[parseInt(y.toString(),10)].textContent.toUpperCase()<u[parseInt(g.toString(),10)].innerText.toUpperCase();if(x){d.insertBefore(u[parseInt(g.toString(),10)],C[parseInt(y.toString(),10)]);break}d.insertBefore(u[parseInt(g.toString(),10)],C[C.length])}}if(this.dataType===1){this.updateField(this.treeData,this.fields,c,"hasChildren",!0);for(var w=this.getId(p),S=m(w)?this.treeData.length:this.getDataPos(this.treeData,this.fields,w),y=0;y<i.length;y++){if(!m(c)){var E=this.isNumberTypeId?parseFloat(c):c;It(this.fields.parentID,E,i[parseInt(y.toString(),10)])}this.treeData.splice(S,0,i[parseInt(y.toString(),10)]),S++}}this.finalizeNode(d)}},t.prototype.updateMapper=function(i){var r=i===1?this.fields:this.getChildFields(this.fields,i-1,1);this.updateListProp(r)},t.prototype.updateListProp=function(i){var r=this.getActualProperties(i);this.listBaseOption.fields=r,this.listBaseOption.fields.url=Object.prototype.hasOwnProperty.call(r,"navigateUrl")?r.navigateUrl:"navigateUrl"},t.prototype.getDataPos=function(i,r,n){for(var a=null,o=0,l=i.length;o<l;o++){var h=ie(r.id,i[parseInt(o.toString(),10)]);if(i[parseInt(o.toString(),10)]&&h&&h.toString()===n)return o;if(typeof r.child=="string"&&!m(ie(r.child,i[parseInt(o.toString(),10)]))){var u=ie(r.child,i[parseInt(o.toString(),10)]);if(a=this.getDataPos(u,this.getChildMapper(r),n),a!==null)break}else if(this.fields.dataSource instanceof fe&&!m(ie("child",i[parseInt(o.toString(),10)]))){var c=ie("child",i[parseInt(o.toString(),10)]);if(a=this.getDataPos(c,this.getChildMapper(r),n),a!==null)break}}return a},t.prototype.addChildData=function(i,r,n,a,o){var l;if(m(n)){o=m(o)?i.length:o;for(var h=0,u=a.length;h<u;h++)i.splice(o,0,a[parseInt(h.toString(),10)]),o++;return l}for(var c=0,f=i.length;c<f;c++){var d=ie(r.id,i[parseInt(c.toString(),10)]);if(i[parseInt(c.toString(),10)]&&d&&d.toString()===n){if(typeof r.child=="string"&&Object.prototype.hasOwnProperty.call(i[parseInt(c.toString(),10)],r.child)&&i[parseInt(c.toString(),10)][r.child]!==null||this.fields.dataSource instanceof fe&&Object.prototype.hasOwnProperty.call(i[parseInt(c.toString(),10)],"child")){var p=typeof r.child=="string"?r.child:"child",v=ie(p,i[parseInt(c.toString(),10)]);m(v)&&(v=[]),o=m(o)?v.length:o;for(var h=0,u=a.length;h<u;h++)v.splice(o,0,a[parseInt(h.toString(),10)]),o++}else{var p=typeof r.child=="string"?r.child:"child";i[parseInt(c.toString(),10)][""+p]=a}return!0}else if(typeof r.child=="string"&&!m(ie(r.child,i[parseInt(c.toString(),10)]))){var g=ie(r.child,i[parseInt(c.toString(),10)]);if(l=this.addChildData(g,this.getChildMapper(r),n,a,o),l!==void 0)break}else if(this.fields.dataSource instanceof fe&&!m(ie("child",i[parseInt(c.toString(),10)]))){var v=ie("child",i[parseInt(c.toString(),10)]);if(l=this.addChildData(v,this.getChildMapper(r),n,a,o),l!==void 0)break}}return l},t.prototype.doDisableAction=function(i){var r=this.nodeType(i),n=this.checkValidId(r);this.validArr=[];for(var a=0,o=n.length;a<o;a++){var l=n[parseInt(a.toString(),10)][this.fields.id].toString();l&&this.disableNode.indexOf(l)===-1&&this.disableNode.push(l);var h=this.getElement(l);h&&(h.setAttribute("aria-disabled","true"),P([h],Ka))}},t.prototype.doEnableAction=function(i){for(var r=this.nodeType(i),n=0,a=r.length;n<a;n++){var o=this.getElement(r[parseInt(n.toString(),10)]),l=r[parseInt(n.toString(),10)];l&&this.disableNode.indexOf(l)!==-1&&this.disableNode.splice(this.disableNode.indexOf(l),1),o&&(o.removeAttribute("aria-disabled"),Z([o],Ka))}},t.prototype.nodeType=function(i){for(var r=[],n=0,a=i.length;n<a;n++){var o=void 0;typeof i[parseInt(n.toString(),10)]=="string"?o=i[parseInt(n.toString(),10)]?i[parseInt(n.toString(),10)].toString():null:typeof i[parseInt(n.toString(),10)]=="object"&&(o=i[parseInt(n.toString(),10)]?i[parseInt(n.toString(),10)].getAttribute("data-uid").toString():null),r.indexOf(o)===-1&&r.push(o)}return r},t.prototype.checkValidId=function(i){var r=this;if(this.dataType===1)this.validArr=this.treeData.filter(function(l){return i.indexOf(l[r.fields.id]?l[r.fields.id].toString():null)!==-1});else if(this.dataType===2)for(var n=0;n<this.treeData.length;n++){var a=this.treeData[parseInt(n.toString(),10)][this.fields.id]?this.treeData[parseInt(n.toString(),10)][this.fields.id].toString():null;i.indexOf(a)!==-1&&this.validArr.push(this.treeData[parseInt(n.toString(),10)]);var o=ie(this.fields.child.toString(),this.treeData[parseInt(n.toString(),10)]);o&&this.filterNestedChild(o,i)}return this.validArr},t.prototype.filterNestedChild=function(i,r){for(var n=0;n<i.length;n++){var a=i[parseInt(n.toString(),10)][this.fields.id]?i[parseInt(n.toString(),10)][this.fields.id].toString():null;r.indexOf(a)!==-1&&this.validArr.push(i[parseInt(n.toString(),10)]);var o=ie(this.fields.child.toString(),i[parseInt(n.toString(),10)]);o&&this.filterNestedChild(o,r)}},t.prototype.setTouchClass=function(){var i=X(this.element,"."+gH);this.touchClass=m(i)?"":bH},t.prototype.updatePersistProp=function(){this.removeField(this.treeData,this.fields,["selected","expanded"]);for(var i=this.selectedNodes,r=0,n=i.length;r<n;r++)this.updateField(this.treeData,this.fields,i[parseInt(r.toString(),10)],"selected",!0);for(var a=this.expandedNodes,o=0,l=a.length;o<l;o++)this.updateField(this.treeData,this.fields,a[parseInt(o.toString(),10)],"expanded",!0);if(this.showCheckBox){this.removeField(this.treeData,this.fields,["isChecked"]);for(var h=this.checkedNodes,u=0,l=h.length;u<l;u++)this.updateField(this.treeData,this.fields,h[parseInt(u.toString(),10)],"isChecked",!0)}},t.prototype.removeField=function(i,r,n){if(!(m(i)||m(r)))for(var a=0,o=i.length;a<o;a++){for(var l=0;l<n.length;l++){var h=this.getMapperProp(r,n[parseInt(l.toString(),10)]);m(i[parseInt(a.toString(),10)][""+h])||delete i[parseInt(a.toString(),10)][""+h]}typeof r.child=="string"&&!m(ie(r.child,i[parseInt(a.toString(),10)]))?this.removeField(ie(r.child,i[parseInt(a.toString(),10)]),this.getChildMapper(r),n):this.fields.dataSource instanceof fe&&!m(ie("child",i[parseInt(a.toString(),10)]))&&this.removeField(ie("child",i[parseInt(a.toString(),10)]),this.getChildMapper(r),n)}},t.prototype.getMapperProp=function(i,r){switch(r){case"selected":return m(i.selected)?"selected":i.selected;case"expanded":return m(i.expanded)?"expanded":i.expanded;case"isChecked":return m(i.isChecked)?"isChecked":i.isChecked;case"hasChildren":return m(i.hasChildren)?"hasChildren":i.hasChildren;default:return r}},t.prototype.updateField=function(i,r,n,a,o){if(!m(n))if(this.dataType===1){var l=this.isNumberTypeId?parseFloat(n):n,h=new fe(this.treeData).executeLocal(new We().where(r.id,"equal",l,!1));It(this.getMapperProp(r,a),o,h[0])}else this.updateChildField(i,r,n,a,o)},t.prototype.updateChildField=function(i,r,n,a,o,l){var h;if(m(i))return h;for(var u=0,c=i.length;u<c;u++){var f=ie(r.id,i[parseInt(u.toString(),10)]);if(i[parseInt(u.toString(),10)]&&!m(f)&&f.toString()===n)return l?h=i.splice(u,1):(It(this.getMapperProp(r,a),o,i[parseInt(u.toString(),10)]),h=[]),h;if(typeof r.child=="string"&&!m(ie(r.child,i[parseInt(u.toString(),10)]))){var d=ie(r.child,i[parseInt(u.toString(),10)]);if(h=this.updateChildField(d,this.getChildMapper(r),n,a,o,l),h!==void 0)break}else if(this.fields.dataSource instanceof fe&&!m(ie("child",i[parseInt(u.toString(),10)]))){var p=ie("child",i[parseInt(u.toString(),10)]);if(h=this.updateChildField(p,this.getChildMapper(r),n,a,o,l),h!==void 0)break}}return h},t.prototype.triggerEvent=function(i,r){if(this.renderReactTemplates(),i==="addNodes"){for(var n=[],a=0;a<r.length;a++)n.push(this.getNode(this.getElement(m(r[parseInt(a.toString(),10)][this.fields.id])?ie(this.fields.id,r[parseInt(a.toString(),10)]).toString():null)));r=n}var o={data:this.treeData,action:i,nodeData:r};this.trigger("dataSourceChanged",o)},t.prototype.wireInputEvents=function(i){R.add(i,"blur",this.inputFocusOut,this)},t.prototype.wireEditingEvents=function(i){var r=this;i&&!this.disabled?this.touchEditObj=new Dl(this.element,{tap:function(n){r.isDoubleTapped(n)&&n.tapCount===2&&(n.originalEvent.preventDefault(),r.editingHandler(n.originalEvent))}}):this.touchEditObj&&this.touchEditObj.destroy()},t.prototype.wireClickEvent=function(i){var r=this;i?this.touchClickObj=new Dl(this.element,{tap:function(n){r.clickHandler(n)}}):this.touchClickObj&&this.touchClickObj.destroy()},t.prototype.wireExpandOnEvent=function(i){var r=this;i?this.touchExpandObj=new Dl(this.element,{tap:function(n){(r.expandOnType==="Click"||r.expandOnType==="DblClick"&&r.isDoubleTapped(n)&&n.tapCount===2)&&n.originalEvent.which!==3&&r.expandHandler(n)}}):this.touchExpandObj&&this.touchExpandObj.destroy()},t.prototype.mouseDownHandler=function(i){this.mouseDownStatus=!0,(i.shiftKey||i.ctrlKey)&&i.preventDefault(),i.ctrlKey&&this.allowMultiSelection&&R.add(this.element,"contextmenu",this.preventContextMenu,this)},t.prototype.preventContextMenu=function(i){i.preventDefault()},t.prototype.wireEvents=function(){R.add(this.element,"mousedown",this.mouseDownHandler,this),this.wireClickEvent(!0),this.expandOnType!=="None"&&this.wireExpandOnEvent(!0),R.add(this.element,"mouseover",this.onMouseOver,this),R.add(this.element,"mouseout",this.onMouseLeave,this),this.keyboardModule=new gr(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},t.prototype.unWireEvents=function(){R.remove(this.element,"mousedown",this.mouseDownHandler),this.wireClickEvent(!1),this.wireExpandOnEvent(!1),R.remove(this.element,"mouseover",this.onMouseOver),R.remove(this.element,"mouseout",this.onMouseLeave),this.disabled||this.keyboardModule.destroy()},t.prototype.parents=function(i,r){for(var n=[],a=i.parentNode;!m(a);)Ud(a,r)&&n.push(a),a=a.parentNode;return n},t.prototype.isDoubleTapped=function(i){var r=i.originalEvent.target,n;return r&&i.tapCount&&(i.tapCount===1?this.firstTap=X(r,"."+it):i.tapCount===2&&(n=X(r,"."+it))),this.firstTap===n},t.prototype.isDescendant=function(i,r){for(var n=r.parentNode;!m(n);){if(n===i)return!0;n=n.parentNode}return!1},t.prototype.showSpinner=function(i){P([i],bu),Kc({target:i,width:xe.isDevice?16:14},this.createElement),Yc(i)},t.prototype.hideSpinner=function(i){Jc(i),i.innerHTML="",Z([i],bu)},t.prototype.setCheckedNodes=function(i){i=JSON.parse(JSON.stringify(i)),i.length>1&&typeof this.nodeChecked=="function"&&this.nodeChecked.length>0&&(this.isFilter=!0),this.uncheckAll(this.checkedNodes),this.setIndeterminate(i),i.length>0&&this.checkAll(i)},t.prototype.setValidCheckedNode=function(i,r){if(r===void 0&&(r=[]),this.dataType===1){var n=this.fields,a=new fe(this.treeData).executeLocal(new We().where(n.id,"equal",i,!0));if(a[0]&&(this.setChildCheckState(a,i,a[0],r),this.autoCheck)){for(var o=a[0][this.fields.parentID]?a[0][this.fields.parentID].toString():null,l=this.getChildNodes(this.treeData,o),h=0,u=0;u<l.length;u++){var c=l[parseInt(u.toString(),10)][this.fields.id].toString();this.checkedNodes.indexOf(c)!==-1&&h++}h===l.length&&this.checkedNodes.indexOf(o)===-1&&o&&this.checkDisabledState(o)}}else if(this.dataType===2)for(var f=0;f<this.treeData.length;f++){var d=this.treeData[parseInt(f.toString(),10)][this.fields.id]?this.treeData[parseInt(f.toString(),10)][this.fields.id].toString():"";if(d===i&&this.checkedNodes.indexOf(i)===-1){this.checkDisabledState(i);break}var p=ie(this.fields.child.toString(),this.treeData[parseInt(f.toString(),10)]);p&&this.setChildCheckState(p,i,this.treeData[parseInt(f.toString(),10)],r)}},t.prototype.setChildCheckState=function(i,r,n,a){a===void 0&&(a=[]);var o,l=0;if(this.dataType===1){n&&(o=n[this.fields.id]?n[this.fields.id].toString():null);for(var h=0;h<i.length;h++){var u=i[parseInt(h.toString(),10)][this.fields.id]?i[parseInt(h.toString(),10)][this.fields.id].toString():null;n&&o&&this.autoCheck&&this.checkedNodes.indexOf(o)!==-1&&this.checkedNodes.indexOf(u)===-1&&this.checkDisabledState(u,i[h]),u===r&&this.checkedNodes.indexOf(r)===-1&&this.checkDisabledState(r);var c=this.getChildNodes(this.treeData,u),f=a.length===1&&a[0]===u;(c.length===r.length||f)&&this.setChildCheckState(c,r,n)}}else{n&&(o=n[this.fields.id]?n[this.fields.id].toString():"");for(var h=0;h<i.length;h++){var d=i[parseInt(h.toString(),10)][this.fields.id]?i[parseInt(h.toString(),10)][this.fields.id].toString():"",f=[r].length===1&&a.length===0;n&&o&&this.autoCheck&&this.checkedNodes.indexOf(o)!==-1&&this.checkedNodes.indexOf(d)===-1&&(d===r||f)&&this.checkDisabledState(d,i[h]),d===r&&this.checkedNodes.indexOf(r)===-1&&this.checkDisabledState(r);var c=ie(this.fields.child.toString(),i[parseInt(h.toString(),10)]);c&&this.setChildCheckState(c,r,i[parseInt(h.toString(),10)]),this.checkedNodes.indexOf(d)!==-1&&this.autoCheck&&l++,l===i.length&&this.checkedNodes.indexOf(o)===-1&&this.autoCheck&&this.checkDisabledState(o,n)}}},t.prototype.setIndeterminate=function(i){for(var r=0;r<i.length;r++)this.setValidCheckedNode(i[parseInt(r.toString(),10)],i)},t.prototype.updatePosition=function(i,r,n,a){if(this.dataType===1){var o=this.getDataPos(this.treeData,this.fields,i);if(this.treeData.splice(o,1,r),n){this.removeChildNodes(i);for(var l=0;l<a.length;l++)this.treeData.splice(o,0,a[parseInt(l.toString(),10)]),o++}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.updateChildPosition(this.treeData,this.fields,i,[r],void 0)},t.prototype.updateChildPosition=function(i,r,n,a,o){for(var l,h=0,u=i.length;h<u;h++){var c=ie(r.id,i[parseInt(h.toString(),10)]);if(i[parseInt(h.toString(),10)]&&c&&c.toString()===n)return i[parseInt(h.toString(),10)]=a[0],!0;if(typeof r.child=="string"&&!m(ie(r.child,i[parseInt(h.toString(),10)]))){var f=ie(r.child,i[parseInt(h.toString(),10)]);if(l=this.updateChildPosition(f,this.getChildMapper(r),n,a,o),l!==void 0)break}else if(this.fields.dataSource instanceof fe&&!m(ie("child",i[parseInt(h.toString(),10)]))){var d=ie("child",i[parseInt(h.toString(),10)]);if(l=this.updateChildPosition(d,this.getChildMapper(r),n,a,o),l!==void 0)break}}return l},t.prototype.dynamicState=function(){this.setDragAndDrop(this.allowDragAndDrop),this.wireEditingEvents(this.allowEditing),this.disabled?(this.unWireEvents(),this.rippleFn(),this.rippleIconFn()):(this.wireEvents(),this.setRipple())},t.prototype.crudOperation=function(i,r,n,a,o,l,h){var u=this,c=this.fields.dataSource,f=[],d=this.getQuery(this.fields),p=this.fields.id,v,g={addedRecords:[],deletedRecords:[],changedRecords:[]},b=[];r?b=this.nodeType(r):n&&(typeof n=="string"?b[0]=n.toString():typeof n=="object"&&(b[0]=n.getAttribute("data-uid").toString()));for(var C=0,y=b.length;C<y;C++){var x=this.getElement(b[parseInt(C.toString(),10)]);if(!m(x)){var w=this.getNodeObject(b[parseInt(C.toString(),10)]);f.push(w)}}switch(i){case"delete":r.length===1?v=c.remove(p,f[0],d.fromTable,d):(g.deletedRecords=f,v=c.saveChanges(g,p,d.fromTable,d)),v.then(function(){return u.deleteSuccess(b)}).catch(function(E){return u.dmFailure(E)});break;case"update":f[0][this.fields.text]=a,v=c.update(p,f[0],d.fromTable,d),v.then(function(){return u.editSucess(n,a,h)}).catch(function(E){return u.dmFailure(E,n,h)});break;case"insert":if(o.length===1)v=c.insert(o[0],d.fromTable,d);else{for(var S=[],C=0,y=o.length;C<y;C++)S.push(o[parseInt(C.toString(),10)]);g.addedRecords=S,v=c.saveChanges(g,p,d.fromTable,d)}v.then(function(){var E=u.getElement(n);u.addSuccess(o,E,l),u.preventExpand=!1}).catch(function(E){return u.dmFailure(E)});break}},t.prototype.deleteSuccess=function(i){for(var r=[],n=0,a=i.length;n<a;n++){var o=this.getElement(i[parseInt(n.toString(),10)]);r.push(this.getNode(o)),!m(o)&&this.removeNode(o)}this.updateInstance(),this.dataType===1&&(this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)),this.triggerEvent("removeNode",r)},t.prototype.editSucess=function(i,r,n){var a=this.getElement(i),o=ye("."+Un,a);this.appendNewText(a,o,r,n)},t.prototype.addSuccess=function(i,r,n){var a=this,o,l=r?r.querySelector("."+vi):null;r&&l&&l.classList.contains(gt)&&r.querySelector("."+mt)===null?this.renderChildNodes(r,null,function(){o=r.querySelector("."+mt),a.addGivenNodes(i,r,n,!0,o),a.triggerEvent("addNodes",i)}):(this.addGivenNodes(i,r,n,!0),this.triggerEvent("addNodes",i))},t.prototype.dmFailure=function(i,r,n){r&&this.updatePreviousText(r,n),this.trigger("actionFailure",{error:i})},t.prototype.updatePreviousText=function(i,r){var n=this.getElement(i),a=ye("."+Un,n);this.updateText(n,a,this.oldText,r)},t.prototype.getHierarchicalParentId=function(i,r,n){var a=this,o=r.findIndex(function(u){return u[a.fields.id]&&u[a.fields.id].toString()===i});if(o===-1)for(var l=0;l<r.length;l++){var h=ie(this.fields.child.toString(),r[parseInt(l.toString(),10)]);if(!m(h))if(o=h.findIndex(function(u){return u[a.fields.id]&&u[a.fields.id].toString()===i}),o===-1)this.getHierarchicalParentId(i,h,n);else{n.push(r[parseInt(l.toString(),10)][this.fields.id].toString()),this.getHierarchicalParentId(r[parseInt(l.toString(),10)][this.fields.id].toString(),this.treeData,n);break}}return n},t.prototype.onPropertyChanged=function(i,r){for(var n=0,a=Object.keys(i);n<a.length;n++){var o=a[n];switch(o){case"allowDragAndDrop":this.setDragAndDrop(this.allowDragAndDrop);break;case"dragArea":this.allowDragAndDrop&&(this.dragObj.dragArea=this.dragArea);break;case"allowEditing":this.wireEditingEvents(this.allowEditing);break;case"allowMultiSelection":if(this.selectedNodes.length>1){var l=this.getElement(this.selectedNodes[0]);this.isLoaded=!1,this.removeSelectAll(),this.selectNode(l,null),this.isLoaded=!0}this.setMultiSelect(this.allowMultiSelection),this.addMultiSelect(this.allowMultiSelection);break;case"allowTextWrap":this.setTextWrap(),this.updateWrap();break;case"checkedNodes":JSON.stringify(r.checkedNodes)!==JSON.stringify(i.checkedNodes)&&this.showCheckBox&&(this.checkedNodes=r.checkedNodes,this.setCheckedNodes(i.checkedNodes));break;case"autoCheck":this.showCheckBox&&(this.autoCheck=i.autoCheck,this.ensureIndeterminate());break;case"cssClass":this.setCssClass(r.cssClass,i.cssClass);break;case"enableRtl":this.setEnableRtl();break;case"expandedNodes":this.isAnimate=!1,this.setProperties({expandedNodes:[]},!0),this.collapseAll(),this.isInitalExpand=!0,this.setProperties({expandedNodes:m(i.expandedNodes)?[]:i.expandedNodes},!0),this.doExpandAction(),this.isInitalExpand=!1,this.isAnimate=!0;break;case"expandOn":this.wireExpandOnEvent(!1),this.setExpandOnType(),this.expandOnType!=="None"&&!this.disabled&&this.wireExpandOnEvent(!0);break;case"disabled":this.setDisabledMode(),this.dynamicState();break;case"fields":this.isAnimate=!1,this.isFieldChange=!0,this.initialRender=!0,(!this.isReact||this.isReact&&!(this.fields.dataSource instanceof fe))&&(this.element.classList.contains("e-filtering")||(this.DDTTreeData=JSON.parse(JSON.stringify(this.fields.dataSource))),this.reRenderNodes()),this.initialRender=!1,this.isAnimate=!0,this.isFieldChange=!1;break;case"fullRowSelect":this.setFullRow(this.fullRowSelect),this.addFullRow(this.fullRowSelect),this.allowTextWrap&&(this.setTextWrap(),this.updateWrap());break;case"loadOnDemand":if(this.loadOnDemand===!1&&!this.onLoaded){for(var h=this.element.querySelectorAll("li"),u=0;u<h.length;)h[parseInt(u.toString(),10)].getAttribute("aria-expanded")!=="true"&&this.renderChildNodes(h[parseInt(u.toString(),10)],!0,null,!0),u++;this.onLoaded=!0}break;case"nodeTemplate":this.hasTemplate=!1,this.nodeTemplateFn=this.templateComplier(this.nodeTemplate),this.reRenderNodes();break;case"selectedNodes":this.removeSelectAll(),this.setProperties({selectedNodes:i.selectedNodes},!0),this.doSelectionAction();break;case"showCheckBox":case"checkDisabledChildren":this.reRenderNodes();break;case"sortOrder":this.reRenderNodes();break;case"fullRowNavigable":this.setProperties({fullRowNavigable:i.fullRowNavigable},!0),this.listBaseOption.itemNavigable=i.fullRowNavigable,this.reRenderNodes();break}}},t.prototype.destroy=function(){this.clearTemplate(),this.element.removeAttribute("aria-activedescendant"),this.unWireEvents(),this.wireEditingEvents(!1),this.disabled||(this.rippleFn(),this.rippleIconFn()),this.setCssClass(this.cssClass,null),this.setDragAndDrop(!1),this.setFullRow(!1),this.ulElement&&this.ulElement.parentElement&&this.ulElement.parentElement.removeChild(this.ulElement),this.ulElement=null,this.liList=null,this.startNode=null,this.firstTap=null,this.expandArgs=null,this.dragLi=null,this.dragTarget=null,this.dragParent=null,this.dragObj=null,this.dropObj=null,this.inputObj=null,this.touchEditObj=null,this.touchExpandObj=null,this.touchClickObj=null,s.prototype.destroy.call(this)},t.prototype.addNodes=function(i,r,n,a){if(!m(i)){i=JSON.parse(JSON.stringify(i));var o=this.getElement(r);if(this.preventExpand=a,this.fields.dataSource instanceof fe)this.isOffline?this.addSuccess(i,o,n):this.crudOperation("insert",null,r,null,i,n,this.preventExpand);else if(this.dataType===2)this.addGivenNodes(i,o,n);else{if(o)this.addGivenNodes(i,o,n);else{i=this.getSortedData(i);for(var l=0;l<i.length;l++){var h=ie(this.fields.parentID,i[parseInt(l.toString(),10)]);o=h&&this.getElement(h.toString()),!m(h)&&m(o)&&(this.isHiddenItem=!0,this.preventExpand=!1,this.ensureVisible(h),this.preventExpand=a,this.isHiddenItem=!1,o=this.getElement(h.toString())),this.addGivenNodes([i[parseInt(l.toString(),10)]],o,n)}}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}this.setNodeFocusable(),this.updateCheckedStateFromDS(),this.showCheckBox&&o&&this.ensureParentCheckState(o),this.fields.dataSource instanceof fe||(this.preventExpand=!1,this.triggerEvent("addNodes",i))}},t.prototype.beginEdit=function(i){var r=this.getElement(i);m(r)||this.disabled||this.createTextbox(r)},t.prototype.checkAll=function(i){this.showCheckBox&&this.doCheckBoxAction(i,!0)},t.prototype.collapseAll=function(i,r,n){m(i)?r>0?this.collapseByLevel(ye("."+mt,this.element),r,n):this.collapseAllNodes(n):this.doGivenAction(i,Xt,!1)},t.prototype.disableNodes=function(i){m(i)||this.doDisableAction(i)},t.prototype.enableNodes=function(i){m(i)||this.doEnableAction(i)},t.prototype.ensureVisible=function(i){var r=[];if(this.dataType===1)for(var n=this.getTreeData(i);n.length!==0&&!m(n[0][this.fields.parentID]);)r.push(n[0][this.fields.parentID].toString()),n=this.getTreeData(n[0][this.fields.parentID].toString());else this.dataType===2&&(r=this.getHierarchicalParentId(i,this.treeData,r));this.expandAll(r.reverse(),null,null,this.isHiddenItem);var a=this.getElement(i);if(!m(a)){if(typeof i=="object"){var o=this.parents(a,"."+it);this.expandAll(o)}setTimeout(function(){a.scrollIntoView({behavior:"smooth"})},450)}},t.prototype.expandAll=function(i,r,n,a){this.isAnimate=!a,m(i)?r>0?this.expandByLevel(ye("."+mt,this.element),r,n):(this.expandAllNodes(n),(!this.loadOnDemand||this.element.classList.contains("e-filtering"))&&(this.updateAttributes(this.element),this.updateList())):this.doGivenAction(i,gt,!0),this.isAnimate=!0},t.prototype.getAllCheckedNodes=function(){var i=this.checkedNodes;return i},t.prototype.getDisabledNodes=function(){var i=this.disableNode;return i},t.prototype.getNode=function(i){var r=this.getElement(i);return this.getNodeData(r,!0)},t.prototype.getTreeData=function(i){var r=this.getId(i);if(this.updatePersistProp(),m(r))return this.treeData;var n=this.getNodeObject(r);return m(n)?[]:[n]},t.prototype.moveNodes=function(i,r,n,a){if(!(m(i)||i.length===0)){var o=this.getElement(r),l=[];m(o)&&(this.isHiddenItem=!0,this.ensureVisible(r),this.isHiddenItem=!1,o=this.getElement(r));for(var h=0;h<i.length;h++){var u=this.getElement(i[parseInt(h.toString(),10)]);l.push(this.getNode(u)),!(m(u)||o.isSameNode(u)||this.isDescendant(u,o))&&(this.preventExpand=a,this.dropAsChildNode(u,o,this,n,null,null,null,o))}this.fields.dataSource instanceof fe||(this.preventExpand=!1),this.triggerEvent("moveNodes",l)}},t.prototype.refreshNode=function(i,r){if(!(m(i)||m(r))){var n=!1;if(this.dataType===1&&r.length>1)n=!0;else if(this.dataType===2&&r.length===1){var a=ie(this.fields.child.toString(),r[0]);m(a)||(n=!0)}var o=this.getElement(i),l=o?o.getAttribute("data-uid"):i?i.toString():null;this.refreshData=this.getNodeObject(l),r=JSON.parse(JSON.stringify(r));var h,u;if(this.dataType===1&&n){for(var c=0;c<r.length;c++)if(m(r[parseInt(c.toString(),10)][this.fields.parentID])){u=r[parseInt(c.toString(),10)],r.splice(c,1);break}h=Ue({},this.refreshData,u)}else h=Ue({},this.refreshData,r[0]);if(m(o)){this.updatePosition(l,h,n,r);return}this.isRefreshed=!0;var f=parseFloat(o.getAttribute("aria-level")),d=Ft.createListItemFromJson(this.createElement,[h],this.listBaseOption,f),p=ye("."+mt,o),v=ie(this.fields.child.toString(),h);if(n&&p||n&&!m(v)){var g=o.parentElement,b=Array.prototype.indexOf.call(g.childNodes,o);Zi(o),g.insertBefore(d[0],g.childNodes[parseInt(b.toString(),10)]),this.updatePosition(l,h,n,r),n&&p&&this.expandAll([l])}else{var C=ye("."+Ei,o),y=ye("."+Ei,d[0]),x=ye("div."+vi,C),w=ye("div."+vi,y);x&&w&&(w.classList.contains(gt)&&x.classList.contains(Xt)?(Z([w],gt),P([w],Xt)):w.classList.contains(Xt)&&x.classList.contains(gt)?(Z([w],Xt),P([w],gt)):x.classList.contains("interaction")&&P([w],"interaction")),Zi(C);var S=ye("."+qs,o);S.parentNode.insertBefore(y,S.nextSibling),this.updatePosition(l,h,n,r)}if(o=this.getElement(i),h[this.fields.tooltip]&&o.setAttribute("title",h[this.fields.tooltip]),Object.prototype.hasOwnProperty.call(h,this.fields.htmlAttributes)&&h[this.fields.htmlAttributes]){var E={};po(E,h[this.fields.htmlAttributes]),E.class?(P([o],E.class.split(" ")),delete E.class):Pe(o,E)}this.selectedNodes.indexOf(l)!==-1&&(o.setAttribute("aria-selected","true"),P([o],xr)),this.isRefreshed=!1,this.triggerEvent("refreshNode",[this.getNode(o)])}},t.prototype.removeNodes=function(i){m(i)||(this.fields.dataSource instanceof fe&&!this.isOffline?this.crudOperation("delete",i):this.deleteSuccess(i))},t.prototype.updateNode=function(i,r){var n=this;if(!(m(i)||m(r)||!this.allowEditing)){var a=this.getElement(i);if(!m(a)){var o=ye("."+Un,a);this.updateOldText(a);var l=this.getEditEvent(a,null,null);this.trigger("nodeEditing",l,function(h){h.cancel||(n.fields.dataSource instanceof fe&&!n.isOffline?n.crudOperation("update",null,i,r,null,null,!1):n.appendNewText(a,o,r,!1))})}}},t.prototype.uncheckAll=function(i){this.showCheckBox&&this.doCheckBoxAction(i,!1)},t.prototype.setNodeFocusable=function(){var i=ye("."+it,this.element);i&&(i.setAttribute("tabindex","0"),this.updateIdAttr(null,i))};var e;return Ye([O(!1)],t.prototype,"allowDragAndDrop",void 0),Ye([O(!1)],t.prototype,"allowEditing",void 0),Ye([O(!1)],t.prototype,"allowMultiSelection",void 0),Ye([O(!1)],t.prototype,"allowTextWrap",void 0),Ye([Ur({},CH)],t.prototype,"animation",void 0),Ye([O()],t.prototype,"checkedNodes",void 0),Ye([O(!0)],t.prototype,"checkDisabledChildren",void 0),Ye([O("")],t.prototype,"cssClass",void 0),Ye([O(!1)],t.prototype,"disabled",void 0),Ye([O(null)],t.prototype,"dragArea",void 0),Ye([O(!0)],t.prototype,"enableHtmlSanitizer",void 0),Ye([O(!1)],t.prototype,"enablePersistence",void 0),Ye([O()],t.prototype,"expandedNodes",void 0),Ye([O("Auto")],t.prototype,"expandOn",void 0),Ye([Ur({},xH)],t.prototype,"fields",void 0),Ye([O(!0)],t.prototype,"fullRowSelect",void 0),Ye([O(!0)],t.prototype,"loadOnDemand",void 0),Ye([O()],t.prototype,"locale",void 0),Ye([O()],t.prototype,"nodeTemplate",void 0),Ye([O()],t.prototype,"selectedNodes",void 0),Ye([O("None")],t.prototype,"sortOrder",void 0),Ye([O(!1)],t.prototype,"showCheckBox",void 0),Ye([O(!0)],t.prototype,"autoCheck",void 0),Ye([O(!1)],t.prototype,"fullRowNavigable",void 0),Ye([Se()],t.prototype,"actionFailure",void 0),Ye([Se()],t.prototype,"created",void 0),Ye([Se()],t.prototype,"dataBound",void 0),Ye([Se()],t.prototype,"dataSourceChanged",void 0),Ye([Se()],t.prototype,"drawNode",void 0),Ye([Se()],t.prototype,"destroyed",void 0),Ye([Se()],t.prototype,"keyPress",void 0),Ye([Se()],t.prototype,"nodeChecked",void 0),Ye([Se()],t.prototype,"nodeChecking",void 0),Ye([Se()],t.prototype,"nodeClicked",void 0),Ye([Se()],t.prototype,"nodeCollapsed",void 0),Ye([Se()],t.prototype,"nodeCollapsing",void 0),Ye([Se()],t.prototype,"nodeDragging",void 0),Ye([Se()],t.prototype,"nodeDragStart",void 0),Ye([Se()],t.prototype,"nodeDragStop",void 0),Ye([Se()],t.prototype,"nodeDropped",void 0),Ye([Se()],t.prototype,"nodeEdited",void 0),Ye([Se()],t.prototype,"nodeEditing",void 0),Ye([Se()],t.prototype,"nodeExpanded",void 0),Ye([Se()],t.prototype,"nodeExpanding",void 0),Ye([Se()],t.prototype,"nodeSelected",void 0),Ye([Se()],t.prototype,"nodeSelecting",void 0),t=e=Ye([Wi],t),t}(Rr),vv=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),qe=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Fb="e-rtl",EH="e-ddt",Nb="e-ddt-hidden",Mb="e-input-group-icon e-ddt-icon e-icons",cr="e-show-chip",qn="e-show-clear",pd="e-show-dd-icon",Si="e-chip-input",Gn="e-input-focus",Pb="e-input-group",Bb="e-icon-anim",SH="e-clear-icon e-icons",kH="e-chips-wrapper",TH="e-chips-collection",md="e-chips",Hb="e-chipcontent",vd="e-chips-close",xt="e-icon-hide",Su="e-ddt-icon-hide",AH="e-ddt e-popup",Vb="e-list-parent",OH="e-popup-content",Wb="e-dropdown",zb="e-disabled",DH="e-icons",ku="e-selectall-parent",Tu="e-hide-selectall",LH="e-bigger",RH="e-small",jb="e-all-text",gd="e-frame",cl="e-check",bd="e-checkbox-wrapper",Ub="e-filter-wrap",$b="e-ddt-icon",qb="e-ddt-footer",Gb="e-ddt-header",IH="e-ddt-nodata",Xn="e-no-data",_H="HeaderTemplate",FH="FooterTemplate",NH="NoRecordsTemplate",MH="ActionFailureTemplate",PH="CustomTemplate",yd="e-remain",xd="e-overflow",Kn="e-show-text",fl="e-total-count",Ya="e-wrap-count",BH=function(s){vv(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return qe([O("child")],t.prototype,"child",void 0),qe([O([])],t.prototype,"dataSource",void 0),qe([O("expanded")],t.prototype,"expanded",void 0),qe([O("hasChildren")],t.prototype,"hasChildren",void 0),qe([O("htmlAttributes")],t.prototype,"htmlAttributes",void 0),qe([O("iconCss")],t.prototype,"iconCss",void 0),qe([O("imageUrl")],t.prototype,"imageUrl",void 0),qe([O("parentValue")],t.prototype,"parentValue",void 0),qe([O(null)],t.prototype,"query",void 0),qe([O("selectable")],t.prototype,"selectable",void 0),qe([O("selected")],t.prototype,"selected",void 0),qe([O(null)],t.prototype,"tableName",void 0),qe([O("text")],t.prototype,"text",void 0),qe([O("tooltip")],t.prototype,"tooltip",void 0),qe([O("value")],t.prototype,"value",void 0),t}(Ir),HH=function(s){vv(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return qe([O(!1)],t.prototype,"autoCheck",void 0),qe([O(!0)],t.prototype,"checkDisabledChildren",void 0),qe([O("Auto")],t.prototype,"expandOn",void 0),qe([O(!1)],t.prototype,"loadOnDemand",void 0),t}(Ir),VH=function(s){vv(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.filterTimer=null,r.isFilteredData=!1,r.isFilterRestore=!1,r.selectedData=[],r.filterDelayTime=300,r.isClicked=!1,r.documentClickContext=r.onDocumentClick.bind(r),r.isCheckAllCalled=!1,r.isFromFilterChange=!1,r}return t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.getLocaleName=function(){return"drop-down-tree"},t.prototype.preRender=function(){this.inputFocus=!1,this.isPopupOpen=!1,this.isFirstRender=!0,this.isInitialized=!1,this.currentText=null,this.currentValue=null,this.oldValue=null,this.removeValue=!1,this.selectedText=[],this.treeItems=[],this.dataValue=null,this.isNodeSelected=!1,this.isDynamicChange=!1,this.clearIconWidth=0,this.headerTemplateId=""+this.element.id+_H,this.footerTemplateId=""+this.element.id+FH,this.actionFailureTemplateId=""+this.element.id+MH,this.noRecordsTemplateId=""+this.element.id+NH,this.customTemplateId=""+this.element.id+PH,this.keyConfigs={escape:"escape",altUp:"alt+uparrow",altDown:"alt+downarrow",tab:"tab",shiftTab:"shift+tab",end:"end",enter:"enter",home:"home",moveDown:"downarrow",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",ctrlDown:"ctrl+downarrow",ctrlUp:"ctrl+uparrow",ctrlEnter:"ctrl+enter",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftEnter:"shift+enter",shiftHome:"shift+home",shiftEnd:"shift+end",csDown:"ctrl+shift+downarrow",csUp:"ctrl+shift+uparrow",csEnter:"ctrl+shift+enter",csHome:"ctrl+shift+home",csEnd:"ctrl+shift+end",space:"space",ctrlA:"ctrl+A"}},t.prototype.render=function(){var e=ye("#"+this.element.id+"_tree",document);if(e){var i=ye("#"+this.element.id+"_options",document);Oe(i||e.parentElement)}this.element.tagName==="INPUT"?(this.inputEle=this.element,m(this.inputEle.getAttribute("role"))&&(this.inputEle.setAttribute("aria-expanded","false"),this.inputEle.setAttribute("role","combobox"),this.inputEle.setAttribute("aria-haspopup","tree"),this.inputEle.setAttribute("aria-controls",this.element.id+"_options")),m(this.inputEle.getAttribute("type"))&&this.inputEle.setAttribute("type","text")):(m(this.element.id)?this.inputEle=this.createElement("input",{attrs:{role:"textbox",type:"text"}}):this.inputEle=this.createElement("input",{attrs:{role:"textbox",type:"text",id:this.element.id+"_textbox"}}),this.element.parentElement.insertBefore(this.inputEle,this.element)),this.inputObj=Te.createInput({element:this.inputEle,floatLabelType:this.floatLabelType,buttons:this.showDropDownIcon?[Mb]:null,properties:{readonly:!0,placeholder:this.placeholder,enabled:this.enabled,cssClass:this.cssClass,enableRtl:this.enableRtl}},this.createElement),this.inputWrapper=this.inputObj.container,this.inputWrapper.classList.contains(Pb)||this.inputWrapper.classList.add(Pb),this.showDropDownIcon&&this.inputWrapper.classList.add(pd),this.element.tagName===this.getDirective()&&this.element.appendChild(this.inputWrapper),this.createHiddenElement(),this.createClearIcon(),this.inputWrapper.classList.add(EH),this.setElementWidth(this.width),this.updateDataAttribute(),this.setHTMLAttributes(),this.setAttributes(),this.popupDiv=this.createElement("div",{className:OH}),this.popupDiv.classList.add(Wb),this.tree=this.createElement("div",{id:this.element.id+"_tree"}),this.popupDiv.appendChild(this.tree),this.destroyPopupOnHide||document.body.appendChild(this.popupDiv),this.wireTreeEvents(),P([this.popupDiv],Su),this.renderTree(),this.isRemoteData=this.fields.dataSource instanceof fe,(this.allowMultiSelection||this.showCheckBox)&&(this.mode!=="Delimiter"&&this.createChip(),!this.wrapText&&this.mode!=="Custom"&&(this.overFlowWrapper=this.createElement("span",{className:xd+" "+xt}),this.inputWrapper.insertBefore(this.overFlowWrapper,this.hiddenElement),this.mode!=="Box"&&P([this.overFlowWrapper],Kn))),this.isRemoteData||(this.setTreeValue(),this.setTreeText(),this.updateHiddenValue(),this.setSelectedValue(),this.wrapText||this.updateView()),this.wireEvents();var r=ye("."+Vb,this.treeObj.element);r&&r.getAttribute("aria-multiselectable")&&r.removeAttribute("aria-multiselectable"),this.setOldValue(),this.isRemoteData||(this.isInitialized=!0),this.hasTemplate=this.itemTemplate||this.headerTemplate||this.footerTemplate||this.actionFailureTemplate||this.noRecordsTemplate||this.customTemplate||this.valueTemplate,this.renderComplete()},t.prototype.hideCheckAll=function(e){var i=m(this.popupEle)?null:this.popupEle.querySelector("."+ku);m(i)||(e&&!i.classList.contains(Tu)?P([i],Tu):!e&&i.classList.contains(Tu)&&Z([i],Tu))},t.prototype.renderFilter=function(){this.filterContainer=this.createElement("div",{id:this.element.id+"_filter_wrap",className:Ub});var e=this.createElement("input",{id:this.element.id+"_filter",attrs:{autocomplete:"off","aria-label":this.filterBarPlaceholder}});this.filterContainer.appendChild(e),Ii([this.filterContainer],this.popupEle),this.filterObj=new qu({value:"",showClearButton:!0,placeholder:this.filterBarPlaceholder,input:this.filterChangeHandler.bind(this)}),this.filterObj.appendTo("#"+this.element.id+"_filter"),this.keyboardModule=new gr(this.filterObj.element,{keyAction:this.filterKeyAction.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},t.prototype.filterKeyAction=function(e){var i=this,r={cancel:!1,event:e},n;this.trigger("keyPress",r,function(a){if(!a.cancel)switch(e.action){case"altUp":i.isPopupOpen&&i.hidePopup();break;case"shiftTab":P([i.inputWrapper],[Gn]);break;case"moveDown":e.preventDefault(),i.filterObj.element.blur(),n=i.treeObj.element.querySelector("li"),n&&n.focus();break}})},t.prototype.filterChangeHandler=function(e){var i=this;m(e.value)||(window.clearTimeout(this.filterTimer),this.filterTimer=window.setTimeout(function(){i.filterHandler(e.value,e.event)},this.filterDelayTime))},t.prototype.isChildObject=function(){return typeof this.treeObj.fields.child=="object"},t.prototype.filterHandler=function(e,i){var r=this;this.isFromFilterChange=!0,this.isFilteredData||(this.isRemoteData&&(this.treeObj.expandedNodes=[]),this.treeData=this.treeObj.getTreeData());var n=this.cloneFields(this.fields),a={cancel:!1,preventDefaultAction:!1,event:i,text:e.trim(),fields:n};this.trigger("filtering",a,function(o){if(!o.cancel){var l=!1,h=void 0;if(r.isFilteredData=!0,o.text===""?(r.isFilteredData=!1,r.isFilterRestore=!0,h=r.cloneFields(r.fields),r.treeObj.element.classList.remove("e-filtering")):o.preventDefaultAction?(h=o.fields,r.treeObj.element.classList.add("e-filtering")):(r.treeDataType===1?h=r.selfReferencefilter(o.text,o.fields):r.fields.dataSource instanceof fe?(h=r.remoteDataFilter(o.text,o.fields),h.child=r.fields.child,r.treeObj.fields=r.getTreeFields(o.fields),r.treeObj.dataBind(),l=!0):h=r.nestedFilter(o.text,o.fields),r.treeObj.element.classList.add("e-filtering")),r.hideCheckAll(r.isFilteredData),l)return;if(r.isRemoteData&&(r.isChildObject()?h.child=r.fields.child:h=o.fields),r.treeObj.fields=r.getTreeFields(h),r.treeObj.dataBind(),r.popupObj&&r.popupObj.refreshPosition(),r.hasTemplate&&r.portals&&r.treeObj.portals){for(var u=0;u<r.treeObj.portals.length;u++)r.portals.indexOf(r.treeObj.portals[u])===-1&&r.portals.push(r.treeObj.portals[u]);r.isReact&&r.renderReactTemplates()}}})},t.prototype.remoteDataFilter=function(e,i){var r=this;return i.dataSource=this.treeData.map(function(n){return r.remoteChildFilter(e,n)}).filter(function(n){return!m(n)}),i},t.prototype.remoteChildFilter=function(e,i,r,n){var a=this.isChildObject()?i.child:i[this.fields.child];if(m(a))return this.isMatchedNode(e,i,r,n)?i:null;for(var o=[],l=0;l<a.length;l++){var h=this.remoteChildFilter(e,a[l],!0,!0);m(h)||o.push(h)}var u=Object.assign({},i);return n=!1,o.length!==0?u.child=o:(u.child=null,u=this.isMatchedNode(e,u)?u:null),u},t.prototype.nestedFilter=function(e,i){for(var r=[],n=0;n<this.treeData.length;n++){var a=this.nestedChildFilter(e,this.treeData[parseInt(n.toString(),10)]);m(a)||r.push(a)}return i.dataSource=r,i},t.prototype.nestedChildFilter=function(e,i){var r=i[this.fields.child];if(m(r))return this.isMatchedNode(e,i)?i:null;for(var n=[],a=0;a<r.length;a++){var o=this.nestedChildFilter(e,r[parseInt(a.toString(),10)]);m(o)||n.push(o)}var l=Object.assign({},i);return n.length!==0?(l[this.fields.child]=n,l):(l[this.fields.child]=null,this.isMatchedNode(e,l)?l:null)},t.prototype.selfReferencefilter=function(e,i){for(var r=[],n=[],a=0;a<this.treeData.length;a++)this.isMatchedNode(e,this.treeData[a])&&r.push(this.treeData[a]);for(var a=0;a<r.length;a++)if(n.indexOf(r[a])===-1){n.push(r[a]);for(var o=r[parseInt(a.toString(),10)][this.fields.parentValue];!m(o);){for(var l=null,h=0;h<this.treeData.length;h++){var u=this.treeData[parseInt(h.toString(),10)][this.fields.value];if(!m(u)&&u===o){l=this.treeData[h];break}}if(!m(l)&&n.indexOf(l)===-1)n.push(l),o=l[this.fields.parentValue];else break}}return i.dataSource=n,i},t.prototype.isMatchedNode=function(e,i,r,n){var a,o=r&&n&&this.isChildObject();if(a=o?i[this.fields.child.text]:i[this.fields.text],!a&&!m(this.fields.child.text)){for(var l=this.fields.child;!i[l.text];)l=l.child;a=i[l.text]}return this.ignoreCase&&(a=a.toLowerCase(),e=e.toLowerCase()),this.ignoreAccent&&(a=ue.ignoreDiacritics(a),e=ue.ignoreDiacritics(e)),this.filterType==="StartsWith"?a.slice(0,e.length)===e:this.filterType==="EndsWith"?a.slice(-e.length)===e:a.indexOf(e)!==-1},t.prototype.wireEvents=function(){R.add(this.inputWrapper,"mouseup",this.dropDownClick,this),R.add(this.inputWrapper,"focus",this.focusIn,this),R.add(this.inputWrapper,"blur",this.focusOut,this),R.add(this.inputWrapper,"mousemove",this.mouseIn,this),R.add(this.inputWrapper,"mouseout",this.onMouseLeave,this),R.add(this.overAllClear,"mousedown",this.clearAll,this),R.add(window,"resize",this.windowResize,this);var e=X(this.inputWrapper,"form");e&&R.add(e,"reset",this.resetValueHandler,this),this.keyboardModule=new gr(this.inputWrapper,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},t.prototype.wireTreeEvents=function(){this.keyboardModule=new gr(this.tree,{keyAction:this.treeAction.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},t.prototype.wireCheckAllWrapperEvents=function(){this.keyboardModule=new gr(this.checkAllParent,{keyAction:this.checkAllAction.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},t.prototype.unWireEvents=function(){R.remove(this.inputWrapper,"mouseup",this.dropDownClick),R.remove(this.inputWrapper,"focus",this.focusIn),R.remove(this.inputWrapper,"blur",this.focusOut),R.remove(this.inputWrapper,"mousemove",this.mouseIn),R.remove(this.inputWrapper,"mouseout",this.onMouseLeave),R.remove(this.overAllClear,"mousedown",this.clearAll),R.remove(window,"resize",this.windowResize);var e=X(this.inputWrapper,"form");e&&R.remove(e,"reset",this.resetValueHandler),this.keyboardModule.destroy(),this.showSelectAll&&this.checkAllParent&&R.remove(this.checkAllParent,"mouseup",this.clickHandler),document.removeEventListener("mousedown",this.documentClickContext)},t.prototype.dropDownClick=function(e){if(!(!this.enabled||this.readonly)){if(this.isClearButtonClick){this.isClearButtonClick=!1;return}this.isPopupOpen?this.hidePopup():(this.focusIn(e),this.renderPopup()),this.showOverAllClear()}},t.prototype.mouseIn=function(){(this.enabled||!this.readonly)&&this.showOverAllClear()},t.prototype.onMouseLeave=function(){this.inputFocus||(P([this.overAllClear],xt),Z([this.inputWrapper],qn))},t.prototype.getDirective=function(){return"EJS-DROPDOWNTREE"},t.prototype.focusOut=function(e){if(!(!this.enabled||this.readonly||!this.inputFocus)&&!((xe.isIE||xe.info.name==="edge")&&e.target===this.inputWrapper)){var i=e.relatedTarget;i!==this.inputEle&&m(i)&&(e.target!==this.inputWrapper||!this.isPopupOpen)&&this.onFocusOut(e)}},t.prototype.onFocusOut=function(e){if(this.inputFocus=!1,this.isPopupOpen&&this.hidePopup(),this.isClearButtonClick&&(this.isClearButtonClick=!1),this.showClearButton&&(this.clearIconWidth=ye(".e-clear-icon",this.inputWrapper).offsetWidth,P([this.overAllClear],xt),Z([this.inputWrapper],qn)),Z([this.inputWrapper],[Gn]),this.allowMultiSelection||this.showCheckBox){var i=this.value?!!this.value.length:!1;this.mode!=="Delimiter"&&this.mode!=="Custom"&&this.chipWrapper&&this.mode==="Default"&&(P([this.chipWrapper],xt),Z([this.inputWrapper],cr),Z([this.inputEle],Si)),i&&this.mode!=="Custom"&&this.showOrHideValueTemplate(!0),!this.wrapText&&i&&this.updateView()}this.changeOnBlur&&this.triggerChangeEvent(e),this.removeValue=!1,this.setOldValue(),this.trigger("blur")},t.prototype.updateView=function(){!this.showCheckBox&&!this.allowMultiSelection||this.mode==="Custom"||this.inputFocus||(this.mode!=="Box"?P([this.inputWrapper,this.overFlowWrapper],Kn):P([this.inputWrapper],cr),this.value&&this.value.length!==0&&(this.inputWrapper.contains(this.chipWrapper)&&P([this.chipWrapper],xt),P([this.inputEle],Si),this.updateOverFlowView()),this.ensurePlaceHolder())},t.prototype.triggerChangeEvent=function(e){var i=this.ddtCompareValues(this.oldValue,this.value);if((!i||this.isChipDelete)&&!this.removeValue){var r={e,oldValue:this.oldValue,value:this.value,isInteracted:!!e,element:this.element};this.trigger("change",r),this.setOldValue()}},t.prototype.ddtCompareValues=function(e,i){if(e===null||i===null){var r=e===null||e.length===0?i===e:!1;return r}else if(e.length!==i.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==i[n])return!1;return!0},t.prototype.focusIn=function(e){if(!(!this.enabled||this.readonly||this.inputFocus)){this.showOverAllClear(),this.inputFocus=!0,P([this.inputWrapper],[Gn]),(this.allowMultiSelection||this.showCheckBox)&&(this.mode!=="Delimiter"&&this.inputFocus&&(this.chipWrapper&&this.value&&this.value.length!==0&&(Z([this.chipWrapper],xt),P([this.inputEle],Si),this.showOrHideValueTemplate(!1,!0)),P([this.inputWrapper],cr),this.popupObj&&this.popupObj.refreshPosition()),!this.wrapText&&this.mode!=="Custom"&&(this.inputWrapper.contains(this.overFlowWrapper)&&P([this.overFlowWrapper],xt),this.mode==="Delimiter"?(Z([this.inputWrapper],cr),Z([this.inputEle],Si),this.showOrHideValueTemplate(!0)):P([this.inputWrapper],cr),Z([this.inputWrapper],Kn),this.ensurePlaceHolder()));var i={isInteracted:!!e,event:e};this.trigger("focus",i)}},t.prototype.treeAction=function(e){var i=this,r={cancel:!1,event:e};this.trigger("keyPress",r,function(n){if(n.cancel)e.stopImmediatePropagation();else switch(e.action){case"escape":case"altUp":i.inputWrapper.focus(),e.preventDefault(),i.isPopupOpen&&i.hidePopup();break;case"tab":i.isPopupOpen&&i.hidePopup();break;case"enter":case"ctrlEnter":case"shiftEnter":case"csEnter":i.showCheckBox||(i.isValueChange=!0,i.keyEventArgs=e);break;case"space":i.isValueChange=!0,i.keyEventArgs=e;break;case"ctrlA":i.allowMultiSelection&&i.selectAll(!0);break}})},t.prototype.keyActionHandler=function(e){var i=this,r={cancel:!1,event:e};this.trigger("keyPress",r,function(n){if(!n.cancel)switch(e.action){case"escape":case"altUp":i.isPopupOpen&&i.hidePopup();break;case"shiftTab":i.isPopupOpen&&i.hidePopup(),i.inputFocus&&i.onFocusOut();break;case"altDown":i.isPopupOpen||(i.showPopup(),e.preventDefault());break;case"moveDown":i.showSelectAll&&i.showCheckBox&&i.checkAllParent.focus();break;case"tab":!i.isPopupOpen&&i.inputFocus&&i.onFocusOut();break}})},t.prototype.checkAllAction=function(e){var i=this,r={cancel:!1,event:e},n;this.trigger("keyPress",r,function(a){if(!a.cancel)switch(e.action){case"space":i.clickHandler(e);break;case"moveDown":e.preventDefault(),n=i.treeObj.element.querySelector('li[tabindex="0"]')||i.treeObj.element.querySelector("li"),n.focus(),P([n],["e-node-focus"]);break}})},t.prototype.windowResize=function(){this.popupObj&&(this.popupObj.setProperties({width:this.setWidth()}),this.popupObj.refreshPosition())},t.prototype.resetValueHandler=function(e){var i=X(this.inputWrapper,"form");i&&e.target===i&&(this.isDynamicChange=!0,this.setProperties({value:null},!0),this.resetValue(!0),this.isDynamicChange=!1)},t.prototype.getAriaAttributes=function(){return{}},t.prototype.updateOverFlowView=function(){if(this.overFlowWrapper.classList.remove(fl),Z([this.overFlowWrapper],xt),this.value&&this.value.length){var e="",i=void 0,r=void 0,n=void 0,a=1,o=void 0,l=void 0,h=0;this.overFlowWrapper.innerHTML="";var u={overflowCountTemplate:"+${count} more..",totalCountTemplate:"${count} selected"};this.l10n=new br(this.getLocaleName(),u,this.locale);var c=this.l10n.getConstant("overflowCountTemplate"),f=this.l10n.getConstant("totalCountTemplate"),d=this.createElement("span",{className:yd});this.overFlowWrapper.appendChild(d),d.innerText=c.replace("${count}",this.value.length.toString());var p=d.offsetWidth;if(Zi(d),this.showDropDownIcon&&(h=ye("."+$b,this.inputWrapper).offsetWidth),!m(this.value))if(this.mode!=="Box"){if(this.valueTemplate){l=this.updateChipAndValueTemplate(!1,h,p),this.checkRemainingTemplate(l,d,c,f),this.updateDelimMode();return}for(var v=0;!m(this.value[v]);v++)if(e+=v===0?"":this.delimiterChar+" ",r=this.getOverflowVal(v),e+=r,r=this.overFlowWrapper.innerHTML,this.enableHtmlSanitizer?this.overFlowWrapper.innerText=mr.sanitize(e):this.overFlowWrapper.innerHTML=e,o=this.overFlowWrapper.offsetWidth,i=this.inputWrapper.offsetWidth,o+h+this.clearIconWidth>i){for(n!==void 0&&n!==""&&(r=n,v=a+1),this.overFlowWrapper.innerHTML=r,l=this.value.length-v,o=this.overFlowWrapper.offsetWidth;o+p+h+this.clearIconWidth>=i&&o!==0&&this.overFlowWrapper.innerHTML!=="";){var g=this.overFlowWrapper.innerHTML.split(this.delimiterChar);g.pop(),this.overFlowWrapper.innerHTML=g.join(this.delimiterChar),l++,o=this.overFlowWrapper.offsetWidth}break}else o+p+h+this.clearIconWidth<=i?(n=e,a=v):v===0&&(n="",a=-1)}else l=this.updateChipAndValueTemplate(!0,h,p);this.checkRemainingTemplate(l,d,c,f)}else this.overFlowWrapper.innerHTML="",P([this.overFlowWrapper],xt);this.updateDelimMode()},t.prototype.checkRemainingTemplate=function(e,i,r,n){e>0&&this.overFlowWrapper.appendChild(this.updateRemainTemplate(i,e,r,n)),this.mode==="Box"&&!this.overFlowWrapper.classList.contains(fl)&&P([i],Ya)},t.prototype.updateChipAndValueTemplate=function(e,i,r){i===void 0&&(i=0);var n="",a,o,l,h=1,u,c;P([e?this.chipWrapper:this.valueTemplateContainer],xt);for(var f=(e?this.chipWrapper:this.valueTemplateContainer).cloneNode(!0),d=e?dt("."+md,f):Array.prototype.slice.call(f.children),p=0;p<d.length;p++)if(o=this.overFlowWrapper.innerHTML,this.overFlowWrapper.appendChild(d[p]),n=this.overFlowWrapper.innerHTML,u=this.overFlowWrapper.offsetWidth,a=this.inputWrapper.offsetWidth,u+i+this.clearIconWidth>a){for(l!==void 0&&l!==""&&(o=l,p=h+1),this.overFlowWrapper.innerHTML=o,c=this.value.length-p,u=this.overFlowWrapper.offsetWidth;u+r+i+this.clearIconWidth>=a&&u!==0&&this.overFlowWrapper.innerHTML!=="";)this.overFlowWrapper.removeChild(this.overFlowWrapper.lastChild),c++,u=this.overFlowWrapper.offsetWidth;break}else u+r+i+this.clearIconWidth<=a?(l=n,h=p):p===0&&(l="",h=-1);return c},t.prototype.updateRemainTemplate=function(e,i,r,n){return this.overFlowWrapper.firstChild&&this.overFlowWrapper.firstChild.nodeType===3&&this.overFlowWrapper.firstChild.nodeValue===""&&this.overFlowWrapper.removeChild(this.overFlowWrapper.firstChild),e.innerHTML="",e.innerText=this.overFlowWrapper.firstChild&&(this.overFlowWrapper.firstChild.nodeType===3||this.mode==="Box"||this.valueTemplateContainer)?r.replace("${count}",i.toString()):n.replace("${count}",i.toString()),this.overFlowWrapper.firstChild&&(this.overFlowWrapper.firstChild.nodeType===3||this.mode==="Box")?Z([this.overFlowWrapper],fl):(P([this.overFlowWrapper],fl),Z([this.overFlowWrapper],Ya)),e},t.prototype.getOverflowVal=function(e){var i=this.getSelectedData(this.value[parseInt(e.toString(),10)]);return ie(this.treeSettings.loadOnDemand?this.fields.text:"text",i)},t.prototype.updateDelimMode=function(){this.mode!=="Box"?ye("."+yd,this.overFlowWrapper)&&!this.overFlowWrapper.classList.contains(fl)?(P([this.overFlowWrapper],Ya),P([this.overFlowWrapper],Kn)):(this.overFlowWrapper.classList.remove(Ya),Z([this.overFlowWrapper],Ya)):ye("."+yd,this.overFlowWrapper)&&this.overFlowWrapper.classList.remove(Ya)},t.prototype.createHiddenElement=function(){this.allowMultiSelection||this.showCheckBox?this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true",class:Nb,tabindex:"-1",multiple:"","aria-label":this.getModuleName()}}):this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true",tabindex:"-1",class:Nb,"aria-label":this.getModuleName()}}),Ii([this.hiddenElement],this.inputWrapper),this.validationAttribute()},t.prototype.createClearIcon=function(){this.overAllClear=this.createElement("span",{className:SH}),P([this.overAllClear],xt),Z([this.inputWrapper],qn),this.showClearButton&&this.inputWrapper.insertBefore(this.overAllClear,this.inputObj.buttons[0])},t.prototype.validationAttribute=function(){var e=this.inputEle.getAttribute("name")?this.inputEle.getAttribute("name"):this.inputEle.getAttribute("id");this.hiddenElement.setAttribute("name",e),this.inputEle.removeAttribute("name");for(var i=["required","aria-required","form"],r=0;r<i.length;r++){var n=this.inputEle.getAttribute(i[r]);n&&(this.hiddenElement.setAttribute(i[r],n),this.inputEle.removeAttribute(i[r]))}},t.prototype.createChip=function(){if(!this.inputWrapper.contains(this.chipWrapper)){this.chipWrapper=this.createElement("span",{className:kH}),this.chipCollection=this.createElement("span",{className:TH}),this.chipWrapper.appendChild(this.chipCollection),this.inputWrapper.insertBefore(this.chipWrapper,this.hiddenElement),P([this.inputWrapper],cr);var e=this.getValidMode();e&&this.value!==null&&this.value&&this.value.length!==0?P([this.inputEle],Si):(this.value===null||this.value&&this.value.length===0||this.checkWrapper)&&P([this.chipWrapper],xt)}},t.prototype.getValidMode=function(){return this.allowMultiSelection||this.showCheckBox?this.mode==="Box"?!0:!!(this.mode==="Default"&&this.inputFocus):!1},t.prototype.createSelectAllWrapper=function(){this.checkAllParent=this.createElement("div",{className:ku,attrs:{tabindex:"0"}}),this.selectAllSpan=this.createElement("span",{className:jb}),this.selectAllSpan.textContent="";var e=X(this.element,"."+LH),i=m(e)?"":RH;this.checkBoxElement=ov(this.createElement,!0,{cssClass:i}),this.checkBoxElement.setAttribute("role","checkbox"),this.checkAllParent.appendChild(this.checkBoxElement),this.checkAllParent.appendChild(this.selectAllSpan),this.setLocale(),R.add(this.checkAllParent,"mouseup",this.clickHandler,this),this.wireCheckAllWrapperEvents()},t.prototype.clickHandler=function(e){var i;if(e.currentTarget&&e.currentTarget.classList.contains(ku)?i=e.currentTarget.firstElementChild.lastElementChild:i=e.target,this.checkWrapper=X(i,"."+bd),!m(this.checkWrapper)){this.isClicked=!0;var r=ye("."+gd,this.checkWrapper);this.changeState(this.checkWrapper,r.classList.contains(cl)?"uncheck":"check",e),this.isClicked=!1}e.preventDefault()},t.prototype.changeState=function(e,i,r){var n,a=e.getElementsByClassName(gd)[0];i==="check"&&!a.classList.contains(cl)?(a.classList.add(cl),n="true",this.isReverseUpdate||(this.setOldValue(),this.isCheckAllCalled=!0,this.treeObj.checkAll(),this.changeOnBlur||this.triggerChangeEvent(r)),this.setLocale(!0)):i==="uncheck"&&a.classList.contains(cl)&&(a.classList.remove(cl),n="false",this.isReverseUpdate||(this.treeObj.uncheckAll(),this.changeOnBlur||this.triggerChangeEvent(r)),this.setLocale(!1)),this.setMultiSelect(),this.ensurePlaceHolder(),n=i==="check"?"true":"false",m(n)||e.parentElement.setAttribute("aria-checked",n)},t.prototype.setLocale=function(e){if(this.selectAllSpan)if(this.selectAllText!=="Select All"||this.unSelectAllText!=="Unselect All"){var i=e?this.unSelectAllText:this.selectAllText;this.selectAllSpan.textContent="";for(var r=wt(i),n=e?"unSelectAllText":"selectAllText",a=0,o=r({},this,n,null,!this.isStringTemplate);a<o.length;a++){var l=o[a];this.selectAllSpan.textContent=l.textContent}}else this.selectAllSpan.textContent=e?this.unSelectAllText:this.selectAllText},t.prototype.setAttributes=function(){this.inputEle.setAttribute("tabindex","-1"),this.inputEle.setAttribute("aria-label",this.getModuleName());var e=this.element.getAttribute("id");this.hiddenElement.id=e+"_hidden",this.inputWrapper.setAttribute("tabindex",this.inputWrapper.classList.contains("e-disabled")?"-1":"0"),this.inputWrapper.setAttribute("aria-label",this.getModuleName()),Pe(this.inputWrapper,this.getAriaAttributes())},t.prototype.setHTMLAttributes=function(){if(Object.keys(this.htmlAttributes).length)for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(r==="class")this.inputWrapper.classList.add(this.htmlAttributes[""+r]);else if(r==="disabled")this.setProperties({enabled:!1},!0),this.setEnable();else if(r==="readonly")this.setProperties({readonly:!0},!0),this.dataBind();else if(r==="style")this.inputWrapper.style.cssText=this.htmlAttributes[""+r];else{var n=["title","id","placeholder","aria-placeholder","role","autocorrect","autocomplete","autocapitalize","spellcheck","minlength","maxlength"],a=["name","required"];r.indexOf("data")===0||a.indexOf(r)>-1?this.hiddenElement.setAttribute(r,this.htmlAttributes[""+r]):n.indexOf(r)>-1?r==="placeholder"?Te.setPlaceholder(this.htmlAttributes[""+r],this.inputEle):this.inputEle.setAttribute(r,this.htmlAttributes[""+r]):this.inputEle.setAttribute(r,this.htmlAttributes[""+r])}}},t.prototype.updateDataAttribute=function(){for(var e=this.htmlAttributes,i=["class","style","id","type"],r={},n=0;n<this.element.attributes.length;n++)i.indexOf(this.element.attributes[n].name)===-1&&this.element.attributes[n].name!=="readonly"&&(r[this.element.attributes[n].name]=this.element.getAttribute(this.element.attributes[n].name));Ue(r,e,r),this.setProperties({htmlAttributes:r},!0)},t.prototype.showOverAllClear=function(){if(!(!this.enabled||this.readonly)&&this.overAllClear){var e=this.value?!!this.value.length:!1;e&&this.showClearButton?(Z([this.overAllClear],xt),P([this.inputWrapper],qn)):(P([this.overAllClear],xt),Z([this.inputWrapper],qn))}},t.prototype.setTreeValue=function(){if(this.value!==null&&this.value.length!==0){var e=void 0;if(this.showCheckBox||this.allowMultiSelection){for(var i=this.value.length-1;i>=0;i--)e=this.treeObj.getTreeData(this.value[i])[0],m(e)&&this.value.splice(i,1);this.value.length!==0&&this.setValidValue()}else e=this.treeObj.getTreeData(this.value[0])[0],m(e)?this.setProperties({value:this.currentValue},!0):(this.setProperties({text:e[this.fields.text]},!0),this.setValidValue())}},t.prototype.setTreeText=function(){if(!(this.value!==null&&!this.isInitialized)&&this.text!==null){var e=void 0,i=[];if(this.showCheckBox||this.allowMultiSelection){for(var r=this.text.split(this.delimiterChar),n=0;n<r.length;n++)e=this.getItems(r[n]),m(e)||i.push(e[this.fields.value].toString());i.length!==0?(this.setOldValue(),this.setProperties({value:i},!0),this.setValidValue()):this.setProperties({text:this.currentText},!0)}else e=this.getItems(this.text),m(e)?this.setProperties({text:this.currentText},!0):(this.setOldValue(),this.setProperties({value:[e[this.fields.value].toString()]},!0),this.setValidValue())}},t.prototype.setSelectedValue=function(){this.value!==null&&this.value.length!==0||this.isInitialized||(this.setOldValue(),this.treeObj.selectedNodes.length>0&&!this.showCheckBox?(this.setProperties({value:this.treeObj.selectedNodes},!0),this.allowMultiSelection&&this.updateMode()):this.showCheckBox&&this.treeObj.checkedNodes&&this.treeObj.checkedNodes.length>0&&(this.setProperties({value:this.treeObj.checkedNodes},!0),It("selectedNodes",[],this.treeObj),this.treeObj.dataBind(),this.updateMode()),this.updateSelectedValues(),this.currentText=this.text,this.currentValue=this.value)},t.prototype.setValueTemplate=function(){var e=this;if(this.valueTemplate){var i=this.initializeValueTemplate();this.getValueTemplateElement(this.value[0],i),this.hasTemplate&&this.portals&&(this.treeObj.portals&&(this.portals=this.portals.concat(this.treeObj.portals.filter(function(r){return!e.portals.includes(r)}))),this.isReact&&this.renderReactTemplates(this.reactCallBack)),this.showOrHideValueTemplate(!0)}},t.prototype.getValueTemplateElement=function(e,i){var r=this.getNodeData(e,this.isFilteredData?this.treeData:this.treeItems),n=i(r,this,"valueTemplate",this.element.id+"valueTemplate",this.isStringTemplate,void 0,this.valueTemplateContainer);n&&(n=Array.prototype.slice.call(n),at(n,this.valueTemplateContainer))},t.prototype.setValidValue=function(){var e=this;if(!this.showCheckBox&&!this.allowMultiSelection){Te.setValue(this.text,this.inputEle,this.floatLabelType),this.setValueTemplate();var i=this.value[0].toString();this.treeObj.selectedNodes[0]!==i&&(It("selectedNodes",[i],this.treeObj),this.fields.dataSource instanceof fe&&this.updateSelectedValues())}else{if(this.showCheckBox){var r=this.value.length!==this.treeObj.checkedNodes.length||this.value.filter(function(n){return e.treeObj.checkedNodes.indexOf(n)===-1}).length>0;(r||this.treeSettings.autoCheck)&&(this.treeObj.checkedNodes=this.value.slice(),this.treeObj.dataBind(),this.setMultiSelect())}else this.treeObj.selectedNodes=this.value.slice(),this.selectedText=[],this.updateSelectedValues();this.treeObj.dataBind()}this.currentText=this.text,this.currentValue=this.value,!m(this.value)&&this.value.length>0&&!m(this.currentText)&&this.inputWrapper.setAttribute("aria-label",this.currentText.replace(/,/g,", ")),this.isInitialized&&this.triggerChangeEvent()},t.prototype.getItems=function(e){var i;if(this.treeDataType===1)for(var r=0;r<this.treeItems.length;r++){var n=ie(this.fields.text,this.treeItems[parseInt(r.toString(),10)]);if(!m(this.treeItems[r])&&!m(n)&&n===e){i=this.treeItems[r];break}}else i=this.getNestedItems(this.treeItems,this.fields,e);return i},t.prototype.getNestedItems=function(e,i,r){for(var n,a=0,o=e.length;a<o;a++){var l=ie(this.fields.text,e[parseInt(a.toString(),10)]);if(e[a]&&l&&l.toString()===r)return e[a];if(typeof i.child=="string"&&!m(ie(i.child,e[a]))){var h=ie(i.child,e[parseInt(a.toString(),10)]);if(n=this.getNestedItems(h,this.getChildType(i),r),n!==void 0)break}else if(this.fields.dataSource instanceof fe&&!m(ie("child",e[a]))){var u="child";if(n=this.getNestedItems(ie(u,e[parseInt(a.toString(),10)]),this.getChildType(i),r),n!==void 0)break}}return n},t.prototype.getChildType=function(e){return typeof e.child=="string"||m(e.child)?e:e.child},t.prototype.renderTree=function(){this.treeObj=new wH({fields:this.getTreeFields(this.fields),enableRtl:this.enableRtl,nodeSelected:this.onNodeSelected.bind(this),nodeChecked:this.onNodeChecked.bind(this),nodeChecking:this.beforeCheck.bind(this),nodeExpanded:this.onNodeExpanded.bind(this),actionFailure:this.onActionFailure.bind(this),nodeClicked:this.onNodeClicked.bind(this),dataBound:this.OnDataBound.bind(this),allowMultiSelection:this.allowMultiSelection,enableHtmlSanitizer:this.enableHtmlSanitizer,showCheckBox:this.showCheckBox,autoCheck:this.treeSettings.autoCheck,sortOrder:this.sortOrder,expandOn:this.treeSettings.expandOn,loadOnDemand:this.treeSettings.loadOnDemand,nodeSelecting:this.onBeforeSelect.bind(this),nodeTemplate:this.itemTemplate,checkDisabledChildren:this.treeSettings.checkDisabledChildren}),this.treeObj.root=this.root?this.root:this,this.treeObj.appendTo(this.tree)},t.prototype.renderPopup=function(){var e=this;this.isFilteredData&&(this.treeObj.element.classList.remove("e-filtering"),this.filterObj.value="",this.treeObj.fields=this.getTreeFields(this.fields),this.isFilterRestore=!0,this.isFilteredData=!1,this.hideCheckAll(!1));var i=!1,r={cancel:!1};this.trigger("beforeOpen",r,function(n){if(n.cancel?i=!0:(P([e.inputWrapper],[Bb]),e.isReact&&e.isFilterRestore&&e.treeObj.refresh(),e.isFirstRender?(e.popupEle=e.createElement("div",{id:e.element.id+"_options",className:AH+" "+(e.cssClass!=null?e.cssClass:"")}),e.popupEle.setAttribute("role","region"),e.popupEle.setAttribute("aria-label",e.element.id),document.body.appendChild(e.popupEle),e.createPopup(e.popupEle)):(e.popupEle=e.popupObj.element,e.isReact&&e.isFilterRestore&&(e.isFilteredData=!0,e.popupEle.removeChild(e.filterContainer)))),(e.isFirstRender&&!i||e.isFilteredData)&&(e.isFilteredData=!1,Ii([e.popupDiv],e.popupEle),Z([e.popupDiv],Su),e.allowFiltering&&e.renderFilter(),e.showCheckBox&&e.showSelectAll&&!e.popupDiv.classList.contains(Xn)&&(e.createSelectAllWrapper(),e.popupEle.insertBefore(e.checkAllParent,e.popupDiv)),e.headerTemplate&&e.setHeaderTemplate(),e.footerTemplate&&e.setFooterTemplate(),e.isFirstRender=!1,e.hasTemplate&&e.portals&&(e.treeObj.portals&&(e.portals=e.portals.concat(e.treeObj.portals.filter(function(f){return!e.portals.includes(f)}))),e.isReact&&e.renderReactTemplates(e.reactCallBack))),!i){if(Pe(e.inputEle,{"aria-expanded":"true"}),e.popupObj.show(null,e.zIndex===1e3?e.inputEle:null),Z([e.popupEle],Su),e.updatePopupHeight(),e.popupObj.refreshPosition(),!(e.showSelectAll||e.allowFiltering)&&!e.popupDiv.classList.contains(Xn)&&e.treeItems.length>0){var a=e.value!=null&&e.text!=null?e.treeObj.element.querySelector('[data-uid="'+e.value[0]+'"]'):null;if(a)e.treeObj.element.querySelector("li").setAttribute("tabindex","-1"),a.setAttribute("tabindex","0");else{var o=e.treeObj.element.querySelector(".e-node-focus");a=e.treeObj.element.querySelector('li[tabindex="0"]:not(.e-disable)')||e.treeObj.element.querySelector("li:not(.e-disable)"),e.removeFocus(a,o)}e.updateFocus(a)}if(e.treeObj.checkedNodes.length>0&&!e.isFilterRestore){var l=e.treeObj.element.querySelectorAll("li:not(.e-disable)"),h=e.treeObj.element.querySelectorAll("li[aria-checked=true]");if(h.length===l.length&&e.checkBoxElement){var u=X(e.checkBoxElement,"."+bd);e.changeState(u,"check"),e.checkSelectAll=!1}}if(e.showSelectAll&&!e.allowFiltering){var o=e.treeObj.element.querySelector(".e-node-focus"),a=e.popupEle.querySelector(".e-selectall-parent");e.removeFocus(a,o),e.updateFocus(a)}if(e.allowFiltering){var a=e.treeObj.element.querySelector("li.e-node-focus");m(a)||Z([a],"e-node-focus"),Z([e.inputWrapper],[Gn]),e.filterObj.element.focus()}var c={popup:e.popupObj};e.trigger("open",c)}})},t.prototype.removeFocus=function(e,i){i&&i!==e&&(i.setAttribute("tabindex","-1"),Z([i],"e-node-focus"))},t.prototype.updateFocus=function(e){m(e)||(e.focus(),P([e],["e-node-focus"]))},t.prototype.reactCallBack=function(){m(this.popupObj)||(this.updatePopupHeight(),this.popupObj.refreshPosition())},t.prototype.updatePopupHeight=function(){if(!this.isFirstRender){var e=this.getHeight();if(this.popupEle.style.maxHeight=e,this.allowFiltering){var i=Math.round(this.filterContainer.getBoundingClientRect().height);e=st(parseInt(e,10)-i+"px")}if(this.headerTemplate){var i=Math.round(this.header.getBoundingClientRect().height);e=st(parseInt(e,10)-i+"px")}if(this.showCheckBox&&this.showSelectAll&&!this.popupDiv.classList.contains(Xn)){var i=Math.round(this.checkAllParent.getBoundingClientRect().height);e=st(parseInt(e,10)-i+"px")}if(this.footerTemplate){var i=Math.round(this.footer.getBoundingClientRect().height);e=st(parseInt(e,10)-i+"px")}var r=parseInt(window.getComputedStyle(this.popupEle).borderTopWidth,10);r=r+parseInt(window.getComputedStyle(this.popupEle).borderBottomWidth,10),e=st(parseInt(e,10)-r+"px"),this.popupDiv.style.maxHeight=e}},t.prototype.createPopup=function(e){var i=this;this.isFirstRender&&(this.popupObj=new Bo(e,{width:this.setWidth(),targetType:"relative",collision:{X:"flip",Y:"flip"},relateTo:this.inputWrapper,zIndex:this.zIndex,enableRtl:this.enableRtl,position:{X:"left",Y:"bottom"},close:function(){i.isPopupOpen=!1},open:function(){document.addEventListener("mousedown",i.documentClickContext),i.isPopupOpen=!0},targetExitViewport:function(){xe.isDevice||i.hidePopup()}}))},t.prototype.setElementWidth=function(e){var i=this.inputWrapper;m(e)||(typeof e=="number"?i.style.width=st(e):typeof e=="string"&&(i.style.width=e.match(/px|%|em/)?e:st(e)))},t.prototype.setWidth=function(){var e=st(this.popupWidth);return e.indexOf("%")>-1?e=(this.inputWrapper.offsetWidth*parseFloat(e)/100).toString()+"px":typeof this.popupWidth=="string"&&(e=this.popupWidth.match(/px|em/)?this.popupWidth:e),e},t.prototype.getHeight=function(){var e=st(this.popupHeight);return e.indexOf("%")>-1?e=(document.documentElement.clientHeight*parseFloat(e)/100).toString()+"px":typeof this.popupHeight=="string"&&(e=this.popupHeight.match(/px|em/)?this.popupHeight:e),e},t.prototype.onDocumentClick=function(e){var i=e.target,r=X(i,"."+Vb),n=X(i,"."+Ub),a=X(i,"."+Gb),o=X(i,"."+qb),l=i.classList.contains(Wb)?!0:Ud(i,".e-ddt .e-popup")||Ud(i,".e-ddt .e-treeview");this.isPopupOpen&&(!m(this.inputWrapper)&&this.inputWrapper.contains(i)||r||l||a||o)||(this.allowMultiSelection||this.showCheckBox)&&(this.isPopupOpen&&i.classList.contains(vd)||this.isPopupOpen&&(i.classList.contains(ku)||i.classList.contains(jb)||i.classList.contains(gd)))?(this.isDocumentClick=!1,e.preventDefault()):!m(this.inputWrapper)&&!this.inputWrapper.contains(i)&&this.inputFocus&&!n&&this.focusOut(e)},t.prototype.onActionFailure=function(e){this.trigger("actionFailure",e),this.l10nUpdate(!0),P([this.popupDiv],Xn)},t.prototype.OnDataBound=function(e){this.treeItems=e.data,this.treeItems.length<=0?(this.l10nUpdate(),P([this.popupDiv],Xn),this.hideCheckAll(!0)):this.popupDiv.classList.contains(Xn)&&this.treeItems.length>=1&&(Z([this.popupDiv],Xn),this.hideCheckAll(!1)),this.isFilteredData||(this.treeDataType=this.getTreeDataType(this.treeItems,this.fields)),this.isFirstRender&&this.isRemoteData&&(this.setTreeValue(),this.setTreeText(),this.updateHiddenValue(),this.setSelectedValue(),this.wrapText||this.updateView(),this.treeObj.element.focus(),this.isInitialized=!0);var i={data:e.data};this.trigger("dataBound",i),this.filterObj===null&&(this.isFilteredData=!1),this.isFilteredData&&this.treeObj.expandAll(),this.isFilterRestore&&(this.restoreFilterSelection(),this.showSelectAll||(this.isFilterRestore=!1))},t.prototype.restoreFilterSelection=function(){this.showCheckBox?this.treeObj.checkedNodes=this.value?this.value:[]:this.treeObj.selectedNodes=this.value?this.value:[]},t.prototype.setCssClass=function(e,i){var r=this.popupObj?[this.inputWrapper,this.popupObj.element]:[this.inputWrapper];!m(i)&&i!==""&&Z(r,i.split(" ")),!m(e)&&e!==""&&P(r,e.split(" "))},t.prototype.setEnableRTL=function(e){e?this.inputWrapper.classList.add(Fb):this.inputWrapper.classList.remove(Fb),this.popupObj&&(this.popupObj.enableRtl=e,this.popupObj.dataBind()),this.treeObj&&(this.treeObj.enableRtl=e,this.treeObj.dataBind())},t.prototype.setEnable=function(){Te.setEnabled(this.enabled,this.inputEle),this.enabled?(Z([this.inputWrapper],zb),this.inputEle.setAttribute("aria-disabled","false"),this.inputWrapper.setAttribute("aria-disabled","false")):(this.isPopupOpen&&this.hidePopup(),P([this.inputWrapper],zb),this.inputWrapper&&this.inputWrapper.classList.contains(Gn)&&Z([this.inputWrapper],[Gn]),this.inputEle.setAttribute("aria-disabled","true"),this.inputWrapper.setAttribute("aria-disabled","true"))},t.prototype.cloneFields=function(e){var i={dataSource:e.dataSource,value:e.value,text:e.text,parentValue:e.parentValue,child:this.cloneChildField(e.child),hasChildren:e.hasChildren,expanded:e.expanded,iconCss:e.iconCss,imageUrl:e.imageUrl,htmlAttributes:e.htmlAttributes,query:e.query,selected:e.selected,selectable:e.selectable,tableName:e.tableName,tooltip:e.tooltip};return i},t.prototype.cloneChildField=function(e){if(typeof e=="string")return e;var i={dataSource:e.dataSource,value:e.value,text:e.text,parentValue:e.parentValue,child:e.child?this.cloneChildField(e.child):null,hasChildren:e.hasChildren,expanded:e.expanded,iconCss:e.iconCss,imageUrl:e.imageUrl,htmlAttributes:e.htmlAttributes,query:e.query,selected:e.selected,selectable:e.selectable,tableName:e.tableName,tooltip:e.tooltip};return i},t.prototype.getTreeFields=function(e){var i={dataSource:e.dataSource,id:e.value,text:e.text,parentID:e.parentValue,child:this.getTreeChildren(e.child),hasChildren:e.hasChildren,expanded:e.expanded,iconCss:e.iconCss,imageUrl:e.imageUrl,isChecked:e.selected,htmlAttributes:e.htmlAttributes,query:e.query,selectable:e.selectable,selected:e.selected,tableName:e.tableName,tooltip:e.tooltip};return i},t.prototype.getTreeChildren=function(e){if(typeof e=="string")return e;if(!m(e)){e=this.getActualProperties(e);var i=e;return e.value&&(i.id=e.value),e.parentValue&&(i.parentID=e.parentValue),e.child&&(i.child=this.getTreeChildren(e.child)),e.selected&&this.showCheckBox&&(i.isChecked=e.selected),i}return null},t.prototype.getTreeDataType=function(e,i){if(this.fields.dataSource instanceof fe){for(var r=0;r<e.length;r++)if(typeof i.child=="string"&&m(ie(i.child,e[r])))return 1;return 2}m(this.fields.dataSource)&&(this.fields.dataSource=[]);for(var r=0,n=this.fields.dataSource.length;r<n;r++){if(typeof i.child=="string"&&!m(ie(i.child,this.fields.dataSource[r])))return 2;if(!m(ie(i.parentValue,this.fields.dataSource[r]))||!m(ie(i.hasChildren,this.fields.dataSource[r])))return 1}return 1},t.prototype.setFields=function(){this.resetValue(),this.hasTemplate&&this.updateTemplate(),this.treeObj.fields=this.getTreeFields(this.fields),this.setProperties({value:this.oldValue},!0),this.treeObj.dataBind(),this.updateValue(this.value)},t.prototype.getEventArgs=function(e){var i=e.data,r=e.nodeData,n;this.showCheckBox&&(e.action==="check"?n="select":e.action==="uncheck"&&(n="un-select"));var a={action:this.showCheckBox?n:e.action,isInteracted:this.isClicked?!0:e.isInteracted,item:e.node,itemData:this.showCheckBox?i[0]:r};return a},t.prototype.onBeforeSelect=function(e){e.isInteracted&&(this.setOldValue(),this.value===null&&this.setProperties({value:[]},!0))},t.prototype.updateHiddenValue=function(){this.allowMultiSelection||this.showCheckBox||(this.value&&this.value.length?this.hiddenElement.innerHTML='<option selected value ="'+this.value[0]+'">'+this.text+"</option>":this.hiddenElement.innerHTML="")},t.prototype.onNodeSelected=function(e){if(!this.showCheckBox){var i=this.getEventArgs(e);this.trigger("select",i);var r;if(e.isInteracted){var n=ie("id",e.nodeData).toString();this.allowMultiSelection?this.allowMultiSelection&&this.setMultiSelect():(this.hiddenElement.innerHTML="",this.setProperties({value:[n]},!0),this.itemTemplate?r=ie("text",this.treeObj.getNode(n)):r=ie("text",e.nodeData).toString(),Te.setValue(r,this.inputEle,this.floatLabelType),this.setProperties({text:r},!0),this.currentText=this.text,this.currentValue=this.value,this.setValueTemplate(),!m(this.value)&&this.value.length>0&&this.inputWrapper.setAttribute("aria-label",e.nodeData.text.toString()),Pe(this.inputWrapper,{"aria-describedby":this.element.id}),Pe(this.inputWrapper,{"aria-activedescendant":n.toString()}),this.updateHiddenValue(),this.showOverAllClear(),this.hidePopup(),this.isNodeSelected=!0)}this.isValueChange&&!this.changeOnBlur&&(this.triggerChangeEvent(this.keyEventArgs),this.isValueChange=!1)}},t.prototype.onNodeClicked=function(e){!this.changeOnBlur&&this.isNodeSelected&&(this.triggerChangeEvent(e.event),this.isNodeSelected=!1);var i=e.event.target;if((i.classList.contains("e-fullrow")||i.classList.contains("e-list-text"))&&this.showCheckBox){this.isClicked=!0;var r=this.treeObj.getNode(e.node);r.isChecked==="true"?this.treeObj.uncheckAll([e.node]):this.treeObj.checkAll([e.node]),this.isClicked=!1,this.setMultiSelect(),this.ensurePlaceHolder()}!this.changeOnBlur&&(this.allowMultiSelection||this.showCheckBox)&&this.triggerChangeEvent(e.event)},t.prototype.onNodeChecked=function(e){var i=this.getEventArgs(e);if(this.trigger("select",i),this.isFilteredData&&e.action==="uncheck"){var r=ie("id",e.data[0]).toString();this.removeSelectedData(r,!0)}if((!this.isChipDelete&&e.isInteracted||!this.isFilteredData&&e.action==="check"&&this.isFromFilterChange)&&(this.setMultiSelect(),this.ensurePlaceHolder()),this.showSelectAll&&this.checkBoxElement){var n=this.treeObj.element.querySelectorAll("li:not(.e-disable)"),a=this.treeObj.element.querySelectorAll("li[aria-checked=true]"),o=X(this.checkBoxElement,"."+bd);o&&e.action==="uncheck"&&(e.isInteracted||a.length===0||!m(e.data[0])&&e.data[0].isChecked==="false")||!e.isInteracted&&this.isFilterRestore?(this.isFilterRestore=!1,this.isReverseUpdate=!0,this.changeState(o,"uncheck"),this.isReverseUpdate=!1):o&&e.action==="check"&&a.length===n.length&&(e.isInteracted||this.isCheckAllCalled||!m(e.data[0])&&e.data[0].isChecked==="true")&&(this.isReverseUpdate=!0,this.isCheckAllCalled=!1,this.changeState(o,"check"),this.isReverseUpdate=!1)}this.isValueChange&&!this.changeOnBlur&&(this.triggerChangeEvent(this.keyEventArgs),this.isValueChange=!1)},t.prototype.beforeCheck=function(e){e.isInteracted&&this.setOldValue()},t.prototype.onNodeExpanded=function(){if(this.hasTemplate&&this.portals&&this.treeObj.portals){for(var e=0;e<this.treeObj.portals.length;e++)this.portals.indexOf(this.treeObj.portals[e])===-1&&this.portals.push(this.treeObj.portals[e]);this.renderReactTemplates()}},t.prototype.updateClearButton=function(e){if(e?this.inputWrapper.contains(this.overAllClear)?(Z([this.overAllClear],xt),P([this.inputWrapper],qn)):this.inputEle.parentElement.insertBefore(this.overAllClear,this.inputEle.nextSibling):(P([this.overAllClear],xt),Z([this.inputWrapper],qn)),(this.allowMultiSelection||this.showCheckBox)&&this.chipWrapper)for(var i=dt("."+vd,this.chipWrapper),r=0;r<i.length;r++)e?Z([i[r]],xt):P([i[r]],xt)},t.prototype.updateDropDownIconState=function(e){var i=ye("."+$b,this.inputWrapper);e?(i?Z([i],xt):Te.appendSpan(Mb,this.inputWrapper,this.createElement),P([this.inputWrapper],pd)):(P([i],xt),Z([this.inputWrapper],pd))},t.prototype.updateMode=function(){if(this.mode!=="Custom")if(this.mode!=="Delimiter"){this.inputWrapper.contains(this.chipWrapper)||this.createChip();var e=this.getValidMode();this.chipWrapper.classList.contains(xt)&&e?(Z([this.chipWrapper],xt),this.showOrHideValueTemplate(!1,!0),P([this.inputWrapper],cr)):e||(P([this.chipWrapper],xt),Z([this.inputWrapper],cr),this.showOrHideValueTemplate(!0));var i=this.value!==null?this.value.length!==0:!1;e&&i?P([this.inputEle],Si):Z([this.inputEle],Si)}else this.inputEle.classList.contains(Si)&&(Z([this.inputEle],Si),this.chipWrapper&&(P([this.chipWrapper],xt),Z([this.inputWrapper],cr),this.showOrHideValueTemplate(!0)))},t.prototype.ensurePlaceHolder=function(){(m(this.value)||this.value!==null&&this.value.length===0)&&(Z([this.inputEle],Si),this.chipWrapper&&(P([this.chipWrapper],xt),this.showOrHideValueTemplate(!0)))},t.prototype.ensureClearIconPosition=function(e){e!=="Never"&&this.inputWrapper.insertBefore(this.overAllClear,this.inputObj.buttons[0])},t.prototype.setMultiSelectValue=function(e){var i=this;if(!this.isFilteredData)this.setProperties({value:this.isFromFilterChange&&e&&e.length===0?this.value:e},!0),this.isFromFilterChange=!1,e&&e.length!==0&&!this.showCheckBox&&!this.ddtCompareValues(this.treeObj.selectedNodes,this.value.slice())&&(this.treeObj.selectedNodes=this.value.slice(),this.treeObj.dataBind());else{var r=m(this.value)?[]:this.value;r=r.filter(function(a){var o=i.treeObj.getTreeData(a);return Array.isArray(o)?o.every(function(l){return l.selected}):!0});for(var n=0;n<e.length;n++)(m(this.value)||this.value.indexOf(e[n])===-1)&&r.push(e[n]);this.setProperties({value:r},!0)}},t.prototype.setMultiSelect=function(){if(this.showCheckBox&&!this.isDynamicChange)this.setMultiSelectValue(this.treeObj.checkedNodes.slice());else{var e=this.allowMultiSelection?this.showCheckBox?this.treeObj.checkedNodes:this.treeObj.selectedNodes:this.value?this.showCheckBox?this.value:[this.value[0]]:null;this.setMultiSelectValue(e),this.showCheckBox&&this.value!==null&&(this.treeObj.checkedNodes=this.value,this.treeObj.dataBind())}this.selectedText=[];var i=this.allowMultiSelection?!0:!!this.showCheckBox;this.inputWrapper.contains(this.chipWrapper)&&!i&&(Z([this.inputEle],Si),Oe(this.chipWrapper));var r=this.getValidMode();r&&this.value!==null&&(P([this.inputEle],Si),this.chipWrapper&&(Z([this.chipWrapper],xt),this.showOrHideValueTemplate(!1,!0)));var n=this.value?!!this.value.length:!1;this.chipWrapper&&this.mode==="Box"&&!n&&(P([this.chipWrapper],xt),Z([this.inputEle],Si),this.showOrHideValueTemplate(!0)),this.updateSelectedValues()},t.prototype.getSelectedData=function(e){var i=null;if(this.isFilteredData){for(var r=0;r<this.selectedData.length;r++)if(ie(this.treeSettings.loadOnDemand?this.fields.value:"id",this.selectedData[r]).toString()===e){i=this.selectedData[r];break}}return m(i)&&(this.treeSettings.loadOnDemand?i=this.getNodeData(e,this.treeItems):i=this.treeObj.getNode(e),m(i)||this.selectedData.push(i)),i},t.prototype.getNodeData=function(e,i){var r;if(m(e))return r;if(this.treeDataType===1)for(var n=0,a=i.length;n<a;n++){var o=ie(this.fields.value,i[n]);if(!m(i[n])&&!m(o)&&o.toString()===e)return i[n]}else return this.getChildNodeData(i,this.fields,e);return r},t.prototype.getChildNodeData=function(e,i,r){var n;if(m(e))return n;for(var a=0,o=e.length;a<o;a++){var l=ie(i.value,e[a]);if(e[a]&&l&&l.toString()===r)return e[a];if(typeof i.child=="string"&&!m(ie(i.child,e[a]))){var h=ie(i.child,e[a]);if(n=this.getChildNodeData(h,this.getChildMapperFields(i),r),n!==void 0)break}else if(this.fields.dataSource instanceof fe&&!m(ie("child",e[a]))){var u="child";if(n=this.getChildNodeData(ie(u,e[a]),this.getChildMapperFields(i),r),n!==void 0)break}}return n},t.prototype.getChildMapperFields=function(e){return typeof e.child=="string"||m(e.child)?e:e.child},t.prototype.removeSelectedData=function(e,i){var r=m(this.value)?[]:this.value.slice();r.splice(r.indexOf(e),1),this.setProperties({value:r},i);for(var n=0;n<this.selectedData.length;n++)if(ie(this.treeSettings.loadOnDemand?this.fields.value:"id",this.selectedData[n]).toString()===e){this.selectedData.splice(n,1);break}},t.prototype.initializeValueTemplate=function(){if(!this.valueTemplate)return null;if(this.valueTemplateContainer)for(;this.valueTemplateContainer.firstChild;)this.valueTemplateContainer.removeChild(this.valueTemplateContainer.firstChild);else this.valueTemplateContainer=this.createElement("span",{className:xd+" "+Kn+" e-input-value "+xt});return this.inputWrapper.insertBefore(this.valueTemplateContainer,this.inputEle),this.templateComplier(this.valueTemplate)},t.prototype.showOrHideValueTemplate=function(e,i){i===void 0&&(i=!1),!(!this.valueTemplateContainer||this.mode==="Box")&&(e?(Z([this.valueTemplateContainer],xt),P([this.inputWrapper],cr),P([this.inputEle],Si)):(P([this.valueTemplateContainer],xt),i||(Z([this.inputWrapper],cr),Z([this.inputEle],Si))))},t.prototype.updateSelectedValues=function(){var e=this;this.dataValue="";var i,r,n="",a;this.hiddenElement.innerHTML="";var o="";if((!this.isChipDelete||this.treeSettings.autoCheck)&&this.inputWrapper.contains(this.chipWrapper)&&(this.chipCollection.innerHTML=""),this.isFilteredData||(this.selectedData=[]),!m(this.value)){for(var l=this.initializeValueTemplate(),h=0,u=this.value.length;h<u;h++)a=this.getSelectedData(this.value[h]),r=ie(this.treeSettings.loadOnDemand?this.fields.text:"text",a),this.selectedText.push(r),i=this.selectedText[this.selectedText.length-1],this.selectedText.length>1?(this.dataValue+=this.delimiterChar+" "+i,n+=","+i):(this.dataValue+=i,n+=i),this.mode!=="Custom"&&this.mode!=="Delimiter"&&(!this.isChipDelete||this.treeSettings.autoCheck)&&(this.allowMultiSelection||this.showCheckBox)&&this.setChipValues(i,this.value[h]),o+='<option selected value ="'+this.value[h]+'">'+this.selectedText[this.selectedText.length-1]+"</option>",this.valueTemplate&&this.getValueTemplateElement(this.value[h],l);this.hasTemplate&&this.portals&&(this.treeObj.portals&&(this.portals=this.portals.concat(this.treeObj.portals.filter(function(f){return!e.portals.includes(f)}))),this.isReact&&this.renderReactTemplates(this.reactCallBack)),this.selectedText.length>=1&&this.setProperties({text:n},!0),this.hiddenElement.innerHTML=o,this.mode==="Custom"&&(this.allowMultiSelection||this.showCheckBox)&&this.setTagValues()}var c=this.getValidMode();this.mode!=="Custom"&&this.mode!=="Box"&&(this.allowMultiSelection||this.showCheckBox)&&!c&&(this.chipWrapper&&(P([this.chipWrapper],xt),Z([this.inputWrapper],cr)),this.showOrHideValueTemplate(!0)),Te.setValue(this.dataValue,this.inputEle,this.floatLabelType),n===""?this.setProperties({text:null},!0):this.setProperties({text:n},!0),this.showClearButton&&this.inputFocus&&this.showOverAllClear(),(this.allowMultiSelection||this.showCheckBox)&&this.popupObj&&this.popupObj.refreshPosition(),this.currentText=this.text,this.currentValue=this.value,!m(this.value)&&this.value.length>0&&!m(this.currentText)?this.inputWrapper.setAttribute("aria-label",this.currentText.replace(/,/g,", ")):this.inputWrapper.setAttribute("aria-label",this.getModuleName())},t.prototype.setChipValues=function(e,i){this.inputWrapper.contains(this.chipWrapper)||this.createChip();var r=this.createElement("span",{className:md,attrs:{"data-value":i}}),n=this.createElement("span",{className:Hb}),a=this.createElement("span",{className:vd+" "+DH});this.enableHtmlSanitizer?n.innerText=mr.sanitize(e):n.innerHTML=e,r.appendChild(n),this.chipCollection.appendChild(r),this.showClearButton&&(r.appendChild(a),R.add(a,"mouseup",this.removeChip,this))},t.prototype.setTagValues=function(){if(this.value===null||this.text==null||this.value.length===0){this.inputWrapper.contains(this.chipWrapper)&&P([this.chipWrapper],xt);return}this.inputWrapper.contains(this.chipWrapper)||this.createChip(),this.inputWrapper.classList.contains(cr)||P([this.inputWrapper],cr);var e=this.createElement("span",{className:md});this.inputEle.classList.contains(Si)||P([this.inputEle],Si),this.chipWrapper.classList.contains(xt)&&(Z([this.chipWrapper],xt),this.showOrHideValueTemplate(!1,!0));var i=this.createElement("span",{className:Hb}),r=this.customTemplate,n=this.customTemplateId,a="customTemplate",o=this.templateComplier(r),l=o({value:this.value,text:this.text},this,a,n,this.isStringTemplate,void 0,i);l&&(l=Array.prototype.slice.call(l),at(l,i)),e.appendChild(i),this.chipCollection.appendChild(e),this.isReact&&this.renderReactTemplates()},t.prototype.setSelectAllWrapper=function(e){this.isFirstRender||(e&&!this.popupEle.contains(this.checkAllParent)&&this.showCheckBox?(this.createSelectAllWrapper(),this.popupEle.insertBefore(this.checkAllParent,this.popupDiv)):this.popupEle.contains(this.checkAllParent)&&(Oe(this.checkAllParent),this.checkAllParent=null))},t.prototype.setHeaderTemplate=function(){this.header?this.header.innerHTML="":(this.header=this.createElement("div"),P([this.header],Gb));var e=this.templateComplier(this.headerTemplate),i=e({},this,"headerTemplate",this.headerTemplateId,this.isStringTemplate,void 0,this.header);i&&(i=Array.prototype.slice.call(i),at(i,this.header)),this.popupEle.insertBefore(this.header,this.checkAllParent?this.checkAllParent:this.popupDiv)},t.prototype.templateComplier=function(e){if(e)try{return typeof e!="function"&&document.querySelectorAll(e).length?wt(document.querySelector(e).innerHTML.trim()):wt(e)}catch(i){return wt(e)}return wt(e)},t.prototype.setFooterTemplate=function(){this.footer?this.isReact&&typeof this.footerTemplate=="function"?this.clearTemplate(["footerTemplate"]):this.footer.innerHTML="":(this.footer=this.createElement("div"),P([this.footer],qb));var e=this.templateComplier(this.footerTemplate),i=e({},this,"footerTemplate",this.footerTemplateId,this.isStringTemplate,void 0,this.footer);i&&(i=Array.prototype.slice.call(i),at(i,this.footer)),at([this.footer],this.popupEle)},t.prototype.clearAll=function(e){!this.enabled||this.readonly||(this.resetValue(),this.showOverAllClear(),(this.allowMultiSelection||this.showCheckBox)&&(this.popupObj&&this.popupObj.refreshPosition(),this.wrapText||this.updateOverflowWrapper(!0)),e&&(this.isClearButtonClick=!0),this.changeOnBlur||this.triggerChangeEvent(e))},t.prototype.removeChip=function(e){if(!(!this.enabled||this.readonly)){e.target.classList.contains("e-chips-close")&&!this.isPopupOpen&&(e.stopPropagation(),e.preventDefault());var i=e.target.parentElement,r=i.getAttribute("data-value");this.chipCollection&&i&&Zi(i),this.isChipDelete=!0,this.isClearButtonClick=!0,this.removeSelectedData(r,!0),this.selectedText=[],this.allowMultiSelection&&(this.treeObj.selectedNodes=this.value.slice(),this.updateSelectedValues()),this.showCheckBox&&(this.treeObj.uncheckAll([r]),this.clearCheckAll(),this.setMultiSelect()),this.triggerChangeEvent(e),this.isChipDelete=!1,this.ensurePlaceHolder()}},t.prototype.resetValue=function(e){Array.isArray(this.value)&&this.value.length===0&&this.text==null||(Te.setValue(null,this.inputEle,this.floatLabelType),e||(this.setOldValue(),this.setProperties({value:[]},!0),this.showOrHideValueTemplate(!1)),(m(this.value)||this.value.length===0)&&this.inputWrapper.setAttribute("aria-label",this.getModuleName()),this.dataValue=null,this.setProperties({text:null},!0),this.selectedData=[],It("selectedNodes",[],this.treeObj),this.hiddenElement.innerHTML="",this.showCheckBox&&(this.treeObj.uncheckAll(),this.setMultiSelect(),this.clearCheckAll()),this.oldValue===null&&!e?this.removeValue=!0:e&&this.triggerChangeEvent(),(this.allowMultiSelection||this.showCheckBox)&&this.chipWrapper&&(this.chipCollection.innerHTML="",this.wrapText||this.updateOverflowWrapper(!0),this.ensurePlaceHolder()))},t.prototype.clearCheckAll=function(){this.showSelectAll&&this.value&&this.value.length===0&&this.setLocale(!1)},t.prototype.setOldValue=function(){this.oldValue=Array.isArray(this.value)?this.value.slice():this.value},t.prototype.selectAllItems=function(e){if(this.showCheckBox)e?(this.isCheckAllCalled=!0,this.treeObj.checkAll()):this.treeObj.uncheckAll(),this.checkSelectAll=e;else if(this.allowMultiSelection)if(!e)this.treeObj.selectedNodes=[];else{for(var i=dt("li",this.treeObj.element),r=void 0,n=[],a=0;a<i.length;a++)r=i[a].getAttribute("data-uid").toString(),n.push(r);this.treeObj.selectedNodes=n}this.updateMode(),this.setMultiSelect(),this.wrapText||(e?this.updateView():this.updateOverflowWrapper(!0))},t.prototype.updateTreeSettings=function(e){if(e==="autoCheck")this.treeObj.autoCheck=this.treeSettings.autoCheck;else if(e==="loadOnDemand")this.treeObj.loadOnDemand=this.treeSettings.loadOnDemand;else if(e==="expandOn"){this.treeObj.expandOn=this.treeSettings.expandOn,this.treeObj.dataBind();return}else e==="checkDisabledChildren"&&(this.treeObj.checkDisabledChildren=this.treeSettings.checkDisabledChildren);this.treeObj.dataBind(),this.setMultiSelect(),this.updateValue(this.value)},t.prototype.updateCheckBoxState=function(e){this.hasTemplate&&this.updateTemplate(),this.wrapText||this.updateOverflowWrapper(!1),this.treeObj.showCheckBox=e,this.treeObj.dataBind(),this.isDynamicChange=!0,this.setSelectAllWrapper(this.showSelectAll),this.showSelectAll&&this.setLocale(),this.showCheckBox&&this.updateMode(),this.setMultiSelect(),this.isDynamicChange=!1},t.prototype.updateTemplate=function(){this.popupObj&&(this.clearTemplate(),this.portals=[],this.popupObj.destroy(),this.isPopupOpen?(this.hidePopup(),this.isFirstRender=!0,this.renderPopup()):this.isFirstRender=!0)},t.prototype.l10nUpdate=function(e){if(this.noRecord?this.noRecord.innerHTML="":this.noRecord=this.createElement("div"),this.noRecordsTemplate!=="No Records Found"||this.actionFailureTemplate!=="The Request Failed"){var i=e?this.actionFailureTemplate:this.noRecordsTemplate,r=e?this.actionFailureTemplateId:this.noRecordsTemplateId,n=e?"actionFailureTemplate":"noRecordsTemplate",a=this.templateComplier(i),o=a({},this,n,r,this.isStringTemplate,void 0,this.noRecord);o&&(o=Array.prototype.slice.call(o),at(o,this.noRecord))}else{var l={noRecordsTemplate:"No Records Found",actionFailureTemplate:"The Request Failed"};this.l10n=new br(this.getLocaleName(),l,this.locale),this.noRecord.innerHTML=e?this.l10n.getConstant("actionFailureTemplate"):this.l10n.getConstant("noRecordsTemplate")}P([this.noRecord],IH),Ii([this.noRecord],this.popupDiv),this.treeObj&&this.treeObj.element.removeAttribute("aria-activedescendant")},t.prototype.updateRecordTemplate=function(e){this.treeItems&&this.treeItems.length<=0&&(this.l10nUpdate(e),this.hasTemplate&&this.updateTemplate())},t.prototype.updateOverflowWrapper=function(e){e?this.inputWrapper.contains(this.overFlowWrapper)&&e&&(this.overFlowWrapper.innerHTML=""):this.inputWrapper.contains(this.overFlowWrapper)||(this.overFlowWrapper=this.createElement("span",{className:xd+" "+xt}),this.inputWrapper.insertBefore(this.overFlowWrapper,this.hiddenElement))},t.prototype.updateMultiSelection=function(e){this.wrapText||this.updateOverflowWrapper(!1),this.treeObj.allowMultiSelection=e,this.treeObj.dataBind(),this.updateOption(),this.allowMultiSelection&&this.updateMode(),this.setMultiSelect()},t.prototype.updateAllowFiltering=function(e){this.isFirstRender||(e?this.renderFilter():this.destroyFilter())},t.prototype.updateFilterPlaceHolder=function(){this.filterObj&&(this.filterObj.placeholder=this.filterBarPlaceholder,this.filterObj.element.setAttribute("aria-label",this.filterBarPlaceholder))},t.prototype.updateValue=function(e){this.isDynamicChange=!0,m(e)||e.length===0?this.resetValue(!0):(this.setTreeValue(),(this.allowMultiSelection||this.showCheckBox)&&!this.wrapText&&(this.updateOverflowWrapper(!1),this.updateView())),this.updateHiddenValue(),this.isDynamicChange=!1},t.prototype.updateText=function(e){m(e)?this.resetValue():(this.setTreeText(),(this.allowMultiSelection||this.showCheckBox)&&!this.wrapText&&(this.updateOverflowWrapper(!1),this.updateView())),this.updateHiddenValue()},t.prototype.updateModelMode=function(){var e=this.allowMultiSelection?!0:!!this.showCheckBox;if(e){if(!this.wrapText){var i=ye(".e-overflow:not(.e-input-value)",this.inputWrapper);i&&(i.innerHTML="")}this.updateMode(),this.setMultiSelect(),!this.wrapText&&this.value&&this.value.length!==0&&(this.updateOverFlowView(),P([this.inputEle],Si),this.mode==="Box"?Z([this.overFlowWrapper,this.inputWrapper],Kn):P([this.overFlowWrapper,this.inputWrapper],Kn))}},t.prototype.updateOption=function(){!this.hiddenElement.hasAttribute("multiple")&&(this.allowMultiSelection||this.showCheckBox)?this.hiddenElement.setAttribute("multiple",""):this.hiddenElement.hasAttribute("multiple")&&!this.allowMultiSelection&&!this.showCheckBox&&this.hiddenElement.removeAttribute("multiple")},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];switch(a){case"width":this.setElementWidth(e.width),this.popupObj&&(this.popupObj.element.style.width=this.setWidth());break;case"placeholder":Te.setPlaceholder(e.placeholder,this.inputEle);break;case"cssClass":this.setCssClass(e.cssClass,i.cssClass);break;case"enableRtl":this.setEnableRTL(this.enableRtl);break;case"fields":this.setFields();break;case"readonly":Te.setReadonly(e.readonly,this.inputEle);break;case"enabled":this.setEnable();break;case"floatLabelType":Te.removeFloating(this.inputObj),Te.addFloating(this.inputEle,e.floatLabelType,this.placeholder,this.createElement),this.ensureClearIconPosition(e.floatLabelType);break;case"showClearButton":this.updateClearButton(e.showClearButton);break;case"allowFiltering":this.updateAllowFiltering(e.allowFiltering);break;case"filterBarPlaceholder":this.updateFilterPlaceHolder();break;case"value":JSON.stringify(i.value)!==JSON.stringify(e.value)&&(this.oldValue=i.value,this.updateValue(e.value));break;case"text":this.updateText(e.text);break;case"allowMultiSelection":this.updateMultiSelection(e.allowMultiSelection);break;case"mode":if(!this.showCheckBox&&!this.allowMultiSelection)return;this.mode==="Custom"?(this.overFlowWrapper&&Oe(this.overFlowWrapper),this.chipWrapper&&Oe(this.chipWrapper),this.setTagValues()):(i.mode==="Custom"&&this.updateOverflowWrapper(this.wrapText),this.updateModelMode());break;case"delimiterChar":if(this.mode==="Box")return;(this.showCheckBox||this.allowMultiSelection)&&this.setMultiSelect();break;case"selectAllText":this.showCheckBox&&this.showSelectAll&&this.setLocale();break;case"unSelectAllText":this.showCheckBox&&this.showSelectAll&&this.setLocale(!1);break;case"showSelectAll":this.showCheckBox&&(this.setSelectAllWrapper(e.showSelectAll),this.updatePopupHeight());break;case"showCheckBox":this.updateCheckBoxState(e.showCheckBox),this.wrapText||this.updateOverflowWrapper(!0),this.updatePopupHeight(),this.updateOption();break;case"treeSettings":for(var o=0,l=Object.keys(e.treeSettings);o<l.length;o++){var h=l[o];this.updateTreeSettings(h)}break;case"customTemplate":if(this.mode!=="Custom")return;this.chipCollection.innerHTML="",this.setTagValues();break;case"sortOrder":this.hasTemplate&&this.updateTemplate(),this.treeObj.sortOrder=e.sortOrder,this.treeObj.dataBind(),this.updateValue(this.value);break;case"showDropDownIcon":this.updateDropDownIconState(e.showDropDownIcon);break;case"popupWidth":this.popupObj&&(this.popupObj.element.style.width=this.setWidth());break;case"popupHeight":this.popupObj&&this.updatePopupHeight();break;case"zIndex":this.popupObj&&(this.popupObj.zIndex=e.zIndex,this.popupObj.dataBind());break;case"headerTemplate":this.updateTemplate();break;case"footerTemplate":this.updateTemplate();break;case"itemTemplate":this.updateTemplate(),this.treeObj.nodeTemplate=e.itemTemplate,this.treeObj.dataBind();break;case"noRecordsTemplate":this.updateRecordTemplate();break;case"actionFailureTemplate":this.updateRecordTemplate(!0);break;case"htmlAttributes":this.setHTMLAttributes();break;case"wrapText":this.updateOverflowWrapper(this.wrapText),(this.allowMultiSelection||this.showCheckBox)&&!this.wrapText?this.updateView():(P([this.overFlowWrapper],xt),this.chipWrapper&&this.mode==="Box"?Z([this.chipWrapper],xt):(Z([this.inputWrapper],cr),Z([this.inputEle],Si)),this.ensurePlaceHolder());break}}},t.prototype.clear=function(){this.clearAll(),this.inputFocus?this.onFocusOut():(this.changeOnBlur&&this.triggerChangeEvent(),this.removeValue=!1)},t.prototype.destroy=function(){for(this.clearTemplate(),this.unWireEvents(),this.setCssClass(null,this.cssClass),this.setProperties({text:null},!0),this.treeObj.destroy(),this.destroyFilter(),this.popupObj&&(this.popupObj.destroy(),Oe(this.popupObj.element)),this.element.tagName!==this.getDirective()&&this.inputWrapper.parentElement.insertBefore(this.element,this.inputWrapper),Te.setValue(null,this.inputEle,this.floatLabelType),Oe(this.inputWrapper),Oe(this.popupDiv),Oe(this.hiddenElement),Te.setRipple(!1,[this.inputObj]),this.element.classList.remove("e-input"),(this.showCheckBox||this.allowMultiSelection||this.value&&this.valueTemplateContainer)&&this.element.classList.remove(Si),Oe(this.inputObj.container),this.inputObj.buttons.length&&Oe(this.inputObj.buttons[0]),this.inputObj=null;this.hiddenElement.options.length>0;)this.hiddenElement.remove(0);if(this.hiddenElement.innerHTML="",this.hiddenElement=null,this.inputWrapper.innerHTML="",this.inputWrapper=null,this.popupDiv=null,this.tree=null,this.popupObj=null,this.treeObj=null,this.overAllClear=null,this.chipCollection)for(var e=dt(".e-chips-close",this.chipCollection),i=0,r=e;i<r.length;i++){var n=r[i];R.remove(n,"mouseup",this.removeChip)}this.chipWrapper=null,this.chipCollection=null,this.checkAllParent=null,this.selectAllSpan=null,this.checkBoxElement=null,this.checkWrapper=null,this.popupEle=null,this.header=null,this.footer=null,this.overFlowWrapper=null,this.keyboardModule=null,s.prototype.destroy.call(this),this.setProperties({value:[]},!0)},t.prototype.destroyFilter=function(){this.filterObj&&(this.filterObj.destroy(),Oe(this.filterObj.element),Oe(this.filterContainer),this.filterObj=null)},t.prototype.destroyPopup=function(){this.isPopupOpen=!1,this.isReact&&this.clearTemplate(["headerTemplate","footerTemplate","itemTemplate","actionFailureTemplate","noRecordsTemplate"]),this.popupObj&&(this.popupObj.destroy(),Oe(this.popupObj.element))},t.prototype.ensureVisible=function(e){this.treeObj.ensureVisible(e)},t.prototype.getData=function(e){return this.treeObj.getTreeData(e)},t.prototype.hidePopup=function(){var e={popup:this.popupObj,cancel:!1};this.trigger("close",e),!e.cancel&&(this.inputWrapper.classList.remove(Bb),this.popupEle&&P([this.popupEle],Su),Pe(this.inputEle,{"aria-expanded":"false"}),this.popupObj&&this.isPopupOpen&&(this.popupObj.hide(),this.inputFocus&&(this.inputWrapper.focus(),this.allowFiltering&&P([this.inputWrapper],[Gn])),this.isFilteredData&&(this.treeObj.treeData=this.treeData),this.destroyPopupOnHide&&(this.isFirstRender=!0,this.destroyPopup())))},t.prototype.selectAll=function(e){this.selectAllItems(e)},t.prototype.showPopup=function(){!this.enabled||this.readonly||this.isPopupOpen||(this.renderPopup(),this.focusIn())},t.prototype.getModuleName=function(){return"dropdowntree"},qe([O("The Request Failed")],t.prototype,"actionFailureTemplate",void 0),qe([O(!1)],t.prototype,"allowFiltering",void 0),qe([O(!1)],t.prototype,"allowMultiSelection",void 0),qe([O(!0)],t.prototype,"changeOnBlur",void 0),qe([O("")],t.prototype,"cssClass",void 0),qe([O("${value.length} item(s) selected")],t.prototype,"customTemplate",void 0),qe([O(",")],t.prototype,"delimiterChar",void 0),qe([O(!0)],t.prototype,"enabled",void 0),qe([Ur({},BH)],t.prototype,"fields",void 0),qe([O(null)],t.prototype,"filterBarPlaceholder",void 0),qe([O("StartsWith")],t.prototype,"filterType",void 0),qe([O("Never")],t.prototype,"floatLabelType",void 0),qe([O(null)],t.prototype,"footerTemplate",void 0),qe([O(!1)],t.prototype,"ignoreAccent",void 0),qe([O(!0)],t.prototype,"ignoreCase",void 0),qe([O(null)],t.prototype,"headerTemplate",void 0),qe([O({})],t.prototype,"htmlAttributes",void 0),qe([O(null)],t.prototype,"itemTemplate",void 0),qe([O("Default")],t.prototype,"mode",void 0),qe([O("No Records Found")],t.prototype,"noRecordsTemplate",void 0),qe([O(null)],t.prototype,"placeholder",void 0),qe([O("300px")],t.prototype,"popupHeight",void 0),qe([O("100%")],t.prototype,"popupWidth",void 0),qe([O(!1)],t.prototype,"readonly",void 0),qe([O(!1)],t.prototype,"showSelectAll",void 0),qe([O("Select All")],t.prototype,"selectAllText",void 0),qe([O(!1)],t.prototype,"showCheckBox",void 0),qe([O(!0)],t.prototype,"destroyPopupOnHide",void 0),qe([O(!0)],t.prototype,"enableHtmlSanitizer",void 0),qe([O(!0)],t.prototype,"showClearButton",void 0),qe([O(!0)],t.prototype,"showDropDownIcon",void 0),qe([O("None")],t.prototype,"sortOrder",void 0),qe([O(null)],t.prototype,"text",void 0),qe([Ur({},HH)],t.prototype,"treeSettings",void 0),qe([O("Unselect All")],t.prototype,"unSelectAllText",void 0),qe([O(null)],t.prototype,"value",void 0),qe([O(null)],t.prototype,"valueTemplate",void 0),qe([O("100%")],t.prototype,"width",void 0),qe([O(1e3)],t.prototype,"zIndex",void 0),qe([O(!1)],t.prototype,"wrapText",void 0),qe([Se()],t.prototype,"actionFailure",void 0),qe([Se()],t.prototype,"beforeOpen",void 0),qe([Se()],t.prototype,"change",void 0),qe([Se()],t.prototype,"close",void 0),qe([Se()],t.prototype,"blur",void 0),qe([Se()],t.prototype,"created",void 0),qe([Se()],t.prototype,"dataBound",void 0),qe([Se()],t.prototype,"destroyed",void 0),qe([Se()],t.prototype,"filtering",void 0),qe([Se()],t.prototype,"focus",void 0),qe([Se()],t.prototype,"keyPress",void 0),qe([Se()],t.prototype,"open",void 0),qe([Se()],t.prototype,"select",void 0),t=qe([Wi],t),t}(Rr),fp="e-float-line",ch="e-float-text",Do="e-label-top",ka="e-label-bottom";function Xb(s,t,e,i,r,n,a){var o=Cs("span",{className:fp}),l=Cs("label",{className:ch}),h=e.getAttribute("id")?e.getAttribute("id"):fi("ej2_multiselect");e.id=h,!m(e.id)&&e.id!==""&&(l.id="label_"+e.id.replace(/ /g,"_"),l.setAttribute("for",e.id),Pe(i,{"aria-labelledby":l.id})),!m(i.placeholder)&&i.placeholder!==""&&(l.innerText=dp(i.placeholder),i.removeAttribute("placeholder")),l.innerText=dp(a),t.appendChild(o),t.appendChild(l),s.classList.add("e-float-input"),WH(r,l),n==="Always"&&(l.classList.contains(ka)&&Z([l],ka),P([l],Do))}function WH(s,t){s&&s.length>0?(P([t],Do),Z([t],ka)):(Z([t],Do),P([t],ka))}function zH(s,t,e,i,r,n,a){var o=t.querySelector("."+ch),l=t.querySelector("."+fp),h;m(o)?(h=a!==null?a:"",Kb(r,i,h)):(h=o.innerText,Oe(e.querySelector("."+ch)),Kb(r,i,h),m(l)||Oe(e.querySelector("."+fp))),s.classList.remove("e-float-input")}function Kb(s,t,e){s&&s.length?t.placeholder="":t.placeholder=e}function jH(s,t){s.classList.add("e-input-focus");var e=t.querySelector("."+ch);m(e)||(P([e],Do),e.classList.contains(ka)&&Z([e],ka))}function UH(s,t,e,i,r){s.classList.remove("e-input-focus");var n=t.querySelector("."+ch);e&&e.length<=0&&i==="Auto"&&!m(n)&&(n.classList.contains(Do)&&Z([n],Do),P([n],ka))}function dp(s){var t="";if(!m(s)&&s!==""){var e=document.createElement("span");e.innerHTML='<input  placeholder="'+s+'"/>';var i=e.children[0];t=i.placeholder}return t}var $H=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ke=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Yn="e-input-focus",dl="e-disabled",qH="e-multiselect e-input-group e-control-wrapper",GH="e-multi-select-wrapper",XH="e-mob-wrapper",Ot="e-hide-listitem",KH="e-delim-view",YH="e-chips-collection",Ja="e-chips",JH="e-chipcontent",Au="e-chips-close",un="e-chip-selected",QH="e-searcher",Yb="e-delimiter",Ou="e-zero-size",ZH="e-remain",Jb="e-chips-close e-close-hooker",Qb="e-delim-values",e3="e-ddl e-popup e-multi-select-list-wrapper",t3="e-dropdownbase",Zb="e-rtl",Cd="e-close-icon-hide",i3="e-mob-chip",r3="e-ddl-footer",s3="e-ddl-header",ey="e-ddl-disable-icon",ty="e-ms-spinner-icon",n3="e-multi-hidden",a3="destroy",iy="e-input-group-icon e-ddl-icon",ry="e-icon-anim",Du="e-delim-total",o3="e-multiselect-box",l3="e-filter-parent",sy="e-search-custom-width",wd="e-input-filter",h3="e-resizer-right e-icons",Ed=function(s){$H(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.clearIconWidth=0,r.previousFilterText="",r.storedSelectAllHeight=0,r.isUpdateHeaderHeight=!1,r.isUpdateFooterHeight=!1,r.isBlurDispatching=!1,r.isFilterPrevented=!1,r.isFilteringAction=!1,r.isValidKey=!1,r.selectAllEventData=[],r.selectAllEventEle=[],r.preventSetCurrentData=!1,r.isSelectAllLoop=!1,r.scrollFocusStatus=!1,r.keyDownStatus=!1,r}return t.prototype.enableRTL=function(e){e?this.overAllWrapper.classList.add(Zb):this.overAllWrapper.classList.remove(Zb),this.popupObj&&(this.popupObj.enableRtl=e,this.popupObj.dataBind())},t.prototype.requiredModules=function(){var e=[];if(this.enableVirtualization&&e.push({args:[this],member:"VirtualScroll"}),this.mode==="CheckBox"){if(this.isGroupChecking=this.enableGroupCheckBox,this.enableGroupCheckBox){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.enableSelectionOrder=!1,this.isProtectedOnChange=i}this.allowCustomValue=!1,this.hideSelectedItem=!1,this.closePopupOnSelect=!1,e.push({member:"CheckBoxSelection",args:[this]})}return e},t.prototype.updateHTMLAttribute=function(){if(Object.keys(this.htmlAttributes).length)for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];switch(r){case"class":{var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&(P([this.overAllWrapper],n.split(" ")),P([this.popupWrapper],n.split(" ")));break}case"disabled":this.enable(!1);break;case"placeholder":this.placeholder||(this.inputElement.setAttribute(r,this.htmlAttributes[""+r]),this.setProperties({placeholder:this.inputElement.placeholder},!0),this.refreshPlaceHolder());break;default:{var a=["id"],o=["name","required","aria-required","form"],l=["title","role","style","class"];a.indexOf(r)>-1?this.element.setAttribute(r,this.htmlAttributes[""+r]):r.indexOf("data")===0||o.indexOf(r)>-1?this.hiddenElement.setAttribute(r,this.htmlAttributes[""+r]):l.indexOf(r)>-1?this.overAllWrapper.setAttribute(r,this.htmlAttributes[""+r]):r!=="size"&&!m(this.inputElement)&&this.inputElement.setAttribute(r,this.htmlAttributes[""+r]);break}}}},t.prototype.updateReadonly=function(e){m(this.inputElement)||(e||this.mode==="CheckBox"?this.inputElement.setAttribute("readonly","true"):this.inputElement.removeAttribute("readonly"))},t.prototype.updateClearButton=function(e){e?(this.overAllClear.parentNode?this.overAllClear.style.display="":this.componentWrapper.appendChild(this.overAllClear),this.componentWrapper.classList.remove(Cd)):(this.overAllClear.style.display="none",this.componentWrapper.classList.add(Cd))},t.prototype.updateCssClass=function(){if(!m(this.cssClass)&&this.cssClass!==""){var e=this.cssClass;e=this.cssClass.replace(/\s+/g," ").trim(),e!==""&&(P([this.overAllWrapper],e.split(" ")),P([this.popupWrapper],e.split(" ")))}},t.prototype.updateOldPropCssClass=function(e){!m(e)&&e!==""&&(e=e.replace(/\s+/g," ").trim(),e!==""&&(Z([this.overAllWrapper],e.split(" ")),Z([this.popupWrapper],e.split(" "))))},t.prototype.onPopupShown=function(e){var i=this;if(xe.isDevice&&this.mode==="CheckBox"&&this.allowFiltering){var r=this;window.onpopstate=function(){r.hidePopup(),r.inputElement.focus()},history.pushState({},"")}var n={name:"FadeIn",duration:100},a={popup:this.popupObj,event:e,cancel:!1,animation:n};this.trigger("open",a,function(o){o.cancel||(i.focusAtFirstListItem(!0),i.popupObj&&document.body.appendChild(i.popupObj.element),i.mode==="CheckBox"&&i.enableGroupCheckBox&&!m(i.fields.groupBy)&&i.updateListItems(i.list.querySelectorAll("li.e-list-item"),i.mainList.querySelectorAll("li.e-list-item")),(i.mode==="CheckBox"||i.showDropDownIcon)&&P([i.overAllWrapper],[ry]),i.refreshPopup(),i.renderReactTemplates(),i.popupObj&&i.popupObj.show(o.animation,i.zIndex===1e3?i.element:null),i.isReact&&setTimeout(function(){if(i.popupHeight&&i.list&&i.popupHeight!=="auto"){var l=typeof i.popupHeight=="string"?parseInt(i.popupHeight,10):i.popupHeight;if(!i.isUpdateHeaderHeight&&i.headerTemplate&&i.header){var h=i.list.style.maxHeight===""?l:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(h-i.header.offsetHeight).toString()+"px",i.isUpdateHeaderHeight=!0}if(!i.isUpdateFooterHeight&&i.footerTemplate&&i.footer){var h=i.list.style.maxHeight===""?l:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(h-i.footer.offsetHeight).toString()+"px",i.isUpdateFooterHeight=!0}}},15),Pe(i.inputElement,{"aria-expanded":"true","aria-owns":i.element.id+"_popup","aria-controls":i.element.id}),i.updateAriaActiveDescendant(),i.isFirstClick&&(i.enableVirtualization||i.loadTemplate()),i.mode==="CheckBox"&&i.showSelectAll&&R.add(i.popupObj.element,"click",i.clickHandler,i))})},t.prototype.updateVirtualReOrderList=function(e){var i=this.getForQuery(this.value,!0).clone();if(this.isVirtualReorder=!0,this.enableVirtualization&&this.dataSource instanceof fe?this.resetList(this.selectedListData,this.fields,i):this.resetList(this.dataSource,this.fields,i),this.isVirtualReorder=!1,this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+ne.li),this.virtualItemCount=this.itemCount,this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.list.querySelector(".e-virtual-ddl"))this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else{var r=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});r.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(r)}this.list.querySelector(".e-virtual-ddl-content")&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues()),e&&this.loadTemplate()},t.prototype.updateListItems=function(e,i){for(var r=0;r<e.length;r++)this.findGroupStart(e[r]),this.findGroupStart(i[r]);this.deselectHeader()},t.prototype.loadTemplate=function(){if(this.refreshListItems(null),this.enableVirtualization&&this.list&&this.mode==="CheckBox"){var e=this.list.querySelectorAll(".e-reorder")[0];this.list.querySelector(".e-virtual-ddl-content")&&e&&this.list.querySelector(".e-virtual-ddl-content").removeChild(e)}this.mode==="CheckBox"&&this.removeFocus(),this.notify("reOrder",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",e:this}),this.isPreventScrollAction=!0},t.prototype.setScrollPosition=function(){if((!this.hideSelectedItem&&this.mode!=="CheckBox"||this.mode==="CheckBox"&&!this.enableSelectionOrder)&&!m(this.value)&&this.value.length>0){var e=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1],i=this.findListElement(this.hideSelectedItem?this.ulElement:this.list,"li","data-value",e);m(i)||this.scrollBottom(i,void 0,!1,null,!0)}if(this.enableVirtualization){var r=this.list.querySelector("."+ne.focus);this.isKeyBoardAction=!1,this.scrollBottom(r,void 0,!1,null,!0)}},t.prototype.focusAtFirstListItem=function(e){if(this.ulElement&&this.ulElement.querySelector("li."+ne.li)){var i=void 0;if(this.mode==="CheckBox"){this.removeFocus();return}else if(this.enableVirtualization){if(this.fields.disabled){if(i=this.ulElement.querySelector("li."+ne.li+":not(.e-virtual-list):not(.e-hide-listitem):not(."+dl+")"),e&&this.viewPortInfo&&this.viewPortInfo.startIndex!==0){var r=this.ulElement.querySelectorAll("li."+ne.li+":not(.e-virtual-list):not(.e-hide-listitem)");i=r&&r.length>0?r[2]:i}}else if(i=this.ulElement.querySelector("li."+ne.li+":not(.e-virtual-list):not(.e-hide-listitem)"),e&&this.viewPortInfo&&this.viewPortInfo.startIndex!==0){var r=this.ulElement.querySelectorAll("li."+ne.li+":not(.e-virtual-list):not(.e-hide-listitem)");i=r&&r.length>0?r[2]:i}}else this.fields.disabled?i=this.ulElement.querySelector("li."+ne.li+":not(."+Ot+"):not(."+dl+")"):i=this.ulElement.querySelector("li."+ne.li+":not(."+Ot+")");i!==null&&(this.removeFocus(),this.addListFocus(i))}},t.prototype.focusAtLastListItem=function(e){var i;if(e)i=Ua(e,this.liCollections,"StartsWith",this.ignoreCase);else if(this.value&&this.value.length){var r=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1];Ua(r,this.liCollections,"StartsWith",this.ignoreCase)}else i=null;i&&i.item!==null&&(this.addListFocus(i.item),((this.allowCustomValue||this.allowFiltering)&&this.isPopupOpen()&&this.closePopupOnSelect&&!this.enableVirtualization||this.closePopupOnSelect&&!this.enableVirtualization)&&this.scrollBottom(i.item,i.index))},t.prototype.getAriaAttributes=function(){var e={"aria-disabled":"false",role:"combobox","aria-expanded":"false"};return e},t.prototype.updateListARIA=function(){m(this.ulElement)||Pe(this.ulElement,{id:this.element.id+"_options",role:"listbox","aria-hidden":"false","aria-label":"list"});var e=!!(!m(this.inputElement)&&this.inputElement.disabled);!this.isPopupOpen()&&!m(this.inputElement)&&Pe(this.inputElement,this.getAriaAttributes()),e&&Pe(this.inputElement,{"aria-disabled":"true"}),this.ensureAriaDisabled(e?"true":"false")},t.prototype.ensureAriaDisabled=function(e){if(this.htmlAttributes&&this.htmlAttributes["aria-disabled"]){var i=this.htmlAttributes;Ue(i,{"aria-disabled":e},i),this.setProperties({htmlAttributes:i},!0)}},t.prototype.removelastSelection=function(e){var i=this.chipCollectionWrapper.querySelector("span."+un);if(i!==null){this.removeSelectedChip(e);return}var r=this.chipCollectionWrapper.querySelectorAll("span."+Ja),n=r[r.length-1].getAttribute("data-value");m(this.value)||(this.tempValues=this.allowObjectBinding?this.value.slice():this.value.slice());var a=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(n)):this.getFormattedValue(n);this.allowCustomValue&&(n!=="false"&&a===!1||!m(a)&&a.toString()==="NaN")&&(a=n),this.removeValue(a,e),this.removeChipSelection(),this.updateDelimeter(this.delimiterChar,e),this.makeTextBoxEmpty(),this.mainList&&this.listData&&this.refreshSelection(),this.checkPlaceholderSize()},t.prototype.onActionFailure=function(e){s.prototype.onActionFailure.call(this,e),this.renderPopup(),this.onPopupShown()},t.prototype.targetElement=function(){return this.targetInputElement=this.inputElement,this.mode==="CheckBox"&&this.allowFiltering&&this.notify("targetElement",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),this.targetInputElement.value},t.prototype.getForQuery=function(e,i){var r,n=this.isPrimitiveData?"":this.fields.value;if(this.enableVirtualization&&e)if(i){for(var a=this.viewPortInfo.startIndex,o=a+this.viewPortInfo.endIndex<=e.length&&e[a+this.viewPortInfo.endIndex]?a+this.viewPortInfo.endIndex:e.length,l=a;l<o;l++){var h=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",e[l]):e[l];l===a?r=new ht(n,"equal",h):r=r.or(n,"equal",h)}return new We().where(r)}else{for(var l=0;l<e.length;l++){var h=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",e[l]):e[l];this.isaddNonPresentItems?r=l===0?new ht(n,"equal",e[l]):r.or(n,"equal",e[l]):r=l===0?r=new ht(n,"notequal",h):r.and(n,"notequal",h)}return new We().where(r)}else for(var l=0;l<e.length;l++)l===0?r=new ht(n,"equal",e[l]):r=r.or(n,"equal",e[l]);return this.dataSource instanceof fe&&this.dataSource.adaptor instanceof dc?new We().where(r):this.getQuery(this.query).clone().where(r)},t.prototype.onActionComplete=function(e,i,r,n){var a=this;if(this.dataSource instanceof fe&&!m(r)&&!this.virtualGroupDataSource&&(this.totalItemCount=r.count),this.value&&i&&i.length>0&&this.allowFiltering&&this.mode!=="CheckBox"&&!this.enableVirtualization&&!this.isFilterPrevented&&!this.allowCustomValue&&this.isFilteringAction){var o=i.every(function(p){var v=ie(a.fields.value?a.fields.value:"",p);return a.value.some(function(g){var b=a.allowObjectBinding?ie(a.fields.value?a.fields.value:"",g):g;return v===b})});o&&(e.innerHTML="",i=[])}s.prototype.onActionComplete.call(this,e,i,r),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof fe)||this.dataSource instanceof fe&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.updateSelectElementData(this.allowFiltering);var l=this;if(!m(this.value)&&!this.allowCustomValue&&!this.enableVirtualization&&this.listData&&this.listData.length>0)for(var h=0;h<this.value.length;h++){var u=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",l.value[h]):l.value[h],c=this.findListElement(this.allowFiltering&&!m(this.mainList)?this.mainList:e,"li","data-value",u);!c&&!(this.dataSource instanceof fe)&&(this.value.splice(h,1),h-=1)}var f=[];if(m(this.value)||(f=this.presentItemValue(this.ulElement)),f.length>0&&this.dataSource instanceof fe&&!m(this.value)&&this.listData!=null?(this.isaddNonPresentItems=!0,this.addNonPresentItems(f,this.ulElement,this.listData),this.isaddNonPresentItems=!1):this.updateActionList(e,i,r),this.dataSource instanceof fe&&this.allowCustomValue&&!this.isCustomRendered&&this.inputElement.value&&this.inputElement.value!==""){var d=new We;d=this.allowFiltering?d.where(this.fields.text,"startswith",this.inputElement.value,this.ignoreCase,this.ignoreAccent):d,this.checkForCustomValue(d,this.fields),this.isCustomRendered=!0,this.remoteCustomValue=this.enableVirtualization?!1:this.remoteCustomValue}this.mode==="CheckBox"&&this.enableGroupCheckBox&&!m(this.fields.groupBy)&&!m(this.fields.disabled)&&this.disableGroupHeader(),this.dataSource instanceof fe&&this.mode==="CheckBox"&&this.allowFiltering&&this.removeFocus()},t.prototype.updateActionList=function(e,i,r,n){this.mode==="CheckBox"&&this.showSelectAll&&this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),!this.mainList&&!this.mainData?(this.mainList=e.cloneNode?e.cloneNode(!0):e,this.mainData=i,this.mainListCollection=this.liCollections):(m(this.mainData)||this.mainData.length===0)&&(this.mainData=i),!((this.remoteCustomValue||i.length<=0)&&this.allowCustomValue&&this.inputFocus&&this.allowFiltering&&this.inputElement.value&&this.inputElement.value!==""&&(this.checkForCustomValue(this.tempQuery,this.fields),this.isCustomRendered))&&(this.value&&this.value.length&&(this.mode!=="CheckBox"&&!m(this.inputElement)&&this.inputElement.value.trim()!==""||this.mode==="CheckBox"||(this.keyCode===8||this.keyCode===46)&&this.allowFiltering&&this.allowCustomValue&&this.dataSource instanceof fe&&this.inputElement.value==="")&&this.refreshSelection(),this.updateListARIA(),this.unwireListEvents(),this.wireListEvents(),m(this.setInitialValue)||this.setInitialValue(),m(this.selectAllAction)||this.selectAllAction(),this.setDynValue&&(!m(this.text)&&(m(this.value)||this.value.length===0)&&this.initialTextUpdate(),!this.enableVirtualization||this.enableVirtualization&&!(this.dataSource instanceof fe)?this.initialValueUpdate():this.isRemoveSelection||this.initialValueUpdate(this.listData,!0),this.initialUpdate(),this.refreshPlaceHolder(),this.mode!=="CheckBox"&&this.changeOnBlur&&this.updateValueState(null,this.value,null)),this.renderPopup(),this.beforePopupOpen&&(this.beforePopupOpen=!1,this.onPopupShown(r)))},t.prototype.refreshSelection=function(){var e,i,r=this.hideSelectedItem?Ot:ne.selected;if(!m(this.value)){for(var n=0;!m(this.value[n]);n++)if(e=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[n]):this.value[n],i=this.findListElement(this.list,"li","data-value",e),i){if(P([i],r),this.hideSelectedItem&&i.previousSibling&&i.previousElementSibling.classList.contains(ne.group)&&(!i.nextElementSibling||i.nextElementSibling.classList.contains(ne.group))&&P([i.previousElementSibling],r),this.hideSelectedItem&&this.fields.groupBy&&!i.previousElementSibling.classList.contains(Ot)&&this.hideGroupItem(e),this.hideSelectedItem&&i.classList.contains(ne.focus)){Z([i],ne.focus);var a=i.parentElement.querySelectorAll("."+ne.li+":not(."+Ot+"):not(."+dl+")");a.length>0?(P([a[0]],ne.focus),this.updateAriaActiveDescendant()):this.list&&this.list.querySelectorAll("."+ne.li).length>0||(this.l10nUpdate(),P([this.list],ne.noData))}if(i.setAttribute("aria-selected","true"),this.mode==="CheckBox"&&i.classList.contains("e-active")){var o=i.getElementsByClassName("e-check").length;if(o===0){var l={module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:i,e:null};this.notify("updatelist",l)}}}}this.checkSelectAll(),this.checkMaxSelection()},t.prototype.hideGroupItem=function(e){var i,r,n=this.hideSelectedItem?Ot:ne.selected;r=i=this.findListElement(this.ulElement,"li","data-value",e);var a=0,o=0,l=!0,h=!0;do i&&i.previousElementSibling&&!i.previousElementSibling.classList.contains(Ot)&&i.previousElementSibling.classList.contains(ne.li)&&(l=!1),!l||!i||i.previousElementSibling&&i.previousElementSibling.classList.contains(ne.group)?a=10:i=i.previousElementSibling,r&&r.nextElementSibling&&!r.nextElementSibling.classList.contains(Ot)&&r.nextElementSibling.classList.contains(ne.li)&&(h=!1),!h||!r||r.nextElementSibling&&r.nextElementSibling.classList.contains(ne.group)?o=10:r=r.nextElementSibling;while(a<10||o<10);l&&h&&!i.previousElementSibling.classList.contains(Ot)?P([i.previousElementSibling],n):l&&h&&i.previousElementSibling.classList.contains(Ot)&&Z([i.previousElementSibling],n)},t.prototype.getValidLi=function(){var e=this.ulElement.querySelector("li."+ne.li+":not(."+Ot+")");return m(e)?this.liCollections[0]:e},t.prototype.checkSelectAll=function(){var e=m(this.fields.disabled)?this.list.querySelectorAll("li.e-list-group-item.e-active").length:this.list.querySelectorAll("li.e-list-group-item.e-active:not(.e-disabled)").length,i=this.list.querySelectorAll("li.e-list-item"),r=this.enableVirtualization?this.list.querySelectorAll("li."+ne.li+":not(.e-virtual-list)").length:m(this.fields.disabled)?this.list.querySelectorAll("li."+ne.li).length:this.list.querySelectorAll("li."+ne.li+":not(.e-disabled)").length,n=this.list.querySelectorAll("li."+ne.selected).length;if(this.enableGroupCheckBox&&!m(this.fields.groupBy)&&(n=n-e),!this.enableVirtualization&&(r===n||n===this.maximumSelectionLength)&&this.mode==="CheckBox"&&this.showSelectAll||this.enableVirtualization&&this.mode==="CheckBox"&&this.showSelectAll&&this.value&&this.value.length===this.totalItemCount?this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"check"}):r!==n&&this.mode==="CheckBox"&&this.showSelectAll&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"uncheck"}),this.enableGroupCheckBox&&this.fields.groupBy&&!this.enableSelectionOrder){for(var a=0;a<i.length;a++)this.findGroupStart(i[a]);this.deselectHeader()}},t.prototype.openClick=function(e){!this.openOnClick&&this.mode!=="CheckBox"&&!this.isPopupOpen()?this.targetElement()!==""?this.showPopup():this.hidePopup(e):!this.openOnClick&&this.mode==="CheckBox"&&!this.isPopupOpen()&&this.showPopup()},t.prototype.keyUp=function(e){if(this.mode==="CheckBox"&&!this.openOnClick){var i=String.fromCharCode(e.keyCode),r=i.match(/\w/);m(r)||(this.isValidKey=!0)}if(this.isValidKey=this.isPopupOpen()&&e.keyCode===8||this.isValidKey,this.isValidKey=e.ctrlKey&&e.keyCode===86?!1:this.isValidKey,this.isValidKey&&this.inputElement)switch(this.isValidKey=!1,this.expandTextbox(),this.showOverAllClear(),e.keyCode){default:this.search(e)}},t.prototype.filter=function(e,i,r){this.isFiltered=!0,this.remoteFilterAction=!0,this.dataUpdater(e,i,r)},t.prototype.getQuery=function(e){var i=e?e.clone():this.query?this.query.clone():new We;if(this.isFiltered){if(this.enableVirtualization&&!m(this.customFilterQuery))return i=this.customFilterQuery.clone(),this.virtualFilterQuery(i);if(!this.enableVirtualization)return i}if(this.filterAction){if(this.targetElement()!==null&&!this.enableVirtualization||this.enableVirtualization&&this.targetElement()!==null&&this.targetElement().trim()!==""){var r=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof fe)&&r==="string"||r==="number")i.where("",this.filterType,this.targetElement(),this.ignoreCase,this.ignoreAccent);else if(this.enableVirtualization&&this.targetElement()!==""&&!this.isClearAllAction||!this.enableVirtualization){var n=this.fields;i.where(m(n.text)?"":n.text,this.filterType,this.targetElement(),this.ignoreCase,this.ignoreAccent)}}return this.enableVirtualization&&this.viewPortInfo.endIndex!==0&&!this.virtualSelectAll?this.virtualFilterQuery(i):this.virtualSelectAll?e?e.take(this.maximumSelectionLength).requiresCount():this.query?this.query.take(this.maximumSelectionLength).requiresCount():new We().take(this.maximumSelectionLength).requiresCount():i}else return this.enableVirtualization&&this.viewPortInfo.endIndex!==0&&!this.virtualSelectAll?this.virtualFilterQuery(i):this.virtualSelectAll?e?e.take(this.maximumSelectionLength).requiresCount():this.query?this.query.take(this.maximumSelectionLength).requiresCount():new We().take(this.maximumSelectionLength).requiresCount():e||(this.query?this.query:new We)},t.prototype.virtualFilterQuery=function(e){for(var i=this.getTakeValue(),r=!0,n=!0,a=0;a<e.queries.length;a++)this.getModuleName()==="multiselect"&&(e.queries[a].e&&e.queries[a].e.condition==="or"||e.queries[a].e&&e.queries[a].e.operator==="equal")&&(r=!1),e.queries[a].fn==="onSkip"&&(n=!1),e.queries[a].fn;var o=0;if(e&&e.queries.length>0)for(var a=0;a<e.queries.length;a++)e.queries[a].fn==="onTake"&&(o=i<=e.queries[a].e.nos?e.queries[a].e.nos:i);if(o<=0&&this.query&&this.query.queries.length>0)for(var a=0;a<this.query.queries.length;a++)this.query.queries[a].fn==="onTake"&&(o=i<=this.query.queries[a].e.nos?this.query.queries[a].e.nos:i);if(e&&e.queries.length>0)for(var a=0;a<e.queries.length;a++)e.queries[a].fn==="onTake"&&(o=e.queries[a].e.nos<=o?o:e.queries[a].e.nos,e.queries.splice(a,1),--a);return(this.allowFiltering&&n||!r||!this.allowFiltering&&n)&&!this.isVirtualReorder&&(r?e.skip(this.virtualItemStartIndex):e.skip(this.viewPortInfo.startIndex)),this.isIncrementalRequest?e.take(this.incrementalEndIndex):o>0?e.take(o):e.take(i),e.requiresCount(),this.customFilterQuery=null,e},t.prototype.getTakeValue=function(){return this.allowFiltering&&xe.isDevice?Math.round(window.outerHeight/this.listItemHeight):this.itemCount},t.prototype.dataUpdater=function(e,i,r){this.isDataFetched=!1;var n=this.list.classList.contains(ne.noData);if(this.targetElement().trim()===""){var a=this.enableVirtualization?this.list.cloneNode(!0):this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;if(this.backCommand||this.enableVirtualization&&this.mode==="CheckBox"&&this.value&&this.value.length>0){this.remoteCustomValue=!1;var o=!1;if(this.allowCustomValue&&a.querySelectorAll("li").length===0&&this.mainData.length>0&&(this.mainData=[]),this.enableVirtualization){if(this.allowFiltering&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.value&&this.value.length>0&&this.mode==="CheckBox")this.notify("setCurrentViewDataAsync",{component:this.getModuleName(),module:"VirtualScroll"}),o=!0;else if(this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.resetList(e,r,i),this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.UpdateSkeleton(),(n||this.allowCustomValue)&&!this.list.classList.contains(ne.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")){var l=this.createElement("div",{className:"e-virtual-ddl-content"});l.style.cssText=this.getTransformValues(),this.list.appendChild(l).appendChild(this.list.querySelector(".e-list-parent"))}if(!this.list.querySelector(".e-virtual-ddl")){var h=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});h.style.cssText=this.GetVirtualTrackHeight(),document.getElementsByClassName("e-multi-select-list-wrapper")[0].querySelector(".e-dropdownbase").appendChild(h)}}}this.onActionComplete(a,this.mainData),this.value&&this.value.length&&this.refreshSelection(),this.keyCode!==8&&this.focusAtFirstListItem(),o||this.notify("reOrder",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",e:this})}}else{if(this.enableVirtualization&&this.allowFiltering&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null,this.list.querySelector(".e-list-parent.e-reorder")&&this.list.querySelector(".e-list-parent.e-reorder").remove()),this.resetList(e,r,i),this.enableVirtualization&&(n||this.allowCustomValue)&&!this.list.classList.contains(ne.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")){var l=this.createElement("div",{className:"e-virtual-ddl-content"});l.style.cssText=this.getTransformValues(),this.list.appendChild(l).appendChild(this.list.querySelector(".e-list-parent"))}if(this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),!this.list.querySelector(".e-virtual-ddl")){var h=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});h.style.cssText=this.GetVirtualTrackHeight(),document.getElementsByClassName("e-multi-select-list-wrapper")[0].querySelector(".e-dropdownbase").appendChild(h)}}this.allowCustomValue&&(e instanceof fe?(this.remoteCustomValue=!0,this.tempQuery=i):this.checkForCustomValue(i,r))}this.enableVirtualization&&this.allowFiltering&&this.getFilteringSkeletonCount(),this.refreshPopup(),this.allowResize&&this.setResize(),this.mode==="CheckBox"&&this.removeFocus()},t.prototype.checkForCustomValue=function(e,i){var r=!this.getValueByText(this.inputElement.value,this.ignoreCase),n=i||this.fields;if(this.allowCustomValue&&r){var a=this.inputElement.value,o=!m(this.mainData)&&this.mainData.length>0?this.mainData[0]:this.mainData;if(o&&typeof o!="string"&&typeof o!="number"&&typeof o!="boolean"){var l={};It(n.text,a,l),typeof ie(this.fields.value?this.fields.value:"value",o)=="number"&&this.fields.value!==this.fields.text?It(n.value,Math.random(),l):It(n.value,a,l);var h={};if(this.allowObjectBinding){var u=this.listData&&this.listData.length>0?Object.keys(this.listData[0]):this.firstItem?Object.keys(this.firstItem):Object.keys(l),c=typeof ie(this.fields.value?this.fields.value:"value",o)=="number"&&this.fields.value!==this.fields.text;u.forEach(function(g){h[g]=g===i.value||g===i.text?g===i.text&&c?ie(i.text,l):ie(i.value,l):null})}if(l=this.allowObjectBinding?h:l,this.enableVirtualization){this.virtualCustomData=l;var f=this.dataSource instanceof fe?JSON.parse(JSON.stringify(this.listData)):JSON.parse(JSON.stringify(this.dataSource));this.virtualCustomSelectData&&this.virtualCustomSelectData.length>0&&f.concat(this.virtualCustomSelectData),f.splice(0,0,l),this.isCustomDataUpdated=!0;var d=this.totalItemCount;this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.itemCount,this.resetList(f,n,e),this.isCustomDataUpdated=!1,this.totalItemCount=this.enableVirtualization&&this.dataSource instanceof fe?d:this.totalItemCount}else{this.dataSource instanceof fe&&this.allowCustomValue&&this.allowFiltering&&(this.remoteCustomValue=!1);var f=JSON.parse(JSON.stringify(this.listData));f.splice(0,0,l),this.resetList(f,n,e)}}else if(this.listData){var f=JSON.parse(JSON.stringify(this.listData));f.splice(0,0,this.inputElement.value),f[0]=typeof o=="number"&&!isNaN(parseFloat(f[0]))?parseFloat(f[0]):f[0],f[0]=typeof o=="boolean"?f[0]==="true"?!0:f[0]==="false"?!1:f[0]:f[0],this.resetList(f,n)}}else if(this.listData&&this.mainData&&!r&&this.allowCustomValue){if(this.allowFiltering&&this.isRemoteSelection&&this.remoteCustomValue)this.isRemoteSelection=!1,this.enableVirtualization||this.resetList(this.listData,n,e);else if(!this.allowFiltering&&this.list){var p=this.list.querySelectorAll("li."+ne.li+":not(.e-hide-listitem)"),v=Ua(this.targetElement(),p,"StartsWith",this.ignoreCase);v&&v.item!==null&&this.addListFocus(v.item)}}this.value&&this.value.length&&this.refreshSelection()},t.prototype.getNgDirective=function(){return"EJS-MULTISELECT"},t.prototype.wrapperClick=function(e){if(this.setDynValue=!1,this.keyboardEvent=null,this.isKeyBoardAction=!1,!!this.enabled){if(e.target===this.overAllClear){e.preventDefault();return}if(this.inputFocus||this.inputElement.focus(),!this.readonly){if(e.target&&e.target.classList.toString().indexOf(Au)!==-1){this.isPopupOpen()&&this.refreshPopup();return}!this.isPopupOpen()&&(this.openOnClick||this.showDropDownIcon&&e.target&&e.target.className===iy)?this.showPopup(e):(this.hidePopup(e),this.mode==="CheckBox"&&(this.showOverAllClear(),this.inputFocus=!0,this.overAllWrapper.classList.contains(Yn)||this.overAllWrapper.classList.add(Yn)))}this.targetElement()&&this.targetElement()!==""||e.preventDefault(),this.checkAndScrollParent()}},t.prototype.checkAndScrollParent=function(){var e=this.overAllWrapper?this.overAllWrapper.parentElement:null;if(e){var i=parseFloat(getComputedStyle(this.overAllWrapper).height),r=parseFloat(getComputedStyle(e).maxHeight);!isNaN(r)&&i>r&&(e.scrollTop=e.scrollHeight)}},t.prototype.enable=function(e){e?(this.overAllWrapper.classList.remove(dl),this.inputElement.removeAttribute("disabled"),Pe(this.inputElement,{"aria-disabled":"false"}),this.ensureAriaDisabled("false")):(this.overAllWrapper.classList.add(dl),this.inputElement.setAttribute("disabled","true"),Pe(this.inputElement,{"aria-disabled":"true"}),this.ensureAriaDisabled("true")),this.enabled!==e&&(this.enabled=e),this.hidePopup()},t.prototype.onBlurHandler=function(e,i){var r;if(this.isBlurDispatching&&this.isAngular){this.isBlurDispatching=!1;return}if(m(e)||(r=e.relatedTarget),this.popupObj&&document.body.contains(this.popupObj.element)&&this.popupObj.element.contains(r)){this.mode!=="CheckBox"?this.inputElement.focus():this.floatLabelType==="Auto"&&(this.overAllWrapper.classList.contains("e-outline")||this.overAllWrapper.classList.contains("e-filled"))&&P([this.overAllWrapper],"e-valid-input");return}if(this.floatLabelType==="Auto"&&this.overAllWrapper.classList.contains("e-outline")&&this.mode==="CheckBox"&&(m(this.value)||this.value.length===0)&&Z([this.overAllWrapper],"e-valid-input"),this.mode==="CheckBox"&&xe.isIE&&!m(e)&&!i){this.inputFocus=!1,this.overAllWrapper.classList.remove(Yn);return}if(this.scrollFocusStatus){m(e)||e.preventDefault(),this.inputElement.focus(),this.scrollFocusStatus=!1;return}if(this.inputFocus=!1,this.overAllWrapper.classList.remove(Yn),this.addTagOnBlur){var n=this.getValueByText(this.inputElement.value,this.ignoreCase,this.ignoreAccent),a=this.findListElement(this.list,"li","data-value",n),o=this.hideSelectedItem?Ot:ne.selected,l=!!(a&&!a.classList.contains(o));l&&(this.updateListSelection(a,e),this.mode==="Delimiter"&&this.updateDelimeter(this.delimiterChar))}this.updateDataList(),this.refreshListItems(null),this.mode!=="Box"&&this.mode!=="CheckBox"&&this.updateDelimView(),this.changeOnBlur&&(this.updateValueState(e,this.value,this.tempValues),this.dispatchEvent(this.hiddenElement,"change")),this.overAllClear.style.display="none",this.isPopupOpen()&&this.hidePopup(e),this.makeTextBoxEmpty(),this.trigger("blur"),this.focused=!0,xe.isDevice&&this.mode!=="Delimiter"&&this.mode!=="CheckBox"&&this.removeChipFocus(),this.removeChipSelection(),this.refreshInputHight(),UH(this.overAllWrapper,this.componentWrapper,this.value,this.floatLabelType,this.placeholder),this.refreshPlaceHolder(),(this.allowFiltering||this.enableSelectionOrder===!0&&this.mode==="CheckBox")&&!m(this.mainList)&&(this.ulElement=this.mainList),this.checkPlaceholderSize(),Te.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),!m(this.overAllWrapper)&&!m(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.isBlurDispatching=!0,this.isAngular&&this.dispatchEvent(this.inputElement,"blur")},t.prototype.calculateWidth=function(){var e;if(this.overAllWrapper){if(!this.showDropDownIcon||this.overAllWrapper.querySelector(".e-label-top"))e=this.overAllWrapper.clientWidth-2*parseInt(getComputedStyle(this.inputElement).paddingRight,10);else{var i=this.dropIcon.offsetWidth+parseInt(getComputedStyle(this.dropIcon).marginRight,10);e=this.overAllWrapper.clientWidth-(i+2*parseInt(getComputedStyle(this.inputElement).paddingRight,10))}this.floatLabelType!=="Never"&&Te.calculateWidth(e,this.overAllWrapper,this.getModuleName())}},t.prototype.checkPlaceholderSize=function(){if(this.showDropDownIcon){var e=this.dropIcon.offsetWidth+parseInt(window.getComputedStyle(this.dropIcon).marginRight,10);this.setPlaceholderSize(e)}else m(this.dropIcon)||this.setPlaceholderSize(this.showDropDownIcon?this.dropIcon.offsetWidth:0)},t.prototype.setPlaceholderSize=function(e){m(this.value)||this.value.length===0?this.dropIcon.offsetWidth!==0?this.searchWrapper.style.width="calc(100% - "+(e+10)+"px":P([this.searchWrapper],sy):m(this.value)||(this.searchWrapper.removeAttribute("style"),Z([this.searchWrapper],sy))},t.prototype.refreshInputHight=function(){m(this.searchWrapper)||((!this.value||!this.value.length)&&(m(this.text)||this.text==="")?this.searchWrapper.classList.remove(Ou):this.searchWrapper.classList.add(Ou))},t.prototype.validateValues=function(e,i){return JSON.stringify(e.slice().sort())!==JSON.stringify(i.slice().sort())},t.prototype.updateValueState=function(e,i,r){var n=i||[],a=r||[];if(this.initStatus&&this.validateValues(n,a)){var o={e,oldValue:(this.allowObjectBinding,r),value:(this.allowObjectBinding,i),isInteracted:!!e,element:this.element,event:e};this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",o),this.enableVirtualization&&this.enableSelectionOrder&&this.mode==="CheckBox"&&(this.preventSetCurrentData=!1),this.updateTempValue(),this.changeOnBlur||this.dispatchEvent(this.hiddenElement,"change")}this.selectedValueInfo=this.viewPortInfo},t.prototype.updateTempValue=function(){this.value?this.tempValues=this.allowObjectBinding?this.value.slice():this.value.slice():this.tempValues=this.value},t.prototype.updateAriaActiveDescendant=function(){!m(this.ulElement)&&!m(this.ulElement.getElementsByClassName("e-item-focus")[0])&&Pe(this.inputElement,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id})},t.prototype.pageUpSelection=function(e,i){var r=this.list.querySelectorAll("li."+ne.li+":not(."+Ot+"):not(.e-reorder-hide)"),n=e>=0?r[e+1]:r[0];if(this.fields.disabled&&n&&!this.enableVirtualization){for(;n&&(n.classList.contains("e-disabled")||n.classList.contains(Ot)||n.classList.contains(".e-reorder-hide")||n.classList.contains("e-list-group-item"));)n=n.previousElementSibling;if(!n)return}this.enableVirtualization&&i&&(n=this.liCollections.length>=e&&e>=0?this.liCollections[e]:this.liCollections[this.skeletonCount]),!m(n)&&n.classList.contains("e-virtual-list")&&(n=this.liCollections[this.skeletonCount]),this.enableVirtualization?(!m(n)&&!n.classList.contains("e-item-focus")?(this.isKeyBoardAction=!0,this.addListFocus(n),this.scrollTop(n,this.getIndexByValue(n.getAttribute("data-value")),this.keyboardEvent.keyCode)):this.viewPortInfo.startIndex===0&&(this.isKeyBoardAction=!0,this.scrollTop(n,this.getIndexByValue(n.getAttribute("data-value")),this.keyboardEvent.keyCode)),this.previousFocusItem=n):(this.isKeyBoardAction=!0,this.addListFocus(n),this.scrollTop(n,this.getIndexByValue(n.getAttribute("data-value")),this.keyboardEvent.keyCode))},t.prototype.pageDownSelection=function(e,i){var r=this.getItems(),n=this.list.querySelectorAll("li."+ne.li+":not(."+Ot+"):not(.e-reorder-hide)"),a=e<=n.length?n[e-1]:n[n.length-1];if(this.fields.disabled&&a&&!this.enableVirtualization){for(;a&&(a.classList.contains("e-disabled")||a.classList.contains(Ot)||a.classList.contains(".e-reorder-hide")||a.classList.contains("e-list-group-item"));)a=a.nextElementSibling;if(!a)return}this.enableVirtualization&&this.skeletonCount>0&&(a=e<r.length?this.liCollections[e]:this.liCollections[r.length-1]),this.enableVirtualization&&i&&(a=e<=r.length?this.liCollections[e]:this.liCollections[r.length-1]),this.isKeyBoardAction=!0,this.addListFocus(a),this.previousFocusItem=a,this.scrollBottom(a,this.getIndexByValue(a.getAttribute("data-value")),!1,this.keyboardEvent.keyCode)},t.prototype.getItems=function(){return this.list||s.prototype.render.call(this),this.ulElement&&this.ulElement.querySelectorAll("."+ne.li).length>0?this.ulElement.querySelectorAll("."+ne.li+":not(."+Ot+")"):[]},t.prototype.focusInHandler=function(e){var i=this;if(this.enabled){if(this.showOverAllClear(),this.inputFocus=!0,this.value&&this.value.length&&(this.mode!=="Delimiter"&&this.mode!=="CheckBox"?this.chipCollectionWrapper.style.display="":this.showDelimWrapper(),this.mode!=="CheckBox"&&(this.viewWrapper.style.display="none")),this.mode!=="CheckBox"&&this.searchWrapper.classList.remove(Ou),this.checkPlaceholderSize(),this.focused){var r={isInteracted:!!e,event:e};this.trigger("focus",r),this.focused=!1}return this.overAllWrapper.classList.contains(Yn)||this.overAllWrapper.classList.add(Yn),jH(this.overAllWrapper,this.componentWrapper),this.isPopupOpen()&&this.refreshPopup(),this.allowResize&&this.setResize(),setTimeout(function(){i.calculateWidth()},150),!0}else return!1},t.prototype.showDelimWrapper=function(){this.mode==="CheckBox"?this.viewWrapper.style.display="":this.delimiterWrapper.style.display="",this.componentWrapper.classList.add(Yb)},t.prototype.hideDelimWrapper=function(){this.delimiterWrapper.style.display="none",this.componentWrapper.classList.remove(Yb)},t.prototype.expandTextbox=function(){var e=5;if(this.placeholder){var i=this.placeholder.charCodeAt(0),r=44032<=i&&i<=55215?1.5:19968<=i&&i<=40959?2:1;e=e>this.inputElement.placeholder.length?e:this.inputElement.placeholder.length*r}this.inputElement.value.length>e?this.inputElement.size=this.inputElement.value.length:this.inputElement.size=e},t.prototype.isPopupOpen=function(){return this.popupWrapper!==null&&this.popupWrapper.parentElement!==null},t.prototype.refreshPopup=function(){this.popupObj&&this.mobFilter&&(this.popupObj.setProperties({width:this.calcPopupWidth()}),this.popupObj.refreshPosition(this.overAllWrapper),this.popupObj.resolveCollision())},t.prototype.checkTextLength=function(){return this.targetElement().length<1},t.prototype.popupKeyActions=function(e){switch(e.keyCode){case 38:this.hidePopup(e),this.mode==="CheckBox"&&this.inputElement.focus(),e.preventDefault();break;case 40:this.isPopupOpen()||(this.showPopup(e),e.preventDefault());break}},t.prototype.updatePopupPosition=function(){this.refreshPopup()},t.prototype.updateAriaAttribute=function(){var e=this.list.querySelector("."+ne.focus);if(!m(e))if(this.inputElement.setAttribute("aria-activedescendant",e.id),this.allowFiltering){var i=this.popupWrapper.querySelector("."+wd);i&&i.setAttribute("aria-activedescendant",e.id)}else this.mode==="CheckBox"&&this.overAllWrapper.setAttribute("aria-activedescendant",e.id)},t.prototype.homeNavigation=function(e,i){if(this.removeFocus(),this.enableVirtualization){if(e)this.enableVirtualization&&this.viewPortInfo.startIndex!==0&&(this.viewPortInfo.startIndex=0,this.viewPortInfo.endIndex=this.itemCount,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query));else if(this.enableVirtualization&&(!this.value&&this.viewPortInfo.endIndex!==this.totalItemCount||this.value&&this.value.length>0&&this.viewPortInfo.endIndex!==this.totalItemCount+this.value.length)){this.viewPortInfo.startIndex=this.totalItemCount-this.itemCount,this.viewPortInfo.endIndex=this.totalItemCount,this.updateVirtualItemIndex();var r=new We().clone();this.value&&this.value.length>0&&(r=this.getForQuery(this.value).clone(),r=r.skip(this.totalItemCount-this.itemCount)),this.resetList(this.dataSource,this.fields,r)}}this.UpdateSkeleton();var n=this.ulElement.querySelectorAll("li."+ne.li+":not(."+Ot+"):not(.e-reorder-hide)");if(n.length>0){var a=n[e?0:n.length-1];this.enableVirtualization&&e&&(a=n[this.skeletonCount]),this.removeFocus(),a.classList.add(ne.focus),this.enableVirtualization&&e?this.scrollTop(a,void 0,this.keyboardEvent.keyCode):i||this.scrollBottom(a,void 0,!1,this.keyboardEvent.keyCode),this.updateAriaActiveDescendant()}},t.prototype.updateSelectionList=function(){if(!m(this.value)&&this.value.length)for(var e=0;e<this.value.length;e++){var i=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[e]):this.value[e],r=this.getElementByValue(i);r&&!r.classList.contains(ne.selected)&&r.classList.add("e-active")}},t.prototype.handleVirtualKeyboardActions=function(e,i){var r=this.list.querySelector("."+ne.focus),n;switch(this.isKeyBoardAction=!0,e.keyCode){case 40:this.arrowDown(e,!0);break;case 38:this.arrowUp(e,!0);break;case 33:e.preventDefault(),r&&(n=this.getIndexByValue(this.previousFocusItem.getAttribute("data-value"))-1,this.pageUpSelection(n,!0),this.updateAriaAttribute());break;case 34:e.preventDefault(),r&&(n=this.getIndexByValue(this.previousFocusItem.getAttribute("data-value")),this.pageDownSelection(n,!0),this.updateAriaAttribute());break;case 35:case 36:this.isMouseScrollAction=!0,this.homeNavigation(e.keyCode===36,!0),this.isPreventScrollAction=!0;break}this.keyboardEvent=null,this.isScrollChanged=!0,this.isKeyBoardAction=!1},t.prototype.onKeyDown=function(e){if(!(this.readonly||!this.enabled&&this.mode!=="CheckBox")&&(this.preventSetCurrentData=!1,this.keyboardEvent=e,this.isPreventKeyAction&&this.enableVirtualization&&e.preventDefault(),this.keyCode=e.keyCode,this.keyDownStatus=!0,!(e.keyCode>111&&e.keyCode<124))){if(e.altKey){this.popupKeyActions(e);return}else if(this.isPopupOpen()){var i=this.list.querySelector("."+ne.focus),r=void 0;switch(e.keyCode){case 36:case 35:this.isMouseScrollAction=!0,this.isKeyBoardAction=!0,this.homeNavigation(e.keyCode===36);break;case 33:e.preventDefault(),i&&(r=this.getIndexByValue(i.getAttribute("data-value")),this.pageUpSelection(r-this.getPageCount()-1),this.updateAriaAttribute());return;case 34:e.preventDefault(),i&&(r=this.getIndexByValue(i.getAttribute("data-value")),this.pageDownSelection(r+this.getPageCount()),this.updateAriaAttribute());return;case 38:this.isKeyBoardAction=!0,this.arrowUp(e);break;case 40:this.isKeyBoardAction=!0,this.arrowDown(e);break;case 27:e.preventDefault(),this.isKeyBoardAction=!0,this.hidePopup(e),this.mode==="CheckBox"&&this.inputElement.focus(),this.isKeyBoardAction=!1;return;case 13:e.preventDefault(),this.isKeyBoardAction=!0,this.mode!=="CheckBox"&&this.selectByKey(e),this.checkPlaceholderSize(),this.isKeyBoardAction=!1;return;case 32:this.isKeyBoardAction=!0,this.spaceKeySelection(e),this.isKeyBoardAction=!1;return;case 9:e.preventDefault(),this.isKeyBoardAction=!0,this.hidePopup(e),this.inputElement.focus(),this.overAllWrapper.classList.add(Yn)}}else switch(e.keyCode){case 13:case 9:case 16:case 17:case 20:return;case 40:this.openOnClick&&this.showPopup();break;case 27:e.preventDefault(),this.escapeAction();return}this.checkTextLength()&&this.keyNavigation(e),this.mode==="CheckBox"&&this.enableSelectionOrder&&(this.allowFiltering&&(this.previousFilterText=this.targetElement()),this.checkBackCommand(e)),this.expandTextbox(),this.mode==="CheckBox"&&this.showSelectAll||this.refreshPopup(),this.allowResize&&this.setResize(),this.isKeyBoardAction=!1}},t.prototype.arrowDown=function(e,i){e.preventDefault(),this.moveByList(1,i),this.keyAction=!0,(document.activeElement.classList.contains(wd)||this.mode==="CheckBox"&&!this.allowFiltering&&document.activeElement!==this.list)&&R.add(this.list,"keydown",this.onKeyDown,this),this.updateAriaAttribute()},t.prototype.arrowUp=function(e,i){e.preventDefault(),this.keyAction=!0;var r=this.list.querySelectorAll("li."+ne.li+":not(."+Ot+"):not(.e-reorder-hide)");this.enableGroupCheckBox&&this.mode==="CheckBox"&&!m(this.fields.groupBy)&&(r=this.list.querySelectorAll("li."+ne.li+",li."+ne.group+":not(."+Ot+"):not(.e-reorder-hide)"));var n=this.list.querySelector("li."+ne.focus);this.focusFirstListItem=m(this.liCollections[0])?!1:this.liCollections[0].classList.contains("e-item-focus");var a=Array.prototype.slice.call(r).indexOf(n);a<=0&&this.mode==="CheckBox"&&this.allowFiltering&&(this.keyAction=!1,this.notify("inputFocus",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"focus"})),this.moveByList(-1,i),this.updateAriaAttribute()},t.prototype.spaceKeySelection=function(e){if(this.mode==="CheckBox"){var i=this.list.querySelector("li."+ne.focus),r=document.getElementsByClassName("e-selectall-parent")[0];if((!m(i)||r&&r.classList.contains("e-item-focus"))&&(e.preventDefault(),this.keyAction=!0),this.selectByKey(e),this.keyAction){var n=this.list.querySelector("li."+ne.focus);!m(n)&&r&&r.classList.contains("e-item-focus")&&n.classList.remove("e-item-focus")}}this.checkPlaceholderSize()},t.prototype.checkBackCommand=function(e){(e.keyCode===8&&this.allowFiltering?this.targetElement()!==this.previousFilterText:this.targetElement()==="")?this.backCommand=!1:this.backCommand=!0},t.prototype.keyNavigation=function(e){if(this.mode!=="Delimiter"&&this.mode!=="CheckBox"&&this.value&&this.value.length)switch(e.keyCode){case 37:e.preventDefault(),this.moveBy(-1,e);break;case 39:e.preventDefault(),this.moveBy(1,e);break;case 8:this.removelastSelection(e);break;case 46:this.removeSelectedChip(e);break}else if(e.keyCode===8&&this.mode==="Delimiter"&&this.value&&this.value.length){e.preventDefault();var i=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1];this.removeValue(this.value[this.value.length-1],e),this.updateDelimeter(this.delimiterChar,e),this.focusAtLastListItem(i)}},t.prototype.selectByKey=function(e){this.removeChipSelection(),this.selectListByKey(e),this.hideSelectedItem&&this.focusAtFirstListItem()},t.prototype.escapeAction=function(){var e=this.tempValues?this.tempValues.slice():[];this.allowObjectBinding&&(e=this.tempValues?this.tempValues.slice():[]),this.value&&this.validateValues(this.value,e)&&(this.mode!=="CheckBox"&&(this.value=e,(this.allowFiltering||this.allowCustomValue)&&this.refreshListItems(null),this.initialValueUpdate()),this.mode!=="Delimiter"&&this.mode!=="CheckBox"?this.chipCollectionWrapper.style.display="":this.showDelimWrapper(),this.refreshPlaceHolder(),this.value.length?this.showOverAllClear():this.hideOverAllClear()),this.makeTextBoxEmpty()},t.prototype.scrollBottom=function(e,i,r,n,a){r===void 0&&(r=!1),n===void 0&&(n=null),a===void 0&&(a=!1),(!m(e)&&e.classList.contains("e-virtual-list")||this.enableVirtualization&&m(e))&&(e=this.liCollections[this.skeletonCount]);var o=e&&!isNaN(parseInt(window.getComputedStyle(e).marginBottom,10))?parseInt(window.getComputedStyle(e).marginBottom,10):0;this.isUpwardScrolling=!1;var l=this.list.querySelectorAll(".e-virtual-list").length,h=this.list.querySelector("li:last-of-type")?this.list.querySelector("li:last-of-type").getAttribute("data-value"):null,u=this.virtualListInfo&&this.virtualListInfo.startIndex?e.offsetTop+this.virtualListInfo.startIndex*(e.offsetHeight+o):e.offsetTop,c=this.list.offsetHeight,f=u-l*(e.offsetHeight+o)+(e.offsetHeight+o)-this.list.scrollTop,d=this.list.scrollTop+f-c,p=!1,v=u-l*(e.offsetHeight+o)+(e.offsetHeight+o)-this.list.scrollTop;if(v=this.fields.groupBy&&!m(this.fixedHeaderElement)?v-this.fixedHeaderElement.offsetHeight:v,i===0&&!this.enableVirtualization)this.list.scrollTop=0;else if(f>c||!(v>0&&this.list.offsetHeight>v)){var g=e?e.getAttribute("data-value"):null,b=n===34?this.getPageCount()-1:1;!this.enableVirtualization||this.isKeyBoardAction||r?this.isKeyBoardAction&&this.enableVirtualization&&h&&g===h&&n!==35&&!this.isVirtualScrolling?(this.isPreventKeyAction=!0,this.list.scrollTop+=(e.offsetHeight+o)*b,this.isPreventKeyAction=this.isScrollerAtEnd()?!1:this.isPreventKeyAction,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1):this.enableVirtualization&&n===35?(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1,this.list.scrollTop=this.list.scrollHeight):(n===34&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=d):this.list.scrollTop=this.virtualListInfo&&this.virtualListInfo.startIndex?a&&this.virtualListInfo.startIndex?this.virtualListInfo.startIndex*this.listItemHeight+this.listItemHeight*2:this.virtualListInfo.startIndex*this.listItemHeight:0,p=this.isKeyBoardAction}this.isKeyBoardAction=p},t.prototype.scrollTop=function(e,i,r){r===void 0&&(r=null);var n=this.list.querySelectorAll(".e-virtual-list").length,a=e&&!isNaN(parseInt(window.getComputedStyle(e).marginBottom,10))?parseInt(window.getComputedStyle(e).marginBottom,10):0,o=this.virtualListInfo&&this.virtualListInfo.startIndex?e.offsetTop+this.virtualListInfo.startIndex*(e.offsetHeight+a):e.offsetTop,l=o-n*(e.offsetHeight+a)-this.list.scrollTop,h=this.list.querySelector("li.e-list-item:not(.e-virtual-list)")?this.list.querySelector("li.e-list-item:not(.e-virtual-list)").getAttribute("data-value"):null;l=this.fields.groupBy&&!Cn(this.fixedHeaderElement)?l-this.fixedHeaderElement.offsetHeight:l;var u=o-n*(e.offsetHeight+a)+(e.offsetHeight+a)-this.list.scrollTop,c=this.enableVirtualization&&this.getModuleName()==="autocomplete"&&l<=0;if(i===0&&!this.enableVirtualization)this.list.scrollTop=0;else if(l<0||c){var f=e?e.getAttribute("data-value"):null,d=r===33?this.getPageCount()-2:1;this.enableVirtualization&&this.isKeyBoardAction&&h&&f===h&&r!==36&&!this.isVirtualScrolling?(this.isUpwardScrolling=!0,this.isPreventKeyAction=!0,this.isKeyBoardAction=!1,this.list.scrollTop-=(e.offsetHeight+a)*d,this.isPreventKeyAction=this.list.scrollTop!==0?this.isPreventKeyAction:!1,this.isPreventScrollAction=!1):this.enableVirtualization&&r===36?(this.isPreventScrollAction=!1,this.isPreventKeyAction=!0,this.isKeyBoardAction=!1,this.list.scrollTo(0,0)):(r===33&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=this.list.scrollTop+l)}else u>0&&this.list.offsetHeight>u||(this.list.scrollTop=e.offsetTop-(this.fields.groupBy&&!m(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))},t.prototype.isScrollerAtEnd=function(){return this.list&&this.list.scrollTop+this.list.clientHeight>=this.list.scrollHeight},t.prototype.selectListByKey=function(e){var i=this.list.querySelector("li."+ne.focus),r=this.value&&this.value.length?this.value.length:0,n;if(i!==null){if(e.preventDefault(),i.classList.contains("e-active")&&(r=r-1),this.isValidLI(i)&&r<this.maximumSelectionLength){this.updateListSelection(i,e),this.addListFocus(i),this.mode==="CheckBox"?(this.updateDelimView(),this.updateDelimeter(this.delimiterChar,e),this.refreshInputHight(),this.checkPlaceholderSize(),this.enableGroupCheckBox&&!m(this.fields.groupBy)&&(n=i.firstElementChild.lastElementChild,this.findGroupStart(n),this.deselectHeader())):this.updateDelimeter(this.delimiterChar,e);var a=this.targetElement().trim()!=="";this.makeTextBoxEmpty(),this.mode!=="CheckBox"&&this.refreshListItems(i.textContent,a),this.changeOnBlur||this.updateValueState(e,this.value,this.tempValues),this.refreshPopup()}else!this.isValidLI(i)&&r<this.maximumSelectionLength&&(n=i.firstElementChild.lastElementChild,n.classList.contains("e-check")?this.selectAllItem(!1,e,i):this.selectAllItem(!0,e,i));this.refreshSelection(),this.closePopupOnSelect&&this.hidePopup(e)}var o=document.getElementsByClassName("e-selectall-parent")[0];if(o&&o.classList.contains("e-item-focus")){var l=o.childNodes[0];if(l.classList.contains("e-check")){l.classList.remove("e-check");var h={module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"check",name:"checkSelectAll"};this.notify("checkSelectAll",h),this.selectAllItem(!1,e,i)}else{l.classList.add("e-check");var h={module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"check",name:"checkSelectAll"};this.notify("checkSelectAll",h),this.selectAllItem(!0,e,i)}}this.refreshPlaceHolder()},t.prototype.refreshListItems=function(e,i){if((this.allowFiltering||this.mode==="CheckBox"&&this.enableSelectionOrder===!0||this.allowCustomValue)&&this.mainList&&this.listData){var r=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;if(this.enableVirtualization)if(this.allowCustomValue&&this.virtualCustomData&&e==null&&this.virtualCustomData&&this.viewPortInfo&&this.viewPortInfo.startIndex===0&&this.viewPortInfo.endIndex===this.itemCount)this.virtualCustomData=null,this.renderItems(this.mainData,this.fields);else if(this.allowFiltering&&i){if(this.updateInitialData(),this.onActionComplete(r,this.mainData),this.isVirtualTrackHeight=!1,this.list.getElementsByClassName("e-virtual-ddl")[0])this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.skeletonCount>0){var n=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});n.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(n)}}else this.onActionComplete(this.list,this.listData);else this.onActionComplete(r,this.mainData);this.focusAtLastListItem(e),this.value&&this.value.length&&this.refreshSelection()}else!m(this.fields.groupBy)&&this.value&&this.value.length&&this.refreshSelection()},t.prototype.removeSelectedChip=function(e){var i=this.chipCollectionWrapper.querySelector("span."+un),r;if(i!==null){m(this.value)||(this.tempValues=this.allowObjectBinding?this.value.slice():this.value.slice()),r=i.nextElementSibling,r!==null&&(this.removeChipSelection(),this.addChipSelection(r,e));var n=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(i.getAttribute("data-value"))):i.getAttribute("data-value");this.removeValue(n,e),this.updateDelimeter(this.delimiterChar,e),this.makeTextBoxEmpty()}this.closePopupOnSelect&&this.hidePopup(e),this.checkPlaceholderSize()},t.prototype.moveByTop=function(e){var i=this.list.querySelectorAll("li."+ne.li),r;i.length>1&&(this.removeFocus(),r=e?0:i.length-1,this.addListFocus(i[r]),this.scrollBottom(i[r],r)),this.updateAriaAttribute()},t.prototype.clickHandler=function(e){var i=e.target,r=i.className,n=document.getElementsByClassName("e-selectall-parent")[0];(r==="e-input-filter e-input"||r==="e-input-group e-control-wrapper e-input-focus")&&n.classList.contains("e-item-focus")&&n.classList.remove("e-item-focus")},t.prototype.moveByList=function(e,i){if(this.list){var r=this.list.querySelectorAll("li."+ne.li+":not(."+Ot+"):not(.e-reorder-hide)");this.mode==="CheckBox"&&this.enableGroupCheckBox&&!m(this.fields.groupBy)&&(r=this.list.querySelectorAll("li."+ne.li+",li."+ne.group+":not(."+Ot+"):not(.e-reorder-hide)"));var n=this.list.querySelector("li."+ne.focus);this.enableVirtualization&&i&&!m(this.currentFocuedListElement)&&(n=this.getElementByValue(this.getFormattedValue(this.currentFocuedListElement.getAttribute("data-value"))));var a=-1,o=document.getElementsByClassName("e-selectall-parent")[0];if(this.mode==="CheckBox"&&this.showSelectAll&&e===1&&!m(o)&&!o.classList.contains("e-item-focus")&&this.list.getElementsByClassName("e-item-focus").length===0&&this.liCollections.length>1)!this.focusFirstListItem&&o.classList.contains("e-item-focus")?o.classList.remove("e-item-focus"):o.classList.contains("e-item-focus")||o.classList.add("e-item-focus");else if(r.length){this.mode==="CheckBox"&&this.showSelectAll&&!m(o&&e===-1)&&(!this.focusFirstListItem&&o.classList.contains("e-item-focus")?o.classList.remove("e-item-focus"):this.focusFirstListItem&&!o.classList.contains("e-item-focus")&&o.classList.add("e-item-focus"));for(var l=0;l<r.length;l++)if(r[l]===n){a=l;break}if(e>0)a<r.length-1&&(this.removeFocus(),this.enableVirtualization&&i?this.addListFocus(r[a]):this.enableVirtualization&&r[a+1].classList.contains("e-virtual-list")?this.addListFocus(r[this.skeletonCount]):this.addListFocus(r[++a]),a>-1&&(this.updateCheck(r[a]),this.scrollBottom(r[a],a),this.currentFocuedListElement=r[a]));else if(a>0)if(this.enableVirtualization){var h=r[a-1].classList.contains("e-virtual-list"),u=i?a:a-1;(i||!h)&&this.removeFocus(),(i||!h)&&(this.addListFocus(r[u]),this.updateCheck(r[u]),this.scrollTop(r[u],a),this.currentFocuedListElement=r[u])}else this.removeFocus(),this.addListFocus(r[--a]),this.updateCheck(r[a]),this.scrollTop(r[a],a)}}var c=this.list?this.list.querySelector(".e-item-focus"):null;if(this.isDisabledElement(c)){if(this.list.querySelectorAll(".e-list-item:not(.e-hide-listitem):not(.e-disabled)").length===0||this.keyCode===38&&this.mode==="CheckBox"&&this.enableGroupCheckBox&&!m(this.fields.groupBy)&&c===this.list.querySelector("li.e-list-group-item")){this.removeFocus();return}var l=this.getIndexByValue(c.getAttribute("data-value"));l===0&&(e=1),l===this.list.querySelectorAll(".e-list-item:not(.e-hide-listitem)").length-1&&(e=-1),this.moveByList(e)}},t.prototype.getElementByValue=function(e){for(var i,r=this.getItems(),n=0,a=r;n<a.length;n++){var o=a[n];if(this.getFormattedValue(o.getAttribute("data-value"))===e){i=o;break}}return i},t.prototype.updateCheck=function(e){if(this.mode==="CheckBox"&&this.enableGroupCheckBox&&!m(this.fields.groupBy)){var i=e.firstElementChild.lastElementChild;i.classList.contains("e-check")?e.classList.add("e-active"):e.classList.remove("e-active")}},t.prototype.moveBy=function(e,i){var r,n=this.chipCollectionWrapper.querySelectorAll("span."+Ja),a=this.chipCollectionWrapper.querySelector("span."+un);a===null?e<0&&this.addChipSelection(n[n.length-1],i):e<0?(r=a.previousElementSibling,r!==null&&(this.removeChipSelection(),this.addChipSelection(r,i))):(r=a.nextElementSibling,this.removeChipSelection(),r!==null&&this.addChipSelection(r,i))},t.prototype.chipClick=function(e){if(this.enabled){var i=X(e.target,"."+Ja);this.removeChipSelection(),this.addChipSelection(i,e)}},t.prototype.removeChipSelection=function(){this.chipCollectionWrapper&&this.removeChipFocus()},t.prototype.addChipSelection=function(e,i){P([e],un),this.trigger("chipSelection",i)},t.prototype.onChipRemove=function(e){if(!(e.which===3||e.button===2)&&this.enabled&&!this.readonly){var i=e.target.parentElement,r=i.getAttribute("data-value"),n=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(r)):this.getFormattedValue(r);if(this.allowCustomValue&&(r!=="false"&&n===!1||!m(n)&&n.toString()==="NaN")&&(n=r),this.isPopupOpen()&&this.mode!=="CheckBox"&&this.hidePopup(e),this.inputFocus||this.inputElement.focus(),this.removeValue(n,e),n=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",n):n,m(this.findListElement(this.list,"li","data-value",n))&&this.mainList&&this.listData){var a=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.onActionComplete(a,this.mainData)}this.updateDelimeter(this.delimiterChar,e),this.placeholder&&this.floatLabelType==="Never"?(this.makeTextBoxEmpty(),this.checkPlaceholderSize()):this.inputElement.value="",e.preventDefault()}},t.prototype.makeTextBoxEmpty=function(){this.inputElement.value="",this.refreshPlaceHolder()},t.prototype.refreshPlaceHolder=function(){this.placeholder&&this.floatLabelType==="Never"?this.value&&this.value.length||!m(this.text)&&this.text!==""?this.inputElement.placeholder="":this.inputElement.placeholder=dp(this.placeholder):this.setFloatLabelType(),this.expandTextbox()},t.prototype.removeAllItems=function(e,i,r,n,a){var o=this.allowObjectBinding?this.indexOfObjectInArray(e,this.value):this.value.indexOf(e),l=this.value.slice(0);l.splice(o,1),this.setProperties({value:[].concat([],l)},!0),n.setAttribute("aria-selected","false");var h=this.hideSelectedItem?Ot:ne.selected;Z([n],h),this.notify("activeList",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:n,e:this,index:o}),this.invokeCheckboxSelection(n,i,r);var u=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",e):e;this.updateMainList(!0,u,a),this.updateChipStatus()},t.prototype.invokeCheckboxSelection=function(e,i,r){this.notify("updatelist",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:e,e:i}),this.updateAriaActiveDescendant(),this.value&&this.value.length!==this.mainData.length&&this.mode==="CheckBox"&&this.showSelectAll&&!(this.isSelectAll||r)&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"uncheck"})},t.prototype.removeValue=function(e,i,r,n){var a=this,o=this.allowObjectBinding?this.indexOfObjectInArray(e,this.value):this.value.indexOf(this.getFormattedValue(e));o===-1&&this.allowCustomValue&&!m(e)&&(o=this.allowObjectBinding?this.indexOfObjectInArray(e,this.value):this.value.indexOf(e.toString()));var l=i&&i.target;n=n||l&&l.classList.contains("e-close-hooker")?!0:null;var h=this.hideSelectedItem?Ot:ne.selected;if(o!==-1){var u=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",e):e,c=this.virtualSelectAll?null:this.findListElement(this.list,"li","data-value",u),f=this.allowObjectBinding?e:this.getDataByValue(e),d={e:i,item:c,itemData:f,isInteracted:!!i,cancel:!1};this.trigger("removing",d,function(p){if(p.cancel)a.removeIndex++;else{a.isRemoveSelection=a.enableVirtualization?!0:a.isRemoveSelection,a.currentRemoveValue=a.allowObjectBinding?ie(a.fields.value?a.fields.value:"",e):e,a.virtualSelectAll=!1;var v=a.value.slice(0);if(v.splice(o,1),a.enableVirtualization&&a.mode==="CheckBox"&&a.selectedListData.splice(o,1),a.setProperties({value:[].concat([],v)},!0),a.enableVirtualization){var g=o===0&&a.text.split(a.delimiterChar)&&a.text.split(a.delimiterChar).length===1?a.text.replace(a.text.split(a.delimiterChar)[o],""):o===0?a.text.replace(a.text.split(a.delimiterChar)[o]+a.delimiterChar,""):a.text.replace(a.delimiterChar+a.text.split(a.delimiterChar)[o],"");a.setProperties({text:g.toString()},!0)}if(c!==null){var b=a.allowObjectBinding?ie(a.fields.value?a.fields.value:"",e):e,C=a.findListElement(a.mainList,"li","data-value",b);c.setAttribute("aria-selected","false"),Z([c],h),C&&(C.setAttribute("aria-selected","false"),Z([c,C],h)),a.notify("activeList",{module:"CheckBoxSelection",enable:a.mode==="CheckBox",li:c,e:a,index:o}),a.invokeCheckboxSelection(c,i,n)}var y=a.allowObjectBinding?ie(a.fields.value?a.fields.value:"",e):e;a.hideSelectedItem&&a.fields.groupBy&&c&&a.hideGroupItem(y),a.hideSelectedItem&&a.fixedHeaderElement&&a.fields.groupBy&&a.mode!=="CheckBox"&&a.isPopupOpen()&&s.prototype.scrollStop.call(a),a.updateMainList(!0,y),a.removeChip(y,n),a.updateChipStatus();var x=a.value&&a.value.length?a.value.length:0;if(x<a.maximumSelectionLength){var w=a.list.querySelectorAll("li."+ne.li+":not(.e-active)");Z(w,"e-disable")}a.trigger("removed",p);var S=i&&i.currentTarget,E=S&&S.classList.contains("e-selectall-parent")?!0:null;if(!a.changeOnBlur&&!n&&i&&r&&!E&&a.isSelectAllTarget&&a.updateValueState(i,a.value,a.tempValues),r&&(a.selectAllEventData.push(f),a.selectAllEventEle.push(c)),r===1){a.changeOnBlur||a.updateValueState(i,a.value,a.tempValues);var k={event:i,items:a.selectAllEventEle,itemData:a.selectAllEventData,isInteracted:!!i,isChecked:!1};a.trigger("selectedAll",k),a.selectAllEventData=[],a.selectAllEventEle=[]}n&&(r===1||r===null)&&a.clearAllCallback(i,n),a.isPopupOpen()&&c&&c.parentElement.classList.contains("e-reorder")&&(a.hideSelectedItem&&a.value&&Array.isArray(a.value)&&a.value.length>0&&a.totalItemsCount(),a.notify("setCurrentViewDataAsync",{module:"VirtualScroll"}))}})}},t.prototype.updateMainList=function(e,i,r){if(this.allowFiltering||this.mode==="CheckBox"){var n=r||this.findListElement(this.mainList,"li","data-value",i);n&&(e?(n.setAttribute("aria-selected","false"),Z([n],this.hideSelectedItem?Ot:ne.selected),this.mode==="CheckBox"&&Z([n.firstElementChild.lastElementChild],"e-check")):(n.setAttribute("aria-selected","true"),P([n],this.hideSelectedItem?Ot:ne.selected),this.mode==="CheckBox"&&P([n.firstElementChild.lastElementChild],"e-check")))}},t.prototype.removeChip=function(e,i){if(this.chipCollectionWrapper&&!(this.enableVirtualization&&i)){var r=this.findListElement(this.chipCollectionWrapper,"span","data-value",e);r&&Zi(r)}},t.prototype.setWidth=function(e){m(e)||(typeof e=="number"?this.overAllWrapper.style.width=st(e):typeof e=="string"&&(this.overAllWrapper.style.width=e.match(/px|%|em/)?e:st(e)))},t.prototype.updateChipStatus=function(){this.value&&this.value.length?(m(this.chipCollectionWrapper)||(this.chipCollectionWrapper.style.display=""),(this.mode==="Delimiter"||this.mode==="CheckBox")&&this.showDelimWrapper(),this.showOverAllClear()):(m(this.chipCollectionWrapper)||(this.chipCollectionWrapper.style.display="none"),m(this.delimiterWrapper)||(this.delimiterWrapper.style.display="none"),this.hideOverAllClear())},t.prototype.indexOfObjectInArray=function(e,i){for(var r=function(o){var l=i[o];if(Object.keys(e).every(function(h){return l.hasOwnProperty(h)&&l[h]===e[h]}))return{value:o}},n=0;n<i.length;n++){var a=r(n);if(typeof a=="object")return a.value}return-1},t.prototype.addValue=function(e,i,r){this.value||(this.value=[]);var n=this.allowObjectBinding?this.getDataByValue(e):e;if(this.allowObjectBinding&&!this.isObjectInArray(this.getDataByValue(e),this.value)||!this.allowObjectBinding&&this.value.indexOf(n)<0){if(this.setProperties({value:[].concat([],this.value,[n])},!0),this.enableVirtualization&&!this.isSelectAllLoop){var a=this.viewWrapper.innerHTML,o=void 0;a+=this.value.length===1?"":this.delimiterChar+" ",o=this.getOverflowVal(this.value.length-1),a+=o,o=this.viewWrapper.innerHTML,this.updateWrapperText(this.viewWrapper,a)}if(this.enableVirtualization&&this.mode==="CheckBox"){var l=[];this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1];var o=i,h=this.text!=null&&this.text!==""?this.text+this.delimiterChar+o:o;l.push(h),this.setProperties({text:l.toString()},!0)}}var u=this.findListElement(this.list,"li","data-value",e);this.removeFocus(),u&&(this.addListFocus(u),this.addListSelection(u)),this.mode!=="Delimiter"&&this.mode!=="CheckBox"&&this.addChip(i,e,r),this.hideSelectedItem&&this.fields.groupBy&&this.hideGroupItem(e),this.updateChipStatus(),this.checkMaxSelection()},t.prototype.checkMaxSelection=function(){var e=this.value&&this.value.length?this.value.length:0;if(e===this.maximumSelectionLength){var i=this.list.querySelectorAll("li."+ne.li+".e-active");Z(i,"e-disable");var r=this.list.querySelectorAll("li."+ne.li+":not(.e-active)");P(r,"e-disable")}if(e<this.maximumSelectionLength){var n=this.list.querySelectorAll("li."+ne.li);Z(n,"e-disable")}},t.prototype.dispatchSelect=function(e,i,r,n,a,o,l){var h=this,u=this.listData;if(this.initStatus&&!n){e=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",e):e;var c=o||this.getDataByValue(e),f={e:i,item:r,itemData:c,isInteracted:!!i,cancel:!1};this.trigger("select",f,function(d){if(!d.cancel){if(a&&(h.selectAllEventData.push(c),h.selectAllEventEle.push(r)),a===1){var p={event:i,items:h.selectAllEventEle,itemData:h.selectAllEventData,isInteracted:!!i,isChecked:!0};h.trigger("selectedAll",p),h.selectAllEventData=[]}h.allowCustomValue&&h.isServerRendered&&h.listData!==u&&(h.listData=u),e=h.allowObjectBinding?h.getDataByValue(e):e,h.enableVirtualization&&(m(h.selectedListData)?h.selectedListData=[h.getDataByValue(e)]:o?Array.isArray(h.selectedListData)?h.selectedListData.push(o):h.selectedListData=[h.selectedListData,o]:Array.isArray(h.selectedListData)?h.selectedListData.push(h.getDataByValue(e)):h.selectedListData=[h.selectedListData,h.getDataByValue(e)]),(h.enableVirtualization&&e||!h.enableVirtualization)&&h.updateListSelectEventCallback(e,r,i,l),h.hideSelectedItem&&h.fixedHeaderElement&&h.fields.groupBy&&h.mode!=="CheckBox"&&s.prototype.scrollStop.call(h)}})}},t.prototype.addChip=function(e,i,r){this.chipCollectionWrapper&&this.getChip(e,i,r)},t.prototype.removeChipFocus=function(){var e=this.chipCollectionWrapper.querySelectorAll("span."+Ja+"."+un);if(Z(e,un),xe.isDevice)for(var i=this.chipCollectionWrapper.querySelectorAll("span."+Au.split(" ")[0]),r=0;r<i.length;r++)i[r].style.display="none"},t.prototype.onMobileChipInteraction=function(e){var i=X(e.target,"."+Ja),r=i.querySelector("span."+Au.split(" ")[0]);this.enabled&&!this.readonly&&(i.classList.contains(un)||(this.removeChipFocus(),r.style.display="",i.classList.add(un)),this.refreshPopup(),e.preventDefault())},t.prototype.multiCompiler=function(e){var i=!1;if(typeof e!="function"&&e)try{i=!!dt(e,document).length}catch(r){i=!1}return i},t.prototype.encodeHtmlEntities=function(e){return e.replace(/[\u00A0-\u9999<>&]/g,function(i){return"&#"+i.charCodeAt(0)+";"})},t.prototype.getChip=function(e,i,r){var n=this,a={text:i,value:i},o=this.createElement("span",{className:Ja,attrs:{"data-value":i,title:e}}),l,h=this.createElement("span",{className:JH}),u=this.createElement("span",{className:Au});if(this.mainData&&(a=this.getDataByValue(i)),this.valueTemplate&&!m(a)){var c=this.multiCompiler(this.valueTemplate);typeof this.valueTemplate!="function"&&c?l=wt(ye(this.valueTemplate,document).innerHTML.trim()):l=wt(this.valueTemplate);var f=l(a,this,"valueTemplate",this.valueTemplateId,this.isStringTemplate,null,h);f&&f.length>0&&at(f,h),this.renderReactTemplates()}else this.enableHtmlSanitizer?h.innerText=e:h.innerHTML=this.encodeHtmlEntities(e.toString());o.appendChild(h);var d={isInteracted:!!r,itemData:a,e:r,setClass:function(p){P([o],p)},cancel:!1};this.isPreventChange=this.isAngular&&this.preventChange,this.trigger("tagging",d,function(p){p.cancel||(xe.isDevice?(o.classList.add(i3),at([u],o),u.style.display="none",R.add(o,"click",n.onMobileChipInteraction,n)):(R.add(o,"mousedown",n.chipClick,n),n.showClearButton&&o.appendChild(u)),R.add(u,"mousedown",n.onChipRemove,n),n.chipCollectionWrapper.appendChild(o),!n.changeOnBlur&&r&&n.updateValueState(r,n.value,n.tempValues))})},t.prototype.calcPopupWidth=function(){var e=st(this.popupWidth);if(e.indexOf("%")>-1){var i=this.componentWrapper.offsetWidth*parseFloat(e)/100;e=i.toString()+"px"}return e},t.prototype.mouseIn=function(){this.enabled&&!this.readonly&&this.showOverAllClear()},t.prototype.mouseOut=function(){this.inputFocus||(this.overAllClear.style.display="none")},t.prototype.listOption=function(e,i){var r=!m(i.iconCss),n=m(i.properties)?i:i.properties;return this.listCurrentOptions=i.text!==null||i.value!==null?{fields:n,showIcon:r,ariaAttributes:{groupItemRole:"presentation"}}:{fields:{value:"text"}},Ue(this.listCurrentOptions,this.listCurrentOptions,i,!0),this.mode==="CheckBox"&&this.notify("listoption",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",dataSource:e,fieldProperty:n}),this.listCurrentOptions},t.prototype.renderPopup=function(){var e=this;if(this.list||s.prototype.render.call(this),this.popupObj&&document.body.contains(this.popupObj.element)&&this.allowFiltering){this.refreshPopup();return}if(!this.popupObj&&!m(this.popupWrapper)){document.body.appendChild(this.popupWrapper);var i=this.popupWrapper.querySelector("."+l3);this.mode==="CheckBox"&&!this.allowFiltering&&i&&this.filterParent&&(i.remove(),this.filterParent=null);var r=parseInt(this.popupHeight,10);if(this.popupWrapper.style.visibility="hidden",this.headerTemplate&&(this.setHeaderTemplate(),r-=this.header.offsetHeight,this.isUpdateHeaderHeight=this.header.offsetHeight!==0),at([this.list],this.popupWrapper),!this.list.classList.contains(ne.noData)&&this.getItems()[1]&&(this.listItemHeight=this.getItems()[1].offsetHeight+parseInt(window.getComputedStyle(this.getItems()[1]).marginBottom,10)),this.enableVirtualization&&!this.list.classList.contains(ne.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")&&this.list.querySelector(".e-list-parent")){var n=this.createElement("div",{className:"e-virtual-ddl-content"});n.style.cssText=this.getTransformValues(),this.list.appendChild(n).appendChild(this.list.querySelector(".e-list-parent"))}else this.list.querySelector(".e-virtual-ddl-content")&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues());if(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+ne.li),this.virtualItemCount=this.itemCount,this.mode!=="CheckBox"&&this.totalItemsCount(),this.list.querySelector(".e-virtual-ddl"))this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else{var a=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});a.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(a)}}if(this.footerTemplate&&(this.setFooterTemplate(),r-=this.footer.offsetHeight,this.isUpdateFooterHeight=this.footer.offsetHeight!==0),this.mode==="CheckBox"&&this.showSelectAll?(this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),r-=this.selectAllHeight):this.mode==="CheckBox"&&!this.showSelectAll&&!this.headerTemplate&&!this.footerTemplate?(this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),r=parseInt(this.popupHeight,10)):this.mode==="CheckBox"&&!this.showSelectAll&&(this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),r=parseInt(this.popupHeight,10),this.headerTemplate&&this.header&&(r-=this.header.offsetHeight),this.footerTemplate&&this.footer&&(r-=this.footer.offsetHeight)),this.mode==="CheckBox"){var o={module:"CheckBoxSelection",enable:this.mode==="CheckBox",popupElement:this.popupWrapper};this.allowFiltering&&(this.notify("searchBox",o),r-=this.searchBoxHeight),P([this.popupWrapper],"e-checkbox")}this.popupHeight!=="auto"?(this.list.style.maxHeight=st(r),this.popupWrapper.style.maxHeight=st(this.popupHeight)):this.list.style.maxHeight=st(this.popupHeight),this.popupObj=new Bo(this.popupWrapper,{width:this.calcPopupWidth(),targetType:"relative",position:this.enableRtl?{X:"right",Y:"bottom"}:{X:"left",Y:"bottom"},relateTo:this.overAllWrapper,collision:this.enableRtl?{X:"fit",Y:"flip"}:{X:"flip",Y:"flip"},offsetY:1,enableRtl:this.enableRtl,zIndex:this.zIndex,close:function(){if(e.popupObj.element.parentElement){e.popupObj.unwireScrollEvents();var l=e.popupWrapper.querySelector("."+wd);e.mode==="CheckBox"&&l&&document.activeElement===l&&l.blur(),Oe(e.popupObj.element)}},open:function(){if(e.popupObj.resolveCollision(),!e.isFirstClick){var l=e.list.querySelector("ul");l&&(e.mode!=="CheckBox"&&(e.allowFiltering||e.allowCustomValue)&&e.targetElement().trim()!==""||(e.mainList=l.cloneNode?l.cloneNode(!0):l)),e.isFirstClick=!0}e.popupObj.wireScrollEvents(),!(e.mode!=="CheckBox"&&(e.allowFiltering||e.allowCustomValue)&&e.targetElement().trim()!=="")&&!e.enableVirtualization&&(e.loadTemplate(),e.enableVirtualization&&e.mode==="CheckBox"&&e.UpdateSkeleton()),e.isPreventScrollAction=!0,e.setScrollPosition(),!e.list.classList.contains(ne.noData)&&e.getItems()[1]&&e.getItems()[1].offsetHeight!==0&&(e.listItemHeight=e.getItems()[1].offsetHeight+parseInt(window.getComputedStyle(e.getItems()[1]).marginBottom,10),e.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(e.list.getElementsByClassName("e-virtual-ddl-content")[0].style=e.getTransformValues())),e.allowFiltering&&e.notify("inputFocus",{module:"CheckBoxSelection",enable:e.mode==="CheckBox",value:"focus"}),e.enableVirtualization&&(e.notify("bindScrollEvent",{module:"VirtualScroll",component:e.getModuleName(),enable:e.enableVirtualization}),setTimeout(function(){e.value?e.updateSelectionList():e.viewPortInfo&&e.viewPortInfo.offsets.top&&(e.list.scrollTop=e.viewPortInfo.offsets.top)},5))},targetExitViewport:function(){xe.isDevice||e.hidePopup()}}),this.checkCollision(this.popupWrapper),this.popupContentElement=this.popupObj.element.querySelector(".e-content"),this.mode==="CheckBox"&&xe.isDevice&&this.allowFiltering&&this.isDeviceFullScreen&&this.notify("deviceSearchBox",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),this.allowResize&&this.setResize(),this.popupObj.close(),this.popupWrapper.style.visibility=""}},t.prototype.checkCollision=function(e){if(!(this.mode==="CheckBox"&&xe.isDevice&&this.allowFiltering&&this.isDeviceFullScreen)){var i=Gc(e);i.length>0&&(e.style.marginTop=-parseInt(getComputedStyle(e).marginTop,10)+"px"),this.popupObj.resolveCollision()}},t.prototype.setHeaderTemplate=function(){var e;this.header&&this.header.remove(),this.header=this.createElement("div"),P([this.header],s3);var i=this.multiCompiler(this.headerTemplate);typeof this.headerTemplate!="function"&&i?e=wt(ye(this.headerTemplate,document).innerHTML.trim()):e=wt(this.headerTemplate);var r=e({},this,"headerTemplate",this.headerTemplateId,this.isStringTemplate,null,this.header);r&&r.length>0&&at(r,this.header),this.mode==="CheckBox"&&this.showSelectAll?Ii([this.header],this.popupWrapper):at([this.header],this.popupWrapper),R.add(this.header,"mousedown",this.onListMouseDown,this)},t.prototype.setFooterTemplate=function(){var e;this.footer&&this.footer.remove(),this.footer=this.createElement("div"),P([this.footer],r3);var i=this.multiCompiler(this.footerTemplate);typeof this.footerTemplate!="function"&&i?e=wt(ye(this.footerTemplate,document).innerHTML.trim()):e=wt(this.footerTemplate);var r=e({},this,"footerTemplate",this.footerTemplateId,this.isStringTemplate,null,this.footer);r&&r.length>0&&at(r,this.footer),at([this.footer],this.popupWrapper),R.add(this.footer,"mousedown",this.onListMouseDown,this)},t.prototype.updateInitialData=function(){var e=this.selectData;if(this.renderItems(e,this.fields),this.list.scrollTop=0,this.virtualListInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount},this.previousStartIndex=0,this.previousEndIndex=this.itemCount,this.dataSource instanceof fe?this.remoteDataCount>=0?this.totalItemCount=this.dataCount=this.remoteDataCount:this.resetList(this.dataSource):this.totalItemCount=this.dataCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.getSkeletonCount(),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof fe)||this.dataSource instanceof fe&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.UpdateSkeleton(),this.list.getElementsByClassName("e-virtual-ddl")[0])this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.skeletonCount>0){var i=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});i.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(i)}this.listData=e,this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues()),this.enableVirtualization&&this.notify("setGeneratedData",{module:"VirtualScroll"})},t.prototype.clearAll=function(e){if(this.enabled&&!this.readonly){var i=void 0;if(this.setDynValue=!1,this.isClearAllAction=!0,this.value&&this.value.length>0){this.allowFiltering&&(this.refreshListItems(null),this.mode==="CheckBox"&&this.targetInputElement&&(this.targetInputElement.value=""));var r=this.list&&this.list.querySelectorAll("li.e-list-item");if(r&&r.length>0)this.selectAllItems(!1,e);else for(this.removeIndex=0,i=this.value[this.removeIndex];this.removeIndex<this.value.length;i=this.value[this.removeIndex])this.removeValue(i,e,null,!0);this.selectedElementID=null,this.inputElement.removeAttribute("aria-activedescendant")}else this.clearAllCallback(e);this.checkAndResetCache(),Te.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),!m(this.overAllWrapper)&&!m(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.enableVirtualization&&(this.updateInitialData(),this.chipCollectionWrapper&&(this.chipCollectionWrapper.innerHTML=""),this.isCustomDataUpdated||this.notify("setGeneratedData",{module:"VirtualScroll"})),this.enableVirtualization&&(this.list.scrollTop=0,this.virtualListInfo=null,this.previousStartIndex=0,this.previousEndIndex=this.itemCount),this.isClearAllAction=!1}this.isClearAllItem=!0,R.add(document,"mouseup",this.preventSelection,this)},t.prototype.preventSelection=function(e){this.isClearAllItem&&e.stopPropagation(),this.isClearAllItem=!1,R.remove(document,"mouseup",this.preventSelection)},t.prototype.clearAllCallback=function(e,i){var r=this.value?this.value.slice():[];if(this.mainList&&this.listData&&(this.allowFiltering&&this.mode!=="CheckBox"||this.allowCustomValue)){var n=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.onActionComplete(n,this.mainData)}this.focusAtFirstListItem(),this.updateDelimeter(this.delimiterChar,e),this.mode!=="Box"&&(!this.inputFocus||this.mode==="CheckBox")&&this.updateDelimView(),this.inputElement.value!==""&&(this.makeTextBoxEmpty(),this.search(null)),this.checkPlaceholderSize(),this.isPopupOpen()&&this.refreshPopup(),this.allowResize&&this.setResize(),this.inputFocus||(this.changeOnBlur&&this.updateValueState(e,this.value,r),this.mode!=="CheckBox"&&this.inputElement.focus()),this.mode==="CheckBox"&&(this.refreshPlaceHolder(),this.refreshInputHight(),this.changeOnBlur&&i&&(m(this.value)||this.value.length===0)&&this.updateValueState(e,this.value,this.tempValues)),!this.changeOnBlur&&i&&(m(this.value)||this.value.length===0)&&this.updateValueState(e,this.value,this.tempValues),this.mode==="CheckBox"&&this.enableGroupCheckBox&&!m(this.fields.groupBy)&&this.updateListItems(this.list.querySelectorAll("li.e-list-item"),this.mainList.querySelectorAll("li.e-list-item")),e.preventDefault()},t.prototype.windowResize=function(){this.refreshPopup(),(!this.inputFocus||this.mode==="CheckBox")&&this.viewWrapper&&this.viewWrapper.parentElement&&this.updateDelimView()},t.prototype.resetValueHandler=function(e){if(!m(this.inputElement)){var i=X(this.inputElement,"form");if(i&&e.target===i){var r=this.element.tagName===this.getNgDirective()?null:this.element.getAttribute("data-initial-value");this.text=r}}},t.prototype.wireEvent=function(){R.add(this.componentWrapper,"mousedown",this.wrapperClick,this),R.add(window,"resize",this.windowResize,this),R.add(this.inputElement,"focus",this.focusInHandler,this),R.add(this.inputElement,"keydown",this.onKeyDown,this),R.add(this.inputElement,"keyup",this.keyUp,this),this.mode!=="CheckBox"&&R.add(this.inputElement,"input",this.onInput,this),R.add(this.inputElement,"blur",this.onBlurHandler,this),R.add(this.componentWrapper,"mouseover",this.mouseIn,this);var e=X(this.inputElement,"form");e&&R.add(e,"reset",this.resetValueHandler,this),R.add(this.componentWrapper,"mouseout",this.mouseOut,this),R.add(this.overAllClear,"mousedown",this.clearAll,this),R.add(this.inputElement,"paste",this.pasteHandler,this)},t.prototype.onInput=function(e){this.keyDownStatus?this.isValidKey=!0:this.isValidKey=!1,this.keyDownStatus=!1,xe.isDevice&&xe.info.name==="mozilla"&&this.search(e)},t.prototype.pasteHandler=function(e){var i=this;setTimeout(function(){i.expandTextbox(),i.search(e)})},t.prototype.search=function(e){var i=this;if(this.preventSetCurrentData=!1,this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null,m(e)||(this.keyCode=e.keyCode),!this.isPopupOpen()&&this.openOnClick&&this.showPopup(e),this.openClick(e),this.checkTextLength()&&!this.allowFiltering&&!m(e)&&e.keyCode!==8)this.focusAtFirstListItem();else{var r=this.targetElement();if(this.allowFiltering){this.allowCustomValue&&(this.isRemoteSelection=!0),this.checkAndResetCache(),this.isRequesting=!1;var n={preventDefaultAction:!1,text:this.targetElement(),updateData:function(p,v,g){n.cancel||(i.isFiltered=!0,i.customFilterQuery=v,i.remoteFilterAction=!0,i.isCustomFiltering=!0,i.dataUpdater(p,v,g))},event:e,cancel:!1};this.trigger("filtering",n,function(p){i.isFilterPrevented=p.cancel,p.cancel||!i.isFiltered&&!p.preventDefaultAction&&(i.filterAction=!0,i.isFilteringAction=!0,i.dataSource instanceof fe&&i.allowCustomValue&&(i.isCustomRendered=!1),i.dataUpdater(i.dataSource,null,i.fields),i.isFilteringAction=!1)})}else if(this.allowCustomValue){var a=new We;a=this.allowFiltering&&r!==""?a.where(this.fields.text,"startswith",r,this.ignoreCase,this.ignoreAccent):a,this.enableVirtualization?this.dataUpdater(this.dataSource,a,this.fields):this.dataUpdater(this.mainData,a,this.fields),this.UpdateSkeleton()}else{var o=this.list.querySelectorAll("li."+ne.li+":not(.e-hide-listitem)"),l=this.typeOfData(this.listData).typeof,h=Ua(this.targetElement(),o,"StartsWith",this.ignoreCase);if(this.enableVirtualization&&this.targetElement().trim()!==""&&!this.allowFiltering){var u=!1;for((this.viewPortInfo.endIndex>=this.incrementalEndIndex&&this.incrementalEndIndex<=this.totalItemCount||this.incrementalEndIndex===0)&&(u=!0,this.incrementalStartIndex=0,this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),u=!1),(this.viewPortInfo.startIndex!==0||u)&&this.updateIncrementalView(0,this.itemCount),h=Ua(this.targetElement(),this.incrementalLiCollections,this.filterType,!0,this.listData,this.fields,l);m(h)&&this.incrementalEndIndex<this.totalItemCount&&(this.incrementalStartIndex=this.incrementalEndIndex,this.incrementalEndIndex=this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),u=!0,(this.viewPortInfo.startIndex!==0||u)&&this.updateIncrementalView(0,this.itemCount),h=Ua(this.targetElement(),this.incrementalLiCollections,this.filterType,!0,this.listData,this.fields,l),!!m(h));)if(m(h)&&this.incrementalEndIndex>=this.totalItemCount){this.incrementalStartIndex=0,this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100;break}if(h.index&&(!(this.viewPortInfo.startIndex>=h.index)||!(h.index>=this.viewPortInfo.endIndex))){var c=h.index-(this.itemCount/2-2)>0?h.index-(this.itemCount/2-2):0,f=c+this.itemCount>this.totalItemCount?this.totalItemCount:c+this.itemCount;c!==this.viewPortInfo.startIndex&&this.updateIncrementalView(c,f)}if(m(h.item))this.updateIncrementalView(0,this.itemCount),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.list.scrollTop=0;else{var d=this.getIndexByValue(h.item.getAttribute("data-value"))-this.skeletonCount;if(d>this.itemCount/2){var c=this.viewPortInfo.startIndex+(this.itemCount/2-2)<this.totalItemCount?this.viewPortInfo.startIndex+(this.itemCount/2-2):this.totalItemCount,f=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(c,f)}h.item=this.getElementByValue(h.item.getAttribute("data-value"))}h&&h.item&&(h.item=this.getElementByValue(h.item.getAttribute("data-value")))}h&&h.item?(this.addListFocus(h.item),this.list.scrollTop=h.item.offsetHeight*h.index):this.targetElement()!==""?this.removeFocus():this.focusAtFirstListItem()}}this.enableVirtualization&&this.allowFiltering&&this.getFilteringSkeletonCount()},t.prototype.preRender=function(){this.allowFiltering===null&&(this.allowFiltering=this.mode==="CheckBox"),this.preventSetCurrentData=!1,this.initializeData(),this.updateDataAttribute(this.htmlAttributes),s.prototype.preRender.call(this)},t.prototype.getLocaleName=function(){return"multi-select"},t.prototype.initializeData=function(){this.mainListCollection=[],this.beforePopupOpen=!1,this.filterAction=!1,this.remoteFilterAction=!1,this.isFirstClick=!1,this.mobFilter=!0,this.isFiltered=!1,this.focused=!0,this.initial=!0,this.backCommand=!0,this.isCustomRendered=!1,this.isRemoteSelection=!1,this.isSelectAllTarget=!0,this.isaddNonPresentItems=!1,this.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount}},t.prototype.updateData=function(e,i,r){var n="",a=this.mode==="Delimiter"||this.mode==="CheckBox",o=[],l,h=this.listData;if(this.enableVirtualization||(this.listData=this.mainData),!m(this.hiddenElement)&&!this.enableVirtualization&&(this.hiddenElement.innerHTML=""),!m(this.value)){for(var u=this.value.length,c="",f=function(x){var w=d.allowObjectBinding?ie(d.fields.value?d.fields.value:"",d.value[x]):d.value[x],S=d.findListElement(m(d.mainList)?d.ulElement:d.mainList,"li","data-value",w);if(d.enableVirtualization&&(S=d.findListElement(m(d.list)?d.ulElement:d.list,"li","data-value",w)),m(S)&&!d.allowCustomValue&&!d.enableVirtualization&&d.listData&&d.listData.length>0)d.value.splice(x,1),x-=1,u-=1;else{if(d.listData)if(d.enableVirtualization){a&&!d.isDynamicRemoteVirtualData&&(n=d.delimiterWrapper&&d.delimiterWrapper.innerHTML===""?n:d.delimiterWrapper.innerHTML);var E=d.allowObjectBinding?ie(d.fields.value?d.fields.value:"",d.value[d.value.length-1]):d.value[d.value.length-1];if(d.isRemoveSelection)n=d.text.replace(/,/g,e+" ")+e+" ",o=d.text.split(e);else{l=r&&a?d.text:d.getTextByValue(E);var k=d.isDynamicRemoteVirtualData&&E!=null&&E!==""&&!r?d.getTextByValue(E):r?d.text:d.text&&d.text!==""?d.text+d.delimiterChar+l:l;n+=l+e+" ",o.push(k),c=d.hiddenElement.innerHTML}if(i&&i.currentTarget&&i.currentTarget.classList.contains("e-chips-close")||i&&i.key==="Backspace"){var A=i.target.parentElement.getAttribute("data-value");if(i.key==="Backspace"){var z=d.hiddenElement.lastChild;z&&d.hiddenElement.removeChild(z)}else d.hiddenElement.childNodes.forEach(function(D){D.value===A&&D.parentNode.removeChild(D)});c=d.hiddenElement.innerHTML}else c+="<option selected value='"+E+"'>"+x+"</option>";return p=x,"break"}else l=d.getTextByValue(w);else l=w;n+=l+e+" ",o.push(l)}c+='<option selected value="'+w+'">'+x+"</option>",p=x},d=this,p,v=0;v<u;v++){var g=f(v);if(v=p,g==="break")break}m(this.hiddenElement)||(this.isRemoveSelection?(this.findListElement(this.hiddenElement,"option","value",this.currentRemoveValue)&&this.hiddenElement.removeChild(this.findListElement(this.hiddenElement,"option","value",this.currentRemoveValue)),this.isRemoveSelection=!1):this.hiddenElement.innerHTML=c)}var b=i&&i.target&&i.target.classList.contains("e-chips-close");(!this.enableVirtualization||this.enableVirtualization&&this.mode!=="CheckBox"&&!b)&&this.setProperties({text:o.toString()},!0),a&&(this.updateWrapperText(this.delimiterWrapper,n),this.delimiterWrapper.setAttribute("id",fi("delim_val")),this.inputElement.setAttribute("aria-describedby",this.delimiterWrapper.id));var C=i&&i.target,y=C&&C.classList.contains("e-close-hooker")?!0:null;(!this.changeOnBlur&&i&&!y||this.isSelectAll)&&(this.isSelectAll=!1,this.updateValueState(i,this.value,this.tempValues)),this.listData=h,this.addValidInputClass()},t.prototype.initialTextUpdate=function(){if(m(this.text))this.setProperties({value:null},!0);else{for(var e=this.text.split(this.delimiterChar),i=[],r=0;e.length>r;r++){var n=this.getValueByText(e[r]);m(n)?this.allowCustomValue&&i.push(e[r]):i.push(n)}if(i&&i.length){var a=this.allowObjectBinding?this.getDataByValue(i):i;this.setProperties({value:a},!0)}}},t.prototype.renderList=function(e){!e&&this.allowCustomValue&&this.list&&(this.list.textContent===this.noRecordsTemplate||this.list.querySelector(".e-ul")&&this.list.querySelector(".e-ul").childElementCount===0)&&(e=!0),s.prototype.render.call(this,null,e),this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.unwireListEvents(),this.wireListEvents()},t.prototype.initialValueUpdate=function(e,i){if(this.list){var r=void 0,n=void 0,a=void 0;if(this.chipCollectionWrapper&&(this.chipCollectionWrapper.innerHTML=""),this.removeListSelection(),!m(this.value))for(var o=0;!m(this.value[o]);o++){a=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[o]):this.value[o],n=this.findListElement(this.hideSelectedItem?this.ulElement:this.list,"li","data-value",a);var l=!1;if(this.enableVirtualization){if(r=null,e!=null&&e.length>0){for(var h=0;h<e.length;h++)if(this.isPrimitiveData&&e[h]===a||!this.isPrimitiveData&&ie(this.fields.value?this.fields.value:"value",e[h])===a){r=this.isPrimitiveData?e[h]:ie(this.fields.text,e[h]),this.enableVirtualization&&(m(this.selectedListData)?this.selectedListData=[e[h]]:Array.isArray(this.selectedListData)?this.selectedListData.push(e[h]):this.selectedListData=[this.selectedListData,e[h]]);break}}m(r)&&this.allowCustomValue&&(!(this.dataSource instanceof fe)||this.dataSource instanceof fe&&i)&&(r=this.getTextByValue(a),l=!0)}else r=this.getTextByValue(a);if(n&&n.getAttribute("aria-selected")!=="true"||n&&n.getAttribute("aria-selected")==="true"&&this.hideSelectedItem&&(this.mode==="Box"||this.mode==="Default")||this.enableVirtualization&&a!=null&&r!=null&&!l){var u=[],c=this.isDynamicRemoteVirtualData&&r!=null&&r!==""&&o===0?r:this.text!=null&&this.text!==""&&!this.text.includes(r)?this.text+this.delimiterChar+r:r;u.push(c),this.setProperties({text:u.toString()},!0),this.addChip(r,a),this.addListSelection(n)}else if(!this.enableVirtualization&&a&&this.allowCustomValue||this.enableVirtualization&&a&&this.allowCustomValue&&(!(this.dataSource instanceof fe)||this.dataSource instanceof fe&&i)){var f=this.listData.length,d={};It(this.fields.text,a,d),It(this.fields.value,a,d);var p=this.popupWrapper.querySelector("."+ne.noData);this.enableVirtualization||this.addItem(d,f),this.enableVirtualization&&(this.virtualCustomSelectData&&this.virtualCustomSelectData.length>=0?this.virtualCustomSelectData.push(d):this.virtualCustomSelectData=[d]),n=n||this.findListElement(this.hideSelectedItem?this.ulElement:this.list,"li","data-value",a),this.popupWrapper.contains(p)&&(this.list.setAttribute("style",p.getAttribute("style")),this.popupWrapper.replaceChild(this.list,p),this.wireListEvents());var u=[],c=this.text!=null&&this.text!==""?this.text+this.delimiterChar+r:r;u.push(c),this.setProperties({text:u.toString()},!0),this.addChip(r,a),this.addListSelection(n)}}this.mode==="CheckBox"?(this.updateDelimView(),this.changeOnBlur&&this.updateValueState(null,this.value,this.tempValues),this.updateDelimeter(this.delimiterChar),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar,null,i),this.mode==="CheckBox"&&this.showSelectAll&&(m(this.value)||!this.value.length)&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"uncheck"}),this.mode==="Box"||this.mode==="Default"&&this.inputFocus?this.chipCollectionWrapper.style.display="":(this.mode==="Delimiter"||this.mode==="CheckBox")&&this.showDelimWrapper()}},t.prototype.updateActionCompleteData=function(e,i){this.value&&(!this.allowObjectBinding&&this.value.indexOf(e.getAttribute("data-value"))>-1||this.allowObjectBinding&&this.isObjectInArray(this.getDataByValue(e.getAttribute("data-value")),this.value))&&(this.mainList=this.ulElement,this.hideSelectedItem&&P([e],Ot))},t.prototype.updateAddItemList=function(e,i){this.popupObj&&this.popupObj.element&&this.popupObj.element.querySelector("."+ne.noData)&&e?(this.list=e,this.mainList=this.ulElement=e.querySelector("ul"),Zi(this.popupWrapper.querySelector(".e-content")),this.popupObj=null,this.renderPopup()):this.allowCustomValue&&(this.list=e,this.mainList=this.ulElement=e.querySelector("ul"))},t.prototype.updateDataList=function(){if(this.mainList&&this.ulElement&&!(this.isFiltered||this.filterAction||this.targetElement().trim())){var e=this.mainList.childElementCount<this.ulElement.childElementCount,i=this.ulElement.childElementCount>0&&this.ulElement.children[0].childElementCount>0&&this.mainList.children[0]&&this.mainList.children[0].childElementCount<this.ulElement.children[0].childElementCount,r=this.itemTemplate&&this.ulElement.childElementCount>0&&!(this.ulElement.childElementCount<this.mainList.childElementCount)&&(this.ulElement.children[0].childElementCount>0||this.fields.groupBy&&this.ulElement.children[1]&&this.ulElement.children[1].childElementCount>0);(e||i||r)&&(this.mainList=this.ulElement)}},t.prototype.isValidLI=function(e){return e&&!e.classList.contains(ne.disabled)&&!e.classList.contains(ne.group)&&e.classList.contains(ne.li)},t.prototype.updateListSelection=function(e,i,r){var n=e.getAttribute("data-value"),a=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(n)):this.getFormattedValue(n);this.allowCustomValue&&(n!=="false"&&a===!1||!m(a)&&a.toString()==="NaN")&&(a=n),this.removeHover(),!this.value||!this.allowObjectBinding&&this.value.indexOf(a)===-1||this.allowObjectBinding&&this.indexOfObjectInArray(a,this.value)===-1?this.dispatchSelect(a,i,e,e.getAttribute("aria-selected")==="true",r):this.removeValue(a,i,r),this.checkAndScrollParent()},t.prototype.updateListSelectEventCallback=function(e,i,r,n){var a=this;e=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",e):e;var o=n||this.getTextByValue(e);if((this.allowCustomValue||this.allowFiltering)&&!this.findListElement(this.mainList,"li","data-value",e)&&(!this.enableVirtualization||this.enableVirtualization&&this.virtualCustomData)){var l=i&&i.cloneNode(!0),h=this.fields.value?this.fields.value:"value";this.allowCustomValue&&this.mainData.length&&typeof ie(h,this.mainData[0])=="number"&&(e=isNaN(parseFloat(e.toString()))?e:parseFloat(e.toString()));var u=this.getDataByValue(e),c={newData:u,cancel:!1};this.trigger("customValueSelection",c,function(f){f.cancel||(a.enableVirtualization&&a.virtualCustomData?(a.virtualCustomSelectData&&a.virtualCustomSelectData.length>=0?a.virtualCustomSelectData.push(u):a.virtualCustomSelectData=[u],a.remoteCustomValue=!1,a.addValue(e,o,r)):(at([l],a.mainList),a.mainData.push(u),a.remoteCustomValue=!1,a.addValue(e,o,r)))})}else this.remoteCustomValue=!1,this.addValue(e,o,r)},t.prototype.removeListSelection=function(){var e=this.hideSelectedItem?Ot:ne.selected,i=this.list.querySelectorAll("."+e),r=i.length;if(i&&i.length)for(Z(i,e);r>0;)i[r-1].setAttribute("aria-selected","false"),r--;if(!m(this.mainList)){var n=this.mainList.querySelectorAll("."+e),a=n.length;if(n&&n.length)for(Z(n,e);a>0;)n[a-1].setAttribute("aria-selected","false"),this.mode==="CheckBox"&&(i&&i.length>a-1&&Z([i[a-1].firstElementChild.lastElementChild],"e-check"),Z([n[a-1].firstElementChild.lastElementChild],"e-check")),a--}},t.prototype.removeHover=function(){var e=this.list.querySelectorAll("."+ne.hover);e&&e.length&&Z(e,ne.hover)},t.prototype.removeFocus=function(){if(this.list&&this.mainList){var e=this.list.querySelectorAll("."+ne.focus),i=this.mainList.querySelectorAll("."+ne.focus);e&&e.length&&(Z(e,ne.focus),Z(i,ne.focus))}},t.prototype.addListHover=function(e){this.enabled&&this.isValidLI(e)?(this.removeHover(),P([e],ne.hover)):e!==null&&e.classList.contains("e-list-group-item")&&this.enableGroupCheckBox&&this.mode==="CheckBox"&&!m(this.fields.groupBy)&&(this.removeHover(),P([e],ne.hover))},t.prototype.addListFocus=function(e){this.enabled&&(this.isValidLI(e)||this.fields.disabled&&this.isDisabledElement(e))?(this.removeFocus(),P([e],ne.focus),this.updateAriaActiveDescendant()):this.enableGroupCheckBox&&this.mode==="CheckBox"&&!m(this.fields.groupBy)&&(P([e],ne.focus),this.updateAriaActiveDescendant())},t.prototype.addListSelection=function(e,i){var r=this.hideSelectedItem?Ot:ne.selected;if(this.isValidLI(e)&&!e.classList.contains(ne.hover)){if(P([e],r),this.updateMainList(!1,e.getAttribute("data-value"),i),e.setAttribute("aria-selected","true"),this.mode==="CheckBox"&&e.classList.contains("e-active")){var n=e.getElementsByClassName("e-check").length;n===0&&this.notify("updatelist",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:e,e:this})}this.notify("activeList",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:e,e:this}),this.chipCollectionWrapper&&this.removeChipSelection(),this.selectedElementID=e.id}},t.prototype.updateDelimeter=function(e,i,r){this.updateData(e,i,r)},t.prototype.onMouseClick=function(e){var i=this;if(!this.isClearAllItem){this.keyCode=null,this.scrollFocusStatus=!1,this.keyboardEvent=null;var r=e.target,n=X(r,"."+ne.li);if(this.enableVirtualization&&n&&n.classList.contains("e-virtual-list"))return;var a=X(r,"."+ne.group);if(a&&this.enableGroupCheckBox&&this.mode==="CheckBox"&&this.fields.groupBy)r=r.classList.contains("e-list-group-item")?r.firstElementChild.lastElementChild:e.target,r.classList.contains("e-check")?(this.selectAllItem(!1,e),r.classList.remove("e-check"),r.classList.remove("e-stop"),X(r,".e-list-group-item").classList.remove("e-active"),r.setAttribute("aria-selected","false")):(this.selectAllItem(!0,e),r.classList.remove("e-stop"),r.classList.add("e-check"),X(r,".e-list-group-item").classList.add("e-active"),r.setAttribute("aria-selected","true")),this.refreshSelection(),this.checkSelectAll();else{if(this.isValidLI(n)){var o=this.value&&this.value.length?this.value.length:0;n.classList.contains("e-active")&&(o=o-1),o<this.maximumSelectionLength&&(this.updateListSelection(n,e),this.checkPlaceholderSize(),this.addListFocus(n),(this.allowCustomValue||this.allowFiltering)&&this.mainList&&this.listData?this.mode!=="CheckBox"&&(this.focusAtLastListItem(n.getAttribute("data-value")),this.refreshSelection()):this.makeTextBoxEmpty()),this.mode==="CheckBox"?(this.updateDelimView(),this.value&&this.value.length>50?setTimeout(function(){i.updateDelimeter(i.delimiterChar,e)},0):this.updateDelimeter(this.delimiterChar,e),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar,e),this.checkSelectAll(),this.refreshPopup(),this.allowResize&&this.setResize(),this.hideSelectedItem&&this.focusAtFirstListItem(),this.closePopupOnSelect?this.hidePopup(e):e.preventDefault();var l=this.targetElement().trim()!=="";this.makeTextBoxEmpty(),this.findGroupStart(r),this.mode!=="CheckBox"&&this.refreshListItems(m(n)?null:n.textContent,l)}else e.preventDefault();if(this.enableVirtualization&&this.hideSelectedItem){var h=this.list.querySelectorAll("li."+ne.li+":not(."+Ot+"):not(.e-reorder-hide):not(.e-virtual-list)");if(h.length){var u=this.virtualListHeight>0?Math.floor(this.virtualListHeight/this.listItemHeight):0;if(h.length<u+2){var c=this.getForQuery(this.value).clone();if(c=c.skip(this.virtualItemStartIndex),this.resetList(this.dataSource,this.fields,c),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+ne.li),this.virtualItemCount=this.itemCount,this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.list.querySelector(".e-virtual-ddl"))this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else{var f=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});f.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(f)}this.list.querySelector(".e-virtual-ddl-content")&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues())}}}this.refreshPlaceHolder(),this.deselectHeader()}}},t.prototype.findGroupStart=function(e){if(this.enableGroupCheckBox&&this.mode==="CheckBox"&&!m(this.fields.groupBy)){var i=0,r=0,n=0,a=void 0;if(this.itemTemplate&&!e.getElementsByClassName("e-frame").length)for(;!e.getElementsByClassName("e-frame").length;)e=e.parentElement;for(e.classList.contains("e-frame")&&(e=e.parentElement.parentElement),a=this.findGroupAttrtibutes(e,r,n,i,0),a=this.findGroupAttrtibutes(e,a[0],a[1],a[2],1);!e.classList.contains("e-list-group-item")&&(e.classList.contains("e-list-icon")&&(e=e.parentElement),e=e.previousElementSibling,e!=null););this.updateCheckBox(e,a[0],a[1],a[2])}},t.prototype.findGroupAttrtibutes=function(e,i,r,n,a){for(;!e.classList.contains("e-list-group-item")&&(this.fields.disabled&&this.isDisabledElement(e)||(e.classList.contains("e-list-icon")&&(e=e.parentElement),e.getElementsByClassName("e-frame")[0].classList.contains("e-check")&&e.classList.contains("e-list-item")?i++:e.classList.contains("e-list-item")&&r++,n++),e=a?e.nextElementSibling:e.previousElementSibling,e!=null););return[i,r,n]},t.prototype.updateCheckBox=function(e,i,r,n){if(!(e===null||!m(this.fields.disabled)&&n===0)){var a=e.getElementsByClassName("e-frame")[0];n===i?(a.classList.remove("e-stop"),a.classList.add("e-check"),X(a,".e-list-group-item").classList.add("e-active"),e.setAttribute("aria-selected","true")):n===r?(a.classList.remove("e-check"),a.classList.remove("e-stop"),X(a,".e-list-group-item").classList.remove("e-active"),e.setAttribute("aria-selected","false")):this.maximumSelectionLength===i-1?(a.classList.remove("e-stop"),e.setAttribute("aria-selected","true"),X(a,".e-list-group-item").classList.add("e-active"),a.classList.add("e-check")):(a.classList.remove("e-check"),a.classList.add("e-stop"),X(a,".e-list-group-item").classList.add("e-active"),e.setAttribute("aria-selected","false"))}},t.prototype.disableGroupHeader=function(){var e=this.list.querySelectorAll("li.e-list-group-item");if(e)for(var i=0;i<e.length;i++){for(var r=!0,n=e[i].nextElementSibling;!n.classList.contains("e-list-group-item");){if(!this.isDisabledElement(n)){r=!1;break}if(n=n.nextElementSibling,n==null)break}r&&this.disableListItem(e[i])}},t.prototype.deselectHeader=function(){var e=this.value&&this.value.length?this.value.length:0,i=this.list.querySelectorAll("li.e-list-group-item:not(.e-active)");e<this.maximumSelectionLength&&Z(i,"e-disable"),e===this.maximumSelectionLength&&P(i,"e-disable")},t.prototype.onMouseOver=function(e){var i=X(e.target,"."+ne.li);i===null&&this.mode==="CheckBox"&&!m(this.fields.groupBy)&&this.enableGroupCheckBox&&(i=X(e.target,"."+ne.group)),this.addListHover(i)},t.prototype.onMouseLeave=function(){this.removeHover()},t.prototype.onListMouseDown=function(e){e.preventDefault(),this.scrollFocusStatus=!0},t.prototype.onDocumentClick=function(e){if(this.mode!=="CheckBox"){var i=e.target;!(!m(this.popupObj)&&X(i,'[id="'+this.popupObj.element.id+'"]'))&&!this.overAllWrapper.contains(e.target)?this.scrollFocusStatus=!1:this.scrollFocusStatus=(xe.isIE||xe.info.name==="edge")&&document.activeElement===this.inputElement}},t.prototype.wireListEvents=function(){m(this.list)||(R.add(document,"mousedown",this.onDocumentClick,this),R.add(this.list,"mousedown",this.onListMouseDown,this),R.add(this.list,"mouseup",this.onMouseClick,this),R.add(this.list,"mouseover",this.onMouseOver,this),R.add(this.list,"mouseout",this.onMouseLeave,this))},t.prototype.unwireListEvents=function(){R.remove(document,"mousedown",this.onDocumentClick),this.list&&(R.remove(this.list,"mousedown",this.onListMouseDown),R.remove(this.list,"mouseup",this.onMouseClick),R.remove(this.list,"mouseover",this.onMouseOver),R.remove(this.list,"mouseout",this.onMouseLeave))},t.prototype.hideOverAllClear=function(){(!this.value||!this.value.length||this.inputElement.value==="")&&(this.overAllClear.style.display="none")},t.prototype.showOverAllClear=function(){(this.value&&this.value.length||this.inputElement.value!=="")&&this.showClearButton&&this.readonly!==!0?this.overAllClear.style.display="":this.overAllClear.style.display="none"},t.prototype.focusIn=function(){document.activeElement!==this.inputElement&&this.enabled&&this.inputElement.focus()},t.prototype.focusOut=function(){document.activeElement===this.inputElement&&this.enabled&&this.inputElement.blur()},t.prototype.showSpinner=function(){if(m(this.spinnerElement)){var e=this.filterParent&&this.filterParent.querySelector(".e-clear-icon.e-icons");this.overAllClear.style.display!=="none"||e?this.spinnerElement=e||this.overAllClear:(this.spinnerElement=this.createElement("span",{className:Jb+" "+ty}),this.componentWrapper.appendChild(this.spinnerElement)),Kc({target:this.spinnerElement,width:xe.isDevice?"16px":"14px"},this.createElement),P([this.spinnerElement],ey),Yc(this.spinnerElement)}},t.prototype.hideSpinner=function(){m(this.spinnerElement)||(Jc(this.spinnerElement),Z([this.spinnerElement],ey),this.spinnerElement.classList.contains(ty)?Oe(this.spinnerElement):this.spinnerElement.innerHTML="",this.spinnerElement=null)},t.prototype.updateWrapperText=function(e,i){this.valueTemplate||!this.enableHtmlSanitizer?e.innerHTML=this.encodeHtmlEntities(i):e.innerText=i},t.prototype.updateDelimView=function(){if(this.delimiterWrapper&&this.hideDelimWrapper(),this.chipCollectionWrapper&&(this.chipCollectionWrapper.style.display="none"),m(this.viewWrapper)||(this.viewWrapper.style.display="",this.viewWrapper.style.width="",this.viewWrapper.classList.remove(Du)),this.value&&this.value.length){var e="",i=void 0,r=void 0,n=1,a=void 0,o=void 0,l=0,h=void 0;this.enableVirtualization||this.updateWrapperText(this.viewWrapper,e);var u={noRecordsTemplate:"No records found",actionFailureTemplate:"Request failed",overflowCountTemplate:"+${count} more..",totalCountTemplate:"${count} selected"},c=new br(this.getLocaleName(),u,this.locale);c.getConstant("actionFailureTemplate")===""&&(c=new br("dropdowns",u,this.locale)),c.getConstant("noRecordsTemplate")===""&&(c=new br("dropdowns",u,this.locale));var f=c.getConstant("overflowCountTemplate"),d=c.getConstant("totalCountTemplate"),p=this.createElement("span",{className:ZH}),v=f.replace("${count}",this.value.length.toString());p.innerText=v,this.viewWrapper.appendChild(p),this.renderReactTemplates();var g=p.offsetWidth;if(Zi(p),this.showDropDownIcon&&(l=this.dropIcon.offsetWidth+parseInt(window.getComputedStyle(this.dropIcon).marginRight,10)),this.checkClearIconWidth(),!m(this.value)&&(this.allowCustomValue||this.listData&&this.listData.length>0))for(var b=0;!m(this.value[b]);b++){var C=this.text&&this.text.split(this.delimiterChar);if(this.enableVirtualization?C&&(e+=b===0?"":this.delimiterChar+" ",i=C[b],e+=i,i=this.viewWrapper.innerHTML,this.updateWrapperText(this.viewWrapper,e)):(e+=b===0?"":this.delimiterChar+" ",i=this.getOverflowVal(b),e+=i,i=this.viewWrapper.innerHTML,this.updateWrapperText(this.viewWrapper,e)),a=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10)+parseInt(window.getComputedStyle(this.viewWrapper).paddingLeft,10),h=this.componentWrapper.offsetWidth-parseInt(window.getComputedStyle(this.componentWrapper).paddingLeft,10)-parseInt(window.getComputedStyle(this.componentWrapper).paddingRight,10),a+l+this.clearIconWidth>h){for(r!==void 0&&r!==""&&(i=r,b=n+1),this.updateWrapperText(this.viewWrapper,i),o=this.value.length-b,a=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10)+parseInt(window.getComputedStyle(this.viewWrapper).paddingLeft,10);a+g+l+this.clearIconWidth>h&&a!==0&&this.viewWrapper.innerHTML!=="";){var y=[];this.viewWrapper.innerHTML=y.join(this.delimiterChar),o=this.value.length,a=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10)+parseInt(window.getComputedStyle(this.viewWrapper).paddingLeft,10)}break}else a+g+l+this.clearIconWidth<=h?(r=e,n=b):b===0&&(r="",n=-1)}if(o>0){var x=h-l-this.clearIconWidth;this.viewWrapper.appendChild(this.updateRemainTemplate(p,this.viewWrapper,o,f,d,x)),this.updateRemainWidth(this.viewWrapper,x),this.updateRemainingText(p,l,o,f,d)}}else m(this.viewWrapper)||(this.viewWrapper.innerHTML="",this.viewWrapper.style.display="none")},t.prototype.checkClearIconWidth=function(){this.showClearButton&&(this.clearIconWidth=parseInt(window.getComputedStyle(this.overAllClear).width,10))},t.prototype.updateRemainWidth=function(e,i){e.classList.contains(Du)&&i<e.offsetWidth+parseInt(window.getComputedStyle(e).paddingLeft,10)+parseInt(window.getComputedStyle(e).paddingRight,10)&&(e.style.width=i+"px")},t.prototype.updateRemainTemplate=function(e,i,r,n,a,o){i.firstChild&&i.firstChild.nodeType===3&&i.firstChild.nodeValue===""&&i.removeChild(i.firstChild),e.innerHTML="";var l=n.replace("${count}",r.toString()),h=a.replace("${count}",r.toString());return e.innerText=i.firstChild&&i.firstChild.nodeType===3?l:h,i.firstChild&&i.firstChild.nodeType===3?i.classList.remove(Du):(i.classList.add(Du),this.updateRemainWidth(i,o)),e},t.prototype.updateRemainingText=function(e,i,r,n,a){var o=this.componentWrapper.offsetWidth-parseInt(window.getComputedStyle(this.componentWrapper).paddingLeft,10)-parseInt(window.getComputedStyle(this.componentWrapper).paddingRight,10),l=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10);if(l+i>=o&&l!==0&&this.viewWrapper.firstChild&&this.viewWrapper.firstChild.nodeType===3){for(;l+i>o&&l!==0&&this.viewWrapper.firstChild&&this.viewWrapper.firstChild.nodeType===3;){var h=this.viewWrapper.firstChild.nodeValue.split(this.delimiterChar);h.pop(),this.viewWrapper.firstChild.nodeValue=h.join(this.delimiterChar),this.viewWrapper.firstChild.nodeValue===""&&this.viewWrapper.removeChild(this.viewWrapper.firstChild),r++,l=this.viewWrapper.offsetWidth}var u=o-i;this.updateRemainTemplate(e,this.viewWrapper,r,n,a,u)}},t.prototype.getOverflowVal=function(e){var i;if(this.mainData&&this.mainData.length){var r=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[e]):this.value[e];if(this.mode==="CheckBox"){var n=this.listData;this.listData=this.mainData,i=this.getTextByValue(r),this.listData=n}else i=this.getTextByValue(r)}else i=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[e]):this.value[e];return i},t.prototype.unWireEvent=function(){if(m(this.componentWrapper)||R.remove(this.componentWrapper,"mousedown",this.wrapperClick),R.remove(window,"resize",this.windowResize),!m(this.inputElement)){R.remove(this.inputElement,"focus",this.focusInHandler),R.remove(this.inputElement,"keydown",this.onKeyDown),this.mode!=="CheckBox"&&R.remove(this.inputElement,"input",this.onInput),R.remove(this.inputElement,"keyup",this.keyUp);var e=X(this.inputElement,"form");e&&R.remove(e,"reset",this.resetValueHandler),R.remove(this.inputElement,"blur",this.onBlurHandler)}m(this.componentWrapper)||(R.remove(this.componentWrapper,"mouseover",this.mouseIn),R.remove(this.componentWrapper,"mouseout",this.mouseOut)),m(this.overAllClear)||R.remove(this.overAllClear,"mousedown",this.clearAll),m(this.inputElement)||R.remove(this.inputElement,"paste",this.pasteHandler)},t.prototype.resizingWireEvent=function(){R.add(document,"mousemove",this.resizePopup,this),R.add(document,"mouseup",this.stopResizing,this),R.add(document,"touchmove",this.resizePopup,this),R.add(document,"touchend",this.stopResizing,this)},t.prototype.resizingUnWireEvent=function(){R.remove(document,"mousemove",this.resizePopup),R.remove(document,"mouseup",this.stopResizing),R.remove(document,"touchmove",this.resizePopup),R.remove(document,"touchend",this.stopResizing)},t.prototype.selectAllItem=function(e,i,r){var n;if(m(this.list)||(n=this.list.querySelectorAll(e?'li.e-list-item:not([aria-selected="true"]):not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)':'li.e-list-item[aria-selected="true"]:not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)')),this.value&&this.value.length&&i&&i.target&&X(i.target,".e-close-hooker")&&this.allowFiltering&&(n=this.mainList.querySelectorAll(e?'li.e-list-item:not([aria-selected="true"]):not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)':'li.e-list-item[aria-selected="true"]:not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)')),this.enableGroupCheckBox&&this.mode==="CheckBox"&&!m(this.fields.groupBy)){var a=i?this.groupTemplate?X(i.target,".e-list-group-item"):i.target:null;if(a=i&&i.keyCode===32?r:a,a=a&&a.classList.contains("e-frame")?a.parentElement.parentElement:a,a&&a.classList.contains("e-list-group-item")){var o=a.nextElementSibling;if(m(o))return;for(;o.classList.contains("e-list-item");){if(!(this.fields.disabled&&this.isDisabledElement(o)))if(e){if(!o.firstElementChild.lastElementChild.classList.contains("e-check")){var l=this.value&&this.value.length?this.value.length:0;o.classList.contains("e-active")&&(l-=1),l<this.maximumSelectionLength&&this.updateListSelection(o,i)}}else o.firstElementChild.lastElementChild.classList.contains("e-check")&&this.updateListSelection(o,i);if(o=o.nextElementSibling,o==null)break}if(a.classList.contains("e-list-group-item")){var h=this.list.getElementsByClassName("e-item-focus")[0];h&&h.classList.remove("e-item-focus"),e?a.classList.add("e-active"):a.classList.remove("e-active"),a.classList.add("e-item-focus"),this.updateAriaActiveDescendant()}this.textboxValueUpdate(),this.checkPlaceholderSize(),!this.changeOnBlur&&i&&this.updateValueState(i,this.value,this.tempValues)}else this.updateValue(i,n,e)}else this.updateValue(i,n,e);this.addValidInputClass()},t.prototype.virtualSelectionAll=function(e,i,r){var n=this,a=0,o=i.length,l=this.maximumSelectionLength;if(e){this.virtualSelectAll=!0,o=this.virtualSelectAllData&&this.virtualSelectAllData.length!==0?this.virtualSelectAllData.length:o,this.listData=this.virtualSelectAllData;var h=this.createListItems(this.virtualSelectAllData.slice(0,30),this.fields),u=h.querySelectorAll("li"),c=document.createDocumentFragment();u.forEach(function(g){c.appendChild(g.cloneNode(!0))}),i.forEach(function(g){c.appendChild(g.cloneNode(!0))});var f=c.childNodes;if(this.virtualSelectAllData instanceof Array){for(;a<o&&a<=50&&a<l;){if(this.isSelectAllTarget=o===a+1,f[a]){var d=this.allowObjectBinding?this.getDataByValue(f[a].getAttribute("data-value")):this.getFormattedValue(f[a].getAttribute("data-value"));if(!this.allowObjectBinding&&this.value&&this.value.indexOf(d)>=0||this.allowObjectBinding&&this.indexOfObjectInArray(d,this.value)>=0){a++;continue}this.updateListSelection(f[a],r,o-a)}else{var d=ie(this.fields.value?this.fields.value:"",this.virtualSelectAllData[a]);if(d=this.allowObjectBinding?this.getDataByValue(d):d,!this.allowObjectBinding&&this.value&&this.value.indexOf(d)>=0||this.allowObjectBinding&&this.indexOfObjectInArray(d,this.value)>=0){a++;continue}this.value&&d!=null&&Array.isArray(this.value)&&(!this.allowObjectBinding&&this.value.indexOf(d)<0||this.allowObjectBinding&&!this.isObjectInArray(d,this.value))&&this.dispatchSelect(d,r,null,!1,o)}a++}o>50&&setTimeout(function(){if(n.virtualSelectAllData&&n.virtualSelectAllData.length>0&&n.virtualSelectAllData.map(function(b){if(n.value&&b[n.fields.value]!=null&&Array.isArray(n.value)&&(!n.allowObjectBinding&&n.value.indexOf(b[n.fields.value])<0||n.allowObjectBinding&&!n.isObjectInArray(b[n.fields.value],n.value))){var C=b[n.fields.value],y=b[n.fields.text].toString();n.dispatchSelect(C,r,null,!1,o,b,y)}}),n.updatedataValueItems(r),n.isSelectAllLoop=!1,n.changeOnBlur||(n.updateValueState(r,n.value,n.tempValues),n.isSelectAll=n.isSelectAll?!n.isSelectAll:n.isSelectAll),n.updateHiddenElement(!0),n.popupWrapper&&i[a-1]&&i[a-1].classList.contains("e-item-focus")){var g=document.getElementsByClassName("e-selectall-parent")[0];g&&g.classList.contains("e-item-focus")&&i[a-1].classList.remove("e-item-focus")}n.checkSelectAll()},0)}}else this.virtualSelectAllData&&this.virtualSelectAllData.length>0&&this.virtualSelectAllData.map(function(g){n.virtualSelectAll=!0,n.removeValue(n.value[a],r,n.value.length-a)}),this.updatedataValueItems(r),this.changeOnBlur||(this.updateValueState(r,this.value,this.tempValues),this.isSelectAll=this.isSelectAll?!this.isSelectAll:this.isSelectAll),this.updateHiddenElement(),this.setProperties({value:[]},!0),this.virtualSelectAll=!1,!m(this.viewPortInfo.startIndex)&&!m(this.viewPortInfo.endIndex)&&this.notify("setCurrentViewDataAsync",{component:this.getModuleName(),module:"VirtualScroll"});this.checkSelectAll();var p=this.list.getElementsByClassName("e-virtual-ddl")[0];p&&(p.style=this.GetVirtualTrackHeight()),this.UpdateSkeleton();var v=this.list.getElementsByClassName("e-virtual-ddl-content")[0];v&&(v.style=this.getTransformValues())},t.prototype.updateValue=function(e,i,r){var n=this,a=i.length,o={event:e,items:r?i:[],itemData:r?this.listData:[],isInteracted:!!e,isChecked:r,preventSelectEvent:!1};if(this.trigger("beforeSelectAll",o),i&&i.length||this.enableVirtualization&&!r){var l=0,h=0;if(this.enableGroupCheckBox?h=r?this.maximumSelectionLength-(this.value?this.value.length:0):i.length:h=r?this.maximumSelectionLength-(this.value?this.value.length:0):this.maximumSelectionLength,o.preventSelectEvent){for(var u=0;u<i.length&&u<h;u++){this.removeHover();var c=i[u].getAttribute("data-value"),f=this.getFormattedValue(c);f=this.allowObjectBinding?this.getDataByValue(f):f;var d=this.mainList?this.mainList.querySelectorAll(r?'li.e-list-item:not([aria-selected="true"]):not(.e-reorder-hide)':'li.e-list-item[aria-selected="true"]:not(.e-reorder-hide)')[u]:null;r?(this.value=this.value?this.value:[],(!this.allowObjectBinding&&this.value.indexOf(f)<0||this.allowObjectBinding&&!this.isObjectInArray(f,this.value))&&this.setProperties({value:[].concat([],this.value,[f])},!0),this.removeFocus(),this.addListSelection(i[u],d),this.updateChipStatus(),this.checkMaxSelection()):this.removeAllItems(f,e,!1,i[u],d),this.enableGroupCheckBox&&this.findGroupStart(i[u])}if(!r){var p=this.value&&this.value.length?this.value.length:0;if(p<this.maximumSelectionLength){var v=this.list.querySelectorAll("li."+ne.li+":not(.e-active)");Z(v,"e-disable")}}var g={event:e,items:r?i:[],itemData:r?this.listData:[],isInteracted:!!e,isChecked:r};this.trigger("selectedAll",g)}else if(this.enableVirtualization)this.virtualSelectAllState=r,this.virtualSelectAll=!0,this.CurrentEvent=e,this.virtualSelectAllData||this.resetList(this.dataSource,this.fields,new We),this.virtualSelectAllData&&this.virtualSelectionAll(r,i,e);else{for(;l<a&&l<=50&&l<h;)this.isSelectAllTarget=a===l+1,this.updateListSelection(i[l],e,a-l),this.enableGroupCheckBox&&this.findGroupStart(i[l]),l++;a>50&&setTimeout(function(){for(;l<a&&l<h;)n.isSelectAllTarget=a===l+1,n.updateListSelection(i[l],e,a-l),n.enableGroupCheckBox&&n.findGroupStart(i[l]),l++;if(n.updatedataValueItems(e),n.changeOnBlur||(n.updateValueState(e,n.value,n.tempValues),n.isSelectAll=n.isSelectAll?!n.isSelectAll:n.isSelectAll),n.updateHiddenElement(),n.popupWrapper&&i[l-1].classList.contains("e-item-focus")){var b=document.getElementsByClassName("e-selectall-parent")[0];b&&b.classList.contains("e-item-focus")&&i[l-1].classList.remove("e-item-focus")}},0)}}this.updatedataValueItems(e),this.checkPlaceholderSize(),a<=50&&!o.preventSelectEvent&&(this.changeOnBlur||(this.updateValueState(e,this.value,this.tempValues),this.isSelectAll=this.isSelectAll?!this.isSelectAll:this.isSelectAll),(this.enableVirtualization&&this.value&&this.value.length>0||!this.enableVirtualization)&&this.updateHiddenElement())},t.prototype.updateHiddenElement=function(e){var i=this,r="",n="",a="",o=[];this.mode==="CheckBox"&&(this.value.map(function(l,h){r+='<option selected value ="'+l+'">'+h+"</option>",e||(i.listData?a=i.getTextByValue(l):a=l,n+=a+i.delimiterChar+" ",o.push(a))}),this.hiddenElement.innerHTML=r,e||(this.updateWrapperText(this.delimiterWrapper,n),this.setProperties({text:o.toString()},!0)),this.delimiterWrapper.setAttribute("id",fi("delim_val")),this.inputElement.setAttribute("aria-describedby",this.delimiterWrapper.id),this.refreshInputHight(),this.refreshPlaceHolder())},t.prototype.updatedataValueItems=function(e){this.deselectHeader(),this.textboxValueUpdate(e)},t.prototype.textboxValueUpdate=function(e){var i=e&&e.target&&(X(e.target,".e-selectall-parent")||X(e.target,".e-close-hooker"));this.mode!=="Box"&&!this.isPopupOpen()&&!(this.mode==="CheckBox"&&(this.isSelectAll||i))?this.updateDelimView():this.searchWrapper.classList.remove(Ou),this.mode==="CheckBox"?(this.updateDelimView(),(!(i||this.isSelectAll)&&this.isSelectAllTarget||this.isSelectAll&&this.isSelectAllTarget)&&this.updateDelimeter(this.delimiterChar,e),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar,e),this.refreshPlaceHolder()},t.prototype.setZIndex=function(){this.popupObj&&this.popupObj.setProperties({zIndex:this.zIndex})},t.prototype.updateDataSource=function(e){this.checkAndResetCache(),m(this.list)?this.renderPopup():this.resetList(this.dataSource),this.value&&this.value.length&&(this.setProperties({value:this.value}),this.refreshSelection())},t.prototype.onLoadSelect=function(){this.setDynValue=!0,this.renderPopup()},t.prototype.selectAllItems=function(e,i){var r=this;if(m(this.list))this.selectAllAction=function(){if(r.mode==="CheckBox"&&r.showSelectAll){var a={module:"CheckBoxSelection",enable:r.mode==="CheckBox",value:e?"check":"uncheck"};r.notify("checkSelectAll",a)}r.selectAllItem(e,i),r.selectAllAction=null},s.prototype.render.call(this);else{if(this.selectAllAction=null,this.mode==="CheckBox"&&this.showSelectAll){var n={value:e?"check":"uncheck",enable:this.mode==="CheckBox",module:"CheckBoxSelection"};this.notify("checkSelectAll",n)}this.selectAllItem(e,i)}(!(this.dataSource instanceof fe)||this.dataSource instanceof fe&&this.virtualSelectAllData)&&(this.virtualSelectAll=!1)},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.onPropertyChanged=function(e,i){(e.dataSource&&!m(Object.keys(e.dataSource))||e.query&&!m(Object.keys(e.query)))&&(this.mainList=null,this.mainData=null,this.isFirstClick=!1,this.isDynamicDataChange=!0),this.getModuleName()==="multiselect"&&(this.filterAction=!1,this.setUpdateInitial(["fields","query","dataSource"],e));for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];switch(a){case"query":case"dataSource":this.mode==="CheckBox"&&this.showSelectAll&&(m(this.popupObj)||(this.popupObj.destroy(),this.popupObj=null),this.renderPopup());break;case"htmlAttributes":this.updateHTMLAttribute();break;case"showClearButton":this.updateClearButton(e.showClearButton);break;case"text":this.fields.disabled&&(this.text=this.text&&!this.isDisabledItemByIndex(this.getIndexByValue(this.getValueByText(this.text)))?this.text:null),this.updateVal(this.value,this.value,"text");break;case"value":if(this.fields.disabled&&this.removeDisabledItemsValue(this.value),this.updateVal(this.value,i.value,"value"),this.addValidInputClass(),!this.closePopupOnSelect&&this.isPopupOpen()&&this.refreshPopup(),this.isPopupOpen()&&this.mode==="CheckBox"&&this.list&&this.list.querySelector(".e-active.e-disable")){var o=this.list.querySelectorAll("li."+ne.li+".e-active.e-disable");Z(o,"e-disable")}this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange;break;case"width":this.setWidth(e.width),this.popupObj.setProperties({width:this.calcPopupWidth()});break;case"placeholder":this.refreshPlaceHolder();break;case"filterBarPlaceholder":this.allowFiltering&&this.notify("filterBarPlaceholder",{filterBarPlaceholder:e.filterBarPlaceholder});break;case"delimiterChar":this.mode!=="Box"&&this.updateDelimView(),this.updateData(e.delimiterChar);break;case"cssClass":this.updateOldPropCssClass(i.cssClass),this.updateCssClass(),this.calculateWidth();break;case"enableRtl":this.enableRTL(e.enableRtl),s.prototype.onPropertyChanged.call(this,e,i);break;case"allowResize":if(this.allowResize=e.allowResize,!this.allowResize&&this.popupObj){var l=parseInt(this.popupHeight,10);this.popupHeight!=="auto"?(this.list.style.maxHeight=st(l),this.popupWrapper.style.height=st(this.popupHeight),this.popupWrapper.style.maxHeight=st(this.popupHeight)):this.list.style.maxHeight=st(this.popupHeight)}break;case"readonly":this.updateReadonly(e.readonly),this.hidePopup();break;case"enabled":this.hidePopup(),this.enable(e.enabled);break;case"showSelectAll":this.popupObj&&(this.popupObj.destroy(),this.popupObj=null),this.renderPopup();break;case"showDropDownIcon":this.dropDownIcon();break;case"floatLabelType":this.setFloatLabelType(),this.addValidInputClass(),Te.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),!m(this.overAllWrapper)&&!m(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon");break;case"enableSelectionOrder":break;case"selectAllText":this.notify("selectAllText",!1);break;case"popupHeight":if(this.popupObj){var l=parseInt(this.popupHeight,10);this.popupHeight!=="auto"?(this.list.style.maxHeight=st(l),this.popupWrapper.style.maxHeight=st(this.popupHeight)):this.list.style.maxHeight=st(this.popupHeight)}break;case"headerTemplate":case"footerTemplate":this.reInitializePoup();break;case"allowFiltering":this.mode==="CheckBox"&&this.popupObj&&this.reInitializePoup(),this.updateSelectElementData(this.allowFiltering);break;case"fields":m(this.fields.groupBy)&&this.removeScrollEvent();break;default:{var h=this.getPropObject(a,e,i);s.prototype.onPropertyChanged.call(this,h.newProperty,h.oldProperty)}break}}},t.prototype.reInitializePoup=function(){this.popupObj&&(this.popupObj.destroy(),this.popupObj=null),this.renderPopup()},t.prototype.totalItemsCount=function(){var e;if(this.dataSource instanceof fe?this.remoteDataCount>=0?e=this.totalItemCount=this.dataCount=this.remoteDataCount:this.resetList(this.dataSource):e=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.mode==="CheckBox")this.totalItemCount=e!==0?e:this.totalItemCount;else if(this.hideSelectedItem){if(this.totalItemCount=e!==0&&this.value?e-this.value.length:this.totalItemCount,this.allowCustomValue&&this.virtualCustomSelectData&&this.virtualCustomSelectData.length>0)for(var i=0;i<this.virtualCustomSelectData.length;i++)for(var r=0;r<this.value.length;r++){var n=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[r]):this.value[r],a=ie(this.fields.value?this.fields.value:"",this.virtualCustomSelectData[i]);n===a&&(this.totalItemCount+=1)}}else this.totalItemCount=e!==0?e:this.totalItemCount,this.allowCustomValue&&this.virtualCustomSelectData&&this.virtualCustomSelectData.length>0&&(this.totalItemCount+=this.virtualCustomSelectData.length)},t.prototype.presentItemValue=function(e){for(var i=[],r=0;r<this.value.length;r++){var n=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[r]):this.value[r],a=this.findListElement(this.allowFiltering&&!m(this.mainList)?this.mainList:e,"li","data-value",n);if(!a){var o=this.allowObjectBinding?this.getDataByValue(this.value[r]):this.value[r];i.push(o)}}return i},t.prototype.addNonPresentItems=function(e,i,r,n){var a=this;this.dataSource.executeQuery(this.getForQuery(e)).then(function(o){o.result.length>0&&a.addItem(o.result,r.length),a.updateActionList(i,r,n)})},t.prototype.updateVal=function(e,i,r){if(!this.list)this.onLoadSelect();else if(this.dataSource instanceof fe&&(!this.listData||!(this.mainList&&this.mainData)))this.onLoadSelect();else{var n=[];if(!m(this.value)&&!this.allowCustomValue&&(n=this.presentItemValue(this.ulElement)),r==="value"&&n.length>0&&this.dataSource instanceof fe&&!m(this.value)&&this.listData!=null)this.mainData=null,this.setDynValue=!0,this.isaddNonPresentItems=!0,this.addNonPresentItems(n,this.ulElement,this.listData),this.isaddNonPresentItems=!1;else{if(r==="text"&&(this.initialTextUpdate(),e=this.value),(m(this.value)||this.value.length===0)&&(this.tempValues=i),this.allowCustomValue&&(this.mode==="Default"||this.mode==="Box")&&this.isReact&&this.inputFocus&&this.isPopupOpen()&&this.mainData!==this.listData){var a=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.onActionComplete(a,this.mainData)}this.enableVirtualization?this.enableVirtualization&&!(this.dataSource instanceof fe)?this.initialValueUpdate(this.dataSource,!0):this.isInitRemoteVirtualData||(this.isDynamicRemoteVirtualData=!0,this.initialValueUpdate(this.listData,!0),this.isDynamicRemoteVirtualData=!1,this.initialUpdate()):this.initialValueUpdate(),this.mode!=="Box"&&!this.inputFocus&&this.updateDelimView(),this.inputFocus||this.refreshInputHight(),this.refreshPlaceHolder(),this.mode!=="CheckBox"&&this.changeOnBlur&&this.updateValueState(null,e,i),this.checkPlaceholderSize()}}this.changeOnBlur||this.updateValueState(null,e,i)},t.prototype.addItem=function(e,i){s.prototype.addItem.call(this,e,i)},t.prototype.hidePopup=function(e){var i=this,r=100;if(this.isPopupOpen()){var n={name:"FadeOut",duration:100,delay:r};this.customFilterQuery=null;var a={popup:this.popupObj,cancel:!1,animation:n,event:e||null};this.trigger("close",a,function(o){if(!o.cancel){i.fields.groupBy&&i.mode!=="CheckBox"&&i.fixedHeaderElement&&(Zi(i.fixedHeaderElement),i.fixedHeaderElement=null),i.beforePopupOpen=!1,i.overAllWrapper.classList.remove(ry);var l=i.mode==="CheckBox"?i.targetElement():null;if(i.popupObj.hide(new vr(o.animation)),Pe(i.inputElement,{"aria-expanded":"false"}),i.inputElement.removeAttribute("aria-owns"),i.inputElement.removeAttribute("aria-activedescendant"),i.allowFiltering&&i.notify("inputFocus",{module:"CheckBoxSelection",enable:i.mode==="CheckBox",value:"clear"}),i.popupObj.hide(),Z([document.body,i.popupObj.element],"e-popup-full-page"),R.remove(i.list,"keydown",i.onKeyDown),i.mode==="CheckBox"&&i.showSelectAll&&R.remove(i.popupObj.element,"click",i.clickHandler),i.list&&i.list.parentElement&&i.allowResize){i.resizer&&i.list.parentElement.contains(i.resizer)&&i.list.parentElement.removeChild(i.resizer),i.list.parentElement.classList.contains("e-resize")&&i.list.parentElement.classList.remove("e-resize"),i.list.parentElement.style.boxSizing="",i.list.parentElement.style.paddingBottom="";var h=parseInt(i.popupHeight,10);i.list.style.maxHeight=st(h),i.list.parentElement.style.height=st(i.popupHeight),i.list.parentElement.style.maxHeight=st(i.popupHeight)}i.resizer&&(R.remove(i.resizer,"mousedown",i.startResizing),i.resizer.remove()),i.enableVirtualization&&i.mode==="CheckBox"&&i.value&&i.value.length>0&&i.enableSelectionOrder&&(i.viewPortInfo.startIndex=i.virtualItemStartIndex=0,i.viewPortInfo.endIndex=i.virtualItemEndIndex=i.viewPortInfo.startIndex>0?i.viewPortInfo.endIndex:i.itemCount,i.virtualListInfo=i.viewPortInfo,i.previousStartIndex=0,i.previousEndIndex=i.itemCount);var u=void 0;i.dataSource instanceof fe?i.remoteDataCount>=0?i.totalItemCount=i.dataCount=i.remoteDataCount:i.resetList(i.dataSource):u=i.dataSource&&i.dataSource.length?i.dataSource.length:0,i.enableVirtualization&&(i.allowFiltering||i.allowCustomValue)&&(i.targetElement()||l)&&i.totalItemCount!==u&&(i.checkAndResetCache(),i.updateInitialData()),i.virtualCustomData&&i.viewPortInfo&&i.viewPortInfo.startIndex===0&&i.viewPortInfo.endIndex===i.itemCount&&i.renderItems(i.mainData,i.fields),i.virtualCustomData=null,i.isVirtualTrackHeight=!1}})}},t.prototype.showPopup=function(e){var i=this;if(this.enabled){this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null;var r={cancel:!1};this.trigger("beforeOpen",r,function(n){if(!n.cancel){if(!i.ulElement){i.beforePopupOpen=!0,i.mode==="CheckBox"&&xe.isDevice&&i.allowFiltering&&i.isDeviceFullScreen&&i.notify("popupFullScreen",{module:"CheckBoxSelection",enable:i.mode==="CheckBox"}),s.prototype.render.call(i,e);return}i.mode==="CheckBox"&&xe.isDevice&&i.allowFiltering&&i.isDeviceFullScreen&&i.notify("popupFullScreen",{module:"CheckBoxSelection",enable:i.mode==="CheckBox"});var a=i.ulElement.querySelectorAll("li.e-list-item").length,o=i.ulElement.querySelectorAll("li."+ne.li+"."+Ot).length;if(a>0&&a===o&&o===i.mainData.length&&!(i.targetElement()!==""&&i.allowCustomValue)){i.beforePopupOpen=!1;return}if(i.onPopupShown(e),i.enableVirtualization&&i.listData&&i.listData.length&&(!m(i.value)&&(i.getModuleName()==="dropdownlist"||i.getModuleName()==="combobox")&&i.removeHover(),i.beforePopupOpen||(i.hideSelectedItem&&i.value&&Array.isArray(i.value)&&i.value.length>0&&i.totalItemsCount(),!i.preventSetCurrentData&&!m(i.viewPortInfo.startIndex)&&!m(i.viewPortInfo.endIndex)&&i.notify("setCurrentViewDataAsync",{component:i.getModuleName(),module:"VirtualScroll"}))),i.enableVirtualization&&!i.allowFiltering&&i.selectedValueInfo!=null&&i.selectedValueInfo.startIndex>0&&i.value!=null&&i.notify("dataProcessAsync",{module:"VirtualScroll",isOpen:!0}),i.enableVirtualization)i.updatevirtualizationList();else if(i.value&&i.value.length){var l=void 0;i.getItems();for(var h=0,u=i.value;h<u.length;h++){var c=u[h],f=i.allowObjectBinding?ie(i.fields.value?i.fields.value:"",c):c;l=i.getElementByValue(f),l&&i.addListSelection(l)}}i.allowResize&&i.setResize(),i.preventSetCurrentData=!0}})}},t.prototype.selectAll=function(e){this.isSelectAll=!0,this.selectAllItems(e)},t.prototype.getModuleName=function(){return"multiselect"},t.prototype.clear=function(){var e=this;this.selectAll(!1),this.value&&this.value.length?setTimeout(function(){e.setProperties({value:null},!0)},0):this.setProperties({value:null},!0)},t.prototype.render=function(){!m(this.value)&&this.value.length>0&&(this.value=this.value.slice()),this.setDynValue=this.initStatus=!1,this.isSelectAll=!1,this.selectAllEventEle=[],this.searchWrapper=this.createElement("span",{className:QH+" "+(this.mode==="Box"?o3:"")}),this.viewWrapper=this.createElement("span",{className:KH+" "+Qb}),this.viewWrapper.style.display="none",this.overAllClear=this.createElement("span",{className:Jb}),this.overAllClear.style.display="none",this.componentWrapper=this.createElement("div",{className:GH}),this.overAllWrapper=this.createElement("div",{className:qH}),this.mode==="CheckBox"&&P([this.overAllWrapper],"e-checkbox"),xe.isDevice&&this.componentWrapper.classList.add(XH),this.setWidth(this.width),this.overAllWrapper.appendChild(this.componentWrapper),this.popupWrapper=this.createElement("div",{id:this.element.id+"_popup",className:e3}),this.popupWrapper.setAttribute("aria-label",this.element.id),this.popupWrapper.setAttribute("role","dialog"),this.mode==="Delimiter"||this.mode==="CheckBox"?(this.delimiterWrapper=this.createElement("span",{className:Qb}),this.delimiterWrapper.style.display="none",this.componentWrapper.appendChild(this.delimiterWrapper)):(this.chipCollectionWrapper=this.createElement("span",{className:YH}),this.chipCollectionWrapper.style.display="none",this.mode==="Default"?this.chipCollectionWrapper.setAttribute("id",fi("chip_default")):this.mode==="Box"&&this.chipCollectionWrapper.setAttribute("id",fi("chip_box")),this.componentWrapper.appendChild(this.chipCollectionWrapper)),this.mode!=="Box"&&this.componentWrapper.appendChild(this.viewWrapper),this.componentWrapper.appendChild(this.searchWrapper),this.showClearButton&&!xe.isDevice?this.componentWrapper.appendChild(this.overAllClear):this.componentWrapper.classList.add(Cd),this.dropDownIcon(),this.inputElement=this.createElement("input",{className:t3,attrs:{spellcheck:"false",type:"text",autocomplete:"off",tabindex:"0",role:"combobox"}}),(this.mode==="Default"||this.mode==="Box")&&this.inputElement.setAttribute("aria-describedby",this.chipCollectionWrapper.id),m(this.inputElement)||(Pe(this.inputElement,{"aria-expanded":"false"}),this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName())),this.element.tagName!==this.getNgDirective()&&(this.element.style.display="none"),this.element.tagName===this.getNgDirective()?(this.element.appendChild(this.overAllWrapper),this.searchWrapper.appendChild(this.inputElement)):(this.element.parentElement.insertBefore(this.overAllWrapper,this.element),this.searchWrapper.appendChild(this.inputElement),this.searchWrapper.appendChild(this.element),this.element.removeAttribute("tabindex")),this.floatLabelType!=="Never"?Xb(this.overAllWrapper,this.searchWrapper,this.element,this.inputElement,this.value,this.floatLabelType,this.placeholder):this.floatLabelType==="Never"&&this.refreshPlaceHolder(),this.addValidInputClass(),this.element.style.opacity="";var e=this.element.getAttribute("id")?this.element.getAttribute("id"):fi("ej2_dropdownlist");this.element.id=e,this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true",class:n3,tabindex:"-1",multiple:""}}),this.componentWrapper.appendChild(this.hiddenElement),this.validationAttribute(this.element,this.hiddenElement),this.mode!=="CheckBox"&&this.hideOverAllClear(),!m(X(this.element,"fieldset"))&&X(this.element,"fieldset").disabled&&(this.enabled=!1),this.wireEvent(),this.enable(this.enabled),this.enableRTL(this.enableRtl),this.enableVirtualization&&this.updateVirtualizationProperties(this.itemCount,this.allowFiltering,this.mode==="CheckBox"),this.listItemHeight=this.getListHeight(),this.getSkeletonCount(),this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.viewPortInfo.startIndex>0?this.viewPortInfo.endIndex:this.itemCount,this.checkInitialValue(),this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),Te.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),!m(this.overAllWrapper)&&!m(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.renderComplete()},t.prototype.setResize=function(){var e=16;if(this.list&&this.list.parentElement&&m(this.list.parentElement.querySelector(".e-resizer-right.e-icons"))&&(this.resizer=this.createElement("div",{id:this.element.id+"_resize-popup",className:h3})),this.mode==="CheckBox"&&this.showSelectAll&&this.selectAllHeight&&this.selectAllHeight!==0&&(this.storedSelectAllHeight=this.selectAllHeight),this.list&&this.list.parentElement){this.list.parentElement.classList.add("e-resize"),this.popupHeight.toString().toLowerCase()!=="auto"&&(this.list.parentElement.style.height="100%"),this.list.parentElement.style.boxSizing="border-box";var i=this.mode==="CheckBox"&&this.searchBoxHeight?this.searchBoxHeight+e+(this.showSelectAll?this.storedSelectAllHeight:0):e;this.list.parentElement.style.paddingBottom=i+"px",this.list.parentElement.appendChild(this.resizer),this.list.parentElement.style.width=this.resizeWidth+"px",this.list.parentElement.style.height=this.resizeHeight+"px",this.list.parentElement.style.maxHeight=this.resizeHeight+"px",this.list.style.maxHeight=this.resizeHeight+"px"}this.resizer&&(R.add(this.resizer,"mousedown",this.startResizing,this),R.add(this.resizer,"touchstart",this.startResizing,this))},t.prototype.startResizing=function(e){this.isResizing=!0,this.trigger("resizeStart",e);var i=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,r=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;this.list&&this.list.parentElement&&(this.originalWidth=this.list.parentElement.offsetWidth,this.originalHeight=this.list.parentElement.offsetHeight,this.originalMouseX=i,this.originalMouseY=r),this.resizingWireEvent(),e&&e.preventDefault()},t.prototype.resizePopup=function(e){if(this.isResizing){this.trigger("resizing",e);var i=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,r=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,n=i-this.originalMouseX,a=r-this.originalMouseY,o=100,l=130;if(this.resizeWidth=Math.max(this.originalWidth+n,o),this.resizeHeight=Math.max(this.originalHeight+a,l),this.list&&this.list.parentElement){var h=parseInt(window.getComputedStyle(this.list.parentElement).minWidth,10),u=parseInt(window.getComputedStyle(this.list.parentElement).minHeight,10);h=h||100,u=u||120,this.resizeWidth=Math.max(this.originalWidth+n,h),this.resizeHeight=Math.max(this.originalHeight+a,u),this.list.parentElement.style.width=this.resizeWidth+"px",this.list.parentElement.style.height=this.resizeHeight+"px",this.list.parentElement.style.maxHeight=this.resizeHeight+"px",this.list.style.maxHeight=this.resizeHeight+"px",this.fixedHeaderElement&&this.ulElement&&(this.fixedHeaderElement.style.width=this.ulElement.offsetWidth+"px")}e&&e.preventDefault()}},t.prototype.stopResizing=function(e){this.isResizing&&(this.isResizing=!1,this.trigger("resizeStop",e),this.resizingUnWireEvent()),e&&e.preventDefault()},t.prototype.getListHeight=function(){var e=this.createElement("div",{className:"e-dropdownbase"}),i=this.createElement("li",{className:"e-list-item"}),r=st(this.popupHeight);e.style.height=parseInt(r,10).toString()+"px",e.appendChild(i),document.body.appendChild(e),this.virtualListHeight=e.getBoundingClientRect().height;var n=Math.ceil(i.getBoundingClientRect().height)+parseInt(window.getComputedStyle(i).marginBottom,10);return e.remove(),n},t.prototype.removeDisabledItemsValue=function(e){if(e){for(var i=[],r=0,n=0;n<e.length;n++){var a=e[n];typeof a=="object"&&(a=JSON.parse(JSON.stringify(a))[this.fields.value]),a!=null&&!this.isDisabledItemByIndex(this.getIndexByValue(a))&&(i[r++]=e[n])}this.value=i.length>0?i:null}},t.prototype.checkInitialValue=function(){var e=this;this.fields.disabled&&this.removeDisabledItemsValue(this.value);var i=this.dataSource instanceof Array?this.dataSource.length>0:!m(this.dataSource);if(!(this.value&&this.value.length)&&m(this.text)&&!i&&this.element.tagName==="SELECT"&&this.element.options.length>0){for(var r=this.element.options,n=[],a="",o=0,l=r.length;o<l;o++){var h=r[o];if(!m(h.getAttribute("selected")))if(h.getAttribute("value")){var u=this.allowObjectBinding?this.getDataByValue(h.getAttribute("value")):h.getAttribute("value");n.push(u)}else a+=h.text+this.delimiterChar}n.length>0?this.setProperties({value:n},!0):a!==""&&this.setProperties({text:a},!0),(n.length>0||a!=="")&&(this.refreshInputHight(),this.refreshPlaceHolder())}if((this.value&&this.value.length||!m(this.text))&&(this.list||s.prototype.render.call(this)),this.fields.disabled&&(this.text=this.text&&!this.isDisabledItemByIndex(this.getIndexByValue(this.getValueByText(this.text)))?this.text:null),!m(this.text)&&(m(this.value)||this.value.length===0)&&this.initialTextUpdate(),this.value&&this.value.length){var c;if(this.enableVirtualization){for(var f=this.isPrimitiveData?"":this.fields.value,d=void 0,p=0;p<this.value.length;p++){var u=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",this.value[p]):this.value[p];p===0?d=new ht(f,"equal",u):d=d.or(f,"equal",u)}this.dataSource instanceof fe?this.dataSource.executeQuery(new We().where(d)).then(function(v){v.result.length>0&&(c=v.result,e.initStatus=!1,e.isInitRemoteVirtualData=!0,setTimeout(function(){e.initialValueUpdate(c,!0),e.initialUpdate(),e.isInitRemoteVirtualData=!1},100),e.initStatus=!0)}):c=new fe(this.dataSource).executeLocal(new We().where(d))}this.dataSource instanceof fe?this.setInitialValue=function(){e.initStatus=!1,(!e.enableVirtualization||e.enableVirtualization&&!(e.dataSource instanceof fe))&&e.initialValueUpdate(c),e.initialUpdate(),e.setInitialValue=null,e.initStatus=!0}:(this.initialValueUpdate(c,!0),this.initialUpdate()),this.updateTempValue()}else this.initialUpdate();this.initStatus=!0,this.checkAutoFocus(),m(this.text)||this.element.setAttribute("data-initial-value",this.text)},t.prototype.checkAutoFocus=function(){this.element.hasAttribute("autofocus")&&this.inputElement.focus()},t.prototype.updatevirtualizationList=function(){if(this.value&&this.value.length){for(var e=void 0,i=0,r=this.value;i<r.length;i++){var n=r[i],a=this.allowObjectBinding?ie(this.fields.value?this.fields.value:"",n):n;e=this.getElementByValue(a),e&&this.addListSelection(e)}if(this.enableVirtualization&&this.hideSelectedItem){var o=this.list.querySelectorAll("li."+ne.li+":not(."+Ot+"):not(.e-reorder-hide):not(.e-virtual-list)");if(o.length){var l=this.virtualListHeight>0?Math.floor(this.virtualListHeight/this.listItemHeight):0;if(o.length<l+2){var h=this.getForQuery(this.value).clone();h=h.skip(this.viewPortInfo.startIndex),this.resetList(this.dataSource,this.fields,h)}}}}},t.prototype.setFloatLabelType=function(){zH(this.overAllWrapper,this.componentWrapper,this.searchWrapper,this.inputElement,this.value,this.floatLabelType,this.placeholder),this.floatLabelType!=="Never"&&Xb(this.overAllWrapper,this.searchWrapper,this.element,this.inputElement,this.value,this.floatLabelType,this.placeholder)},t.prototype.addValidInputClass=function(){m(this.overAllWrapper)||(!m(this.value)&&this.value.length||this.floatLabelType==="Always"?P([this.overAllWrapper],"e-valid-input"):Z([this.overAllWrapper],"e-valid-input"))},t.prototype.dropDownIcon=function(){this.showDropDownIcon?(this.dropIcon=this.createElement("span",{className:iy}),this.componentWrapper.appendChild(this.dropIcon),P([this.componentWrapper],["e-down-icon"])):m(this.dropIcon)||(this.dropIcon.parentElement.removeChild(this.dropIcon),Z([this.componentWrapper],["e-down-icon"]))},t.prototype.initialUpdate=function(){this.mode!=="Box"&&!(this.setDynValue&&this.mode==="Default"&&this.inputFocus)&&this.updateDelimView(),this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.itemCount,this.updateCssClass(),this.updateHTMLAttribute(),this.updateReadonly(this.readonly),this.refreshInputHight(),this.checkPlaceholderSize()},t.prototype.disableItem=function(e){if(this.fields.disabled){this.list||this.renderList();var i=-1;if(this.liCollections&&this.liCollections.length>0&&this.listData&&this.fields.disabled){if(typeof e=="string")i=this.getIndexByValue(e);else if(typeof e=="object"){if(e instanceof HTMLLIElement){for(var r=0;r<this.liCollections.length;r++)if(this.liCollections[r]===e){i=this.getIndexByValue(e.getAttribute("data-value"));break}}else for(var n=JSON.parse(JSON.stringify(e))[this.fields.value],r=0;r<this.listData.length;r++)if(JSON.parse(JSON.stringify(this.listData[r]))[this.fields.value]===n){i=this.getIndexByValue(n);break}}else i=e;var a=i<this.liCollections.length&&i>-1;if(a&&!JSON.parse(JSON.stringify(this.listData[i]))[this.fields.disabled]){var o=this.liCollections[i];if(o){this.disableListItem(o);var l=JSON.parse(JSON.stringify(this.listData[i]));if(l[this.fields.disabled]=!0,this.listData[i]=l,o.classList.contains(ne.focus)&&this.removeFocus(),o.classList.contains(Ot)||o.classList.contains(ne.selected)){var h=this.value;this.removeDisabledItemsValue(this.value),this.updateVal(this.value,h,"value")}this.mode==="CheckBox"&&this.enableGroupCheckBox&&!m(this.fields.groupBy)&&this.disableGroupHeader()}}}}},t.prototype.destroy=function(){this.isReact&&this.clearTemplate(),m(this.popupObj)||(this.popupObj.hide(),this.popupObj.destroy()),this.notify(a3,{}),this.unwireListEvents(),this.unWireEvent();var e=["readonly","aria-disabled","placeholder","aria-label","aria-expanded"],i=e.length;if(!m(this.inputElement))for(;i>0;)this.inputElement.removeAttribute(e[i-1]),i--;for(m(this.element)||(this.element.removeAttribute("data-initial-value"),this.element.style.display="block"),this.overAllWrapper&&this.overAllWrapper.parentElement&&(this.overAllWrapper.parentElement.tagName===this.getNgDirective()?Zi(this.overAllWrapper):(this.overAllWrapper.parentElement.insertBefore(this.element,this.overAllWrapper),Zi(this.overAllWrapper))),this.popupWrapper&&this.popupWrapper.parentElement&&this.popupWrapper.parentElement.remove();this.searchWrapper&&this.searchWrapper.firstChild;)this.searchWrapper.removeChild(this.searchWrapper.firstChild);this.searchWrapper&&this.searchWrapper.parentElement&&this.searchWrapper.parentElement.remove(),this.viewWrapper&&this.viewWrapper.parentElement&&this.viewWrapper.parentElement.remove(),this.overAllClear&&this.overAllClear.parentElement&&this.overAllClear.parentElement.remove(),this.delimiterWrapper&&this.delimiterWrapper.parentElement&&this.delimiterWrapper.parentElement.remove();var r=this.overAllWrapper.querySelector("select.e-multi-hidden");for(r&&r.parentElement&&r.parentElement.remove();this.componentWrapper&&this.componentWrapper.firstChild;)this.componentWrapper.removeChild(this.componentWrapper.firstChild);for(this.componentWrapper&&this.componentWrapper.parentElement&&(this.componentWrapper.removeAttribute("class"),this.componentWrapper.parentElement.remove());this.popupWrapper&&this.popupWrapper.firstChild;)this.popupWrapper.removeChild(this.popupWrapper.firstChild);if(this.inputElement)for(var n=["readonly","aria-disabled","placeholder","aria-labelledby","aria-expanded","autocomplete","aria-readonly","autocapitalize","spellcheck","aria-autocomplete","aria-live","aria-label","aria-hidden","tabindex","aria-controls","aria-describedby","size","role","type","class"],a=0;a<n.length;a++)this.inputElement.removeAttribute(n[a]);this.inputElement&&this.inputElement.remove(),this.list=null,this.popupObj=null,this.mainData=null,this.filterParent=null,this.ulElement=null,this.componentWrapper=null,this.overAllClear=null,this.overAllWrapper=null,this.hiddenElement=null,this.searchWrapper=null,this.viewWrapper=null,this.chipCollectionWrapper=null,this.targetInputElement=null,this.popupWrapper=null,this.inputElement=null,this.delimiterWrapper=null,this.liCollections=null,this.popupContentElement=null,this.header=null,this.mainList=null,this.mainListCollection=null,this.footer=null,this.selectAllEventEle=null,s.prototype.destroy.call(this)},Ke([Ur({text:null,value:null,iconCss:null,groupBy:null,disabled:null},Bw)],t.prototype,"fields",void 0),Ke([O(!1)],t.prototype,"enablePersistence",void 0),Ke([O(null)],t.prototype,"groupTemplate",void 0),Ke([O("No records found")],t.prototype,"noRecordsTemplate",void 0),Ke([O("Request failed")],t.prototype,"actionFailureTemplate",void 0),Ke([O("None")],t.prototype,"sortOrder",void 0),Ke([O(!0)],t.prototype,"enabled",void 0),Ke([O(!0)],t.prototype,"enableHtmlSanitizer",void 0),Ke([O(!1)],t.prototype,"enableVirtualization",void 0),Ke([O([])],t.prototype,"dataSource",void 0),Ke([O(null)],t.prototype,"query",void 0),Ke([O("StartsWith")],t.prototype,"filterType",void 0),Ke([O(1e3)],t.prototype,"zIndex",void 0),Ke([O(!1)],t.prototype,"ignoreAccent",void 0),Ke([O()],t.prototype,"locale",void 0),Ke([O(!1)],t.prototype,"enableGroupCheckBox",void 0),Ke([O(null)],t.prototype,"cssClass",void 0),Ke([O("100%")],t.prototype,"width",void 0),Ke([O("300px")],t.prototype,"popupHeight",void 0),Ke([O("100%")],t.prototype,"popupWidth",void 0),Ke([O(null)],t.prototype,"placeholder",void 0),Ke([O(null)],t.prototype,"filterBarPlaceholder",void 0),Ke([O({})],t.prototype,"htmlAttributes",void 0),Ke([O(null)],t.prototype,"valueTemplate",void 0),Ke([O(null)],t.prototype,"headerTemplate",void 0),Ke([O(null)],t.prototype,"footerTemplate",void 0),Ke([O(null)],t.prototype,"itemTemplate",void 0),Ke([O(null)],t.prototype,"allowFiltering",void 0),Ke([O(!0)],t.prototype,"isDeviceFullScreen",void 0),Ke([O(!0)],t.prototype,"changeOnBlur",void 0),Ke([O(!1)],t.prototype,"allowCustomValue",void 0),Ke([O(!0)],t.prototype,"showClearButton",void 0),Ke([O(1e3)],t.prototype,"maximumSelectionLength",void 0),Ke([O(!1)],t.prototype,"readonly",void 0),Ke([O(!1)],t.prototype,"allowResize",void 0),Ke([O(null)],t.prototype,"text",void 0),Ke([O(null)],t.prototype,"value",void 0),Ke([O(!1)],t.prototype,"allowObjectBinding",void 0),Ke([O(!0)],t.prototype,"hideSelectedItem",void 0),Ke([O(!0)],t.prototype,"closePopupOnSelect",void 0),Ke([O("Default")],t.prototype,"mode",void 0),Ke([O(",")],t.prototype,"delimiterChar",void 0),Ke([O(!0)],t.prototype,"ignoreCase",void 0),Ke([O(!1)],t.prototype,"showDropDownIcon",void 0),Ke([O("Never")],t.prototype,"floatLabelType",void 0),Ke([O(!1)],t.prototype,"showSelectAll",void 0),Ke([O("Select All")],t.prototype,"selectAllText",void 0),Ke([O("Unselect All")],t.prototype,"unSelectAllText",void 0),Ke([O(!0)],t.prototype,"enableSelectionOrder",void 0),Ke([O(!0)],t.prototype,"openOnClick",void 0),Ke([O(!1)],t.prototype,"addTagOnBlur",void 0),Ke([Se()],t.prototype,"change",void 0),Ke([Se()],t.prototype,"removing",void 0),Ke([Se()],t.prototype,"removed",void 0),Ke([Se()],t.prototype,"beforeSelectAll",void 0),Ke([Se()],t.prototype,"selectedAll",void 0),Ke([Se()],t.prototype,"beforeOpen",void 0),Ke([Se()],t.prototype,"open",void 0),Ke([Se()],t.prototype,"close",void 0),Ke([Se()],t.prototype,"blur",void 0),Ke([Se()],t.prototype,"focus",void 0),Ke([Se()],t.prototype,"chipSelection",void 0),Ke([Se()],t.prototype,"resizeStop",void 0),Ke([Se()],t.prototype,"resizing",void 0),Ke([Se()],t.prototype,"resizeStart",void 0),Ke([Se()],t.prototype,"filtering",void 0),Ke([Se()],t.prototype,"tagging",void 0),Ke([Se()],t.prototype,"customValueSelection",void 0),t=Ke([Wi],t),t}(Hw),u3="e-icons",Lu="e-frame",Jn="e-check",ny="e-checkbox-wrapper",pl="e-stop",c3="e-selectall-parent",f3="e-input-group-icon e-back-icon e-icons",ay="e-input-group-icon e-clear-icon e-icons",d3="e-input-filter",p3="e-filter-parent",m3="e-ddl-device-filter",Sd="e-clear-icon",oy="e-popup-full-page",v3="e-ddl-device",ly="e-input-focus",g3=function(){function s(t){this.activeLi=[],this.activeEle=[],this.parent=t,this.removeEventListener(),this.addEventListener()}return s.prototype.getModuleName=function(){return"CheckBoxSelection"},s.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("updatelist",this.listSelection,this),this.parent.on("listoption",this.listOption,this),this.parent.on("selectAll",this.setSelectAll,this),this.parent.on("checkSelectAll",this.checkSelectAll,this),this.parent.on("searchBox",this.setSearchBox,this),this.parent.on("blur",this.onBlurHandler,this),this.parent.on("targetElement",this.targetElement,this),this.parent.on("deviceSearchBox",this.setDeviceSearchBox,this),this.parent.on("inputFocus",this.getFocus,this),this.parent.on("reOrder",this.setReorder,this),this.parent.on("activeList",this.getActiveList,this),this.parent.on("selectAllText",this.setLocale,this),this.parent.on("filterBarPlaceholder",this.setPlaceholder,this),R.add(document,"mousedown",this.onDocumentClick,this),this.parent.on("addItem",this.checboxCreate,this),this.parent.on("popupFullScreen",this.setPopupFullScreen,this))},s.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updatelist",this.listSelection),this.parent.off("listoption",this.listOption),this.parent.off("selectAll",this.setSelectAll),this.parent.off("checkSelectAll",this.checkSelectAll),this.parent.off("searchBox",this.setSearchBox),this.parent.off("blur",this.onBlurHandler),this.parent.off("targetElement",this.targetElement),this.parent.off("deviceSearchBox",this.setDeviceSearchBox),this.parent.off("inputFocus",this.getFocus),this.parent.off("reOrder",this.setReorder),this.parent.off("activeList",this.getActiveList),this.parent.off("selectAllText",this.setLocale),this.parent.off("filterBarPlaceholder",this.setPlaceholder),this.parent.off("addItem",this.checboxCreate),this.parent.off("popupFullScreen",this.setPopupFullScreen))},s.prototype.listOption=function(t){var e=this;if(m(this.parent.listCurrentOptions.itemCreated))this.parent.listCurrentOptions.itemCreated=function(r){e.checboxCreate(r)};else{var i=this.parent.listCurrentOptions.itemCreated;this.parent.listCurrentOptions.itemCreated=function(r){e.checboxCreate(r),i.apply(e,[r])}}},s.prototype.setPlaceholder=function(t){Te.setPlaceholder(t.filterBarPlaceholder,this.filterInput)},s.prototype.checboxCreate=function(t){var e;if(m(t.item)?e=t:e=t.item,this.parent.enableGroupCheckBox||e.className!=="e-list-group-item "&&e.className!=="e-list-group-item"){var i=ov(this.parent.createElement),r=ye("div."+u3,e);return e.insertBefore(i,e.childNodes[m(r)?0:1]),ye("."+Lu,i),this.parent.enableGroupCheckBox&&this.parent.popupWrapper.classList.add("e-multiselect-group"),e}else return e},s.prototype.setSelectAll=function(){this.parent.showSelectAll?(m(this.checkAllParent)&&(this.checkAllParent=this.parent.createElement("div",{className:c3}),this.selectAllSpan=this.parent.createElement("span",{className:"e-all-text"}),this.selectAllSpan.textContent="",this.checkAllParent.appendChild(this.selectAllSpan),this.setLocale(),this.checboxCreate(this.checkAllParent),this.parent.headerTemplate&&(m(this.parent.filterParent)?at([this.checkAllParent],this.parent.popupWrapper):at([this.checkAllParent],this.parent.filterParent)),this.parent.headerTemplate||(m(this.parent.filterParent)?Ii([this.checkAllParent],this.parent.popupWrapper):this.parent.filterParent.parentNode.insertBefore(this.checkAllParent,this.parent.filterParent.nextSibling)),R.add(this.checkAllParent,"mousedown",this.clickHandler,this)),this.parent.list.classList.contains("e-nodata")||this.parent.listData&&this.parent.listData.length<=1&&!this.parent.enableVirtualization&&!this.parent.isDynamicDataChange||this.parent.isDynamicDataChange&&this.parent.listData&&this.parent.listData.length<=1?this.checkAllParent.style.display="none":this.checkAllParent.style.display="block",this.parent.selectAllHeight=this.checkAllParent.getBoundingClientRect().height):m(this.checkAllParent)||(this.checkAllParent.parentElement.removeChild(this.checkAllParent),this.checkAllParent=null)},s.prototype.destroy=function(){this.removeEventListener(),R.remove(document,"mousedown",this.onDocumentClick),this.checkAllParent=null,this.clearIconElement=null,this.filterInput=null,this.filterInputObj=null,this.checkWrapper=null,this.selectAllSpan=null},s.prototype.listSelection=function(t){var e;if(!m(t.e))t.li.querySelector(".e-checkbox-wrapper .e-frame"),e=m(t.e.target)?t.li.querySelector(".e-checkbox-wrapper").childNodes[1]:t.e.target.classList.contains("e-frame")&&(!this.parent.showSelectAll||this.checkAllParent&&!this.checkAllParent.contains(t.e.target))?t.e.target:t.li.querySelector(".e-checkbox-wrapper").childNodes[1];else{var i=t.li.querySelector(".e-checkbox-wrapper");e=i?i.childNodes[1]:t.li.lastElementChild.childNodes[1]}if((this.parent.itemTemplate||this.parent.enableGroupCheckBox)&&(e=t.li.firstElementChild.childNodes[1]),m(e)||(this.checkWrapper=X(e,"."+ny)),!m(this.checkWrapper)){var r=ye("."+Lu,this.checkWrapper),n=!1;this.validateCheckNode(this.checkWrapper,r.classList.contains(Jn),t.li,t.e,n)}},s.prototype.validateCheckNode=function(t,e,i,r,n){this.changeState(t,e?"uncheck":"check",r,!0,n)},s.prototype.clickHandler=function(t){var e;t.currentTarget.classList.contains(this.checkAllParent.className)||t.currentTarget.classList.value===this.checkAllParent.className?e=t.currentTarget.firstElementChild.lastElementChild:e=t.currentTarget,this.checkWrapper=X(e,"."+ny);var i=!0;if(!m(this.checkWrapper)){var r=ye("."+Lu,this.checkWrapper);this.validateCheckNode(this.checkWrapper,r.classList.contains(Jn),null,t,i)}t.preventDefault()},s.prototype.changeState=function(t,e,i,r,n){var a=t.getElementsByClassName(Lu)[0];e==="check"&&!a.classList.contains(Jn)?(a.classList.remove(pl),a.classList.add(Jn),n&&(this.parent.selectAllItems(!0,i),this.setLocale(!0))):e==="uncheck"&&(a.classList.contains(Jn)||a.classList.contains(pl))?(Z([a],[Jn,pl]),n&&(this.parent.selectAllItems(!1,i),this.setLocale())):e==="indeterminate"&&!a.classList.contains(pl)&&(Z([a],[Jn]),a.classList.add(pl),n&&(this.parent.selectAllItems(!1,i),this.setLocale()))},s.prototype.setSearchBox=function(t){if(m(this.parent.filterParent)){this.parent.filterParent=this.parent.createElement("span",{className:p3}),this.filterInput=this.parent.createElement("input",{attrs:{type:"text"},className:d3}),this.parent.element.parentNode.insertBefore(this.filterInput,this.parent.element);var e=!1;return xe.isDevice&&this.parent.isDeviceFullScreen&&(e=!0,this.parent.mobFilter=!1),this.filterInputObj=Te.createInput({element:this.filterInput,buttons:e?[f3,ay]:[ay],properties:{placeholder:this.parent.filterBarPlaceholder}},this.parent.createElement),m(this.parent.cssClass)||(this.parent.cssClass.split(" ").indexOf("e-outline")!==-1?P([this.filterInputObj.container],"e-outline"):this.parent.cssClass.split(" ").indexOf("e-filled")!==-1&&P([this.filterInputObj.container],"e-filled")),at([this.filterInputObj.container],this.parent.filterParent),Ii([this.parent.filterParent],t.popupElement),Pe(this.filterInput,{"aria-disabled":"false",role:"combobox",autocomplete:"off",autocapitalize:"off",spellcheck:"false","aria-label":"multiselect","aria-expanded":"true","aria-controls":t.popupElement.id}),this.clearIconElement=this.filterInput.parentElement.querySelector("."+Sd),!xe.isDevice&&this.clearIconElement&&(R.add(this.clearIconElement,"mousedown",this.clearText,this),this.clearIconElement.style.visibility="hidden"),R.add(this.filterInput,"input",this.parent.onInput,this.parent),R.add(this.filterInput,"keyup",this.parent.keyUp,this.parent),R.add(this.filterInput,"keydown",this.parent.onKeyDown,this.parent),R.add(this.filterInput,"blur",this.onBlurHandler,this),R.add(this.filterInput,"paste",this.parent.pasteHandler,this.parent),this.parent.searchBoxHeight=this.filterInputObj.container.parentElement.getBoundingClientRect().height,this.filterInputObj}},s.prototype.clickOnBackIcon=function(t){this.parent.hidePopup(),Z([document.body,this.parent.popupObj.element],oy),this.parent.inputElement.focus()},s.prototype.clearText=function(t){this.parent.targetInputElement.value="",this.parent.allowFiltering&&this.parent.targetInputElement.value===""&&this.parent.search(null),this.parent.refreshListItems(null),this.parent.refreshPopup(),this.clearIconElement.style.visibility="hidden",this.filterInput.focus(),(!this.parent.enableVirtualization||this.parent.enableVirtualization&&(m(this.parent.value)||this.parent.value&&this.parent.value.length===0))&&this.setReorder(t),this.boundPreventListSelection=this.preventListSelection.bind(this),this.parent.popupWrapper.addEventListener("mouseup",this.boundPreventListSelection,!0),t.preventDefault()},s.prototype.preventListSelection=function(t){t.stopPropagation(),this.parent.popupWrapper.removeEventListener("mouseup",this.boundPreventListSelection,!0),this.boundPreventListSelection=null},s.prototype.setDeviceSearchBox=function(){this.parent.popupObj.element.classList.add(v3),this.parent.popupObj.element.classList.add(m3),this.parent.popupObj.position={X:0,Y:0},this.parent.popupObj.dataBind(),this.setSearchBoxPosition(),this.backIconElement=this.filterInputObj.container.querySelector(".e-back-icon"),this.clearIconElement=this.filterInputObj.container.querySelector("."+Sd),this.clearIconElement.style.visibility="hidden",R.add(this.backIconElement,"click",this.clickOnBackIcon,this),R.add(this.clearIconElement,"click",this.clearText,this)},s.prototype.setSearchBoxPosition=function(){var t=this.filterInput.parentElement.getBoundingClientRect().height,e=0,i=0,r=0;this.checkAllParent&&(e=this.checkAllParent.getBoundingClientRect().height),this.parent.header&&(r=this.parent.header.getBoundingClientRect().height),this.parent.footer&&(i=this.parent.footer.getBoundingClientRect().height),this.parent.popupObj.element.style.maxHeight="100%",this.parent.popupObj.element.style.width="100%",this.parent.list.style.maxHeight=window.innerHeight-t-e-r-i+"px",this.parent.list.style.height=window.innerHeight-t-e-r-i+"px";var n=this.filterInput.parentElement.querySelector("."+Sd);Oe(this.filterInput),n.parentElement.insertBefore(this.filterInput,n)},s.prototype.setPopupFullScreen=function(){this.parent&&this.parent.popupObj&&(Pe(this.parent.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),P([document.body,this.parent.popupObj.element],oy),this.parent.popupObj.element.style.maxHeight="100%",this.parent.popupObj.element.style.width="100%")},s.prototype.targetElement=function(){return m(this.clearIconElement)||(this.parent.targetInputElement=this.filterInput,this.clearIconElement.style.visibility=this.parent.targetInputElement.value===""?"hidden":"visible"),this.parent.targetInputElement.value},s.prototype.onBlurHandler=function(t){if(!this.parent.element.classList.contains("e-listbox")){var e=void 0;if(this.parent.keyAction)return;if(xe.isIE&&(e=!m(t)&&t.target),xe.isIE||(e=!m(t)&&t.relatedTarget),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&this.parent.popupObj.element.contains(e)&&!xe.isIE&&this.filterInput){this.filterInput.focus();return}if(this.parent.scrollFocusStatus&&this.filterInput){t.preventDefault(),this.filterInput.focus(),this.parent.scrollFocusStatus=!1;return}this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&(this.parent.inputFocus=!1,this.parent.updateValueState(t,this.parent.value,this.parent.tempValues),this.parent.dispatchEvent(this.parent.hiddenElement,"change")),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&(this.parent.inputFocus=!1,this.parent.overAllWrapper.classList.remove(ly),this.parent.trigger("blur"),this.parent.focused=!0),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&!xe.isDevice&&this.parent.hidePopup()}},s.prototype.onDocumentClick=function(t){if(this.parent.getLocaleName()!=="listbox"){var e=t.target;!m(this.parent.popupObj)&&X(e,'[id="'+this.parent.popupObj.element.id+'"]')&&(this.filterInput&&this.filterInput.value!==""||t.preventDefault()),!(!m(this.parent.popupObj)&&X(e,'[id="'+this.parent.popupObj.element.id+'"]'))&&!m(this.parent.overAllWrapper)&&!this.parent.overAllWrapper.contains(t.target)?(this.parent.overAllWrapper.classList.contains(ne.focus)||this.parent.isPopupOpen())&&(this.parent.inputFocus=!1,this.parent.scrollFocusStatus=!1,this.parent.hidePopup(),this.parent.onBlurHandler(t,!0),this.parent.focused=!0):this.parent.scrollFocusStatus=(xe.isIE||xe.info.name==="edge")&&document.activeElement===this.filterInput,!m(this.parent.overAllWrapper)&&!this.parent.overAllWrapper.contains(t.target)&&this.parent.overAllWrapper.classList.contains("e-input-focus")&&!this.parent.isPopupOpen()&&(xe.isIE?this.parent.onBlurHandler():this.parent.onBlurHandler(t)),this.filterInput===e&&this.filterInput.focus()}},s.prototype.getFocus=function(t){if(this.parent.overAllWrapper.classList.remove(ly),this.parent.keyAction&&t.value!=="clear"&&t.value!=="focus"){this.parent.keyAction=!1;return}t.value==="focus"&&(this.filterInput.focus(),this.parent.removeFocus(),R.remove(this.parent.list,"keydown",this.parent.onKeyDown)),t.value==="clear"&&(this.filterInput.value="",this.clearIconElement.style.visibility="hidden")},s.prototype.checkSelectAll=function(t){t.value==="check"&&(this.changeState(this.checkAllParent,t.value,null,null,!1),this.setLocale(!0)),t.value==="uncheck"&&(this.changeState(this.checkAllParent,t.value,null,null,!1),this.setLocale()),t.value==="indeterminate"&&(this.changeState(this.checkAllParent,t.value,null,null,!1),this.setLocale())},s.prototype.setLocale=function(t){if(this.parent.selectAllText!=="Select All"||this.parent.unSelectAllText!=="Unselect All"){var e=t?this.parent.unSelectAllText:this.parent.selectAllText;this.selectAllSpan.textContent="";for(var i=wt(e),r=t?"unSelectAllText":"selectAllText",n=0,a=i({},this.parent,r,null,!this.parent.isStringTemplate);n<a.length;n++){var o=a[n];this.selectAllSpan.textContent=o.textContent}}else{var l={selectAllText:"Select All",unSelectAllText:"Unselect All"},h=new br(this.parent.getLocaleName(),{},this.parent.locale);h.getConstant("selectAllText")===""&&(h=new br("dropdowns",l,this.parent.locale)),m(this.selectAllSpan)||(this.selectAllSpan.textContent=t?h.getConstant("unSelectAllText"):h.getConstant("selectAllText"))}},s.prototype.getActiveList=function(t){t.li.classList.contains("e-active")?this.activeLi.push(t.li.cloneNode(!0)):this.activeLi.splice(t.index,1)},s.prototype.setReorder=function(t){if(this.parent.enableSelectionOrder&&!m(this.parent.value)){var e=this.parent.ulElement.querySelectorAll("li.e-active").length,i=void 0,r=this.parent.createElement("ul",{className:"e-list-parent e-ul e-reorder"});if(e>0){var n=this.parent.ulElement.querySelectorAll("li.e-active");if(n.forEach(function(o){r.appendChild(o)}),i=this.parent.ulElement.querySelectorAll("li.e-active"),P(i,"e-reorder-hide"),this.parent.enableVirtualization){var a=this.parent.list.querySelector(".e-virtual-ddl-content");Ii([r],a)}else Ii([r],this.parent.list)}this.parent.focusAtFirstListItem()}},s}(),zw=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Jt=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},is="e-other-month",kd="e-other-year",ml="e-calendar",hy="e-device",b3="e-header",uy="e-rtl",y3="e-content",x3="e-calendar-content-table",Td="e-year",Ad="e-month",cy="e-decade",fy="e-icons",C3="e-prev",w3="e-next",E3="e-date-icon-prev",S3="e-date-icon-next ",k3="e-icon-container",zt="e-disabled",cn="e-overlay",T3="e-weekend",vl="e-week-number",Mi="e-selected",Er="e-focused-date",Qn="e-focused-cell",Ru="e-month-hide",dy="e-today",A3="e-title",py="e-day",my="e-cell",O3="e-week-header",Iu="e-zoomin",D3="e-footer-container",L3="e-btn",R3="e-flat",I3="e-css",_3="e-primary",vy="e-calendar-day-header-lg",Od=864e5,F3=6e4,N3=function(s){zw(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.effect="",r.isPopupClicked=!1,r.isDateSelected=!0,r.isTodayClicked=!1,r.preventChange=!1,r.previousDates=!1,r}return t.prototype.render=function(){this.rangeValidation(this.min,this.max),this.calendarEleCopy=this.element.cloneNode(!0),this.calendarMode==="Islamic"&&(+this.min.setSeconds(0)==+new Date(1900,0,1,0,0,0)&&(this.min=new Date(1944,2,18)),+this.max==+new Date(2099,11,31)&&(this.max=new Date(2069,10,16))),this.globalize=new Ji(this.locale),(m(this.firstDayOfWeek)||this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:this.globalize.getFirstDayOfWeek()},!0),this.todayDisabled=!1,this.todayDate=new Date(new Date().setHours(0,0,0,0)),this.getModuleName()==="calendar"?(this.element.classList.add(ml),this.enableRtl&&this.element.classList.add(uy),xe.isDevice&&this.element.classList.add(hy),Pe(this.element,{"data-role":"calendar"}),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.setAttribute("tabindex",this.tabIndex)):(this.calendarElement=this.createElement("div"),this.calendarElement.classList.add(ml),this.enableRtl&&this.calendarElement.classList.add(uy),xe.isDevice&&this.calendarElement.classList.add(hy),Pe(this.calendarElement,{"data-role":"calendar"})),!m(X(this.element,"fieldset"))&&X(this.element,"fieldset").disabled&&(this.enabled=!1),this.createHeader(),this.createContent(),this.wireEvents()},t.prototype.rangeValidation=function(e,i){m(e)&&this.setProperties({min:new Date(1900,0,1)},!0),m(i)&&this.setProperties({max:new Date(2099,11,31)},!0)},t.prototype.getDefaultKeyConfig=function(){return this.defaultKeyConfigs={controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",altUpArrow:"alt+uparrow",spacebar:"space",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"},this.defaultKeyConfigs},t.prototype.validateDate=function(e){this.setProperties({min:this.checkDateValue(new Date(this.checkValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkValue(this.max)))},!0),this.currentDate=this.currentDate?this.currentDate:new Date(new Date().setHours(0,0,0,0)),!m(e)&&this.min<=this.max&&e>=this.min&&e<=this.max&&(this.currentDate=new Date(this.checkValue(e)))},t.prototype.setOverlayIndex=function(e,i,r,n){if(n&&!m(i)&&!m(r)&&!m(e)){var a=parseInt(i.style.zIndex,10)?parseInt(i.style.zIndex,10):1e3;r.style.zIndex=(a-1).toString(),e.style.zIndex=a.toString()}},t.prototype.minMaxUpdate=function(e){+this.min<=+this.max?Z([this.element],cn):(this.setProperties({min:this.min},!0),P([this.element],cn)),this.min=m(this.min)||!+this.min?this.min=new Date(1900,0,1):this.min,this.max=m(this.max)||!+this.max?this.max=new Date(2099,11,31):this.max,+this.min<=+this.max&&e&&+e<=+this.max&&+e>=+this.min?this.currentDate=new Date(this.checkValue(e)):+this.min<=+this.max&&!e&&+this.currentDate>+this.max?this.currentDate=new Date(this.checkValue(this.max)):+this.currentDate<+this.min&&(this.currentDate=new Date(this.checkValue(this.min)))},t.prototype.createHeader=function(){var e={"aria-disabled":"false","aria-label":"previous month"},i={"aria-disabled":"false","aria-label":"next month"},r={"aria-atomic":"true","aria-live":"assertive"},n={tabindex:"0"};this.headerElement=this.createElement("div",{className:b3});var a=this.createElement("div",{className:k3});this.previousIcon=this.createElement("button",{className:""+C3,attrs:{type:"button"}}),os(this.previousIcon,{duration:400,selector:".e-prev",isCenterRipple:!0}),Pe(this.previousIcon,e),Pe(this.previousIcon,n),this.nextIcon=this.createElement("button",{className:""+w3,attrs:{type:"button"}}),os(this.nextIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),this.getModuleName()==="daterangepicker"&&(Pe(this.previousIcon,{tabIndex:"-1"}),Pe(this.nextIcon,{tabIndex:"-1"})),Pe(this.nextIcon,i),Pe(this.nextIcon,n),this.headerTitleElement=this.createElement("div",{className:""+py+" "+A3}),Pe(this.headerTitleElement,r),Pe(this.headerTitleElement,n),this.headerElement.appendChild(this.headerTitleElement),this.previousIcon.appendChild(this.createElement("span",{className:""+E3+" "+fy})),this.nextIcon.appendChild(this.createElement("span",{className:""+S3+" "+fy})),a.appendChild(this.previousIcon),a.appendChild(this.nextIcon),this.headerElement.appendChild(a),this.getModuleName()==="calendar"?this.element.appendChild(this.headerElement):this.calendarElement.appendChild(this.headerElement),this.adjustLongHeaderSize()},t.prototype.createContent=function(){this.contentElement=this.createElement("div",{className:y3}),this.table=this.createElement("table",{attrs:{class:x3,tabIndex:"0",role:"grid","aria-activedescendant":"","aria-labelledby":this.element.id}}),this.getModuleName()==="calendar"?this.element.appendChild(this.contentElement):this.calendarElement.appendChild(this.contentElement),this.contentElement.appendChild(this.table),this.createContentHeader(),this.createContentBody(),this.showTodayButton&&this.createContentFooter(),this.getModuleName()!=="daterangepicker"&&(R.add(this.table,"focus",this.addContentFocus,this),R.add(this.table,"blur",this.removeContentFocus,this))},t.prototype.addContentFocus=function(e){var i=this.tableBodyElement.querySelector("tr td.e-focused-date"),r=this.tableBodyElement.querySelector("tr td.e-selected");m(r)?m(i)||i.classList.add(Qn):r.classList.add(Qn)},t.prototype.removeContentFocus=function(e){var i=m(this.tableBodyElement)?null:this.tableBodyElement.querySelector("tr td.e-focused-date"),r=m(this.tableBodyElement)?null:this.tableBodyElement.querySelector("tr td.e-selected");m(r)?m(i)||i.classList.remove(Qn):r.classList.remove(Qn)},t.prototype.getCultureValues=function(){var e=[],i,r=m(this.dayHeaderFormat)?null:"days.stand-alone."+this.dayHeaderFormat.toLowerCase();if((this.locale==="en"||this.locale==="en-US")&&!m(r)?i=ie(r,BS()):i=this.getCultureObjects(N1,""+this.locale),!m(i))for(var n=0,a=Object.keys(i);n<a.length;n++){var o=a[n];e.push(ie(o,i))}return e},t.prototype.toCapitalize=function(e){return!m(e)&&e.length?e[0].toUpperCase()+e.slice(1):e},t.prototype.createContentHeader=function(){this.getModuleName()==="calendar"?m(this.element.querySelectorAll(".e-content .e-week-header")[0])||Oe(this.element.querySelectorAll(".e-content .e-week-header")[0]):m(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0])||Oe(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0]);var e=6,i="";(this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:0},!0),this.tableHeadElement=this.createElement("thead",{className:O3}),this.weekNumber&&(i+='<th class="e-week-number" aria-hidden="true"></th>',this.getModuleName()==="calendar"?P([this.element],""+vl):P([this.calendarElement],""+vl));var r=this.getCultureValues().length>0&&this.getCultureValues()?this.shiftArray(this.getCultureValues().length>0&&this.getCultureValues(),this.firstDayOfWeek):null;if(!m(r))for(var n=0;n<=e;n++)i+='<th  class="">'+this.toCapitalize(r[n])+"</th>";i="<tr>"+i+"</tr>",this.tableHeadElement.innerHTML=i,this.table.appendChild(this.tableHeadElement)},t.prototype.createContentBody=function(){switch(this.getModuleName()==="calendar"?m(this.element.querySelectorAll(".e-content tbody")[0])||Oe(this.element.querySelectorAll(".e-content tbody")[0]):m(this.calendarElement.querySelectorAll(".e-content tbody")[0])||Oe(this.calendarElement.querySelectorAll(".e-content tbody")[0]),this.start){case"Year":this.renderYears();break;case"Decade":this.renderDecades();break;default:this.renderMonths()}},t.prototype.updateFooter=function(){this.todayElement.textContent=this.l10.getConstant("today"),this.todayElement.setAttribute("aria-label",this.l10.getConstant("today")),this.todayElement.setAttribute("tabindex","0")},t.prototype.createContentFooter=function(){if(this.showTodayButton){var e=new Date(+this.min),i=new Date(+this.max),r={today:"Today"};this.globalize=new Ji(this.locale),this.l10=new br(this.getModuleName(),r,this.locale),this.todayElement=this.createElement("button",{attrs:{role:"button"}}),os(this.todayElement),this.updateFooter(),P([this.todayElement],[L3,dy,R3,_3,I3]),(!(+new Date(e.setHours(0,0,0,0))<=+this.todayDate&&+this.todayDate<=+new Date(i.setHours(0,0,0,0)))||this.todayDisabled)&&P([this.todayElement],zt),this.footer=this.createElement("div",{className:D3}),this.footer.appendChild(this.todayElement),this.getModuleName()==="calendar"&&this.element.appendChild(this.footer),this.getModuleName()==="datepicker"&&this.calendarElement.appendChild(this.footer),this.getModuleName()==="datetimepicker"&&this.calendarElement.appendChild(this.footer),this.todayElement.classList.contains(zt)||R.add(this.todayElement,"click",this.todayButtonClick,this)}},t.prototype.wireEvents=function(e,i,r,n){R.add(this.headerTitleElement,"click",this.navigateTitle,this),this.defaultKeyConfigs=Ue(this.defaultKeyConfigs,this.keyConfigs),this.getModuleName()==="calendar"?this.keyboardModule=new gr(this.element,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}):this.keyboardModule=new gr(this.calendarElement,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})},t.prototype.dateWireEvents=function(e,i,r,n){this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.defaultKeyConfigs=Ue(this.defaultKeyConfigs,r),this.serverModuleName=n},t.prototype.todayButtonClick=function(e,i,r){this.showTodayButton&&(this.currentView()===this.depth?this.effect="":this.effect="e-zoomin",this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.navigateTo(this.depth,new Date(this.checkValue(i)),r):this.navigateTo("Month",new Date(this.checkValue(i)),r))},t.prototype.resetCalendar=function(){this.calendarElement&&Oe(this.calendarElement),this.tableBodyElement&&Oe(this.tableBodyElement),this.table&&Oe(this.table),this.tableHeadElement&&Oe(this.tableHeadElement),this.nextIcon&&Oe(this.nextIcon),this.previousIcon&&Oe(this.previousIcon),this.footer&&Oe(this.footer),this.todayElement=null,this.renderDayCellArgs=null,this.calendarElement=this.tableBodyElement=this.footer=this.tableHeadElement=this.nextIcon=this.previousIcon=this.table=null},t.prototype.keyActionHandle=function(e,i,r){if(!(this.calendarElement===null&&e.action==="escape")){var n=this.tableBodyElement.querySelector("tr td.e-focused-date"),a;r?!m(n)&&+i===parseInt(n.getAttribute("id").split("_")[0],10)?a=n:a=this.tableBodyElement.querySelector("tr td.e-selected"):a=this.tableBodyElement.querySelector("tr td.e-selected");var o=this.getViewNumber(this.currentView()),l=this.getViewNumber(this.depth),h=o===l&&this.getViewNumber(this.start)>=l;switch(this.effect="",e.action){case"moveLeft":this.getModuleName()!=="daterangepicker"&&!m(e.target)&&(this.keyboardNavigate(-1,o,e,this.max,this.min),e.preventDefault());break;case"moveRight":this.getModuleName()!=="daterangepicker"&&!m(e.target)&&(this.keyboardNavigate(1,o,e,this.max,this.min),e.preventDefault());break;case"moveUp":this.getModuleName()!=="daterangepicker"&&!m(e.target)&&(o===0?this.keyboardNavigate(-7,o,e,this.max,this.min):this.keyboardNavigate(-4,o,e,this.max,this.min),e.preventDefault());break;case"moveDown":this.getModuleName()!=="daterangepicker"&&!m(e.target)&&(o===0?this.keyboardNavigate(7,o,e,this.max,this.min):this.keyboardNavigate(4,o,e,this.max,this.min),e.preventDefault());break;case"select":if(e.target===this.headerTitleElement)this.navigateTitle(e);else if(e.target===this.previousIcon&&!e.target.className.includes(zt))this.navigatePrevious(e);else if(e.target===this.nextIcon&&!e.target.className.includes(zt))this.navigateNext(e);else if(e.target===this.todayElement&&!e.target.className.includes(zt))this.todayButtonClick(e,i),(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&(this.isAngular?this.inputElement.focus():this.element.focus());else{var u=m(n)?a:n;if(!m(u)&&!u.classList.contains(zt))if(h){var c=new Date(parseInt(""+u.id,0));this.selectDate(e,c,u),(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&(this.isAngular?this.inputElement.focus():this.element.focus())}else e.target.className.includes(zt)||this.contentClick(null,--o,u,i)}break;case"controlUp":this.title(),e.preventDefault();break;case"controlDown":(!m(n)&&!h||!m(a)&&!h)&&this.contentClick(null,--o,n||a,i),e.preventDefault();break;case"home":this.currentDate=this.firstDay(this.currentDate),Oe(this.tableBodyElement),o===0?this.renderMonths(e):o===1?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"end":this.currentDate=this.lastDay(this.currentDate,o),Oe(this.tableBodyElement),o===0?this.renderMonths(e):o===1?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"pageUp":this.addMonths(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"pageDown":this.addMonths(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageUp":this.addYears(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageDown":this.addYears(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"controlHome":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),0,1)),e.preventDefault();break;case"controlEnd":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),11,31)),e.preventDefault();break;case"tab":(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&e.target===this.todayElement&&(e.preventDefault(),this.isAngular?this.inputElement.focus():this.element.focus(),this.hide());break;case"shiftTab":(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&e.target===this.headerTitleElement&&(e.preventDefault(),this.isAngular?this.inputElement.focus():this.element.focus(),this.hide());break;case"escape":(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&(e.target===this.headerTitleElement||e.target===this.previousIcon||e.target===this.nextIcon||e.target===this.todayElement)&&this.hide();break}}},t.prototype.keyboardNavigate=function(e,i,r,n,a){var o=new Date(this.checkValue(this.currentDate));switch(i){case 2:this.addYears(this.currentDate,e),this.isMonthYearRange(this.currentDate)?(Oe(this.tableBodyElement),this.renderDecades(r)):this.currentDate=o;break;case 1:this.addMonths(this.currentDate,e),this.calendarMode==="Gregorian"?this.isMonthYearRange(this.currentDate)?(Oe(this.tableBodyElement),this.renderYears(r)):this.currentDate=o:this.isMonthYearRange(this.currentDate)?(Oe(this.tableBodyElement),this.renderYears(r)):this.currentDate=o;break;case 0:this.addDay(this.currentDate,e,r,n,a),this.isMinMaxRange(this.currentDate)?(Oe(this.tableBodyElement),this.renderMonths(r)):this.currentDate=o;break}},t.prototype.preRender=function(e){var i=this;this.navigatePreviousHandler=this.navigatePrevious.bind(this),this.navigateNextHandler=this.navigateNext.bind(this),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.navigateHandler=function(r){i.triggerNavigate(r)}},t.prototype.minMaxDate=function(e){var i=new Date(new Date(+e).setHours(0,0,0,0)),r=new Date(new Date(+this.min).setHours(0,0,0,0)),n=new Date(new Date(+this.max).setHours(0,0,0,0));return(+i==+r||+i==+n)&&(+e<+this.min&&(e=new Date(+this.min)),+e>+this.max&&(e=new Date(+this.max))),e},t.prototype.renderMonths=function(e,i,r){var n=this.weekNumber?8:7,a;this.calendarMode==="Gregorian"?a=this.renderDays(this.currentDate,i,null,null,r,e):a=m(this.islamicModule)?null:this.islamicModule.islamicRenderDays(this.currentDate,i),this.createContentHeader(),this.calendarMode==="Gregorian"?this.renderTemplate(a,n,Ad,e,i):m(this.islamicModule)||this.islamicModule.islamicRenderTemplate(a,n,Ad,e,i)},t.prototype.renderDays=function(e,i,r,n,a,o){var l=[],h=42,u=a?new Date(+e):this.getDate(new Date,this.timezone),c=new Date(this.checkValue(e)),f,d=c.getMonth();this.titleUpdate(e,"days");var p=c;for(c=new Date(p.getFullYear(),p.getMonth(),0,p.getHours(),p.getMinutes(),p.getSeconds(),p.getMilliseconds());c.getDay()!==this.firstDayOfWeek;)this.setStartDate(c,-1*Od);for(var v=0;v<h;++v){var g=this.createElement("td",{className:my}),b=this.createElement("span");if(v%7===0&&this.weekNumber){var C=this.weekRule==="FirstDay"?6:this.weekRule==="FirstFourDayWeek"?3:0,y=new Date(c.getFullYear(),c.getMonth(),c.getDate()+C);b.textContent=""+this.getWeek(y),g.appendChild(b),P([g],""+vl),l.push(g)}f=new Date(+c),c=this.minMaxDate(c);var x={type:"dateTime",skeleton:"full"},w=this.globalize.parseDate(this.globalize.formatDate(c,x),x),S=this.dayCell(c),E=this.globalize.formatDate(c,{type:"date",skeleton:"full"}),k=this.createElement("span");k.textContent=this.globalize.formatDate(c,{format:"d",type:"date",skeleton:"yMd"});var A=this.min>c||this.max<c;A?(P([S],zt),P([S],cn)):k.setAttribute("title",""+E),d!==c.getMonth()&&(P([S],is),k.setAttribute("aria-disabled","true")),(c.getDay()===0||c.getDay()===6)&&P([S],T3),S.appendChild(k),this.renderDayCellArgs={date:c,isDisabled:!1,element:S,isOutOfRange:A};var z=this.renderDayCellArgs;if(this.renderDayCellEvent(z),z.isDisabled){var D=new Date(this.checkValue(i)),T=new Date(this.checkValue(z.date));if(r){if(!m(n)&&n.length>0)for(var M=0;M<n.length;M++){var K=+new Date(this.globalize.formatDate(z.date,{type:"date",skeleton:"yMd"})),te=+new Date(this.globalize.formatDate(n[M],{type:"date",skeleton:"yMd"}));K===te&&(n.splice(M,1),M=-1)}}else D&&+D==+T&&this.setProperties({value:null},!0)}this.renderDayCellArgs.isDisabled&&!S.classList.contains(Mi)&&(P([S],zt),P([S],cn),k.setAttribute("aria-disabled","true"),+this.renderDayCellArgs.date==+this.todayDate&&(this.todayDisabled=!0));var ee=S.classList.contains(is),J=S.classList.contains(zt);J||R.add(S,"click",this.clickHandler,this);var re=void 0;if(!m(o)&&o.type==="click"&&(re=o.currentTarget),r&&!m(n)&&!J){for(var j=0;j<n.length;j++){var de=this.calendarMode==="Gregorian"?"gregorian":"islamic",we={format:null,type:"date",skeleton:"short",calendar:de},K=this.globalize.formatDate(c,we),te=this.globalize.formatDate(n[j],we);if((K===te&&this.getDateVal(c,n[j])||this.getDateVal(c,i))&&P([S],Mi),!m(re)&&re.innerText===S.innerText&&this.previousDates&&S.classList.contains(Mi)&&re.classList.contains(Mi)){Z([S],Mi),this.previousDates=!1;for(var N=this.copyValues(n),H=0;H<N.length;H++){var L=this.calendarMode==="Gregorian"?"gregorian":"islamic",_={format:null,type:"date",skeleton:"short",calendar:L},U=this.globalize.formatDate(w,_),se=this.globalize.formatDate(N[H],_);if(U===se){var M=N.indexOf(N[H]);N.splice(M,1),n.splice(M,1)}}this.setProperties({values:N},!0)}else this.updateFocus(ee,J,c,S,e)}n.length<=0&&this.updateFocus(ee,J,c,S,e)}else!J&&this.getDateVal(c,i)&&P([S],Mi);this.updateFocus(ee,J,c,S,e),!m(w)&&w.getFullYear()===u.getFullYear()&&w.getMonth()===u.getMonth()&&w.getDate()===u.getDate()&&P([S],dy),l.push(this.renderDayCellArgs.element),c=new Date(+f),this.addDay(c,1,null,this.max,this.min)}return l},t.prototype.updateFocus=function(e,i,r,n,a){a.getDate()===r.getDate()&&!e&&!i?P([n],Er):(a>=this.max&&parseInt(n.id,0)===+this.max&&!e&&!i&&P([n],Er),a<=this.min&&parseInt(n.id,0)===+this.min&&!e&&!i&&P([n],Er))},t.prototype.renderYears=function(e,i){this.removeTableHeadElement();var r=4,n=[],a=m(i),o=new Date(this.checkValue(this.currentDate)),l=o.getMonth(),h=o.getFullYear(),u=o,c=u.getFullYear(),f=new Date(this.checkValue(this.min)).getFullYear(),d=new Date(this.checkValue(this.min)).getMonth(),p=new Date(this.checkValue(this.max)).getFullYear(),v=new Date(this.checkValue(this.max)).getMonth();u.setMonth(0),this.titleUpdate(this.currentDate,"months"),u.setDate(1);for(var g=0;g<12;++g){var b=this.dayCell(u),C=this.createElement("span"),y=i&&i.getMonth()===u.getMonth(),x=i&&i.getFullYear()===h&&y,w=this.globalize.formatDate(u,{type:"date",format:"MMM y"});C.textContent=this.toCapitalize(this.globalize.formatDate(u,{format:null,type:"dateTime",skeleton:"MMM"})),this.min&&(c<f||g<d&&c===f)||this.max&&(c>p||g>v&&c>=p)?P([b],zt):!a&&x?P([b],Mi):u.getMonth()===l&&this.currentDate.getMonth()===l&&P([b],Er),u.setDate(1),u.setMonth(u.getMonth()+1),b.classList.contains(zt)||(R.add(b,"click",this.clickHandler,this),C.setAttribute("title",""+w)),b.appendChild(C),n.push(b)}this.renderTemplate(n,r,Td,e,i)},t.prototype.renderDecades=function(e,i){this.removeTableHeadElement();var r=4,n=12,a=[],o=new Date(this.checkValue(this.currentDate));o.setMonth(0),o.setDate(1);var l=o.getFullYear(),h=new Date(o.setFullYear(l-l%10)),u=new Date(o.setFullYear(l-l%10+9)),c=h.getFullYear(),f=u.getFullYear(),d=this.globalize.formatDate(h,{format:null,type:"dateTime",skeleton:"y"}),p=this.globalize.formatDate(u,{format:null,type:"dateTime",skeleton:"y"});this.headerTitleElement.textContent=d+" - "+p;for(var v=new Date(l-l%10-1,0,1),g=v.getFullYear(),b=0;b<n;++b){var C=g+b;o.setFullYear(C);var y=this.dayCell(o),x=this.createElement("span");x.textContent=this.globalize.formatDate(o,{format:null,type:"dateTime",skeleton:"y"}),C<c||C>f?(P([y],kd),x.setAttribute("aria-disabled","true"),!m(i)&&o.getFullYear()===i.getFullYear()&&P([y],Mi),(C<new Date(this.checkValue(this.min)).getFullYear()||C>new Date(this.checkValue(this.max)).getFullYear())&&P([y],zt)):C<new Date(this.checkValue(this.min)).getFullYear()||C>new Date(this.checkValue(this.max)).getFullYear()?P([y],zt):!m(i)&&o.getFullYear()===i.getFullYear()?P([y],Mi):o.getFullYear()===this.currentDate.getFullYear()&&!y.classList.contains(zt)&&P([y],Er),y.classList.contains(zt)||(R.add(y,"click",this.clickHandler,this),x.setAttribute("title",""+x.textContent)),y.appendChild(x),a.push(y)}this.renderTemplate(a,r,"e-decade",e,i)},t.prototype.dayCell=function(e){var i=this.calendarMode==="Gregorian"?"gregorian":"islamic",r={skeleton:"full",type:"dateTime",calendar:i},n=this.globalize.parseDate(this.globalize.formatDate(e,r),r),a;m(n)||(a=n.valueOf());var o={className:my,attrs:{id:""+fi(""+a)}};return this.createElement("td",o)},t.prototype.firstDay=function(e){var i=this.currentView()!=="Decade"?this.tableBodyElement.querySelectorAll("td:not(."+is+"):not(."+vl+")"):this.tableBodyElement.querySelectorAll("td:not(."+kd);if(i.length){for(var r=0;r<i.length;r++)if(!i[r].classList.contains(zt)){e=new Date(parseInt(i[r].id,0));break}}return e},t.prototype.lastDay=function(e,i){var r=new Date(e.getFullYear(),e.getMonth()+1,0);if(i!==2){var n=Math.abs(r.getTimezoneOffset()-this.firstDay(e).getTimezoneOffset());return n&&r.setHours(this.firstDay(e).getHours()+n/60),this.findLastDay(r)}else return this.findLastDay(this.firstDay(r))},t.prototype.checkDateValue=function(e){return!m(e)&&e instanceof Date&&!isNaN(+e)?e:null},t.prototype.findLastDay=function(e){var i=this.currentView()==="Decade"?this.tableBodyElement.querySelectorAll("td:not(."+kd):this.tableBodyElement.querySelectorAll("td:not(."+is+"):not(."+vl+")");if(i.length){for(var r=i.length-1;r>=0;r--)if(!i[r].classList.contains(zt)){e=new Date(parseInt(i[r].id,0));break}}return e},t.prototype.removeTableHeadElement=function(){this.getModuleName()==="calendar"?m(this.element.querySelectorAll(".e-content table thead")[0])||Oe(this.tableHeadElement):m(this.calendarElement.querySelectorAll(".e-content table thead")[0])||Oe(this.tableHeadElement)},t.prototype.renderTemplate=function(e,i,r,n,a){var o=this.getViewNumber(this.currentView()),l;this.tableBodyElement=this.createElement("tbody"),this.table.appendChild(this.tableBodyElement),Z([this.contentElement,this.headerElement],[Ad,cy,Td]),P([this.contentElement,this.headerElement],[r]);for(var h=41,u=35,c=6,f=i,d=0,p=0;p<e.length/i;++p){for(l=this.createElement("tr"),d=0+d;d<f;d++)!e[d].classList.contains("e-week-number")&&!m(e[d].children[0])&&(P([e[d].children[0]],[py]),os(e[d].children[0],{duration:600,isCenterRipple:!0})),l.appendChild(e[d]),this.weekNumber&&d===c+1&&e[c+1].classList.contains(is)&&P([l],Ru),!this.weekNumber&&d===c&&e[c].classList.contains(is)&&P([l],Ru),this.weekNumber?d===h&&e[h].classList.contains(is)&&P([l],Ru):d===u&&e[u].classList.contains(is)&&P([l],Ru);f=f+i,d=d+0,this.tableBodyElement.appendChild(l)}this.table.querySelector("tbody").className=this.effect,this.calendarMode==="Gregorian"?this.iconHandler():this.islamicModule.islamicIconHandler(),(o!==this.getViewNumber(this.currentView())||o===0&&o!==this.getViewNumber(this.currentView()))&&this.navigateHandler(n),this.setAriaActiveDescendant()},t.prototype.clickHandler=function(e,i){this.clickEventEmitter(e);var r=e.currentTarget,n=this.getViewNumber(this.currentView());r.classList.contains(is)?this.contentClick(e,0,null,i):n===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.contentClick(e,1,null,i):n===2?this.contentClick(e,1,null,i):!r.classList.contains(is)&&n===0?this.selectDate(e,this.getIdValue(e,null),null):this.contentClick(e,0,r,i),this.getModuleName()==="calendar"&&this.table.focus()},t.prototype.clickEventEmitter=function(e){e.preventDefault()},t.prototype.contentClick=function(e,i,r,n){var a=this.getViewNumber(this.currentView()),o=this.getIdValue(e,r);switch(i){case 0:a===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?(Oe(this.tableBodyElement),this.currentDate=o,this.effect=Iu,this.renderMonths(e)):(this.calendarMode==="Gregorian"?(this.currentDate.setMonth(o.getMonth()),o.getMonth()>0&&this.currentDate.getMonth()!==o.getMonth()&&this.currentDate.setDate(0),this.currentDate.setFullYear(o.getFullYear())):this.currentDate=o,this.effect=Iu,Oe(this.tableBodyElement),this.renderMonths(e));break;case 1:if(a===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth))this.selectDate(e,o,null);else{if(this.calendarMode==="Gregorian")this.currentDate.setFullYear(o.getFullYear());else{this.islamicPreviousHeader=this.headerElement.textContent;var l=this.islamicModule.getIslamicDate(o);this.currentDate=this.islamicModule.toGregorian(l.year,l.month,1)}this.effect=Iu,Oe(this.tableBodyElement),this.renderYears(e)}}},t.prototype.switchView=function(e,i,r,n){switch(e){case 0:Oe(this.tableBodyElement),this.renderMonths(i,null,n);break;case 1:Oe(this.tableBodyElement),this.renderYears(i);break;case 2:Oe(this.tableBodyElement),this.renderDecades(i)}},t.prototype.getModuleName=function(){return"calendar"},t.prototype.requiredModules=function(){var e=[];return this.calendarMode==="Islamic"&&e.push({args:[this],member:"islamic",name:"Islamic"}),e},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.onPropertyChanged=function(e,i,r,n){this.effect="";for(var a=0,o=Object.keys(e);a<o.length;a++){var l=o[a];switch(l){case"enableRtl":e.enableRtl?this.getModuleName()==="calendar"?this.element.classList.add("e-rtl"):this.calendarElement.classList.add("e-rtl"):this.getModuleName()==="calendar"?this.element.classList.remove("e-rtl"):this.calendarElement.classList.remove("e-rtl");break;case"dayHeaderFormat":this.getCultureValues(),this.getModuleName()!=="datepicker"?this.createContentHeader():this.calendarElement&&this.createContentHeader(),this.adjustLongHeaderSize();break;case"min":case"max":this.rangeValidation(this.min,this.max),l==="min"?this.setProperties({min:this.checkDateValue(new Date(this.checkValue(e.min)))},!0):this.setProperties({max:this.checkDateValue(new Date(this.checkValue(e.max)))},!0),this.setProperties({start:this.currentView()},!0),this.tableBodyElement&&Oe(this.tableBodyElement),this.minMaxUpdate(),r&&this.validateValues(r,n),this.getModuleName()!=="datepicker"?this.createContentBody():this.calendarElement&&this.createContentBody(),(this.todayDate<this.min||this.max<this.todayDate)&&this.footer&&this.todayElement?(Oe(this.todayElement),Oe(this.footer),this.todayElement=this.footer=null,this.createContentFooter()):this.footer&&this.todayElement&&this.todayElement.classList.contains("e-disabled")&&(Z([this.todayElement],zt),Oe(this.todayElement),Oe(this.footer),this.todayElement=this.footer=null,this.createContentFooter());break;case"start":case"depth":case"weekNumber":case"firstDayOfWeek":case"weekRule":this.checkView(),this.getModuleName()!=="datepicker"?(this.createContentHeader(),this.createContentBody()):this.calendarElement&&(this.createContentHeader(),this.createContentBody());break;case"locale":if(this.globalize=new Ji(this.locale),this.getModuleName()!=="datepicker"?(this.createContentHeader(),this.createContentBody()):this.calendarElement&&(this.createContentHeader(),this.createContentBody()),this.getModuleName()==="calendar"){var h={today:"Today"};this.l10=new br(this.getModuleName(),h,this.locale)}this.l10.setLocale(this.locale),this.showTodayButton&&this.updateFooter();break;case"showTodayButton":e.showTodayButton?this.createContentFooter():!m(this.todayElement)&&!m(this.footer)&&(Oe(this.todayElement),Oe(this.footer),this.todayElement=this.footer=void 0),this.setProperties({showTodayButton:e.showTodayButton},!0);break}}},t.prototype.validateValues=function(e,i){if(e&&!m(i)&&i.length>0){for(var r=this.copyValues(i),n=0;n<r.length;n++){var a=r[n],o=this.calendarMode==="Gregorian"?"gregorian":"islamic",l=void 0,h=void 0,u=void 0;this.calendarMode==="Gregorian"?(l={type:"date",skeleton:"yMd"},h=this.globalize.formatDate(a,l),u=this.globalize.parseDate(h,l)):(l={type:"date",skeleton:"yMd",calendar:"islamic"},h=this.globalize.formatDate(a,l),u=this.globalize.parseDate(h,l));var c={type:"date",skeleton:"yMd",calendar:o},f=this.globalize.formatDate(this.min,c),d=f,p={type:"date",skeleton:"yMd",calendar:o},v=this.globalize.formatDate(this.max,p),g=v,b=this.globalize.parseDate(d,c),C=this.globalize.parseDate(g,p);(+u<+b||+u>+C)&&(r.splice(n,1),n=-1)}this.setProperties({values:r},!0)}},t.prototype.setValueUpdate=function(){m(this.tableBodyElement)||(Oe(this.tableBodyElement),this.setProperties({start:this.currentView()},!0),this.createContentBody())},t.prototype.copyValues=function(e){var i=[];if(!m(e)&&e.length>0)for(var r=0;r<e.length;r++)i.push(new Date(+e[r]));return i},t.prototype.titleUpdate=function(e,i){var r=new Ji(this.locale),n,a,o=this.calendarMode==="Gregorian"?"gregorian":"islamic";switch(this.calendarMode==="Gregorian"?(n=r.formatDate(e,{type:"dateTime",skeleton:"yMMMM",calendar:o}),a=r.formatDate(e,{format:null,type:"dateTime",skeleton:"y",calendar:o})):(n=r.formatDate(e,{type:"dateTime",format:"MMMM y",calendar:o}),a=r.formatDate(e,{type:"dateTime",format:"y",calendar:o})),i){case"days":this.headerTitleElement.textContent=this.toCapitalize(n);break;case"months":this.headerTitleElement.textContent=a}},t.prototype.setActiveDescendant=function(){var e,i=this.tableBodyElement.querySelector("tr td.e-focused-date"),r=this.tableBodyElement.querySelector("tr td.e-selected"),n=this.calendarMode==="Gregorian"?"gregorian":"islamic",a,o=this.currentView();return o==="Month"?a=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"full",calendar:n}):o==="Year"?n!=="islamic"?a=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"yMMMM",calendar:n}):a=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"GyMMM",calendar:n}):a=this.globalize.formatDate(this.currentDate,{format:null,type:"date",skeleton:"y",calendar:n}),(r||i)&&(m(r)||r.setAttribute("aria-selected","true"),(i||r).setAttribute("aria-label",a),e=(i||r).getAttribute("id")),e},t.prototype.iconHandler=function(){switch(new Date(this.checkValue(this.currentDate)).setDate(1),this.currentView()){case"Month":this.previousIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Year":this.previousIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Decade":this.previousIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.max)>-1)}},t.prototype.destroy=function(){this.getModuleName()==="calendar"&&this.element?Z([this.element],[ml]):this.calendarElement&&this.element&&Z([this.element],[ml]),this.getModuleName()==="calendar"&&this.element&&(m(this.headerTitleElement)||R.remove(this.headerTitleElement,"click",this.navigateTitle),this.todayElement&&R.remove(this.todayElement,"click",this.todayButtonClick),this.previousIconHandler(!0),this.nextIconHandler(!0),this.keyboardModule.destroy(),this.element.removeAttribute("data-role"),m(this.calendarEleCopy.getAttribute("tabindex"))?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex",this.tabIndex)),this.element&&(this.element.innerHTML=""),this.todayElement=null,this.tableBodyElement=null,this.todayButtonEvent=null,this.renderDayCellArgs=null,this.headerElement=null,this.nextIcon=null,this.table=null,this.tableHeadElement=null,this.previousIcon=null,this.headerTitleElement=null,this.footer=null,this.contentElement=null,s.prototype.destroy.call(this)},t.prototype.title=function(e){var i=this.getViewNumber(this.currentView());this.effect=Iu,this.switchView(++i,e)},t.prototype.getViewNumber=function(e){return e==="Month"?0:e==="Year"?1:2},t.prototype.navigateTitle=function(e){e.preventDefault(),this.title(e)},t.prototype.previous=function(){this.effect="";var e=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,-1),this.switchView(e);break;case"Year":this.addYears(this.currentDate,-1),this.switchView(e);break;case"Decade":this.addYears(this.currentDate,-10),this.switchView(e);break}},t.prototype.navigatePrevious=function(e){!xe.isDevice&&e.preventDefault(),this.calendarMode==="Gregorian"?this.previous():this.islamicModule.islamicPrevious(),this.triggerNavigate(e)},t.prototype.next=function(){this.effect="";var e=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,1),this.switchView(e);break;case"Year":this.addYears(this.currentDate,1),this.switchView(e);break;case"Decade":this.addYears(this.currentDate,10),this.switchView(e);break}},t.prototype.navigateNext=function(e){!xe.isDevice&&e.preventDefault(),this.calendarMode==="Gregorian"?this.next():this.islamicModule.islamicNext(),this.triggerNavigate(e)},t.prototype.navigateTo=function(e,i,r){+i>=+this.min&&+i<=+this.max&&(this.currentDate=i),+i<=+this.min&&(this.currentDate=new Date(this.checkValue(this.min))),+i>=+this.max&&(this.currentDate=new Date(this.checkValue(this.max))),this.getViewNumber(this.depth)>=this.getViewNumber(e)&&(this.getViewNumber(this.depth)<=this.getViewNumber(this.start)||this.getViewNumber(this.depth)===this.getViewNumber(e))&&(e=this.depth),this.switchView(this.getViewNumber(e),null,null,r)},t.prototype.currentView=function(){return!m(this.contentElement)&&this.contentElement.classList.contains(Td)?"Year":!m(this.contentElement)&&this.contentElement.classList.contains(cy)?"Decade":"Month"},t.prototype.getDateVal=function(e,i){return!m(i)&&e.getDate()===i.getDate()&&e.getMonth()===i.getMonth()&&e.getFullYear()===i.getFullYear()},t.prototype.getCultureObjects=function(e,i){var r=m(this.dayHeaderFormat)?null:".dates.calendars.gregorian.days.format."+this.dayHeaderFormat.toLowerCase(),n=m(this.dayHeaderFormat)?null:".dates.calendars.islamic.days.format."+this.dayHeaderFormat.toLowerCase(),a="main.";return this.calendarMode==="Gregorian"?ie(a+""+this.locale+r,e):ie("main."+this.locale+n,e)},t.prototype.getWeek=function(e){var i=new Date(this.checkValue(e)).valueOf(),r=new Date(e.getFullYear(),0,1).valueOf();return Math.ceil((i-r+Od)/Od/7)},t.prototype.setStartDate=function(e,i){var r=e.getTimezoneOffset(),n=new Date(e.getTime()+i),a=n.getTimezoneOffset()-r;e.setTime(n.getTime()+a*F3)},t.prototype.addMonths=function(e,i){if(this.calendarMode==="Gregorian"){var r=e.getDate();e.setDate(1),e.setMonth(e.getMonth()+i),e.setDate(Math.min(r,this.getMaxDays(e)))}else{var n=this.islamicModule.getIslamicDate(e);this.currentDate=this.islamicModule.toGregorian(n.year,n.month+i,1)}},t.prototype.addYears=function(e,i){if(this.calendarMode==="Gregorian"){var r=e.getDate();e.setDate(1),e.setFullYear(e.getFullYear()+i),e.setDate(Math.min(r,this.getMaxDays(e)))}else{var n=this.islamicModule.getIslamicDate(e);this.currentDate=this.islamicModule.toGregorian(n.year+i,n.month,1)}},t.prototype.getIdValue=function(e,i){var r;e?r=e.currentTarget:r=i;var n=this.calendarMode==="Gregorian"?"gregorian":"islamic",a={type:"dateTime",skeleton:"full",calendar:n},o=this.globalize.formatDate(new Date(parseInt(""+r.getAttribute("id"),0)),a),l=this.globalize.parseDate(o,a),h=l.valueOf()-l.valueOf()%1e3;return new Date(h)},t.prototype.adjustLongHeaderSize=function(){Z([this.element],vy),this.dayHeaderFormat==="Wide"&&P([this.getModuleName()==="calendar"?this.element:this.calendarElement],vy)},t.prototype.selectDate=function(e,i,r,n,a){var o=r||e.currentTarget;if(this.isDateSelected=!1,this.currentView()==="Decade")this.setDateDecade(this.currentDate,i.getFullYear());else if(this.currentView()==="Year")this.setDateYear(this.currentDate,i);else{if(n&&!this.checkPresentDate(i,a)){var l=this.copyValues(a);!m(a)&&l.length>0?(l.push(new Date(this.checkValue(i))),this.setProperties({values:l},!0),this.setProperties({value:a[a.length-1]},!0)):this.setProperties({values:[new Date(this.checkValue(i))]},!0)}else this.setProperties({value:new Date(this.checkValue(i))},!0);this.currentDate=new Date(this.checkValue(i))}var h=X(o,"."+ml);if(m(h)&&(h=this.tableBodyElement),!n&&!m(h.querySelector("."+Mi))&&Z([h.querySelector("."+Mi)],Mi),!n&&!m(h.querySelector("."+Er))&&Z([h.querySelector("."+Er)],Er),!n&&!m(h.querySelector("."+Qn))&&Z([h.querySelector("."+Qn)],Qn),n){for(var l=this.copyValues(a),u=Array.prototype.slice.call(this.tableBodyElement.querySelectorAll("td")),c=0;c<u.length;c++){var f=h.querySelectorAll("td."+Er)[0],d=h.querySelectorAll("td."+Mi)[0];u[c]===f&&Z([u[c]],Er),u[c]===d&&!this.checkPresentDate(new Date(parseInt(d.getAttribute("id").split("_")[0],10)),a)&&Z([u[c]],Mi)}if(o.classList.contains(Mi)){Z([o],Mi);for(var p=0;p<l.length;p++){var v=this.calendarMode==="Gregorian"?"gregorian":"islamic",g={format:null,type:"date",skeleton:"short",calendar:v},b=this.globalize.formatDate(i,g),C=this.globalize.formatDate(l[p],g);if(b===C){var c=l.indexOf(l[p]);l.splice(c,1),P([o],Er)}}this.setProperties({values:l},!0)}else P([o],Mi)}else P([o],Mi);this.isDateSelected=!0},t.prototype.checkPresentDate=function(e,i){var r=!1;if(!m(i))for(var n=0;n<i.length;n++){var a=this.calendarMode==="Gregorian"?"gregorian":"islamic",o=this.globalize.formatDate(e,{format:null,type:"date",skeleton:"short",calendar:a}),l=this.globalize.formatDate(i[n],{format:null,type:"date",skeleton:"short",calendar:a});o===l&&(r=!0)}return r},t.prototype.setAriaActiveDescendant=function(){Pe(this.table,{"aria-activedescendant":""+this.setActiveDescendant()})},t.prototype.previousIconHandler=function(e){e?m(this.previousIcon)||(R.remove(this.previousIcon,"click",this.navigatePreviousHandler),P([this.previousIcon],""+zt),P([this.previousIcon],""+cn),this.previousIcon.setAttribute("aria-disabled","true")):(R.add(this.previousIcon,"click",this.navigatePreviousHandler),Z([this.previousIcon],""+zt),Z([this.previousIcon],""+cn),this.previousIcon.setAttribute("aria-disabled","false"))},t.prototype.renderDayCellEvent=function(e){Ue(this.renderDayCellArgs,{name:"renderDayCell"}),this.trigger("renderDayCell",e)},t.prototype.navigatedEvent=function(e){Ue(this.navigatedArgs,{name:"navigated",event:e}),this.trigger("navigated",this.navigatedArgs)},t.prototype.triggerNavigate=function(e){this.navigatedArgs={view:this.currentView(),date:this.currentDate},this.navigatedEvent(e)},t.prototype.nextIconHandler=function(e){e?m(this.previousIcon)||(R.remove(this.nextIcon,"click",this.navigateNextHandler),P([this.nextIcon],zt),P([this.nextIcon],cn),this.nextIcon.setAttribute("aria-disabled","true")):(R.add(this.nextIcon,"click",this.navigateNextHandler),Z([this.nextIcon],zt),Z([this.nextIcon],cn),this.nextIcon.setAttribute("aria-disabled","false"))},t.prototype.compare=function(e,i,r){var n=i.getFullYear(),a,o;return a=n,o=0,r&&(n=n-n%r,a=n-n%r+r-1),e.getFullYear()>a?o=1:e.getFullYear()<n&&(o=-1),o},t.prototype.isMinMaxRange=function(e){return+e>=+this.min&&+e<=+this.max},t.prototype.isMonthYearRange=function(e){if(this.calendarMode==="Gregorian")return e.getMonth()>=this.min.getMonth()&&e.getFullYear()>=this.min.getFullYear()&&e.getMonth()<=this.max.getMonth()&&e.getFullYear()<=this.max.getFullYear();var i=this.islamicModule.getIslamicDate(e);return i.month>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).month&&i.year>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).year&&i.month<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).month&&i.year<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).year},t.prototype.compareYear=function(e,i){return this.compare(e,i,0)},t.prototype.compareDecade=function(e,i){return this.compare(e,i,10)},t.prototype.shiftArray=function(e,i){return e.slice(i).concat(e.slice(0,i))},t.prototype.addDay=function(e,i,r,n,a){var o=i,l=new Date(+e);if(!m(this.tableBodyElement)&&!m(r)){for(;this.findNextTD(new Date(+e),o,n,a);)o+=i;var h=new Date(l.setDate(l.getDate()+o));o=+h>+n||+h<+a?o===i?i-i:i:o}e.setDate(e.getDate()+o)},t.prototype.findNextTD=function(e,i,r,n){var a=new Date(e.setDate(e.getDate()+i)),o=[],l=!1;if((!m(a)&&a.getMonth())===(!m(this.currentDate)&&this.currentDate.getMonth())){var h=void 0;this.calendarMode==="Gregorian"?h=this.renderDays(a):h=this.islamicModule.islamicRenderDays(this.currentDate,a),o=h.filter(function(c){return c.classList.contains(zt)})}else o=this.tableBodyElement.querySelectorAll("td."+zt);if(+a<=+r&&+a>=+n&&o.length)for(var u=0;u<o.length&&(l=+a==+new Date(parseInt(o[u].id,0)),!l);u++);return l},t.prototype.getMaxDays=function(e){var i,r=new Date(this.checkValue(e));i=28;for(var n=r.getMonth();r.getMonth()===n;)++i,r.setDate(i);return i-1},t.prototype.setDateDecade=function(e,i){e.setFullYear(i),this.setProperties({value:new Date(this.checkValue(e))},!0)},t.prototype.setDateYear=function(e,i){e.setFullYear(i.getFullYear(),i.getMonth(),e.getDate()),i.getMonth()!==e.getMonth()&&(e.setDate(0),this.currentDate=new Date(this.checkValue(i))),this.setProperties({value:new Date(this.checkValue(e))},!0)},t.prototype.compareMonth=function(e,i){var r;return e.getFullYear()>i.getFullYear()?r=1:e.getFullYear()<i.getFullYear()?r=-1:r=e.getMonth()===i.getMonth()?0:e.getMonth()>i.getMonth()?1:-1,r},t.prototype.checkValue=function(e){return e instanceof Date?e.toUTCString():""+e},t.prototype.checkView=function(){this.start!=="Decade"&&this.start!=="Year"&&this.setProperties({start:"Month"},!0),this.depth!=="Decade"&&this.depth!=="Year"&&this.setProperties({depth:"Month"},!0),this.getViewNumber(this.depth)>this.getViewNumber(this.start)&&this.setProperties({depth:"Month"},!0)},t.prototype.getDate=function(e,i){return i&&(e=new Date(e.toLocaleString("en-US",{timeZone:i}))),e},Jt([O(new Date(1900,0,1))],t.prototype,"min",void 0),Jt([O(!0)],t.prototype,"enabled",void 0),Jt([O(null)],t.prototype,"cssClass",void 0),Jt([O(new Date(2099,11,31))],t.prototype,"max",void 0),Jt([O(null)],t.prototype,"firstDayOfWeek",void 0),Jt([O("Gregorian")],t.prototype,"calendarMode",void 0),Jt([O("Month")],t.prototype,"start",void 0),Jt([O("Month")],t.prototype,"depth",void 0),Jt([O(!1)],t.prototype,"weekNumber",void 0),Jt([O("FirstDay")],t.prototype,"weekRule",void 0),Jt([O(!0)],t.prototype,"showTodayButton",void 0),Jt([O("Short")],t.prototype,"dayHeaderFormat",void 0),Jt([O(!1)],t.prototype,"enablePersistence",void 0),Jt([O(null)],t.prototype,"keyConfigs",void 0),Jt([O(null)],t.prototype,"serverTimezoneOffset",void 0),Jt([Se()],t.prototype,"created",void 0),Jt([Se()],t.prototype,"destroyed",void 0),Jt([Se()],t.prototype,"navigated",void 0),Jt([Se()],t.prototype,"renderDayCell",void 0),t=Jt([Wi],t),t}(Rr),M3=function(s){zw(t,s);function t(e,i){return s.call(this,e,i)||this}return t.prototype.render=function(){if(this.calendarMode==="Islamic"&&this.islamicModule===void 0&&HS("Requires the injectable Islamic modules to render Calendar in Islamic mode"),this.isMultiSelection&&typeof this.values=="object"&&!m(this.values)&&this.values.length>0){for(var e=[],i=[],r=0;r<this.values.length;r++)e.indexOf(+this.values[r])===-1&&(e.push(+this.values[r]),i.push(this.values[r]));this.setProperties({values:i},!0);for(var n=0;n<this.values.length;n++)if(!this.checkDateValue(this.values[n]))if(typeof this.values[n]=="string"&&this.checkDateValue(new Date(this.checkValue(this.values[n])))){var a=new Date(this.checkValue(this.values[n]));this.values.splice(n,1),this.values.splice(n,0,a)}else this.values.splice(n,1);this.setProperties({value:this.values[this.values.length-1]},!0),this.previousValues=this.values.length}if(this.validateDate(),this.minMaxUpdate(),this.getModuleName()==="calendar"&&(this.setEnable(this.enabled),this.setClass(this.cssClass)),s.prototype.render.call(this),this.getModuleName()==="calendar"){var o=X(this.element,"form");o&&R.add(o,"reset",this.formResetHandler.bind(this)),this.setTimeZone(this.serverTimezoneOffset)}this.renderComplete()},t.prototype.setEnable=function(e){e?Z([this.element],zt):P([this.element],zt)},t.prototype.setClass=function(e,i){m(i)||(i=i.replace(/\s+/g," ").trim()),m(e)||(e=e.replace(/\s+/g," ").trim()),!m(i)&&i!==""&&Z([this.element],i.split(" ")),m(e)||P([this.element],e.split(" "))},t.prototype.isDayLightSaving=function(){var e=new Date(this.value.getFullYear(),6,1).getTimezoneOffset(),i=new Date(this.value.getFullYear(),0,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(i,e)},t.prototype.setTimeZone=function(e){if(!m(this.serverTimezoneOffset)&&this.value){var i=e,r=new Date().getTimezoneOffset()/60,n=i+r;n=this.isDayLightSaving()?n--:n,this.value=new Date(this.value.getTime()+n*60*60*1e3)}},t.prototype.formResetHandler=function(){this.setProperties({value:null},!0)},t.prototype.validateDate=function(){typeof this.value=="string"&&this.setProperties({value:this.checkDateValue(new Date(this.checkValue(this.value)))},!0),s.prototype.validateDate.call(this,this.value),!m(this.value)&&this.min<=this.max&&this.value>=this.min&&this.value<=this.max&&(this.currentDate=new Date(this.checkValue(this.value))),isNaN(+this.value)&&this.setProperties({value:null},!0)},t.prototype.minMaxUpdate=function(){this.getModuleName()==="calendar"&&(!m(this.value)&&this.value<=this.min&&this.min<=this.max?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!m(this.value)&&this.value>=this.max&&this.min<=this.max&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})),this.getModuleName()!=="calendar"&&!m(this.value)?!m(this.value)&&this.value<this.min&&this.min<=this.max?s.prototype.minMaxUpdate.call(this,this.min):!m(this.value)&&this.value>this.max&&this.min<=this.max&&s.prototype.minMaxUpdate.call(this,this.max):s.prototype.minMaxUpdate.call(this,this.value)},t.prototype.generateTodayVal=function(e){var i=new Date;return m(this.timezone)||(i=s.prototype.getDate.call(this,i,this.timezone)),e&&m(this.timezone)?(i.setHours(e.getHours()),i.setMinutes(e.getMinutes()),i.setSeconds(e.getSeconds()),i.setMilliseconds(e.getMilliseconds())):i=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0),i},t.prototype.todayButtonClick=function(e){if(this.showTodayButton){var i=this.generateTodayVal(this.value);if(this.setProperties({value:i},!0),this.isTodayClicked=!0,this.todayButtonEvent=e,this.isMultiSelection){var r=this.copyValues(this.values);s.prototype.checkPresentDate.call(this,i,this.values)||(r.push(i),this.setProperties({values:r}))}s.prototype.todayButtonClick.call(this,e,new Date(+this.value))}},t.prototype.keyActionHandle=function(e){s.prototype.keyActionHandle.call(this,e,this.value,this.isMultiSelection)},t.prototype.preRender=function(){var e=this;this.changeHandler=function(i){e.triggerChange(i)},this.checkView(),s.prototype.preRender.call(this,this.value)},t.prototype.createContent=function(){this.previousDate=this.value,this.previousDateTime=this.value,s.prototype.createContent.call(this)},t.prototype.minMaxDate=function(e){return s.prototype.minMaxDate.call(this,e)},t.prototype.renderMonths=function(e,i,r){s.prototype.renderMonths.call(this,e,this.value,r)},t.prototype.renderDays=function(e,i,r,n,a,o){var l=s.prototype.renderDays.call(this,e,this.value,this.isMultiSelection,this.values,a,o);return this.isMultiSelection&&s.prototype.validateValues.call(this,this.isMultiSelection,this.values),l},t.prototype.renderYears=function(e){this.calendarMode==="Gregorian"?s.prototype.renderYears.call(this,e,this.value):this.islamicModule.islamicRenderYears(e,this.value)},t.prototype.renderDecades=function(e){this.calendarMode==="Gregorian"?s.prototype.renderDecades.call(this,e,this.value):this.islamicModule.islamicRenderDecade(e,this.value)},t.prototype.renderTemplate=function(e,i,r,n){this.calendarMode==="Gregorian"?s.prototype.renderTemplate.call(this,e,i,r,n,this.value):this.islamicModule.islamicRenderTemplate(e,i,r,n,this.value),this.changedArgs={value:this.value,values:this.values},n&&n.type==="click"&&n.currentTarget.classList.contains(is)?this.changeHandler(n):this.changeHandler()},t.prototype.clickHandler=function(e){var i=e.currentTarget;if(this.isPopupClicked=!0,i.classList.contains(is))if(this.isMultiSelection){var r=this.copyValues(this.values);r.toString().indexOf(this.getIdValue(e,null).toString())===-1?(r.push(this.getIdValue(e,null)),this.setProperties({values:r},!0),this.setProperties({value:this.values[this.values.length-1]},!0)):this.previousDates=!0}else this.setProperties({value:this.getIdValue(e,null)},!0);var n=this.currentView();s.prototype.clickHandler.call(this,e,this.value),this.isMultiSelection&&this.currentDate!==this.value&&!m(this.tableBodyElement.querySelectorAll("."+Er)[0])&&n==="Year"&&this.tableBodyElement.querySelectorAll("."+Er)[0].classList.remove(Er)},t.prototype.switchView=function(e,i,r,n){s.prototype.switchView.call(this,e,i,this.isMultiSelection,n)},t.prototype.getModuleName=function(){return s.prototype.getModuleName.call(this),"calendar"},t.prototype.getPersistData=function(){s.prototype.getPersistData.call(this);var e=["value","values"];return this.addOnPersist(e)},t.prototype.onPropertyChanged=function(e,i){this.effect="",this.rangeValidation(this.min,this.max);for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];switch(a){case"value":this.isDateSelected&&(typeof e.value=="string"?this.setProperties({value:new Date(this.checkValue(e.value))},!0):e.value=new Date(this.checkValue(e.value)),isNaN(+this.value)&&this.setProperties({value:i.value},!0),this.update());break;case"values":if(this.isDateSelected){if(typeof e.values=="string"||typeof e.values=="number")this.setProperties({values:null},!0);else{for(var o=this.copyValues(this.values),l=0;l<o.length;l++){var h=o[l];this.checkDateValue(h)&&!s.prototype.checkPresentDate.call(this,h,o)&&o.push(h)}this.setProperties({values:o},!0),this.values.length>0&&this.setProperties({value:e.values[e.values.length-1]},!0)}this.validateValues(this.isMultiSelection,this.values),this.update()}break;case"isMultiSelection":this.isDateSelected&&(this.setProperties({isMultiSelection:e.isMultiSelection},!0),this.update());break;case"enabled":this.setEnable(this.enabled);break;case"cssClass":this.getModuleName()==="calendar"&&this.setClass(e.cssClass,i.cssClass);break;default:s.prototype.onPropertyChanged.call(this,e,i,this.isMultiSelection,this.values)}}this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange},t.prototype.destroy=function(){if(s.prototype.destroy.call(this),this.getModuleName()==="calendar"){this.changedArgs=null;var e=X(this.element,"form");e&&R.remove(e,"reset",this.formResetHandler.bind(this))}},t.prototype.navigateTo=function(e,i,r){this.minMaxUpdate(),s.prototype.navigateTo.call(this,e,i,r)},t.prototype.currentView=function(){return s.prototype.currentView.call(this)},t.prototype.addDate=function(e){if(typeof e!="string"&&typeof e!="number"){var i=this.copyValues(this.values);if(typeof e=="object"&&e.length>0)for(var r=e,n=0;n<r.length;n++)this.checkDateValue(r[n])&&!s.prototype.checkPresentDate.call(this,r[n],i)&&(!m(i)&&i.length>0?i.push(r[n]):i=[new Date(+r[n])]);else this.checkDateValue(e)&&!s.prototype.checkPresentDate.call(this,e,i)&&(!m(i)&&i.length>0?i.push(e):i=[new Date(+e)]);this.setProperties({values:i},!0),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.validateValues(this.isMultiSelection,i),this.update(),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}},t.prototype.removeDate=function(e){if(typeof e!="string"&&typeof e!="number"&&!m(this.values)&&this.values.length>0){var i=this.copyValues(this.values);if(typeof e=="object"&&e.length>0)for(var r=e,n=0;n<r.length;n++)for(var a=0;a<i.length;a++)+i[a]==+r[n]&&i.splice(a,1);else for(var a=0;a<i.length;a++)+i[a]==+e&&i.splice(a,1);this.setProperties({values:i},!1),this.update(),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}},t.prototype.setTodayDate=function(e){var i=new Date(+e);this.setProperties({value:i},!0),s.prototype.todayButtonClick.call(this,null,i,!0)},t.prototype.update=function(){this.validateDate(),this.minMaxUpdate(),s.prototype.setValueUpdate.call(this)},t.prototype.selectDate=function(e,i,r){s.prototype.selectDate.call(this,e,i,r,this.isMultiSelection,this.values),this.isMultiSelection&&!m(this.values)&&this.values.length>0&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler(e)},t.prototype.changeEvent=function(e){((this.value&&this.value.valueOf())!==(this.previousDate&&+this.previousDate.valueOf())||this.isMultiSelection)&&(this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousDate=new Date(+this.value))},t.prototype.triggerChange=function(e){!m(this.todayButtonEvent)&&this.isTodayClicked&&(e=this.todayButtonEvent,this.isTodayClicked=!1),this.changedArgs.event=e||null,this.changedArgs.isInteracted=!m(e),m(this.value)||this.setProperties({value:this.value},!0),!this.isMultiSelection&&+this.value!==Number.NaN&&(!m(this.value)&&!m(this.previousDate)||this.previousDate===null&&!isNaN(+this.value))?this.changeEvent(e):!m(this.values)&&this.previousValues!==this.values.length&&(this.changeEvent(e),this.previousValues=this.values.length)},Jt([O(null)],t.prototype,"value",void 0),Jt([O(null)],t.prototype,"values",void 0),Jt([O(!1)],t.prototype,"isMultiSelection",void 0),Jt([Se()],t.prototype,"change",void 0),t=Jt([Wi],t),t}(N3),P3=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),_t=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},B3="e-date-wrapper",_u="e-datepicker",H3="e-lib",V3="e-control",gy="e-popup-wrapper",W3="e-input-group-icon",z3="e-popup",j3="e-input-group",Dd="e-input-focus",U3="e-input",by="e-error",Fu="e-active",yy="e-date-overflow",$3="e-date-icon",q3="e-icons",G3=300,X3=4,Nu="e-selected",K3="e-focused-date",Ld="e-non-edit",xy=["title","class","style"],Mu=function(s){P3(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.isDateIconClicked=!1,r.isAltKeyPressed=!1,r.isInteracted=!0,r.invalidValueString=null,r.checkPreviousValue=null,r.maskedDateValue="",r.preventChange=!1,r.isIconClicked=!1,r.isDynamicValueChanged=!1,r.moduleName=r.getModuleName(),r.isFocused=!1,r.isBlur=!1,r.isKeyAction=!1,r.datepickerOptions=e,r}return t.prototype.render=function(){this.initialize(),this.bindEvents(),this.floatLabelType!=="Never"&&Te.calculateWidth(this.inputElement,this.inputWrapper.container),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon"),!m(X(this.element,"fieldset"))&&X(this.element,"fieldset").disabled&&(this.enabled=!1),this.renderComplete(),this.setTimeZone(this.serverTimezoneOffset)},t.prototype.setTimeZone=function(e){if(!m(this.serverTimezoneOffset)&&this.value){var i=new Date().getTimezoneOffset()/60,r=e,n=r+i;n=this.isDayLightSaving()?n--:n,this.value=new Date(this.value.getTime()+n*60*60*1e3),this.updateInput(),this.changeTrigger(null)}},t.prototype.isDayLightSaving=function(){var e=new Date(this.value.getFullYear(),0,1).getTimezoneOffset(),i=new Date(this.value.getFullYear(),6,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(e,i)},t.prototype.setAllowEdit=function(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):Pe(this.inputElement,{readonly:""}),this.updateIconState()},t.prototype.updateIconState=function(){!this.allowEdit&&this.inputWrapper&&!this.readonly?this.inputElement.value===""?Z([this.inputWrapper.container],[Ld]):P([this.inputWrapper.container],[Ld]):this.inputWrapper&&Z([this.inputWrapper.container],[Ld])},t.prototype.initialize=function(){this.checkInvalidValue(this.value),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"}),this.createInput(),this.updateHtmlAttributeToWrapper(),this.setAllowEdit(),this.enableMask&&!this.value&&this.maskedDateValue&&(this.floatLabelType==="Always"||!this.floatLabelType||!this.placeholder)?(this.updateInput(!0),this.updateInputValue(this.maskedDateValue)):this.enableMask||this.updateInput(!0),this.previousElementValue=this.inputElement.value,this.previousDate=m(this.value)?null:new Date(+this.value),this.inputElement.setAttribute("value",this.inputElement.value),this.inputValueCopy=this.value},t.prototype.createInput=function(){var e={"aria-atomic":"true","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-invalid":"false"};if(this.getModuleName()==="datepicker"){var i={placeholder:this.placeholder};this.globalize=new Ji(this.locale),this.l10n=new br("datepicker",i,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0)}this.fullScreenMode&&xe.isDevice&&(this.cssClass+=" e-popup-expand");var r=this.cssClass;!m(this.cssClass)&&this.cssClass!==""&&(r=this.cssClass.replace(/\s+/g," ").trim());var n=!this.enableMask;this.inputWrapper=Te.createInput({element:this.inputElement,floatLabelType:this.floatLabelType,bindClearAction:n,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:r,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:[W3+" "+$3+" "+q3]},this.createElement),this.setWidth(this.width),this.inputElement.name!==""?this.inputElement.setAttribute("name",""+this.inputElement.getAttribute("name")):this.inputElement.setAttribute("name",""+this.element.id),Pe(this.inputElement,e),this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName()),this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1),Te.addAttributes({"aria-label":"select",role:"button"},this.inputWrapper.buttons[0]),P([this.inputWrapper.container],B3)},t.prototype.updateInput=function(e,i){e===void 0&&(e=!1),i===void 0&&(i=!1);var r;if(this.value&&!this.isCalendar()&&this.disabledDates(e,i),isNaN(+new Date(this.checkValue(this.value)))&&this.setProperties({value:null},!0),this.strictMode&&(s.prototype.validateDate.call(this),this.minMaxUpdates(),s.prototype.minMaxUpdate.call(this)),!m(this.value)){var n=this.value,a=void 0,o=m(this.formatString)?this.dateTimeFormat:this.formatString;if(this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?a=this.globalize.formatDate(this.value,{format:o,type:"dateTime",skeleton:"yMd"}):a=this.globalize.formatDate(this.value,{format:o,type:"dateTime",skeleton:"yMd",calendar:"islamic"}):(this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},a=this.globalize.formatDate(this.value,r)),+n<=+this.max&&+n>=+this.min)this.updateInputValue(a);else{var l=+n>=+this.max||!+this.value||!+this.value||+n<=+this.min;!this.strictMode&&l&&this.updateInputValue(a)}}m(this.value)&&this.strictMode&&(this.enableMask?(this.updateInputValue(this.maskedDateValue),this.notify("createMask",{module:"MaskedDateTime"})):this.updateInputValue("")),!this.strictMode&&m(this.value)&&this.invalidValueString&&this.updateInputValue(this.invalidValueString),this.changedArgs={value:this.value},this.errorClass(),this.updateIconState()},t.prototype.minMaxUpdates=function(){!m(this.value)&&this.value<this.min&&this.min<=this.max&&this.strictMode?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!m(this.value)&&this.value>this.max&&this.min<=this.max&&this.strictMode&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})},t.prototype.checkStringValue=function(e){var i=null,r=null,n=null;if(this.getModuleName()==="datetimepicker"){var a=new Ji(this.locale);this.calendarMode==="Gregorian"?(r={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd"},n={format:a.getDatePattern({skeleton:"yMd"}),type:"dateTime"}):(r={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},n={format:a.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};return i=this.checkDateValue(this.globalize.parseDate(this.getAmPmValue(e),r)),m(i)&&this.getModuleName()==="datetimepicker"&&(i=this.checkDateValue(this.globalize.parseDate(this.getAmPmValue(e),n))),i},t.prototype.checkInvalidValue=function(e){if(!(e instanceof Date)&&!m(e)){var i=null,r=e;if(typeof e=="number"&&(r=e.toString()),this.getModuleName()==="datetimepicker"){var n=new Ji(this.locale);this.calendarMode==="Gregorian"?(this.dateTimeFormat,n.getDatePattern({skeleton:"yMd"})):(this.dateTimeFormat,n.getDatePattern({skeleton:"yMd"}))}else this.calendarMode==="Gregorian"?this.formatString:this.formatString;var a=!1;if(typeof r!="string")r=null,a=!0;else if(typeof r=="string"&&(r=r.trim()),i=this.checkStringValue(r),!i){var o=null,l=null;o=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,l=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!o.test(r)&&!l.test(r)||/^[a-zA-Z0-9- ]*$/.test(r)||isNaN(+new Date(this.checkValue(r)))?a=!0:i=new Date(r)}a?(this.strictMode||(this.invalidValueString=r),this.setProperties({value:null},!0)):this.setProperties({value:i},!0)}},t.prototype.bindInputEvent=function(){(!m(this.formatString)||this.enableMask)&&(this.enableMask||this.formatString.indexOf("y")===-1?R.add(this.inputElement,"input",this.inputHandler,this):R.remove(this.inputElement,"input",this.inputHandler))},t.prototype.bindEvents=function(){R.add(this.inputWrapper.buttons[0],"mousedown",this.dateIconHandler,this),R.add(this.inputElement,"mouseup",this.mouseUpHandler,this),R.add(this.inputElement,"focus",this.inputFocusHandler,this),R.add(this.inputElement,"blur",this.inputBlurHandler,this),R.add(this.inputElement,"keyup",this.keyupHandler,this),this.enableMask&&R.add(this.inputElement,"keydown",this.keydownHandler,this),this.bindInputEvent(),R.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&R.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this),this.formElement&&R.add(this.formElement,"reset",this.resetFormHandler,this),this.defaultKeyConfigs=Ue(this.defaultKeyConfigs,this.keyConfigs),this.keyboardModules=new gr(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})},t.prototype.keydownHandler=function(e){switch(e.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":case"Home":case"End":case"Backspace":case"Delete":this.enableMask&&!this.popupObj&&!this.readonly&&(e.code!=="Delete"&&e.code!=="Backspace"&&e.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e}));break}},t.prototype.unBindEvents=function(){m(this.inputWrapper)||R.remove(this.inputWrapper.buttons[0],"mousedown",this.dateIconHandler),R.remove(this.inputElement,"mouseup",this.mouseUpHandler),R.remove(this.inputElement,"focus",this.inputFocusHandler),R.remove(this.inputElement,"blur",this.inputBlurHandler),R.remove(this.inputElement,"change",this.inputChangeHandler),R.remove(this.inputElement,"keyup",this.keyupHandler),this.enableMask&&R.remove(this.inputElement,"keydown",this.keydownHandler),this.showClearButton&&this.inputWrapper.clearButton&&R.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler),this.formElement&&R.remove(this.formElement,"reset",this.resetFormHandler)},t.prototype.resetFormHandler=function(){if(this.enabled&&!this.inputElement.disabled){var e=this.inputElement.getAttribute("value");(this.element.tagName==="EJS-DATEPICKER"||this.element.tagName==="EJS-DATETIMEPICKER")&&(e="",this.inputValueCopy=null,this.inputElement.setAttribute("value","")),this.setProperties({value:this.inputValueCopy},!0),this.restoreValue(),this.inputElement&&(this.updateInputValue(e),this.errorClass())}},t.prototype.restoreValue=function(){this.currentDate=this.value?this.value:new Date,this.previousDate=this.value,this.previousElementValue=m(this.inputValueCopy)?"":this.globalize.formatDate(this.inputValueCopy,{format:this.formatString,type:"dateTime",skeleton:"yMd"})},t.prototype.inputChangeHandler=function(e){this.enabled&&e.stopPropagation()},t.prototype.bindClearEvent=function(){this.showClearButton&&this.inputWrapper.clearButton&&R.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},t.prototype.resetHandler=function(e){this.enabled&&(e.preventDefault(),this.clear(e))},t.prototype.mouseUpHandler=function(e){this.enableMask&&(e.preventDefault(),this.notify("setMaskSelection",{module:"MaskedDateTime"}))},t.prototype.clear=function(e){this.setProperties({value:null},!0),this.enableMask||this.updateInputValue("");var i={event:e};if(this.trigger("cleared",i),this.invalidValueString="",this.updateInput(),this.popupUpdate(),this.changeEvent(e),this.enableMask&&this.notify("clearHandler",{module:"MaskedDateTime"}),X(this.element,"form")){var r=this.element,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}},t.prototype.preventEventBubbling=function(e){e.preventDefault(),this.interopAdaptor.invokeMethodAsync("OnDateIconClick")},t.prototype.updateInputValue=function(e){Te.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.dateIconHandler=function(e){this.enabled&&(this.isIconClicked=!0,xe.isDevice&&(this.inputElement.setAttribute("readonly",""),this.inputElement.blur()),e.preventDefault(),this.readonly||(this.isCalendar()?this.hide(e):(this.isDateIconClicked=!0,this.show(null,e),this.getModuleName()==="datetimepicker"&&this.inputElement.focus(),this.inputElement.focus(),P([this.inputWrapper.container],[Dd]),P(this.inputWrapper.buttons,Fu))),this.isIconClicked=!1)},t.prototype.updateHtmlAttributeToWrapper=function(){if(!m(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(!m(this.htmlAttributes[""+r])&&xy.indexOf(r)>-1)if(r==="class"){var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&P([this.inputWrapper.container],n.split(" "))}else if(r==="style"){var a=this.inputWrapper.container.getAttribute(r);m(a)?a=this.htmlAttributes[""+r]:a.charAt(a.length-1)===";"?a=a+this.htmlAttributes[""+r]:a=a+";"+this.htmlAttributes[""+r],this.inputWrapper.container.setAttribute(r,a)}else this.inputWrapper.container.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.updateHtmlAttributeToElement=function(){if(!m(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];xy.indexOf(r)<0&&this.inputElement.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.updateCssClass=function(e,i){m(i)||(i=i.replace(/\s+/g," ").trim()),m(e)||(e=e.replace(/\s+/g," ").trim()),Te.setCssClass(e,[this.inputWrapper.container],i),this.popupWrapper&&Te.setCssClass(e,[this.popupWrapper],i)},t.prototype.calendarKeyActionHandle=function(e){switch(e.action){case"escape":this.isCalendar()?this.hide(e):this.inputWrapper.container.children[this.index].blur();break;case"enter":this.isCalendar()?+this.value!=+this.currentDate&&!this.isCalendar()&&this.inputWrapper.container.children[this.index].focus():this.show(null,e),this.getModuleName()==="datetimepicker"&&this.inputElement.focus();break}},t.prototype.inputFocusHandler=function(){if(this.isFocused=!0,!!this.enabled){this.enableMask&&!this.inputElement.value&&this.placeholder&&this.maskedDateValue&&!this.value&&(this.floatLabelType==="Auto"||this.floatLabelType==="Never"||this.placeholder)&&(this.updateInputValue(this.maskedDateValue),this.inputElement.selectionStart=0,this.inputElement.selectionEnd=this.inputElement.value.length),this.enableMask&&this.showClearButton&&this.inputElement&&this.inputElement.value===this.maskedDateValue&&this.inputWrapper&&this.inputWrapper.clearButton&&!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")&&this.inputWrapper.clearButton.classList.add("e-clear-icon-hide");var e={model:this};this.isDateIconClicked=!1,this.trigger("focus",e),this.updateIconState(),this.openOnFocus&&!this.isIconClicked&&this.show()}},t.prototype.inputHandler=function(e){this.isPopupClicked=!1,this.enableMask&&(!m(e)&&!m(e.inputType)&&e.inputType==="insertFromPaste"?this.notify("maskPasteInputHandler",{module:"MaskedDateTime"}):this.notify("inputHandler",{module:"MaskedDateTime"}))},t.prototype.inputBlurHandler=function(e){if(this.enabled){if(this.strictModeUpdate(),this.inputElement.value===""&&m(this.value)&&(this.invalidValueString=null,this.updateInputValue("")),this.isBlur=!0,this.updateInput(!1,!0),this.isBlur=!1,this.popupUpdate(),this.changeTrigger(e),this.enableMask&&this.maskedDateValue&&this.placeholder&&this.floatLabelType!=="Always"&&this.inputElement.value===this.maskedDateValue&&!this.value&&(this.floatLabelType==="Auto"||this.floatLabelType==="Never"||this.placeholder)&&this.updateInputValue(""),this.errorClass(),this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(e),this.getModuleName()==="datepicker"){var i={model:this};this.trigger("blur",i)}this.isCalendar()&&(this.defaultKeyConfigs=Ue(this.defaultKeyConfigs,this.keyConfigs),this.calendarKeyboardModules=new gr(this.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:this.calendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})),this.isPopupClicked=!1}},t.prototype.documentHandler=function(e){!m(this.popupObj)&&!m(this.inputWrapper)&&(this.inputWrapper.container.contains(e.target)&&e.type!=="mousedown"||this.popupObj.element&&this.popupObj.element.contains(e.target))&&e.type!=="touchstart"&&e.preventDefault();var i=e.target;!X(i,".e-datepicker.e-popup-wrapper")&&!m(this.inputWrapper)&&X(i,"."+j3)!==this.inputWrapper.container&&!i.classList.contains("e-day")&&!i.classList.contains("e-dlg-overlay")?(this.hide(e),this.focusOut()):X(i,".e-datepicker.e-popup-wrapper")&&(i.classList.contains("e-day")&&!m(e.target.parentElement)&&e.target.parentElement.classList.contains("e-selected")&&X(i,".e-content")&&X(i,".e-content").classList.contains("e-"+this.depth.toLowerCase())?this.hide(e):X(i,".e-footer-container")&&i.classList.contains("e-today")&&i.classList.contains("e-btn")&&+new Date(+this.value)==+s.prototype.generateTodayVal.call(this,this.value)&&this.hide(e))},t.prototype.inputKeyActionHandle=function(e){var i=this.currentView();switch(e.action){case"altUpArrow":this.isAltKeyPressed=!1,this.hide(e),this.inputElement.focus();break;case"altDownArrow":this.isAltKeyPressed=!0,this.strictModeUpdate(),this.updateInput(),this.changeTrigger(e),this.getModuleName()==="datepicker"&&this.show(null,e);break;case"escape":this.hide(e);break;case"enter":this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass(),!this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(e),this.isCalendar()&&(e.preventDefault(),e.stopPropagation());break;case"tab":case"shiftTab":{var r=this.inputElement.selectionStart,n=this.inputElement.selectionEnd;if(this.enableMask&&!this.popupObj&&!this.readonly){var a=this.inputElement.value.length;(r===0&&n===a||n!==a&&e.action==="tab"||r!==0&&e.action==="shiftTab")&&e.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e}),r=this.inputElement.selectionStart,n=this.inputElement.selectionEnd}this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass(),this.enableMask&&(this.inputElement.selectionStart=r,this.inputElement.selectionEnd=n),e.action==="tab"&&e.target===this.inputElement&&this.isCalendar()&&document.activeElement===this.inputElement&&(e.preventDefault(),this.headerTitleElement.focus()),e.action==="shiftTab"&&e.target===this.inputElement&&this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(e);break}default:this.defaultAction(e),e.action==="select"&&i===this.depth&&this.hide(e)}},t.prototype.defaultAction=function(e){this.previousDate=!m(this.value)&&new Date(+this.value)||null,this.isCalendar()&&(s.prototype.keyActionHandle.call(this,e),this.isCalendar()&&Pe(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()}))},t.prototype.popupUpdate=function(){if((m(this.value)&&!m(this.previousDate)||this.getModuleName()!=="datetimepicker"&&+this.value!=+this.previousDate||this.getModuleName()==="datetimepicker"&&+this.value!=+this.previousDateTime)&&(this.popupObj&&this.popupObj.element.querySelectorAll("."+Nu).length>0&&Z(this.popupObj.element.querySelectorAll("."+Nu),[Nu]),!m(this.value)&&+this.value>=+this.min&&+this.value<=+this.max)){var e=new Date(this.checkValue(this.value));s.prototype.navigateTo.call(this,"Month",e)}},t.prototype.strictModeUpdate=function(){var e,i=/^y/,r=/[^a-zA-Z]/,n;if(this.getModuleName()==="datetimepicker"?e=m(this.formatString)?this.dateTimeFormat:this.formatString:(!i.test(this.formatString)||r.test(this.formatString))&&(e=m(this.formatString)?this.formatString:this.formatString.replace("dd","d")),m(e))e=this.formatString;else{var a=e.split("M").length-1;a<3&&(e=e.replace("MM","M"))}var o;this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?o={format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:o={format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:(this.calendarMode==="Gregorian"?n={format:e,type:"dateTime",skeleton:"yMd"}:n={format:e,type:"dateTime",skeleton:"yMd",calendar:"islamic"},o=n);var l;if(typeof this.inputElement.value=="string"&&(this.inputElement.value=this.inputElement.value.trim()),this.getModuleName()==="datetimepicker"){if(this.checkDateValue(this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),o))?l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),o):(this.calendarMode==="Gregorian"?n={format:e,type:"dateTime",skeleton:"yMd"}:n={format:e,type:"dateTime",skeleton:"yMd",calendar:"islamic"},l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),n)),(m(l)||typeof l=="object"&&isNaN(l.getTime()))&&!m(this.inputFormatsString))for(var h=0,u=this.inputFormatsString;h<u.length;h++){var c=u[h],f=void 0;if(this.calendarMode==="Gregorian"?f={format:c,type:"dateTime",skeleton:"yMd"}:f={format:c,type:"dateTime",skeleton:"yMd",calendar:"islamic"},l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),f),!m(l)&&l instanceof Date&&!isNaN(l.getTime()))break}}else{if(l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),o),(m(l)||typeof l=="object"&&isNaN(l.getTime()))&&!m(this.inputFormatsString))for(var d=0,p=this.inputFormatsString;d<p.length;d++){var v=p[d],f=void 0;if(this.calendarMode==="Gregorian"?f={format:v,type:"dateTime",skeleton:"yMd"}:f={format:v,type:"dateTime",skeleton:"yMd",calendar:"islamic"},l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),f),!m(l)&&l instanceof Date&&!isNaN(l.getTime()))break}l=!m(l)&&isNaN(+l)?null:l,!m(this.formatString)&&this.inputElement.value!==""&&this.strictMode&&(this.isPopupClicked||!this.isPopupClicked&&this.inputElement.value===this.previousElementValue)&&this.formatString.indexOf("y")===-1&&l.setFullYear(this.value.getFullYear())}this.getModuleName()==="datepicker"&&this.value&&!isNaN(+this.value)&&l&&l.setHours(this.value.getHours(),this.value.getMinutes(),this.value.getSeconds(),this.value.getMilliseconds()),this.strictMode&&l?(this.updateInputValue(this.globalize.formatDate(l,o)),this.inputElement.value!==this.previousElementValue&&this.setProperties({value:l},!0)):this.strictMode||this.inputElement.value!==this.previousElementValue&&this.setProperties({value:l},!0),this.strictMode&&!l&&this.inputElement.value===(this.enableMask?this.maskedDateValue:"")&&this.setProperties({value:null},!0),isNaN(+this.value)&&this.setProperties({value:null},!0),m(this.value)&&(this.currentDate=new Date(new Date().setHours(0,0,0,0)))},t.prototype.createCalendar=function(){var e=this;this.popupWrapper=this.createElement("div",{className:""+_u+" "+gy,id:this.inputElement.id+"_options"}),this.popupWrapper.setAttribute("aria-label",this.element.id),this.popupWrapper.setAttribute("role","dialog"),m(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass),xe.isDevice&&(this.modelHeader(),this.modal=this.createElement("div"),this.modal.className=""+_u+" e-date-modal",document.body.className+=" "+yy,this.modal.style.display="block",document.body.appendChild(this.modal)),this.calendarElement.querySelector("table tbody").className="",this.popupObj=new Bo(this.popupWrapper,{content:this.calendarElement,relateTo:xe.isDevice?document.body:this.inputWrapper.container,position:xe.isDevice?{X:"center",Y:"center"}:this.enableRtl?{X:"right",Y:"bottom"}:{X:"left",Y:"bottom"},offsetY:X3,targetType:"container",enableRtl:this.enableRtl,zIndex:this.zIndex,collision:xe.isDevice?{X:"fit",Y:"fit"}:this.enableRtl?{X:"fit",Y:"flip"}:{X:"flip",Y:"flip"},open:function(){xe.isDevice&&e.fullScreenMode&&(e.iconRight=parseInt(window.getComputedStyle(e.calendarElement.querySelector(".e-header.e-month .e-prev")).marginRight,10)>16,e.touchModule=new Dl(e.calendarElement.querySelector(".e-content.e-month"),{swipe:e.CalendarSwipeHandler.bind(e)}),R.add(e.calendarElement.querySelector(".e-content.e-month"),"touchstart",e.TouchStartHandler,e)),e.getModuleName()!=="datetimepicker"&&document.activeElement!==e.inputElement&&(e.defaultKeyConfigs=Ue(e.defaultKeyConfigs,e.keyConfigs),e.calendarElement.children[1].firstElementChild.focus(),e.calendarKeyboardModules=new gr(e.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:e.calendarKeyActionHandle.bind(e),keyConfigs:e.defaultKeyConfigs}),e.calendarKeyboardModules=new gr(e.inputWrapper.container.children[e.index],{eventName:"keydown",keyAction:e.calendarKeyActionHandle.bind(e),keyConfigs:e.defaultKeyConfigs}))},close:function(){e.isDateIconClicked&&e.inputWrapper.container.children[e.index].focus(),e.value&&e.disabledDates(),e.popupObj&&e.popupObj.destroy(),e.resetCalendar(),Oe(e.popupWrapper),e.popupObj=e.popupWrapper=null,e.preventArgs=null,e.calendarKeyboardModules=null,e.setAriaAttributes()},targetExitViewport:function(){xe.isDevice||e.hide()}}),this.popupObj.element.className+=" "+this.cssClass,this.setAriaAttributes()},t.prototype.getAmPmValue=function(e){try{return typeof e=="string"&&e.trim()!==""?e.replace(/(am|pm|Am|aM|pM|Pm)/g,function(i){return i.toLocaleUpperCase()}):""}catch(i){return console.error("Error occurred while processing date:",i),""}},t.prototype.CalendarSwipeHandler=function(e){var i=0;if(this.iconRight)switch(e.swipeDirection){case"Left":i=1;break;case"Right":i=-1;break}else switch(e.swipeDirection){case"Up":i=1;break;case"Down":i=-1;break}this.touchStart&&(i===1?this.navigateNext(e):i===-1&&this.navigatePrevious(e),this.touchStart=!1)},t.prototype.TouchStartHandler=function(e){this.touchStart=!0},t.prototype.setAriaDisabled=function(){this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1)},t.prototype.modelHeader=function(){var e,i=this.createElement("div",{className:"e-model-header"}),r=this.createElement("h1",{className:"e-model-year"}),n=this.createElement("div"),a=this.createElement("span",{className:"e-model-day"}),o=this.createElement("span",{className:"e-model-month"});if(this.calendarMode==="Gregorian"?e={format:"y",skeleton:"dateTime"}:e={format:"y",skeleton:"dateTime",calendar:"islamic"},r.textContent=""+this.globalize.formatDate(this.value||new Date,e),this.calendarMode==="Gregorian"?e={format:"E",skeleton:"dateTime"}:e={format:"E",skeleton:"dateTime",calendar:"islamic"},a.textContent=""+this.globalize.formatDate(this.value||new Date,e)+", ",this.calendarMode==="Gregorian"?e={format:"MMM d",skeleton:"dateTime"}:e={format:"MMM d",skeleton:"dateTime",calendar:"islamic"},o.textContent=""+this.globalize.formatDate(this.value||new Date,e),this.fullScreenMode){var l=this.createElement("span",{className:"e-popup-close"});R.add(l,"mousedown touchstart",this.modelCloseHandler,this);var h=this.calendarElement.querySelector("button.e-today");n.classList.add("e-day-wrapper"),h.classList.add("e-outline"),i.appendChild(l),i.appendChild(h)}this.fullScreenMode||i.appendChild(r),n.appendChild(a),n.appendChild(o),i.appendChild(n),this.calendarElement.insertBefore(i,this.calendarElement.firstElementChild)},t.prototype.modelCloseHandler=function(e){this.hide()},t.prototype.changeTrigger=function(e){this.inputElement.value!==this.previousElementValue&&(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.isDynamicValueChanged&&this.isCalendar()&&this.popupUpdate(),this.changedArgs.value=this.value,this.changedArgs.event=e||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=!m(e),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousElementValue=this.inputElement.value,this.previousDate=isNaN(+new Date(this.checkValue(this.value)))?null:new Date(this.checkValue(this.value)),this.isInteracted=!0),this.isKeyAction=!1},t.prototype.navigatedEvent=function(e){Ue(this.navigatedArgs,{name:"navigated",event:e}),this.trigger("navigated",this.navigatedArgs)},t.prototype.keyupHandler=function(e){this.isKeyAction=this.inputElement.value!==this.previousElementValue,this.enableMask&&this.showClearButton&&this.inputElement&&this.inputElement.value===this.maskedDateValue&&this.inputWrapper&&this.inputWrapper.clearButton&&!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")&&this.inputWrapper.clearButton.classList.add("e-clear-icon-hide")},t.prototype.changeEvent=function(e){!this.isIconClicked&&!(this.isBlur||this.isKeyAction)&&this.selectCalendar(e),(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())?(this.changedArgs.event=e||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=this.isInteracted,this.isDynamicValueChanged||this.trigger("change",this.changedArgs),this.previousDate=this.value&&new Date(+this.value),this.isDynamicValueChanged||this.hide(e),this.previousElementValue=this.inputElement.value,this.errorClass()):e&&this.hide(e),this.isKeyAction=!1},t.prototype.requiredModules=function(){var e=[];return this.calendarMode==="Islamic"&&e.push({args:[this],member:"islamic",name:"Islamic"}),this.enableMask&&e.push({args:[this],member:"MaskedDateTime"}),e},t.prototype.selectCalendar=function(e){var i,r,n;this.getModuleName()==="datetimepicker"?r=m(this.formatString)?this.dateTimeFormat:this.formatString:r=this.formatString,this.value&&(this.getModuleName()==="datetimepicker"?(this.calendarMode==="Gregorian"?n={format:r,type:"dateTime",skeleton:"yMd"}:n={format:r,type:"dateTime",skeleton:"yMd",calendar:"islamic"},i=this.globalize.formatDate(this.changedArgs.value,n)):(this.calendarMode==="Gregorian"?n={format:this.formatString,type:"dateTime",skeleton:"yMd"}:n={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},i=this.globalize.formatDate(this.changedArgs.value,n)),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"})),m(i)||(this.updateInputValue(i),this.enableMask&&this.notify("setMaskSelection",{module:"MaskedDateTime"}))},t.prototype.isCalendar=function(){return!!(this.popupWrapper&&this.popupWrapper.classList.contains(""+gy))},t.prototype.setWidth=function(e){typeof e=="number"?this.inputWrapper.container.style.width=st(this.width):typeof e=="string"?this.inputWrapper.container.style.width=e.match(/px|%|em/)?this.width:st(this.width):this.inputWrapper.container.style.width="100%"},t.prototype.show=function(e,i){var r=this;if(!(this.enabled&&this.readonly||!this.enabled||this.popupObj)){var n=!0,a=void 0;!m(this.value)&&!(+this.value>=+new Date(this.checkValue(this.min))&&+this.value<=+new Date(this.checkValue(this.max)))?(a=new Date(this.checkValue(this.value)),this.setProperties({value:null},!0)):a=this.value||null,this.isCalendar()||(s.prototype.render.call(this),this.setProperties({value:a||null},!0),this.previousDate=a,this.createCalendar()),xe.isDevice&&(this.mobilePopupWrapper=this.createElement("div",{className:"e-datepick-mob-popup-wrap"}),document.body.appendChild(this.mobilePopupWrapper)),this.preventArgs={preventDefault:function(){n=!1},popup:this.popupObj,event:i||null,cancel:!1,appendTo:xe.isDevice?this.mobilePopupWrapper:document.body};var o=this.preventArgs;this.trigger("open",o,function(l){if(r.preventArgs=l,n&&!r.preventArgs.cancel){P(r.inputWrapper.buttons,Fu),r.preventArgs.appendTo.appendChild(r.popupWrapper),r.popupObj.refreshPosition(r.inputElement);var h={name:"FadeIn",duration:xe.isDevice?0:G3};if(r.zIndex===1e3?r.popupObj.show(new vr(h),r.element):r.popupObj.show(new vr(h),null),s.prototype.setOverlayIndex.call(r,r.mobilePopupWrapper,r.popupObj.element,r.modal,xe.isDevice),r.setAriaAttributes(),xe.isDevice){var u=r.createElement("div",{className:"e-dlg-overlay"});u.style.zIndex=(r.zIndex-1).toString(),r.mobilePopupWrapper.appendChild(u)}}else r.popupObj.destroy(),r.popupWrapper=r.popupObj=null;!m(r.inputElement)&&r.inputElement.value===""&&!m(r.tableBodyElement)&&r.tableBodyElement.querySelectorAll("td.e-selected").length>0&&(P([r.tableBodyElement.querySelector("td.e-selected")],K3),Z(r.tableBodyElement.querySelectorAll("td.e-selected"),Nu)),R.add(document,"mousedown touchstart",r.documentHandler,r)})}},t.prototype.hide=function(e){var i=this;if(m(this.popupWrapper))xe.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit();else{var r=!0;this.preventArgs={preventDefault:function(){r=!1},popup:this.popupObj,event:e||null,cancel:!1},Z(this.inputWrapper.buttons,Fu),Z([document.body],yy);var n=this.preventArgs;this.isCalendar()?this.trigger("close",n,function(a){i.closeEventCallback(r,a)}):this.closeEventCallback(r,n)}},t.prototype.closeEventCallback=function(e,i){this.preventArgs=i,this.isCalendar()&&e&&!this.preventArgs.cancel&&(this.popupObj.hide(),this.isAltKeyPressed=!1,this.keyboardModule.destroy(),Z(this.inputWrapper.buttons,Fu)),this.setAriaAttributes(),xe.isDevice&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null),xe.isDevice&&!m(this.mobilePopupWrapper)&&e&&(m(this.preventArgs)||!this.preventArgs.cancel)&&(this.mobilePopupWrapper.remove(),this.mobilePopupWrapper=null),R.remove(document,"mousedown touchstart",this.documentHandler),xe.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},t.prototype.focusIn=function(e){document.activeElement!==this.inputElement&&this.enabled&&(this.inputElement.focus(),P([this.inputWrapper.container],[Dd]))},t.prototype.focusOut=function(){document.activeElement===this.inputElement&&(Z([this.inputWrapper.container],[Dd]),this.inputElement.blur())},t.prototype.currentView=function(){var e;return this.calendarElement&&(e=s.prototype.currentView.call(this)),e},t.prototype.navigateTo=function(e,i){this.calendarElement&&s.prototype.navigateTo.call(this,e,i)},t.prototype.destroy=function(){this.unBindEvents(),this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),s.prototype.destroy.call(this),Te.destroy({element:this.inputElement,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),m(this.keyboardModules)||this.keyboardModules.destroy(),this.popupObj&&this.popupObj.element.classList.contains(z3)&&s.prototype.destroy.call(this);var e={"aria-atomic":"true","aria-disabled":"true","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"};this.inputElement.hasAttribute("aria-label")&&this.inputElement.removeAttribute("aria-label"),this.inputElement&&(Te.removeAttributes(e,this.inputElement),m(this.inputElementCopy.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),R.remove(this.inputElement,"blur",this.inputBlurHandler),R.remove(this.inputElement,"focus",this.inputFocusHandler),this.ensureInputAttribute()),this.isCalendar()&&(this.popupWrapper&&Oe(this.popupWrapper),this.popupObj=this.popupWrapper=null,this.keyboardModule.destroy()),this.ngTag===null&&(this.inputElement&&(m(this.inputWrapper)||this.inputWrapper.container.insertAdjacentElement("afterend",this.inputElement),Z([this.inputElement],[U3])),Z([this.element],[_u]),m(this.inputWrapper)||Oe(this.inputWrapper.container)),this.formElement&&R.remove(this.formElement,"reset",this.resetFormHandler),this.inputWrapper=null,this.keyboardModules=null},t.prototype.ensureInputAttribute=function(){for(var e=[],i=0;i<this.inputElement.attributes.length;i++)e[i]=this.inputElement.attributes[i].name;for(var i=0;i<e.length;i++)m(this.inputElementCopy.getAttribute(e[i]))?(e[i].toLowerCase()==="value"&&(this.inputElement.value=""),this.inputElement.removeAttribute(e[i])):(e[i].toLowerCase()==="value"&&(this.inputElement.value=this.inputElementCopy.getAttribute(e[i])),this.inputElement.setAttribute(e[i],this.inputElementCopy.getAttribute(e[i])))},t.prototype.preRender=function(){this.inputElementCopy=this.element.cloneNode(!0),Z([this.inputElementCopy],[_u,V3,H3]),this.inputElement=this.element,this.formElement=X(this.inputElement,"form"),this.index=this.showClearButton?2:1,this.ngTag=null,(this.element.tagName==="EJS-DATEPICKER"||this.element.tagName==="EJS-DATETIMEPICKER")&&(this.ngTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.element.getAttribute("id")?this.ngTag!==null&&(this.inputElement.id=this.element.getAttribute("id")+"_input"):this.getModuleName()==="datetimepicker"?(this.element.id=fi("ej2-datetimepicker"),this.ngTag!==null&&Pe(this.inputElement,{id:this.element.id+"_input"})):(this.element.id=fi("ej2-datepicker"),this.ngTag!==null&&Pe(this.inputElement,{id:this.element.id+"_input"})),this.ngTag!==null&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement(),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.checkHtmlAttributes(!1),this.inputFormats&&this.checkInputFormats(),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),s.prototype.preRender.call(this)},t.prototype.getDefaultKeyConfig=function(){return this.defaultKeyConfigs={altUpArrow:"alt+uparrow",altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",shiftTab:"shift+tab",tab:"tab"},this.defaultKeyConfigs},t.prototype.validationAttribute=function(e,i){var r=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");i.setAttribute("name",r),e.removeAttribute("name");for(var n=["required","aria-required","form"],a=0;a<n.length;a++)if(!m(e.getAttribute(n[a]))){var o=e.getAttribute(n[a]);i.setAttribute(n[a],o),e.removeAttribute(n[a])}},t.prototype.checkFormat=function(){var e=new Ji(this.locale);if(this.format)if(typeof this.format=="string")this.formatString=this.format;else if(this.format.skeleton!==""&&!m(this.format.skeleton)){var i=this.format.skeleton;this.getModuleName()==="datetimepicker"?this.formatString=e.getDatePattern({skeleton:i,type:"dateTime"}):this.formatString=e.getDatePattern({skeleton:i,type:"date"})}else this.getModuleName()==="datetimepicker"?this.formatString=this.dateTimeFormat:this.formatString=null;else this.formatString=null},t.prototype.checkInputFormats=function(){var e=new Ji(this.locale);if(this.inputFormatsString=[],this.inputFormats){for(var i=0,r=this.inputFormats;i<r.length;i++){var n=r[i],a="";if(typeof n=="string")a=n;else if(n.skeleton!==""&&!m(n.skeleton)){var o=n.skeleton;this.getModuleName()==="datetimepicker"?a=e.getDatePattern({skeleton:o,type:"dateTime"}):a=e.getDatePattern({skeleton:o,type:"date"})}a&&this.inputFormatsString.push(a)}this.inputFormatsString.length===0&&(this.inputFormatsString=null)}else this.inputFormatsString=null},t.prototype.checkHtmlAttributes=function(e){this.globalize=new Ji(this.locale),this.checkFormat(),this.checkView();var i=e?m(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","disabled","readonly","style","name","placeholder","type"],r;this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?r={format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};for(var n=0,a=i;n<a.length;n++){var o=a[n];if(!m(this.inputElement.getAttribute(o)))switch(o){case"disabled":if(m(this.datepickerOptions)||this.datepickerOptions.enabled===void 0||e){var l=!(this.inputElement.getAttribute(o)==="disabled"||this.inputElement.getAttribute(o)===""||this.inputElement.getAttribute(o)==="true");this.setProperties({enabled:l},!e)}break;case"readonly":if(m(this.datepickerOptions)||this.datepickerOptions.readonly===void 0||e){var h=this.inputElement.getAttribute(o)==="readonly"||this.inputElement.getAttribute(o)===""||this.inputElement.getAttribute(o)==="true";this.setProperties({readonly:h},!e)}break;case"placeholder":(m(this.datepickerOptions)||this.datepickerOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(o)},!e);break;case"style":this.inputElement.setAttribute("style",""+this.inputElement.getAttribute(o));break;case"name":this.inputElement.setAttribute("name",""+this.inputElement.getAttribute(o));break;case"value":if(m(this.datepickerOptions)||this.datepickerOptions.value===void 0||e){var u=this.inputElement.getAttribute(o);this.setProperties(It(o,this.globalize.parseDate(this.getAmPmValue(u),r),{}),!e)}break;case"min":if(+this.min==+new Date(1900,0,1)||e){var c=this.inputElement.getAttribute(o);this.setProperties(It(o,this.globalize.parseDate(this.getAmPmValue(c),r),{}),!e)}break;case"max":if(+this.max==+new Date(2099,11,31)||e){var f=this.inputElement.getAttribute(o);this.setProperties(It(o,this.globalize.parseDate(this.getAmPmValue(f),r),{}),!e)}break;case"type":this.inputElement.getAttribute(o)!=="text"&&this.inputElement.setAttribute("type","text");break}}},t.prototype.getModuleName=function(){return"datepicker"},t.prototype.disabledDates=function(e,i){e===void 0&&(e=!1),i===void 0&&(i=!1);var r,n,a=this.checkDateValue(this.value)?new Date(+this.value):new Date(this.checkValue(this.value)),o=this.previousDate;this.minMaxUpdates(),(!e||e&&!m(this.renderDayCell))&&s.prototype.render.call(this),this.previousDate=o;var l=a&&+a,h='*[id^="/id"]'.replace("/id",""+l);this.strictMode||(typeof this.value=="string"||typeof this.value=="object"&&+this.value!=+a)&&this.setProperties({value:a},!0),!m(this.calendarElement)&&!m(this.calendarElement.querySelectorAll(h)[0])&&this.calendarElement.querySelectorAll(h)[0].classList.contains("e-disabled")&&(this.strictMode||(this.currentDate=new Date(new Date().setHours(0,0,0,0))));var u;this.getModuleName()==="datetimepicker"?(this.calendarMode==="Gregorian"?n=this.globalize.formatDate(a,{format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}):n=this.globalize.formatDate(a,{format:m(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),u=n):(this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},u=this.globalize.formatDate(a,r)),this.popupObj||(this.updateInputValue(u),this.enableMask&&(this.updateInputValue(this.maskedDateValue),this.notify("createMask",{module:"MaskedDateTime",isBlur:i})))},t.prototype.setAriaAttributes=function(){this.isCalendar()?(Te.addAttributes({"aria-expanded":"true"},this.inputElement),Pe(this.inputElement,{"aria-owns":this.inputElement.id+"_options"}),Pe(this.inputElement,{"aria-controls":this.inputElement.id}),this.value&&Pe(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()})):(Te.addAttributes({"aria-expanded":"false"},this.inputElement),this.inputElement.removeAttribute("aria-owns"),this.inputElement.removeAttribute("aria-controls"),this.inputElement.removeAttribute("aria-activedescendant"))},t.prototype.errorClass=function(){var e='*[id^="/id"]'.replace("/id",""+ +this.value),i=this.calendarElement&&this.calendarElement.querySelectorAll(e)[0]&&this.calendarElement.querySelectorAll(e)[0].classList.contains("e-disabled");!m(this.value)&&!m(this.min)&&!m(this.max)&&!(new Date(this.value).setMilliseconds(0)>=new Date(this.min).setMilliseconds(0)&&new Date(this.value).setMilliseconds(0)<=new Date(this.max).setMilliseconds(0))||!this.strictMode&&this.inputElement.value!==""&&this.inputElement.value!==this.maskedDateValue&&m(this.value)||i||!this.isValidTime(this.value)?(P([this.inputWrapper.container],by),Pe(this.inputElement,{"aria-invalid":"true"})):m(this.inputWrapper)||(Z([this.inputWrapper.container],by),Pe(this.inputElement,{"aria-invalid":"false"}))},t.prototype.isValidTime=function(e){return!0},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r],o=["blur","change","cleared","close","created","destroyed","focus","navigated","open","renderDayCell"];switch(o.indexOf(a)>0&&this.isReact&&(this.isDynamicValueChanged=!0),a){case"value":this.isDynamicValueChanged=!0,this.isInteracted=!1,this.invalidValueString=null,this.checkInvalidValue(e.value),e.value=this.value,this.previousElementValue=this.inputElement.value,m(this.value)&&(this.enableMask?this.updateInputValue(this.maskedDateValue):this.updateInputValue(""),this.currentDate=new Date(new Date().setHours(0,0,0,0))),this.updateInput(!0),+this.previousDate!=+this.value&&this.changeTrigger(null),this.isInteracted=!0,this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange,this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"format":this.checkFormat(),this.bindInputEvent(),this.updateInput(),this.enableMask&&(this.notify("createMask",{module:"MaskedDateTime"}),this.value||this.updateInputValue(this.maskedDateValue));break;case"inputFormats":this.checkInputFormats();break;case"allowEdit":this.setAllowEdit();break;case"placeholder":Te.setPlaceholder(this.placeholder,this.inputElement);break;case"readonly":Te.setReadonly(this.readonly,this.inputElement);break;case"enabled":Te.setEnabled(this.enabled,this.inputElement),this.setAriaDisabled();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkHtmlAttributes(!0);break;case"locale":this.globalize=new Ji(this.locale),this.l10n.setLocale(this.locale),this.datepickerOptions&&this.datepickerOptions.placeholder==null&&(this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),Te.setPlaceholder(this.placeholder,this.inputElement)),this.updateInput(),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"enableRtl":Te.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"start":case"depth":this.checkView(),this.calendarElement&&s.prototype.onPropertyChanged.call(this,e,i);break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0);break;case"cssClass":this.updateCssClass(e.cssClass,i.cssClass);break;case"showClearButton":Te.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent(),this.index=this.showClearButton?2:1;break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(e.width),Te.calculateWidth(this.inputElement,this.inputWrapper.container),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"floatLabelType":this.floatLabelType=e.floatLabelType,Te.removeFloating(this.inputWrapper),Te.addFloating(this.inputElement,this.floatLabelType,this.placeholder),!m(this.inputWrapper.buttons[0])&&!m(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"enableMask":this.enableMask?(this.notify("createMask",{module:"MaskedDateTime"}),this.updateInputValue(this.maskedDateValue),this.bindInputEvent()):this.inputElement.value===this.maskedDateValue&&this.updateInputValue("");break;default:this.calendarElement&&this.isCalendar()&&s.prototype.onPropertyChanged.call(this,e,i),a==="min"&&m(this.min)&&(this.min=new Date(1900,0,1)),a==="max"&&m(this.max)&&(this.max=new Date(2099,11,31));break}this.isDynamicValueChanged||this.hide(null),this.isDynamicValueChanged=!1}},t.prototype.addDate=function(e){},_t([O(null)],t.prototype,"width",void 0),_t([O(null)],t.prototype,"value",void 0),_t([O(null)],t.prototype,"cssClass",void 0),_t([O(!1)],t.prototype,"strictMode",void 0),_t([O(null)],t.prototype,"format",void 0),_t([O(null)],t.prototype,"inputFormats",void 0),_t([O(!0)],t.prototype,"enabled",void 0),_t([O(!1)],t.prototype,"fullScreenMode",void 0),_t([O({})],t.prototype,"htmlAttributes",void 0),_t([O(null)],t.prototype,"values",void 0),_t([O(!1)],t.prototype,"isMultiSelection",void 0),_t([O(!0)],t.prototype,"showClearButton",void 0),_t([O(!0)],t.prototype,"allowEdit",void 0),_t([O(null)],t.prototype,"keyConfigs",void 0),_t([O(!1)],t.prototype,"enablePersistence",void 0),_t([O(1e3)],t.prototype,"zIndex",void 0),_t([O(!1)],t.prototype,"readonly",void 0),_t([O(null)],t.prototype,"placeholder",void 0),_t([O("Never")],t.prototype,"floatLabelType",void 0),_t([O(null)],t.prototype,"serverTimezoneOffset",void 0),_t([O(!1)],t.prototype,"openOnFocus",void 0),_t([O(!1)],t.prototype,"enableMask",void 0),_t([O({day:"day",month:"month",year:"year",hour:"hour",minute:"minute",second:"second",dayOfTheWeek:"day of the week"})],t.prototype,"maskPlaceholder",void 0),_t([Se()],t.prototype,"open",void 0),_t([Se()],t.prototype,"cleared",void 0),_t([Se()],t.prototype,"close",void 0),_t([Se()],t.prototype,"blur",void 0),_t([Se()],t.prototype,"focus",void 0),_t([Se()],t.prototype,"created",void 0),_t([Se()],t.prototype,"destroyed",void 0),t=_t([Wi],t),t}(M3),Oh=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Cr=function(){return Cr=Object.assign||function(s){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=t[r])}return s},Cr.apply(this,arguments)},Ge=function(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var o=s.length-1;o>=0;o--)(a=s[o])&&(n=(r<3?a(n):r>3?a(t,e,n):a(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n};(function(s){Oh(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return Ge([O(null)],t.prototype,"field",void 0),Ge([O(null)],t.prototype,"label",void 0),Ge([O(null)],t.prototype,"type",void 0),Ge([O(null)],t.prototype,"values",void 0),Ge([O(null)],t.prototype,"operators",void 0),Ge([O()],t.prototype,"ruleTemplate",void 0),Ge([O(null)],t.prototype,"template",void 0),Ge([O({isRequired:!0,min:0,max:Number.MAX_VALUE})],t.prototype,"validation",void 0),Ge([O(null)],t.prototype,"format",void 0),Ge([O(null)],t.prototype,"step",void 0),Ge([O(null)],t.prototype,"value",void 0),Ge([O(null)],t.prototype,"category",void 0),Ge([O(null)],t.prototype,"columns",void 0),t})(Ir);var Y3=function(s){Oh(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return Ge([O(null)],t.prototype,"condition",void 0),Ge([_1([],t)],t.prototype,"rules",void 0),Ge([O(null)],t.prototype,"field",void 0),Ge([O(null)],t.prototype,"label",void 0),Ge([O(null)],t.prototype,"type",void 0),Ge([O(null)],t.prototype,"operator",void 0),Ge([O(null)],t.prototype,"value",void 0),Ge([O(!1)],t.prototype,"not",void 0),Ge([O(null)],t.prototype,"isLocked",void 0),t}(Ir);(function(s){Oh(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return Ge([O(null)],t.prototype,"numericTextBoxModel",void 0),Ge([O(null)],t.prototype,"multiSelectModel",void 0),Ge([O(null)],t.prototype,"datePickerModel",void 0),Ge([O(null)],t.prototype,"textBoxModel",void 0),Ge([O(null)],t.prototype,"radioButtonModel",void 0),t})(Ir);var J3=function(s){Oh(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return Ge([O(!1)],t.prototype,"cloneRule",void 0),Ge([O(!1)],t.prototype,"cloneGroup",void 0),Ge([O(!1)],t.prototype,"lockRule",void 0),Ge([O(!1)],t.prototype,"lockGroup",void 0),Ge([O(!0)],t.prototype,"ruleDelete",void 0),Ge([O(!0)],t.prototype,"groupInsert",void 0),Ge([O(!0)],t.prototype,"groupDelete",void 0),t}(Ir),Q3=function(s){Oh(t,s);function t(e,i){var r=s.call(this,e,i)||this;return r.isReadonly=!0,r.fields={text:"label",value:"field"},r.updatedRule={not:!1,condition:"and",isLocked:!1},r.isLocale=!1,r.isRefreshed=!1,r.isNotified=!1,r.isAddSuccess=!1,r.isNotValueChange=!1,r.isFieldChange=!1,r.isFieldClose=!1,r.isDestroy=!1,r.isGetNestedData=!1,r.isCustomOprCols=[],r.groupCounter=0,r.lockItems=[],r.groupIndex=-1,r.ruleIndex=-1,r.isLastGroup=!1,r.cloneGrpBtnClick=!1,r.isMiddleGroup=!1,r.cloneRuleBtnClick=!1,r.isValueEmpty=!1,Ed.Inject(g3),r}return t.prototype.getPersistData=function(){return this.addOnPersist(["rule"])},t.prototype.reset=function(){this.isImportRules=!1;for(var e=this.element.querySelector(".e-group-body"),i=this.element.querySelectorAll("input.e-control"),r=0,n=i.length;r<n;r++)i[r].className.indexOf("e-tooltip")>-1?He(i[r],"tooltip").destroy():i[r].parentElement.className.indexOf("e-tooltip")>-1&&He(i[r].parentElement,"tooltip").destroy();if(e)e.innerHTML="";else{var a=this.createElement("div",{attrs:{class:"e-group-container"}}),o=this.createElement("div",{attrs:{class:"e-group-header"}}),l=this.createElement("div",{attrs:{class:"e-group-body"}});a.appendChild(o).appendChild(l),this.element.appendChild(a),e=this.element.querySelector(".e-group-body")}this.headerTemplate&&this.isRoot&&(this.element.innerHTML="",this.isRoot=!1),this.enableNotCondition&&Z(this.element.querySelectorAll(".e-qb-toggle"),"e-active-toggle"),e.appendChild(this.createElement("div",{attrs:{class:"e-rule-list"}})),this.levelColl[this.element.id+"_group0"]=[0],this.setProperties({rule:{condition:"and",not:!1,rules:[]}},!0),this.disableRuleCondition(e.parentElement)},t.prototype.getWrapper=function(){return this.element},t.prototype.getModuleName=function(){return"query-builder"},t.prototype.requiredModules=function(){var e=[];return e.push({member:"query-library",args:[this]}),e},t.prototype.GetRootColumnName=function(e){return m(e)?"":this.separator?e.split(this.separator)[0]:e},t.prototype.initialize=function(){if(this.dataColl.length){var e=Object.keys(this.dataColl[0]),i=[],r=[],n=void 0,a=!1,o=!1,l=void 0,h={isRequired:!0,min:0,max:Number.MAX_VALUE};if(this.columns.length){this.columnSort();for(var u=this.columns,c=0,f=u.length;c<f;c++)this.updateCustomOperator(u[c],"initial"),u[c].type||(e.indexOf(u[c].field)>-1&&(l=this.dataColl[0][u[c].field],n=typeof l,n==="string"?o=!isNaN(Date.parse(l)):n==="object"&&(o=l instanceof Date&&!isNaN(l.getTime()),n="string"),u[c].type=n,o=!1),n="string"),u[c].validation||(u[c].validation=h),u[c].category?a=!0:u[c].category=this.l10n.getConstant("OtherFields"),r.indexOf(u[c].category)<0&&r.push(u[c].category),(!u[c].operators||this.isLocale&&this.isCustomOprCols.indexOf(u[c].field)===-1)&&(u[c].operators=this.customOperators[u[c].type+"Operator"]);a&&(r.length>1||r[0]!==this.l10n.getConstant("OtherFields"))&&(this.fields={text:"label",value:"field",groupBy:"category"}),this.updateSubFieldsFromColumns(this.columns)}else{for(var c=0,f=e.length;c<f;c++)l=this.dataColl[0][e[c]],n=typeof l,n==="string"?o=!isNaN(Date.parse(l)):n==="object"&&!Object.keys(l).length&&(o=l instanceof Date&&!isNaN(l.getTime()),n="string"),i[c]={field:e[c],label:e[c],type:o?"date":n,validation:h},o=!1,i[c].operators=this.customOperators[i[c].type+"Operator"],n==="object"&&this.updateSubFields(l,i[c]);this.columns=i}}else if(this.columns&&this.columns.length){for(var u=this.columns,c=0,f=u.length;c<f;c++)u[c].category?this.fields={text:"label",value:"field",groupBy:"category"}:u[c].category=this.l10n.getConstant("OtherFields"),this.updateCustomOperator(u[c],"initial"),(!u[c].operators||this.isLocale&&this.isCustomOprCols.indexOf(u[c].field)===-1)&&(u[c].operators=this.customOperators[u[c].type+"Operator"]);this.updateSubFieldsFromColumns(this.columns)}this.trigger("dataBound",{type:"dataBound"})},t.prototype.updateSubFieldsFromColumns=function(e,i){for(var r=0;r<e.length;r++)this.separator!==""&&e[r].field.indexOf(this.separator)<0&&(e[r].field=i?i+this.separator+e[r].field:e[r].field),e[r].operators?this.updateCustomOperator(e[r]):e[r].type&&e[r].type!=="object"&&(e[r].operators=this.customOperators[e[r].type+"Operator"]),e[r].columns&&(e[r].type="object",this.updateSubFieldsFromColumns(e[r].columns,e[r].field))},t.prototype.updateSubFields=function(e,i,r){var n;i.columns=[];var a=Object.keys(e),o,l,h,u;r=r||this.dataColl[0];for(var c=0,f=a.length;c<f;c++){var d=i.field.split(".");r?u=r[d[d.length-1]][a[c]]:u=this.dataColl[0][i.field][a[c]];var p=r[i.field.split(this.separator)[i.field.split(this.separator).length-1]];h=typeof u,o=i.field+this.separator+a[c],l=a[c],h=h==="object"&&!isNaN(Date.parse(u))?"date":h,n={field:o,label:l,type:h},h!=="object"&&(n.operators=this.customOperators[h+"Operator"]),i.columns.push(n),h==="object"&&this.updateSubFields(u,n,p)}},t.prototype.updateCustomOperator=function(e,i){if(e.operators){!this.isLocale&&i==="initial"&&!m(this.isCustomOprCols)&&this.isCustomOprCols.push(e.field);for(var r=function(o){var l=Object.keys(e.operators[o]).indexOf("sqlOperator");if(l>-1){var h=e.operators[o],u=Object.keys(h),c=u.map(function(d){return h[""+d]}).join(",").split(","),f=u.indexOf("value");n.operators[c[f]]=c[l]}},n=this,a=0;a<e.operators.length;a++)r(a)}},t.prototype.focusEventHandler=function(e){this.target=e.target},t.prototype.clickEventHandler=function(e){var i=this,r=e.target,n;this.isImportRules=!1;var a;if(r.tagName==="SPAN"&&(r=r.parentElement),typeof r.className=="string"&&r.className.indexOf("e-collapse-rule")>-1){var o=new vr({duration:1e3,delay:0});this.element.querySelectorAll(".e-summary-content").length<1&&this.renderSummary();var l=document.getElementById(this.element.id+"_summary_content"),h=l.querySelector(".e-summary-text");o.animate(".e-query-builder",{name:"SlideLeftIn"});var u=this.element.querySelector(".e-group-container");u.style.display="none",h.textContent=this.getSqlFromRules(this.rule),l.style.display="block",h.style.height=h.scrollHeight+"px"}if(r.tagName==="BUTTON"&&typeof r.className=="string"&&r.className.indexOf("e-qb-toggle")<0){var o=new vr({duration:1e3,delay:0});switch(!0){case r.className.indexOf("e-removerule")>-1:this.actionButton=r,this.deleteRule(r);break;case r.className.indexOf("e-clone-rule-btn")>-1:this.actionButton=r,this.cloneRuleBtnClick=!0,this.ruleClone(r);break;case r.className.indexOf("e-lock-rule-btn")>-1:this.actionButton=r,this.ruleLock(r);break;case r.className.indexOf("e-lock-grp-btn")>-1:this.actionButton=r,this.groupLock(r);break;case r.className.indexOf("e-clone-grp-btn")>-1:this.actionButton=r,this.cloneGrpBtnClick=!0,this.groupClone(X(r,".e-group-container"));break;case r.className.indexOf("e-deletegroup")>-1:this.actionButton=r,this.deleteGroup(X(r,".e-group-container"));break;case r.className.indexOf("e-edit-rule")>-1:if(o.animate(".e-query-builder",{name:"SlideLeftIn"}),document.getElementById(this.element.id+"_summary_content").style.display="none",this.element.querySelectorAll(".e-group-container").length<1){this.addGroupElement(!1,this.element,this.rule.condition,!1,this.rule.not);var c=Ue({},this.rule,{},!0);this.setGroupRules(c),this.renderSummaryCollapse()}else{var u=this.element.querySelector(".e-group-container");u.querySelectorAll(".e-collapse-rule").length<1&&this.renderSummaryCollapse(),u.style.display="block"}break}}else if(r.tagName==="LABEL"&&r.parentElement.className.indexOf("e-btn-group")>-1||typeof r.className=="string"&&r.className.indexOf("e-qb-toggle")>-1){var f=X(r,".e-group-container");if(!this.headerTemplate){var d=r.getAttribute("for"),p=void 0;d?p=document.getElementById(d).getAttribute("value"):this.enableSeparateConnector&&(p=r.textContent),a=f.id.replace(this.element.id+"_","");var v=this.getGroup(a),g=void 0;if(this.enableNotCondition)if(r.className.indexOf("e-qb-toggle")>-1){var b=f.getElementsByClassName("e-qb-toggle")[0];b.className.indexOf("e-active-toggle")>-1?(Z([b],"e-active-toggle"),g=!1):(P([b],"e-active-toggle"),g=!0),p=v.condition}else g=v.not;n={groupID:a,cancel:!1,type:"condition",value:p.toLowerCase()},this.enableNotCondition&&(n={groupID:a,cancel:!1,type:"condition",value:p.toLowerCase(),not:g})}this.isImportRules?this.beforeSuccessCallBack(n,r):this.trigger("beforeChange",n,function(C){i.beforeSuccessCallBack(C,r)}),this.target=r}},t.prototype.beforeSuccessCallBack=function(e,i){if(e&&!e.cancel){var r=X(i,".e-group-container"),n=r.id.replace(this.element.id+"_",""),a=this.getValidRules(this.rule),o=this.getParentGroup(r);if(this.enableSeparateConnector){m(X(i,".e-rule-container"))&&r.classList.contains("e-group-container")?r=i.parentElement.previousElementSibling!==null?i.parentElement.previousElementSibling:r:r=X(i,".e-rule-container");var l=r.id.replace(this.element.id+"_","");r.classList.contains("e-rule-container")?(o=this.getRule(r),o.condition=e.value):r.classList.contains("e-group-container")&&(o=this.getGroup(r),o.condition=e.value),this.enableNotCondition&&(o.not=e.not),this.isImportRules||this.trigger("change",{groupID:n,ruleID:l,type:"condition",value:o.condition})}else o.condition=e.value,this.enableNotCondition&&(o.not=e.not),this.isImportRules||this.trigger("change",{groupID:n,type:"condition",value:o.condition});if(this.filterRules(a,this.getValidRules(this.rule),"condition"),this.enableSeparateConnector){var h=i.parentElement.querySelector(".e-btngroup-and"),u=i.parentElement.querySelector(".e-btngroup-or");h&&u&&(e.value==="and"?(h.checked=!0,u.checked=!1):e.value==="or"&&(u.checked=!0,h.checked=!1))}}},t.prototype.selectBtn=function(e,i){i.name==="beforeOpen"?this.showButtons.groupInsert||m(this.showButtons.groupInsert)?(this.element.querySelectorAll(".e-group-container").length>=this.maxGroupCount+1?P([i.element.querySelector("li span.e-addgroup").parentElement],"e-button-hide"):Z([i.element.querySelector("li span.e-addgroup").parentElement],"e-button-hide"),this.enableRtl&&P([i.element.querySelector("li").parentElement],"e-rtl")):P([i.element.querySelector("li span.e-addgroup").parentElement],"e-button-hide"):i.element.children[0].className.indexOf("e-addrule")>-1?this.addRuleElement(X(e,".e-group-container"),{}):i.element.children[0].className.indexOf("e-addgroup")>-1&&this.addGroupElement(!0,X(e,".e-group-container"),"",!0)},t.prototype.appendRuleElem=function(e,i,r,n,a,o){var l,h,u=e.querySelector(".e-rule-list"),c;if(r==="change")l=ye("#"+n,e);else{if(l=this.createElement("div",{attrs:{class:"e-rule-container"}}),l.setAttribute("id",e.id+"_rule"+this.ruleIdCounter),this.showButtons.cloneRule&&this.cloneRuleBtnClick){if(this.ruleIndex<0)u.appendChild(l);else if(this.enableSeparateConnector){for(var f=-1,d=this.ruleIndex+1,p=0;p<d&&p!==u.children.length;p++)u.children[p].classList.contains("e-rule-container")&&(d++,f++);u.insertBefore(l,u.children[this.ruleIndex+f+1])}else u.insertBefore(l,u.children[this.ruleIndex+1]);this.cloneRuleBtnClick=!1}else u.appendChild(l);this.ruleIdCounter++}if(i&&i.ruleTemplate&&o){c={requestType:"template-initialize",ruleID:l.id,action:a,fields:this.fields,rule:o},this.trigger("actionBegin",c),this.ruleTemplateFn=this.templateParser(i.ruleTemplate);var v=this.element.id+i.field,g=void 0;if(c.fields=this.fields,c.columns=this.columns,o.field===""&&(o.field=i.field),c.operators=this.getOperators(o.field),c.operatorFields={text:"key",value:"value"},this.isReact)g=this.ruleTemplateFn(c,this,l.id,v)[0],h=g,h.className+=" e-rule-field",l.appendChild(h);else if(this.isAngular){var b=this.ruleTemplateFn(c,this,l.id,v);g=b[0].nodeType===3?b[1]:b[0],h=g,h.className+=" e-rule-field",l.appendChild(h)}else this.isVue3?(g=this.ruleTemplateFn(c,this,"Template",v),h=g,at(h,l),l.children.length&&(l.children[l.children.length-1].className+=" e-rule-field")):(g=this.ruleTemplateFn(c,this,"Template",v)[0],h=g,h.className+=" e-rule-field",l.appendChild(h))}else h=this.ruleElem.querySelector(".e-rule-field").cloneNode(!0),l.appendChild(h);return this.showButtons.lockGroup&&Z(l.querySelectorAll(".e-lock-grp-btn"),"e-button-hide"),this.showButtons.lockRule&&Z(l.querySelectorAll(".e-lock-rule-btn"),"e-button-hide"),this.showButtons.cloneGroup&&Z(l.querySelectorAll(".e-clone-grp-btn"),"e-button-hide"),this.showButtons.cloneRule&&Z(l.querySelectorAll(".e-clone-rule-btn"),"e-button-hide"),this.showButtons.ruleDelete&&Z(l.querySelectorAll(".e-lock-grp-btn"),"e-button-hide"),this.allowDragAndDrop&&Z(l.querySelectorAll(".e-drag-qb-rule"),"e-hidden"),i&&i.ruleTemplate&&o&&this.renderReactTemplates(),l},t.prototype.addRuleElement=function(e,i,r,n,a,o){var l=this;if(e){var h={groupID:e.id.replace(this.element.id+"_",""),cancel:!1,type:"insertRule"};!this.isImportRules&&!this.isInitialLoad&&!this.prvtEvtTgrDaD?this.trigger("beforeChange",h,function(u){l.addRuleSuccessCallBack(u,e,i,r,n,a,o)}):(this.isInitialLoad=!1,this.addRuleSuccessCallBack(h,e,i,r,n,a,o))}},t.prototype.addRuleSuccessCallBack=function(e,i,r,n,a,o,l){var h=this.element.className.indexOf("e-device")>-1?"250px":"200px",u,c=r&&r.field?this.getColumn(r.field):n||this.columns[0],f,d,p,v={label:"",field:"",type:"",operator:""};if(!e.cancel){if(c&&c.ruleTemplate&&r.field){this.selectedColumn=c,f=this.selectedColumn.operators,v={label:c.label,field:c.field,type:c.type,operator:f[0].value};var g=Object.keys(r).length?r:v;p=this.appendRuleElem(i,c,a,o,"field",g);var b={requestType:"template-create",action:"insert-rule",ruleID:p.id,fields:this.fields,rule:g};this.trigger("actionBegin",b)}else{p=this.appendRuleElem(i,c,a,o,"field"),p.querySelector(".e-filter-input").setAttribute("id",p.id+"_filterkey");var C=p.querySelector(".e-rule-delete");if(this.element.className.indexOf("e-device")>-1||this.displayMode==="Vertical")C.textContent=this.l10n.getConstant("Remove"),P([C],"e-flat"),P([C],"e-primary");else{P([C],"e-round"),P([C],"e-icon-btn"),C.setAttribute("title",this.l10n.getConstant("DeleteRule"));var y=this.createElement("span",{attrs:{class:"e-btn-icon e-icons e-delete-icon"}});p.querySelector(".e-rule-delete").appendChild(y)}this.showButtons.ruleDelete||C.classList.add("e-button-hide")}this.displayMode==="Vertical"||this.element.className.indexOf("e-device")>-1?p.className="e-rule-container e-vertical-mode":p.className="e-rule-container e-horizontal-mode";var x=p.previousElementSibling;if(this.enableSeparateConnector){var w=void 0,S=void 0;if(x&&x.classList.contains("e-group-container")&&(S=x.querySelectorAll(".e-rule-container"),x=S[S.length-1]),x&&x.classList.contains("e-rule-container")&&(w=this.getRule(x)),this.headerTemplate&&x&&w)this.headerTemplateFn(x,!1,w.condition,w,x.id);else if(m(x)&&p.id!==this.element.id+"_group0_rule0"){var E=p.closest(".e-group-container");if(E&&E.previousElementSibling){var k=E.previousElementSibling,A=k.querySelectorAll(".e-rule-container");if(k.classList.contains("e-group-container")&&(k=A[A.length-1]),k.classList.contains("e-rule-container")){var z=this.getRule(k);this.headerTemplateFn(k,!1,z.condition,z,k.id,!0)}}else this.headerTemplateFn(p,!1,r.condition,r,p.id,!0)}}else x&&x.className.indexOf("e-rule-container")>-1&&(p.className.indexOf("e-joined-rule")<0&&(p.className+=" e-joined-rule"),x.className.indexOf("e-prev-joined-rule")<0&&(x.className+=" e-prev-joined-rule"));if(x&&x.className.indexOf("e-group-container")>-1&&p.className.indexOf("e-separate-rule")<0&&(p.className+=" e-separate-rule"),this.isImportRules||this.updateAddedRule(i,r,v,l,o,this.enableSeparateConnector?!0:null),!c||c&&!c.ruleTemplate||!r.field)if(this.fieldMode==="Default"){var D=void 0,T=void 0;this.separator&&r.field?T=this.GetRootColumnName(r.field):this.autoSelectField?T=this.GetRootColumnName(r.field):T=this.isImportRules?this.GetRootColumnName(r.field):r.field,D={dataSource:this.columns,fields:this.fields,placeholder:this.l10n.getConstant("SelectField"),popupHeight:this.columns.length>5?h:"auto",close:this.fieldClose.bind(this,p.id+"_filterkey"),change:this.changeField.bind(this),value:r?T:null,open:this.popupOpen.bind(this,!0),cssClass:"qb-dropdownlist"},this.fieldModel&&(D=Cr({},D,this.fieldModel)),d=new vu(D),d.appendTo("#"+p.id+"_filterkey");var M=void 0;this.separator&&r.field?M=this.GetRootColumnName(r.field):M=this.isImportRules?this.GetRootColumnName(r.field):d.value,this.selectedColumn=d.getDataByValue(M),Object.keys(r).length&&this.changeRule(r,{element:d.element,itemData:this.selectedColumn})}else{var D=void 0,T=(this.isImportRules,r.field);this.dummyDropdownTreeDs=Ue([],this.columns,[],!0),this.updateDropdowntreeDS(this.dummyDropdownTreeDs),D={fields:{dataSource:this.dummyDropdownTreeDs,value:"field",text:"label",child:"columns",expanded:"expanded",selectable:"selectable"},placeholder:this.l10n.getConstant("SelectField"),showClearButton:!1,popupHeight:this.columns.length>5?h:"auto",changeOnBlur:!1,change:this.changeField.bind(this),value:m(T)?null:[T],open:this.popupOpen.bind(this,!1),treeSettings:{expandOn:"Click"},cssClass:"e-qb-ddt",filtering:this.dropdownTreeFiltering.bind(this),close:this.dropdownTreeClose.bind(this)},this.fieldModel&&(D=Cr({},D,this.fieldModel));var K=new VH(D);if(K.appendTo("#"+p.id+"_filterkey"),!m(K.value)){var te=this.getLabelFromColumn(K.value[0]);K.element.value=te}var M=m(r.field)?K.value:this.GetRootColumnName(r.field);this.selectedColumn=this.getColumn(M),Object.keys(r).length&&this.changeRule(r,{element:K.element,itemData:this.selectedColumn})}if(u=p.id.replace(this.element.id+"_",""),r&&r.isLocked){var ee=p.querySelector(".e-lock-rule-btn");this.ruleLock(ee)}!this.isImportRules&&!this.prvtEvtTgrDaD&&this.trigger("change",{groupID:i.id.replace(this.element.id+"_",""),ruleID:u,type:"insertRule"})}if(this.enableSeparateConnector&&m(r.condition)&&u&&(r=this.getRule(u)),this.enableSeparateConnector){for(var k=p.previousElementSibling,S=void 0;k&&!k.classList.contains("e-rule-container");){if(k.classList.contains("e-group-container")){S=k.querySelectorAll(".e-rule-container"),k=S[S.length-1];break}k=k.previousElementSibling}if(this.headerTemplate&&k){var w=this.getRule(k),J={requestType:"rule-template-create",ruleID:k.id,condition:w.condition,notCondition:this.enableNotCondition?!0:void 0};this.trigger("actionBegin",J)}else if(m(k)&&p.id!==this.element.id+"_group0_rule0"){var E=p.closest(".e-group-container");if(E&&E.previousElementSibling&&E.previousElementSibling.previousElementSibling){var re=E.previousElementSibling.previousElementSibling;if(re.classList.contains("e-group-container")){var j=re.querySelectorAll(".e-rule-container");re=j[j.length-1]}if(re.classList.contains("e-rule-container")){var w=this.getRule(re),de={requestType:"rule-template-create",ruleID:re.id,condition:w.condition,notCondition:this.enableNotCondition?!0:void 0};this.trigger("actionBegin",de)}}}this.setMultiConnector(p)}},t.prototype.dropdownTreeFiltering=function(e){var i=this,r=this,n="",a=e.event.srcElement,o=a.classList.contains("e-clear-icon"),l=o?a.parentElement.querySelector(".e-textbox"):a;n=l.id.split("_filterkey")[0];var h=document.getElementById(n);this.ddTree=He(h.querySelector("input.e-dropdowntree"),"dropdowntree");var u=Ue([],this.columns,[],!0);if(e.cancel=!0,e.text==="")this.changeDataSource(u);else{var c=u.map(function(f){return i.nestedChildFilter(e.text,f)}).filter(function(f){return f!==null});this.changeDataSource(c),setTimeout(function(){!m(r.ddTree)&&!m(r.ddTree.treeObj)&&r.ddTree.treeObj.expandAll()},100)}},t.prototype.changeDataSource=function(e){this.updateDropdowntreeDS(e),this.ddTree.treeObj.fields={dataSource:e,value:"field",text:"label",child:"columns",expanded:"expanded"},this.ddTree.treeObj.refresh()},t.prototype.nestedChildFilter=function(e,i){var r=this,n=i[this.ddTree.fields.child];if(!n)return this.isMatchedNode(e,i)?i:null;var a=n.map(function(o){return r.nestedChildFilter(e,o)}).filter(function(o){return o!==null});return a.length?(i[this.ddTree.fields.child]=a,i):(i[this.ddTree.fields.child]=n,this.isMatchedNode(e,i)?i:null)},t.prototype.isMatchedNode=function(e,i){var r=i[this.ddTree.fields.text].toLowerCase();return e=e?e.toLowerCase():"",r.indexOf(e)!==-1},t.prototype.dropdownTreeClose=function(){this.ddTree&&this.changeDataSource(Ue([],this.columns,[],!0)),this.ddTree=null},t.prototype.updateDropdowntreeDS=function(e){for(var i=0;i<e.length;i++)e[parseInt(i.toString(),10)].type==="object"?(this.isAngular&&e[parseInt(i.toString(),10)].template&&delete e[parseInt(i.toString(),10)].template,e[parseInt(i.toString(),10)].selectable=!1,this.updateDropdowntreeDS(e[parseInt(i.toString(),10)].columns)):this.isAngular&&e[parseInt(i.toString(),10)].template&&delete e[parseInt(i.toString(),10)].template},t.prototype.updateAddedRule=function(e,i,r,n,a,o){var l,h=0,u,c;if(n){for(l=ye("#"+a,e),u=X(e,".e-group-container"),c=this.getParentGroup(u);l&&l.previousElementSibling!==null;){l=l.previousElementSibling;var f=this.enableSeparateConnector&&(!this.headerTemplate&&!l.classList.contains("e-btn-group")||this.headerTemplate&&(l.classList.contains("e-rule-container")||l.classList.contains("e-group-container")));(!this.enableSeparateConnector||f)&&h++}c.rules[h]=i}else{u=X(e,".e-group-container"),c=this.getParentGroup(u);var d=i.custom;Object.keys(i).length?this.ruleIndex<0?(c.rules.push({field:i.field,type:i.type,label:i.label,operator:i.operator,value:i.value}),d&&(c.rules[c.rules.length-1].custom=d),this.enableSeparateConnector&&(c.rules[c.rules.length-1].condition=i.condition?i.condition:r.condition)):(c.rules.splice(this.ruleIndex+1,0,{field:i.field,type:i.type,label:i.label,operator:i.operator,value:i.value}),d&&(c.rules[this.ruleIndex+1].custom=d),this.enableSeparateConnector&&(c.rules[this.ruleIndex+1].condition=i.condition?i.condition:r.condition)):(d&&(r.custom=d),this.autoSelectField&&(i.field=r.field=this.rule.rules[0].field),c.rules.push(r))}this.disableRuleCondition(e,c,o)},t.prototype.changeRuleTemplate=function(e,i){var r=this.selectedColumn.operators;if(!e.ruleTemplate){var n=X(i,".e-group-container"),a=X(i,".e-rule-container").id;if(this.previousColumn&&this.previousColumn.ruleTemplate&&(Oe(i.closest('[id="'+a+'"]').querySelector(".e-rule-field")),this.clearQBTemplate([a])),e){var o={field:e.field,label:e.label,operator:r[0].value,value:""};this.addRuleElement(n,o,e,"change",a,!0)}}},t.prototype.renderToolTip=function(e){var i=new XB({content:this.l10n.getConstant("ValidationMessage"),isSticky:!0,position:"BottomCenter",cssClass:"e-querybuilder-error",afterClose:function(){i.destroy()},beforeOpen:function(r){var n=r.element.querySelector(".e-tooltip-close");n&&(n.style.display="none")}});i.appendTo(e),i.open(e)},t.prototype.validateFields=function(){var e=!0,i;if(this.allowValidation){var r=["isnull","isnotnull","isempty","isnotempty"],n=void 0,a=void 0,o=void 0,l=void 0,h=[],u=void 0,c=void 0,f=void 0,d=void 0,p=void 0,v=this.element.querySelectorAll(".e-rule-container");for(n=0,a=v.length;n<a;n++){var g=void 0;if(u=X(v[n],".e-group-container"),p=this.getParentGroup(u),c=0,l=d=v[n],this.fieldMode==="DropdownTree"?(i=He(v[n].querySelector(".e-rule-filter input.e-dropdowntree"),"dropdowntree"),i&&i.value&&i.value.length&&(this.selectedColumn=this.getColumn(i.value[0]),g=this.selectedColumn.validation)):(f=He(v[n].querySelector(".e-rule-filter input.e-dropdownlist"),"dropdownlist"),f&&f.value&&(this.selectedColumn=f.getDataByValue(f.value),g=!m(f.value)&&this.selectedColumn.validation)),o=d.querySelector(".e-rule-field input.e-control"),g&&g.isRequired){for(;l&&l.previousElementSibling!==null;){l=l.previousElementSibling;var b=this.enableSeparateConnector&&(!this.headerTemplate&&!l.classList.contains("e-btn-group")||this.headerTemplate&&(l.classList.contains("e-rule-container")||l.classList.contains("e-group-container")));(!this.enableSeparateConnector||b)&&c++}if(o=d.querySelector(".e-rule-operator .e-control"),p.rules[c].operator||(o.parentElement.className.indexOf("e-tooltip")<0&&o.className.indexOf("e-tooltip")<0&&this.renderToolTip(o.parentElement),e=!1),p.rules[c].value instanceof Array&&(h=p.rules[c].value),r.indexOf(p.rules[c].operator)<-1&&m(p.rules[c].value)&&p.rules[c].type!=="date"||p.rules[c].value===""||p.rules[c].value===null||p.rules[c].value instanceof Array&&h.length<1){var C=d.querySelectorAll(".e-rule-value .e-control");r.indexOf(p.rules[c].operator)<0&&(e=!1);for(var y=0,x=C.length;y<x;y++){var w=C[y],S=void 0;w.parentElement.className.indexOf("e-searcher")>-1?(S=X(w,".e-multi-select-wrapper"),S.className.indexOf("e-tooltip")<0&&this.renderToolTip(S)):C[y].parentElement.className.indexOf("e-tooltip")<0&&C[y].className.indexOf("e-tooltip")<0&&this.renderToolTip(C[y].parentElement),y++}}else if(p.rules[c].type==="date"&&(p.rules[c].value===null||p.rules[c].value.indexOf(null)>-1)){var C=d.querySelectorAll(".e-rule-value .e-control");r.indexOf(p.rules[c].operator)<0&&(e=!1);for(var y=0,x=C.length;y<x;y++)C[y].parentElement.className.indexOf("e-tooltip")<0&&C[y].className.indexOf("e-tooltip")<0&&(m(p.rules[c].value)||p.rules[c].value[y]==null)&&this.renderToolTip(C[y].parentElement)}}else(f&&f.element&&m(f.value)||i&&i.element&&(m(i.value)||i.value.length<1))&&(o.parentElement.className.indexOf("e-tooltip")<0&&this.renderToolTip(o.parentElement),e=!1)}}return e},t.prototype.refreshLevelColl=function(){this.levelColl={};var e=this.element.querySelector(".e-group-container");if(e){this.levelColl[e.id]=[0];var i={groupElement:e,level:[0]};this.refreshLevel(i)}},t.prototype.refreshLevel=function(e){var i=e.groupElement.querySelector(".e-rule-list").children,r,n=e.groupElement,a,o=i.length,l=0;for(a=0;a<o;a++)r=i[a],r.className.indexOf("e-group-container")>-1&&(e.level.push(l),this.levelColl[r.id]=e.level.slice(),l++,e.groupElement=r,e=this.refreshLevel(e));var h=X(n,".e-rule-list");return e.groupElement=h?X(h,".e-group-container"):n,e.level=this.levelColl[e.groupElement.id].slice(),e},t.prototype.groupTemplate=function(e){var i,r,n,a,o,l,h=this.createElement("div",{attrs:{class:"e-group-container"}}),u=this.createElement("div",{attrs:{class:"e-group-header"}}),c=this.createElement("div",{attrs:{class:"e-group-body"}}),f=this.createElement("div",{attrs:{class:"e-rule-list"}});if(h.appendChild(u),c.appendChild(f),h.appendChild(c),!this.headerTemplate){this.allowDragAndDrop?n="e-icons e-drag-qb-rule":n="e-icons e-drag-qb-rule e-hidden";var d=this.createElement("span",{attrs:{class:n,"aria-lable":"drag handle",title:"drag handle"}});u.appendChild(d);var p=this.enableSeparateConnector&&!e?"e-lib e-btn-group e-qb-toggle-btn":"e-lib e-btn-group";i=this.createElement("div",{attrs:{class:p,role:"group"}}),this.enableSeparateConnector&&i.classList.add("e-multi-connector"),this.enableNotCondition&&(this.enableSeparateConnector?r=this.createElement("input",{attrs:{type:"checkbox",class:"e-qb-toggle"}}):r=this.createElement("button",{attrs:{type:"button",class:"e-qb-toggle"}}),i.appendChild(r)),r=this.createElement("input",{attrs:{type:"radio",class:"e-btngroup-and",value:"AND"}}),i.appendChild(r),a=this.createElement("label",{attrs:{class:"e-lib e-btn e-btngroup-and-lbl e-small"},innerHTML:this.l10n.getConstant("AND")}),i.appendChild(a),r=this.createElement("input",{attrs:{type:"radio",class:"e-btngroup-or",value:"OR"}}),i.appendChild(r),a=this.createElement("label",{attrs:{class:"e-lib e-btn e-btngroup-or-lbl e-small"},innerHTML:this.l10n.getConstant("OR")}),i.appendChild(a),u.appendChild(i),o=this.createElement("div",{attrs:{class:"e-group-action"}}),this.enableSeparateConnector?(l=this.createElement("button",{attrs:{type:"button",class:"e-add-condition-btn"}}),o.appendChild(l),l=this.createElement("button",{attrs:{type:"button",class:"e-add-group-btn"}}),o.appendChild(l)):(l=this.createElement("button",{attrs:{type:"button",class:"e-add-btn"}}),o.appendChild(l)),u.appendChild(o)}return h},t.prototype.ruleTemplate=function(){var e,i,r,n,a,o=this.createElement("div"),l=this.createElement("div",{attrs:{class:"e-rule-field"}});e=this.createElement("div",{attrs:{class:"e-rule-filter"}}),this.allowDragAndDrop?a="e-icons e-drag-qb-rule":a="e-icons e-drag-qb-rule e-hidden";var h=this.createElement("span",{attrs:{class:a,"aria-lable":"drag handle",title:"drag handle"}});l.appendChild(h);var u=this.createElement("input",{attrs:{type:"text",class:"e-filter-input"}});e.appendChild(u),l.appendChild(e),e=this.createElement("div",{attrs:{class:"e-rule-operator"}}),l.appendChild(e),e=this.createElement("div",{attrs:{class:"e-rule-value"}}),l.appendChild(e),e=this.createElement("div",{attrs:{class:"e-rule-value-delete"}}),this.showButtons.cloneRule?r="e-clone-rule-btn e-clone-rule e-css e-btn e-small e-round e-icon-btn":r="e-clone-rule-btn e-clone-rule e-css e-btn e-small e-round e-icon-btn e-button-hide",this.showButtons.lockRule?n="e-lock-rule-btn e-lock-rule e-css e-btn e-small e-round e-icons e-icon-btn":n="e-lock-rule-btn e-lock-rule e-css e-btn e-small e-round e-icons e-icon-btn e-button-hide";var c=this.createElement("button",{attrs:{title:this.l10n.getConstant("CloneRule"),type:"button",class:r}}),f=this.createElement("span",{attrs:{class:"e-btn-icon e-icons e-copy"}});c.appendChild(f);var d=this.createElement("button",{attrs:{title:this.l10n.getConstant("LockRule"),type:"button",class:n}});f=this.createElement("span",{attrs:{class:"e-btn-icon e-icons e-unlock"}}),d.appendChild(f),this.showButtons.ruleDelete||m(this.showButtons.ruleDelete)?i="e-removerule e-rule-delete e-css e-btn e-small":i="e-removerule e-rule-delete e-css e-btn e-small e-button-hide";var p=this.createElement("button",{attrs:{type:"button",class:i}});return e.appendChild(c),e.appendChild(d),e.appendChild(p),l.appendChild(e),o.appendChild(l),o},t.prototype.addGroupElement=function(e,i,r,n,a,o,l){var h=this,u={groupID:i.id.replace(this.element.id+"_",""),cancel:!1,type:"insertGroup"};!this.isImportRules&&!this.isInitialLoad&&!this.prvtEvtTgrDaD?this.trigger("beforeChange",u,function(c){h.addGroupSuccess(c,e,i,r,n,a,o,l)}):(this.isInitialLoad=!1,this.addGroupSuccess(u,e,i,r,n,a,o,l))},t.prototype.addGroupSuccess=function(e,i,r,n,a,o,l,h){var u=this;if(!e.cancel&&this.element.querySelectorAll(".e-group-container").length<=this.maxGroupCount){var c=r,f=void 0,d="";c.className.indexOf("e-group-container")<0?d=c.querySelector(".e-group-container")&&c.querySelector(".e-group-container").id:d=c.id,this.enableSeparateConnector&&(this.groupElem=this.groupTemplate());var p=this.groupElem.cloneNode(!0);if(p.setAttribute("id",this.element.id+"_group"+this.groupIdCounter),this.groupIdCounter===0&&this.allowDragAndDrop&&p.querySelector(".e-drag-qb-rule")&&(p&&p.children[0]&&p.children[0].classList.add("e-parent-header"),P([p.querySelector(".e-drag-qb-rule")],"e-hidden")),this.headerTemplate&&(l?(i=!1,p.setAttribute("id",this.element.id+"_group0"),this.headerTemplateFn(p,o,n,h,d),this.groupIdCounter=0):this.headerTemplateFn(p,o,n,h,d)),this.groupIdCounter++,!this.headerTemplate){var v=p.querySelector(".e-btngroup-and"),g=p.querySelector(".e-btngroup-or"),b=p.querySelector(".e-btngroup-and-lbl"),C=p.querySelector(".e-btngroup-or-lbl");v.setAttribute("id",this.element.id+"_and"+this.btnGroupId),g.setAttribute("id",this.element.id+"_or"+this.btnGroupId),v.setAttribute("name",this.element.id+"_and"+this.btnGroupId),g.setAttribute("name",this.element.id+"_and"+this.btnGroupId),b.setAttribute("for",this.element.id+"_and"+this.btnGroupId),C.setAttribute("for",this.element.id+"_or"+this.btnGroupId),this.btnGroupId++}if(i){var y=void 0;this.showButtons.groupDelete||m(this.showButtons.groupDelete)?y="e-deletegroup":y="e-deletegroup e-button-hide",f=this.createElement("button",{attrs:{type:"button",class:y}});var x=new Tl({iconCss:"e-icons e-delete-icon",cssClass:"e-small e-round"});x.appendTo(f),f.setAttribute("title",this.l10n.getConstant("DeleteGroup")),os(f,{selector:".deletegroup"});for(var w=c.querySelector(".e-rule-list"),S=w.children,E=0,k=0,A=S.length;k<A;k++)S[k].className.indexOf("e-group-container")>-1&&(E+=1);if(this.showButtons.cloneGroup&&this.cloneGrpBtnClick)if(this.groupIndex===S.length-1)w.appendChild(p),this.isLastGroup=!0;else{if(this.enableSeparateConnector){for(var z=0,D=this.groupIndex+1,T=0;T<D;T++)S[T].classList.contains("e-rule-container")&&(D++,z++);z>0&&z--;var M=this.groupIndex+z+1;S[M].parentNode.insertBefore(p,S[M])}else{var M=this.groupIndex+1;S[M].parentNode.insertBefore(p,S[M])}this.isMiddleGroup=!0}else w.appendChild(p);var K=this.levelColl[c.id].slice(0);if(K.push(E),this.levelColl[p.id]=K,this.groupIndex>-1&&this.refreshLevelColl(),this.isImportRules||(this.isAddSuccess=!0,this.addGroups([],c.id.replace(this.element.id+"_","")),this.isAddSuccess=!1,a&&this.addRuleToNewGroups&&this.addRuleElement(p,{})),!this.headerTemplate){var te="";this.showButtons.cloneGroup?te="e-clone-grp-btn e-css e-btn e-small e-round e-icons e-icon-btn":te="e-clone-grp-btn e-css e-btn e-small e-round e-icons e-icon-btn e-button-hide";var ee=this.createElement("button",{attrs:{title:this.l10n.getConstant("CloneGroup"),type:"button",class:te}}),J=this.createElement("span",{attrs:{class:"e-btn-icon e-icons e-copy"}});ee.appendChild(J),p.querySelector(".e-group-action").appendChild(ee),this.showButtons.lockGroup?te="e-lock-grp-btn e-css e-btn e-small e-round e-icons e-icon-btn":te="e-lock-grp-btn e-css e-btn e-small e-round e-icons e-icon-btn e-button-hide";var re=this.createElement("button",{attrs:{title:this.l10n.getConstant("LockGroup"),type:"button",class:te}}),j=this.createElement("span",{attrs:{class:"e-btn-icon e-icons e-unlock"}});re.appendChild(j),p.querySelector(".e-group-action").appendChild(re),p.querySelector(".e-group-action").appendChild(f)}}else{if(!this.headerTemplate){var te="";this.showButtons.lockGroup?te="e-lock-grp-btn e-css e-btn e-small e-round e-icons e-icon-btn":te="e-lock-grp-btn e-css e-btn e-small e-round e-icons e-icon-btn e-button-hide";var re=this.createElement("button",{attrs:{title:this.l10n.getConstant("LockGroup"),type:"button",class:te}}),J=this.createElement("span",{attrs:{class:"e-btn-icon e-icons e-unlock"}});re.appendChild(J),p.querySelector(".e-group-action").appendChild(re)}c.appendChild(p),this.levelColl[p.id]=[0]}if(this.enableNotCondition&&!this.headerTemplate){var de=p.querySelector(".e-qb-toggle"),we=void 0;this.enableSeparateConnector?we=new OB({label:this.l10n.getConstant("NOT"),cssClass:"e-qb-toggle"}):we=new Tl({content:this.l10n.getConstant("NOT"),cssClass:"e-btn e-small"}),we.appendTo(de),p.querySelector(".e-btngroup-and-lbl").classList.add("e-not"),this.updatedRule&&this.updatedRule.not&&P([de],"e-active-toggle")}if(this.enableSeparateConnector&&!this.headerTemplate){for(var N=p.querySelector(".e-btngroup-and"),H=p.querySelector(".e-btngroup-or"),L=p.querySelector(".e-btn-group"),T=0;T<L.childNodes.length;T++)p.querySelector(".e-btn-group").childNodes[T].textContent.toLowerCase()==="not"&&this.enableNotCondition?L.childNodes[T].classList.add("e-multiconnector"):L.childNodes[T].style.display="none";var _=p.previousElementSibling;if(_){if(m(this.headerTemplate)){p.parentElement.insertBefore(this.groupTemplate(!0).querySelector(".e-btn-group"),p);var de=p.previousElementSibling.childNodes[0];de.classList.contains("e-qb-toggle")&&(de.style.display="none")}if(!this.isImportRules){var U=p.previousElementSibling,se=U.querySelector(".e-btngroup-and"),ae=U.querySelector(".e-btngroup-or");if(!N.checked&&!H.checked){var oe=p.nextElementSibling;oe&&oe.classList.contains("e-btn-group")&&(N=oe.querySelector(".e-btngroup-and"),H=oe.querySelector(".e-btngroup-or"),se.checked=N.checked,ae.checked=H.checked)}else this.enableSeparateConnector&&(N.checked&&(se.checked=!0),H.checked&&(ae.checked=!0))}}}if(this.updatedRule=null,this.headerTemplate){var me={requestType:"header-template-create",ruleID:p.id,condition:n,notCondition:this.enableNotCondition?o:void 0};this.trigger("actionBegin",me)}else if(this.enableSeparateConnector){var Re=p.querySelector(".e-add-condition-btn"),V=new Tl({cssClass:this.element.id+"_addConditionbtn",content:this.l10n.getConstant("AddCondition")});V.appendTo(Re),V.element.onclick=function(){u.addRuleElement(X(Re,".e-group-container"),{})};var $e=p.querySelector(".e-add-group-btn");V=new Tl({cssClass:this.element.id+"_addGroupbtn",content:this.l10n.getConstant("AddGroup")}),V.appendTo($e),V.element.onclick=function(){u.addGroupElement(!0,X($e,".e-group-container"),"",!0)}}else{var Me=p.querySelector(".e-add-btn"),V=new nH({items:this.items,cssClass:"e-round e-small e-caret-hide e-addrulegroup",iconCss:"e-icons e-add-icon",beforeOpen:this.selectBtn.bind(this,Me),select:this.selectBtn.bind(this,Me)});V.appendTo(Me),Me.setAttribute("title",this.l10n.getConstant("AddButton"))}if(!this.isImportRules&&!this.prvtEvtTgrDaD){var Ze=c.id.replace(this.element.id+"_",""),Je=p.id.replace(this.element.id+"_","");this.trigger("change",{groupID:Ze,type:"insertGroup",childGroupID:Je})}}},t.prototype.setMultiConnector=function(e){if(this.enableSeparateConnector&&!this.headerTemplate&&e.previousElementSibling&&this.groupElem.querySelector(".e-btn-group")){e.parentElement.insertBefore(this.groupTemplate(!0).querySelector(".e-btn-group"),e);var i=e.previousElementSibling.childNodes[0];i.classList.contains("e-qb-toggle")&&(i.style.display="none"),this.addHeaderDiv(e)}},t.prototype.addHeaderDiv=function(e){var i,r=e.previousElementSibling.previousElementSibling;if(r){r.id.indexOf("rule")>-1?i=this.getRule(r):i=this.getGroup(r),m(i.condition)&&(i.condition="and");var n=e.previousElementSibling.querySelector(".e-btngroup-or"),a=e.previousElementSibling.querySelector(".e-btngroup-and");n.disabled=!1,a.disabled=!1,i.condition==="or"?n.checked=!0:a.checked=!0}},t.prototype.headerTemplateFn=function(e,i,r,n,a,o){var l,h=this.element.id+"_header",u,c=e.querySelector(".e-group-header");if(this.enableSeparateConnector&&e.id.indexOf("rule")!==-1&&(c=e),this.headerTemplate){if(u={requestType:"header-template-initialize",ruleID:e.id,notCondition:this.enableNotCondition?i:void 0,condition:r,rule:this.getRuleCollection(n,!1),groupID:a},this.trigger("actionBegin",u),this.enableSeparateConnector&&e.id.indexOf("rule")!==-1&&(u.requestType="rule-template-create"),this.headerFn=this.templateParser(this.headerTemplate),this.isReact)l=this.headerFn(u,this,e.id,h)[0],this.enableSeparateConnector&&o?this.enableSeparateConnectorInitialRule(e,l):this.enableSeparateConnector&&e.id.indexOf("rule")!==-1?c.parentElement.insertBefore(l,c.nextElementSibling):c.appendChild(l);else if(this.isAngular){var f=this.headerFn(u,this,e.id,h);l=f[0].nodeType===3?f[1]:f[0],this.enableSeparateConnector&&o?this.enableSeparateConnectorInitialRule(e,l):this.enableSeparateConnector&&e.id.indexOf("rule")!==-1?c.parentElement.insertBefore(l,c.nextElementSibling):c.appendChild(l)}else if(this.isVue3){if(l=this.headerFn(u,this,e.id,h),this.enableSeparateConnector&&(o||e.id.indexOf("rule")!==-1)){for(var d=0;d<l.length;d++)if(l[d].nodeName==="DIV"){l=l[d];break}}this.enableSeparateConnector&&o?this.enableSeparateConnectorInitialRule(e,l):this.enableSeparateConnector&&e.id.indexOf("rule")!==-1?c.parentElement.insertBefore(l,c.nextElementSibling):at(l,c)}else l=this.headerFn(u,this,"Template",h)[0],this.enableSeparateConnector&&o?this.enableSeparateConnectorInitialRule(e,l):this.enableSeparateConnector&&e.id.indexOf("rule")!==-1?c.parentElement.insertBefore(l,c.nextElementSibling):c.appendChild(l);this.renderReactTemplates()}return e},t.prototype.enableSeparateConnectorInitialRule=function(e,i){var r=e.nextElementSibling?e.nextElementSibling:e,n=r.closest(".e-group-container");!e.nextElementSibling&&n&&(n=n.nextElementSibling?n.nextElementSibling:n),n&&n.parentElement.insertBefore(i,n)},t.prototype.notifyChange=function(e,i,r){var n=X(i,".e-group-container"),a=this.getParentGroup(n),o=X(i,".e-rule-container"),l=0;if(r==="not"){a.not=e;return}if(r==="condition"){this.enableSeparateConnector&&(o=i.parentElement.previousElementSibling,o&&o.classList.contains("e-group-container")&&(o=o.querySelectorAll(".e-rule-container")[o.querySelectorAll(".e-rule-container").length-1]),o&&o.classList.contains("e-rule-container")&&(a=this.getRule(o))),a.condition=e;return}for(;o&&o.previousElementSibling!==null;)o=o.previousElementSibling,(!this.enableSeparateConnector||this.enableSeparateConnector&&(!this.headerTemplate&&!o.classList.contains("e-btn-group")||this.headerTemplate&&(o.classList.contains("e-rule-container")||o.classList.contains("e-group-container"))))&&l++;var h=a.rules[l],u=this.getColumn(h.field),c=this.getFormat(u.format);if(u.type==="date"){if(e instanceof Date)e=this.intl.formatDate(e,c);else if(e instanceof Array)for(var f=0;f<e.length;f++)e[f]&&e[f]instanceof Date&&(e[f]=this.intl.formatDate(e[f],c))}u.ruleTemplate?this.templateChange(i,e,r):(this.isNotified=!0,this.updateRules(i,e),this.isNotified=!1)},t.prototype.templateChange=function(e,i,r){var n=X(e,".e-group-container"),a,o=this.getParentGroup(n),l=X(e,".e-rule-container"),h=0;for(this.allowValidation&&this.validateValue(o,l);l&&l.previousElementSibling!==null;)l=l.previousElementSibling,(!this.enableSeparateConnector||this.enableSeparateConnector&&(!this.headerTemplate&&!l.classList.contains("e-btn-group")||this.headerTemplate&&(l.classList.contains("e-rule-container")||l.classList.contains("e-group-container"))))&&h++;var u=o.rules[h];r==="field"?this.selectedColumn=this.getColumn(i):u&&(this.selectedColumn=this.getColumn(u.field));var c;this.previousColumn=this.getColumn(u.field);var f=this.getValidRules(this.rule);this.selectedColumn&&(this.selectedColumn.operators?c=this.selectedColumn.operators:c=this.customOperators[this.selectedColumn.type+"Operator"]);var d=["in","notin","between","notbetween"],p;switch(r){case"field":u.field=i,u.label=this.selectedColumn.label,u.type=this.selectedColumn.type,u.value="",u.operator=c[0].value;break;case"operator":p=u.operator,u.operator=i,d.indexOf(u.operator)>-1?u.value=[]:d.indexOf(p)>-1&&(u.value="");break;case"value":u.value=i}if(this.changeRuleTemplate(this.selectedColumn,e),this.filterRules(f,this.getValidRules(this.rule),r),this.selectedColumn&&this.selectedColumn.ruleTemplate&&(r==="field"||r==="operator")){var v=X(e,".e-rule-container");this.destroyControls(v,!0),Oe(v.querySelector(".e-rule-field"));var g=this.appendRuleElem(X(v,".e-group-container"),this.selectedColumn,"change",v.id,r,u);this.displayMode==="Vertical"||this.element.className.indexOf("e-device")>-1?g.className="e-rule-container e-vertical-mode":g.className="e-rule-container e-horizontal-mode",this.enableSeparateConnector||g.previousElementSibling&&g.previousElementSibling.className.indexOf("e-rule-container")>-1&&(g.className.indexOf("e-joined-rule")<0&&(g.className+=" e-joined-rule"),g.previousElementSibling.className.indexOf("e-prev-joined-rule")<0&&(g.previousElementSibling.className+=" e-prev-joined-rule")),g.previousElementSibling&&g.previousElementSibling.className.indexOf("e-group-container")>-1&&g.className.indexOf("e-separate-rule")<0&&(g.className+=" e-separate-rule");var b={requestType:"template-create",action:r,ruleID:v.id,fields:this.fields,rule:u};a={groupID:n.id.replace(this.element.id+"_",""),ruleID:v.id.replace(this.element.id+"_",""),value:u.field,type:"field"},this.trigger("actionBegin",b),this.trigger("change",a)}},t.prototype.changeValue=function(e,i){var r=this,n;if(this.isNumInput&&typeof i.value=="number"||i.type==="input"&&i.target&&i.target.classList.contains("e-numerictextbox")&&this.selectedColumn.validation&&(this.selectedColumn.validation.max!==Number.MAX_VALUE||this.selectedColumn.validation.min>0)){this.isNumInput=!1;return}if(i.element&&i.element.classList.contains("e-multiselect")){var a=i;n=a.element}else i.event?n=i.event.target:i.type==="input"&&i.target&&i.target.classList.contains("e-numerictextbox")?n=i.currentTarget:n=i.element;if(n){if(n.className.indexOf("e-day")>-1||n.className.indexOf("e-today")>-1||n.className.indexOf("e-cell")>-1){var o=i;n=o.element}var l=X(n,".e-group-container"),h=X(n,".e-rule-container"),u=l&&l.id.replace(this.element.id+"_",""),c=h.id.replace(this.element.id+"_",""),f=i,d;f.element&&f.element.className.indexOf("e-datepicker")>-1&&(n=f.element,d=He(X(n,".e-rule-container").querySelector(".e-filter-input"),"dropdownlist"),d&&(this.selectedColumn=d.getDataByValue(d.value)),d=He(X(n,".e-rule-container").querySelector(".e-filter-input"),"dropdowntree"),d&&(this.selectedColumn=this.getColumn(d.value[0])));var p,v;if(n.className.indexOf("e-radio")>-1)if(v=parseInt(n.id.split("valuekey")[1],10),this.fieldMode==="Default"?(d=He(X(n,".e-rule-container").querySelector(".e-filter-input"),"dropdownlist"),this.selectedColumn=d.getDataByValue(d.value),this.selectedColumn.columns&&(d=He(X(n,".e-rule-container").querySelector(".e-rule-sub-filter .e-dropdownlist"),"dropdownlist"),this.selectedColumn=this.getColumn(d.value))):(d=He(X(n,".e-rule-container").querySelector(".e-filter-input"),"dropdowntree"),this.selectedColumn=this.getColumn(d.value[0])),this.selectedColumn.values)p=this.selectedColumn.values[v];else{var g=[!0,!1];p=g[v]}else if(n.className.indexOf("e-multiselect")>-1)p=He(n,"multiselect").value;else if(p=i.value,i.type==="input"&&i.target&&i.target.classList.contains("e-numerictextbox")){p=Number(i.currentTarget.value);var b=i.currentTarget,C=fn(b,hd),y=ie("decimal",to(this.locale));isNaN(p)&&b.value.indexOf(y)!==-1&&(p=this.intl.getNumberParser({format:"n"})(b.value)),isNaN(p)||(C.value=p),this.isNumInput=!0}i.name==="input"&&this.immediateModeDelay?(window.clearInterval(this.timer),this.timer=window.setInterval(function(){r.filterValue(u,c,p,e,n)},this.immediateModeDelay)):this.filterValue(u,c,p,e,n)}},t.prototype.filterValue=function(e,i,r,n,a){var o=this,l={groupID:e,ruleID:i,value:r,cancel:!1,type:"value"};window.clearInterval(this.timer),this.isImportRules?this.changeValueSuccessCallBack(l,a,n,e,i):this.trigger("beforeChange",l,function(h){o.changeValueSuccessCallBack(h,a,n,e,i)})},t.prototype.changeValueSuccessCallBack=function(e,i,r,n,a){e.cancel||(this.updateRules(i,e.value,r),this.isImportRules||this.trigger("change",{groupID:n,ruleID:a,value:e.value,cancel:!1,type:"value"}))},t.prototype.fieldClose=function(e){if(!(this.isFieldChange||this.isDestroy)){this.isFieldClose=!0;var i=He(e,"dropdownlist"),r=i.popupObj&&i.popupObj.element.querySelector(".e-active"),n=i.getItemData();i.value=n.value;var a={element:i.element,value:n.value,isInteracted:!0,previousItemData:this.prevItemData,previousItem:null,item:r,itemData:n,event:null,e:null};i.previousValue!==i.value&&this.changeField(a),this.isFieldChange=!1}},t.prototype.changeField=function(e){if(e.isInteracted){if(m(e.value))return;this.isFieldChange=!0,this.prevItemData=e.itemData;var i=X(e.element,".e-rule-filter")||X(e.element,".e-rule-sub-filter"),r=this.fieldMode==="DropdownTree"?this.getColumn(e.value[0]):this.getColumn(e.value);if(this.fieldMode==="DropdownTree"&&i!==null){var n=i.querySelector(".e-dropdowntree.e-control"),a=He(n,"dropdowntree");if(r){if(r.type==="object"){if(a.value=e.oldValue,a.dataBind(),m(e.oldValue))n.value="";else{var o=this.getLabelFromColumn(e.oldValue[0]);n.value=o}return}else if(!m(e.value[0])){a.value=e.value[0],a.dataBind();var o=this.getLabelFromColumn(e.value[0]);n.value=o}}else return}if(this.destroySubFields(i),this.subFieldElem=null,this.isNotValueChange=!0,r&&r.ruleTemplate)this.templateChange(e.element,r.field,"field");else if(r&&r.columns&&r.columns[0].ruleTemplate)this.templateChange(e.element,r.columns[0].field,"field");else{for(var l=X(e.element,".e-group-container"),h=this.getParentGroup(l),u=X(e.element,".e-rule-container"),c=0;u&&u.previousElementSibling!==null;)u=u.previousElementSibling,(!this.enableSeparateConnector||this.enableSeparateConnector&&(!this.headerTemplate&&!u.classList.contains("e-btn-group")||this.headerTemplate&&(u.classList.contains("e-rule-container")||u.classList.contains("e-group-container"))))&&c++;h.rules[c].value="",this.changeRule(h.rules[c],e)}}},t.prototype.changeRule=function(e,i){if(!i.itemData)if(this.fieldMode==="DropdownTree"){var r=He(i.element,"dropdowntree");if(r.value==null)return}else return;var n={},a=X(i.element,".e-rule-filter");a=a||X(i.element,".e-rule-sub-filter");var o=He(i.element,"dropdownlist");this.fieldMode==="DropdownTree"&&a!==null&&(o=He(i.element,"dropdowntree"));var l=X(i.element,".e-group-container"),h=l.id.replace(this.element.id+"_","");this.changeFilter(a,o,h,e,n,i)},t.prototype.changeFilter=function(e,i,r,n,a,o){var l=this;if(e){var h=void 0;this.fieldMode==="DropdownTree"?h=i.value[0]:h=this.isImportRules?this.GetRootColumnName(i.value):i.value,this.selectedColumn=this.getColumn(h);var u=X(e,".e-rule-container"),c=u.id.replace(this.element.id+"_",""),f={groupID:r,ruleID:c,selectedField:this.fieldMode==="DropdownTree"?i.value[0]:i.value,cancel:!1,type:"field"};!this.isImportRules&&!this.prvtEvtTgrDaD?this.trigger("beforeChange",f,function(p){l.fieldChangeSuccess(p,a,e,n,o)}):this.fieldChangeSuccess(f,a,e,n,o)}else{var d=X(o.element,".e-rule-operator");this.changeOperator(e,d,i,r,n,a,o)}},t.prototype.changeOperator=function(e,i,r,n,a,o,l){var h=this,u,c,f;i?(u=X(i,".e-rule-container"),c=u.id.replace(this.element.id+"_",""),f={groupID:n,ruleID:c,selectedIndex:r.index,cancel:!1,type:"operator"},this.isImportRules?this.operatorChangeSuccess(f,e,o,a,l):this.trigger("beforeChange",f,function(d){h.operatorChangeSuccess(d,e,o,a,l)})):this.changeRuleValues(e,a,o,l)},t.prototype.fieldChangeSuccess=function(e,i,r,n,a){for(var o=X(r,".e-rule-container"),l=X(a.element,".e-rule-operator"),h=X(a.element,".e-group-container"),u=h.id.replace(this.element.id+"_",""),c=He(a.element,"dropdownlist"),f=o.querySelectorAll(".e-tooltip.e-input-group"),d=0;d<f.length;d++)He(f[d],"tooltip").destroy();if(e.cancel)this.changeOperator(r,l,c,u,n,i,a);else{if(m(this.selectedColumn))return;if(i.type=this.selectedColumn.type,o.querySelector(".e-template")&&(n.value=""),this.selectedColumn.type==="object"&&this.fieldMode==="Default")for(i.type=this.selectedColumn.columns[0].type;this.selectedColumn.columns;)this.createSubFields(r,n,i,a);else this.destroySubFields(r),this.changeOperator(r,l,c,u,n,i,a)}},t.prototype.destroySubFields=function(e){for(;e&&e.nextElementSibling.classList.contains("e-rule-sub-filter");)this.destroyControls(e),e.nextElementSibling.remove()},t.prototype.createSubFields=function(e,i,r,n){var a=!1,o=X(e,".e-rule-field"),l=this.createElement("div",{attrs:{class:"e-rule-sub-filter",id:"subfilter"+this.subFilterCounter}});o.insertBefore(l,o.querySelector(".e-rule-operator"));var h=X(l,".e-rule-container").id,u=this.createElement("input",{attrs:{type:"text",id:h+"_subfilterkey"+this.subFilterCounter}});l.appendChild(u);var c=this.element.className.indexOf("e-device")>-1?"250px":"200px",f;f={dataSource:this.selectedColumn.columns,fields:this.fields,placeholder:this.l10n.getConstant("SelectField"),popupHeight:this.selectedColumn.columns.length>5?c:"auto",change:this.changeField.bind(this),index:0,open:this.popupOpen.bind(this,!1)},this.fieldModel&&(f=Cr({},f,this.fieldModel));var d=new vu(f);if(d.appendTo("#"+h+"_subfilterkey"+this.subFilterCounter),this.isImportRules||this.previousColumn&&this.previousColumn.ruleTemplate&&this.GetRootColumnName(i.field)===this.GetRootColumnName(this.previousColumn.field)){for(var p=this.selectedColumn.columns,v=0;v<p.length;v++)if(i.field===p[v].field||i.field.indexOf(p[v].field+this.separator)>-1){d.value=p[v].field,this.selectedColumn=p[v],a=!0;break}}this.subFilterCounter++,this.subFieldElem=u,n.itemData=n.itemData,!a&&this.selectedColumn.columns&&(!a&&this.isImportRules&&(d.value=null),this.selectedColumn=this.selectedColumn.columns[0]),this.previousColumn=this.selectedColumn,this.selectedColumn.columns||this.changeRuleValues(l,i,r,n)},t.prototype.operatorChangeSuccess=function(e,i,r,n,a){if(!e.cancel){var o=X(a.element,".e-rule-operator"),l=o.nextElementSibling,h=He(a.element,"dropdownlist"),u=n.operator?n.operator.toString().toLowerCase():"";r.operator=h.value.toString();var c=r.operator.toLowerCase();if(r.operator.toLowerCase().indexOf("between")>-1||r.operator.toLowerCase().indexOf("in")>-1&&r.operator.toLowerCase().indexOf("contains")<0?(i=o.previousElementSibling,r.type=n.type,(r.operator.toLowerCase().indexOf("in")<0||u.indexOf("in")<0)&&(n.value=[])):typeof n.value=="object"&&n.value!==null&&(n.value=n.value.length>0?n.value[0]:n.type==="number"?0:""),a.previousItemData){var f=a.previousItemData.value.toString().toLowerCase();(f.indexOf("between")>-1||(f.indexOf("in")>-1||f.indexOf("null")>-1||f.indexOf("empty")>-1)&&f.indexOf("contains")<0)&&(i=o.previousElementSibling,r.type=n.type)}if(u.indexOf("in")>-1&&u.indexOf("in")<5&&c.indexOf("in")>-1&&c.indexOf("in")<5&&(i=null),r.operator.indexOf("null")>-1||r.operator.indexOf("empty")>-1){var d=o.parentElement.querySelector(".e-rule-value"),p=d.querySelector(".e-tooltip.e-input-group");p&&He(p,"tooltip").destroy(),Z([d],"e-show"),P([d],"e-hide")}l&&this.getColumn(n.field).template&&(i=o.previousElementSibling),l.children.length===0&&(i=o.previousElementSibling),this.changeRuleValues(i,n,r,a)}},t.prototype.changeRuleValues=function(e,i,r,n){var a=X(n.element,".e-rule-operator"),o,l,h,u;if(e)if(a=e.nextElementSibling,e.classList.contains("e-rule-sub-filter")&&(r.type=this.selectedColumn.type,o=a.classList.contains("e-rule-sub-filter"),a=o?a.nextElementSibling:a),P([a],"e-operator"),a.childElementCount){l=He(a.querySelector(".e-dropdownlist"),"dropdownlist"),r.operator=l.value;var c=void 0;this.fieldMode==="DropdownTree"?c=He(e.querySelector(".e-dropdowntree"),"dropdowntree"):c=He(e.querySelector(".e-dropdownlist"),"dropdownlist"),r.type=this.fieldMode==="DropdownTree"?this.getColumn(c.value[0]).type:this.getColumn(c.value).type;var f=n.itemData;l.value!==""&&this.renderValues(a,f,n.previousItemData,!0,i,r,n.element)}else{var d=X(a,".e-rule-container").id;u=this.createElement("input",{attrs:{type:"text",id:d+"_operatorkey"}}),a.appendChild(u),this.selectedColumn.operators?h=this.selectedColumn.operators:n.itemData&&(h=this.customOperators[this.selectedColumn.type+"Operator"]);var p=this.element.className.indexOf("e-device")>-1?"250px":"200px",v;i.operator&&h.forEach(function(x){"value"in x&&typeof x.value=="string"&&x.value.toLowerCase()===i.operator.toLowerCase()&&(v=x.value)});var g=v||h[0].value,b=0;this.autoSelectOperator||(g="",b=-1),(this.isImportRules||this.ruleIndex>-1||this.groupIndex>-1||this.prvtEvtTgrDaD)&&(g=i&&i.operator?i.operator:g);var C=void 0;C={dataSource:h,fields:{text:"key",value:"value"},placeholder:this.l10n.getConstant("SelectOperator"),popupHeight:h.length>5?p:"auto",change:this.changeField.bind(this),index:b,value:g,open:this.popupOpen.bind(this,!1)},this.operatorModel&&(C=Cr({},C,this.operatorModel));var y=new vu(C);y.appendTo("#"+d+"_operatorkey"),r.operator=i&&i.operator!==""&&!m(i.operator)?i.operator:h[0].value,this.isImportRules&&(r.type=this.selectedColumn.type,r.operator=i.operator),!m(g)&&g!==""?this.renderValues(a,this.selectedColumn,n.previousItemData,!1,i,r,n.element):this.autoSelectField&&this.autoSelectOperator&&this.renderValues(a,this.selectedColumn,n.previousItemData,!1,i,r,n.element)}this.isImportRules||this.updateRules(n.element,n.item)},t.prototype.popupOpen=function(e,i){this.enableRtl&&P([i.popup.element],"e-rtl"),e&&(this.isFieldClose=!1)},t.prototype.destroyControls=function(e,i){for(var r=i?e:e.nextElementSibling,n=r.querySelectorAll("input.e-control"),a=r.querySelectorAll("div.e-control:not(.e-handle)"),o=this.columns,l=0,h=n.length;l<h;l++){if(n[l].classList.contains("e-textbox"))He(n[l],"textbox").destroy(),Oe(ye("input#"+n[l].id,r));else if(n[l].classList.contains("e-dropdownlist"))this.allowValidation&&n[l].parentElement.className.indexOf("e-tooltip")>-1&&He(n[l].parentElement,"tooltip").destroy(),He(n[l],"dropdownlist").destroy();else if(n[l].classList.contains("e-radio"))He(n[l],"radio").destroy();else if(n[l].classList.contains("e-numerictextbox"))He(n[l],"numerictextbox").destroy(),Oe(ye("input#"+n[l].id,r));else if(n[l].classList.contains("e-datepicker"))He(n[l],"datepicker").destroy();else if(n[l].classList.contains("e-multiselect"))He(n[l],"multiselect").destroy();else if(n[l].className.indexOf("e-template")>-1){for(var u=n[l].className,c=0,f=o.length;c<f;c++)if(o[c].template&&u.indexOf(o[c].field)>-1){this.templateDestroy(o[c],n[l].id);break}}document.getElementById(n[l].id)&&Oe(n[l])}for(var l=0,h=a.length;l<h;l++){if(a[l].className.indexOf("e-template")>-1){for(var u=a[l].className,c=0,f=o.length;c<f;c++)if(o[c].template&&u.indexOf(o[c].field)>-1){this.templateDestroy(o[c],a[l].id);break}}Oe(a[l])}for(var d=r.querySelectorAll(".e-template:not(.e-control)"),l=0,h=d.length;l<h;l++)Oe(d[l])},t.prototype.templateDestroy=function(e,i){var r;if(typeof e.template!="string"||e.template.destroy===void 0)r=e.template;else return;var n=r.destroy;if(r.destroy){var a=void 0;document.getElementById(i)&&(a=X(document.getElementById(i),".e-rule-field").querySelectorAll(".e-template")),typeof n=="string"?(n=ie(n,window),n({field:e.field,elementId:i,elements:a})):r.destroy({field:e.field,elementId:i,elements:a})}},t.prototype.getValues=function(e){var i={},r=[],n,a=[];this.separator.length>0&&(a=e.split(this.separator));var o=this.dataColl;if(this.dataColl[1])for(var l=0,h=o.length;l<h;l++){var u={};if(a.length>1)for(var c=o[l],f=void 0,d=0,p=a.length;d<p;d++)f=a[d],a.length===d+1?(n=c[""+f],Number(c[""+f])===c[""+f]&&c[""+f]%1!==0&&(n=c[""+f].toString())):c=c[""+f];else n=o[l][""+e],Number(o[l][""+e])===o[l][""+e]&&o[l][""+e]%1!==0&&(n=o[l][""+e].toString());n in i||(i[""+n]=1,a.length>1?this.createNestedObject(u,a,n):u[""+e]=n,r.push(u))}return r},t.prototype.createNestedObject=function(e,i,r){for(var n,a=i.length-1,o=0;o<a;++o)n=i[o],n in e||(e[""+n]={}),e=e[""+n];e[i[a]]=r},t.prototype.getDistinctValues=function(e,i){for(var r={},n=[],a=[],o="",l=i.indexOf(this.separator),h=function(d,p){o="",l===0?o=e[d][""+i]:(a=i.split(u.separator),a.forEach(function(g){o?o=o[""+g]:o=e[d][""+g]})),Number(e[d][""+i])===e[d][""+i]&&e[d][""+i]%1!==0&&(o=e[d][""+i].toString());var v={};o in r||(r[""+o]=1,l===0?v[""+i]=o:v[a[a.length-1]]=o,n.push(v))},u=this,c=0,f=e.length;c<f;c++)h(c);return n},t.prototype.renderMultiSelect=function(e,i,r,n,a){var o=!1,l,h=!1;this.isGetNestedData=!1,this.dataColl[1]&&Object.keys(this.dataColl[1]).indexOf(e.field)>-1&&(o=!0,l=this.getDistinctValues(this.dataColl,e.field)),o=e.columns?!1:o,!this.dataColl.length&&a.length&&(h=!0);var u;u={dataSource:h?a:o?l:this.dataManager,query:new We([e.field]),fields:{text:this.selectedRule.field,value:this.selectedRule.field},placeholder:this.l10n.getConstant("SelectValue"),value:n,mode:"CheckBox",width:"100%",change:this.changeValue.bind(this,r),close:this.closePopup.bind(this,r),actionBegin:this.multiSelectOpen.bind(this,i+"_valuekey"+r),open:this.popupOpen.bind(this,!1)},this.valueModel&&this.valueModel.multiSelectModel&&(u=Cr({},u,this.valueModel.multiSelectModel));var c=new Ed(u);c.appendTo("#"+i+"_valuekey"+r),this.updateRules(c.element,n,0)},t.prototype.multiSelectOpen=function(e,i){if(this.dataSource instanceof fe){var r=document.getElementById(e),n=He(X(r,".e-rule-container").querySelector(".e-filter-input"),this.fieldMode==="DropdownTree"?"dropdowntree":"dropdownlist");this.fieldMode==="DropdownTree"?this.selectedColumn=this.getColumn(n.value[0]):this.selectedColumn=n.getDataByValue(n.value);var a=this.selectedColumn.field,o=!1;if(this.dataColl[1]){Object.keys(this.dataColl[1]).indexOf(a)>-1&&(o=!0);var l=a.indexOf(this.separator);l!==0&&this.isGetNestedData&&(o=!0)}o||(i.cancel=!0,this.bindMultiSelectData(r,a))}},t.prototype.bindMultiSelectData=function(e,i){this.getMultiSelectData(e,i)},t.prototype.getMultiSelectData=function(e,i){var r=this,n,a=new dn,o=this.dataManager.executeQuery(new We().select(i)),l=He(e,"multiselect");l.hideSpinner(),this.createSpinner(X(e,".e-multi-select-wrapper").parentElement),Yc(X(e,".e-multi-select-wrapper").parentElement),o.then(function(h){h.actual&&h.actual.result?n=h.actual.result:n=h.result,r.dataColl=Ue(r.dataColl,n,[],!0),l.dataSource=r.getDistinctValues(r.dataColl,i),r.isGetNestedData=!0,Jc(X(e,".e-multi-select-wrapper").parentElement)}).catch(function(h){a.reject(h)})},t.prototype.createSpinner=function(e){var i=this.createElement("span",{attrs:{class:"e-qb-spinner"}});e.appendChild(i),Kc({target:i,width:xe.isDevice?"16px":"14px"})},t.prototype.closePopup=function(e,i){var r=document.getElementById(i.popup.element.id.replace("_popup",""));if(r){var n=He(r,"multiselect");if(n){var a=n.value;this.updateRules(r,a,e)}}},t.prototype.processTemplate=function(e,i,r,n){var a=X(e,".e-rule-container"),o=a.querySelectorAll(".e-template"),l=a.querySelector(".e-rule-filter .e-filter-input"),h=this.fieldMode==="DropdownTree"?He(l,"dropdowntree"):He(a.querySelector(".e-rule-filter .e-filter-input"),"dropdownlist"),u=this.fieldMode==="DropdownTree"?this.getColumn(h.value[0]):this.getColumn(h.value);if(typeof i.template=="string"||i.template.write===void 0){var c={rule:r,ruleID:a.id,operator:n.operator,field:u.field,requestType:"value-template-create"};this.trigger("actionBegin",c)}else{var f=i.template;typeof f.write=="string"?ie(f.write,window)({elements:o.length>1?o:o[0],values:r.value,operator:n.operator,field:u.field,dataSource:u.values}):typeof i.template!="function"&&i.template.write({elements:o.length>1?o:o[0],values:r.value,operator:n.operator,field:u.field,dataSource:u.values})}},t.prototype.getItemData=function(e){var i=He(document.getElementById(e+"_filterkey"),"dropdownlist"),r=this.element.querySelector("#"+e);if(this.fieldMode==="DropdownTree")i=He(document.getElementById(e+"_filterkey"),"dropdowntree");else if(r){var n=r.querySelectorAll(".e-rule-sub-filter");if(n.length>0){var a=n[n.length-1].querySelector(".e-dropdownlist");i=He(a,"dropdownlist")}}return this.fieldMode==="DropdownTree"?this.getColumn(i.value[0]):this.getColumn(i.value)},t.prototype.setDefaultValue=function(e,i,r){var n=this.getItemData(e);if(m(n.value))return r?i?[0,0]:0:i?[]:"";if(i){if(!(n.value instanceof Array))return[n.value]}else if(n.value instanceof Array)return n.value[0];return n.value},t.prototype.renderStringValue=function(e,i,r,n,a){var o,l=this.getItemData(e),h,u=typeof l.template=="string";if(this.isImportRules||this.ruleIndex>-1||this.groupIndex>-1||this.isPublic||u||i.value!==""?h=i.value:h=this.setDefaultValue(e,!1,!1),(r==="in"||r==="notin")&&(this.dataColl.length||l.values))o=this.isImportRules||this.ruleIndex>-1||this.groupIndex>-1||this.isPublic?i.value:this.setDefaultValue(e,!0,!1),this.renderMultiSelect(l,e,n,o,l.values),this.displayMode==="Vertical"||this.element.className.indexOf("e-device")>-1?a.style.width="100%":(a.style.width=null,a.style.minWidth="200px");else{(r==="in"||r==="notin")&&(o=this.isImportRules||this.ruleIndex>-1||this.groupIndex>-1?i.value:this.setDefaultValue(e,!0,!1),h=o.join(",")),(r==="between"||r==="notbetween")&&h.length>1&&(h=h[n]);var c=void 0;c={placeholder:this.l10n.getConstant("SelectValue"),input:this.changeValue.bind(this,n)},this.valueModel&&this.valueModel.textBoxModel&&(c=Cr({},c,this.valueModel.textBoxModel));var f=new qu(c);f.appendTo("#"+e+"_valuekey"+n),f.value=h,f.dataBind()}},t.prototype.renderNumberValue=function(e,i,r,n,a,o,l){var h=this.getItemData(e),u=typeof h.template=="string",c=this.isImportRules||this.ruleIndex>-1||this.groupIndex>-1||this.isPublic||u||typeof i.value=="number"?i.value:this.setDefaultValue(e,!1,!0);if((r==="in"||r==="notin")&&(this.dataColl.length||h.values))c=this.isImportRules||this.ruleIndex>-1||this.groupIndex>-1||this.isPublic?i.value:this.setDefaultValue(e,!0,!1),this.renderMultiSelect(h,e,n,c,h.values),this.element.className.indexOf("e-device")>-1||this.displayMode==="Vertical"?a.style.width="100%":(a.style.minWidth="200px",a.style.width=null);else if(r==="in"||r==="notin"){c=this.isImportRules||this.ruleIndex>-1||this.groupIndex>-1?i.value:this.setDefaultValue(e,!0,!1);var f=c.join(","),d=void 0;d={placeholder:this.l10n.getConstant("SelectValue"),input:this.changeValue.bind(this,n)},this.valueModel&&this.valueModel.textBoxModel&&(d=Cr({},d,this.valueModel.textBoxModel));var p=new qu(d);p.appendTo("#"+e+"_valuekey"+n),p.value=f,p.dataBind()}else{o=h;var v=o.validation&&o.validation.min?o.validation.min:0,g=o.validation&&o.validation.max?o.validation.max:Number.MAX_VALUE,b=o.format?o.format:"n";l>1&&i&&(c=i.value[n]?i.value[n]:this.setDefaultValue(e,!0,!0));var C=void 0;C={value:c instanceof Array?c[n]:c,format:b,min:v,max:g,width:"100%",step:o.step?o.step:1,change:this.changeValue.bind(this,n)},this.valueModel&&this.valueModel.numericTextBoxModel&&(C=Cr({},C,this.valueModel.numericTextBoxModel));var y=new hd(C);y.appendTo("#"+e+"_valuekey"+n),y.element.setAttribute("aria-label",o.label+" Value"),y.element.oninput=this.changeValue.bind(this,n)}},t.prototype.processValueString=function(e,i){var r=[],n=e.split(",");if(i==="string")return n;for(var a=0,o=n.length;a<o;a++)r.push(Number(n[a]));return r},t.prototype.parseDate=function(e,i){var r,n;if(i){var a=this.intl.getDateParser({skeleton:"full",type:"dateTime"});r=this.getFormat(i),n=a(e),m(n)&&(n=this.intl.parseDate(e,r))}else n=new Date(e);return n},t.prototype.renderControls=function(e,i,r,n,a){if(P([e.parentElement.querySelector(".e-rule-value")],"e-value"),Z([e.parentElement.querySelector(".e-rule-value")],"e-hide"),P([e.parentElement.querySelector(".e-rule-value")],"e-show"),i.template&&(i.template.create||a))this.processTemplate(e,i,r,n);else{var o;n.type==="boolean"?o=this.selectedColumn.values?this.selectedColumn.values.length:2:o=n.operator&&n.operator.toString().toLowerCase().indexOf("between")>-1?2:1;var l=X(e,".e-rule-container").id,h=void 0,u=n.operator.toString();if(e.className.indexOf("e-rule-operator")>-1||e.className.indexOf("e-rule-filter")>-1){h=e.parentElement.querySelector(".e-rule-value"),this.element.className.indexOf("e-device")>-1||this.displayMode==="Vertical"?h.style.width="100%":u!=="in"&&u!=="notin"?P([h],"e-custom-value"):Z([h],"e-custom-value");for(var c=0;c<o;c++)switch(n.type){case"string":this.renderStringValue(l,r,u,c,h);break;case"number":this.renderNumberValue(l,r,u,c,h,i,o);break;case"boolean":this.processBoolValues(i,r,l,c);break;case"date":{var f=new Date,d=void 0,p=void 0,v=i.format,g=void 0,b=void 0,C=this.l10n.getConstant("SelectValue"),y=typeof i.template=="string";if(r.value&&!m(v)&&(d=o>1?r.value[c]:r.value,f=this.parseDate(d,v)||new Date),!i.field&&!i.key&&i.value&&(i.value instanceof Date?f=i.value:f=this.parseDate(i.value,i.format)),!i.format&&r&&r.field!==""&&(p=this.getColumn(r.field),v=p.format),(this.isImportRules||this.isPublic||y)&&r&&(p=this.getColumn(r.field),v=p.format,r.value?(d=o>1?r.value[c]:r.value,f=this.parseDate(d,p.format)):f=r.value),v){var x=this.getFormat(v);x.skeleton?(b={locale:this.getLocale(),value:f,placeholder:C,format:x,change:this.changeValue.bind(this,c)},this.valueModel&&this.valueModel.datePickerModel&&(b=Cr({},b,this.valueModel.datePickerModel)),g=new Mu(b)):(b={value:f,locale:this.getLocale(),placeholder:C,format:x.format,change:this.changeValue.bind(this,c)},this.valueModel&&this.valueModel.datePickerModel&&(b=Cr({},b,this.valueModel.datePickerModel)),g=new Mu(b))}else b={locale:this.getLocale(),value:f,placeholder:C,change:this.changeValue.bind(this,c)},this.valueModel&&this.valueModel.datePickerModel&&(b=Cr({},b,this.valueModel.datePickerModel)),g=new Mu(b);if(g.appendTo("#"+l+"_valuekey"+c),!r.value){var w=document.getElementById(l+"_valuekey"+c);this.updateRules(w,f,null,this.isNotValueChange),this.isNotValueChange=!1}}break}}}},t.prototype.processBoolValues=function(e,i,r,n){var a=!1,o,l;m(i.type)&&e&&(i.type=e.type);var h;if(e.values){var u=e.values;i.type==="boolean"&&!m(i.value)?a=u[n].toLowerCase()===i.value.toString().toLowerCase():e.value?a=u[n].toLowerCase()===e.value.toString().toLowerCase():n===0&&(a=!0),l=o=h=u[n]}else{var u=[!0,!1];i.type==="boolean"&&!m(i.value)?a=u[n].toString().toLowerCase()===i.value.toString().toLowerCase():e.value?a=u[n].toString().toLowerCase()===e.value.toString().toLowerCase():n===0&&(typeof i.value=="boolean"?a=!!i.value:a=!0),typeof i.value=="boolean"&&n===1&&(a=!i.value),o=u[n].toString(),l=u[n],h=this.l10n.getConstant(["True","False"][n])}var c;c={label:h,name:r+"default",checked:a,value:o,change:this.changeValue.bind(this,n)},this.valueModel&&this.valueModel.radioButtonModel&&(c=Cr({},c,this.valueModel.radioButtonModel));var f=new qg(c);f.appendTo("#"+r+"_valuekey"+n),a&&this.updateRules(f.element,l,0,!0)},t.prototype.getOperatorIndex=function(e,i){var r,n=e.dataSource,a=n.length;for(r=0;r<a;r++)if(i.operator===e.dataSource[r].value)return r;return 0},t.prototype.getPreviousItemData=function(e,i){return this.isFieldClose&&e&&(e=this.getColumn(e.value?e.value:e.field)),i&&i.template&&e&&Object.keys(e).length<4&&(e.template=i.template),e},t.prototype.renderValues=function(e,i,r,n,a,o,l){var h=e.previousElementSibling,u=h.getElementsByTagName("input")[0],c=this.fieldMode==="DropdownTree"?He(u,"dropdowntree"):He(u,"dropdownlist"),f=this.fieldMode==="DropdownTree"?this.getColumn(c.value[0]):this.getColumn(c.value);this.selectedRule=f;var d=He(e.querySelector("input"),"dropdownlist");n&&(i=l.id.indexOf("operator")>-1?i:this.selectedRule,i.operators&&(d.value=null,d.dataBind(),d.dataSource=i.operators,d.index=this.getOperatorIndex(d,a),d.value=o.operator=d.dataSource[d.index].value,this.autoSelectOperator?d.dataBind():(d.index=-1,o.operator=d.value="")));var p=o.operator.toString(),v=!1;if(p.indexOf("null")>-1||p.indexOf("isempty")>-1||p.indexOf("isnotempty")>-1){var C=e.parentElement.querySelector(".e-rule-value");C&&(Z([C],"e-show"),P([C],"e-hide"))}else{var g=X(e,".e-rule-container").id;if(r=this.getPreviousItemData(r,f),r&&r.template===void 0?r.columns&&(r=this.getColumn(a.field)):this.fieldMode==="DropdownTree"&&r===void 0&&(r=this.getColumn(a.field)),r&&r.template){this.templateDestroy(r,g+"_valuekey0");var b=ye("#"+g+"_valuekey0",e.nextElementSibling);b&&!b.classList.contains("e-control")&&Oe(ye("#"+g+"_valuekey0",e.nextElementSibling)),(typeof r.template=="string"||r.template.create===void 0)&&(e.nextElementSibling.classList.contains("e-template-value")&&this.clearQBTemplate([g]),e.nextElementSibling.innerHTML=""),this.isAngular&&!m(r.key)&&this.fieldMode==="DropdownTree"&&delete r.template}if(n&&(this.validateValue(a,X(e,".e-rule-container")),this.destroyControls(e)),this.isImportRules||d&&d.value!==""){if(f&&(i.template=f.template),i.template&&(P([e.nextElementSibling],"e-template-value"),i.template=f.template,v=this.setColumnTemplate(i,g,f.field,i.value||p,e,a)),v){var C=e.parentElement.querySelector(".e-rule-value");this.element.className.indexOf("e-device")>-1||this.displayMode==="Vertical"?C.style.width="100%":C.style.width="200px"}else{Z([e.nextElementSibling],"e-template-value");var y=1;o.type==="boolean"?y=this.selectedColumn.values?this.selectedColumn.values.length:2:y=p&&p.toLowerCase().indexOf("between")>-1?2:1;for(var x=0;x<y;x++){var w=this.createElement("input",{attrs:{type:"text",id:g+"_valuekey"+x}});e.nextElementSibling.appendChild(w)}}this.renderControls(e,i,a,o,v),this.isAngular&&!m(i.key)&&i.template&&this.fieldMode==="DropdownTree"&&delete i.template}}},t.prototype.setColumnTemplate=function(e,i,r,n,a,o){var l=this,h,u=!0;if(e.template){if(typeof e.template=="string"||e.template.create===void 0)return h={requestType:"value-template-initialize",ruleID:i,field:r,operator:n,rule:o,renderTemplate:!0},this.trigger("actionBegin",h,function(v){u=l.actionBeginSuccessCallBack(v,e,i,r,a)}),u;var c=void 0,f=e.template;if(typeof f.create=="string"?c=ie(f.create,window)({field:r,operator:n}):c=f.create({field:r,operator:n}),c instanceof Element)c.id=i+"_valuekey0",P([c],"e-template"),a.nextElementSibling.appendChild(c),r.indexOf(" ")<0&&P([c],"e-"+r);else if(c instanceof Array){P(c,"e-template");for(var d=0,p=c.length;d<p;d++)c[d].id=i+"_valuekey"+d,a.nextElementSibling.appendChild(c[d])}return P([a.nextElementSibling],"e-template-value"),!0}else return!0},t.prototype.actionBeginSuccessCallBack=function(e,i,r,n,a){if(e.renderTemplate){var o=void 0;this.columnTemplateFn=this.templateParser((typeof i.template=="function",i.template));var l=this.element.id+n;if(this.isReact)o=this.columnTemplateFn(e,this,r,l)[0],a.nextElementSibling.appendChild(o);else if(this.isAngular){var h=this.columnTemplateFn(e,this,r,l);o=h[0].nodeType===3?h[1]:h[0],a.nextElementSibling.appendChild(o)}else this.isVue3?(o=this.columnTemplateFn(e,this,"Template",l),at(o,a.nextElementSibling)):(o=this.columnTemplateFn(e,this,"Template",l)[0],a.nextElementSibling.appendChild(o));return P([a.nextElementSibling],"e-template-value"),this.renderReactTemplates(),!0}else return!1},t.prototype.updateValues=function(e,i){var r=1;e.className.indexOf("e-template")>-1&&(r=3);var n=e.className.split(" e-")[r],a=parseInt(e.id.slice(-1),2),o,l,h,u,c,f;switch(n){case"checkbox":u=He(e,n).value,i.value=u!==""?u:void 0;break;case"textbox":f=He(e,n).value,i.operator.indexOf("between")>-1?(typeof i.value=="string"&&(i.value=[]),i.value[a]=f):i.value=f;break;case"dropdownlist":i.value=He(e,n).value;break;case"radio":c=He(e,n),c.checked&&(typeof i.value=="boolean"?i.value=c.value==="true":this.getColumn(i.field).values?i.value=c.value:i.value=c.value==="true"),c.refresh();break;case"numerictextbox":i.operator.indexOf("between")>-1?(typeof i.value=="string"&&(i.value=[]),i.value[a]=He(e,n).value):i.value=He(e,n).value;break;case"datepicker":o=this.getColumn(i.field),l=this.getFormat(o.format),h=He(e,n).value,i.operator.indexOf("between")>-1?(typeof i.value=="string"&&(i.value=[]),i.value[a]=this.intl.formatDate(h,l)):m(l.format)&&h?i.value=this.intl.formatDate(h):h?i.value=this.intl.formatDate(h,l):i.value=h;break;case"multiselect":i.value=He(e,n).value;break}},t.prototype.updateRules=function(e,i,r,n){for(var a=X(e,".e-group-container"),o=this.getParentGroup(a),l=X(e,".e-rule-container"),h=0,u,c,f=a.id.replace(this.element.id+"_",""),d=this.getValidRules(this.rule);l&&l.previousElementSibling!==null;)l=l.previousElementSibling,(!this.enableSeparateConnector||this.enableSeparateConnector&&(!this.headerTemplate&&!l.classList.contains("e-btn-group")||this.headerTemplate&&(l.classList.contains("e-rule-container")||l.classList.contains("e-group-container"))))&&h++;var p=o.rules[h].operator?o.rules[h].operator.toString():"";l=X(e,".e-rule-container");var v=l.id.replace(this.element.id+"_","");if(X(e,".e-rule-filter")||X(e,".e-rule-sub-filter")){this.subFieldElem&&(e=this.subFieldElem),u=this.fieldMode==="DropdownTree"?He(e,"dropdowntree"):He(e,"dropdownlist");var g=this.fieldMode==="DropdownTree"?this.getColumn(u.value[0]):this.getColumn(u.value);!this.isImportRules&&o.rules[h].field&&o.rules[h].field.toLowerCase()!==g.field.toLowerCase()&&(!l.querySelectorAll(".e-template")&&!(p.indexOf("null")>-1)||p.indexOf("empty")>-1)&&(o.rules[h].value=""),this.selectedColumn=this.getColumn(this.selectedColumn.field),o.rules[h].field=this.selectedColumn.field,o.rules[h].type=this.selectedColumn.type,o.rules[h].label=this.selectedColumn.label;var b=X(e,".e-rule-filter");b=b||X(e,".e-rule-sub-filter");var C=b.nextElementSibling.querySelector("input.e-control");C=C||b.nextElementSibling.nextElementSibling.querySelector("input.e-control"),p=He(C,"dropdownlist").value.toString(),o.rules[h].operator=p;var y=b.nextElementSibling.nextElementSibling,x=y.querySelectorAll("input.e-control");x.length<1&&(x=y.querySelectorAll("div.e-control")),x.length<1&&(x=y.querySelectorAll(".e-template")),c={groupID:f,ruleID:v,value:o.rules[h].field,type:"field"};for(var w=0;w<x.length;w++){if(p.indexOf("null")>-1||p.indexOf("empty")>-1){o.rules[h].value=null;continue}this.updateValues(x[w],o.rules[h])}!this.isImportRules&&!this.prvtEvtTgrDaD&&this.trigger("change",c),this.allowValidation&&o.rules[h].field&&e.parentElement.className.indexOf("e-tooltip")>-1&&He(e.parentElement,"tooltip").destroy(),this.filterRules(d,this.getValidRules(this.rule),"field")}else if(X(e,".e-rule-operator")){u=He(e,"dropdownlist"),o.rules[h].operator=u.value.toString();var S=l.querySelectorAll(".e-rule-value input.e-control");c={groupID:f,ruleID:v,value:u.value,type:"operator"},this.allowValidation&&o.rules[h].operator&&e.parentElement.className.indexOf("e-tooltip")>-1&&He(e.parentElement,"tooltip").destroy(),S.length>1&&!(S[0].className.indexOf("e-template")>-1)&&(o.rules[h].value=[]);for(var E=0;E<S.length;E++){if(o.rules[h].operator.indexOf("null")>-1||o.rules[h].operator.indexOf("empty")>-1){o.rules[h].value=null;continue}else if(S[E].classList.contains("e-template"))continue;this.updateValues(S[E],o.rules[h])}this.isImportRules||this.trigger("change",c),this.filterRules(d,this.getValidRules(this.rule),"operator")}else X(e,".e-rule-value")&&(this.ruleValueUpdate(e,i,o,h,a,l,r),n||this.filterRules(d,this.getValidRules(this.rule),"value"))},t.prototype.filterRules=function(e,i,r){var n=JSON.stringify({condition:e.condition,not:e.not,rule:e.rules}),a=JSON.stringify({condition:i.condition,not:i.not,rule:i.rules});n!==a&&!this.isImportRules&&!this.prvtEvtTgrDaD&&this.trigger("ruleChange",{previousRule:e,rule:i,type:r})},t.prototype.ruleValueUpdate=function(e,i,r,n,a,o,l){var h,u,c=["in","between","notin","notbetween"];if(r.rules[n].operator&&(u=r.rules[n].operator.toString().toLowerCase()),i!==null){if(e.className.indexOf("e-multiselect")>-1&&r.rules[n].type==="number"&&!this.isNotified){for(var f=[],d=i,p=0,v=d.length;p<v;p++)typeof d[p]=="string"&&f.push(parseFloat(d[p]));f.length&&(i=f)}if(this.isNotified)r.rules[n].value=i,h={groupID:a.id,ruleID:o.id,value:r.rules[n].value,type:"value"},this.isImportRules||this.trigger("change",h);else if(e.className.indexOf("e-spin")>-1||e.className.indexOf("e-numeric")>-1)c.indexOf(u)>-1?r.rules[n].value[l]=i:r.rules[n].value=i;else if(e.className.indexOf("e-radio")>-1)r.rules[n].value=i;else if(e.className.indexOf("e-multiselect")>-1)r.rules[n].value=i;else if(e.className.indexOf("e-textbox")>-1)u==="in"||u==="notin"?r.rules[n].type==="string"?r.rules[n].value=this.processValueString(i,r.rules[n].type):r.rules[n].value=this.processValueString(i,r.rules[n].type):u==="between"||u==="notbetween"?(typeof r.rules[n].value=="string"&&(r.rules[n].value=[]),r.rules[n].value[l]=i):r.rules[n].value=i;else if(e.className.indexOf("e-datepicker")>-1){var g=this.getFormat(this.getColumn(this.selectedColumn.field).format);g.type&&(c.indexOf(u)>-1?(typeof r.rules[n].value=="string"&&(r.rules[n].value=[]),r.rules[n].value[l]=this.intl.formatDate(i,g)):r.rules[n].value=this.intl.formatDate(i,g))}this.validateValue(r,o,n)}else e.className.indexOf("e-datepicker")>-1&&c.indexOf(u)>-1?(typeof r.rules[n].value=="string"&&(r.rules[n].value=[]),r.rules[n].value[l]=i):r.rules[n].value=i},t.prototype.validateValue=function(e,i,r){m(r)||(e=e.rules[r]);var n=typeof e.value=="object";if(this.allowValidation&&(m(r)||(n?e.value.length>0:e.value))){var a=i.querySelectorAll(".e-rule-value .e-control");a.length>0&&(a[0].className.indexOf("e-tooltip")>-1?He(a[0],"tooltip").destroy():a[0].parentElement.className.indexOf("e-tooltip")>-1&&He(a[0].parentElement,"tooltip").destroy(),a[1]&&a[1].parentElement.className.indexOf("e-tooltip")>-1&&He(a[1].parentElement,"tooltip").destroy(),a[2]&&a[2].parentElement.className.indexOf("e-tooltip")>-1&&He(a[2].parentElement,"tooltip").destroy())}},t.prototype.getFormat=function(e){var i;return e?typeof e=="string"?(i={type:"dateTime"},e==="short"||e==="yMd"?(i.type="date",i.skeleton=e):i.format=e):i={type:"dateTime",skeleton:e.skeleton}:i={type:"date",skeleton:"yMd"},i},t.prototype.findGroupByIdx=function(e,i,r){var n=i.rules,a=[];if(!r){for(var o=0,l=n.length;o<l;o++)i=n[o],i.rules&&a.push(i);return a[e]}return i},t.prototype.destroy=function(){this.isDestroy=!0;var e=this.element;if(e){var i,r,n,a;for(s.prototype.destroy.call(this),i=this.element.querySelectorAll(".e-addrulegroup"),n=i.length,r=0;r<n;r++)He(i[r],"dropdown-btn").destroy(),Oe(i[r]);for(a=this.element.querySelectorAll(".e-rule-filter .e-control.e-tooltip"),r=0;r<a.length;r++)He(a[r],"tooltip").destroy();for(i=this.element.querySelectorAll(".e-rule-filter .e-control:not(.e-tooltip)"),n=i.length,r=0;r<n;r++)He(i[r],"dropdownlist")?He(i[r],"dropdownlist").destroy():He(i[r],"dropdowntree").destroy(),Oe(i[r]);for(a=this.element.querySelectorAll(".e-rule-operator .e-control.e-tooltip"),r=0;r<a.length;r++)He(a[r],"tooltip").destroy();for(i=this.element.querySelectorAll(".e-rule-operator .e-control:not(.e-tooltip)"),n=i.length,r=0;r<n;r++)He(i[r],"dropdownlist")&&(He(i[r],"dropdownlist").destroy(),Oe(i[r]));for(a=this.element.querySelectorAll(".e-rule-value .e-control.e-tooltip"),r=0;r<a.length;r++)He(a[r],"tooltip").destroy();this.isImportRules=!1,this.unWireEvents(),this.levelColl[this.element.id+"_group0"]=[0],this.element.innerHTML="",this.portals&&this.portals.length&&this.clearQBTemplate();var o=document.querySelectorAll(".qb-dropdownlist.e-popup");if(o)for(r=0;r<o.length;r++)o[r].remove();On(this.element,[],["e-rtl","e-responsive","e-device"]),this.isDestroy=!1}},t.prototype.addRules=function(e,i){i=this.element.id+"_"+i,this.isPublic=!0;for(var r=0,n=e.length;r<n;r++)this.addRuleElement(document.getElementById(i),e[r]);this.isPublic=!1},t.prototype.addGroups=function(e,i){if(this.isAddSuccess||this.element.querySelectorAll(".e-group-container").length<=this.maxGroupCount){i=this.element.id+"_"+i;var r=document.getElementById(i),n=this.getParentGroup(r),a=e.length;if(a){this.isPublic=!0;for(var o=0,l=e.length;o<l;o++)this.updatedRule={isLocked:e[o].isLocked,condition:e[o].condition,not:e[o].not},this.importRules(e[o],r,!1,e[o].not);this.isPublic=!1}else{var h="and",u=!1,c=!1;this.updatedRule&&(h=this.updatedRule.condition,u=this.updatedRule.not,c=this.updatedRule.isLocked),this.groupIndex<0?this.enableNotCondition?n.rules.push({condition:h,not:u,rules:[]}):n.rules.push({condition:h,rules:[]}):this.enableNotCondition?n.rules.splice(this.groupIndex+1,0,{condition:h,not:u,rules:[],isLocked:c}):n.rules.splice(this.groupIndex+1,0,{condition:h,rules:[],isLocked:c})}this.headerTemplate||this.disableRuleCondition(r,n,null,this.enableSeparateConnector?!0:null)}},t.prototype.initWrapper=function(){if(this.isInitialLoad=!0,this.cssClass&&P([this.element],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.enableSeparateConnector&&P([this.element],"e-multi-connector"),this.enableRtl&&P([this.element],"e-rtl"),this.width&&(this.element.style.width=this.width),this.height&&(this.element.style.height=this.height),this.rule.rules.length?this.isImportRules=!0:this.addGroupElement(!1,this.element),xe.isDevice||this.displayMode==="Vertical"?(xe.isDevice&&(this.element.style.width="100%",this.element.classList.add("e-device")),Z(this.element.querySelectorAll(".e-rule-container"),"e-horizontal-mode"),P(this.element.querySelectorAll(".e-rule-container"),"e-vertical-mode"),this.displayMode="Vertical"):this.displayMode="Horizontal",this.summaryView)this.isImportRules?this.renderSummary():this.renderSummaryCollapse();else{if(this.columns&&this.columns.length&&this.isImportRules){this.addGroupElement(!1,this.element,this.rule.condition,!1,this.rule.not,!1,this.rule);var e=Ue({},this.rule,{},!0);this.isRefreshed=!0,this.setGroupRules(e),this.isRefreshed=!1}else this.columns&&this.columns.length&&this.addRuleElement(this.element.querySelector(".e-group-container"),{});this.notGroupRtl(),this.readonly&&this.enableReadonly();for(var i=this.element.querySelectorAll("label.e-btn"),r=void 0,n=0;n<i.length;n++)r=i.item(n),os(r,{selector:".e-btn"})}},t.prototype.renderSummary=function(){var e=this.createElement("div",{attrs:{class:"e-summary-content",id:this.element.id+"_summary_content"}}),i=this.createElement("textarea",{attrs:{class:"e-summary-text",readonly:"true"},styles:"max-height:500px"}),r=this.createElement("button",{attrs:{type:"button",class:"e-edit-rule e-css e-btn e-small e-flat e-primary"}}),n=this.createElement("div",{attrs:{class:"e-summary-btndiv"}});e.appendChild(i),i.textContent=this.getSqlFromRules(this.rule),r.textContent=this.l10n.getConstant("Edit"),n.appendChild(r),e.appendChild(n),this.element.appendChild(e)},t.prototype.renderSummaryCollapse=function(){var e=this.createElement("div",{attrs:{class:"e-collapse-rule e-icons",title:this.l10n.getConstant("SummaryViewTitle")}});this.element.querySelector(".e-group-header").appendChild(e)},t.prototype.columnSort=function(){this.sortDirection.toLowerCase()==="descending"?this.columns=new fe(this.columns).executeLocal(new We().sortByDesc("field")):this.sortDirection.toLowerCase()==="ascending"&&(this.columns=new fe(this.columns).executeLocal(new We().sortBy("field")))},t.prototype.onChangeNotGroup=function(){if(this.element.innerHTML="",this.groupIdCounter=0,!this.headerTemplate)if(this.enableNotCondition){var e=this.createElement("button",{attrs:{type:"button",class:"e-qb-toggle"}});this.groupElem.querySelector(".e-btn-group")&&this.groupElem.querySelector(".e-btn-group").insertBefore(e,this.groupElem.querySelector(".e-btngroup-and"))}else this.groupElem.querySelector(".e-qb-toggle").remove();this.setProperties({rule:this.checkNotGroup(this.rule)},!0),this.initWrapper()},t.prototype.notGroupRtl=function(){this.enableRtl?P(this.element.querySelectorAll(".e-btn-group"),"e-rtl"):Z(this.element.querySelectorAll(".e-btn-group"),"e-rtl")},t.prototype.checkNotGroup=function(e){var i;if(e.rules)for(var r=0;r<e.rules.length;r++)i=e.rules[r],i=this.checkNotGroup(i),e.rules[r]=i;return m(e.not)?this.enableNotCondition&&!m(e.condition)&&(e.not=!1):(this.enableNotCondition&&(e.not=!1),delete e.not),e},t.prototype.onPropertyChanged=function(e,i){for(var r=Object.keys(e),n=this.element.querySelector(".e-group-container"),a=this.element.querySelector(".e-summary-content"),o=0,l=r;o<l.length;o++){var h=l[o];switch(h){case"summaryView":e.summaryView?(n.style.display="none",this.element.querySelectorAll(".e-summary-content").length<1?(this.renderSummary(),a=this.element.querySelector(".e-summary-content")):this.element.querySelector(".e-summary-text").textContent=this.getSqlFromRules(this.rule),a.style.display="block"):(n.querySelectorAll(".e-collapse-rule").length>-1&&this.renderSummaryCollapse(),n.style.display="block",a.style.display="none");break;case"displayMode":this.refresh();break;case"showButtons":m(e.showButtons.lockGroup)||(e.showButtons.lockGroup?Z(this.element.querySelectorAll(".e-lock-grp-btn"),"e-button-hide"):P(this.element.querySelectorAll(".e-lock-grp-btn"),"e-button-hide")),m(e.showButtons.lockRule)||(e.showButtons.lockRule?Z(this.element.querySelectorAll(".e-lock-rule-btn"),"e-button-hide"):P(this.element.querySelectorAll(".e-lock-rule-btn"),"e-button-hide")),m(e.showButtons.cloneGroup)||(e.showButtons.cloneGroup?Z(this.element.querySelectorAll(".e-clone-grp-btn"),"e-button-hide"):P(this.element.querySelectorAll(".e-clone-grp-btn"),"e-button-hide")),m(e.showButtons.cloneRule)||(e.showButtons.cloneRule?Z(this.element.querySelectorAll(".e-clone-rule-btn"),"e-button-hide"):P(this.element.querySelectorAll(".e-clone-rule-btn"),"e-button-hide")),m(e.showButtons.ruleDelete)||(e.showButtons.ruleDelete?Z(this.element.querySelectorAll(".e-rule-delete"),"e-button-hide"):P(this.element.querySelectorAll(".e-rule-delete"),"e-button-hide")),m(e.showButtons.groupDelete)||(e.showButtons.groupDelete?Z(this.element.querySelectorAll(".e-deletegroup"),"e-button-hide"):P(this.element.querySelectorAll(".e-deletegroup"),"e-button-hide"));break;case"cssClass":i.cssClass&&Z([this.element],i.cssClass.split(" ")),e.cssClass&&P([this.element],e.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":e.enableRtl?(P([this.element],"e-rtl"),this.notGroupRtl()):(Z([this.element],"e-rtl"),this.notGroupRtl());break;case"enablePersistence":this.enablePersistence=e.enablePersistence;break;case"dataSource":this.dataSource=e.dataSource,this.refresh();break;case"columns":this.columns=e.columns,this.columnSort(),this.updateSubFieldsFromColumns(this.columns);break;case"sortDirection":this.sortDirection=e.sortDirection,this.columnSort();break;case"maxGroupCount":this.maxGroupCount=e.maxGroupCount;break;case"height":this.height=e.height,this.element.style.height=this.height;break;case"rule":this.rule.rules.length===0&&!m(this.rule)&&this.reset(),this.setProperties({rule:e.rule},!0),e.rule=this.getRuleCollection(this.rule,!1),this.setRules(this.rule);break;case"width":this.width=e.width,this.element.style.width=this.width;break;case"locale":this.locale=e.locale,this.intl=new Ji(this.locale),this.isLocale=!0,this.refresh(),this.isLocale=!1;break;case"enableNotCondition":this.onChangeNotGroup();break;case"readonly":this.isReadonly=e.readonly,this.enableReadonly();break;case"allowDragAndDrop":this.allowDragAndDrop=e.allowDragAndDrop,this.refresh();break;case"enableSeparateConnector":this.enableSeparateConnector=e.enableSeparateConnector,this.refresh();break}}},t.prototype.preRender=function(){this.element.id=this.element.id||fi("ej2-querybuilder"),this.defaultLocale={StartsWith:"Starts With",DoesNotStartWith:"Does Not Start With",EndsWith:"Ends With",DoesNotEndWith:"Does Not End With",Contains:"Contains",DoesNotContain:"Does Not Contain",NotLike:"Not Like",Like:"Like",Equal:"Equal",NotEqual:"Not Equal",LessThan:"Less Than",LessThanOrEqual:"Less Than Or Equal",GreaterThan:"Greater Than",GreaterThanOrEqual:"Greater Than Or Equal",Between:"Between",NotBetween:"Not Between",In:"In",NotIn:"Not In",Remove:"REMOVE",SelectField:"Select a field",SelectOperator:"Select operator",DeleteRule:"Remove this condition",DeleteGroup:"Delete group",AddGroup:"Add Group",AddCondition:"Add Condition",Edit:"EDIT",ValidationMessage:"This field is required",SummaryViewTitle:"Summary View",OtherFields:"Other Fields",AND:"AND",OR:"OR",NOT:"NOT",SelectValue:"Enter Value",IsEmpty:"Is Empty",IsNotEmpty:"Is Not Empty",IsNull:"Is Null",IsNotNull:"Is Not Null",True:"true",False:"false",AddButton:"Add Group/Condition",CloneGroup:"Clone Group",LockGroup:"Lock Group",CloneRule:"Clone Rule",LockRule:"Lock Rule",UnlockRule:"Unlock Rule",UnlockGroup:"Unlock Group"},this.l10n=new br("querybuilder",this.defaultLocale,this.locale),this.intl=new Ji(this.locale),this.groupIdCounter=0,this.subFilterCounter=0,this.ruleIdCounter=0,this.btnGroupId=0,this.isImportRules=!1,this.parser=[],this.customOperators={stringOperator:[{value:"startswith",key:this.l10n.getConstant("StartsWith")},{value:"notstartswith",key:this.l10n.getConstant("DoesNotStartWith")},{value:"endswith",key:this.l10n.getConstant("EndsWith")},{value:"notendswith",key:this.l10n.getConstant("DoesNotEndWith")},{value:"contains",key:this.l10n.getConstant("Contains")},{value:"notcontains",key:this.l10n.getConstant("DoesNotContain")},{value:"equal",key:this.l10n.getConstant("Equal")},{value:"notequal",key:this.l10n.getConstant("NotEqual")},{value:"in",key:this.l10n.getConstant("In")},{value:"notin",key:this.l10n.getConstant("NotIn")},{value:"isempty",key:this.l10n.getConstant("IsEmpty")},{value:"isnotempty",key:this.l10n.getConstant("IsNotEmpty")}],dateOperator:[{value:"equal",key:this.l10n.getConstant("Equal")},{value:"greaterthan",key:this.l10n.getConstant("GreaterThan")},{value:"greaterthanorequal",key:this.l10n.getConstant("GreaterThanOrEqual")},{value:"lessthan",key:this.l10n.getConstant("LessThan")},{value:"lessthanorequal",key:this.l10n.getConstant("LessThanOrEqual")},{value:"notequal",key:this.l10n.getConstant("NotEqual")},{value:"between",key:this.l10n.getConstant("Between")},{value:"notbetween",key:this.l10n.getConstant("NotBetween")}],booleanOperator:[{value:"equal",key:this.l10n.getConstant("Equal")},{value:"notequal",key:this.l10n.getConstant("NotEqual")}],numberOperator:[{value:"equal",key:this.l10n.getConstant("Equal")},{value:"greaterthanorequal",key:this.l10n.getConstant("GreaterThanOrEqual")},{value:"greaterthan",key:this.l10n.getConstant("GreaterThan")},{value:"between",key:this.l10n.getConstant("Between")},{value:"lessthan",key:this.l10n.getConstant("LessThan")},{value:"notbetween",key:this.l10n.getConstant("NotBetween")},{value:"lessthanorequal",key:this.l10n.getConstant("LessThanOrEqual")},{value:"notequal",key:this.l10n.getConstant("NotEqual")},{value:"in",key:this.l10n.getConstant("In")},{value:"notin",key:this.l10n.getConstant("NotIn")}]},this.operators={equal:"=",notequal:"!=",greaterthan:">",greaterthanorequal:">=",lessthan:"<",in:"IN",notin:"NOT IN",lessthanorequal:"<=",startswith:"LIKE",endswith:"LIKE",between:"BETWEEN",notbetween:"NOT BETWEEN",contains:"LIKE",isnull:"IS NULL",isnotnull:"IS NOT NULL",isempty:"IS EMPTY",isnotempty:"IS NOT EMPTY",notstartswith:"NOT LIKE",notendswith:"NOT LIKE",notcontains:"NOT LIKE"},this.sqlOperators={equal:"=",notequal:"!=",greaterthan:">",greaterthanorequal:">=",lessthan:"<",in:this.l10n.getConstant("In").toUpperCase(),notin:this.l10n.getConstant("NotIn").toUpperCase(),lessthanorequal:"<=",startswith:this.l10n.getConstant("Like").toUpperCase(),endswith:this.l10n.getConstant("Like").toUpperCase(),between:this.l10n.getConstant("Between").toUpperCase(),notbetween:this.l10n.getConstant("NotBetween").toUpperCase(),contains:this.l10n.getConstant("Like").toUpperCase(),isnull:this.l10n.getConstant("IsNull").toUpperCase(),isnotnull:this.l10n.getConstant("IsNotNull").toUpperCase(),isempty:this.l10n.getConstant("IsEmpty").toUpperCase(),isnotempty:this.l10n.getConstant("IsNotEmpty").toUpperCase(),notstartswith:this.l10n.getConstant("NotLike").toUpperCase(),notendswith:this.l10n.getConstant("NotLike").toUpperCase(),notcontains:this.l10n.getConstant("NotLike").toUpperCase()},this.fields||(this.fields={text:"label",value:"field"})},t.prototype.render=function(){this.levelColl={},this.items=[{text:this.l10n.getConstant("AddGroup"),iconCss:"e-icons e-add-icon e-addgroup"},{text:this.l10n.getConstant("AddCondition"),iconCss:"e-icons e-add-icon e-addrule"}],this.ruleElem=this.ruleTemplate(),this.groupElem=this.groupTemplate();var e=[{value:"isnull",key:this.l10n.getConstant("IsNull")},{value:"isnotnull",key:this.l10n.getConstant("IsNotNull")}],i=[{value:"isnull",key:this.l10n.getConstant("IsNull")},{value:"isnotnull",key:this.l10n.getConstant("IsNotNull")}];this.customOperators.stringOperator=this.customOperators.stringOperator.concat(e),this.customOperators.numberOperator=this.customOperators.numberOperator.concat(i),this.dataSource instanceof fe?(this.dataManager=this.dataSource,this.executeDataManager(new We().take(1))):(this.dataManager=new fe(this.dataSource),this.dataColl=this.dataManager.executeLocal(new We),this.initControl()),this.renderComplete(),this.allowDragAndDrop&&this.initializeDrag()},t.prototype.initializeDrag=function(){this.draggable=new F1(this.element,{dragTarget:".e-drag-qb-rule",distance:5,helper:this.helper.bind(this),dragStart:this.dragStartHandler.bind(this),drag:this.dragHandler.bind(this),dragStop:this.dragStopHandler.bind(this),isReplaceDragEle:!0,isPreventSelect:!1,abort:".e-parent-header",isDragScroll:!0})},t.prototype.helper=function(e){var i=this.draggable.currentStateTarget;if(!i.classList.contains("e-drag-qb-rule")||i.classList.contains("e-drag-qb-rule")&&X(i,".e-disable"))return!1;var r=this.createElement("div",{className:"e-cloneproperties e-draganddrop e-dragclone",styles:'height:"auto", z-index:2, width:'+this.element.offsetWidth}),n;if(this.draggable.currentStateTarget.parentElement.classList.contains("e-group-header"))n=X(i,".e-group-container").cloneNode(!0),X(i,".e-group-container").classList.add("e-qb-dragging-rule");else{r.classList.add("e-group-body"),n=this.createElement("div",{className:"e-rule-container"});var a=X(i,".e-rule-field").cloneNode(!0);n.appendChild(a),X(i,".e-rule-field").classList.add("e-qb-dragging-rule")}r.appendChild(n);var o=r.querySelectorAll("*");return o.forEach(function(l){l.removeAttribute("id")}),this.element.appendChild(r),r},t.prototype.dragStartHandler=function(e){this.draggedRule=e.target,this.isDragEventPrevent=!1,document.body.classList.add("e-prevent-select"),this.dragElement=e.dragElement;var i=X(e.target,".e-rule-container"),r=X(e.target,".e-group-container"),n={dragRuleID:i!==null?i.id:r.id,dragGroupID:r.id,cancel:!1};this.trigger("dragStart",n),this.isDragEventPrevent=n.cancel},t.prototype.dragHandler=function(e){if(!this.isDragEventPrevent){var i=this.element.querySelectorAll(".e-drag-rule-bottom-line");if(i.forEach(function(f){f.classList.remove("e-drag-rule-bottom-line")}),i=this.element.querySelectorAll(".e-drag-rule-top-line"),i.forEach(function(f){f.classList.remove("e-drag-rule-top-line")}),!m(e.target)){if(e.target.nodeName==="HTML"||X(e.target,".e-qb-dragging-rule")||X(e.target,".e-group-header")||!X(e.target,"#"+this.element.id)||X(e.target,".e-disable")||e.target.parentElement&&e.target.parentElement.classList.contains("e-btn-group")&&this.enableSeparateConnector){this.dragElement.classList.add("e-notallowedcur");return}else this.dragElement.classList.remove("e-notallowedcur");var r=X(e.target,".e-rule-container"),n=X(e.target,".e-group-container");if(r){var a=r.getBoundingClientRect(),o=e.event.clientY||e.event.changedTouches[0].clientY,l=o-a.top,h=a.bottom-o,u=20;l<u?r.classList.add("e-drag-rule-top-line"):h<u&&r.classList.add("e-drag-rule-bottom-line")}else if(e.target.classList.contains("e-rule-list")&&e.target.children.length===0)e.target.classList.add("e-drag-rule-bottom-line");else if(e.target.classList.contains("e-rule-list")&&e.target.children[0].classList.contains("e-group-container")){var a=e.target.children[0].getBoundingClientRect(),o=e.event.clientY||e.event.changedTouches[0].clientY,l=o-a.top,u=20;l<u&&e.target.classList.add("e-drag-rule-top-line")}else if((X(e.target,".e-group-container")||e.target.classList.contains("e-group-container"))&&(n||(n=e.target),n.id.indexOf("group0")>-1)){var a=e.target.getBoundingClientRect(),o=e.event.clientY||e.event.changedTouches[0].clientY,h=a.bottom-o,u=20;h<u&&e.target.classList.add("e-drag-rule-bottom-line")}var c={dragRuleID:r!==null?r.id:n!==null?n.id:null,dragGroupID:n!==null?n.id:null,cancel:!1};this.trigger("drag",c),this.isDragEventPrevent=c.cancel}}},t.prototype.dragStopHandler=function(e){var i=this;if(!this.isDragEventPrevent){var r=X(e.target,".e-rule-container");m(r)&&e.target.parentElement&&e.target.parentElement.classList.contains("e-btn-group")&&this.enableSeparateConnector&&(r=X(e.target.parentElement.previousElementSibling,".e-rule-container"));var n;m(e.helper)||(n=X(e.helper,".e-notallowedcur"));var a;if(!n){var o=X(e.target,".e-group-container"),l={cancel:!1,dropRuleID:r!==null?r.id:o!==null?o.id:null,dropGroupID:o!==null?o.id:null};this.trigger("drop",l),l.cancel&&(n=!0),a=this.getValidRules()}this.prvtEvtTgrDaD=!0;var h=this.enableSeparateConnector&&e.target.parentElement&&e.target.parentElement.classList.contains("e-btn-group")?e.target.parentElement.previousElementSibling:e.target;if(r&&!n){var u=r.id.split(this.element.id+"_")[1].split("_")[0];if(this.draggable.currentStateTarget.parentElement.classList.contains("e-rule-field")||this.draggable.currentStateTarget.parentElement.classList.contains("e-group-header")){var c=void 0;this.draggable.currentStateTarget.parentElement.classList.contains("e-group-header")?(c=this.getGroup(this.draggedRule),this.deleteGroup(X(this.draggedRule,".e-group-container"))):(c=this.getRule(this.draggedRule),this.deleteRule(this.draggedRule));var f=Ue([],this.getGroup(r),[],!0);f.properties&&(f=f.properties);var d=X(r,".e-group-container"),p=d.querySelectorAll(".e-group-container");p.forEach(function(E){i.element.querySelector("#"+E.id)&&i.deleteGroup(E)});for(var v=d.querySelectorAll(".e-rule-container"),g=[],b=void 0,C=0;C<v.length;C++)(v[C].classList.contains("e-drag-rule-top-line")||v[C].classList.contains("e-drag-rule-bottom-line"))&&(b=C),g.push(v[C].id.split(this.element.id+"_")[1]);this.deleteRules(g),r.classList.contains("e-drag-rule-top-line")?f.rules.splice(b,0,c):f.rules.splice(b+1,0,c),f.rules.forEach(function(E){i.enableSeparateConnector?E.rules?i.addGroups([E],u):i.addRules([E],u):E.condition?i.addGroups([E],u):i.addRules([E],u)})}}else if(h.classList.contains("e-rule-list")&&h.children.length===0&&!n){var d=X(h,".e-group-container"),y=d.id.split(this.element.id+"_")[1].split("_")[0],c=void 0;this.draggable.currentStateTarget.parentElement.classList.contains("e-group-header")?(c=this.getGroup(this.draggedRule),this.deleteGroup(X(this.draggedRule,".e-group-container"))):(c=this.getRule(this.draggedRule),this.deleteRule(this.draggedRule)),this.enableSeparateConnector?c.rules?this.addGroups([c],y):this.addRules([c],y):c.condition?this.addGroups([c],y):this.addRules([c],y)}else if(h.classList.contains("e-rule-list")&&h.children[0].classList.contains("e-group-container")&&!n){var d=X(h,".e-group-container"),x=d.id.split(this.element.id+"_")[1].split("_")[0],c=void 0;this.draggable.currentStateTarget.parentElement.classList.contains("e-group-header")?(c=this.getGroup(this.draggedRule),this.deleteGroup(X(this.draggedRule,".e-group-container"))):(c=this.getRule(this.draggedRule),this.deleteRule(this.draggedRule));var f=Ue([],this.getGroup(h),[],!0);f.properties&&(f=f.properties);var w=h.querySelectorAll(".e-group-container");w.forEach(function(D){i.element.querySelector("#"+D.id)&&i.deleteGroup(D)});var v=d.querySelectorAll(".e-rule-container");v.forEach(function(D){i.element.querySelector("#"+D.id)&&i.deleteRule(D)}),this.draggable.currentStateTarget.parentElement.classList.contains("e-group-header")?this.addGroups([c],x):this.addRules([c],x),f.rules.forEach(function(D){i.enableSeparateConnector?D.rules?i.addGroups([D],x):i.addRules([D],x):D.condition?i.addGroups([D],x):i.addRules([D],x)})}else if((X(e.target,".e-group-container")||e.target.classList.contains("e-group-container"))&&!n){var c=void 0;r=X(e.target,".e-group-container"),!r&&e.target.classList.contains("e-group-container")&&(r=e.target);var y=r.id.split(this.element.id+"_")[1].split("_")[0];y==="group0"&&(this.draggable.currentStateTarget.parentElement.classList.contains("e-group-header")?(c=this.getGroup(this.draggedRule),this.deleteGroup(X(this.draggedRule,".e-group-container"))):(c=this.getRule(this.draggedRule),this.deleteRule(this.draggedRule)),this.enableSeparateConnector?c.rules?this.addGroups([c],y):this.addRules([c],y):c.condition?this.addGroups([c],y):this.addRules([c],y))}n||this.trigger("ruleChange",{previousRule:a,rule:this.getValidRules(),type:"drag-and-drop"}),this.prvtEvtTgrDaD=!1,document.body.classList.remove("e-prevent-select");var S=this.element.querySelectorAll(".e-drag-rule-bottom-line");S.forEach(function(E){E.classList.remove("e-drag-rule-bottom-line")}),S=this.element.querySelectorAll(".e-drag-rule-top-line"),S.forEach(function(E){E.classList.remove("e-drag-rule-top-line")}),S=this.element.querySelectorAll(".e-qb-dragging-rule"),S.forEach(function(E){E.classList.remove("e-qb-dragging-rule")}),e.helper&&e.helper.classList.contains("e-cloneproperties")&&document.querySelector("."+e.helper.classList[0])&&Zi(e.helper),this.enableSeparateConnector&&this.refresh()}},t.prototype.templateParser=function(e){if(e)try{return typeof e!="function"&&document.querySelectorAll(e).length?wt(document.querySelector(e).innerHTML.trim()):wt(e)}catch(i){return wt(e)}},t.prototype.executeDataManager=function(e){var i=this,r=this.dataManager.executeQuery(e),n=new dn;r.then(function(a){a.actual&&a.actual.result?i.dataColl=a.actual.result:i.dataColl=a.result,i.initControl()}).catch(function(a){n.reject(a)})},t.prototype.initControl=function(){this.initialize(),this.initWrapper(),this.wireEvents()},t.prototype.wireEvents=function(){var e=this.getWrapper();R.add(e,"click",this.clickEventHandler,this),R.add(e,"focusout",this.focusEventHandler,this),R.add(e,"focusin",this.focusEventHandler,this),R.add(this.element,"keydown",this.keyBoardHandler,this),R.add(document,"keydown",this.keyBoardHandler,this)},t.prototype.unWireEvents=function(){var e=this.getWrapper();R.remove(e,"click",this.clickEventHandler),R.remove(e,"focusout",this.focusEventHandler),R.remove(e,"focusin",this.focusEventHandler),R.remove(this.element,"keydown",this.keyBoardHandler),R.remove(document,"keydown",this.keyBoardHandler)},t.prototype.getParentGroup=function(e,i){for(var r=e instanceof Element?this.levelColl[e.id]:this.levelColl[""+e],n=i?r.length-1:r.length,a=this.rule,o=0;o<n;o++)a=this.findGroupByIdx(r[o],a,o===0);return a},t.prototype.deleteGroup=function(e){var i=this,r=e,n;if(typeof e=="string"?(n=this.element.id+"_"+e,e=document.getElementById(n),n=n.replace(this.element.id+"_","")):n=r.id.replace(this.element.id+"_",""),!(n==="group0"||!e)){var a={groupID:n,cancel:!1,type:"deleteGroup"};!this.isImportRules&&!this.prvtEvtTgrDaD?this.trigger("beforeChange",a,function(o){i.deleteGroupSuccessCallBack(o,e)}):this.deleteGroupSuccessCallBack(a,e)}},t.prototype.deleteGroupSuccessCallBack=function(e,i){if(!e.cancel){var r=i,n=this.getParentGroup(r,!0),a=0,o=void 0,l=void 0,h=this.getValidRules(this.rule),u=r.nextElementSibling,c=r.previousElementSibling,f=r.querySelectorAll(".e-group-container"),d=r.querySelectorAll(".e-tooltip");for(l=d.length,o=0;o<l;o++)He(d[o],"tooltip").destroy();for(o=0,l=f.length;o<l;o++)delete this.levelColl[f[o].id];for(;r.previousElementSibling!==null;)r=r.previousElementSibling,(!this.enableSeparateConnector||this.enableSeparateConnector&&(!this.headerTemplate&&!r.classList.contains("e-btn-group")||this.headerTemplate&&(r.classList.contains("e-rule-container")||r.classList.contains("e-group-container"))))&&a++;this.enableSeparateConnector||u&&u.className.indexOf("e-separate-rule")>-1&&(Z([u],"e-separate-rule"),P([u],"e-joined-rule"),c&&c.className.indexOf("e-rule-container")>-1&&P([c],"e-prev-joined-rule"));var p=r.parentElement.parentElement.parentElement,v=[];if(this.isReact||this.isAngular){var g=n.rules[a],b=i.querySelectorAll(".e-rule-container");if(g&&g.rules)for(var C=0;C<g.rules.length;C++){var y=this.getColumn(g.rules[C].field);if(b[C]){var x=b[C].querySelector(".e-template-value");y&&(y.ruleTemplate||this.isPlatformTemplate(y)&&x)&&v.push(b[C].id)}}}Oe(i),this.headerTemplate&&this.clearQBTemplate([i.id]),v.length&&this.clearQBTemplate(v),n.rules.splice(a,1),delete this.levelColl[e.groupID],this.refreshLevelColl(),this.disableRuleCondition(p,n),this.enableSeparateConnector&&c&&(!this.headerTemplate&&c.classList.contains("e-btn-group")||this.headerTemplate&&c.classList.contains("e-custom-group-btn"))&&Oe(c),!this.isImportRules&&!this.prvtEvtTgrDaD&&this.trigger("change",e),this.filterRules(h,this.getValidRules(this.rule),"deleteGroup")}},t.prototype.isPlatformTemplate=function(e){var i=!1;return i=e.template&&(typeof e.template=="string"||e.template.create===void 0),i},t.prototype.deleteRule=function(e){var i=this,r=X(e,".e-group-container"),n=r.id.replace(this.element.id+"_",""),a=X(e,".e-rule-container").id.replace(this.element.id+"_",""),o={groupID:n,ruleID:a,cancel:!1,type:"deleteRule"};!this.isImportRules&&!this.prvtEvtTgrDaD?this.trigger("beforeChange",o,function(l){i.deleteRuleSuccessCallBack(l,e)}):this.deleteRuleSuccessCallBack(o,e)},t.prototype.deleteRuleSuccessCallBack=function(e,i){if(!e.cancel){var r=X(i,".e-group-container"),n=this.getParentGroup(r),a=X(i,".e-rule-container"),o=this.getValidRules(this.rule),l=a.previousElementSibling,h=0,u=a,c=a.nextElementSibling,f=a.querySelectorAll(".e-tooltip"),d=void 0,p=f.length;for(d=0;d<p;d++)He(f[d],"tooltip").destroy();for(;a.previousElementSibling!==null;)a=a.previousElementSibling,(!this.enableSeparateConnector||this.enableSeparateConnector&&(!this.headerTemplate&&!a.classList.contains("e-btn-group")||this.headerTemplate&&(a.classList.contains("e-rule-container")||a.classList.contains("e-group-container"))))&&h++;var v=this.getColumn(n.rules[h].field);v&&v.template&&u.querySelector(".e-template")&&this.templateDestroy(v,u.querySelector(".e-template").id),(!l||l.className.indexOf("e-rule-container")<0)&&c&&Z([c],"e-joined-rule"),(!c||c.className.indexOf("e-rule-container")<0)&&l&&Z([l],"e-prev-joined-rule");var g=u.querySelector(".e-template-value");try{if(this.enableSeparateConnector&&(u.previousElementSibling||u.nextElementSibling)){var b=u.previousElementSibling,C=u.nextElementSibling;if(m(C)&&(!this.headerTemplate&&b.classList.contains("e-btn-group")||this.headerTemplate&&b.classList.contains("e-custom-group-btn"))){if(b&&b.previousElementSibling&&b.previousElementSibling.classList.contains("e-rule-container")){var y=this.getRule(b.previousElementSibling);y.condition=null}Oe(b)}else(!this.headerTemplate&&C.classList.contains("e-btn-group")||this.headerTemplate&&C.classList.contains("e-custom-group-btn"))&&Oe(C)}Oe(u)}catch(S){return}v&&v.ruleTemplate&&this.clearQBTemplate([u.id]),v&&this.isPlatformTemplate(v)&&g&&this.clearQBTemplate([u.id]),n.rules.splice(h,1),n.rules[0]&&n.rules[0].rules||this.disableRuleCondition(r,n,!!this.enableSeparateConnector);for(var x=this.element.querySelectorAll(".e-tooltip"),w=0;w<x.length;w++)He(x[w],"tooltip").refresh(x[w]);!this.isImportRules&&!this.prvtEvtTgrDaD&&this.trigger("change",e),this.filterRules(o,this.getValidRules(this.rule),"deleteRule")}},t.prototype.setGroupRules=function(e,i){if(this.headerTemplate&&i&&(this.isRoot=!0),this.reset(),this.groupIdCounter=1,this.ruleIdCounter=0,this.isImportRules=!0,this.setProperties({rule:e},!0),e=this.getRuleCollection(this.rule,!1),this.importRules(this.rule,this.element.querySelector(".e-group-container"),!0,this.rule.not,i),e.isLocked){var r=this.element.querySelector(".e-group-container").querySelector(".e-lock-grp-btn");this.groupLock(r)}this.isImportRules=!1},t.prototype.keyBoardHandler=function(e){if(e.currentTarget===this.element&&this.readonly&&(e.keyCode===38||e.keyCode===40||e.keyCode===13))e.preventDefault();else if(e.code==="Escape"&&this.allowDragAndDrop){this.isDragEventPrevent=!0,document.body.classList.remove("e-prevent-select");var i=this.element.querySelectorAll(".e-drag-rule-bottom-line");i.forEach(function(n){n.classList.remove("e-drag-rule-bottom-line")}),i=this.element.querySelectorAll(".e-drag-rule-top-line"),i.forEach(function(n){n.classList.remove("e-drag-rule-top-line")}),i=this.element.querySelectorAll(".e-qb-dragging-rule"),i.forEach(function(n){n.classList.remove("e-qb-dragging-rule")});var r=this.element.querySelector(".e-cloneproperties");r&&Zi(r),this.enableSeparateConnector&&this.refresh()}},t.prototype.clearQBTemplate=function(e){(this.isReact||this.isAngular)&&this.clearTemplate(e)},t.prototype.disableRuleCondition=function(e,i,r,n){if(!this.headerTemplate){if(this.readonly)return;var a=e.querySelector(".e-rule-list").childElementCount,o=e.querySelector(".e-btngroup-and"),l=e.querySelector(".e-btngroup-or");if(a>1)if(o.disabled=!1,l.disabled=!1,(l.nextElementSibling.classList.contains("e-btn-disable")||o.nextElementSibling.classList.contains("e-btn-disable"))&&(l.nextElementSibling.classList.remove("e-btn-disable"),o.nextElementSibling.classList.remove("e-btn-disable")),this.enableSeparateConnector&&!r){for(var h=0,u=void 0;;){var c=e.parentElement.querySelectorAll(".e-btngroup-and"),f=e.parentElement.querySelectorAll(".e-btngroup-or");if(o=c[c.length-(1+h)],l=f[f.length-(1+h)],u=c[c.length-(1+h)],u&&u.parentElement&&u.parentElement.style.display==="none")h++;else break}for(var d=e.previousElementSibling;d&&!d.classList.contains("e-rule-container");){if(d.classList.contains("e-group-container")){d=d.querySelectorAll(".e-rule-container")[d.querySelectorAll(".e-rule-container").length-1];break}d=d.previousElementSibling}if(n&&e.classList.contains("e-group-container")){d=e;var p=this.getGroup(d);p.condition==="or"?l.checked=!0:o.checked=!0}else if(d&&d.classList.contains("e-rule-container")){var v=d.id.replace(this.element.id+"_",""),p=this.getRule(v);p.condition==="or"?l.checked=!0:o.checked=!0}}else r||(i&&i.condition==="or"?l.checked=!0:o.checked=!0);else if(this.enableSeparateConnector&&!r){for(var h=0,u=void 0;;){var c=e.parentElement.querySelectorAll(".e-btngroup-and"),f=e.parentElement.querySelectorAll(".e-btngroup-or");if(o=c[c.length-(1+h)],l=f[f.length-(1+h)],u=c[c.length-(1+h)],u&&u.parentElement&&u.parentElement.style.display==="none")h++;else break}for(var d=void 0,g=e.previousElementSibling;g;){if(g.classList.contains("e-group-container")&&(g=g.querySelectorAll(".e-rule-container")[g.querySelectorAll(".e-rule-container").length-1]),g.classList.contains("e-rule-container")){d=g;break}g=g.previousElementSibling}if(m(d)&&e.querySelectorAll(".e-rule-container")[e.querySelectorAll(".e-rule-container").length-1]&&(d=e.querySelectorAll(".e-rule-container")[e.querySelectorAll(".e-rule-container").length-1]),n&&e.classList.contains("e-group-container")){d=e;var p=this.getGroup(d);p.condition==="or"?l.checked=!0:o.checked=!0}else if(d){var v=d.id.replace(this.element.id+"_",""),p=this.getRule(v);p.condition==="or"&&l?l.checked=!0:o&&(o.checked=!0)}}else!r&&!m(o)&&(o.checked=!1,o.disabled=!0,l.checked=!1,l.disabled=!0,i&&(l.nextElementSibling.classList.add("e-btn-disable"),o.nextElementSibling.classList.add("e-btn-disable")))}},t.prototype.getValidRules=function(e){this.isValueEmpty=!0,e||(e=this.getRules());var i=e.condition,r=e.not,n=Ue([],e.rules,[],!0),a=m(e.isLocked)?this.getRuleCollection({condition:i,rules:n,not:r},!0):this.getRuleCollection({condition:i,rules:n,not:r,isLocked:e.isLocked},!0);return this.isValueEmpty=!1,a},t.prototype.getRuleCollection=function(e,i){if(m(e))return null;var r;if(e.rules&&e.rules.length&&(Object.keys(e.rules[0]).length>6||i))for(var n=e.rules.length,a=0;a<n;a++)r=e.rules[a],r=this.getRuleCollection(r,i),e.rules[a]=r,Object.keys(r).length<1&&i&&(e.rules.splice(a,1),a--,n--);var o=e.custom;if(e.field&&e.field!==""&&(m(o)||o&&o.type!=="question"&&o.type!=="answer"))if(e.operator&&(e.operator.toString().indexOf("null")>-1||e.operator.toString().indexOf("empty")>-1)&&(e.value=null),this.isRefreshed&&this.enablePersistence||e.field!==""&&e.operator!==""&&(this.isValueEmpty?e.value!==""&&e.value!==void 0:e.value!==void 0)||o&&o.isQuestion){var l=e.condition,h=e.isLocked;e={label:e.label,field:e.field,operator:e.operator,type:e.type,value:e.value},m(h)||(e.isLocked=h),l&&(e.condition=l),o&&(e.custom=o),(e.operator==="in"||e.operator==="notin")&&e.value&&e.value.length===0&&(e={}),(e.operator==="between"||e.operator==="notbetween")&&Array.isArray(e.value)&&(e.value.length<2||e.value.some(function(f){return f===""||f===null}))&&(e={})}else e={};else if(o&&(o.type==="question"||o.type==="answer")){var u=e.not;e={label:e.label,field:e.field,operator:e.operator,type:e.type,value:e.value,condition:e.condition,rules:e.rules},e.custom=o,this.enableNotCondition&&(e.not=u)}else if(m(e.condition)&&m(e.rules))e={};else{var c=e.isLocked;this.enableNotCondition?e={condition:e.condition,rules:e.rules,not:e.not}:e={condition:e.condition,rules:e.rules},m(c)||(e.isLocked=c),o&&(e.custom=o),e.rules&&e.rules.length===0&&(e={})}return e},t.prototype.setRules=function(e){var i=Ue({},e,{},!0);this.headerTemplate?this.setGroupRules(i,!0):this.setGroupRules(i)},t.prototype.getRules=function(){var e;return this.enableNotCondition?e={condition:this.rule.condition,rules:this.rule.rules,not:this.rule.not}:e={condition:this.rule.condition,rules:this.rule.rules},m(this.rule.isLocked)||(e.isLocked=this.rule.isLocked),this.rule.custom&&(e.custom=this.rule.custom),e},t.prototype.getRule=function(e){var i,r,n=0;if(e instanceof HTMLElement?i=X(e,".e-rule-container"):(r=this.element.id+"_"+e,i=document.getElementById(r)),m(i))return null;for(var a=X(i,".e-group-container"),o=this.getParentGroup(a);i.previousElementSibling!==null;)i=i.previousElementSibling,(!this.enableSeparateConnector||this.enableSeparateConnector&&(!this.headerTemplate&&!i.classList.contains("e-btn-group")||this.headerTemplate&&(i.classList.contains("e-rule-container")||i.classList.contains("e-group-container"))))&&n++;return o.rules[n]},t.prototype.getGroup=function(e){e instanceof Element&&e.className.indexOf("e-group-container")<1&&(e=X(e,".e-group-container"));var i=e instanceof Element?e.id:this.element.id+"_"+e,r=this.getParentGroup(i);return r},t.prototype.deleteGroups=function(e){var i,r=e.length,n;for(i=0;i<r;i++)e[i]!=="group0"&&(n=this.element.id+"_"+e[i],this.deleteGroup(document.getElementById(n)))},t.prototype.getFilteredRecords=function(){var e=this.getPredicate(this.getValidRules(this.rule)),i=m(e)?new We:new We().where(e);return this.dataManager.executeQuery(i)},t.prototype.deleteRules=function(e){var i,r=e.length,n;for(i=0;i<r;i++)n=this.element.id+"_"+e[i],this.deleteRule(document.getElementById(n))},t.prototype.getDataManagerQuery=function(e){for(var i=this.getPredicate(e),r,n=[],a=0,o=Object.keys(this.columns);a<o.length;a++)n.push(this.columns[a].field);return e.rules.length?r=new We().select(n).where(i):r=new We().select(n),r},t.prototype.getPredicate=function(e){var i=e.rules,r,n,a,o=!1,l;if(!i)return r;for(var h=0,u=i.length;h<u;h++){var c=i[h].operator;c==="notstartswith"?c="doesnotstartwith":c==="notendswith"?c="doesnotendwith":c==="notcontains"&&(c="doesnotcontain");var f=Object.keys(i[h]);if(o=!1,f.indexOf("rules")>-1&&i[h].rules)n=this.getPredicate(i[h]),n&&(r?e.condition==="and"?r=r.and(n):r=r.or(n):r=n);else if(!m(c)&&!m(c.length)){var d=i[h].operator.toLowerCase(),p=!1,v=["equal","notequal","greaterthan","greaterthanorequal","lessthan","lessthanorequal"];if(i[h].type==="string"&&(o=!this.matchCase),i[h].type==="date"&&v.indexOf(d)>-1&&(o=!0),l=this.getColumn(i[h].field),d.indexOf("null")>-1||d.indexOf("empty")>-1)i[h].value=null;else if(i[h].type==="date"&&!(i[h].value instanceof Array)){var g=this.getFormat(l.format);m(i[h].value)?a=null:(a=this.getDate(i[h].value,g),v.indexOf(d)>-1&&!this.isTime(i[h].value)&&(p=!0))}else a=i[h].value;if(h===0)if(p||(d.indexOf("in")>-1||d.indexOf("between")>-1||d.indexOf("null")>-1||d.indexOf("empty")>-1)&&d.indexOf("contain")<0)r=p?this.datePredicate(i[h],a):this.arrayPredicate(i[h]);else{var b=a;b!==""&&(r=new ht(i[h].field,c,a,o))}else if(p||(d.indexOf("in")>-1||d.indexOf("between")>-1||d.indexOf("null")>-1||d.indexOf("empty")>-1)&&d.indexOf("contain")<0)r=p?this.datePredicate(i[h],a,r,e.condition):this.arrayPredicate(i[h],r,e.condition);else if(e.condition==="and"){var b=a;r&&b!==""?r=r.and(i[h].field,c,a,o):b!==""&&(r=new ht(i[h].field,c,a,o))}else{var b=a;r&&b!==""?r=r.or(i[h].field,c,a,o):b!==""&&(r=new ht(i[h].field,c,a,o))}}}return this.dataSource instanceof fe&&!m(r)&&(r.operator==="isnull"||r.operator==="isnotnull")&&(r.operator=r.operator==="isnull"?"equal":"notequal"),r},t.prototype.getLocale=function(){var e=".dates.calendars.gregorian.days.format.short",i=this.locale,r="main.",n=ie(r+""+this.locale+e,N1);return n||(i="en"),i},t.prototype.getColumn=function(e,i){var r=this.columns,n;r=i||r;for(var a=0,o=r.length;a<o;a++)if(r[a].field===e){n=r[a];break}else if(r[a].columns){if(n=this.getColumn(e,r[a].columns),n)break}else if(e&&e.indexOf(this.separator)>-1&&this.separator!==""&&r[a].field===e.split(this.separator)[0]){n=r[a];break}return n},t.prototype.getOperators=function(e){var i=this.getColumn(e);return i.operators},t.prototype.setTime=function(e,i){return i?e.setHours(0,0,0):e.setHours(23,59,59),e},t.prototype.datePredicate=function(e,i,r,n){var a,o=this.setTime(new Date(i.getTime()),!0),l=this.setTime(i);switch(e.operator){case"equal":a=new ht(e.field,"greaterthanorequal",o),a=a.and(e.field,"lessthanorequal",l);break;case"notequal":a=new ht(e.field,"lessthan",o),a=a.or(e.field,"greaterthan",l);break;case"greaterthan":a=new ht(e.field,"greaterthan",l);break;case"greaterthanorequal":a=new ht(e.field,"greaterthanorequal",o);break;case"lessthan":a=new ht(e.field,"lessthan",o);break;case"lessthanorequal":a=new ht(e.field,"lessthanorequal",l);break}return a&&(r?n==="and"?r=r.and(a):n==="or"&&(r=r.or(a)):r=a),r},t.prototype.arrayPredicate=function(e,i,r){var n=e.value,a=e.operator.toString(),o=e.value,l,h=this.getColumn(e.field),u=this.getFormat(h.format);if(a.indexOf("null")>-1||a.indexOf("empty")>-1)switch(a){case"isnull":l=new ht(e.field,"isnull",o);break;case"isnotnull":l=new ht(e.field,"isnotnull",o);break;case"isempty":l=new ht(e.field,"equal","");break;case"isnotempty":l=new ht(e.field,"notequal","");break}if(!(a.indexOf("null")>-1||a.indexOf("empty")>-1)){for(var c=0,f=n.length;c<f;c++)if(n[c]!==""||(a==="in"||a==="notin")&&h.type==="string")if(c===0){var d="greaterthanorequal";switch(a){case"between":h.type!=="date"?l=new ht(e.field,d,n[c]):l=new ht(e.field,d,n[c]?this.isTime(n[c])?this.getDate(n[c],u):this.setTime(this.getDate(n[c],u),!0):null);break;case"notbetween":h.type==="date"?l=new ht(e.field,"lessthan",n[c]?this.isTime(n[c])?this.getDate(n[c],u):this.setTime(this.getDate(n[c],u),!0):null):l=new ht(e.field,"lessthan",n[c]);break;case"in":l=new ht(e.field,"equal",n[c]);break;case"notin":l=new ht(e.field,"notequal",n[c]);break}}else{var p="greaterthan";switch(e.operator){case"between":h.type==="date"?l=l.and(e.field,"lessthanorequal",n[c]?this.isTime(n[c])?this.getDate(n[c],u):this.setTime(this.getDate(n[c],u)):n[c]):l=l.and(e.field,"lessthanorequal",n[c]);break;case"notbetween":h.type==="date"?l=l.or(e.field,p,n[c]?this.isTime(n[c])?this.getDate(n[c],u):this.setTime(this.getDate(n[c],u)):n[c]):l=l.or(e.field,"greaterthan",n[c]);break;case"in":l=l.or(e.field,"equal",n[c]);break;case"notin":l=l.and(e.field,"notequal",n[c]);break}}}return l&&(i?r==="and"?i=i.and(l):r==="or"&&(i=i.or(l)):i=l),i},t.prototype.getDate=function(e,i){var r=this.intl.parseDate(e,i);return e.indexOf(":")>-1&&e.indexOf("/")<0&&e.indexOf(",")<0&&e.indexOf("-")<0&&(r=new Date,r.setHours(parseInt(e.split(":")[0],10)),r.setMinutes(parseInt(e.split(":")[1],10)),e.split(":")[2]&&r.setSeconds(parseInt(e.split(":")[2],10))),r},t.prototype.isTime=function(e){return!!(e&&e.indexOf(":")>-1)},t.prototype.importRules=function(e,i,r,n,a){if(!r)i=this.renderGroup(e,e.condition,i,n);else{if(e.rules&&e.rules.length>1&&!this.headerTemplate){var o=i.querySelector(".e-btngroup-or"),l=i.querySelector(".e-btngroup-and");if(this.enableSeparateConnector&&i.previousElementSibling&&(o=i.previousElementSibling.querySelector(".e-btngroup-or"),l=i.previousElementSibling.querySelector(".e-btngroup-and")),o.disabled=!1,l.disabled=!1,this.enableSeparateConnector){for(var h=i.previousElementSibling;h&&!h.classList.contains("e-rule-container");){if(h.classList.contains("e-group-container")){h=h.querySelectorAll(".e-rule-container")[h.querySelectorAll(".e-rule-container").length-1];break}h=h.previousElementSibling}if(h&&h.classList.contains("e-rule-container")){var u=h.id.replace(this.element.id+"_",""),c=this.getRule(u);c.condition==="or"?o.checked=!0:l.checked=!0}}else e.condition==="or"?o.checked=!0:l.checked=!0}else this.disableRuleCondition(i);if(this.headerTemplate&&a&&(i=this.renderGroup(e,e.condition,this.element,e.not,a)),this.enableNotCondition&&!this.headerTemplate){var f=i.querySelector(".e-qb-toggle");e.not?P([f],"e-active-toggle"):Z([f],"e-active-toggle")}}e.rules&&e.rules.length===0&&this.headerTemplate&&(e.rules[0]={label:"",field:"",operator:"",type:"",value:""});var d=e.rules;if(!m(d))for(var p=0,v=d.length;p<v;p++){var g=Object.keys(d[p]);if(!m(d[p].rules)&&g.indexOf("rules")>-1&&d[p].rules.length!==0){if(this.element.querySelectorAll(".e-group-container").length>this.maxGroupCount)return null;i=this.renderGroup(d[p],d[p].condition,i,d[p].not),i=this.importRules(d[p],i,!0)}else this.renderRule(d[p],i);if(!m(d[p].rules)&&d[p].isLocked){var b=i.querySelector(".e-rule-list").children[p].querySelector(".e-lock-grp-btn");this.groupLock(b)}}return i&&(i=X(i,".e-rule-list")),i&&(i=X(i,".e-group-container")),i},t.prototype.renderGroup=function(e,i,r,n,a){this.addGroupElement(!0,r,i,!1,n,a,e);var o=r.querySelectorAll(".e-group-container"),l=r.querySelector(".e-rule-list").children;if(this.showButtons.cloneGroup&&this.cloneGrpBtnClick&&this.isMiddleGroup){this.isMiddleGroup=!1,this.cloneGrpBtnClick=!1;var h=0,u=this.groupIndex+1;if(this.enableSeparateConnector)for(var c=0;c<u;c++)l[c].classList.contains("e-rule-container")&&(u++,h++);return l[this.groupIndex+h+1]}else return this.showButtons.cloneGroup&&this.cloneGrpBtnClick&&this.isLastGroup?(this.isLastGroup=!1,this.cloneGrpBtnClick=!1,l[l.length-1]):o[o.length-1]},t.prototype.renderRule=function(e,i){i.className.indexOf("e-group-container")>-1?this.addRuleElement(i,e):this.addRuleElement(i.querySelector(".e-group-container"),e)},t.prototype.enableReadonly=function(){for(var e=this.element,i=e.querySelectorAll(".e-dropdownlist, .e-dropdowntree, .e-numerictextbox, .e-textbox, .e-datepicker, .e-multiselect .e-lib, .e-radio"),r=0;r<i.length;r++)if(i[r].classList.contains("e-dropdownlist")){var n=fn(i[r],vu);n.readonly=this.isReadonly}else if(i[r].classList.contains("e-dropdowntree")){var a=He(i[r],"dropdowntree");a.readonly=this.isReadonly}else if(i[r].classList.contains("e-numerictextbox")){var o=fn(i[r],hd);o.readonly=this.isReadonly}else if(i[r].classList.contains("e-textbox")){var l=fn(i[r],qu);l.readonly=this.isReadonly}else if(i[r].classList.contains("e-datepicker")){var h=fn(i[r],Mu);h.readonly=this.isReadonly}else if(i[r].classList.contains("e-multiselect")){var u=fn(i[r],Ed);u.readonly=this.isReadonly}else if(i[r].classList.contains("e-radio")){var c=fn(i[r],qg);c.checked||(this.isReadonly?i[r].parentElement.style.display="none":i[r].parentElement.style.display="inherit")}var f=this.element.querySelectorAll(".e-deletegroup"),d=this.element.querySelectorAll(".e-addrulegroup"),p=this.element.querySelectorAll(".e-removerule");!this.isReadonly&&this.ruleElem.classList.contains("e-readonly")&&this.ruleElem.classList.remove("e-readonly");for(var v=[f,d,p],r=0;r<v.length;r++)v[r].forEach(function(b){b.classList.contains("e-readonly")?b.classList.remove("e-readonly"):b.classList.add("e-readonly")});this.enableBtnGroup()},t.prototype.enableBtnGroup=function(){var e=this,i=this.element.querySelectorAll(".e-btngroup-and-lbl, .e-btngroup-or-lbl, .e-qb-toggle"),r=!1;i.forEach(function(n){n.classList.contains("e-qb-toggle")&&!n.classList.contains("e-active-toggle")&&!n.classList.contains("e-readonly")?(n.classList.add("e-readonly"),r=!1):n.classList.contains("e-qb-toggle")&&n.classList.contains("e-not-readonly")?n.classList.remove("e-not-readonly"):n.classList.contains("e-qb-toggle")&&n.classList.contains("e-readonly")?n.classList.remove("e-readonly"):n.classList.contains("e-active-toggle")?(n.classList.add("e-not-readonly"),r=!0):n.previousElementSibling.checked||n.classList.contains("e-readonly")?(n.classList.remove("e-readonly"),r?n.textContent==="AND"?n.classList.add("e-readonly-and"):n.classList.add("e-readonly-or"):(n.textContent==="AND"&&e.isReadonly?(n.classList.remove("e-not"),n.classList.add("e-readonly-and")):(e.enableNotCondition&&n.classList.add("e-not"),n.classList.remove("e-readonly-and")),n.textContent==="OR"&&e.isReadonly?n.classList.add("e-readonly-or-not"):n.classList.remove("e-readonly-or-not"))):n.classList.contains("e-btn-disable")||n.classList.add("e-readonly")})},t.prototype.isDateFunction=function(e){for(var i=["date","time","day","week","month","year","hour","minute","second","now","quarter","period","extract"],r=0,n=i.length;r<n;r++)if(e.toLowerCase().indexOf(i[r])>-1)return!0;return!1},t.prototype.getSqlString=function(e,i,r,n){var a=!1;!r&&r!==""?(r="",a=!0):r+="(";var o=e.condition;if(e.not){var l=void 0;a?(l=n?this.l10n.getConstant("NOT").toUpperCase()+" (":"NOT (",r+=l):(l=n?" "+this.l10n.getConstant("NOT").toUpperCase()+" (":" NOT (",r+=l)}if(e.rules)for(var h=0,u=e.rules.length;h<u;h++){if(e.rules[h].rules)r=this.getSqlString(e.rules[h],i,r,n),this.enableSeparateConnector&&(o=e.rules[h].condition);else{var c=e.rules[h],f="",d=n?this.sqlOperators[c.operator]:this.operators[c.operator];if(c.value instanceof Array)if(c.operator.toString().indexOf("between")>-1){var p=n?" "+this.l10n.getConstant("AND").toUpperCase()+" ":" AND ";c.type==="date"&&!this.isDateFunction(c.value[0])?f+='"'+c.value[0]+'"'+p+'"'+c.value[1]+'"':f+=c.value[0]+p+c.value[1]}else if(typeof c.value[0]=="string"&&c.value!==null){f+='("'+c.value[0]+'"';for(var v=1,g=c.value.length;v<g;v++)f+=',"'+c.value[v]+'"';f+=")"}else f+="("+c.value+")";else c.operator.toString().indexOf("startswith")>-1?f+=c.value?'("'+c.value+'%")':"("+c.value+")":c.operator.toString().indexOf("endswith")>-1?f+=c.value?'("%'+c.value+'")':"("+c.value+")":c.operator.toString().indexOf("contains")>-1?f+=c.value?'("%'+c.value+'%")':"("+c.value+")":c.type==="number"||typeof c.value=="boolean"||c.value===null&&c.operator.toString().indexOf("empty")<-1?f+=c.value:c.operator.toString().indexOf("empty")>-1?f+='""':f+='"'+c.value+'"';if(c.operator.toString().indexOf("null")>-1)i?c.field="`"+c.field+"`":c.field.indexOf(" ")>-1&&(c.field='"'+c.field+'"'),r+=c.field+" "+d;else{var b=d;c.operator==="isempty"?b="=":c.operator==="isnotempty"&&(b="!="),i?c.field="`"+c.field+"`":c.field.indexOf(" ")>-1&&(c.field='"'+c.field+'"'),r+=c.field+" "+b+" "+f}c.condition&&c.condition!==""&&(o=c.condition)}if(h!==u-1){var c=e.rules[h];(o===""||c&&c.condition!==""&&c.custom&&c.custom.isCustom)&&(o=c.condition),o&&(o=n?this.l10n.getConstant(o.toUpperCase()).toUpperCase():o.toUpperCase(),r+=" "+o+" ")}}return a||(r+=")"),e.not&&(r+=")"),r},t.prototype.setRulesFromSql=function(e,i){e=e.replace(/`/g,"");var r=this.getRulesFromSql(e,i);this.setRules({condition:r.condition,not:r.not,rules:r.rules})},t.prototype.getRulesFromSql=function(e,i){this.parser=[],this.sqlParser(e,i),this.setProperties({rule:{condition:"and",not:!1,rules:[]}},!0);var r=this.processParser(this.parser,this.rule,[0],i);return this.enableNotCondition?{condition:r.condition,not:r.not,rules:r.rules}:{condition:r.condition,rules:r.rules}},t.prototype.getSqlFromRules=function(e,i,r){e||(e=this.getValidRules()),e=this.getRuleCollection(e,!1);var n=this.getSqlString(this.getValidRules(e),i,null,r).replace(/"/g,"'");return n},t.prototype.getParameterizedSql=function(e){if(this.moduleLoader.loadedModules.length){e||(e=this.getValidRules());var i={sql:null};return this.notify("query-library",{prop:"getParameterSql",onPropertyChange:!1,value:{rule:e,obj:i}}),i.sql}else console.warn('[WARNING] :: Module "query-library" is not available in QueryBuilder component! You either misspelled the module name or forgot to load it.');return null},t.prototype.setParameterizedSql=function(e){if(this.moduleLoader.loadedModules.length){var i={sql:null};this.notify("query-library",{prop:"convertParamSqlToSql",onPropertyChange:!1,value:{sql:e,obj:i}});var r=i.sql;if(r){r=r.replace(/`/g,"");var n=this.getRulesFromSql(r);this.setRules({condition:n.condition,not:n.not,rules:n.rules})}}else console.warn('[WARNING] :: Module "query-library" is not available in QueryBuilder component! You either misspelled the module name or forgot to load it.')},t.prototype.getParameterizedNamedSql=function(e){if(this.moduleLoader.loadedModules.length){e||(e=this.getValidRules());var i={sql:null};return this.notify("query-library",{prop:"getNamedParameterSql",onPropertyChange:!1,value:{rule:e,obj:i}}),i.sql}else console.warn('[WARNING] :: Module "query-library" is not available in QueryBuilder component! You either misspelled the module name or forgot to load it.');return null},t.prototype.setParameterizedNamedSql=function(e){if(this.moduleLoader.loadedModules.length){var i={sql:null};this.notify("query-library",{prop:"convertNamedParamSqlToSql",onPropertyChange:!1,value:{sql:e,obj:i}});var r=i.sql;if(r){r=r.replace(/`/g,"");var n=this.getRulesFromSql(r);this.setRules({condition:n.condition,not:n.not,rules:n.rules})}}else console.warn('[WARNING] :: Module "query-library" is not available in QueryBuilder component! You either misspelled the module name or forgot to load it.')},t.prototype.setMongoQuery=function(e,i){this.moduleLoader.loadedModules.length?(this.rule={condition:"and",not:!1,rules:[]},this.notify("query-library",{prop:"mongoParser",onPropertyChange:!1,value:{mongoQuery:JSON.parse(e),rule:this.rule,mongoLocale:i}})):console.warn('[WARNING] :: Module "query-library" is not available in QueryBuilder component! You either misspelled the module name or forgot to load it.')},t.prototype.getMongoQuery=function(e){if(this.moduleLoader.loadedModules.length){e||(e=this.getValidRules());var i={mongoQuery:null};return this.notify("query-library",{prop:"getMongoFromRules",onPropertyChange:!1,value:{rule:e,mongoQuery:"",obj:i}}),i.mongoQuery}else console.warn('[WARNING] :: Module "query-library" is not available in QueryBuilder component! You either misspelled the module name or forgot to load it.');return""},t.prototype.cloneRule=function(e,i,r){var n=this.getRule(e.replace(this.element.id+"_","")),a=this.showButtons.cloneRule;i=i.replace(this.element.id+"_",""),this.ruleIndex=r,this.cloneRuleBtnClick=!0,this.showButtons.cloneRule=!0,this.addRules([{label:n.label,field:n.field,type:n.type,operator:n.operator,value:n.value,condition:n.condition}],i),this.ruleIndex=-1,this.cloneRuleBtnClick=!1,this.showButtons.cloneRule=a,a=!1},t.prototype.cloneGroup=function(e,i,r){i=i.replace(this.element.id+"_","");var n=this.getGroup(i),a=this.showButtons.cloneGroup;e=e.replace(this.element.id+"_",""),this.groupIndex=r,this.cloneGrpBtnClick=!0,this.showButtons.cloneGroup=!0,this.addGroups([{condition:n.condition,not:n.not,rules:n.rules}],e),this.groupIndex=-1,this.cloneGrpBtnClick=!1,this.showButtons.cloneGroup=a,a=!1},t.prototype.lockRule=function(e){e.indexOf(this.element.id)<0&&(e=this.element.id+"_"+e);var i=document.getElementById(e).querySelectorAll(".e-lock-rule-btn")[0];this.ruleLock(i)},t.prototype.lockGroup=function(e){e.indexOf(this.element.id)<0&&(e=this.element.id+"_"+e);var i=document.getElementById(e).querySelectorAll(".e-lock-grp-btn")[0];this.groupLock(i)},t.prototype.sqlParser=function(e,i){var r=0,n;do n=e.slice(r),r+=this.parseSqlStrings(n,i);while(n!=="");return this.parser},t.prototype.parseSqlStrings=function(e,i){var r=["=","!=","<=",">=","<",">"],n;i?n=[this.l10n.getConstant("AND").toUpperCase(),this.l10n.getConstant("OR").toUpperCase(),this.l10n.getConstant("NOT").toUpperCase()]:n=["AND","OR","NOT"];var a;i?a=[this.l10n.getConstant("In").toUpperCase(),this.l10n.getConstant("NotIn").toUpperCase(),this.l10n.getConstant("Like").toUpperCase(),this.l10n.getConstant("NotLike").toUpperCase(),this.l10n.getConstant("Between").toUpperCase(),this.l10n.getConstant("NotBetween").toUpperCase(),this.l10n.getConstant("IsNull").toUpperCase(),this.l10n.getConstant("IsNotNull").toUpperCase(),this.l10n.getConstant("IsEmpty").toUpperCase(),this.l10n.getConstant("IsNotEmpty").toUpperCase()]:a=["IN","NOT IN","LIKE","NOT LIKE","BETWEEN","NOT BETWEEN","IS NULL","IS NOT NULL","IS EMPTY","IS NOT EMPTY"];for(var o,l,h,u=0,c=r.length;u<c;u++){o=/^\w+$/.test(r[u])?"\\b":"";var f=RegExp;if(l=new f("^("+r[u]+")"+o,"ig"),l.exec(e))return this.parser.push(["Operators",r[u].toLowerCase()]),r[u].length}var d=this.parser[this.parser.length-1];if(!d||d&&d[0]!=="Literal")for(var u=0,c=n.length;u<c;u++){o=/^\w+$/.test(n[u])?"\\b":"";var f=RegExp;if(l=new f("^("+n[u]+")"+o,"ig"),l.exec(e))return this.parser.push(["Conditions",n[u].toLowerCase()]),n[u].length}for(var u=0,c=a.length;u<c;u++){o=/^\w+$/.test(a[u])?"\\b":"";var f=RegExp;if(l=new f("^("+a[u]+")"+o,"ig"),l.exec(e))return this.parser.push(["SubOperators",a[u].toLowerCase()]),a[u].length}if(/^\(/.exec(e))return this.parser.push(["Left","("]),1;if(/^\)/.exec(e))return this.parser.push(["Right",")"]),1;if(/^(true|false)/.exec(e))return h=/^(true|false)/.exec(e)[0],this.parser.push(["String",h]),h.length;if(/^null/.exec(e))return h=/^null/.exec(e)[0],this.parser.push(["String",null]),h.length;if(/^`?([a-z_][a-z0-9_.\\[\]\\(\\)]{0,}(\\:(number|float|string|date|boolean))?)`?/i.exec(e))return h=/^`?([a-z_][a-z0-9_.\\[\]\\(\\)]{0,}(\\:(number|float|string|date|boolean))?)`?/i.exec(e)[1],this.parser.push(["Literal",h]),h.length;if(this.checkLiteral()&&/^'?([a-z_][a-z0-9 _.\\[\]\\(\\)-]{0,}(\\:(number|float|string|date|boolean))?)'?/i.exec(e))return h=/^'?([a-z_][a-z0-9 _.\\[\]\\(\\)-]{0,}(\\:(number|float|string|date|boolean))?)'?/i.exec(e)[1],this.parser.push(["Literal",h]),h.length+2;if(this.checkNumberLiteral(e,i)){var p=/^[0-9]+(\.[0-9]+)$/.exec(e);if(p)return h=p[0],this.parser.push(["Literal",h]),h.length}var v=this.getSingleQuoteString(e);if(v!==""){if(h=v,h[h.length-2]==="(")for(var g=!1,b=h.length;b<e.length&&(h+=e[b],e[b]===")"&&(g=!0),!(g&&e[b]==="'"));b++);else e[h.length]&&e[h.length]!==")"&&!this.checkCondition(e,h)&&(h=this.combineSingleQuoteString(e,h));return this.parser.push(["String",h]),h.length}var C=this.getDoubleQuoteString(e);return C!==""?(h=C,this.parser.push(["DoubleString",h]),h.length):/^\d*\.?\d+/.exec(e)?(h=/^\d*\.?\d+/.exec(e)[0],this.parser.push(["Number",h]),h.length):/^-?\d*\.?\d+/.exec(e)?(h=/^-?\d*\.?\d+/.exec(e)[0],this.parser.push(["Number",h]),h.length):1},t.prototype.getDoubleQuoteString=function(e){var i=e.indexOf('"');if(i===0){var r=e.indexOf('"',i+1);if(r!==-1)return e.substring(i,r+1)}return""},t.prototype.checkCondition=function(e,i){return e.slice(i.length+1,i.length+4)==="AND"||e.slice(i.length+1,i.length+3)==="OR"},t.prototype.getSingleQuoteString=function(e,i){var r=e.indexOf("'");if(r!==-1&&i||r===0&&!i){var n=e.indexOf("'",r+1);if(n!==-1)return e.substring(r,n+1)}return""},t.prototype.combineSingleQuoteString=function(e,i){if(e[i.length]&&e[i.length]!==")"&&!this.checkCondition(e,i)&&e[i.length]!==","){var r=i.substring(0,i.length-1),n=e.replace(r,""),a=this.getSingleQuoteString(n,!0);if(a!==""){var o=a.substring(1,a.length);i+=o,i=this.combineSingleQuoteString(e,i)}}return i},t.prototype.checkLiteral=function(){var e=this.parser[this.parser.length-1];if(e){var i=this.parser[this.parser.length-2],r=this.parser[this.parser.length-3];if(e[0]==="Left"&&i&&i[0]==="Conditions")return!0;var n="between";if(e[0]==="Conditions"&&r&&r[1].indexOf(n)<0)return!0}else return!0;return!1},t.prototype.checkNumberLiteral=function(e,i){var r=this.parser[this.parser.length-1];if(r){if(/^[0-9]+(?:\.[0-9]+)$/.exec(e)){var n=this.parser[this.parser.length-2],a=this.parser[this.parser.length-3];if(r[0]==="Left"&&n&&n[0]==="Conditions")return!0;var o=i?this.l10n.getConstant("Between").toLowerCase():"between";if(r[0]==="Conditions"&&a&&a[1].indexOf(o)<0)return!0}}else return!0;return!1},t.prototype.getOperator=function(e,i,r){var n={"=":"equal","!=":"notequal","<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal",in:"in","not in":"notin",between:"between","not between":"notbetween","is empty":"isempty","is null":"isnull","is not null":"isnotnull","is not empty":"isnotempty"};if(r){for(var a=Object.keys(this.sqlOperators),o=0;o<a.length;o++)if(this.sqlOperators[a[o]]===i.toUpperCase())return e&&e.indexOf("%")===0&&e[e.length-1]==="%"?i.toUpperCase()==="NOT LIKE"?"notcontains":"contains":e&&e.indexOf("%")!==0&&e.indexOf("%")===e.length-1?i.toUpperCase()==="NOT LIKE"?"notstartswith":"startswith":e&&e.indexOf("%")===0&&e.indexOf("%")!==e.length-1?i.toUpperCase()==="NOT LIKE"?"notendswith":"endswith":a[o];return null}if(e){if(e.indexOf("%")===0&&e[e.length-1]==="%")return i==="not like"?"notcontains":"contains";if(e.indexOf("%")!==0&&e.indexOf("%")===e.length-1)return i==="not like"?"notstartswith":"startswith";if(e.indexOf("%")===0&&e.indexOf("%")!==e.length-1)return i==="not like"?"notendswith":"endswith"}else{if(i==="not like")return"notequal";if(i==="like")return"equal"}return n[""+i]},t.prototype.getTypeFromColumn=function(e){var i=this.getColumn(e.field);return m(i)?null:i.type},t.prototype.getLabelFromColumn=function(e){var i="",r=0;if(this.separator!==""){for(var n=e.split(this.separator),a=0;a<n.length;a++)i+=this.getLabelFromField(n,a+1),r++,r<n.length&&(i+=this.separator);return i}else{var o=this.getColumn(e).label;return o}},t.prototype.getLabelFromField=function(e,i){for(var r="",n=0,a=0;a<i;a++)r+=e[a],n++,n<i&&(r+=this.separator);return this.getColumn(r).label},t.prototype.processParser=function(e,i,r,n){for(var a,o,l,h,u=[],c=[],f,d,p,v,g,b,C=!1,y=!1,x=0,w=e.length;x<w;x++)if(e[x][0]==="Literal"){var S=this.getColumn(e[x][1]);if(l={label:S&&S.label?S.label:e[x][1],field:e[x][1]},e[x+1][0]==="SubOperators"){if(e[x+1][1].indexOf("null")>-1||e[x+1][1].indexOf("empty")>-1)l.operator=this.getOperator(" ",e[x+1][1],n),l.value=null,l.type=this.getTypeFromColumn(l);else{var E=e[x+3][1]?e[x+3][1].replace(/'/g,""):e[x+3][1];l.operator=this.getOperator(E,e[x+1][1],n)}for(b=e[x+1][1],x++,a=x+1,o=w,n&&l.operator==="contains"||l.operator==="startswith"||l.operator==="endswith"?b="like":n&&l.operator==="notcontains"||l.operator==="notstartswith"||l.operator==="notendswith"?b="not like":n&&(b=l.operator),a=x+1;a<o;a++)if(b.indexOf("between")<0&&e[a][0]==="Left")C=!0;else if(e[a][0]==="Right"&&C){x=a,C=!1;break}else{if(b.indexOf("null")>-1||b.indexOf("empty")>-1)break;if(b.indexOf("like")>-1&&e[a][0]==="String"){var k=e[a][1];e[a][1]&&e[a][1][0]==="'"&&(k=e[a][1].substring(1,e[a][1].length-1)),k=k?k.replace(/%/g,""):e[a][1],l.value=k,l.type="string"}else if(b.indexOf("between")>-1){if(e[a][0]==="Literal"||e[a][0]==="Left")break;if(e[a][0]==="Number")u.push(Number(e[a][1]));else if(e[a][0]==="String"){var k=e[a][1];e[a][1]&&e[a][1][0]==="'"&&(k=e[a][1].substring(1,e[a][1].length-1)),c.push(k)}}else if(e[a][0]==="Number")u.push(Number(e[a][1]));else if(e[a][0]==="String"){var k=e[a][1];e[a][1]&&e[a][1][0]==="'"&&(k=e[a][1].substring(1,e[a][1].length-1)),c.push(k)}l.type=this.getTypeFromColumn(l)}b.indexOf("like")<0&&(e[a-1][0]==="Number"?(l.value=u,l.type="number"):e[a-1][0]==="String"?(l.value=c,l.type="string"):b.indexOf("between")>-1&&e[a-1][0]==="Conditions"&&(c.length!==0?(l.value=c,l.type="string"):(l.value=u,l.type="number")),u=[],c=[],l.type=this.getTypeFromColumn(l)),this.enableSeparateConnector&&e[x+1][0]==="Conditions"&&(l.condition=e[x+1][1])}else if(e[x+1][0]==="Operators"){if(l.operator=this.getOperator(e[x+2][1],e[x+1][1],n),l.operator==="equal"&&e[x+2][0]==="String"&&e[x+2][1]==="''"?l.operator="isempty":l.operator==="notequal"&&e[x+2][0]==="String"&&e[x+2][1]==="''"&&(l.operator="isnotempty"),e[x+2][0]==="Number")l.type="number",l.value=Number(e[x+2][1]);else{l.type="string";var k=e[x+2][1];k&&k[0]==="'"&&(k=k.substring(1,k.length-1)),l.value=k}this.enableSeparateConnector&&e[x+3][0]==="Conditions"&&(l.condition=e[x+3][1]),l.type=this.getTypeFromColumn(l)}i.rules.push(l)}else if(e[x][0]==="Left"){if(e[0][0]!=="Left"&&(e[x-1][1]==="not"||n&&this.l10n.getConstant("NOT").toLowerCase()===e[x-1][1])){y=!0;continue}for(this.parser=e.splice(x+1,w-(x+1)),this.enableNotCondition?h={condition:"and",rules:[],not:!1}:h={condition:"and",rules:[]},g=0,d=i.rules.length,f=0;f<d;f++)i.rules[f].rules&&g++;return r.push(g),i.rules.push(h),h=this.processParser(this.parser,h,r,n),i}else if(e[x][0]==="Conditions"&&!this.enableSeparateConnector)e[x][1]==="not"||n&&this.l10n.getConstant("NOT").toLowerCase()===e[x][1]?i.not=!0:i.condition=e[x][1];else if(e[x][0]==="Right"){if(y&&e[x+1][0]==="Right"){y=!1;continue}for(this.parser=e.splice(x+1,w-(x+1)),r.pop(),i=this.rule,v=r.length,p=0;p<v;p++)i=this.findGroupByIdx(r[p],i,p===0);return this.processParser(this.parser,i,r,n)}return i},t.prototype.groupClone=function(e){var i=e.closest(".e-rule-list").closest(".e-group-container"),r=e.id.replace(this.element.id+"_",""),n=i.id.replace(this.element.id+"_",""),a=this.getGroup(r);this.groupIndex=Array.prototype.indexOf.call(e.closest(".e-rule-list").children,e.closest(".e-group-container")),this.addGroups([{condition:a.condition,not:a.not,rules:a.rules}],n),this.groupIndex=-1},t.prototype.ruleClone=function(e){for(var i=X(e,".e-rule-container"),r=e.closest(".e-rule-list").closest(".e-group-container"),n=this.getRule(e),a=r.id.replace(this.element.id+"_",""),o=r.querySelectorAll(".e-rule-container"),l=0,h=o.length;l<h;l++)i.id===o[l].id&&(this.ruleIndex=l);this.enableSeparateConnector?this.addRules([{label:n.label,field:n.field,type:n.type,operator:n.operator,value:n.value,condition:n.condition}],a):this.addRules([{label:n.label,field:n.field,type:n.type,operator:n.operator,value:n.value}],a),this.ruleIndex=-1},t.prototype.ruleLock=function(e){var i=X(e,".e-rule-container"),r=this.getRule(i.id.replace(this.element.id+"_",""));i.classList.contains("e-disable")?(r.isLocked=!1,this.lockItems=this.lockItems.filter(function(n){return n!==i.id}),i.classList.remove("e-disable"),this.disableRuleControls(e,i,!1),e.children[0].classList.add("e-unlock"),e.children[0].classList.remove("e-lock"),e.setAttribute("title",this.l10n.getConstant("LockRule"))):(r.isLocked=!0,this.lockItems.indexOf(i.id)<0&&this.lockItems.splice(this.lockItems.length-1,0,i.id),i.classList.add("e-disable"),this.disableRuleControls(e,i,!0),e.children[0].classList.add("e-lock"),e.children[0].classList.remove("e-unlock"),e.setAttribute("title",this.l10n.getConstant("UnlockRule")))},t.prototype.groupLock=function(e){var i=X(e,".e-group-container"),r=this.getGroup(i.id.replace(this.element.id+"_","")),n=i.id.indexOf("group0")>-1;if(i.classList.contains("e-disable")){if(n){var a={};a.condition=r.condition,a.not=r.not,a.isLocked=!1,this.setProperties({rule:a},!0)}else r.isLocked=!1;this.lockItems=this.lockItems.filter(function(o){return o!==i.id}),i.classList.remove("e-disable"),this.disableHeaderControls(e,i,!1),e.children[0].classList.add("e-unlock"),e.children[0].classList.remove("e-lock"),e.setAttribute("title",this.l10n.getConstant("LockGroup")),this.updateLockItems()}else{if(n){var a={};a.condition=r.condition,a.not=r.not,a.isLocked=!0,this.setProperties({rule:a},!0)}else r.isLocked=!0;this.lockItems.indexOf(i.id)<0&&this.lockItems.splice(this.lockItems.length-1,0,i.id),i.classList.add("e-disable"),this.disableHeaderControls(e,i,!0),e.children[0].classList.add("e-lock"),e.children[0].classList.remove("e-unlock"),e.setAttribute("title",this.l10n.getConstant("UnlockGroup"))}},t.prototype.updateLockItems=function(){for(var e=0;e<this.lockItems.length;e++){var i=this.lockItems[e].split("_");if(i.length>2){var r=this.element.querySelector("#"+this.lockItems[e]),n=r.querySelector(".e-lock-rule-btn");r=X(n,".e-rule-container"),r.classList.contains("e-disable")||this.ruleLock(n)}else{var a=this.element.querySelector("#"+this.lockItems[e]),n=a.querySelector(".e-lock-grp-btn");a=X(n,".e-group-container"),a.classList.contains("e-disable")||this.groupLock(n)}}},t.prototype.disableHeaderControls=function(e,i,r){for(var n=i.querySelectorAll(".e-btngroup-and"),a=i.querySelectorAll(".e-btngroup-or"),o=i.querySelectorAll(".e-qb-toggle"),l=i.querySelectorAll(".e-add-btn"),h=i.querySelectorAll(".e-deletegroup"),u=i.querySelectorAll(".e-lock-grp-btn"),c=i.querySelectorAll(".e-clone-grp-btn"),f=i.querySelectorAll(".e-group-container"),d=i.querySelectorAll(".e-add-condition-btn"),p=i.querySelectorAll(".e-add-group-btn"),v=0;v<n.length;v++)r?(f[v]&&f[v].classList.contains("e-disable")&&f[v].classList.add("e-disable"),n[v].disabled=!0,a[v].disabled=!0,l[v]&&(l[v].disabled=!0),d[v]&&(d[v].disabled=!0),p[v]&&(p[v].disabled=!0),o[v]&&(o[v].disabled=!0),h[v]&&(h[v].disabled=!0),c[v]&&(c[v].disabled=!0),n[v].parentElement.classList.add("e-disabled"),u[v]&&u[v]!==e&&(u[v].disabled=!0,u[v].children[0].classList.remove("e-unlock"),u[v].children[0].classList.add("e-lock"))):(f[v]&&f[v].classList.remove("e-disable"),n[v].disabled=!1,a[v].disabled=!1,l[v]&&(l[v].disabled=!1),d[v]&&(d[v].disabled=!1),p[v]&&(p[v].disabled=!1),u[v]&&(u[v].disabled=!1),o[v]&&(o[v].disabled=!1),h[v]&&(h[v].disabled=!1),c[v]&&(c[v].disabled=!1),n[v].parentElement.classList.remove("e-disabled"),u[v]&&u[v].children[0].classList.remove("e-lock"),u[v]&&u[v].children[0].classList.add("e-unlock"));this.disableRuleControls(e,i,r)},t.prototype.disableRuleControls=function(e,i,r){for(var n=i.querySelectorAll(".e-control.e-dropdownlist"),a=i.querySelectorAll(".e-control.e-numerictextbox"),o=i.querySelectorAll(".e-control.e-textbox"),l=i.querySelectorAll(".e-control.e-datepicker"),h=i.querySelectorAll(".e-control.e-checkbox"),u=i.querySelectorAll(".e-control.e-radio"),c=i.querySelectorAll(".e-control.e-multiselect"),f=i.querySelectorAll(".e-rule-delete"),d=i.querySelectorAll(".e-lock-rule"),p=i.querySelectorAll(".e-clone-rule"),v=i.querySelectorAll(".e-rule-container"),g=0;g<f.length;g++)r?(v[g]&&v[g].classList.contains("e-disable")&&v[g].classList.add("e-disable"),f[g].disabled=!0,p[g]&&(p[g].disabled=!0),d[g]!==e&&(d[g].disabled=!0,d[g].children[0].classList.remove("e-unlock"),d[g].children[0].classList.add("e-lock"))):(v[g]&&v[g].classList.remove("e-disable"),p[g]&&(p[g].disabled=!1),f[g].disabled=!1,d[g].disabled=!1,d[g].children[0].classList.remove("e-lock"),d[g].children[0].classList.add("e-unlock"));for(var b,C,y,x,w,S,E,g=0;g<n.length;g++)b=He(n[g],"dropdownlist"),r?b.enabled=!1:b.enabled=!0;for(var g=0;g<a.length;g++)C=He(a[g],"numerictextbox"),r?C.enabled=!1:C.enabled=!0;for(var g=0;g<o.length;g++)y=He(o[g],"textbox"),r?y.enabled=!1:y.enabled=!0;for(var g=0;g<l.length;g++)x=He(l[g],"datepicker"),r?x.enabled=!1:x.enabled=!0;for(var g=0;g<h.length;g++)w=He(h[g],"checkbox"),r?w.disabled=!0:w.disabled=!1;for(var g=0;g<u.length;g++)S=He(u[g],"radio"),r?S.disabled=!0:S.disabled=!1;for(var g=0;g<c.length;g++)E=He(c[g],"multiselect"),r?E.enabled=!1:E.enabled=!0},Ge([Se()],t.prototype,"created",void 0),Ge([Se()],t.prototype,"actionBegin",void 0),Ge([Se()],t.prototype,"beforeChange",void 0),Ge([Se()],t.prototype,"change",void 0),Ge([Se()],t.prototype,"dataBound",void 0),Ge([Se()],t.prototype,"ruleChange",void 0),Ge([Se()],t.prototype,"dragStart",void 0),Ge([Se()],t.prototype,"drag",void 0),Ge([Se()],t.prototype,"drop",void 0),Ge([Ur({},J3)],t.prototype,"showButtons",void 0),Ge([O(!1)],t.prototype,"summaryView",void 0),Ge([O(!1)],t.prototype,"allowValidation",void 0),Ge([O("Default")],t.prototype,"fieldMode",void 0),Ge([O([])],t.prototype,"columns",void 0),Ge([O(null)],t.prototype,"fieldModel",void 0),Ge([O(null)],t.prototype,"operatorModel",void 0),Ge([O(null)],t.prototype,"valueModel",void 0),Ge([O()],t.prototype,"headerTemplate",void 0),Ge([O("")],t.prototype,"cssClass",void 0),Ge([O([])],t.prototype,"dataSource",void 0),Ge([O("Horizontal")],t.prototype,"displayMode",void 0),Ge([O(!1)],t.prototype,"enablePersistence",void 0),Ge([O("Default")],t.prototype,"sortDirection",void 0),Ge([O(5)],t.prototype,"maxGroupCount",void 0),Ge([O("auto")],t.prototype,"height",void 0),Ge([O("auto")],t.prototype,"width",void 0),Ge([O(!1)],t.prototype,"matchCase",void 0),Ge([O(0)],t.prototype,"immediateModeDelay",void 0),Ge([O(!1)],t.prototype,"enableNotCondition",void 0),Ge([O(!1)],t.prototype,"readonly",void 0),Ge([O(!0)],t.prototype,"addRuleToNewGroups",void 0),Ge([O(!1)],t.prototype,"autoSelectField",void 0),Ge([O(!0)],t.prototype,"autoSelectOperator",void 0),Ge([O("")],t.prototype,"separator",void 0),Ge([O(!1)],t.prototype,"enableSeparateConnector",void 0),Ge([Ur({condition:"and",rules:[]},Y3)],t.prototype,"rule",void 0),Ge([O(!1)],t.prototype,"allowDragAndDrop",void 0),t=Ge([Wi],t),t}(Rr),Z3=function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),jw=function(s){Z3(t,s);function t(e){var i=s.call(this,e)||this;return i.initRenderCalled=!1,i.checkInjectedModules=!0,i.directivekeys={columns:"column"},i.statelessTemplateProps=null,i.templateProps=null,i.immediateRender=!1,i.isReactMock=!0,i.portals=[],i}return t.prototype.render=function(){if(this.isReactMock=!1,(this.element&&!this.initRenderCalled||this.refreshing)&&!this.isReactForeceUpdate)s.prototype.render.call(this),this.initRenderCalled=!0;else return _e.createElement("div",this.getDefaultAttributes(),[].concat(this.props.children,this.portals))},t}(Q3);bB(jw,[gB,_e.Component]);const eV=ks(Ae.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),tV=ds("div")(({theme:s})=>({position:"relative",borderRadius:s.shape.borderRadius,backgroundColor:ns(s.palette.common.white,.15),"&:hover":{backgroundColor:ns(s.palette.common.white,.25)},marginRight:s.spacing(2),marginLeft:0,width:"100%",maxWidth:"400px",[s.breakpoints.up("sm")]:{marginLeft:s.spacing(3),width:"auto"}})),iV=ds("div")(({theme:s})=>({padding:s.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"})),rV=ds(wT)(({theme:s})=>({color:"inherit","& .MuiInputBase-input":{padding:s.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(s.spacing(4),")"),transition:s.transitions.create("width"),width:"100%",[s.breakpoints.up("md")]:{width:"20ch"}}})),sV=({setFilter:s})=>{const t=e=>s(e.target.value);return Ae.jsxs(tV,{className:"no-print",children:[Ae.jsx(iV,{children:Ae.jsx(eV,{})}),Ae.jsx(rV,{placeholder:"Search",inputProps:{"aria-label":"search"},onChange:t})]})},UQ=({splitBy:s,handleToggle:t,defaultValue:e=null})=>{const[i,r]=_e.useState(e),n=(a,o)=>{r(o),t(o)};return Ae.jsx(YT,{className:"no-print",color:"primary",size:"small",value:i,onChange:n,"aria-label":"group toggle",exclusive:!0,sx:{mb:1},children:s.map(a=>Ae.jsx(qT,{value:a.field,"aria-label":a.field,sx:{textTransform:"none"},children:a.buttonLabel},a.field))})},nV=ks(Ae.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),aV=ks(Ae.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy"),oV=ks(Ae.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),$Q=({data:s,rules:t,setOpen:e,setFilteredData:i})=>{const r=_e.useRef(null),[n,a]=_e.useState(t),[o,l]=_e.useState(!1),h=_e.useMemo(()=>[hV(s)],[s]),u=()=>{const v=r.current;if(!v)return;const g=v.getRules();a(g)},c=()=>{const v=r.current;if(v){try{const g=v.getRules(),b=v.getPredicate(g);console.log("rules:",g);const C=new fe(s),y=b?C.executeLocal(new We().where(b)):s;i(y,g,b!=null?b:null)}catch(g){console.error("invalid query rules:",g),i(s,{},null)}e(!1)}},f=()=>{e(!1)},d=()=>{e(!1),i(s,void 0,null),a(void 0)},p=async()=>{try{await navigator.clipboard.writeText(JSON.stringify(n,null,2)),l(!0),setTimeout(()=>l(!1),1500)}catch(v){console.error("Failed to copy:",v)}};return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(Ll,{variant:"h2",children:"Filter"}),Ae.jsx(jw,{width:"100%",ref:r,dataSource:h,rule:n,allowDragAndDrop:!0,sortDirection:"Ascending",separator:".",showButtons:{cloneRule:!0,cloneGroup:!0},change:u}),Ae.jsxs(wf,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mt:2},children:[Ae.jsx(Ll,{variant:"subtitle1",children:"Current Rules"}),Ae.jsx(Xh,{size:"small",variant:"outlined",startIcon:o?Ae.jsx(oV,{}):Ae.jsx(aV,{}),onClick:p,children:o?"Copied!":"Copy"})]}),Ae.jsx("pre",{style:{background:"#f5f5f5",padding:"8px",borderRadius:"6px",marginTop:"0.5rem",maxHeight:"100px",overflowY:"auto",fontSize:"0.85rem"},children:JSON.stringify(n,null)}),Ae.jsxs(wf,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mt:1},children:[Ae.jsxs(wf,{direction:"row",gap:2,children:[Ae.jsx(Xh,{variant:"outlined",onClick:c,children:"Apply"}),Ae.jsx(Xh,{variant:"outlined",onClick:f,children:"Close"})]}),n&&Ae.jsxs(Xh,{variant:"outlined",color:"error",onClick:d,children:[Ae.jsx(nV,{}),"Clear"]})]})]})},lV=s=>{const t={};for(const[i,r]of Object.entries(s))if(!(typeof r=="function"||r===null||Array.isArray(r)))if(typeof r=="object"&&!(r instanceof Date)){const n={};for(const[a,o]of Object.entries(r))if(typeof o=="object"&&o!==null&&!(o instanceof Date)&&!Array.isArray(o)){const l={};for(const[h,u]of Object.entries(o))(typeof u!="object"&&typeof u!="function"||u instanceof Date)&&(l[h]=u);n[a]=l}else(typeof o!="object"&&typeof o!="function"||o instanceof Date)&&(n[a]=o);t[i]=n}else typeof r!="function"&&(typeof r!="object"||r instanceof Date)&&(t[i]=r);return[gv(t)]},gv=s=>{const t={};return Object.keys(s).sort((e,i)=>e.localeCompare(i)).forEach(e=>{const i=s[e];i&&typeof i=="object"&&!Array.isArray(i)&&!(i instanceof Date)?t[e]=gv(i):t[e]=i}),t},hV=s=>{const t={};for(const e of s){const i=lV(e)[0];for(const[r,n]of Object.entries(i))r in t||(t[r]=n)}return gv(t)};class Gi{constructor(t){this.table=t}reloadData(t,e,i){return this.table.dataLoader.load(t,void 0,void 0,void 0,e,i)}langText(){return this.table.modules.localize.getText(...arguments)}langBind(){return this.table.modules.localize.bind(...arguments)}langLocale(){return this.table.modules.localize.getLocale(...arguments)}commsConnections(){return this.table.modules.comms.getConnections(...arguments)}commsSend(){return this.table.modules.comms.send(...arguments)}layoutMode(){return this.table.modules.layout.getMode()}layoutRefresh(t){return this.table.modules.layout.layout(t)}subscribe(){return this.table.eventBus.subscribe(...arguments)}unsubscribe(){return this.table.eventBus.unsubscribe(...arguments)}subscribed(t){return this.table.eventBus.subscribed(t)}subscriptionChange(){return this.table.eventBus.subscriptionChange(...arguments)}dispatch(){return this.table.eventBus.dispatch(...arguments)}chain(){return this.table.eventBus.chain(...arguments)}confirm(){return this.table.eventBus.confirm(...arguments)}dispatchExternal(){return this.table.externalEvents.dispatch(...arguments)}subscribedExternal(t){return this.table.externalEvents.subscribed(t)}subscriptionChangeExternal(){return this.table.externalEvents.subscriptionChange(...arguments)}options(t){return this.table.options[t]}setOption(t,e){return typeof e<"u"&&(this.table.options[t]=e),this.table.options[t]}deprecationCheck(t,e,i){return this.table.deprecationAdvisor.check(t,e,i)}deprecationCheckMsg(t,e){return this.table.deprecationAdvisor.checkMsg(t,e)}deprecationMsg(t){return this.table.deprecationAdvisor.msg(t)}module(t){return this.table.module(t)}}class $t{static elVisible(t){return!(t.offsetWidth<=0&&t.offsetHeight<=0)}static elOffset(t){var e=t.getBoundingClientRect();return{top:e.top+window.pageYOffset-document.documentElement.clientTop,left:e.left+window.pageXOffset-document.documentElement.clientLeft}}static retrieveNestedData(t,e,i){var r=t?e.split(t):[e],n=r.length,a;for(let o=0;o<n&&(i=i[r[o]],a=i,!!i);o++);return a}static deepClone(t,e,i=[]){var r={}.__proto__,n=[].__proto__;e||(e=Object.assign(Array.isArray(t)?[]:{},t));for(var a in t){let o=t[a],l,h;o!=null&&typeof o=="object"&&(o.__proto__===r||o.__proto__===n)&&(l=i.findIndex(u=>u.subject===o),l>-1?e[a]=i[l].copy:(h=Object.assign(Array.isArray(o)?[]:{},o),i.unshift({subject:o,copy:h}),e[a]=this.deepClone(o,h,i)))}return e}}let uV=class Uw extends Gi{constructor(t,e,i){super(t),this.element=e,this.container=this._lookupContainer(),this.parent=i,this.reversedX=!1,this.childPopup=null,this.blurable=!1,this.blurCallback=null,this.blurEventsBound=!1,this.renderedCallback=null,this.visible=!1,this.hideable=!0,this.element.classList.add("tabulator-popup-container"),this.blurEvent=this.hide.bind(this,!1),this.escEvent=this._escapeCheck.bind(this),this.destroyBinding=this.tableDestroyed.bind(this),this.destroyed=!1}tableDestroyed(){this.destroyed=!0,this.hide(!0)}_lookupContainer(){var t=this.table.options.popupContainer;return typeof t=="string"?(t=document.querySelector(t),t||console.warn("Menu Error - no container element found matching selector:",this.table.options.popupContainer,"(defaulting to document body)")):t===!0&&(t=this.table.element),t&&!this._checkContainerIsParent(t)&&(t=!1,console.warn("Menu Error - container element does not contain this table:",this.table.options.popupContainer,"(defaulting to document body)")),t||(t=document.body),t}_checkContainerIsParent(t,e=this.table.element){return t===e?!0:e.parentNode?this._checkContainerIsParent(t,e.parentNode):!1}renderCallback(t){this.renderedCallback=t}containerEventCoords(t){var e=!(t instanceof MouseEvent),i=e?t.touches[0].pageX:t.pageX,r=e?t.touches[0].pageY:t.pageY;if(this.container!==document.body){let n=$t.elOffset(this.container);i-=n.left,r-=n.top}return{x:i,y:r}}elementPositionCoords(t,e="right"){var i=$t.elOffset(t),r,n,a;switch(this.container!==document.body&&(r=$t.elOffset(this.container),i.left-=r.left,i.top-=r.top),e){case"right":n=i.left+t.offsetWidth,a=i.top-1;break;case"bottom":n=i.left,a=i.top+t.offsetHeight;break;case"left":n=i.left,a=i.top-1;break;case"top":n=i.left,a=i.top;break;case"center":n=i.left+t.offsetWidth/2,a=i.top+t.offsetHeight/2;break}return{x:n,y:a,offset:i}}show(t,e){var i,r,n,a,o;return this.destroyed||this.table.destroyed?this:(t instanceof HTMLElement?(n=t,o=this.elementPositionCoords(t,e),a=o.offset,i=o.x,r=o.y):typeof t=="number"?(a={top:0,left:0},i=t,r=e):(o=this.containerEventCoords(t),i=o.x,r=o.y,this.reversedX=!1),this.element.style.top=r+"px",this.element.style.left=i+"px",this.container.appendChild(this.element),typeof this.renderedCallback=="function"&&this.renderedCallback(),this._fitToScreen(i,r,n,a,e),this.visible=!0,this.subscribe("table-destroy",this.destroyBinding),this.element.addEventListener("mousedown",l=>{l.stopPropagation()}),this)}_fitToScreen(t,e,i,r,n){var a=this.container===document.body?document.documentElement.scrollTop:this.container.scrollTop;(t+this.element.offsetWidth>=this.container.offsetWidth||this.reversedX)&&(this.element.style.left="",i?this.element.style.right=this.container.offsetWidth-r.left+"px":this.element.style.right=this.container.offsetWidth-t+"px",this.reversedX=!0);let o=Math.max(this.container.offsetHeight,a?this.container.scrollHeight:0);if(e+this.element.offsetHeight>o)if(i)switch(n){case"bottom":this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight-i.offsetHeight-1+"px";break;default:this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight+i.offsetHeight+1+"px"}else this.element.style.height=o+"px"}isVisible(){return this.visible}hideOnBlur(t){return this.blurable=!0,this.visible&&(setTimeout(()=>{this.visible&&(this.table.rowManager.element.addEventListener("scroll",this.blurEvent),this.subscribe("cell-editing",this.blurEvent),document.body.addEventListener("click",this.blurEvent),document.body.addEventListener("contextmenu",this.blurEvent),document.body.addEventListener("mousedown",this.blurEvent),window.addEventListener("resize",this.blurEvent),document.body.addEventListener("keydown",this.escEvent),this.blurEventsBound=!0)},100),this.blurCallback=t),this}_escapeCheck(t){t.keyCode==27&&this.hide()}blockHide(){this.hideable=!1}restoreHide(){this.hideable=!0}hide(t=!1){return this.visible&&this.hideable&&(this.blurable&&this.blurEventsBound&&(document.body.removeEventListener("keydown",this.escEvent),document.body.removeEventListener("click",this.blurEvent),document.body.removeEventListener("contextmenu",this.blurEvent),document.body.removeEventListener("mousedown",this.blurEvent),window.removeEventListener("resize",this.blurEvent),this.table.rowManager.element.removeEventListener("scroll",this.blurEvent),this.unsubscribe("cell-editing",this.blurEvent),this.blurEventsBound=!1),this.childPopup&&this.childPopup.hide(),this.parent&&(this.parent.childPopup=null),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.visible=!1,this.blurCallback&&!t&&this.blurCallback(),this.unsubscribe("table-destroy",this.destroyBinding)),this}child(t){return this.childPopup&&this.childPopup.hide(),this.childPopup=new Uw(this.table,t,this),this.childPopup}};class pt extends Gi{constructor(t,e){super(t),this._handler=null}initialize(){}registerTableOption(t,e){this.table.optionsList.register(t,e)}registerColumnOption(t,e){this.table.columnManager.optionsList.register(t,e)}registerTableFunction(t,e){typeof this.table[t]>"u"?this.table[t]=(...i)=>(this.table.initGuard(t),e(...i)):console.warn("Unable to bind table function, name already in use",t)}registerComponentFunction(t,e,i){return this.table.componentFunctionBinder.bind(t,e,i)}registerDataHandler(t,e){this.table.rowManager.registerDataPipelineHandler(t,e),this._handler=t}registerDisplayHandler(t,e){this.table.rowManager.registerDisplayPipelineHandler(t,e),this._handler=t}displayRows(t){var e=this.table.rowManager.displayRows.length-1,i;if(this._handler&&(i=this.table.rowManager.displayPipeline.findIndex(r=>r.handler===this._handler),i>-1&&(e=i)),t&&(e=e+t),this._handler)return e>-1?this.table.rowManager.getDisplayRows(e):this.activeRows()}activeRows(){return this.table.rowManager.activeRows}refreshData(t,e){e||(e=this._handler),e&&this.table.rowManager.refreshActiveData(e,!1,t)}footerAppend(t){return this.table.footerManager.append(t)}footerPrepend(t){return this.table.footerManager.prepend(t)}footerRemove(t){return this.table.footerManager.remove(t)}popup(t,e){return new uV(this.table,t,e)}alert(t,e){return this.table.alertManager.alert(t,e)}clearAlert(){return this.table.alertManager.clear()}}var cV={rownum:function(s,t,e,i,r,n){return n.getPosition()}};const ho=class ho extends pt{constructor(t){super(t),this.allowedTypes=["","data","download","clipboard","print","htmlOutput"],this.registerColumnOption("accessor"),this.registerColumnOption("accessorParams"),this.registerColumnOption("accessorData"),this.registerColumnOption("accessorDataParams"),this.registerColumnOption("accessorDownload"),this.registerColumnOption("accessorDownloadParams"),this.registerColumnOption("accessorClipboard"),this.registerColumnOption("accessorClipboardParams"),this.registerColumnOption("accessorPrint"),this.registerColumnOption("accessorPrintParams"),this.registerColumnOption("accessorHtmlOutput"),this.registerColumnOption("accessorHtmlOutputParams")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-retrieve",this.transformRow.bind(this))}initializeColumn(t){var e=!1,i={};this.allowedTypes.forEach(r=>{var n="accessor"+(r.charAt(0).toUpperCase()+r.slice(1)),a;t.definition[n]&&(a=this.lookupAccessor(t.definition[n]),a&&(e=!0,i[n]={accessor:a,params:t.definition[n+"Params"]||{}}))}),e&&(t.modules.accessor=i)}lookupAccessor(t){var e=!1;switch(typeof t){case"string":ho.accessors[t]?e=ho.accessors[t]:console.warn("Accessor Error - No such accessor found, ignoring: ",t);break;case"function":e=t;break}return e}transformRow(t,e){var i="accessor"+(e.charAt(0).toUpperCase()+e.slice(1)),r=t.getComponent(),n=$t.deepClone(t.data||{});return this.table.columnManager.traverse(function(a){var o,l,h,u;a.modules.accessor&&(l=a.modules.accessor[i]||a.modules.accessor.accessor||!1,l&&(o=a.getFieldValue(n),o!="undefined"&&(u=a.getComponent(),h=typeof l.params=="function"?l.params(o,n,e,u,r):l.params,a.setFieldValue(n,l.accessor(o,n,e,h,u,r)))))}),n}};Ne(ho,"moduleName","accessor"),Ne(ho,"accessors",cV);let pp=ho;var fV={method:"GET"};function mp(s,t){var e=[];if(t=t||"",Array.isArray(s))s.forEach((r,n)=>{e=e.concat(mp(r,t?t+"["+n+"]":n))});else if(typeof s=="object")for(var i in s)e=e.concat(mp(s[i],t?t+"["+i+"]":i));else e.push({key:t,value:s});return e}function dV(s){var t=mp(s),e=[];return t.forEach(function(i){e.push(encodeURIComponent(i.key)+"="+encodeURIComponent(i.value))}),e.join("&")}function $w(s,t,e){return s&&e&&Object.keys(e).length&&(!t.method||t.method.toLowerCase()=="get")&&(t.method="get",s+=(s.includes("?")?"&":"?")+dV(e)),s}function pV(s,t,e){var i;return new Promise((r,n)=>{if(s=this.urlGenerator.call(this.table,s,t,e),t.method.toUpperCase()!="GET")if(i=typeof this.table.options.ajaxContentType=="object"?this.table.options.ajaxContentType:this.contentTypeFormatters[this.table.options.ajaxContentType],i){for(var a in i.headers)t.headers||(t.headers={}),typeof t.headers[a]>"u"&&(t.headers[a]=i.headers[a]);t.body=i.body.call(this,s,t,e)}else console.warn("Ajax Error - Invalid ajaxContentType value:",this.table.options.ajaxContentType);s?(typeof t.headers>"u"&&(t.headers={}),typeof t.headers.Accept>"u"&&(t.headers.Accept="application/json"),typeof t.headers["X-Requested-With"]>"u"&&(t.headers["X-Requested-With"]="XMLHttpRequest"),typeof t.mode>"u"&&(t.mode="cors"),t.mode=="cors"?(typeof t.headers.Origin>"u"&&(t.headers.Origin=window.location.origin),typeof t.credentials>"u"&&(t.credentials="same-origin")):typeof t.credentials>"u"&&(t.credentials="include"),fetch(s,t).then(o=>{o.ok?o.json().then(l=>{r(l)}).catch(l=>{n(l),console.warn("Ajax Load Error - Invalid JSON returned",l)}):(console.error("Ajax Load Error - Connection Error: "+o.status,o.statusText),n(o))}).catch(o=>{console.error("Ajax Load Error - Connection Error: ",o),n(o)})):(console.warn("Ajax Load Error - No URL Set"),r([]))})}function vp(s,t){var e=[];if(t=t||"",Array.isArray(s))s.forEach((r,n)=>{e=e.concat(vp(r,t?t+"["+n+"]":n))});else if(typeof s=="object")for(var i in s)e=e.concat(vp(s[i],t?t+"["+i+"]":i));else e.push({key:t,value:s});return e}var mV={json:{headers:{"Content-Type":"application/json"},body:function(s,t,e){return JSON.stringify(e)}},form:{headers:{},body:function(s,t,e){var i=vp(e),r=new FormData;return i.forEach(function(n){r.append(n.key,n.value)}),r}}};const xs=class xs extends pt{constructor(t){super(t),this.config={},this.url="",this.urlGenerator=!1,this.params=!1,this.loaderPromise=!1,this.registerTableOption("ajaxURL",!1),this.registerTableOption("ajaxURLGenerator",!1),this.registerTableOption("ajaxParams",{}),this.registerTableOption("ajaxConfig","get"),this.registerTableOption("ajaxContentType","form"),this.registerTableOption("ajaxRequestFunc",!1),this.registerTableOption("ajaxRequesting",function(){}),this.registerTableOption("ajaxResponse",!1),this.contentTypeFormatters=xs.contentTypeFormatters}initialize(){this.loaderPromise=this.table.options.ajaxRequestFunc||xs.defaultLoaderPromise,this.urlGenerator=this.table.options.ajaxURLGenerator||xs.defaultURLGenerator,this.table.options.ajaxURL&&this.setUrl(this.table.options.ajaxURL),this.setDefaultConfig(this.table.options.ajaxConfig),this.registerTableFunction("getAjaxUrl",this.getUrl.bind(this)),this.subscribe("data-loading",this.requestDataCheck.bind(this)),this.subscribe("data-params",this.requestParams.bind(this)),this.subscribe("data-load",this.requestData.bind(this))}requestParams(t,e,i,r){var n=this.table.options.ajaxParams;return n&&(typeof n=="function"&&(n=n.call(this.table)),r=Object.assign(Object.assign({},n),r)),r}requestDataCheck(t,e,i,r){return!!(!t&&this.url||typeof t=="string")}requestData(t,e,i,r,n){var a;return!n&&this.requestDataCheck(t)?(t&&this.setUrl(t),a=this.generateConfig(i),this.sendRequest(this.url,e,a)):n}setDefaultConfig(t={}){this.config=Object.assign({},xs.defaultConfig),typeof t=="string"?this.config.method=t:Object.assign(this.config,t)}generateConfig(t={}){var e=Object.assign({},this.config);return typeof t=="string"?e.method=t:Object.assign(e,t),e}setUrl(t){this.url=t}getUrl(){return this.url}sendRequest(t,e,i){return this.table.options.ajaxRequesting.call(this.table,t,e)!==!1?this.loaderPromise(t,i,e).then(r=>(this.table.options.ajaxResponse&&(r=this.table.options.ajaxResponse.call(this.table,t,e,r)),r)):Promise.reject()}};Ne(xs,"moduleName","ajax"),Ne(xs,"defaultConfig",fV),Ne(xs,"defaultURLGenerator",$w),Ne(xs,"defaultLoaderPromise",pV),Ne(xs,"contentTypeFormatters",mV);let gp=xs;var vV={replace:function(s){return this.table.setData(s)},update:function(s){return this.table.updateOrAddData(s)},insert:function(s){return this.table.addData(s)}},gV={table:function(s){var t=[],e=!0,i=this.table.columnManager.columns,r=[],n=[];return s=s.split("\n"),s.forEach(function(a){t.push(a.split("	"))}),t.length&&!(t.length===1&&t[0].length<2)?(t[0].forEach(function(a){var o=i.find(function(l){return a&&l.definition.title&&a.trim()&&l.definition.title.trim()===a.trim()});o?r.push(o):e=!1}),e||(e=!0,r=[],t[0].forEach(function(a){var o=i.find(function(l){return a&&l.field&&a.trim()&&l.field.trim()===a.trim()});o?r.push(o):e=!1}),e||(r=this.table.columnManager.columnsByIndex)),e&&t.shift(),t.forEach(function(a){var o={};a.forEach(function(l,h){r[h]&&(o[r[h].field]=l)}),n.push(o)}),n):!1}},bV={copyToClipboard:["ctrl + 67","meta + 67"]},yV={copyToClipboard:function(s){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}},xV={keybindings:{bindings:bV,actions:yV}};const mn=class mn extends pt{constructor(t){super(t),this.mode=!0,this.pasteParser=function(){},this.pasteAction=function(){},this.customSelection=!1,this.rowRange=!1,this.blocked=!0,this.registerTableOption("clipboard",!1),this.registerTableOption("clipboardCopyStyled",!0),this.registerTableOption("clipboardCopyConfig",!1),this.registerTableOption("clipboardCopyFormatter",!1),this.registerTableOption("clipboardCopyRowRange","active"),this.registerTableOption("clipboardPasteParser","table"),this.registerTableOption("clipboardPasteAction","insert"),this.registerColumnOption("clipboard"),this.registerColumnOption("titleClipboard")}initialize(){this.mode=this.table.options.clipboard,this.rowRange=this.table.options.clipboardCopyRowRange,(this.mode===!0||this.mode==="copy")&&this.table.element.addEventListener("copy",t=>{var e,i,r;this.blocked||(t.preventDefault(),this.customSelection?(e=this.customSelection,this.table.options.clipboardCopyFormatter&&(e=this.table.options.clipboardCopyFormatter("plain",e))):(r=this.table.modules.export.generateExportList(this.table.options.clipboardCopyConfig,this.table.options.clipboardCopyStyled,this.rowRange,"clipboard"),i=this.table.modules.export.generateHTMLTable(r),e=i?this.generatePlainContent(r):"",this.table.options.clipboardCopyFormatter&&(e=this.table.options.clipboardCopyFormatter("plain",e),i=this.table.options.clipboardCopyFormatter("html",i))),window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",e):t.clipboardData&&t.clipboardData.setData?(t.clipboardData.setData("text/plain",e),i&&t.clipboardData.setData("text/html",i)):t.originalEvent&&t.originalEvent.clipboardData.setData&&(t.originalEvent.clipboardData.setData("text/plain",e),i&&t.originalEvent.clipboardData.setData("text/html",i)),this.dispatchExternal("clipboardCopied",e,i),this.reset())}),(this.mode===!0||this.mode==="paste")&&this.table.element.addEventListener("paste",t=>{this.paste(t)}),this.setPasteParser(this.table.options.clipboardPasteParser),this.setPasteAction(this.table.options.clipboardPasteAction),this.registerTableFunction("copyToClipboard",this.copy.bind(this))}reset(){this.blocked=!0,this.customSelection=!1}generatePlainContent(t){var e=[];return t.forEach(i=>{var r=[];i.columns.forEach(n=>{var a="";if(n)if(i.type==="group"&&(n.value=n.component.getKey()),n.value===null)a="";else switch(typeof n.value){case"object":a=JSON.stringify(n.value);break;case"undefined":a="";break;default:a=n.value}r.push(a)}),e.push(r.join("	"))}),e.join("\n")}copy(t,e){var i,r;this.blocked=!1,this.customSelection=!1,(this.mode===!0||this.mode==="copy")&&(this.rowRange=t||this.table.options.clipboardCopyRowRange,typeof window.getSelection<"u"&&typeof document.createRange<"u"?(t=document.createRange(),t.selectNodeContents(this.table.element),i=window.getSelection(),i.toString()&&e&&(this.customSelection=i.toString()),i.removeAllRanges(),i.addRange(t)):typeof document.selection<"u"&&typeof document.body.createTextRange<"u"&&(r=document.body.createTextRange(),r.moveToElementText(this.table.element),r.select()),document.execCommand("copy"),i&&i.removeAllRanges())}setPasteAction(t){switch(typeof t){case"string":this.pasteAction=mn.pasteActions[t],this.pasteAction||console.warn("Clipboard Error - No such paste action found:",t);break;case"function":this.pasteAction=t;break}}setPasteParser(t){switch(typeof t){case"string":this.pasteParser=mn.pasteParsers[t],this.pasteParser||console.warn("Clipboard Error - No such paste parser found:",t);break;case"function":this.pasteParser=t;break}}paste(t){var e,i,r;this.checkPasteOrigin(t)&&(e=this.getPasteData(t),i=this.pasteParser.call(this,e),i?(t.preventDefault(),this.table.modExists("mutator")&&(i=this.mutateData(i)),r=this.pasteAction.call(this,i),this.dispatchExternal("clipboardPasted",e,i,r)):this.dispatchExternal("clipboardPasteError",e))}mutateData(t){var e=[];return Array.isArray(t)?t.forEach(i=>{e.push(this.table.modules.mutator.transformRow(i,"clipboard"))}):e=t,e}checkPasteOrigin(t){var e=!0,i=this.confirm("clipboard-paste",[t]);return(i||!["DIV","SPAN"].includes(t.target.tagName))&&(e=!1),e}getPasteData(t){var e;return window.clipboardData&&window.clipboardData.getData?e=window.clipboardData.getData("Text"):t.clipboardData&&t.clipboardData.getData?e=t.clipboardData.getData("text/plain"):t.originalEvent&&t.originalEvent.clipboardData.getData&&(e=t.originalEvent.clipboardData.getData("text/plain")),e}};Ne(mn,"moduleName","clipboard"),Ne(mn,"moduleExtensions",xV),Ne(mn,"pasteActions",vV),Ne(mn,"pasteParsers",gV);let bp=mn;class CV{constructor(t){return this._row=t,new Proxy(this,{get:function(e,i,r){return typeof e[i]<"u"?e[i]:e._row.table.componentFunctionBinder.handle("row",e._row,i)}})}getData(t){return this._row.getData(t)}getElement(){return this._row.getElement()}getTable(){return this._row.table}getCells(){var t=[];return this._row.getCells().forEach(function(e){t.push(e.getComponent())}),t}getCell(t){var e=this._row.getCell(t);return e?e.getComponent():!1}_getSelf(){return this._row}}class qw{constructor(t){return this._cell=t,new Proxy(this,{get:function(e,i,r){return typeof e[i]<"u"?e[i]:e._cell.table.componentFunctionBinder.handle("cell",e._cell,i)}})}getValue(){return this._cell.getValue()}getOldValue(){return this._cell.getOldValue()}getInitialValue(){return this._cell.initialValue}getElement(){return this._cell.getElement()}getRow(){return this._cell.row.getComponent()}getData(t){return this._cell.row.getData(t)}getType(){return"cell"}getField(){return this._cell.column.getField()}getColumn(){return this._cell.column.getComponent()}setValue(t,e){typeof e>"u"&&(e=!0),this._cell.setValue(t,e)}restoreOldValue(){this._cell.setValueActual(this._cell.getOldValue())}restoreInitialValue(){this._cell.setValueActual(this._cell.initialValue)}checkHeight(){this._cell.checkHeight()}getTable(){return this._cell.table}_getSelf(){return this._cell}}class Dh extends Gi{constructor(t,e){super(t.table),this.table=t.table,this.column=t,this.row=e,this.element=null,this.value=null,this.initialValue,this.oldValue=null,this.modules={},this.height=null,this.width=null,this.minWidth=null,this.component=null,this.loaded=!1,this.build()}build(){this.generateElement(),this.setWidth(),this._configureCell(),this.setValueActual(this.column.getFieldValue(this.row.data)),this.initialValue=this.value}generateElement(){this.element=document.createElement("div"),this.element.className="tabulator-cell",this.element.setAttribute("role","gridcell"),this.column.isRowHeader&&this.element.classList.add("tabulator-row-header")}_configureCell(){var t=this.element,e=this.column.getField(),i={top:"flex-start",bottom:"flex-end",middle:"center"},r={left:"flex-start",right:"flex-end",center:"center"};if(t.style.textAlign=this.column.hozAlign,this.column.vertAlign&&(t.style.display="inline-flex",t.style.alignItems=i[this.column.vertAlign]||"",this.column.hozAlign&&(t.style.justifyContent=r[this.column.hozAlign]||"")),e&&t.setAttribute("tabulator-field",e),this.column.definition.cssClass){var n=this.column.definition.cssClass.split(" ");n.forEach(a=>{t.classList.add(a)})}this.dispatch("cell-init",this),this.column.visible||this.hide()}_generateContents(){var t;switch(t=this.chain("cell-format",this,null,()=>this.element.innerHTML=this.value),typeof t){case"object":if(t instanceof Node){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(t)}else this.element.innerHTML="",t!=null&&console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",t);break;case"undefined":this.element.innerHTML="";break;default:this.element.innerHTML=t}}cellRendered(){this.dispatch("cell-rendered",this)}getElement(t){return this.loaded||(this.loaded=!0,t||this.layoutElement()),this.element}getValue(){return this.value}getOldValue(){return this.oldValue}setValue(t,e,i){var r=this.setValueProcessData(t,e,i);r&&(this.dispatch("cell-value-updated",this),this.cellRendered(),this.column.definition.cellEdited&&this.column.definition.cellEdited.call(this.table,this.getComponent()),this.dispatchExternal("cellEdited",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()))}setValueProcessData(t,e,i){var r=!1;return(this.value!==t||i)&&(r=!0,e&&(t=this.chain("cell-value-changing",[this,t],null,t))),this.setValueActual(t),r&&this.dispatch("cell-value-changed",this),r}setValueActual(t){this.oldValue=this.value,this.value=t,this.dispatch("cell-value-save-before",this),this.column.setFieldValue(this.row.data,t),this.dispatch("cell-value-save-after",this),this.loaded&&this.layoutElement()}layoutElement(){this._generateContents(),this.dispatch("cell-layout",this)}setWidth(){this.width=this.column.width,this.element.style.width=this.column.widthStyled}clearWidth(){this.width="",this.element.style.width=""}getWidth(){return this.width||this.element.offsetWidth}setMinWidth(){this.minWidth=this.column.minWidth,this.element.style.minWidth=this.column.minWidthStyled}setMaxWidth(){this.maxWidth=this.column.maxWidth,this.element.style.maxWidth=this.column.maxWidthStyled}checkHeight(){this.row.reinitializeHeight()}clearHeight(){this.element.style.height="",this.height=null,this.dispatch("cell-height",this,"")}setHeight(){this.height=this.row.height,this.element.style.height=this.row.heightStyled,this.dispatch("cell-height",this,this.row.heightStyled)}getHeight(){return this.height||this.element.offsetHeight}show(){this.element.style.display=this.column.vertAlign?"inline-flex":""}hide(){this.element.style.display="none"}delete(){this.dispatch("cell-delete",this),!this.table.rowManager.redrawBlock&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.column.deleteCell(this),this.row.deleteCell(this),this.calcs={}}getIndex(){return this.row.getCellIndex(this)}getComponent(){return this.component||(this.component=new qw(this)),this.component}}class Gw{constructor(t){return this._column=t,this.type="ColumnComponent",new Proxy(this,{get:function(e,i,r){return typeof e[i]<"u"?e[i]:e._column.table.componentFunctionBinder.handle("column",e._column,i)}})}getElement(){return this._column.getElement()}getDefinition(){return this._column.getDefinition()}getField(){return this._column.getField()}getTitleDownload(){return this._column.getTitleDownload()}getCells(){var t=[];return this._column.cells.forEach(function(e){t.push(e.getComponent())}),t}isVisible(){return this._column.visible}show(){this._column.isGroup?this._column.columns.forEach(function(t){t.show()}):this._column.show()}hide(){this._column.isGroup?this._column.columns.forEach(function(t){t.hide()}):this._column.hide()}toggle(){this._column.visible?this.hide():this.show()}delete(){return this._column.delete()}getSubColumns(){var t=[];return this._column.columns.length&&this._column.columns.forEach(function(e){t.push(e.getComponent())}),t}getParentColumn(){return this._column.getParentComponent()}_getSelf(){return this._column}scrollTo(t,e){return this._column.table.columnManager.scrollToColumn(this._column,t,e)}getTable(){return this._column.table}move(t,e){var i=this._column.table.columnManager.findColumn(t);i?this._column.table.columnManager.moveColumn(this._column,i,e):console.warn("Move Error - No matching column found:",i)}getNextColumn(){var t=this._column.nextColumn();return t?t.getComponent():!1}getPrevColumn(){var t=this._column.prevColumn();return t?t.getComponent():!1}updateDefinition(t){return this._column.updateDefinition(t)}getWidth(){return this._column.getWidth()}setWidth(t){var e;return t===!0?e=this._column.reinitializeWidth(!0):e=this._column.setWidth(t),this._column.table.columnManager.rerenderColumns(!0),e}}var Xw={title:void 0,field:void 0,columns:void 0,visible:void 0,hozAlign:void 0,vertAlign:void 0,width:void 0,minWidth:40,maxWidth:void 0,maxInitialWidth:void 0,cssClass:void 0,variableHeight:void 0,headerVertical:void 0,headerHozAlign:void 0,headerWordWrap:!1,editableTitle:void 0};const sa=class sa extends Gi{constructor(t,e,i){super(e.table),this.definition=t,this.parent=e,this.type="column",this.columns=[],this.cells=[],this.isGroup=!1,this.isRowHeader=i,this.element=this.createElement(),this.contentElement=!1,this.titleHolderElement=!1,this.titleElement=!1,this.groupElement=this.createGroupElement(),this.hozAlign="",this.vertAlign="",this.field="",this.fieldStructure="",this.getFieldValue="",this.setFieldValue="",this.titleDownload=null,this.titleFormatterRendered=!1,this.mapDefinitions(),this.setField(this.definition.field),this.modules={},this.width=null,this.widthStyled="",this.maxWidth=null,this.maxWidthStyled="",this.maxInitialWidth=null,this.minWidth=null,this.minWidthStyled="",this.widthFixed=!1,this.visible=!0,this.component=null,this.definition.columns?(this.isGroup=!0,this.definition.columns.forEach((r,n)=>{var a=new sa(r,this);this.attachColumn(a)}),this.checkColumnVisibility()):e.registerColumnField(this),this._initialize()}createElement(){var t=document.createElement("div");switch(t.classList.add("tabulator-col"),t.setAttribute("role","columnheader"),t.setAttribute("aria-sort","none"),this.isRowHeader&&t.classList.add("tabulator-row-header"),this.table.options.columnHeaderVertAlign){case"middle":t.style.justifyContent="center";break;case"bottom":t.style.justifyContent="flex-end";break}return t}createGroupElement(){var t=document.createElement("div");return t.classList.add("tabulator-col-group-cols"),t}mapDefinitions(){var t=this.table.options.columnDefaults;if(t)for(let e in t)typeof this.definition[e]>"u"&&(this.definition[e]=t[e]);this.definition=this.table.columnManager.optionsList.generate(sa.defaultOptionList,this.definition)}checkDefinition(){Object.keys(this.definition).forEach(t=>{sa.defaultOptionList.indexOf(t)===-1&&console.warn("Invalid column definition option in '"+(this.field||this.definition.title)+"' column:",t)})}setField(t){this.field=t,this.fieldStructure=t?this.table.options.nestedFieldSeparator?t.split(this.table.options.nestedFieldSeparator):[t]:[],this.getFieldValue=this.fieldStructure.length>1?this._getNestedData:this._getFlatData,this.setFieldValue=this.fieldStructure.length>1?this._setNestedData:this._setFlatData}registerColumnPosition(t){this.parent.registerColumnPosition(t)}registerColumnField(t){this.parent.registerColumnField(t)}reRegisterPosition(){this.isGroup?this.columns.forEach(function(t){t.reRegisterPosition()}):this.registerColumnPosition(this)}_initialize(){for(var t=this.definition;this.element.firstChild;)this.element.removeChild(this.element.firstChild);t.headerVertical&&(this.element.classList.add("tabulator-col-vertical"),t.headerVertical==="flip"&&this.element.classList.add("tabulator-col-vertical-flip")),this.contentElement=this._buildColumnHeaderContent(),this.element.appendChild(this.contentElement),this.isGroup?this._buildGroupHeader():this._buildColumnHeader(),this.dispatch("column-init",this)}_buildColumnHeader(){var t=this.definition;if(this.dispatch("column-layout",this),typeof t.visible<"u"&&(t.visible?this.show(!0):this.hide(!0)),t.cssClass){var e=t.cssClass.split(" ");e.forEach(i=>{this.element.classList.add(i)})}t.field&&this.element.setAttribute("tabulator-field",t.field),this.setMinWidth(parseInt(t.minWidth)),t.maxInitialWidth&&(this.maxInitialWidth=parseInt(t.maxInitialWidth)),t.maxWidth&&this.setMaxWidth(parseInt(t.maxWidth)),this.reinitializeWidth(),this.hozAlign=this.definition.hozAlign,this.vertAlign=this.definition.vertAlign,this.titleElement.style.textAlign=this.definition.headerHozAlign}_buildColumnHeaderContent(){var t=document.createElement("div");return t.classList.add("tabulator-col-content"),this.titleHolderElement=document.createElement("div"),this.titleHolderElement.classList.add("tabulator-col-title-holder"),t.appendChild(this.titleHolderElement),this.titleElement=this._buildColumnHeaderTitle(),this.titleHolderElement.appendChild(this.titleElement),t}_buildColumnHeaderTitle(){var t=this.definition,e=document.createElement("div");if(e.classList.add("tabulator-col-title"),t.headerWordWrap&&e.classList.add("tabulator-col-title-wrap"),t.editableTitle){var i=document.createElement("input");i.classList.add("tabulator-title-editor"),i.addEventListener("click",r=>{r.stopPropagation(),i.focus()}),i.addEventListener("mousedown",r=>{r.stopPropagation()}),i.addEventListener("change",()=>{t.title=i.value,this.dispatchExternal("columnTitleChanged",this.getComponent())}),e.appendChild(i),t.field?this.langBind("columns|"+t.field,r=>{i.value=r||t.title||"&nbsp;"}):i.value=t.title||"&nbsp;"}else t.field?this.langBind("columns|"+t.field,r=>{this._formatColumnHeaderTitle(e,r||t.title||"&nbsp;")}):this._formatColumnHeaderTitle(e,t.title||"&nbsp;");return e}_formatColumnHeaderTitle(t,e){var i=this.chain("column-format",[this,e,t],null,()=>e);switch(typeof i){case"object":i instanceof Node?t.appendChild(i):(t.innerHTML="",console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",i));break;case"undefined":t.innerHTML="";break;default:t.innerHTML=i}}_buildGroupHeader(){if(this.element.classList.add("tabulator-col-group"),this.element.setAttribute("role","columngroup"),this.element.setAttribute("aria-title",this.definition.title),this.definition.cssClass){var t=this.definition.cssClass.split(" ");t.forEach(e=>{this.element.classList.add(e)})}this.titleElement.style.textAlign=this.definition.headerHozAlign,this.element.appendChild(this.groupElement)}_getFlatData(t){return t[this.field]}_getNestedData(t){var e=t,i=this.fieldStructure,r=i.length,n;for(let a=0;a<r&&(e=e[i[a]],n=e,!!e);a++);return n}_setFlatData(t,e){this.field&&(t[this.field]=e)}_setNestedData(t,e){var i=t,r=this.fieldStructure,n=r.length;for(let a=0;a<n;a++)if(a==n-1)i[r[a]]=e;else{if(!i[r[a]])if(typeof e<"u")i[r[a]]={};else break;i=i[r[a]]}}attachColumn(t){this.groupElement?(this.columns.push(t),this.groupElement.appendChild(t.getElement()),t.columnRendered()):console.warn("Column Warning - Column being attached to another column instead of column group")}verticalAlign(t,e){var i=this.parent.isGroup?this.parent.getGroupElement().clientHeight:e||this.parent.getHeadersElement().clientHeight;this.element.style.height=i+"px",this.dispatch("column-height",this,this.element.style.height),this.isGroup&&(this.groupElement.style.minHeight=i-this.contentElement.offsetHeight+"px"),this.columns.forEach(function(r){r.verticalAlign(t)})}clearVerticalAlign(){this.element.style.paddingTop="",this.element.style.height="",this.element.style.minHeight="",this.groupElement.style.minHeight="",this.columns.forEach(function(t){t.clearVerticalAlign()}),this.dispatch("column-height",this,"")}getElement(){return this.element}getGroupElement(){return this.groupElement}getField(){return this.field}getTitleDownload(){return this.titleDownload}getFirstColumn(){return this.isGroup?this.columns.length?this.columns[0].getFirstColumn():!1:this}getLastColumn(){return this.isGroup?this.columns.length?this.columns[this.columns.length-1].getLastColumn():!1:this}getColumns(t){var e=[];return t?this.columns.forEach(i=>{e.push(i),e=e.concat(i.getColumns(!0))}):e=this.columns,e}getCells(){return this.cells}getTopColumn(){return this.parent.isGroup?this.parent.getTopColumn():this}getDefinition(t){var e=[];return this.isGroup&&t&&(this.columns.forEach(function(i){e.push(i.getDefinition(!0))}),this.definition.columns=e),this.definition}checkColumnVisibility(){var t=!1;this.columns.forEach(function(e){e.visible&&(t=!0)}),t?(this.show(),this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1)):this.hide()}show(t,e){this.visible||(this.visible=!0,this.element.style.display="",this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(i){i.show()}),!this.isGroup&&this.width===null&&this.reinitializeWidth(),this.table.columnManager.verticalAlignHeaders(),this.dispatch("column-show",this,e),t||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!0),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}hide(t,e){this.visible&&(this.visible=!1,this.element.style.display="none",this.table.columnManager.verticalAlignHeaders(),this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(i){i.hide()}),this.dispatch("column-hide",this,e),t||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}matchChildWidths(){var t=0;this.contentElement&&this.columns.length&&(this.columns.forEach(function(e){e.visible&&(t+=e.getWidth())}),this.contentElement.style.maxWidth=t-1+"px",this.table.initialized&&(this.element.style.width=t+"px"),this.parent.isGroup&&this.parent.matchChildWidths())}removeChild(t){var e=this.columns.indexOf(t);e>-1&&this.columns.splice(e,1),this.columns.length||this.delete()}setWidth(t){this.widthFixed=!0,this.setWidthActual(t)}setWidthActual(t){isNaN(t)&&(t=Math.floor(this.table.element.clientWidth/100*parseInt(t))),t=Math.max(this.minWidth,t),this.maxWidth&&(t=Math.min(this.maxWidth,t)),this.width=t,this.widthStyled=t?t+"px":"",this.element.style.width=this.widthStyled,this.isGroup||this.cells.forEach(function(e){e.setWidth()}),this.parent.isGroup&&this.parent.matchChildWidths(),this.dispatch("column-width",this),this.subscribedExternal("columnWidth")&&this.dispatchExternal("columnWidth",this.getComponent())}checkCellHeights(){var t=[];this.cells.forEach(function(e){e.row.heightInitialized&&(e.row.getElement().offsetParent!==null?(t.push(e.row),e.row.clearCellHeight()):e.row.heightInitialized=!1)}),t.forEach(function(e){e.calcHeight()}),t.forEach(function(e){e.setCellHeight()})}getWidth(){var t=0;return this.isGroup?this.columns.forEach(function(e){e.visible&&(t+=e.getWidth())}):t=this.width,t}getLeftOffset(){var t=this.element.offsetLeft;return this.parent.isGroup&&(t+=this.parent.getLeftOffset()),t}getHeight(){return Math.ceil(this.element.getBoundingClientRect().height)}setMinWidth(t){this.maxWidth&&t>this.maxWidth&&(t=this.maxWidth,console.warn("the minWidth ("+t+"px) for column '"+this.field+"' cannot be bigger that its maxWidth ("+this.maxWidthStyled+")")),this.minWidth=t,this.minWidthStyled=t?t+"px":"",this.element.style.minWidth=this.minWidthStyled,this.cells.forEach(function(e){e.setMinWidth()})}setMaxWidth(t){this.minWidth&&t<this.minWidth&&(t=this.minWidth,console.warn("the maxWidth ("+t+"px) for column '"+this.field+"' cannot be smaller that its minWidth ("+this.minWidthStyled+")")),this.maxWidth=t,this.maxWidthStyled=t?t+"px":"",this.element.style.maxWidth=this.maxWidthStyled,this.cells.forEach(function(e){e.setMaxWidth()})}delete(){return new Promise((t,e)=>{this.isGroup&&this.columns.forEach(function(r){r.delete()}),this.dispatch("column-delete",this);var i=this.cells.length;for(let r=0;r<i;r++)this.cells[0].delete();this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.contentElement=!1,this.titleElement=!1,this.groupElement=!1,this.parent.isGroup&&this.parent.removeChild(this),this.table.columnManager.deregisterColumn(this),this.table.columnManager.rerenderColumns(!0),this.dispatch("column-deleted",this),t()})}columnRendered(){this.titleFormatterRendered&&this.titleFormatterRendered(),this.dispatch("column-rendered",this)}generateCell(t){var e=new Dh(this,t);return this.cells.push(e),e}nextColumn(){var t=this.table.columnManager.findColumnIndex(this);return t>-1?this._nextVisibleColumn(t+1):!1}_nextVisibleColumn(t){var e=this.table.columnManager.getColumnByIndex(t);return!e||e.visible?e:this._nextVisibleColumn(t+1)}prevColumn(){var t=this.table.columnManager.findColumnIndex(this);return t>-1?this._prevVisibleColumn(t-1):!1}_prevVisibleColumn(t){var e=this.table.columnManager.getColumnByIndex(t);return!e||e.visible?e:this._prevVisibleColumn(t-1)}reinitializeWidth(t){this.widthFixed=!1,typeof this.definition.width<"u"&&!t&&this.setWidth(this.definition.width),this.dispatch("column-width-fit-before",this),this.fitToData(t),this.dispatch("column-width-fit-after",this)}fitToData(t){if(!this.isGroup){this.widthFixed||(this.element.style.width="",this.cells.forEach(r=>{r.clearWidth()}));var e=this.element.offsetWidth;if((!this.width||!this.widthFixed)&&(this.cells.forEach(r=>{var n=r.getWidth();n>e&&(e=n)}),e)){var i=e+1;this.maxInitialWidth&&!t&&(i=Math.min(i,this.maxInitialWidth)),this.setWidthActual(i)}}}updateDefinition(t){var e;return this.isGroup||this.parent.isGroup?(console.error("Column Update Error - The updateDefinition function is only available on ungrouped columns"),Promise.reject("Column Update Error - The updateDefinition function is only available on columns, not column groups")):(e=Object.assign({},this.getDefinition()),e=Object.assign(e,t),this.table.columnManager.addColumn(e,!1,this).then(i=>(e.field==this.field&&(this.field=!1),this.delete().then(()=>i.getComponent()))))}deleteCell(t){var e=this.cells.indexOf(t);e>-1&&this.cells.splice(e,1)}getComponent(){return this.component||(this.component=new Gw(this)),this.component}getPosition(){return this.table.columnManager.getVisibleColumnsByIndex().indexOf(this)+1}getParentComponent(){return this.parent instanceof sa?this.parent.getComponent():!1}};Ne(sa,"defaultOptionList",Xw);let pa=sa;class Zc{constructor(t){return this._row=t,new Proxy(this,{get:function(e,i,r){return typeof e[i]<"u"?e[i]:e._row.table.componentFunctionBinder.handle("row",e._row,i)}})}getData(t){return this._row.getData(t)}getElement(){return this._row.getElement()}getCells(){var t=[];return this._row.getCells().forEach(function(e){t.push(e.getComponent())}),t}getCell(t){var e=this._row.getCell(t);return e?e.getComponent():!1}getIndex(){return this._row.getData("data")[this._row.table.options.index]}getPosition(){return this._row.getPosition()}watchPosition(t){return this._row.watchPosition(t)}delete(){return this._row.delete()}scrollTo(t,e){return this._row.table.rowManager.scrollToRow(this._row,t,e)}move(t,e){this._row.moveToRow(t,e)}update(t){return this._row.updateData(t)}normalizeHeight(){this._row.normalizeHeight(!0)}_getSelf(){return this._row}reformat(){return this._row.reinitialize()}getTable(){return this._row.table}getNextRow(){var t=this._row.nextRow();return t&&t.getComponent()}getPrevRow(){var t=this._row.prevRow();return t&&t.getComponent()}}class pr extends Gi{constructor(t,e,i="row"){super(e.table),this.parent=e,this.data={},this.type=i,this.element=!1,this.modules={},this.cells=[],this.height=0,this.heightStyled="",this.manualHeight=!1,this.outerHeight=0,this.initialized=!1,this.heightInitialized=!1,this.position=0,this.positionWatchers=[],this.component=null,this.created=!1,this.setData(t)}create(){this.created||(this.created=!0,this.generateElement())}createElement(){var t=document.createElement("div");t.classList.add("tabulator-row"),t.setAttribute("role","row"),this.element=t}getElement(){return this.create(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}generateElement(){this.createElement(),this.dispatch("row-init",this)}generateCells(){this.cells=this.table.columnManager.generateCells(this)}initialize(t,e){if(this.create(),!this.initialized||t){for(this.deleteCells();this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.dispatch("row-layout-before",this),this.generateCells(),this.initialized=!0,this.table.columnManager.renderer.renderRowCells(this,e),t&&this.normalizeHeight(),this.dispatch("row-layout",this),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent()),this.dispatch("row-layout-after",this)}else this.table.columnManager.renderer.rerenderRowCells(this,e)}rendered(){this.cells.forEach(t=>{t.cellRendered()})}reinitializeHeight(){this.heightInitialized=!1,this.element&&this.element.offsetParent!==null&&this.normalizeHeight(!0)}deinitialize(){this.initialized=!1}deinitializeHeight(){this.heightInitialized=!1}reinitialize(t){this.initialized=!1,this.heightInitialized=!1,this.manualHeight||(this.height=0,this.heightStyled=""),this.element&&this.element.offsetParent!==null&&this.initialize(!0),this.dispatch("row-relayout",this)}calcHeight(t){var e=0,i=0;this.table.options.rowHeight?this.height=this.table.options.rowHeight:(i=this.calcMinHeight(),e=this.calcMaxHeight(),t?this.height=Math.max(e,i):this.height=this.manualHeight?this.height:Math.max(e,i)),this.heightStyled=this.height?this.height+"px":"",this.outerHeight=this.element.offsetHeight}calcMinHeight(){return this.table.options.resizableRows?this.element.clientHeight:0}calcMaxHeight(){var t=0;return this.cells.forEach(function(e){var i=e.getHeight();i>t&&(t=i)}),t}setCellHeight(){this.cells.forEach(function(t){t.setHeight()}),this.heightInitialized=!0}clearCellHeight(){this.cells.forEach(function(t){t.clearHeight()})}normalizeHeight(t){t&&!this.table.options.rowHeight&&this.clearCellHeight(),this.calcHeight(t),this.setCellHeight()}setHeight(t,e){(this.height!=t||e)&&(this.manualHeight=!0,this.height=t,this.heightStyled=t?t+"px":"",this.setCellHeight(),this.outerHeight=this.element.offsetHeight,this.subscribedExternal("rowHeight")&&this.dispatchExternal("rowHeight",this.getComponent()))}getHeight(){return this.outerHeight}getWidth(){return this.element.offsetWidth}deleteCell(t){var e=this.cells.indexOf(t);e>-1&&this.cells.splice(e,1)}setData(t){this.data=this.chain("row-data-init-before",[this,t],void 0,t),this.dispatch("row-data-init-after",this)}updateData(t){var e=this.element&&$t.elVisible(this.element),i={},r;return new Promise((n,a)=>{typeof t=="string"&&(t=JSON.parse(t)),this.dispatch("row-data-save-before",this),this.subscribed("row-data-changing")&&(i=Object.assign(i,this.data),i=Object.assign(i,t)),r=this.chain("row-data-changing",[this,i,t],null,t);for(let o in r)this.data[o]=r[o];this.dispatch("row-data-save-after",this);for(let o in t)this.table.columnManager.getColumnsByFieldRoot(o).forEach(h=>{let u=this.getCell(h.getField());if(u){let c=h.getFieldValue(r);u.getValue()!==c&&(u.setValueProcessData(c),e&&u.cellRendered())}});e?(this.normalizeHeight(!0),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent())):(this.initialized=!1,this.height=0,this.heightStyled=""),this.dispatch("row-data-changed",this,e,t),this.dispatchExternal("rowUpdated",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),n()})}getData(t){return t?this.chain("row-data-retrieve",[this,t],null,this.data):this.data}getCell(t){var e=!1;return t=this.table.columnManager.findColumn(t),!this.initialized&&this.cells.length===0&&this.generateCells(),e=this.cells.find(function(i){return i.column===t}),e}getCellIndex(t){return this.cells.findIndex(function(e){return e===t})}findCell(t){return this.cells.find(e=>e.element===t)}getCells(){return!this.initialized&&this.cells.length===0&&this.generateCells(),this.cells}nextRow(){var t=this.table.rowManager.nextDisplayRow(this,!0);return t||!1}prevRow(){var t=this.table.rowManager.prevDisplayRow(this,!0);return t||!1}moveToRow(t,e){var i=this.table.rowManager.findRow(t);i?(this.table.rowManager.moveRowActual(this,i,!e),this.table.rowManager.refreshActiveData("display",!1,!0)):console.warn("Move Error - No matching row found:",t)}delete(){return this.dispatch("row-delete",this),this.deleteActual(),Promise.resolve()}deleteActual(t){this.detachModules(),this.table.rowManager.deleteRow(this,t),this.deleteCells(),this.initialized=!1,this.heightInitialized=!1,this.element=!1,this.dispatch("row-deleted",this)}detachModules(){this.dispatch("row-deleting",this)}deleteCells(){var t=this.cells.length;for(let e=0;e<t;e++)this.cells[0].delete()}wipe(){if(this.detachModules(),this.deleteCells(),this.element){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.parentNode&&this.element.parentNode.removeChild(this.element)}this.element=!1,this.modules={}}isDisplayed(){return this.table.rowManager.getDisplayRows().includes(this)}getPosition(){return this.isDisplayed()?this.position:!1}setPosition(t){t!=this.position&&(this.position=t,this.positionWatchers.forEach(e=>{e(this.position)}))}watchPosition(t){this.positionWatchers.push(t),t(this.position)}getGroup(){return this.modules.group||!1}getComponent(){return this.component||(this.component=new Zc(this)),this.component}}var wV={avg:function(s,t,e){var i=0,r=typeof e.precision<"u"?e.precision:2;return s.length&&(i=s.reduce(function(n,a){return Number(n)+Number(a)}),i=i/s.length,i=r!==!1?i.toFixed(r):i),parseFloat(i).toString()},max:function(s,t,e){var i=null,r=typeof e.precision<"u"?e.precision:!1;return s.forEach(function(n){n=Number(n),(n>i||i===null)&&(i=n)}),i!==null?r!==!1?i.toFixed(r):i:""},min:function(s,t,e){var i=null,r=typeof e.precision<"u"?e.precision:!1;return s.forEach(function(n){n=Number(n),(n<i||i===null)&&(i=n)}),i!==null?r!==!1?i.toFixed(r):i:""},sum:function(s,t,e){var i=0,r=typeof e.precision<"u"?e.precision:!1;return s.length&&s.forEach(function(n){n=Number(n),i+=isNaN(n)?0:Number(n)}),r!==!1?i.toFixed(r):i},concat:function(s,t,e){var i=0;return s.length&&(i=s.reduce(function(r,n){return String(r)+String(n)})),i},count:function(s,t,e){var i=0;return s.length&&s.forEach(function(r){r&&i++}),i},unique:function(s,t,e){var i=s.filter((r,n)=>(s||r===0)&&s.indexOf(r)===n);return i.length}};const vn=class vn extends pt{constructor(t){super(t),this.topCalcs=[],this.botCalcs=[],this.genColumn=!1,this.topElement=this.createElement(),this.botElement=this.createElement(),this.topRow=!1,this.botRow=!1,this.topInitialized=!1,this.botInitialized=!1,this.blocked=!1,this.recalcAfterBlock=!1,this.registerTableOption("columnCalcs",!0),this.registerColumnOption("topCalc"),this.registerColumnOption("topCalcParams"),this.registerColumnOption("topCalcFormatter"),this.registerColumnOption("topCalcFormatterParams"),this.registerColumnOption("bottomCalc"),this.registerColumnOption("bottomCalcParams"),this.registerColumnOption("bottomCalcFormatter"),this.registerColumnOption("bottomCalcFormatterParams")}createElement(){var t=document.createElement("div");return t.classList.add("tabulator-calcs-holder"),t}initialize(){this.genColumn=new pa({field:"value"},this),this.subscribe("cell-value-changed",this.cellValueChanged.bind(this)),this.subscribe("column-init",this.initializeColumnCheck.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("column-moved",this.recalcActiveRows.bind(this)),this.subscribe("column-add",this.recalcActiveRows.bind(this)),this.subscribe("data-refreshed",this.recalcActiveRowsRefresh.bind(this)),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this)),this.subscribe("redraw-blocked",this.blockRedraw.bind(this)),this.subscribe("redraw-restored",this.restoreRedraw.bind(this)),this.subscribe("table-redrawing",this.resizeHolderWidth.bind(this)),this.subscribe("column-resized",this.resizeHolderWidth.bind(this)),this.subscribe("column-show",this.resizeHolderWidth.bind(this)),this.subscribe("column-hide",this.resizeHolderWidth.bind(this)),this.registerTableFunction("getCalcResults",this.getResults.bind(this)),this.registerTableFunction("recalc",this.userRecalc.bind(this)),this.resizeHolderWidth()}resizeHolderWidth(){this.topElement.style.minWidth=this.table.columnManager.headersElement.offsetWidth+"px"}tableRedraw(t){this.recalc(this.table.rowManager.activeRows),t&&this.redraw()}blockRedraw(){this.blocked=!0,this.recalcAfterBlock=!1}restoreRedraw(){this.blocked=!1,this.recalcAfterBlock&&(this.recalcAfterBlock=!1,this.recalcActiveRowsRefresh())}userRecalc(){this.recalc(this.table.rowManager.activeRows)}blockCheck(){return this.blocked&&(this.recalcAfterBlock=!0),this.blocked}visibleRows(t,e){return this.topRow&&e.unshift(this.topRow),this.botRow&&e.push(this.botRow),e}rowsUpdated(t){this.table.options.groupBy?this.recalcRowGroup(t):this.recalcActiveRows()}recalcActiveRowsRefresh(){this.table.options.groupBy&&this.table.options.dataTreeStartExpanded&&this.table.options.dataTree?this.recalcAll():this.recalcActiveRows()}recalcActiveRows(){this.recalc(this.table.rowManager.activeRows)}cellValueChanged(t){(t.column.definition.topCalc||t.column.definition.bottomCalc)&&(this.table.options.groupBy?((this.table.options.columnCalcs=="table"||this.table.options.columnCalcs=="both")&&this.recalcActiveRows(),this.table.options.columnCalcs!="table"&&this.recalcRowGroup(t.row)):this.recalcActiveRows())}initializeColumnCheck(t){(t.definition.topCalc||t.definition.bottomCalc)&&this.initializeColumn(t)}initializeColumn(t){var e=t.definition,i={topCalcParams:e.topCalcParams||{},botCalcParams:e.bottomCalcParams||{}};if(e.topCalc){switch(typeof e.topCalc){case"string":vn.calculations[e.topCalc]?i.topCalc=vn.calculations[e.topCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",e.topCalc);break;case"function":i.topCalc=e.topCalc;break}i.topCalc&&(t.modules.columnCalcs=i,this.topCalcs.push(t),this.table.options.columnCalcs!="group"&&this.initializeTopRow())}if(e.bottomCalc){switch(typeof e.bottomCalc){case"string":vn.calculations[e.bottomCalc]?i.botCalc=vn.calculations[e.bottomCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",e.bottomCalc);break;case"function":i.botCalc=e.bottomCalc;break}i.botCalc&&(t.modules.columnCalcs=i,this.botCalcs.push(t),this.table.options.columnCalcs!="group"&&this.initializeBottomRow())}}registerColumnField(){}removeCalcs(){var t=!1;this.topInitialized&&(this.topInitialized=!1,this.topElement.parentNode.removeChild(this.topElement),t=!0),this.botInitialized&&(this.botInitialized=!1,this.footerRemove(this.botElement),t=!0),t&&this.table.rowManager.adjustTableSize()}reinitializeCalcs(){this.topCalcs.length&&this.initializeTopRow(),this.botCalcs.length&&this.initializeBottomRow()}initializeTopRow(){var t=document.createDocumentFragment();this.topInitialized||(t.appendChild(document.createElement("br")),t.appendChild(this.topElement),this.table.columnManager.getContentsElement().insertBefore(t,this.table.columnManager.headersElement.nextSibling),this.topInitialized=!0)}initializeBottomRow(){this.botInitialized||(this.footerPrepend(this.botElement),this.botInitialized=!0)}scrollHorizontal(t){this.botInitialized&&this.botRow&&(this.botElement.scrollLeft=t)}recalc(t){var e,i;if(!this.blockCheck()&&(this.topInitialized||this.botInitialized)){if(e=this.rowsToData(t),this.topInitialized){for(this.topRow&&this.topRow.deleteCells(),i=this.generateRow("top",e),this.topRow=i;this.topElement.firstChild;)this.topElement.removeChild(this.topElement.firstChild);this.topElement.appendChild(i.getElement()),i.initialize(!0)}if(this.botInitialized){for(this.botRow&&this.botRow.deleteCells(),i=this.generateRow("bottom",e),this.botRow=i;this.botElement.firstChild;)this.botElement.removeChild(this.botElement.firstChild);this.botElement.appendChild(i.getElement()),i.initialize(!0)}this.table.rowManager.adjustTableSize(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()}}recalcRowGroup(t){this.recalcGroup(this.table.modules.groupRows.getRowGroup(t))}recalcAll(){if((this.topCalcs.length||this.botCalcs.length)&&(this.table.options.columnCalcs!=="group"&&this.recalcActiveRows(),this.table.options.groupBy&&this.table.options.columnCalcs!=="table")){var t=this.table.modules.groupRows.getChildGroups();t.forEach(e=>{this.recalcGroup(e)})}}recalcGroup(t){var e,i;this.blockCheck()||t&&t.calcs&&(t.calcs.bottom&&(e=this.rowsToData(t.rows),i=this.generateRowData("bottom",e),t.calcs.bottom.updateData(i),t.calcs.bottom.reinitialize()),t.calcs.top&&(e=this.rowsToData(t.rows),i=this.generateRowData("top",e),t.calcs.top.updateData(i),t.calcs.top.reinitialize()))}generateTopRow(t){return this.generateRow("top",this.rowsToData(t))}generateBottomRow(t){return this.generateRow("bottom",this.rowsToData(t))}rowsToData(t){var e=[],i=this.table.options.dataTree&&this.table.options.dataTreeChildColumnCalcs,r=this.table.modules.dataTree;return t.forEach(n=>{var a;e.push(n.getData()),i&&((a=n.modules.dataTree)!=null&&a.open)&&this.rowsToData(r.getFilteredTreeChildren(n)).forEach(o=>{e.push(n)})}),e}generateRow(t,e){var i=this.generateRowData(t,e),r;return this.table.modExists("mutator")&&this.table.modules.mutator.disable(),r=new pr(i,this,"calc"),this.table.modExists("mutator")&&this.table.modules.mutator.enable(),r.getElement().classList.add("tabulator-calcs","tabulator-calcs-"+t),r.component=!1,r.getComponent=()=>(r.component||(r.component=new CV(r)),r.component),r.generateCells=()=>{var n=[];this.table.columnManager.columnsByIndex.forEach(a=>{this.genColumn.setField(a.getField()),this.genColumn.hozAlign=a.hozAlign,a.definition[t+"CalcFormatter"]&&this.table.modExists("format")?this.genColumn.modules.format={formatter:this.table.modules.format.lookupFormatter(a.definition[t+"CalcFormatter"]),params:a.definition[t+"CalcFormatterParams"]||{}}:this.genColumn.modules.format={formatter:this.table.modules.format.lookupFormatter("plaintext"),params:{}},this.genColumn.definition.cssClass=a.definition.cssClass;var o=new Dh(this.genColumn,r);o.getElement(),o.column=a,o.setWidth(),a.cells.push(o),n.push(o),a.visible||o.hide()}),r.cells=n},r}generateRowData(t,e){var i={},r=t=="top"?this.topCalcs:this.botCalcs,n=t=="top"?"topCalc":"botCalc",a,o;return r.forEach(function(l){var h=[];l.modules.columnCalcs&&l.modules.columnCalcs[n]&&(e.forEach(function(u){h.push(l.getFieldValue(u))}),o=n+"Params",a=typeof l.modules.columnCalcs[o]=="function"?l.modules.columnCalcs[o](h,e):l.modules.columnCalcs[o],l.setFieldValue(i,l.modules.columnCalcs[n](h,e,a)))}),i}hasTopCalcs(){return!!this.topCalcs.length}hasBottomCalcs(){return!!this.botCalcs.length}redraw(){this.topRow&&this.topRow.normalizeHeight(!0),this.botRow&&this.botRow.normalizeHeight(!0)}getResults(){var t={},e;return this.table.options.groupBy&&this.table.modExists("groupRows")?(e=this.table.modules.groupRows.getGroups(!0),e.forEach(i=>{t[i.getKey()]=this.getGroupResults(i)})):t={top:this.topRow?this.topRow.getData():{},bottom:this.botRow?this.botRow.getData():{}},t}getGroupResults(t){var e=t._getSelf(),i=t.getSubGroups(),r={},n={};return i.forEach(a=>{r[a.getKey()]=this.getGroupResults(a)}),n={top:e.calcs.top?e.calcs.top.getData():{},bottom:e.calcs.bottom?e.calcs.bottom.getData():{},groups:r},n}adjustForScrollbar(t){this.botRow&&(this.table.rtl?this.botElement.style.paddingLeft=t+"px":this.botElement.style.paddingRight=t+"px")}};Ne(vn,"moduleName","columnCalcs"),Ne(vn,"calculations",wV);let yp=vn;class Kw extends pt{constructor(t){super(t),this.indent=10,this.field="",this.collapseEl=null,this.expandEl=null,this.branchEl=null,this.elementField=!1,this.startOpen=function(){},this.registerTableOption("dataTree",!1),this.registerTableOption("dataTreeFilter",!0),this.registerTableOption("dataTreeSort",!0),this.registerTableOption("dataTreeElementColumn",!1),this.registerTableOption("dataTreeBranchElement",!0),this.registerTableOption("dataTreeChildIndent",9),this.registerTableOption("dataTreeChildField","_children"),this.registerTableOption("dataTreeCollapseElement",!1),this.registerTableOption("dataTreeExpandElement",!1),this.registerTableOption("dataTreeStartExpanded",!1),this.registerTableOption("dataTreeChildColumnCalcs",!1),this.registerTableOption("dataTreeSelectPropagate",!1),this.registerComponentFunction("row","treeCollapse",this.collapseRow.bind(this)),this.registerComponentFunction("row","treeExpand",this.expandRow.bind(this)),this.registerComponentFunction("row","treeToggle",this.toggleRow.bind(this)),this.registerComponentFunction("row","getTreeParent",this.getTreeParent.bind(this)),this.registerComponentFunction("row","getTreeChildren",this.getRowChildren.bind(this)),this.registerComponentFunction("row","addTreeChild",this.addTreeChildRow.bind(this)),this.registerComponentFunction("row","isTreeExpanded",this.isRowExpanded.bind(this))}initialize(){if(this.table.options.dataTree){var t=null,e=this.table.options;switch(this.field=e.dataTreeChildField,this.indent=e.dataTreeChildIndent,this.options("movableRows")&&console.warn("The movableRows option is not available with dataTree enabled, moving of child rows could result in unpredictable behavior"),e.dataTreeBranchElement?e.dataTreeBranchElement===!0?(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch")):typeof e.dataTreeBranchElement=="string"?(t=document.createElement("div"),t.innerHTML=e.dataTreeBranchElement,this.branchEl=t.firstChild):this.branchEl=e.dataTreeBranchElement:(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch-empty")),e.dataTreeCollapseElement?typeof e.dataTreeCollapseElement=="string"?(t=document.createElement("div"),t.innerHTML=e.dataTreeCollapseElement,this.collapseEl=t.firstChild):this.collapseEl=e.dataTreeCollapseElement:(this.collapseEl=document.createElement("div"),this.collapseEl.classList.add("tabulator-data-tree-control"),this.collapseEl.tabIndex=0,this.collapseEl.innerHTML="<div class='tabulator-data-tree-control-collapse'></div>"),e.dataTreeExpandElement?typeof e.dataTreeExpandElement=="string"?(t=document.createElement("div"),t.innerHTML=e.dataTreeExpandElement,this.expandEl=t.firstChild):this.expandEl=e.dataTreeExpandElement:(this.expandEl=document.createElement("div"),this.expandEl.classList.add("tabulator-data-tree-control"),this.expandEl.tabIndex=0,this.expandEl.innerHTML="<div class='tabulator-data-tree-control-expand'></div>"),typeof e.dataTreeStartExpanded){case"boolean":this.startOpen=function(i,r){return e.dataTreeStartExpanded};break;case"function":this.startOpen=e.dataTreeStartExpanded;break;default:this.startOpen=function(i,r){return e.dataTreeStartExpanded[r]};break}this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("row-deleted",this.rowDelete.bind(this),0),this.subscribe("row-data-changed",this.rowDataChanged.bind(this),10),this.subscribe("cell-value-updated",this.cellValueChanged.bind(this)),this.subscribe("edit-cancelled",this.cellValueChanged.bind(this)),this.subscribe("column-moving-rows",this.columnMoving.bind(this)),this.subscribe("table-built",this.initializeElementField.bind(this)),this.subscribe("table-redrawing",this.tableRedrawing.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),30)}}tableRedrawing(t){var e;t&&(e=this.table.rowManager.getRows(),e.forEach(i=>{this.reinitializeRowChildren(i)}))}initializeElementField(){var t=this.table.columnManager.getFirstVisibleColumn();this.elementField=this.table.options.dataTreeElementColumn||(t?t.field:!1)}getRowChildren(t){return this.getTreeChildren(t,!0)}columnMoving(){var t=[];return this.table.rowManager.rows.forEach(e=>{t=t.concat(this.getTreeChildren(e,!1,!0))}),t}rowDataChanged(t,e,i){this.redrawNeeded(i)&&(this.initializeRow(t),e&&(this.layoutRow(t),this.refreshData(!0)))}cellValueChanged(t){var e=t.column.getField();e===this.elementField&&this.layoutRow(t.row)}initializeRow(t){var e=t.getData()[this.field],i=Array.isArray(e),r=i||!i&&typeof e=="object"&&e!==null;!r&&t.modules.dataTree&&t.modules.dataTree.branchEl&&t.modules.dataTree.branchEl.parentNode.removeChild(t.modules.dataTree.branchEl),!r&&t.modules.dataTree&&t.modules.dataTree.controlEl&&t.modules.dataTree.controlEl.parentNode.removeChild(t.modules.dataTree.controlEl),t.modules.dataTree={index:t.modules.dataTree?t.modules.dataTree.index:0,open:r?t.modules.dataTree?t.modules.dataTree.open:this.startOpen(t.getComponent(),0):!1,controlEl:t.modules.dataTree&&r?t.modules.dataTree.controlEl:!1,branchEl:t.modules.dataTree&&r?t.modules.dataTree.branchEl:!1,parent:t.modules.dataTree?t.modules.dataTree.parent:!1,children:r}}reinitializeRowChildren(t){var e=this.getTreeChildren(t,!1,!0);e.forEach(function(i){i.reinitialize(!0)})}layoutRow(t){var e=this.elementField?t.getCell(this.elementField):t.getCells()[0],i=e.getElement(),r=t.modules.dataTree;r.branchEl&&(r.branchEl.parentNode&&r.branchEl.parentNode.removeChild(r.branchEl),r.branchEl=!1),r.controlEl&&(r.controlEl.parentNode&&r.controlEl.parentNode.removeChild(r.controlEl),r.controlEl=!1),this.generateControlElement(t,i),t.getElement().classList.add("tabulator-tree-level-"+r.index),r.index&&(this.branchEl?(r.branchEl=this.branchEl.cloneNode(!0),i.insertBefore(r.branchEl,i.firstChild),this.table.rtl?r.branchEl.style.marginRight=(r.branchEl.offsetWidth+r.branchEl.style.marginLeft)*(r.index-1)+r.index*this.indent+"px":r.branchEl.style.marginLeft=(r.branchEl.offsetWidth+r.branchEl.style.marginRight)*(r.index-1)+r.index*this.indent+"px"):this.table.rtl?i.style.paddingRight=parseInt(window.getComputedStyle(i,null).getPropertyValue("padding-right"))+r.index*this.indent+"px":i.style.paddingLeft=parseInt(window.getComputedStyle(i,null).getPropertyValue("padding-left"))+r.index*this.indent+"px")}generateControlElement(t,e){var i=t.modules.dataTree,r=i.controlEl;e=e||t.getCells()[0].getElement(),i.children!==!1&&(i.open?(i.controlEl=this.collapseEl.cloneNode(!0),i.controlEl.addEventListener("click",n=>{n.stopPropagation(),this.collapseRow(t)})):(i.controlEl=this.expandEl.cloneNode(!0),i.controlEl.addEventListener("click",n=>{n.stopPropagation(),this.expandRow(t)})),i.controlEl.addEventListener("mousedown",n=>{n.stopPropagation()}),r&&r.parentNode===e?r.parentNode.replaceChild(i.controlEl,r):e.insertBefore(i.controlEl,e.firstChild))}getRows(t){var e=[];return t.forEach((i,r)=>{var n,a;e.push(i),i instanceof pr&&(i.create(),n=i.modules.dataTree,!n.index&&n.children!==!1&&(a=this.getChildren(i,!1,!0),a.forEach(o=>{o.create(),e.push(o)})))}),e}getChildren(t,e,i){var r=t.modules.dataTree,n=[],a=[];return r.children!==!1&&(r.open||e)&&(Array.isArray(r.children)||(r.children=this.generateChildren(t)),this.table.modExists("filter")&&this.table.options.dataTreeFilter?n=this.table.modules.filter.filter(r.children):n=r.children,this.table.modExists("sort")&&this.table.options.dataTreeSort&&this.table.modules.sort.sort(n,i),n.forEach(o=>{a.push(o);var l=this.getChildren(o,!1,!0);l.forEach(h=>{a.push(h)})})),a}generateChildren(t){var e=[],i=t.getData()[this.field];return Array.isArray(i)||(i=[i]),i.forEach(r=>{var n=new pr(r||{},this.table.rowManager);n.create(),n.modules.dataTree.index=t.modules.dataTree.index+1,n.modules.dataTree.parent=t,n.modules.dataTree.children&&(n.modules.dataTree.open=this.startOpen(n.getComponent(),n.modules.dataTree.index)),e.push(n)}),e}expandRow(t,e){var i=t.modules.dataTree;i.children!==!1&&(i.open=!0,t.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowExpanded",t.getComponent(),t.modules.dataTree.index))}collapseRow(t){var e=t.modules.dataTree;e.children!==!1&&(e.open=!1,t.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowCollapsed",t.getComponent(),t.modules.dataTree.index))}toggleRow(t){var e=t.modules.dataTree;e.children!==!1&&(e.open?this.collapseRow(t):this.expandRow(t))}isRowExpanded(t){return t.modules.dataTree.open}getTreeParent(t){return t.modules.dataTree.parent?t.modules.dataTree.parent.getComponent():!1}getTreeParentRoot(t){return t.modules.dataTree&&t.modules.dataTree.parent?this.getTreeParentRoot(t.modules.dataTree.parent):t}getFilteredTreeChildren(t){var e=t.modules.dataTree,i=[],r;return e.children&&(Array.isArray(e.children)||(e.children=this.generateChildren(t)),this.table.modExists("filter")&&this.table.options.dataTreeFilter?r=this.table.modules.filter.filter(e.children):r=e.children,r.forEach(n=>{n instanceof pr&&i.push(n)})),i}rowDelete(t){var e=t.modules.dataTree.parent,i;e&&(i=this.findChildIndex(t,e),i!==!1&&e.data[this.field].splice(i,1),e.data[this.field].length||delete e.data[this.field],this.initializeRow(e),this.layoutRow(e)),this.refreshData(!0)}addTreeChildRow(t,e,i,r){var n=!1;typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(t.data[this.field])||(t.data[this.field]=[],t.modules.dataTree.open=this.startOpen(t.getComponent(),t.modules.dataTree.index)),typeof r<"u"&&(n=this.findChildIndex(r,t),n!==!1&&t.data[this.field].splice(i?n:n+1,0,e)),n===!1&&(i?t.data[this.field].unshift(e):t.data[this.field].push(e)),this.initializeRow(t),this.layoutRow(t),this.refreshData(!0)}findChildIndex(t,e){var i=!1;return typeof t=="object"?t instanceof pr?i=t.data:t instanceof Zc?i=t._getSelf().data:typeof HTMLElement<"u"&&t instanceof HTMLElement?e.modules.dataTree&&(i=e.modules.dataTree.children.find(r=>r instanceof pr?r.element===t:!1),i&&(i=i.data)):t===null&&(i=!1):typeof t>"u"?i=!1:i=e.data[this.field].find(r=>r.data[this.table.options.index]==t),i&&(Array.isArray(e.data[this.field])&&(i=e.data[this.field].indexOf(i)),i==-1&&(i=!1)),i}getTreeChildren(t,e,i){var r=t.modules.dataTree,n=[];return r&&r.children&&(Array.isArray(r.children)||(r.children=this.generateChildren(t)),r.children.forEach(a=>{a instanceof pr&&(n.push(e?a.getComponent():a),i&&this.getTreeChildren(a,e,i).forEach(o=>{n.push(o)}))})),n}getChildField(){return this.field}redrawNeeded(t){return(this.field?typeof t[this.field]<"u":!1)||(this.elementField?typeof t[this.elementField]<"u":!1)}}Ne(Kw,"moduleName","dataTree");function EV(s,t={},e){var i=t.delimiter?t.delimiter:",",r=[],n=[];s.forEach(a=>{var o=[];switch(a.type){case"group":console.warn("Download Warning - CSV downloader cannot process row groups");break;case"calc":console.warn("Download Warning - CSV downloader cannot process column calculations");break;case"header":a.columns.forEach((l,h)=>{l&&l.depth===1&&(n[h]=typeof l.value>"u"||l.value===null?"":'"'+String(l.value).split('"').join('""')+'"')});break;case"row":a.columns.forEach(l=>{if(l){switch(typeof l.value){case"object":l.value=l.value!==null?JSON.stringify(l.value):"";break;case"undefined":l.value="";break}o.push('"'+String(l.value).split('"').join('""')+'"')}}),r.push(o.join(i));break}}),n.length&&r.unshift(n.join(i)),r=r.join("\n"),t.bom&&(r="\uFEFF"+r),e(r,"text/csv")}function SV(s,t,e){var i=[];s.forEach(r=>{var n={};switch(r.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":r.columns.forEach(a=>{a&&(n[a.component.getTitleDownload()||a.component.getField()]=a.value)}),i.push(n);break}}),i=JSON.stringify(i,null,"	"),e(i,"application/json")}function kV(s,t={},e){var i=[],r=[],n={},a=t.rowGroupStyles||{fontStyle:"bold",fontSize:12,cellPadding:6,fillColor:220},o=t.rowCalcStyles||{fontStyle:"bold",fontSize:10,cellPadding:4,fillColor:232},l=t.jsPDF||{},h=t.title?t.title:"",u,c;l.orientation||(l.orientation=t.orientation||"landscape"),l.unit||(l.unit="pt"),s.forEach(d=>{switch(d.type){case"header":i.push(f(d));break;case"group":r.push(f(d,a));break;case"calc":r.push(f(d,o));break;case"row":r.push(f(d));break}});function f(d,p){var v=[];return d.columns.forEach(g=>{var b;if(g){switch(typeof g.value){case"object":g.value=g.value!==null?JSON.stringify(g.value):"";break;case"undefined":g.value="";break}b={content:g.value,colSpan:g.width,rowSpan:g.height},p&&(b.styles=p),v.push(b)}}),v}u=this.dependencyRegistry.lookup("jspdf","jsPDF"),c=new u(l),t.autoTable&&(typeof t.autoTable=="function"?n=t.autoTable(c)||{}:n=t.autoTable),h&&(n.didDrawPage=function(d){c.text(h,40,30)}),n.head=i,n.body=r,c.autoTable(n),t.documentProcessing&&t.documentProcessing(c),e(c.output("arraybuffer"),"application/pdf")}function TV(s,t,e){var i=this,r=t.sheetName||"Sheet1",n=this.dependencyRegistry.lookup("XLSX"),a=n.utils.book_new(),o=new Gi(this),l="compress"in t?t.compress:!0,h=t.writeOptions||{bookType:"xlsx",bookSST:!0,compression:l},u;h.type="binary",a.SheetNames=[],a.Sheets={};function c(){var p=[],v=[],g={},b={s:{c:0,r:0},e:{c:s[0]?s[0].columns.reduce((C,y)=>C+(y&&y.width?y.width:1),0):0,r:s.length}};return s.forEach((C,y)=>{var x=[];C.columns.forEach(function(w,S){w?(x.push(!(w.value instanceof Date)&&typeof w.value=="object"?JSON.stringify(w.value):w.value),(w.width>1||w.height>-1)&&(w.height>1||w.width>1)&&v.push({s:{r:y,c:S},e:{r:y+w.height-1,c:S+w.width-1}})):x.push("")}),p.push(x)}),n.utils.sheet_add_aoa(g,p),g["!ref"]=n.utils.encode_range(b),v.length&&(g["!merges"]=v),g}if(t.sheetOnly){e(c());return}if(t.sheets)for(var f in t.sheets)t.sheets[f]===!0?(a.SheetNames.push(f),a.Sheets[f]=c()):(a.SheetNames.push(f),o.commsSend(t.sheets[f],"download","intercept",{type:"xlsx",options:{sheetOnly:!0},active:i.active,intercept:function(p){a.Sheets[f]=p}}));else a.SheetNames.push(r),a.Sheets[r]=c();t.documentProcessing&&(a=t.documentProcessing(a));function d(p){for(var v=new ArrayBuffer(p.length),g=new Uint8Array(v),b=0;b!=p.length;++b)g[b]=p.charCodeAt(b)&255;return v}u=n.write(a,h),e(d(u),"application/octet-stream")}function AV(s,t,e){this.modExists("export",!0)&&e(this.modules.export.generateHTMLTable(s),"text/html")}function OV(s,t,e){const i=[];s.forEach(r=>{const n={};switch(r.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":r.columns.forEach(a=>{a&&(n[a.component.getTitleDownload()||a.component.getField()]=a.value)}),i.push(JSON.stringify(n));break}}),e(i.join("\n"),"application/x-ndjson")}var DV={csv:EV,json:SV,jsonLines:OV,pdf:kV,xlsx:TV,html:AV};const uo=class uo extends pt{constructor(t){super(t),this.registerTableOption("downloadEncoder",function(e,i){return new Blob([e],{type:i})}),this.registerTableOption("downloadConfig",{}),this.registerTableOption("downloadRowRange","active"),this.registerColumnOption("download"),this.registerColumnOption("titleDownload")}initialize(){this.deprecatedOptionsCheck(),this.registerTableFunction("download",this.download.bind(this)),this.registerTableFunction("downloadToTab",this.downloadToTab.bind(this))}deprecatedOptionsCheck(){}downloadToTab(t,e,i,r){this.download(t,e,i,r,!0)}download(t,e,i,r,n){var a=!1;function o(h,u){n?n===!0?this.triggerDownload(h,u,t,e,!0):n(h):this.triggerDownload(h,u,t,e)}if(typeof t=="function"?a=t:uo.downloaders[t]?a=uo.downloaders[t]:console.warn("Download Error - No such download type found: ",t),a){var l=this.generateExportList(r);a.call(this.table,l,i||{},o.bind(this))}}generateExportList(t){var e=this.table.modules.export.generateExportList(this.table.options.downloadConfig,!1,t||this.table.options.downloadRowRange,"download"),i=this.table.options.groupHeaderDownload;return i&&!Array.isArray(i)&&(i=[i]),e.forEach(r=>{var n;r.type==="group"&&(n=r.columns[0],i&&i[r.indent]&&(n.value=i[r.indent](n.value,r.component._group.getRowCount(),r.component._group.getData(),r.component)))}),e}triggerDownload(t,e,i,r,n){var a=document.createElement("a"),o=this.table.options.downloadEncoder(t,e);o&&(n?window.open(window.URL.createObjectURL(o)):(r=r||"Tabulator."+(typeof i=="function"?"txt":i),navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(o,r):(a.setAttribute("href",window.URL.createObjectURL(o)),a.setAttribute("download",r),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a))),this.dispatchExternal("downloadComplete"))}commsReceived(t,e,i){switch(e){case"intercept":this.download(i.type,"",i.options,i.active,i.intercept);break}}};Ne(uo,"moduleName","download"),Ne(uo,"downloaders",DV);let xp=uo;function ef(s,t){var e=t.mask,i=typeof t.maskLetterChar<"u"?t.maskLetterChar:"A",r=typeof t.maskNumberChar<"u"?t.maskNumberChar:"9",n=typeof t.maskWildcardChar<"u"?t.maskWildcardChar:"*";function a(o){var l=e[o];typeof l<"u"&&l!==n&&l!==i&&l!==r&&(s.value=s.value+""+l,a(o+1))}s.addEventListener("keydown",o=>{var l=s.value.length,h=o.key;if(o.keyCode>46&&!o.ctrlKey&&!o.metaKey){if(l>=e.length)return o.preventDefault(),o.stopPropagation(),!1;switch(e[l]){case i:if(h.toUpperCase()==h.toLowerCase())return o.preventDefault(),o.stopPropagation(),!1;break;case r:if(isNaN(h))return o.preventDefault(),o.stopPropagation(),!1;break;case n:break;default:if(h!==e[l])return o.preventDefault(),o.stopPropagation(),!1}}}),s.addEventListener("keyup",o=>{o.keyCode>46&&t.maskAutoFill&&a(s.value.length)}),s.placeholder||(s.placeholder=e),t.maskAutoFill&&a(s.value.length)}function LV(s,t,e,i,r){var n=s.getValue(),a=document.createElement("input");if(a.setAttribute("type",r.search?"search":"text"),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",r.elementAttributes&&typeof r.elementAttributes=="object")for(let l in r.elementAttributes)l.charAt(0)=="+"?(l=l.slice(1),a.setAttribute(l,a.getAttribute(l)+r.elementAttributes["+"+l])):a.setAttribute(l,r.elementAttributes[l]);a.value=typeof n<"u"?n:"",t(function(){s.getType()==="cell"&&(a.focus({preventScroll:!0}),a.style.height="100%",r.selectContents&&a.select())});function o(l){(n===null||typeof n>"u")&&a.value!==""||a.value!==n?e(a.value)&&(n=a.value):i()}return a.addEventListener("change",o),a.addEventListener("blur",o),a.addEventListener("keydown",function(l){switch(l.keyCode){case 13:o();break;case 27:i();break;case 35:case 36:l.stopPropagation();break}}),r.mask&&ef(a,r),a}function RV(s,t,e,i,r){var n=s.getValue(),a=r.verticalNavigation||"hybrid",o=String(n!==null&&typeof n<"u"?n:""),l=document.createElement("textarea"),h=0;if(l.style.display="block",l.style.padding="2px",l.style.height="100%",l.style.width="100%",l.style.boxSizing="border-box",l.style.whiteSpace="pre-wrap",l.style.resize="none",r.elementAttributes&&typeof r.elementAttributes=="object")for(let c in r.elementAttributes)c.charAt(0)=="+"?(c=c.slice(1),l.setAttribute(c,l.getAttribute(c)+r.elementAttributes["+"+c])):l.setAttribute(c,r.elementAttributes[c]);l.value=o,t(function(){s.getType()==="cell"&&(l.focus({preventScroll:!0}),l.style.height="100%",l.scrollHeight,l.style.height=l.scrollHeight+"px",s.getRow().normalizeHeight(),r.selectContents&&l.select())});function u(c){(n===null||typeof n>"u")&&l.value!==""||l.value!==n?(e(l.value)&&(n=l.value),setTimeout(function(){s.getRow().normalizeHeight()},300)):i()}return l.addEventListener("change",u),l.addEventListener("blur",u),l.addEventListener("keyup",function(){l.style.height="";var c=l.scrollHeight;l.style.height=c+"px",c!=h&&(h=c,s.getRow().normalizeHeight())}),l.addEventListener("keydown",function(c){switch(c.keyCode){case 13:c.shiftKey&&r.shiftEnterSubmit&&u();break;case 27:i();break;case 38:(a=="editor"||a=="hybrid"&&l.selectionStart)&&(c.stopImmediatePropagation(),c.stopPropagation());break;case 40:(a=="editor"||a=="hybrid"&&l.selectionStart!==l.value.length)&&(c.stopImmediatePropagation(),c.stopPropagation());break;case 35:case 36:c.stopPropagation();break}}),r.mask&&ef(l,r),l}function IV(s,t,e,i,r){var n=s.getValue(),a=r.verticalNavigation||"editor",o=document.createElement("input");if(o.setAttribute("type","number"),typeof r.max<"u"&&o.setAttribute("max",r.max),typeof r.min<"u"&&o.setAttribute("min",r.min),typeof r.step<"u"&&o.setAttribute("step",r.step),o.style.padding="4px",o.style.width="100%",o.style.boxSizing="border-box",r.elementAttributes&&typeof r.elementAttributes=="object")for(let u in r.elementAttributes)u.charAt(0)=="+"?(u=u.slice(1),o.setAttribute(u,o.getAttribute(u)+r.elementAttributes["+"+u])):o.setAttribute(u,r.elementAttributes[u]);o.value=n;var l=function(u){h()};t(function(){s.getType()==="cell"&&(o.removeEventListener("blur",l),o.focus({preventScroll:!0}),o.style.height="100%",o.addEventListener("blur",l),r.selectContents&&o.select())});function h(){var u=o.value;!isNaN(u)&&u!==""&&(u=Number(u)),u!==n?e(u)&&(n=u):i()}return o.addEventListener("keydown",function(u){switch(u.keyCode){case 13:h();break;case 27:i();break;case 38:case 40:a=="editor"&&(u.stopImmediatePropagation(),u.stopPropagation());break;case 35:case 36:u.stopPropagation();break}}),r.mask&&ef(o,r),o}function _V(s,t,e,i,r){var n=s.getValue(),a=document.createElement("input");if(a.setAttribute("type","range"),typeof r.max<"u"&&a.setAttribute("max",r.max),typeof r.min<"u"&&a.setAttribute("min",r.min),typeof r.step<"u"&&a.setAttribute("step",r.step),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",r.elementAttributes&&typeof r.elementAttributes=="object")for(let l in r.elementAttributes)l.charAt(0)=="+"?(l=l.slice(1),a.setAttribute(l,a.getAttribute(l)+r.elementAttributes["+"+l])):a.setAttribute(l,r.elementAttributes[l]);a.value=n,t(function(){s.getType()==="cell"&&(a.focus({preventScroll:!0}),a.style.height="100%")});function o(){var l=a.value;!isNaN(l)&&l!==""&&(l=Number(l)),l!=n?e(l)&&(n=l):i()}return a.addEventListener("blur",function(l){o()}),a.addEventListener("keydown",function(l){switch(l.keyCode){case 13:o();break;case 27:i();break}}),a}function FV(s,t,e,i,r){var n=r.format,a=r.verticalNavigation||"editor",o=n?window.DateTime||luxon.DateTime:null,l=s.getValue(),h=document.createElement("input");function u(f){var d;return o.isDateTime(f)?d=f:n==="iso"?d=o.fromISO(String(f)):d=o.fromFormat(String(f),n),d.toFormat("yyyy-MM-dd")}if(h.type="date",h.style.padding="4px",h.style.width="100%",h.style.boxSizing="border-box",r.max&&h.setAttribute("max",n?u(r.max):r.max),r.min&&h.setAttribute("min",n?u(r.min):r.min),r.elementAttributes&&typeof r.elementAttributes=="object")for(let f in r.elementAttributes)f.charAt(0)=="+"?(f=f.slice(1),h.setAttribute(f,h.getAttribute(f)+r.elementAttributes["+"+f])):h.setAttribute(f,r.elementAttributes[f]);l=typeof l<"u"?l:"",n&&(o?l=u(l):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),h.value=l,t(function(){s.getType()==="cell"&&(h.focus({preventScroll:!0}),h.style.height="100%",r.selectContents&&h.select())});function c(){var f=h.value,d;if((l===null||typeof l>"u")&&f!==""||f!==l){if(f&&n)switch(d=o.fromFormat(String(f),"yyyy-MM-dd"),n){case!0:f=d;break;case"iso":f=d.toISO();break;default:f=d.toFormat(n)}e(f)&&(l=h.value)}else i()}return h.addEventListener("blur",function(f){(f.relatedTarget||f.rangeParent||f.explicitOriginalTarget!==h)&&c()}),h.addEventListener("keydown",function(f){switch(f.keyCode){case 13:c();break;case 27:i();break;case 35:case 36:f.stopPropagation();break;case 38:case 40:a=="editor"&&(f.stopImmediatePropagation(),f.stopPropagation());break}}),h}function NV(s,t,e,i,r){var n=r.format,a=r.verticalNavigation||"editor",o=n?window.DateTime||luxon.DateTime:null,l,h=s.getValue(),u=document.createElement("input");if(u.type="time",u.style.padding="4px",u.style.width="100%",u.style.boxSizing="border-box",r.elementAttributes&&typeof r.elementAttributes=="object")for(let f in r.elementAttributes)f.charAt(0)=="+"?(f=f.slice(1),u.setAttribute(f,u.getAttribute(f)+r.elementAttributes["+"+f])):u.setAttribute(f,r.elementAttributes[f]);h=typeof h<"u"?h:"",n&&(o?(o.isDateTime(h)?l=h:n==="iso"?l=o.fromISO(String(h)):l=o.fromFormat(String(h),n),h=l.toFormat("HH:mm")):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),u.value=h,t(function(){s.getType()=="cell"&&(u.focus({preventScroll:!0}),u.style.height="100%",r.selectContents&&u.select())});function c(){var f=u.value,d;if((h===null||typeof h>"u")&&f!==""||f!==h){if(f&&n)switch(d=o.fromFormat(String(f),"hh:mm"),n){case!0:f=d;break;case"iso":f=d.toISO();break;default:f=d.toFormat(n)}e(f)&&(h=u.value)}else i()}return u.addEventListener("blur",function(f){(f.relatedTarget||f.rangeParent||f.explicitOriginalTarget!==u)&&c()}),u.addEventListener("keydown",function(f){switch(f.keyCode){case 13:c();break;case 27:i();break;case 35:case 36:f.stopPropagation();break;case 38:case 40:a=="editor"&&(f.stopImmediatePropagation(),f.stopPropagation());break}}),u}function MV(s,t,e,i,r){var n=r.format,a=r.verticalNavigation||"editor",o=n?this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"):null,l,h=s.getValue(),u=document.createElement("input");if(u.type="datetime-local",u.style.padding="4px",u.style.width="100%",u.style.boxSizing="border-box",r.elementAttributes&&typeof r.elementAttributes=="object")for(let f in r.elementAttributes)f.charAt(0)=="+"?(f=f.slice(1),u.setAttribute(f,u.getAttribute(f)+r.elementAttributes["+"+f])):u.setAttribute(f,r.elementAttributes[f]);h=typeof h<"u"?h:"",n&&(o?(o.isDateTime(h)?l=h:n==="iso"?l=o.fromISO(String(h)):l=o.fromFormat(String(h),n),h=l.toFormat("yyyy-MM-dd")+"T"+l.toFormat("HH:mm")):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),u.value=h,t(function(){s.getType()==="cell"&&(u.focus({preventScroll:!0}),u.style.height="100%",r.selectContents&&u.select())});function c(){var f=u.value,d;if((h===null||typeof h>"u")&&f!==""||f!==h){if(f&&n)switch(d=o.fromISO(String(f)),n){case!0:f=d;break;case"iso":f=d.toISO();break;default:f=d.toFormat(n)}e(f)&&(h=u.value)}else i()}return u.addEventListener("blur",function(f){(f.relatedTarget||f.rangeParent||f.explicitOriginalTarget!==u)&&c()}),u.addEventListener("keydown",function(f){switch(f.keyCode){case 13:c();break;case 27:i();break;case 35:case 36:f.stopPropagation();break;case 38:case 40:a=="editor"&&(f.stopImmediatePropagation(),f.stopPropagation());break}}),u}let PV=class{constructor(t,e,i,r,n,a){this.edit=t,this.table=t.table,this.cell=e,this.params=this._initializeParams(a),this.data=[],this.displayItems=[],this.currentItems=[],this.focusedItem=null,this.input=this._createInputElement(),this.listEl=this._createListElement(),this.initialValues=null,this.isFilter=e.getType()==="header",this.filterTimeout=null,this.filtered=!1,this.typing=!1,this.values=[],this.popup=null,this.listIteration=0,this.lastAction="",this.filterTerm="",this.blurable=!0,this.actions={success:r,cancel:n},this._deprecatedOptionsCheck(),this._initializeValue(),i(this._onRendered.bind(this))}_deprecatedOptionsCheck(){}_initializeValue(){var t=this.cell.getValue();typeof t>"u"&&typeof this.params.defaultValue<"u"&&(t=this.params.defaultValue),this.initialValues=this.params.multiselect?t:[t],this.isFilter&&(this.input.value=this.initialValues?this.initialValues.join(","):"",this.headerFilterInitialListGen())}_onRendered(){var t=this.cell.getElement();function e(i){i.stopPropagation()}this.isFilter||(this.input.style.height="100%",this.input.focus({preventScroll:!0})),t.addEventListener("click",e),setTimeout(()=>{t.removeEventListener("click",e)},1e3),this.input.addEventListener("mousedown",this._preventPopupBlur.bind(this))}_createListElement(){var t=document.createElement("div");return t.classList.add("tabulator-edit-list"),t.addEventListener("mousedown",this._preventBlur.bind(this)),t.addEventListener("keydown",this._inputKeyDown.bind(this)),t}_setListWidth(){var t=this.isFilter?this.input:this.cell.getElement();this.listEl.style.minWidth=t.offsetWidth+"px",this.params.maxWidth&&(this.params.maxWidth===!0?this.listEl.style.maxWidth=t.offsetWidth+"px":typeof this.params.maxWidth=="number"?this.listEl.style.maxWidth=this.params.maxWidth+"px":this.listEl.style.maxWidth=this.params.maxWidth)}_createInputElement(){var t=this.params.elementAttributes,e=document.createElement("input");if(e.setAttribute("type",this.params.clearable?"search":"text"),e.style.padding="4px",e.style.width="100%",e.style.boxSizing="border-box",this.params.autocomplete||(e.style.cursor="default",e.style.caretColor="transparent"),t&&typeof t=="object")for(let i in t)i.charAt(0)=="+"?(i=i.slice(1),e.setAttribute(i,e.getAttribute(i)+t["+"+i])):e.setAttribute(i,t[i]);return this.params.mask&&ef(e,this.params),this._bindInputEvents(e),e}_initializeParams(t){var e=["values","valuesURL","valuesLookup"],i;return t=Object.assign({},t),t.verticalNavigation=t.verticalNavigation||"editor",t.placeholderLoading=typeof t.placeholderLoading>"u"?"Searching ...":t.placeholderLoading,t.placeholderEmpty=typeof t.placeholderEmpty>"u"?"No Results Found":t.placeholderEmpty,t.filterDelay=typeof t.filterDelay>"u"?300:t.filterDelay,t.emptyValue=Object.keys(t).includes("emptyValue")?t.emptyValue:"",i=Object.keys(t).filter(r=>e.includes(r)).length,i?i>1&&console.warn("list editor config error - only one of the values, valuesURL, or valuesLookup options can be set on the same editor"):console.warn("list editor config error - either the values, valuesURL, or valuesLookup option must be set"),t.autocomplete?t.multiselect&&(t.multiselect=!1,console.warn("list editor config error - multiselect option is not available when autocomplete is enabled")):(t.freetext&&(t.freetext=!1,console.warn("list editor config error - freetext option is only available when autocomplete is enabled")),t.filterFunc&&(t.filterFunc=!1,console.warn("list editor config error - filterFunc option is only available when autocomplete is enabled")),t.filterRemote&&(t.filterRemote=!1,console.warn("list editor config error - filterRemote option is only available when autocomplete is enabled")),t.mask&&(t.mask=!1,console.warn("list editor config error - mask option is only available when autocomplete is enabled")),t.allowEmpty&&(t.allowEmpty=!1,console.warn("list editor config error - allowEmpty option is only available when autocomplete is enabled")),t.listOnEmpty&&(t.listOnEmpty=!1,console.warn("list editor config error - listOnEmpty option is only available when autocomplete is enabled"))),t.filterRemote&&!(typeof t.valuesLookup=="function"||t.valuesURL)&&(t.filterRemote=!1,console.warn("list editor config error - filterRemote option should only be used when values list is populated from a remote source")),t}_bindInputEvents(t){t.addEventListener("focus",this._inputFocus.bind(this)),t.addEventListener("click",this._inputClick.bind(this)),t.addEventListener("blur",this._inputBlur.bind(this)),t.addEventListener("keydown",this._inputKeyDown.bind(this)),t.addEventListener("search",this._inputSearch.bind(this)),this.params.autocomplete&&t.addEventListener("keyup",this._inputKeyUp.bind(this))}_inputFocus(t){this.rebuildOptionsList()}_filter(){this.params.filterRemote?(clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(()=>{this.rebuildOptionsList()},this.params.filterDelay)):this._filterList()}_inputClick(t){t.stopPropagation()}_inputBlur(t){this.blurable&&(this.popup?this.popup.hide():this._resolveValue(!0))}_inputSearch(){this._clearChoices()}_inputKeyDown(t){switch(t.keyCode){case 38:this._keyUp(t);break;case 40:this._keyDown(t);break;case 37:case 39:this._keySide(t);break;case 13:this._keyEnter();break;case 27:this._keyEsc();break;case 36:case 35:this._keyHomeEnd(t);break;case 9:this._keyTab(t);break;default:this._keySelectLetter(t)}}_inputKeyUp(t){switch(t.keyCode){case 38:case 37:case 39:case 40:case 13:case 27:break;default:this._keyAutoCompLetter(t)}}_preventPopupBlur(){this.popup&&this.popup.blockHide(),setTimeout(()=>{this.popup&&this.popup.restoreHide()},10)}_preventBlur(){this.blurable=!1,setTimeout(()=>{this.blurable=!0},10)}_keyTab(t){this.params.autocomplete&&this.lastAction==="typing"?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem,!0)}_keyUp(t){var e=this.displayItems.indexOf(this.focusedItem);(this.params.verticalNavigation=="editor"||this.params.verticalNavigation=="hybrid"&&e)&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),e>0&&this._focusItem(this.displayItems[e-1]))}_keyDown(t){var e=this.displayItems.indexOf(this.focusedItem);(this.params.verticalNavigation=="editor"||this.params.verticalNavigation=="hybrid"&&e<this.displayItems.length-1)&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),e<this.displayItems.length-1&&(e==-1?this._focusItem(this.displayItems[0]):this._focusItem(this.displayItems[e+1])))}_keySide(t){this.params.autocomplete||(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault())}_keyEnter(t){this.params.autocomplete&&this.lastAction==="typing"?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem)}_keyEsc(t){this._cancel()}_keyHomeEnd(t){this.params.autocomplete&&t.stopImmediatePropagation()}_keySelectLetter(t){this.params.autocomplete||(t.preventDefault(),t.keyCode>=38&&t.keyCode<=90&&this._scrollToValue(t.keyCode))}_keyAutoCompLetter(t){this._filter(),this.lastAction="typing",this.typing=!0}_scrollToValue(t){clearTimeout(this.filterTimeout);var e=String.fromCharCode(t).toLowerCase();this.filterTerm+=e.toLowerCase();var i=this.displayItems.find(r=>typeof r.label<"u"&&r.label.toLowerCase().startsWith(this.filterTerm));i&&this._focusItem(i),this.filterTimeout=setTimeout(()=>{this.filterTerm=""},800)}_focusItem(t){this.lastAction="focus",this.focusedItem&&this.focusedItem.element&&this.focusedItem.element.classList.remove("focused"),this.focusedItem=t,t&&t.element&&(t.element.classList.add("focused"),t.element.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}headerFilterInitialListGen(){this._generateOptions(!0)}rebuildOptionsList(){this._generateOptions().then(this._sortOptions.bind(this)).then(this._buildList.bind(this)).then(this._showList.bind(this)).catch(t=>{Number.isInteger(t)||console.error("List generation error",t)})}_filterList(){this._buildList(this._filterOptions()),this._showList()}_generateOptions(t){var e=[],i=++this.listIteration;return this.filtered=!1,this.params.values?e=this.params.values:this.params.valuesURL?e=this._ajaxRequest(this.params.valuesURL,this.input.value):typeof this.params.valuesLookup=="function"?e=this.params.valuesLookup(this.cell,this.input.value):this.params.valuesLookup&&(e=this._uniqueColumnValues(this.params.valuesLookupField)),e instanceof Promise?(t||this._addPlaceholder(this.params.placeholderLoading),e.then().then(r=>this.listIteration===i?this._parseList(r):Promise.reject(i))):Promise.resolve(this._parseList(e))}_addPlaceholder(t){var e=document.createElement("div");typeof t=="function"&&(t=t(this.cell.getComponent(),this.listEl)),t&&(this._clearList(),t instanceof HTMLElement?e=t:(e.classList.add("tabulator-edit-list-placeholder"),e.innerHTML=t),this.listEl.appendChild(e),this._showList())}_ajaxRequest(t,e){var i=this.params.filterRemote?{term:e}:{};return t=$w(t,{},i),fetch(t).then(r=>r.ok?r.json().catch(n=>(console.warn("List Ajax Load Error - Invalid JSON returned",n),Promise.reject(n))):(console.error("List Ajax Load Error - Connection Error: "+r.status,r.statusText),Promise.reject(r))).catch(r=>(console.error("List Ajax Load Error - Connection Error: ",r),Promise.reject(r)))}_uniqueColumnValues(t){var e={},i=this.table.getData(this.params.valuesLookup),r;return t?r=this.table.columnManager.getColumnByField(t):r=this.cell.getColumn()._getSelf(),r?i.forEach(n=>{var a=r.getFieldValue(n);this._emptyValueCheck(a)||(this.params.multiselect&&Array.isArray(a)?a.forEach(o=>{this._emptyValueCheck(o)||(e[o]=!0)}):e[a]=!0)}):(console.warn("unable to find matching column to create select lookup list:",t),e=[]),Object.keys(e)}_emptyValueCheck(t){return t===null||typeof t>"u"||t===""}_parseList(t){var e=[];return Array.isArray(t)||(t=Object.entries(t).map(([i,r])=>({label:r,value:i}))),t.forEach(i=>{typeof i!="object"&&(i={label:i,value:i}),this._parseListItem(i,e,0)}),!this.currentItems.length&&this.params.freetext&&(this.input.value=this.initialValues,this.typing=!0,this.lastAction="typing"),this.data=e,e}_parseListItem(t,e,i){var r={};t.options?r=this._parseListGroup(t,i+1):(r={label:t.label,value:t.value,itemParams:t.itemParams,elementAttributes:t.elementAttributes,element:!1,selected:!1,visible:!0,level:i,original:t},this.initialValues&&this.initialValues.indexOf(t.value)>-1&&this._chooseItem(r,!0)),e.push(r)}_parseListGroup(t,e){var i={label:t.label,group:!0,itemParams:t.itemParams,elementAttributes:t.elementAttributes,element:!1,visible:!0,level:e,options:[],original:t};return t.options.forEach(r=>{this._parseListItem(r,i.options,e)}),i}_sortOptions(t){var e;return this.params.sort&&(e=typeof this.params.sort=="function"?this.params.sort:this._defaultSortFunction.bind(this),this._sortGroup(e,t)),t}_sortGroup(t,e){e.sort((i,r)=>t(i.label,r.label,i.value,r.value,i.original,r.original)),e.forEach(i=>{i.group&&this._sortGroup(t,i.options)})}_defaultSortFunction(t,e){var i,r,n,a,o=0,l,h=/(\d+)|(\D+)/g,u=/\d/,c=0;if(this.params.sort==="desc"&&([t,e]=[e,t]),!t&&t!==0)c=!e&&e!==0?0:-1;else if(!e&&e!==0)c=1;else{if(isFinite(t)&&isFinite(e))return t-e;if(i=String(t).toLowerCase(),r=String(e).toLowerCase(),i===r)return 0;if(!(u.test(i)&&u.test(r)))return i>r?1:-1;for(i=i.match(h),r=r.match(h),l=i.length>r.length?r.length:i.length;o<l;)if(n=i[o],a=r[o++],n!==a)return isFinite(n)&&isFinite(a)?(n.charAt(0)==="0"&&(n="."+n),a.charAt(0)==="0"&&(a="."+a),n-a):n>a?1:-1;return i.length>r.length}return c}_filterOptions(){var t=this.params.filterFunc||this._defaultFilterFunc,e=this.input.value;return e?(this.filtered=!0,this.data.forEach(i=>{this._filterItem(t,e,i)})):this.filtered=!1,this.data}_filterItem(t,e,i){var r=!1;return i.group?(i.options.forEach(n=>{this._filterItem(t,e,n)&&(r=!0)}),i.visible=r):i.visible=t(e,i.label,i.value,i.original),i.visible}_defaultFilterFunc(t,e,i,r){return t=String(t).toLowerCase(),e!==null&&typeof e<"u"&&(String(e).toLowerCase().indexOf(t)>-1||String(i).toLowerCase().indexOf(t)>-1)}_clearList(){for(;this.listEl.firstChild;)this.listEl.removeChild(this.listEl.firstChild);this.displayItems=[]}_buildList(t){this._clearList(),t.forEach(e=>{this._buildItem(e)}),this.displayItems.length||this._addPlaceholder(this.params.placeholderEmpty)}_buildItem(t){var e=t.element,i;if(!this.filtered||t.visible){if(!e){if(e=document.createElement("div"),e.tabIndex=0,i=this.params.itemFormatter?this.params.itemFormatter(t.label,t.value,t.original,e):t.label,i instanceof HTMLElement?e.appendChild(i):e.innerHTML=i,t.group?e.classList.add("tabulator-edit-list-group"):e.classList.add("tabulator-edit-list-item"),e.classList.add("tabulator-edit-list-group-level-"+t.level),t.elementAttributes&&typeof t.elementAttributes=="object")for(let r in t.elementAttributes)r.charAt(0)=="+"?(r=r.slice(1),e.setAttribute(r,this.input.getAttribute(r)+t.elementAttributes["+"+r])):e.setAttribute(r,t.elementAttributes[r]);t.group?e.addEventListener("click",this._groupClick.bind(this,t)):e.addEventListener("click",this._itemClick.bind(this,t)),e.addEventListener("mousedown",this._preventBlur.bind(this)),t.element=e}this._styleItem(t),this.listEl.appendChild(e),t.group?t.options.forEach(r=>{this._buildItem(r)}):this.displayItems.push(t)}}_showList(){var t=this.popup&&this.popup.isVisible();if(this.input.parentNode){if(this.params.autocomplete&&this.input.value===""&&!this.params.listOnEmpty){this.popup&&this.popup.hide(!0);return}this._setListWidth(),this.popup||(this.popup=this.edit.popup(this.listEl)),this.popup.show(this.cell.getElement(),"bottom"),t||setTimeout(()=>{this.popup.hideOnBlur(this._resolveValue.bind(this,!0))},10)}}_styleItem(t){t&&t.element&&(t.selected?t.element.classList.add("active"):t.element.classList.remove("active"))}_itemClick(t,e){e.stopPropagation(),this._chooseItem(t)}_groupClick(t,e){e.stopPropagation()}_cancel(){this.popup.hide(!0),this.actions.cancel()}_clearChoices(){this.typing=!0,this.currentItems.forEach(t=>{t.selected=!1,this._styleItem(t)}),this.currentItems=[],this.focusedItem=null}_chooseItem(t,e){var i;this.typing=!1,this.params.multiselect?(i=this.currentItems.indexOf(t),i>-1?(this.currentItems.splice(i,1),t.selected=!1):(this.currentItems.push(t),t.selected=!0),this.input.value=this.currentItems.map(r=>r.label).join(","),this._styleItem(t)):(this.currentItems=[t],t.selected=!0,this.input.value=t.label,this._styleItem(t),e||this._resolveValue()),this._focusItem(t)}_resolveValue(t){var e,i;if(this.popup&&this.popup.hide(!0),this.params.multiselect)e=this.currentItems.map(r=>r.value);else if(t&&this.params.autocomplete&&this.typing)if(this.params.freetext||this.params.allowEmpty&&this.input.value==="")e=this.input.value;else{this.actions.cancel();return}else this.currentItems[0]?e=this.currentItems[0].value:(i=Array.isArray(this.initialValues)?this.initialValues[0]:this.initialValues,i===null||typeof i>"u"||i===""?e=i:e=this.params.emptyValue);e===""&&(e=this.params.emptyValue),this.actions.success(e),this.isFilter&&(this.initialValues=e&&!Array.isArray(e)?[e]:e,this.currentItems=[])}};function BV(s,t,e,i,r){var n=new PV(this,s,t,e,i,r);return n.input}function HV(s,t,e,i,r){var n=this,a=s.getElement(),o=s.getValue(),l=a.getElementsByTagName("svg").length||5,h=a.getElementsByTagName("svg")[0]?a.getElementsByTagName("svg")[0].getAttribute("width"):14,u=[],c=document.createElement("div"),f=document.createElementNS("http://www.w3.org/2000/svg","svg");function d(b){u.forEach(function(C,y){y<b?(n.table.browser=="ie"?C.setAttribute("class","tabulator-star-active"):C.classList.replace("tabulator-star-inactive","tabulator-star-active"),C.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):(n.table.browser=="ie"?C.setAttribute("class","tabulator-star-inactive"):C.classList.replace("tabulator-star-active","tabulator-star-inactive"),C.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')})}function p(b){var C=document.createElement("span"),y=f.cloneNode(!0);u.push(y),C.addEventListener("mouseenter",function(x){x.stopPropagation(),x.stopImmediatePropagation(),d(b)}),C.addEventListener("mousemove",function(x){x.stopPropagation(),x.stopImmediatePropagation()}),C.addEventListener("click",function(x){x.stopPropagation(),x.stopImmediatePropagation(),e(b),a.blur()}),C.appendChild(y),c.appendChild(C)}function v(b){o=b,d(b)}if(a.style.whiteSpace="nowrap",a.style.overflow="hidden",a.style.textOverflow="ellipsis",c.style.verticalAlign="middle",c.style.display="inline-block",c.style.padding="4px",f.setAttribute("width",h),f.setAttribute("height",h),f.setAttribute("viewBox","0 0 512 512"),f.setAttribute("xml:space","preserve"),f.style.padding="0 1px",r.elementAttributes&&typeof r.elementAttributes=="object")for(let b in r.elementAttributes)b.charAt(0)=="+"?(b=b.slice(1),c.setAttribute(b,c.getAttribute(b)+r.elementAttributes["+"+b])):c.setAttribute(b,r.elementAttributes[b]);for(var g=1;g<=l;g++)p(g);return o=Math.min(parseInt(o),l),d(o),c.addEventListener("mousemove",function(b){d(0)}),c.addEventListener("click",function(b){e(0)}),a.addEventListener("blur",function(b){i()}),a.addEventListener("keydown",function(b){switch(b.keyCode){case 39:v(o+1);break;case 37:v(o-1);break;case 13:e(o);break;case 27:i();break}}),c}function VV(s,t,e,i,r){var n=s.getElement(),a=typeof r.max>"u"?n.getElementsByTagName("div")[0]&&n.getElementsByTagName("div")[0].getAttribute("max")||100:r.max,o=typeof r.min>"u"?n.getElementsByTagName("div")[0]&&n.getElementsByTagName("div")[0].getAttribute("min")||0:r.min,l=(a-o)/100,h=s.getValue()||0,u=document.createElement("div"),c=document.createElement("div"),f,d;function p(){var v=window.getComputedStyle(n,null),g=l*Math.round(c.offsetWidth/((n.clientWidth-parseInt(v.getPropertyValue("padding-left"))-parseInt(v.getPropertyValue("padding-right")))/100))+o;e(g),n.setAttribute("aria-valuenow",g),n.setAttribute("aria-label",h)}if(u.style.position="absolute",u.style.right="0",u.style.top="0",u.style.bottom="0",u.style.width="5px",u.classList.add("tabulator-progress-handle"),c.style.display="inline-block",c.style.position="relative",c.style.height="100%",c.style.backgroundColor="#488CE9",c.style.maxWidth="100%",c.style.minWidth="0%",r.elementAttributes&&typeof r.elementAttributes=="object")for(let v in r.elementAttributes)v.charAt(0)=="+"?(v=v.slice(1),c.setAttribute(v,c.getAttribute(v)+r.elementAttributes["+"+v])):c.setAttribute(v,r.elementAttributes[v]);return n.style.padding="4px 4px",h=Math.min(parseFloat(h),a),h=Math.max(parseFloat(h),o),h=Math.round((h-o)/l),c.style.width=h+"%",n.setAttribute("aria-valuemin",o),n.setAttribute("aria-valuemax",a),c.appendChild(u),u.addEventListener("mousedown",function(v){f=v.screenX,d=c.offsetWidth}),u.addEventListener("mouseover",function(){u.style.cursor="ew-resize"}),n.addEventListener("mousemove",function(v){f&&(c.style.width=d+v.screenX-f+"px")}),n.addEventListener("mouseup",function(v){f&&(v.stopPropagation(),v.stopImmediatePropagation(),f=!1,d=!1,p())}),n.addEventListener("keydown",function(v){switch(v.keyCode){case 39:v.preventDefault(),c.style.width=c.clientWidth+n.clientWidth/100+"px";break;case 37:v.preventDefault(),c.style.width=c.clientWidth-n.clientWidth/100+"px";break;case 9:case 13:p();break;case 27:i();break}}),n.addEventListener("blur",function(){i()}),c}function WV(s,t,e,i,r){var n=s.getValue(),a=document.createElement("input"),o=r.tristate,l=typeof r.indeterminateValue>"u"?null:r.indeterminateValue,h=!1,u=Object.keys(r).includes("trueValue"),c=Object.keys(r).includes("falseValue");if(a.setAttribute("type","checkbox"),a.style.marginTop="5px",a.style.boxSizing="border-box",r.elementAttributes&&typeof r.elementAttributes=="object")for(let d in r.elementAttributes)d.charAt(0)=="+"?(d=d.slice(1),a.setAttribute(d,a.getAttribute(d)+r.elementAttributes["+"+d])):a.setAttribute(d,r.elementAttributes[d]);a.value=n,o&&(typeof n>"u"||n===l||n==="")&&(h=!0,a.indeterminate=!0),this.table.browser!="firefox"&&this.table.browser!="safari"&&t(function(){s.getType()==="cell"&&a.focus({preventScroll:!0})}),a.checked=u?n===r.trueValue:n===!0||n==="true"||n==="True"||n===1;function f(d){var p=a.checked;return u&&p?p=r.trueValue:c&&!p&&(p=r.falseValue),o?d?h?l:p:a.checked&&!h?(a.checked=!1,a.indeterminate=!0,h=!0,l):(h=!1,p):p}return a.addEventListener("change",function(d){e(f())}),a.addEventListener("blur",function(d){e(f(!0))}),a.addEventListener("keydown",function(d){d.keyCode==13&&e(f()),d.keyCode==27&&i()}),a}function zV(s,t,e,i,r){var n=s._getSelf().column,a,o,l;function h(u){var c=u.getValue(),f="input";switch(typeof c){case"number":f="number";break;case"boolean":f="tickCross";break;case"string":c.includes("\n")&&(f="textarea");break}return f}return a=r.editorLookup?r.editorLookup(s):h(s),r.paramsLookup&&(l=typeof r.paramsLookup=="function"?r.paramsLookup(a,s):r.paramsLookup[a]),o=this.table.modules.edit.lookupEditor(a,n),o.call(this,s,t,e,i,l||{})}var jV={input:LV,textarea:RV,number:IV,range:_V,date:FV,time:NV,datetime:MV,list:BV,star:HV,progress:VV,tickCross:WV,adaptable:zV};const Wl=class Wl extends pt{constructor(t){super(t),this.currentCell=!1,this.mouseClick=!1,this.recursionBlock=!1,this.invalidEdit=!1,this.editedCells=[],this.convertEmptyValues=!1,this.editors=Wl.editors,this.registerTableOption("editTriggerEvent","focus"),this.registerTableOption("editorEmptyValue"),this.registerTableOption("editorEmptyValueFunc",this.emptyValueCheck.bind(this)),this.registerColumnOption("editable"),this.registerColumnOption("editor"),this.registerColumnOption("editorParams"),this.registerColumnOption("editorEmptyValue"),this.registerColumnOption("editorEmptyValueFunc"),this.registerColumnOption("cellEditing"),this.registerColumnOption("cellEdited"),this.registerColumnOption("cellEditCancelled"),this.registerTableFunction("getEditedCells",this.getEditedCells.bind(this)),this.registerTableFunction("clearCellEdited",this.clearCellEdited.bind(this)),this.registerTableFunction("navigatePrev",this.navigatePrev.bind(this)),this.registerTableFunction("navigateNext",this.navigateNext.bind(this)),this.registerTableFunction("navigateLeft",this.navigateLeft.bind(this)),this.registerTableFunction("navigateRight",this.navigateRight.bind(this)),this.registerTableFunction("navigateUp",this.navigateUp.bind(this)),this.registerTableFunction("navigateDown",this.navigateDown.bind(this)),this.registerComponentFunction("cell","isEdited",this.cellIsEdited.bind(this)),this.registerComponentFunction("cell","clearEdited",this.clearEdited.bind(this)),this.registerComponentFunction("cell","edit",this.editCell.bind(this)),this.registerComponentFunction("cell","cancelEdit",this.cellCancelEdit.bind(this)),this.registerComponentFunction("cell","navigatePrev",this.navigatePrev.bind(this)),this.registerComponentFunction("cell","navigateNext",this.navigateNext.bind(this)),this.registerComponentFunction("cell","navigateLeft",this.navigateLeft.bind(this)),this.registerComponentFunction("cell","navigateRight",this.navigateRight.bind(this)),this.registerComponentFunction("cell","navigateUp",this.navigateUp.bind(this)),this.registerComponentFunction("cell","navigateDown",this.navigateDown.bind(this))}initialize(){this.subscribe("cell-init",this.bindEditor.bind(this)),this.subscribe("cell-delete",this.clearEdited.bind(this)),this.subscribe("cell-value-changed",this.updateCellClass.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("column-delete",this.columnDeleteCheck.bind(this)),this.subscribe("row-deleting",this.rowDeleteCheck.bind(this)),this.subscribe("row-layout",this.rowEditableCheck.bind(this)),this.subscribe("data-refreshing",this.cancelEdit.bind(this)),this.subscribe("clipboard-paste",this.pasteBlocker.bind(this)),this.subscribe("keybinding-nav-prev",this.navigatePrev.bind(this,void 0)),this.subscribe("keybinding-nav-next",this.keybindingNavigateNext.bind(this)),this.subscribe("keybinding-nav-up",this.navigateUp.bind(this,void 0)),this.subscribe("keybinding-nav-down",this.navigateDown.bind(this,void 0)),Object.keys(this.table.options).includes("editorEmptyValue")&&(this.convertEmptyValues=!0)}pasteBlocker(t){if(this.currentCell)return!0}keybindingNavigateNext(t){var e=this.currentCell,i=this.options("tabEndNewRow");e&&(this.navigateNext(e,t)||i&&(e.getElement().firstChild.blur(),this.invalidEdit||(i===!0?i=this.table.addRow({}):typeof i=="function"?i=this.table.addRow(i(e.row.getComponent())):i=this.table.addRow(Object.assign({},i)),i.then(()=>{setTimeout(()=>{e.getComponent().navigateNext()})}))))}cellIsEdited(t){return!!t.modules.edit&&t.modules.edit.edited}cellCancelEdit(t){t===this.currentCell?this.table.modules.edit.cancelEdit():console.warn("Cancel Editor Error - This cell is not currently being edited ")}updateCellClass(t){this.allowEdit(t)?t.getElement().classList.add("tabulator-editable"):t.getElement().classList.remove("tabulator-editable")}clearCellEdited(t){t||(t=this.table.modules.edit.getEditedCells()),Array.isArray(t)||(t=[t]),t.forEach(e=>{this.table.modules.edit.clearEdited(e._getSelf())})}navigatePrev(t=this.currentCell,e){var i,r;if(t){if(e&&e.preventDefault(),i=this.navigateLeft(),i)return!0;if(r=this.table.rowManager.prevDisplayRow(t.row,!0),r&&(i=this.findPrevEditableCell(r,r.cells.length),i))return i.getComponent().edit(),!0}return!1}navigateNext(t=this.currentCell,e){var i,r;if(t){if(e&&e.preventDefault(),i=this.navigateRight(),i)return!0;if(r=this.table.rowManager.nextDisplayRow(t.row,!0),r&&(i=this.findNextEditableCell(r,-1),i))return i.getComponent().edit(),!0}return!1}navigateLeft(t=this.currentCell,e){var i,r;return t&&(e&&e.preventDefault(),i=t.getIndex(),r=this.findPrevEditableCell(t.row,i),r)?(r.getComponent().edit(),!0):!1}navigateRight(t=this.currentCell,e){var i,r;return t&&(e&&e.preventDefault(),i=t.getIndex(),r=this.findNextEditableCell(t.row,i),r)?(r.getComponent().edit(),!0):!1}navigateUp(t=this.currentCell,e){var i,r;return t&&(e&&e.preventDefault(),i=t.getIndex(),r=this.table.rowManager.prevDisplayRow(t.row,!0),r)?(r.cells[i].getComponent().edit(),!0):!1}navigateDown(t=this.currentCell,e){var i,r;return t&&(e&&e.preventDefault(),i=t.getIndex(),r=this.table.rowManager.nextDisplayRow(t.row,!0),r)?(r.cells[i].getComponent().edit(),!0):!1}findNextEditableCell(t,e){var i=!1;if(e<t.cells.length-1)for(var r=e+1;r<t.cells.length;r++){let n=t.cells[r];if(n.column.modules.edit&&$t.elVisible(n.getElement())&&this.allowEdit(n)){i=n;break}}return i}findPrevEditableCell(t,e){var i=!1;if(e>0)for(var r=e-1;r>=0;r--){let n=t.cells[r];if(n.column.modules.edit&&$t.elVisible(n.getElement())&&this.allowEdit(n)){i=n;break}}return i}initializeColumnCheck(t){typeof t.definition.editor<"u"&&this.initializeColumn(t)}columnDeleteCheck(t){this.currentCell&&this.currentCell.column===t&&this.cancelEdit()}rowDeleteCheck(t){this.currentCell&&this.currentCell.row===t&&this.cancelEdit()}rowEditableCheck(t){t.getCells().forEach(e=>{e.column.modules.edit&&typeof e.column.modules.edit.check=="function"&&this.updateCellClass(e)})}initializeColumn(t){var e=Object.keys(t.definition).includes("editorEmptyValue"),i={editor:!1,blocked:!1,check:t.definition.editable,params:t.definition.editorParams||{},convertEmptyValues:e,editorEmptyValue:t.definition.editorEmptyValue,editorEmptyValueFunc:t.definition.editorEmptyValueFunc};i.editor=this.lookupEditor(t.definition.editor,t),i.editor&&(t.modules.edit=i)}lookupEditor(t,e){var i;switch(typeof t){case"string":this.editors[t]?i=this.editors[t]:console.warn("Editor Error - No such editor found: ",t);break;case"function":i=t;break;case"boolean":t===!0&&(typeof e.definition.formatter!="function"?this.editors[e.definition.formatter]?i=this.editors[e.definition.formatter]:i=this.editors.input:console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",e.definition.formatter));break}return i}getCurrentCell(){return this.currentCell?this.currentCell.getComponent():!1}clearEditor(t){var e=this.currentCell,i;if(this.invalidEdit=!1,e){for(this.currentCell=!1,i=e.getElement(),this.dispatch("edit-editor-clear",e,t),i.classList.remove("tabulator-editing");i.firstChild;)i.removeChild(i.firstChild);e.row.getElement().classList.remove("tabulator-editing"),e.table.element.classList.remove("tabulator-editing")}}cancelEdit(){if(this.currentCell){var t=this.currentCell,e=this.currentCell.getComponent();this.clearEditor(!0),t.setValueActual(t.getValue()),t.cellRendered(),(t.column.definition.editor=="textarea"||t.column.definition.variableHeight)&&t.row.normalizeHeight(!0),t.column.definition.cellEditCancelled&&t.column.definition.cellEditCancelled.call(this.table,e),this.dispatch("edit-cancelled",t),this.dispatchExternal("cellEditCancelled",e)}}bindEditor(t){if(t.column.modules.edit){var e=this,i=t.getElement(!0);this.updateCellClass(t),i.setAttribute("tabindex",0),i.addEventListener("mousedown",function(r){r.button===2?r.preventDefault():e.mouseClick=!0}),this.options("editTriggerEvent")==="dblclick"&&i.addEventListener("dblclick",function(r){i.classList.contains("tabulator-editing")||(i.focus({preventScroll:!0}),e.edit(t,r,!1))}),(this.options("editTriggerEvent")==="focus"||this.options("editTriggerEvent")==="click")&&i.addEventListener("click",function(r){i.classList.contains("tabulator-editing")||(i.focus({preventScroll:!0}),e.edit(t,r,!1))}),this.options("editTriggerEvent")==="focus"&&i.addEventListener("focus",function(r){e.recursionBlock||e.edit(t,r,!1)})}}focusCellNoEvent(t,e){this.recursionBlock=!0,e&&this.table.browser==="ie"||t.getElement().focus({preventScroll:!0}),this.recursionBlock=!1}editCell(t,e){this.focusCellNoEvent(t),this.edit(t,!1,e)}focusScrollAdjust(t){if(this.table.rowManager.getRenderMode()=="virtual"){var e=this.table.rowManager.element.scrollTop,i=this.table.rowManager.element.clientHeight+this.table.rowManager.element.scrollTop,r=t.row.getElement();r.offsetTop<e?this.table.rowManager.element.scrollTop-=e-r.offsetTop:r.offsetTop+r.offsetHeight>i&&(this.table.rowManager.element.scrollTop+=r.offsetTop+r.offsetHeight-i);var n=this.table.rowManager.element.scrollLeft,a=this.table.rowManager.element.clientWidth+this.table.rowManager.element.scrollLeft,o=t.getElement();this.table.modExists("frozenColumns")&&(n+=parseInt(this.table.modules.frozenColumns.leftMargin||0),a-=parseInt(this.table.modules.frozenColumns.rightMargin||0)),this.table.options.renderHorizontal==="virtual"&&(n-=parseInt(this.table.columnManager.renderer.vDomPadLeft),a-=parseInt(this.table.columnManager.renderer.vDomPadLeft)),o.offsetLeft<n?this.table.rowManager.element.scrollLeft-=n-o.offsetLeft:o.offsetLeft+o.offsetWidth>a&&(this.table.rowManager.element.scrollLeft+=o.offsetLeft+o.offsetWidth-a)}}allowEdit(t){var e=!!t.column.modules.edit;if(t.column.modules.edit)switch(typeof t.column.modules.edit.check){case"function":t.row.initialized&&(e=t.column.modules.edit.check(t.getComponent()));break;case"string":e=!!t.row.data[t.column.modules.edit.check];break;case"boolean":e=t.column.modules.edit.check;break}return e}edit(t,e,i){var r=this,n=!0,a=function(){},o=t.getElement(),l=!1,h,u,c;if(this.currentCell){!this.invalidEdit&&this.currentCell!==t&&this.cancelEdit();return}function f(b){if(r.currentCell===t&&!l){var C=r.chain("edit-success",[t,b],!0,!0);return C===!0||r.table.options.validationMode==="highlight"?(l=!0,r.clearEditor(),t.modules.edit||(t.modules.edit={}),t.modules.edit.edited=!0,r.editedCells.indexOf(t)==-1&&r.editedCells.push(t),b=r.transformEmptyValues(b,t),t.setValue(b,!0),C===!0):(l=!0,r.invalidEdit=!0,r.focusCellNoEvent(t,!0),a(),setTimeout(()=>{l=!1},10),!1)}}function d(){r.currentCell===t&&!l&&r.cancelEdit()}function p(b){a=b}if(t.column.modules.edit.blocked)return this.mouseClick=!1,this.blur(o),!1;if(e&&e.stopPropagation(),n=this.allowEdit(t),n||i){if(r.cancelEdit(),r.currentCell=t,this.focusScrollAdjust(t),u=t.getComponent(),this.mouseClick&&(this.mouseClick=!1,t.column.definition.cellClick&&t.column.definition.cellClick.call(this.table,e,u)),t.column.definition.cellEditing&&t.column.definition.cellEditing.call(this.table,u),this.dispatch("cell-editing",t),this.dispatchExternal("cellEditing",u),c=typeof t.column.modules.edit.params=="function"?t.column.modules.edit.params(u):t.column.modules.edit.params,h=t.column.modules.edit.editor.call(r,u,p,f,d,c),this.currentCell&&h!==!1)if(h instanceof Node){for(o.classList.add("tabulator-editing"),t.row.getElement().classList.add("tabulator-editing"),t.table.element.classList.add("tabulator-editing");o.firstChild;)o.removeChild(o.firstChild);o.appendChild(h),a();for(var v=o.children,g=0;g<v.length;g++)v[g].addEventListener("click",function(b){b.stopPropagation()})}else return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:",h),this.blur(o),!1;else return this.blur(o),!1;return!0}else return this.mouseClick=!1,this.blur(o),!1}emptyValueCheck(t){return t===""||t===null||typeof t>"u"}transformEmptyValues(t,e){var i=e.column.modules.edit,r=i.convertEmptyValues||this.convertEmptyValues,n;return r&&(n=i.editorEmptyValueFunc||this.options("editorEmptyValueFunc"),n&&n(t)&&(t=i.convertEmptyValues?i.editorEmptyValue:this.options("editorEmptyValue"))),t}blur(t){this.confirm("edit-blur",[t])||t.blur()}getEditedCells(){var t=[];return this.editedCells.forEach(e=>{t.push(e.getComponent())}),t}clearEdited(t){var e;t.modules.edit&&t.modules.edit.edited&&(t.modules.edit.edited=!1,this.dispatch("edit-edited-clear",t)),e=this.editedCells.indexOf(t),e>-1&&this.editedCells.splice(e,1)}};Ne(Wl,"moduleName","edit"),Ne(Wl,"editors",jV);let Cp=Wl;class Cy{constructor(t,e,i,r){this.type=t,this.columns=e,this.component=i||!1,this.indent=r||0}}class Rd{constructor(t,e,i,r,n){this.value=t,this.component=e||!1,this.width=i,this.height=r,this.depth=n}}var UV={},$V={visible:function(){return this.rowManager.getVisibleRows(!1,!0)},all:function(){return this.rowManager.rows},selected:function(){return this.modules.selectRow.selectedRows},active:function(){return this.options.pagination?this.rowManager.getDisplayRows(this.rowManager.displayRows.length-2):this.rowManager.getDisplayRows()}};const gn=class gn extends pt{constructor(t){super(t),this.config={},this.cloneTableStyle=!0,this.colVisProp="",this.colVisPropAttach="",this.registerTableOption("htmlOutputConfig",!1),this.registerColumnOption("htmlOutput"),this.registerColumnOption("titleHtmlOutput")}initialize(){this.registerTableFunction("getHtml",this.getHtml.bind(this))}generateExportList(t,e,i,r){var n,a,o,l;return this.cloneTableStyle=e,this.config=t||{},this.colVisProp=r,this.colVisPropAttach=this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1),l=gn.columnLookups[i],l&&(o=l.call(this.table),o=o.filter(h=>this.columnVisCheck(h))),n=this.config.columnHeaders!==!1?this.headersToExportRows(this.generateColumnGroupHeaders(o)):[],o&&(o=o.map(h=>h.getComponent())),a=this.bodyToExportRows(this.rowLookup(i),o),n.concat(a)}generateTable(t,e,i,r){var n=this.generateExportList(t,e,i,r);return this.generateTableElement(n)}rowLookup(t){var e=[],i;return typeof t=="function"?t.call(this.table).forEach(r=>{r=this.table.rowManager.findRow(r),r&&e.push(r)}):(i=gn.rowLookups[t]||gn.rowLookups.active,e=i.call(this.table)),Object.assign([],e)}generateColumnGroupHeaders(t){var e=[];return t||(t=this.config.columnGroups!==!1?this.table.columnManager.columns:this.table.columnManager.columnsByIndex),t.forEach(i=>{var r=this.processColumnGroup(i);r&&e.push(r)}),e}processColumnGroup(t){var e=t.columns,i=0,r=t.definition["title"+this.colVisPropAttach]||t.definition.title,n={title:r,column:t,depth:1};if(e.length){if(n.subGroups=[],n.width=0,e.forEach(a=>{var o=this.processColumnGroup(a);o&&(n.width+=o.width,n.subGroups.push(o),o.depth>i&&(i=o.depth))}),n.depth+=i,!n.width)return!1}else if(this.columnVisCheck(t))n.width=1;else return!1;return n}columnVisCheck(t){var e=t.definition[this.colVisProp];return this.config.rowHeaders===!1&&t.isRowHeader?!1:(typeof e=="function"&&(e=e.call(this.table,t.getComponent())),e===!1||e===!0?e:t.visible&&t.field)}headersToExportRows(t){var e=[],i=0,r=[];function n(a,o){var l=i-o;if(typeof e[o]>"u"&&(e[o]=[]),a.height=a.subGroups?1:l-a.depth+1,e[o].push(a),a.height>1)for(let h=1;h<a.height;h++)typeof e[o+h]>"u"&&(e[o+h]=[]),e[o+h].push(!1);if(a.width>1)for(let h=1;h<a.width;h++)e[o].push(!1);a.subGroups&&a.subGroups.forEach(function(h){n(h,o+1)})}return t.forEach(function(a){a.depth>i&&(i=a.depth)}),t.forEach(function(a){n(a,0)}),e.forEach(a=>{var o=[];a.forEach(l=>{if(l){let h=typeof l.title>"u"?"":l.title;o.push(new Rd(h,l.column.getComponent(),l.width,l.height,l.depth))}else o.push(null)}),r.push(new Cy("header",o))}),r}bodyToExportRows(t,e=[]){var i=[];return e.length===0&&this.table.columnManager.columnsByIndex.forEach(r=>{this.columnVisCheck(r)&&e.push(r.getComponent())}),this.config.columnCalcs!==!1&&this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&t.unshift(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&t.push(this.table.modules.columnCalcs.botRow)),t=t.filter(r=>{switch(r.type){case"group":return this.config.rowGroups!==!1;case"calc":return this.config.columnCalcs!==!1;case"row":return!(this.table.options.dataTree&&this.config.dataTree===!1&&r.modules.dataTree.parent)}return!0}),t.forEach((r,n)=>{var a=r.getData(this.colVisProp),o=[],l=0;switch(r.type){case"group":l=r.level,o.push(new Rd(r.key,r.getComponent(),e.length,1));break;case"calc":case"row":e.forEach(h=>{o.push(new Rd(h._column.getFieldValue(a),h,1,1))}),this.table.options.dataTree&&this.config.dataTree!==!1&&(l=r.modules.dataTree.index);break}i.push(new Cy(r.type,o,r.getComponent(),l))}),i}generateTableElement(t){var e=document.createElement("table"),i=document.createElement("thead"),r=document.createElement("tbody"),n=this.lookupTableStyles(),a=this.table.options["rowFormatter"+this.colVisPropAttach],o={};return o.rowFormatter=a!==null?a:this.table.options.rowFormatter,this.table.options.dataTree&&this.config.dataTree!==!1&&this.table.modExists("columnCalcs")&&(o.treeElementField=this.table.modules.dataTree.elementField),o.groupHeader=this.table.options["groupHeader"+this.colVisPropAttach],o.groupHeader&&!Array.isArray(o.groupHeader)&&(o.groupHeader=[o.groupHeader]),e.classList.add("tabulator-print-table"),this.mapElementStyles(this.table.columnManager.getHeadersElement(),i,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),t.length>1e3&&console.warn("It may take a long time to render an HTML table with more than 1000 rows"),t.forEach((l,h)=>{let u;switch(l.type){case"header":i.appendChild(this.generateHeaderElement(l,o,n));break;case"group":r.appendChild(this.generateGroupElement(l,o,n));break;case"calc":r.appendChild(this.generateCalcElement(l,o,n));break;case"row":u=this.generateRowElement(l,o,n),this.mapElementStyles(h%2&&n.evenRow?n.evenRow:n.oddRow,u,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),r.appendChild(u);break}}),i.innerHTML&&e.appendChild(i),e.appendChild(r),this.mapElementStyles(this.table.element,e,["border-top","border-left","border-right","border-bottom"]),e}lookupTableStyles(){var t={};return this.cloneTableStyle&&window.getComputedStyle&&(t.oddRow=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),t.evenRow=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),t.calcRow=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),t.firstRow=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),t.firstGroup=this.table.element.getElementsByClassName("tabulator-group")[0],t.firstRow&&(t.styleCells=t.firstRow.getElementsByClassName("tabulator-cell"),t.styleRowHeader=t.firstRow.getElementsByClassName("tabulator-row-header")[0],t.firstCell=t.styleCells[0],t.lastCell=t.styleCells[t.styleCells.length-1])),t}generateHeaderElement(t,e,i){var r=document.createElement("tr");return t.columns.forEach(n=>{if(n){var a=document.createElement("th"),o=n.component._column.definition.cssClass?n.component._column.definition.cssClass.split(" "):[];a.colSpan=n.width,a.rowSpan=n.height,a.innerHTML=n.value,this.cloneTableStyle&&(a.style.boxSizing="border-box"),o.forEach(function(l){a.classList.add(l)}),this.mapElementStyles(n.component.getElement(),a,["text-align","border-left","border-right","background-color","color","font-weight","font-family","font-size"]),this.mapElementStyles(n.component._column.contentElement,a,["padding-top","padding-left","padding-right","padding-bottom"]),n.component._column.visible?this.mapElementStyles(n.component.getElement(),a,["width"]):n.component._column.definition.width&&(a.style.width=n.component._column.definition.width+"px"),n.component._column.parent&&n.component._column.parent.isGroup?this.mapElementStyles(n.component._column.parent.groupElement,a,["border-top"]):this.mapElementStyles(n.component.getElement(),a,["border-top"]),n.component._column.isGroup?this.mapElementStyles(n.component.getElement(),a,["border-bottom"]):this.mapElementStyles(this.table.columnManager.getElement(),a,["border-bottom"]),r.appendChild(a)}}),r}generateGroupElement(t,e,i){var r=document.createElement("tr"),n=document.createElement("td"),a=t.columns[0];return r.classList.add("tabulator-print-table-row"),e.groupHeader&&e.groupHeader[t.indent]?a.value=e.groupHeader[t.indent](a.value,t.component._group.getRowCount(),t.component._group.getData(),t.component):e.groupHeader!==!1&&(a.value=t.component._group.generator(a.value,t.component._group.getRowCount(),t.component._group.getData(),t.component)),n.colSpan=a.width,n.innerHTML=a.value,r.classList.add("tabulator-print-table-group"),r.classList.add("tabulator-group-level-"+t.indent),a.component.isVisible()&&r.classList.add("tabulator-group-visible"),this.mapElementStyles(i.firstGroup,r,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),this.mapElementStyles(i.firstGroup,n,["padding-top","padding-left","padding-right","padding-bottom"]),r.appendChild(n),r}generateCalcElement(t,e,i){var r=this.generateRowElement(t,e,i);return r.classList.add("tabulator-print-table-calcs"),this.mapElementStyles(i.calcRow,r,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),r}generateRowElement(t,e,i){var r=document.createElement("tr");if(r.classList.add("tabulator-print-table-row"),t.columns.forEach((n,a)=>{if(n){var o=document.createElement("td"),l=n.component._column,h=this.table,u=h.columnManager.findColumnIndex(l),c=n.value,f,d,p={modules:{},getValue:function(){return c},getField:function(){return l.definition.field},getElement:function(){return o},getType:function(){return"cell"},getColumn:function(){return l.getComponent()},getData:function(){return t.component.getData()},getRow:function(){return t.component},getTable:function(){return h},getComponent:function(){return p},column:l},v=l.definition.cssClass?l.definition.cssClass.split(" "):[];if(v.forEach(function(g){o.classList.add(g)}),this.table.modExists("format")&&this.config.formatCells!==!1)c=this.table.modules.format.formatExportValue(p,this.colVisProp);else switch(typeof c){case"object":c=c!==null?JSON.stringify(c):"";break;case"undefined":c="";break}c instanceof Node?o.appendChild(c):o.innerHTML=c,d=["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","text-align"],l.isRowHeader?(f=i.styleRowHeader,d.push("background-color")):f=i.styleCells&&i.styleCells[u]?i.styleCells[u]:i.firstCell,f&&(this.mapElementStyles(f,o,d),l.definition.align&&(o.style.textAlign=l.definition.align)),this.table.options.dataTree&&this.config.dataTree!==!1&&(e.treeElementField&&e.treeElementField==l.field||!e.treeElementField&&a==0)&&(t.component._row.modules.dataTree.controlEl&&o.insertBefore(t.component._row.modules.dataTree.controlEl.cloneNode(!0),o.firstChild),t.component._row.modules.dataTree.branchEl&&o.insertBefore(t.component._row.modules.dataTree.branchEl.cloneNode(!0),o.firstChild)),r.appendChild(o),p.modules.format&&p.modules.format.renderedCallback&&p.modules.format.renderedCallback()}}),e.rowFormatter&&t.type==="row"&&this.config.formatCells!==!1){let n=Object.assign(t.component);n.getElement=function(){return r},e.rowFormatter(t.component)}return r}generateHTMLTable(t){var e=document.createElement("div");return e.appendChild(this.generateTableElement(t)),e.innerHTML}getHtml(t,e,i,r){var n=this.generateExportList(i||this.table.options.htmlOutputConfig,e,t,r||"htmlOutput");return this.generateHTMLTable(n)}mapElementStyles(t,e,i){if(this.cloneTableStyle&&t&&e){var r={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var n=window.getComputedStyle(t);i.forEach(function(a){e.style[r[a]]||(e.style[r[a]]=n.getPropertyValue(a))})}}}};Ne(gn,"moduleName","export"),Ne(gn,"columnLookups",UV),Ne(gn,"rowLookups",$V);let wp=gn;var qV={"=":function(s,t,e,i){return t==s},"<":function(s,t,e,i){return t<s},"<=":function(s,t,e,i){return t<=s},">":function(s,t,e,i){return t>s},">=":function(s,t,e,i){return t>=s},"!=":function(s,t,e,i){return t!=s},regex:function(s,t,e,i){return typeof s=="string"&&(s=new RegExp(s)),s.test(t)},like:function(s,t,e,i){return s===null||typeof s>"u"?t===s:typeof t<"u"&&t!==null?String(t).toLowerCase().indexOf(s.toLowerCase())>-1:!1},keywords:function(s,t,e,i){var r=s.toLowerCase().split(typeof i.separator>"u"?" ":i.separator),n=String(t===null||typeof t>"u"?"":t).toLowerCase(),a=[];return r.forEach(o=>{n.includes(o)&&a.push(!0)}),i.matchAll?a.length===r.length:!!a.length},starts:function(s,t,e,i){return s===null||typeof s>"u"?t===s:typeof t<"u"&&t!==null?String(t).toLowerCase().startsWith(s.toLowerCase()):!1},ends:function(s,t,e,i){return s===null||typeof s>"u"?t===s:typeof t<"u"&&t!==null?String(t).toLowerCase().endsWith(s.toLowerCase()):!1},in:function(s,t,e,i){return Array.isArray(s)?s.length?s.indexOf(t)>-1:!0:(console.warn("Filter Error - filter value is not an array:",s),!1)}};const Xs=class Xs extends pt{constructor(t){super(t),this.filterList=[],this.headerFilters={},this.headerFilterColumns=[],this.prevHeaderFilterChangeCheck="",this.prevHeaderFilterChangeCheck="{}",this.changed=!1,this.tableInitialized=!1,this.registerTableOption("filterMode","local"),this.registerTableOption("initialFilter",!1),this.registerTableOption("initialHeaderFilter",!1),this.registerTableOption("headerFilterLiveFilterDelay",300),this.registerTableOption("placeholderHeaderFilter",!1),this.registerColumnOption("headerFilter"),this.registerColumnOption("headerFilterPlaceholder"),this.registerColumnOption("headerFilterParams"),this.registerColumnOption("headerFilterEmptyCheck"),this.registerColumnOption("headerFilterFunc"),this.registerColumnOption("headerFilterFuncParams"),this.registerColumnOption("headerFilterLiveFilter"),this.registerTableFunction("searchRows",this.searchRows.bind(this)),this.registerTableFunction("searchData",this.searchData.bind(this)),this.registerTableFunction("setFilter",this.userSetFilter.bind(this)),this.registerTableFunction("refreshFilter",this.userRefreshFilter.bind(this)),this.registerTableFunction("addFilter",this.userAddFilter.bind(this)),this.registerTableFunction("getFilters",this.getFilters.bind(this)),this.registerTableFunction("setHeaderFilterFocus",this.userSetHeaderFilterFocus.bind(this)),this.registerTableFunction("getHeaderFilterValue",this.userGetHeaderFilterValue.bind(this)),this.registerTableFunction("setHeaderFilterValue",this.userSetHeaderFilterValue.bind(this)),this.registerTableFunction("getHeaderFilters",this.getHeaderFilters.bind(this)),this.registerTableFunction("removeFilter",this.userRemoveFilter.bind(this)),this.registerTableFunction("clearFilter",this.userClearFilter.bind(this)),this.registerTableFunction("clearHeaderFilter",this.userClearHeaderFilter.bind(this)),this.registerComponentFunction("column","headerFilterFocus",this.setHeaderFilterFocus.bind(this)),this.registerComponentFunction("column","reloadHeaderFilter",this.reloadHeaderFilter.bind(this)),this.registerComponentFunction("column","getHeaderFilterValue",this.getHeaderFilterValue.bind(this)),this.registerComponentFunction("column","setHeaderFilterValue",this.setHeaderFilterValue.bind(this))}initialize(){this.subscribe("column-init",this.initializeColumnHeaderFilter.bind(this)),this.subscribe("column-width-fit-before",this.hideHeaderFilterElements.bind(this)),this.subscribe("column-width-fit-after",this.showHeaderFilterElements.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.subscribe("placeholder",this.generatePlaceholder.bind(this)),this.table.options.filterMode==="remote"&&this.subscribe("data-params",this.remoteFilterParams.bind(this)),this.registerDataHandler(this.filter.bind(this),10)}tableBuilt(){this.table.options.initialFilter&&this.setFilter(this.table.options.initialFilter),this.table.options.initialHeaderFilter&&this.table.options.initialHeaderFilter.forEach(t=>{var e=this.table.columnManager.findColumn(t.field);if(e)this.setHeaderFilterValue(e,t.value);else return console.warn("Column Filter Error - No matching column found:",t.field),!1}),this.tableInitialized=!0}remoteFilterParams(t,e,i,r){return r.filter=this.getFilters(!0,!0),r}generatePlaceholder(t){if(this.table.options.placeholderHeaderFilter&&Object.keys(this.headerFilters).length)return this.table.options.placeholderHeaderFilter}userSetFilter(t,e,i,r){this.setFilter(t,e,i,r),this.refreshFilter()}userRefreshFilter(){this.refreshFilter()}userAddFilter(t,e,i,r){this.addFilter(t,e,i,r),this.refreshFilter()}userSetHeaderFilterFocus(t){var e=this.table.columnManager.findColumn(t);if(e)this.setHeaderFilterFocus(e);else return console.warn("Column Filter Focus Error - No matching column found:",t),!1}userGetHeaderFilterValue(t){var e=this.table.columnManager.findColumn(t);if(e)return this.getHeaderFilterValue(e);console.warn("Column Filter Error - No matching column found:",t)}userSetHeaderFilterValue(t,e){var i=this.table.columnManager.findColumn(t);if(i)this.setHeaderFilterValue(i,e);else return console.warn("Column Filter Error - No matching column found:",t),!1}userRemoveFilter(t,e,i){this.removeFilter(t,e,i),this.refreshFilter()}userClearFilter(t){this.clearFilter(t),this.refreshFilter()}userClearHeaderFilter(){this.clearHeaderFilter(),this.refreshFilter()}searchRows(t,e,i){return this.search("rows",t,e,i)}searchData(t,e,i){return this.search("data",t,e,i)}initializeColumnHeaderFilter(t){var e=t.definition;e.headerFilter&&this.initializeColumn(t)}initializeColumn(t,e){var i=this,r=t.getField();function n(a){var o=t.modules.filter.tagType=="input"&&t.modules.filter.attrType=="text"||t.modules.filter.tagType=="textarea"?"partial":"match",l="",h="",u;if(typeof t.modules.filter.prevSuccess>"u"||t.modules.filter.prevSuccess!==a){if(t.modules.filter.prevSuccess=a,t.modules.filter.emptyFunc(a))delete i.headerFilters[r];else{switch(t.modules.filter.value=a,typeof t.definition.headerFilterFunc){case"string":Xs.filters[t.definition.headerFilterFunc]?(l=t.definition.headerFilterFunc,u=function(c){var f=t.definition.headerFilterFuncParams||{},d=t.getFieldValue(c);return f=typeof f=="function"?f(a,d,c):f,Xs.filters[t.definition.headerFilterFunc](a,d,c,f)}):console.warn("Header Filter Error - Matching filter function not found: ",t.definition.headerFilterFunc);break;case"function":u=function(c){var f=t.definition.headerFilterFuncParams||{},d=t.getFieldValue(c);return f=typeof f=="function"?f(a,d,c):f,t.definition.headerFilterFunc(a,d,c,f)},l=u;break}if(!u)switch(o){case"partial":u=function(c){var f=t.getFieldValue(c);return typeof f<"u"&&f!==null?String(f).toLowerCase().indexOf(String(a).toLowerCase())>-1:!1},l="like";break;default:u=function(c){return t.getFieldValue(c)==a},l="="}i.headerFilters[r]={value:a,func:u,type:l}}t.modules.filter.value=a,h=JSON.stringify(i.headerFilters),i.prevHeaderFilterChangeCheck!==h&&(i.prevHeaderFilterChangeCheck=h,i.trackChanges(),i.refreshFilter())}return!0}t.modules.filter={success:n,attrType:!1,tagType:!1,emptyFunc:!1},this.generateHeaderFilterElement(t)}generateHeaderFilterElement(t,e,i){var r=this,n=t.modules.filter.success,a=t.getField(),o,l,h,u,c,f,d,p;t.modules.filter.value=e;function v(){}function g(b){p=b}if(t.modules.filter.headerElement&&t.modules.filter.headerElement.parentNode&&t.contentElement.removeChild(t.modules.filter.headerElement.parentNode),a){switch(t.modules.filter.emptyFunc=t.definition.headerFilterEmptyCheck||function(b){return!b&&b!==0},o=document.createElement("div"),o.classList.add("tabulator-header-filter"),typeof t.definition.headerFilter){case"string":r.table.modules.edit.editors[t.definition.headerFilter]?(l=r.table.modules.edit.editors[t.definition.headerFilter],(t.definition.headerFilter==="tick"||t.definition.headerFilter==="tickCross")&&!t.definition.headerFilterEmptyCheck&&(t.modules.filter.emptyFunc=function(b){return b!==!0&&b!==!1})):console.warn("Filter Error - Cannot build header filter, No such editor found: ",t.definition.editor);break;case"function":l=t.definition.headerFilter;break;case"boolean":t.modules.edit&&t.modules.edit.editor?l=t.modules.edit.editor:t.definition.formatter&&r.table.modules.edit.editors[t.definition.formatter]?(l=r.table.modules.edit.editors[t.definition.formatter],(t.definition.formatter==="tick"||t.definition.formatter==="tickCross")&&!t.definition.headerFilterEmptyCheck&&(t.modules.filter.emptyFunc=function(b){return b!==!0&&b!==!1})):l=r.table.modules.edit.editors.input;break}if(l){if(u={getValue:function(){return typeof e<"u"?e:""},getField:function(){return t.definition.field},getElement:function(){return o},getColumn:function(){return t.getComponent()},getTable:()=>this.table,getType:()=>"header",getRow:function(){return{normalizeHeight:function(){}}}},d=t.definition.headerFilterParams||{},d=typeof d=="function"?d.call(r.table,u):d,h=l.call(this.table.modules.edit,u,g,n,v,d),!h){console.warn("Filter Error - Cannot add filter to "+a+" column, editor returned a value of false");return}if(!(h instanceof Node)){console.warn("Filter Error - Cannot add filter to "+a+" column, editor should return an instance of Node, the editor returned:",h);return}r.langBind("headerFilters|columns|"+t.definition.field,function(b){h.setAttribute("placeholder",typeof b<"u"&&b?b:t.definition.headerFilterPlaceholder||r.langText("headerFilters|default"))}),h.addEventListener("click",function(b){b.stopPropagation(),h.focus()}),h.addEventListener("focus",b=>{var C=this.table.columnManager.contentsElement.scrollLeft,y=this.table.rowManager.element.scrollLeft;C!==y&&(this.table.rowManager.scrollHorizontal(C),this.table.columnManager.scrollHorizontal(C))}),c=!1,f=function(b){c&&clearTimeout(c),c=setTimeout(function(){n(h.value)},r.table.options.headerFilterLiveFilterDelay)},t.modules.filter.headerElement=h,t.modules.filter.attrType=h.hasAttribute("type")?h.getAttribute("type").toLowerCase():"",t.modules.filter.tagType=h.tagName.toLowerCase(),t.definition.headerFilterLiveFilter!==!1&&(t.definition.headerFilter==="autocomplete"||t.definition.headerFilter==="tickCross"||(t.definition.editor==="autocomplete"||t.definition.editor==="tickCross")&&t.definition.headerFilter===!0||(h.addEventListener("keyup",f),h.addEventListener("search",f),t.modules.filter.attrType=="number"&&h.addEventListener("change",function(b){n(h.value)}),t.modules.filter.attrType=="text"&&this.table.browser!=="ie"&&h.setAttribute("type","search")),(t.modules.filter.tagType=="input"||t.modules.filter.tagType=="select"||t.modules.filter.tagType=="textarea")&&h.addEventListener("mousedown",function(b){b.stopPropagation()})),o.appendChild(h),t.contentElement.appendChild(o),i||r.headerFilterColumns.push(t),p&&p()}}else console.warn("Filter Error - Cannot add header filter, column has no field set:",t.definition.title)}hideHeaderFilterElements(){this.headerFilterColumns.forEach(function(t){t.modules.filter&&t.modules.filter.headerElement&&(t.modules.filter.headerElement.style.display="none")})}showHeaderFilterElements(){this.headerFilterColumns.forEach(function(t){t.modules.filter&&t.modules.filter.headerElement&&(t.modules.filter.headerElement.style.display="")})}setHeaderFilterFocus(t){t.modules.filter&&t.modules.filter.headerElement?t.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",t.getField())}getHeaderFilterValue(t){if(t.modules.filter&&t.modules.filter.headerElement)return t.modules.filter.value;console.warn("Column Filter Error - No header filter set on column:",t.getField())}setHeaderFilterValue(t,e){t&&(t.modules.filter&&t.modules.filter.headerElement?(this.generateHeaderFilterElement(t,e,!0),t.modules.filter.success(e)):console.warn("Column Filter Error - No header filter set on column:",t.getField()))}reloadHeaderFilter(t){t&&(t.modules.filter&&t.modules.filter.headerElement?this.generateHeaderFilterElement(t,t.modules.filter.value,!0):console.warn("Column Filter Error - No header filter set on column:",t.getField()))}refreshFilter(){this.tableInitialized&&(this.table.options.filterMode==="remote"?this.reloadData(null,!1,!1):this.refreshData(!0))}trackChanges(){this.changed=!0,this.dispatch("filter-changed")}hasChanged(){var t=this.changed;return this.changed=!1,t}setFilter(t,e,i,r){this.filterList=[],Array.isArray(t)||(t=[{field:t,type:e,value:i,params:r}]),this.addFilter(t)}addFilter(t,e,i,r){var n=!1;Array.isArray(t)||(t=[{field:t,type:e,value:i,params:r}]),t.forEach(a=>{a=this.findFilter(a),a&&(this.filterList.push(a),n=!0)}),n&&this.trackChanges()}findFilter(t){var e;if(Array.isArray(t))return this.findSubFilters(t);var i=!1;return typeof t.field=="function"?i=function(r){return t.field(r,t.type||{})}:Xs.filters[t.type]?(e=this.table.columnManager.getColumnByField(t.field),e?i=function(r){return Xs.filters[t.type](t.value,e.getFieldValue(r),r,t.params||{})}:i=function(r){return Xs.filters[t.type](t.value,r[t.field],r,t.params||{})}):console.warn("Filter Error - No such filter type found, ignoring: ",t.type),t.func=i,t.func?t:!1}findSubFilters(t){var e=[];return t.forEach(i=>{i=this.findFilter(i),i&&e.push(i)}),e.length?e:!1}getFilters(t,e){var i=[];return t&&(i=this.getHeaderFilters()),e&&i.forEach(function(r){typeof r.type=="function"&&(r.type="function")}),i=i.concat(this.filtersToArray(this.filterList,e)),i}filtersToArray(t,e){var i=[];return t.forEach(r=>{var n;Array.isArray(r)?i.push(this.filtersToArray(r,e)):(n={field:r.field,type:r.type,value:r.value},e&&typeof n.type=="function"&&(n.type="function"),i.push(n))}),i}getHeaderFilters(){var t=[];for(var e in this.headerFilters)t.push({field:e,type:this.headerFilters[e].type,value:this.headerFilters[e].value});return t}removeFilter(t,e,i){Array.isArray(t)||(t=[{field:t,type:e,value:i}]),t.forEach(r=>{var n=-1;typeof r.field=="object"?n=this.filterList.findIndex(a=>r===a):n=this.filterList.findIndex(a=>r.field===a.field&&r.type===a.type&&r.value===a.value),n>-1?this.filterList.splice(n,1):console.warn("Filter Error - No matching filter type found, ignoring: ",r.type)}),this.trackChanges()}clearFilter(t){this.filterList=[],t&&this.clearHeaderFilter(),this.trackChanges()}clearHeaderFilter(){this.headerFilters={},this.prevHeaderFilterChangeCheck="{}",this.headerFilterColumns.forEach(t=>{typeof t.modules.filter.value<"u"&&delete t.modules.filter.value,t.modules.filter.prevSuccess=void 0,this.reloadHeaderFilter(t)}),this.trackChanges()}search(t,e,i,r){var n=[],a=[];return Array.isArray(e)||(e=[{field:e,type:i,value:r}]),e.forEach(o=>{o=this.findFilter(o),o&&a.push(o)}),this.table.rowManager.rows.forEach(o=>{var l=!0;a.forEach(h=>{this.filterRecurse(h,o.getData())||(l=!1)}),l&&n.push(t==="data"?o.getData("data"):o.getComponent())}),n}filter(t,e){var i=[],r=[];return this.subscribedExternal("dataFiltering")&&this.dispatchExternal("dataFiltering",this.getFilters(!0)),this.table.options.filterMode!=="remote"&&(this.filterList.length||Object.keys(this.headerFilters).length)?t.forEach(n=>{this.filterRow(n)&&i.push(n)}):i=t.slice(0),this.subscribedExternal("dataFiltered")&&(i.forEach(n=>{r.push(n.getComponent())}),this.dispatchExternal("dataFiltered",this.getFilters(!0),r)),i}filterRow(t,e){var i=!0,r=t.getData();this.filterList.forEach(a=>{this.filterRecurse(a,r)||(i=!1)});for(var n in this.headerFilters)this.headerFilters[n].func(r)||(i=!1);return i}filterRecurse(t,e){var i=!1;return Array.isArray(t)?t.forEach(r=>{this.filterRecurse(r,e)&&(i=!0)}):i=t.func(e),i}};Ne(Xs,"moduleName","filter"),Ne(Xs,"filters",qV);let Ep=Xs;function GV(s,t,e){return this.emptyToSpace(this.sanitizeHTML(s.getValue()))}function XV(s,t,e){return s.getValue()}function KV(s,t,e){return s.getElement().style.whiteSpace="pre-wrap",this.emptyToSpace(this.sanitizeHTML(s.getValue()))}function YV(s,t,e){var i=parseFloat(s.getValue()),r="",n,a,o,l,h,u=t.decimal||".",c=t.thousand||",",f=t.negativeSign||"-",d=t.symbol||"",p=!!t.symbolAfter,v=typeof t.precision<"u"?t.precision:2;if(isNaN(i))return this.emptyToSpace(this.sanitizeHTML(s.getValue()));if(i<0&&(i=Math.abs(i),r=f),n=v!==!1?i.toFixed(v):i,n=String(n).split("."),a=n[0],o=n.length>1?u+n[1]:"",t.thousand!==!1)for(l=/(\d+)(\d{3})/;l.test(a);)a=a.replace(l,"$1"+c+"$2");return h=a+o,r===!0?(h="("+h+")",p?h+d:d+h):p?r+h+d:r+d+h}function JV(s,t,e){var i=s.getValue(),r=t.urlPrefix||"",n=t.download,a=i,o=document.createElement("a"),l;function h(u,c){var f=u.shift(),d=c[f];return u.length&&typeof d=="object"?h(u,d):d}if(t.labelField&&(l=s.getData(),a=h(t.labelField.split(this.table.options.nestedFieldSeparator),l)),t.label)switch(typeof t.label){case"string":a=t.label;break;case"function":a=t.label(s);break}if(a){if(t.urlField&&(l=s.getData(),i=$t.retrieveNestedData(this.table.options.nestedFieldSeparator,t.urlField,l)),t.url)switch(typeof t.url){case"string":i=t.url;break;case"function":i=t.url(s);break}return o.setAttribute("href",r+i),t.target&&o.setAttribute("target",t.target),t.download&&(typeof n=="function"?n=n(s):n=n===!0?"":n,o.setAttribute("download",n)),o.innerHTML=this.emptyToSpace(this.sanitizeHTML(a)),o}else return"&nbsp;"}function QV(s,t,e){var i=document.createElement("img"),r=s.getValue();switch(t.urlPrefix&&(r=t.urlPrefix+s.getValue()),t.urlSuffix&&(r=r+t.urlSuffix),i.setAttribute("src",r),typeof t.height){case"number":i.style.height=t.height+"px";break;case"string":i.style.height=t.height;break}switch(typeof t.width){case"number":i.style.width=t.width+"px";break;case"string":i.style.width=t.width;break}return i.addEventListener("load",function(){s.getRow().normalizeHeight()}),i}function ZV(s,t,e){var i=s.getValue(),r=s.getElement(),n=t.allowEmpty,a=t.allowTruthy,o=Object.keys(t).includes("trueValue"),l=typeof t.tickElement<"u"?t.tickElement:'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>',h=typeof t.crossElement<"u"?t.crossElement:'<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';return o&&i===t.trueValue||!o&&(a&&i||i===!0||i==="true"||i==="True"||i===1||i==="1")?(r.setAttribute("aria-checked",!0),l||""):n&&(i==="null"||i===""||i===null||typeof i>"u")?(r.setAttribute("aria-checked","mixed"),""):(r.setAttribute("aria-checked",!1),h||"")}function eW(s,t,e){var i=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),r=t.inputFormat||"yyyy-MM-dd HH:mm:ss",n=t.outputFormat||"dd/MM/yyyy HH:mm:ss",a=typeof t.invalidPlaceholder<"u"?t.invalidPlaceholder:"",o=s.getValue();if(typeof i<"u"){var l;return i.isDateTime(o)?l=o:r==="iso"?l=i.fromISO(String(o)):l=i.fromFormat(String(o),r),l.isValid?(t.timezone&&(l=l.setZone(t.timezone)),l.toFormat(n)):a===!0||!o?o:typeof a=="function"?a(o):a}else console.error("Format Error - 'datetime' formatter is dependant on luxon.js")}function tW(s,t,e){var i=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),r=t.inputFormat||"yyyy-MM-dd HH:mm:ss",n=typeof t.invalidPlaceholder<"u"?t.invalidPlaceholder:"",a=typeof t.suffix<"u"?t.suffix:!1,o=typeof t.unit<"u"?t.unit:"days",l=typeof t.humanize<"u"?t.humanize:!1,h=typeof t.date<"u"?t.date:i.now(),u=s.getValue();if(typeof i<"u"){var c;return i.isDateTime(u)?c=u:r==="iso"?c=i.fromISO(String(u)):c=i.fromFormat(String(u),r),c.isValid?l?c.diff(h,o).toHuman()+(a?" "+a:""):parseInt(c.diff(h,o)[o])+(a?" "+a:""):n===!0?u:typeof n=="function"?n(u):n}else console.error("Format Error - 'datetimediff' formatter is dependant on luxon.js")}function iW(s,t,e){var i=s.getValue();return typeof t[i]>"u"?(console.warn("Missing display value for "+i),i):t[i]}function rW(s,t,e){var i=s.getValue(),r=s.getElement(),n=t&&t.stars?t.stars:5,a=document.createElement("span"),o=document.createElementNS("http://www.w3.org/2000/svg","svg"),l='<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>',h='<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>';a.style.verticalAlign="middle",o.setAttribute("width","14"),o.setAttribute("height","14"),o.setAttribute("viewBox","0 0 512 512"),o.setAttribute("xml:space","preserve"),o.style.padding="0 1px",i=i&&!isNaN(i)?parseInt(i):0,i=Math.max(0,Math.min(i,n));for(var u=1;u<=n;u++){var c=o.cloneNode(!0);c.innerHTML=u<=i?l:h,a.appendChild(c)}return r.style.whiteSpace="nowrap",r.style.overflow="hidden",r.style.textOverflow="ellipsis",r.setAttribute("aria-label",i),a}function sW(s,t,e){var i=this.sanitizeHTML(s.getValue())||0,r=document.createElement("span"),n=t&&t.max?t.max:100,a=t&&t.min?t.min:0,o=t&&typeof t.color<"u"?t.color:["red","orange","green"],l="#666666",h,u;if(!(isNaN(i)||typeof s.getValue()>"u")){switch(r.classList.add("tabulator-traffic-light"),u=parseFloat(i)<=n?parseFloat(i):n,u=parseFloat(u)>=a?parseFloat(u):a,h=(n-a)/100,u=Math.round((u-a)/h),typeof o){case"string":l=o;break;case"function":l=o(i);break;case"object":if(Array.isArray(o)){var c=100/o.length,f=Math.floor(u/c);f=Math.min(f,o.length-1),f=Math.max(f,0),l=o[f];break}}return r.style.backgroundColor=l,r}}function nW(s,t={},e){var i=this.sanitizeHTML(s.getValue())||0,r=s.getElement(),n=t.max?t.max:100,a=t.min?t.min:0,o=t.legendAlign?t.legendAlign:"center",l,h,u,c,f;switch(h=parseFloat(i)<=n?parseFloat(i):n,h=parseFloat(h)>=a?parseFloat(h):a,l=(n-a)/100,h=Math.round((h-a)/l),typeof t.color){case"string":u=t.color;break;case"function":u=t.color(i);break;case"object":if(Array.isArray(t.color)){let g=100/t.color.length,b=Math.floor(h/g);b=Math.min(b,t.color.length-1),b=Math.max(b,0),u=t.color[b];break}default:u="#2DC214"}switch(typeof t.legend){case"string":c=t.legend;break;case"function":c=t.legend(i);break;case"boolean":c=i;break;default:c=!1}switch(typeof t.legendColor){case"string":f=t.legendColor;break;case"function":f=t.legendColor(i);break;case"object":if(Array.isArray(t.legendColor)){let g=100/t.legendColor.length,b=Math.floor(h/g);b=Math.min(b,t.legendColor.length-1),b=Math.max(b,0),f=t.legendColor[b]}break;default:f="#000"}r.style.minWidth="30px",r.style.position="relative",r.setAttribute("aria-label",h);var d=document.createElement("div");d.style.display="inline-block",d.style.width=h+"%",d.style.backgroundColor=u,d.style.height="100%",d.setAttribute("data-max",n),d.setAttribute("data-min",a);var p=document.createElement("div");if(p.style.position="relative",p.style.width="100%",p.style.height="100%",c){var v=document.createElement("div");v.style.position="absolute",v.style.top=0,v.style.left=0,v.style.textAlign=o,v.style.width="100%",v.style.color=f,v.innerHTML=c}return e(function(){if(!(s instanceof qw)){var g=document.createElement("div");g.style.position="absolute",g.style.top="4px",g.style.bottom="4px",g.style.left="4px",g.style.right="4px",r.appendChild(g),r=g}r.appendChild(p),p.appendChild(d),c&&p.appendChild(v)}),""}function aW(s,t,e){return s.getElement().style.backgroundColor=this.sanitizeHTML(s.getValue()),""}function oW(s,t,e){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>'}function lW(s,t,e){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>'}function hW(s,t,e){var i=s.getValue(),r=t.size||15,n=r+"px",a,o,l=t.hasOwnProperty("onValue")?t.onValue:!0,h=t.hasOwnProperty("offValue")?t.offValue:!1,u=t.onTruthy?i:i===l;return a=document.createElement("div"),a.classList.add("tabulator-toggle"),u?(a.classList.add("tabulator-toggle-on"),a.style.flexDirection="row-reverse",t.onColor&&(a.style.background=t.onColor)):t.offColor&&(a.style.background=t.offColor),a.style.width=2.5*r+"px",a.style.borderRadius=n,t.clickable&&a.addEventListener("click",c=>{s.setValue(u?h:l)}),o=document.createElement("div"),o.classList.add("tabulator-toggle-switch"),o.style.height=n,o.style.width=n,o.style.borderRadius=n,a.appendChild(o),a}function uW(s,t,e){var i=document.createElement("span"),r=s.getRow(),n=s.getTable();return r.watchPosition(a=>{t.relativeToPage&&(a+=n.modules.page.getPageSize()*(n.modules.page.getPage()-1)),i.innerText=a}),i}function cW(s,t,e){return s.getElement().classList.add("tabulator-row-handle"),"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>"}function fW(s,t,e){var i,r,n;function a(o){var l=o.getValue(),h="plaintext";switch(typeof l){case"boolean":h="tickCross";break;case"string":l.includes("\n")&&(h="textarea");break}return h}return i=t.formatterLookup?t.formatterLookup(s):a(s),t.paramsLookup&&(n=typeof t.paramsLookup=="function"?t.paramsLookup(i,s):t.paramsLookup[i]),r=this.table.modules.format.lookupFormatter(i),r.call(this,s,n||{},e)}function dW(s,t,e){var i=t.delimiter||",",r=s.getValue(),n=this.table,a;return t.valueMap&&(typeof t.valueMap=="string"?a=function(o){return o.map(l=>$t.retrieveNestedData(n.options.nestedFieldSeparator,t.valueMap,l))}:a=t.valueMap),Array.isArray(r)?(a&&(r=a(r)),r.join(i)):r}function pW(s,t,e){var i=t.indent||"	",r=typeof t.multiline>"u"?!0:t.multiline,n=t.replacer||null,a=s.getValue();return r&&(s.getElement().style.whiteSpace="pre-wrap"),JSON.stringify(a,n,i)}var mW={plaintext:GV,html:XV,textarea:KV,money:YV,link:JV,image:QV,tickCross:ZV,datetime:eW,datetimediff:tW,lookup:iW,star:rW,traffic:sW,progress:nW,color:aW,buttonTick:oW,buttonCross:lW,toggle:hW,rownum:uW,handle:cW,adaptable:fW,array:dW,json:pW};const bn=class bn extends pt{constructor(t){super(t),this.registerColumnOption("formatter"),this.registerColumnOption("formatterParams"),this.registerColumnOption("formatterPrint"),this.registerColumnOption("formatterPrintParams"),this.registerColumnOption("formatterClipboard"),this.registerColumnOption("formatterClipboardParams"),this.registerColumnOption("formatterHtmlOutput"),this.registerColumnOption("formatterHtmlOutputParams"),this.registerColumnOption("titleFormatter"),this.registerColumnOption("titleFormatterParams")}initialize(){this.subscribe("cell-format",this.formatValue.bind(this)),this.subscribe("cell-rendered",this.cellRendered.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-format",this.formatHeader.bind(this))}initializeColumn(t){t.modules.format=this.lookupTypeFormatter(t,""),typeof t.definition.formatterPrint<"u"&&(t.modules.format.print=this.lookupTypeFormatter(t,"Print")),typeof t.definition.formatterClipboard<"u"&&(t.modules.format.clipboard=this.lookupTypeFormatter(t,"Clipboard")),typeof t.definition.formatterHtmlOutput<"u"&&(t.modules.format.htmlOutput=this.lookupTypeFormatter(t,"HtmlOutput"))}lookupTypeFormatter(t,e){var i={params:t.definition["formatter"+e+"Params"]||{}},r=t.definition["formatter"+e];return i.formatter=this.lookupFormatter(r),i}lookupFormatter(t){var e;switch(typeof t){case"string":bn.formatters[t]?e=bn.formatters[t]:(console.warn("Formatter Error - No such formatter found: ",t),e=bn.formatters.plaintext);break;case"function":e=t;break;default:e=bn.formatters.plaintext;break}return e}cellRendered(t){t.modules.format&&t.modules.format.renderedCallback&&!t.modules.format.rendered&&(t.modules.format.renderedCallback(),t.modules.format.rendered=!0)}formatHeader(t,e,i){var r,n,a,o;return t.definition.titleFormatter?(r=this.lookupFormatter(t.definition.titleFormatter),a=l=>{t.titleFormatterRendered=l},o={getValue:function(){return e},getElement:function(){return i},getType:function(){return"header"},getColumn:function(){return t.getComponent()},getTable:()=>this.table},n=t.definition.titleFormatterParams||{},n=typeof n=="function"?n():n,r.call(this,o,n,a)):e}formatValue(t){var e=t.getComponent(),i=typeof t.column.modules.format.params=="function"?t.column.modules.format.params(e):t.column.modules.format.params;function r(n){t.modules.format||(t.modules.format={}),t.modules.format.renderedCallback=n,t.modules.format.rendered=!1}return t.column.modules.format.formatter.call(this,e,i,r)}formatExportValue(t,e){var i=t.column.modules.format[e],r;if(i){let n=function(a){t.modules.format||(t.modules.format={}),t.modules.format.renderedCallback=a,t.modules.format.rendered=!1};return r=typeof i.params=="function"?i.params(t.getComponent()):i.params,i.formatter.call(this,t.getComponent(),r,n)}else return this.formatValue(t)}sanitizeHTML(t){if(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(t).replace(/[&<>"'`=/]/g,function(i){return e[i]})}else return t}emptyToSpace(t){return t===null||typeof t>"u"||t===""?"&nbsp;":t}};Ne(bn,"moduleName","format"),Ne(bn,"formatters",mW);let Sp=bn;class Yw extends pt{constructor(t){super(t),this.leftColumns=[],this.rightColumns=[],this.initializationMode="left",this.active=!1,this.blocked=!0,this.registerColumnOption("frozen")}reset(){this.initializationMode="left",this.leftColumns=[],this.rightColumns=[],this.active=!1}initialize(){this.subscribe("cell-layout",this.layoutCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-width",this.layout.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("table-layout",this.layout.bind(this)),this.subscribe("columns-loading",this.reset.bind(this)),this.subscribe("column-add",this.reinitializeColumns.bind(this)),this.subscribe("column-deleted",this.reinitializeColumns.bind(this)),this.subscribe("column-hide",this.reinitializeColumns.bind(this)),this.subscribe("column-show",this.reinitializeColumns.bind(this)),this.subscribe("columns-loaded",this.reinitializeColumns.bind(this)),this.subscribe("table-redraw",this.layout.bind(this)),this.subscribe("layout-refreshing",this.blockLayout.bind(this)),this.subscribe("layout-refreshed",this.unblockLayout.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this))}blockLayout(){this.blocked=!0}unblockLayout(){this.blocked=!1}layoutCell(t){this.layoutElement(t.element,t.column)}reinitializeColumns(){this.reset(),this.table.columnManager.columnsByIndex.forEach(t=>{this.initializeColumn(t)}),this.layout()}initializeColumn(t){var e={margin:0,edge:!1};t.isGroup||(this.frozenCheck(t)?(e.position=this.initializationMode,this.initializationMode=="left"?this.leftColumns.push(t):this.rightColumns.unshift(t),this.active=!0,t.modules.frozen=e):this.initializationMode="right")}frozenCheck(t){return t.parent.isGroup&&t.definition.frozen&&console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"),t.parent.isGroup?this.frozenCheck(t.parent):t.definition.frozen}layoutCalcRows(){this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&this.table.modules.columnCalcs.topRow&&this.layoutRow(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&this.table.modules.columnCalcs.botRow&&this.layoutRow(this.table.modules.columnCalcs.botRow),this.table.modExists("groupRows")&&this.layoutGroupCalcs(this.table.modules.groupRows.getGroups()))}layoutGroupCalcs(t){t.forEach(e=>{e.calcs.top&&this.layoutRow(e.calcs.top),e.calcs.bottom&&this.layoutRow(e.calcs.bottom),e.groupList&&e.groupList.length&&this.layoutGroupCalcs(e.groupList)})}layoutColumnPosition(t){var e=[],i=0,r=0;this.leftColumns.forEach((n,a)=>{if(n.modules.frozen.marginValue=i,n.modules.frozen.margin=n.modules.frozen.marginValue+"px",n.visible&&(i+=n.getWidth()),a==this.leftColumns.length-1?n.modules.frozen.edge=!0:n.modules.frozen.edge=!1,n.parent.isGroup){var o=this.getColGroupParentElement(n);e.includes(o)||(this.layoutElement(o,n),e.push(o)),o.classList.toggle("tabulator-frozen-left",n.modules.frozen.edge&&n.modules.frozen.position==="left"),o.classList.toggle("tabulator-frozen-right",n.modules.frozen.edge&&n.modules.frozen.position==="right")}else this.layoutElement(n.getElement(),n);t&&n.cells.forEach(l=>{this.layoutElement(l.getElement(!0),n)})}),this.rightColumns.forEach((n,a)=>{n.modules.frozen.marginValue=r,n.modules.frozen.margin=n.modules.frozen.marginValue+"px",n.visible&&(r+=n.getWidth()),a==this.rightColumns.length-1?n.modules.frozen.edge=!0:n.modules.frozen.edge=!1,n.parent.isGroup?this.layoutElement(this.getColGroupParentElement(n),n):this.layoutElement(n.getElement(),n),t&&n.cells.forEach(o=>{this.layoutElement(o.getElement(!0),n)})})}getColGroupParentElement(t){return t.parent.isGroup?this.getColGroupParentElement(t.parent):t.getElement()}layout(){this.active&&!this.blocked&&(this.layoutColumnPosition(),this.reinitializeRows(),this.layoutCalcRows())}reinitializeRows(){var t=this.table.rowManager.getVisibleRows(!0),e=this.table.rowManager.getRows().filter(i=>!t.includes(i));e.forEach(i=>{i.deinitialize()}),t.forEach(i=>{i.type==="row"&&this.layoutRow(i)})}layoutRow(t){this.table.options.layout==="fitDataFill"&&this.rightColumns.length&&(this.table.rowManager.getTableElement().style.minWidth="calc(100% - "+this.rightMargin+")"),this.leftColumns.forEach(e=>{var i=t.getCell(e);i&&this.layoutElement(i.getElement(!0),e)}),this.rightColumns.forEach(e=>{var i=t.getCell(e);i&&this.layoutElement(i.getElement(!0),e)})}layoutElement(t,e){var i;e.modules.frozen&&t&&(t.style.position="sticky",this.table.rtl?i=e.modules.frozen.position==="left"?"right":"left":i=e.modules.frozen.position,t.style[i]=e.modules.frozen.margin,t.classList.add("tabulator-frozen"),t.classList.toggle("tabulator-frozen-left",e.modules.frozen.edge&&e.modules.frozen.position==="left"),t.classList.toggle("tabulator-frozen-right",e.modules.frozen.edge&&e.modules.frozen.position==="right"))}adjustForScrollbar(t){this.rightColumns.length&&(this.table.columnManager.getContentsElement().style.width="calc(100% - "+t+"px)")}getFrozenColumns(){return this.leftColumns.concat(this.rightColumns)}_calcSpace(t,e){var i=0;for(let r=0;r<e;r++)t[r].visible&&(i+=t[r].getWidth());return i}}Ne(Yw,"moduleName","frozenColumns");class Jw extends pt{constructor(t){super(t),this.topElement=document.createElement("div"),this.rows=[],this.registerComponentFunction("row","freeze",this.freezeRow.bind(this)),this.registerComponentFunction("row","unfreeze",this.unfreezeRow.bind(this)),this.registerComponentFunction("row","isFrozen",this.isRowFrozen.bind(this)),this.registerTableOption("frozenRowsField","id"),this.registerTableOption("frozenRows",!1)}initialize(){var t=document.createDocumentFragment();this.rows=[],this.topElement.classList.add("tabulator-frozen-rows-holder"),t.appendChild(document.createElement("br")),t.appendChild(this.topElement),this.table.columnManager.getContentsElement().insertBefore(t,this.table.columnManager.headersElement.nextSibling),this.subscribe("row-deleting",this.detachRow.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),10),this.table.options.frozenRows&&(this.subscribe("data-processed",this.initializeRows.bind(this)),this.subscribe("row-added",this.initializeRow.bind(this)),this.subscribe("table-redrawing",this.resizeHolderWidth.bind(this)),this.subscribe("column-resized",this.resizeHolderWidth.bind(this)),this.subscribe("column-show",this.resizeHolderWidth.bind(this)),this.subscribe("column-hide",this.resizeHolderWidth.bind(this))),this.resizeHolderWidth()}resizeHolderWidth(){this.topElement.style.minWidth=this.table.columnManager.headersElement.offsetWidth+"px"}initializeRows(){this.table.rowManager.getRows().forEach(t=>{this.initializeRow(t)})}initializeRow(t){var e=this.table.options.frozenRows,i=typeof e;i==="number"?t.getPosition()&&t.getPosition()+this.rows.length<=e&&this.freezeRow(t):i==="function"?e.call(this.table,t.getComponent())&&this.freezeRow(t):Array.isArray(e)&&e.includes(t.data[this.options("frozenRowsField")])&&this.freezeRow(t)}isRowFrozen(t){var e=this.rows.indexOf(t);return e>-1}isFrozen(){return!!this.rows.length}visibleRows(t,e){return this.rows.forEach(i=>{e.push(i)}),e}getRows(t){var e=t.slice(0);return this.rows.forEach(function(i){var r=e.indexOf(i);r>-1&&e.splice(r,1)}),e}freezeRow(t){t.modules.frozen?console.warn("Freeze Error - Row is already frozen"):(t.modules.frozen=!0,this.topElement.appendChild(t.getElement()),t.initialize(),t.normalizeHeight(),this.rows.push(t),this.refreshData(!1,"display"),this.table.rowManager.adjustTableSize(),this.styleRows())}unfreezeRow(t){t.modules.frozen?(t.modules.frozen=!1,this.detachRow(t),this.table.rowManager.adjustTableSize(),this.refreshData(!1,"display"),this.rows.length&&this.styleRows()):console.warn("Freeze Error - Row is already unfrozen")}detachRow(t){var e=this.rows.indexOf(t);if(e>-1){var i=t.getElement();i.parentNode&&i.parentNode.removeChild(i),this.rows.splice(e,1)}}styleRows(t){this.rows.forEach((e,i)=>{this.table.rowManager.styleRow(e,i)})}}Ne(Jw,"moduleName","frozenRows");class vW{constructor(t){return this._group=t,this.type="GroupComponent",new Proxy(this,{get:function(e,i,r){return typeof e[i]<"u"?e[i]:e._group.groupManager.table.componentFunctionBinder.handle("group",e._group,i)}})}getKey(){return this._group.key}getField(){return this._group.field}getElement(){return this._group.element}getRows(){return this._group.getRows(!0)}getSubGroups(){return this._group.getSubGroups(!0)}getParentGroup(){return this._group.parent?this._group.parent.getComponent():!1}isVisible(){return this._group.visible}show(){this._group.show()}hide(){this._group.hide()}toggle(){this._group.toggleVisibility()}scrollTo(t,e){return this._group.groupManager.table.rowManager.scrollToRow(this._group,t,e)}_getSelf(){return this._group}getTable(){return this._group.groupManager.table}}class lo{constructor(t,e,i,r,n,a,o){this.groupManager=t,this.parent=e,this.key=r,this.level=i,this.field=n,this.hasSubGroups=i<t.groupIDLookups.length-1,this.addRow=this.hasSubGroups?this._addRowToGroup:this._addRow,this.type="group",this.old=o,this.rows=[],this.groups=[],this.groupList=[],this.generator=a,this.element=!1,this.elementContents=!1,this.height=0,this.outerHeight=0,this.initialized=!1,this.calcs={},this.initialized=!1,this.modules={},this.arrowElement=!1,this.visible=o?o.visible:typeof t.startOpen[i]<"u"?t.startOpen[i]:t.startOpen[0],this.component=null,this.createElements(),this.addBindings(),this.createValueGroups()}wipe(t){t||(this.groupList.length?this.groupList.forEach(function(e){e.wipe()}):this.rows.forEach(e=>{e.modules&&delete e.modules.group})),this.element=!1,this.arrowElement=!1,this.elementContents=!1}createElements(){var t=document.createElement("div");t.classList.add("tabulator-arrow"),this.element=document.createElement("div"),this.element.classList.add("tabulator-row"),this.element.classList.add("tabulator-group"),this.element.classList.add("tabulator-group-level-"+this.level),this.element.setAttribute("role","rowgroup"),this.arrowElement=document.createElement("div"),this.arrowElement.classList.add("tabulator-group-toggle"),this.arrowElement.appendChild(t),this.groupManager.table.options.movableRows!==!1&&this.groupManager.table.modExists("moveRow")&&this.groupManager.table.modules.moveRow.initializeGroupHeader(this)}createValueGroups(){var t=this.level+1;this.groupManager.allowedValues&&this.groupManager.allowedValues[t]&&this.groupManager.allowedValues[t].forEach(e=>{this._createGroup(e,t)})}addBindings(){var t;this.groupManager.table.options.groupToggleElement&&(t=this.groupManager.table.options.groupToggleElement=="arrow"?this.arrowElement:this.element,t.addEventListener("click",e=>{this.groupManager.table.options.groupToggleElement==="arrow"&&(e.stopPropagation(),e.stopImmediatePropagation()),setTimeout(()=>{this.toggleVisibility()})}))}_createGroup(t,e){var i=e+"_"+t,r=new lo(this.groupManager,this,e,t,this.groupManager.groupIDLookups[e].field,this.groupManager.headerGenerator[e]||this.groupManager.headerGenerator[0],this.old?this.old.groups[i]:!1);this.groups[i]=r,this.groupList.push(r)}_addRowToGroup(t){var e=this.level+1;if(this.hasSubGroups){var i=this.groupManager.groupIDLookups[e].func(t.getData()),r=e+"_"+i;this.groupManager.allowedValues&&this.groupManager.allowedValues[e]?this.groups[r]&&this.groups[r].addRow(t):(this.groups[r]||this._createGroup(i,e),this.groups[r].addRow(t))}}_addRow(t){this.rows.push(t),t.modules.group=this}insertRow(t,e,i){var r=this.conformRowData({});t.updateData(r);var n=this.rows.indexOf(e);n>-1?i?this.rows.splice(n+1,0,t):this.rows.splice(n,0,t):i?this.rows.push(t):this.rows.unshift(t),t.modules.group=this,this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modules.columnCalcs.recalcGroup(this),this.groupManager.updateGroupRows(!0)}scrollHeader(t){this.arrowElement&&(this.arrowElement.style.marginLeft=t,this.groupList.forEach(function(e){e.scrollHeader(t)}))}getRowIndex(t){}conformRowData(t){return this.field?t[this.field]=this.key:console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"),this.parent&&(t=this.parent.conformRowData(t)),t}removeRow(t){var e=this.rows.indexOf(t),i=t.getElement();e>-1&&this.rows.splice(e,1),!this.groupManager.table.options.groupValues&&!this.rows.length?(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this),this.groupManager.updateGroupRows(!0)):(i.parentNode&&i.parentNode.removeChild(i),this.groupManager.blockRedraw||(this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modules.columnCalcs.recalcGroup(this)))}removeGroup(t){var e=t.level+"_"+t.key,i;this.groups[e]&&(delete this.groups[e],i=this.groupList.indexOf(t),i>-1&&this.groupList.splice(i,1),this.groupList.length||(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this)))}getHeadersAndRows(){var t=[];return t.push(this),this._visSet(),this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.visible?this.groupList.length?this.groupList.forEach(function(e){t=t.concat(e.getHeadersAndRows())}):(this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),t.push(this.calcs.top)),t=t.concat(this.rows),this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),t.push(this.calcs.bottom))):!this.groupList.length&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&(this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),t.push(this.calcs.top)),this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),t.push(this.calcs.bottom))),t}getData(t,e){var i=[];return this._visSet(),(!t||t&&this.visible)&&this.rows.forEach(r=>{i.push(r.getData(e||"data"))}),i}getRowCount(){var t=0;return this.groupList.length?this.groupList.forEach(e=>{t+=e.getRowCount()}):t=this.rows.length,t}toggleVisibility(){this.visible?this.hide():this.show()}hide(){this.visible=!1,this.groupManager.table.rowManager.getRenderMode()=="basic"&&!this.groupManager.table.options.pagination?(this.element.classList.remove("tabulator-group-visible"),this.groupList.length?this.groupList.forEach(t=>{var e=t.getHeadersAndRows();e.forEach(i=>{i.detachElement()})}):this.rows.forEach(t=>{var e=t.getElement();e.parentNode.removeChild(e)}),this.groupManager.updateGroupRows(!0)):this.groupManager.updateGroupRows(!0),this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!1)}show(){if(this.visible=!0,this.groupManager.table.rowManager.getRenderMode()=="basic"&&!this.groupManager.table.options.pagination){this.element.classList.add("tabulator-group-visible");var t=this.generateElement();this.groupList.length?this.groupList.forEach(e=>{var i=e.getHeadersAndRows();i.forEach(r=>{var n=r.getElement();t.parentNode.insertBefore(n,t.nextSibling),r.initialize(),t=n})}):this.rows.forEach(e=>{var i=e.getElement();t.parentNode.insertBefore(i,t.nextSibling),e.initialize(),t=i}),this.groupManager.updateGroupRows(!0)}else this.groupManager.updateGroupRows(!0);this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!0)}_visSet(){var t=[];typeof this.visible=="function"&&(this.rows.forEach(function(e){t.push(e.getData())}),this.visible=this.visible(this.key,this.getRowCount(),t,this.getComponent()))}getRowGroup(t){var e=!1;return this.groupList.length?this.groupList.forEach(function(i){var r=i.getRowGroup(t);r&&(e=r)}):this.rows.find(function(i){return i===t})&&(e=this),e}getSubGroups(t){var e=[];return this.groupList.forEach(function(i){e.push(t?i.getComponent():i)}),e}getRows(t,e){var i=[];return e&&this.groupList.length?this.groupList.forEach(r=>{i=i.concat(r.getRows(t,e))}):this.rows.forEach(function(r){i.push(t?r.getComponent():r)}),i}generateGroupHeaderContents(){var t=[],e=this.getRows(!1,!0);for(e.forEach(function(i){t.push(i.getData())}),this.elementContents=this.generator(this.key,this.getRowCount(),t,this.getComponent());this.element.firstChild;)this.element.removeChild(this.element.firstChild);typeof this.elementContents=="string"?this.element.innerHTML=this.elementContents:this.element.appendChild(this.elementContents),this.element.insertBefore(this.arrowElement,this.element.firstChild)}getPath(t=[]){return t.unshift(this.key),this.parent&&this.parent.getPath(t),t}getElement(){return this.elementContents?this.element:this.generateElement()}generateElement(){this.addBindings=!1,this._visSet(),this.visible?this.element.classList.add("tabulator-group-visible"):this.element.classList.remove("tabulator-group-visible");for(var t=0;t<this.element.childNodes.length;++t)this.element.childNodes[t].parentNode.removeChild(this.element.childNodes[t]);return this.generateGroupHeaderContents(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}normalizeHeight(){this.setHeight(this.element.clientHeight)}initialize(t){(!this.initialized||t)&&(this.normalizeHeight(),this.initialized=!0)}reinitialize(){this.initialized=!1,this.height=0,$t.elVisible(this.element)&&this.initialize(!0)}setHeight(t){this.height!=t&&(this.height=t,this.outerHeight=this.element.offsetHeight)}getHeight(){return this.outerHeight}getGroup(){return this}reinitializeHeight(){}calcHeight(){}setCellHeight(){}clearCellHeight(){}deinitializeHeight(){}rendered(){}getComponent(){return this.component||(this.component=new vW(this)),this.component}}class Qw extends pt{constructor(t){super(t),this.groupIDLookups=!1,this.startOpen=[function(){return!1}],this.headerGenerator=[function(){return""}],this.groupList=[],this.allowedValues=!1,this.groups={},this.displayHandler=this.getRows.bind(this),this.blockRedraw=!1,this.registerTableOption("groupBy",!1),this.registerTableOption("groupStartOpen",!0),this.registerTableOption("groupValues",!1),this.registerTableOption("groupUpdateOnCellEdit",!1),this.registerTableOption("groupHeader",!1),this.registerTableOption("groupHeaderPrint",null),this.registerTableOption("groupHeaderClipboard",null),this.registerTableOption("groupHeaderHtmlOutput",null),this.registerTableOption("groupHeaderDownload",null),this.registerTableOption("groupToggleElement","arrow"),this.registerTableOption("groupClosedShowCalcs",!1),this.registerTableFunction("setGroupBy",this.setGroupBy.bind(this)),this.registerTableFunction("setGroupValues",this.setGroupValues.bind(this)),this.registerTableFunction("setGroupStartOpen",this.setGroupStartOpen.bind(this)),this.registerTableFunction("setGroupHeader",this.setGroupHeader.bind(this)),this.registerTableFunction("getGroups",this.userGetGroups.bind(this)),this.registerTableFunction("getGroupedData",this.userGetGroupedData.bind(this)),this.registerComponentFunction("row","getGroup",this.rowGetGroup.bind(this))}initialize(){this.subscribe("table-destroy",this._blockRedrawing.bind(this)),this.subscribe("rows-wipe",this._blockRedrawing.bind(this)),this.subscribe("rows-wiped",this._restore_redrawing.bind(this)),this.table.options.groupBy&&(this.table.options.groupUpdateOnCellEdit&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("row-data-changed",this.reassignRowToGroup.bind(this),0)),this.subscribe("table-built",this.configureGroupSetup.bind(this)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHeaders.bind(this)),this.subscribe("rows-wipe",this.wipe.bind(this)),this.subscribe("rows-added",this.rowsUpdated.bind(this)),this.subscribe("row-moving",this.rowMoving.bind(this)),this.subscribe("row-adding-index",this.rowAddingIndex.bind(this)),this.subscribe("rows-sample",this.rowSample.bind(this)),this.subscribe("render-virtual-fill",this.virtualRenderFill.bind(this)),this.registerDisplayHandler(this.displayHandler,20),this.initialized=!0)}_blockRedrawing(){this.blockRedraw=!0}_restore_redrawing(){this.blockRedraw=!1}configureGroupSetup(){if(this.table.options.groupBy){var t=this.table.options.groupBy,e=this.table.options.groupStartOpen,i=this.table.options.groupHeader;if(this.allowedValues=this.table.options.groupValues,Array.isArray(t)&&Array.isArray(i)&&t.length>i.length&&console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"),this.headerGenerator=[function(){return""}],this.startOpen=[function(){return!1}],this.langBind("groups|item",(n,a)=>{this.headerGenerator[0]=(o,l,h)=>(typeof o>"u"?"":o)+"<span>("+l+" "+(l===1?n:a.groups.items)+")</span>"}),this.groupIDLookups=[],t)this.table.modExists("columnCalcs")&&this.table.options.columnCalcs!="table"&&this.table.options.columnCalcs!="both"&&this.table.modules.columnCalcs.removeCalcs();else if(this.table.modExists("columnCalcs")&&this.table.options.columnCalcs!="group"){var r=this.table.columnManager.getRealColumns();r.forEach(n=>{n.definition.topCalc&&this.table.modules.columnCalcs.initializeTopRow(),n.definition.bottomCalc&&this.table.modules.columnCalcs.initializeBottomRow()})}Array.isArray(t)||(t=[t]),t.forEach((n,a)=>{var o,l;typeof n=="function"?o=n:(l=this.table.columnManager.getColumnByField(n),l?o=function(h){return l.getFieldValue(h)}:o=function(h){return h[n]}),this.groupIDLookups.push({field:typeof n=="function"?!1:n,func:o,values:this.allowedValues?this.allowedValues[a]:!1})}),e&&(Array.isArray(e)||(e=[e]),e.forEach(n=>{}),this.startOpen=e),i&&(this.headerGenerator=Array.isArray(i)?i:[i])}else this.groupList=[],this.groups={}}rowSample(t,e){if(this.table.options.groupBy){var i=this.getGroups(!1)[0];e.push(i.getRows(!1)[0])}return e}virtualRenderFill(){var t=this.table.rowManager.tableElement,e=this.table.rowManager.getVisibleRows();if(this.table.options.groupBy)e=e.filter(i=>i.type!=="group"),t.style.minWidth=e.length?"":this.table.columnManager.getWidth()+"px";else return e}rowAddingIndex(t,e,i){if(this.table.options.groupBy){this.assignRowToGroup(t);var r=t.modules.group.rows;return r.length>1&&(!e||e&&r.indexOf(e)==-1?i?r[0]!==t&&(e=r[0],this.table.rowManager.moveRowInArray(t.modules.group.rows,t,e,!i)):r[r.length-1]!==t&&(e=r[r.length-1],this.table.rowManager.moveRowInArray(t.modules.group.rows,t,e,!i)):this.table.rowManager.moveRowInArray(t.modules.group.rows,t,e,!i)),e}}trackChanges(){this.dispatch("group-changed")}setGroupBy(t){this.table.options.groupBy=t,this.initialized||this.initialize(),this.configureGroupSetup(),!t&&this.table.modExists("columnCalcs")&&this.table.options.columnCalcs===!0&&this.table.modules.columnCalcs.reinitializeCalcs(),this.refreshData(),this.trackChanges()}setGroupValues(t){this.table.options.groupValues=t,this.configureGroupSetup(),this.refreshData(),this.trackChanges()}setGroupStartOpen(t){this.table.options.groupStartOpen=t,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}setGroupHeader(t){this.table.options.groupHeader=t,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}userGetGroups(t){return this.getGroups(!0)}userGetGroupedData(){return this.table.options.groupBy?this.getGroupedData():this.getData()}rowGetGroup(t){return t.modules.group?t.modules.group.getComponent():!1}rowMoving(t,e,i){if(this.table.options.groupBy){!i&&e instanceof lo&&(e=this.table.rowManager.prevDisplayRow(t)||e);var r=e instanceof lo?e:e.modules.group,n=t instanceof lo?t:t.modules.group;r===n?this.table.rowManager.moveRowInArray(r.rows,t,e,i):(n&&n.removeRow(t),r.insertRow(t,e,i))}}rowDeleting(t){this.table.options.groupBy&&t.modules.group&&t.modules.group.removeRow(t)}rowsUpdated(t){this.table.options.groupBy&&this.updateGroupRows(!0)}cellUpdated(t){this.table.options.groupBy&&this.reassignRowToGroup(t.row)}getRows(t){return this.table.options.groupBy&&this.groupIDLookups.length?(this.dispatchExternal("dataGrouping"),this.generateGroups(t),this.subscribedExternal("dataGrouped")&&this.dispatchExternal("dataGrouped",this.getGroups(!0)),this.updateGroupRows()):t.slice(0)}getGroups(t){var e=[];return this.groupList.forEach(function(i){e.push(t?i.getComponent():i)}),e}getChildGroups(t){var e=[];return t||(t=this),t.groupList.forEach(i=>{i.groupList.length?e=e.concat(this.getChildGroups(i)):e.push(i)}),e}wipe(){this.table.options.groupBy&&(this.groupList.forEach(function(t){t.wipe()}),this.groupList=[],this.groups={})}pullGroupListData(t){var e=[];return t.forEach(i=>{var r={};r.level=0,r.rowCount=0,r.headerContent="";var n=[];i.hasSubGroups?(n=this.pullGroupListData(i.groupList),r.level=i.level,r.rowCount=n.length-i.groupList.length,r.headerContent=i.generator(i.key,r.rowCount,i.rows,i),e.push(r),e=e.concat(n)):(r.level=i.level,r.headerContent=i.generator(i.key,i.rows.length,i.rows,i),r.rowCount=i.getRows().length,e.push(r),i.getRows().forEach(a=>{e.push(a.getData("data"))}))}),e}getGroupedData(){return this.pullGroupListData(this.groupList)}getRowGroup(t){var e=!1;return this.options("dataTree")&&(t=this.table.modules.dataTree.getTreeParentRoot(t)),this.groupList.forEach(i=>{var r=i.getRowGroup(t);r&&(e=r)}),e}countGroups(){return this.groupList.length}generateGroups(t){var e=this.groups;this.groups={},this.groupList=[],this.allowedValues&&this.allowedValues[0]?(this.allowedValues[0].forEach(i=>{this.createGroup(i,0,e)}),t.forEach(i=>{this.assignRowToExistingGroup(i,e)})):t.forEach(i=>{this.assignRowToGroup(i,e)}),Object.values(e).forEach(i=>{i.wipe(!0)})}createGroup(t,e,i){var r=e+"_"+t,n;i=i||[],n=new lo(this,!1,e,t,this.groupIDLookups[0].field,this.headerGenerator[0],i[r]),this.groups[r]=n,this.groupList.push(n)}assignRowToExistingGroup(t,e){var i=this.groupIDLookups[0].func(t.getData()),r="0_"+i;this.groups[r]&&this.groups[r].addRow(t)}assignRowToGroup(t,e){var i=this.groupIDLookups[0].func(t.getData()),r=!this.groups["0_"+i];return r&&this.createGroup(i,0,e),this.groups["0_"+i].addRow(t),!r}reassignRowToGroup(t){if(t.type==="row"){var e=t.modules.group,i=e.getPath(),r=this.getExpectedPath(t),n;n=i.length==r.length&&i.every((a,o)=>a===r[o]),n||(e.removeRow(t),this.assignRowToGroup(t,this.groups),this.refreshData(!0))}}getExpectedPath(t){var e=[],i=t.getData();return this.groupIDLookups.forEach(r=>{e.push(r.func(i))}),e}updateGroupRows(t){var e=[];return this.blockRedraw||(this.groupList.forEach(i=>{e=e.concat(i.getHeadersAndRows())}),t&&this.refreshData(!0)),e}scrollHeaders(t){this.table.options.groupBy&&(this.table.options.renderHorizontal==="virtual"&&(t-=this.table.columnManager.renderer.vDomPadLeft),t=t+"px",this.groupList.forEach(e=>{e.scrollHeader(t)}))}removeGroup(t){var e=t.level+"_"+t.key,i;this.groups[e]&&(delete this.groups[e],i=this.groupList.indexOf(t),i>-1&&this.groupList.splice(i,1))}checkBasicModeGroupHeaderWidth(){var t=this.table.rowManager.tableElement,e=!0;this.table.rowManager.getDisplayRows().forEach((i,r)=>{this.table.rowManager.styleRow(i,r),t.appendChild(i.getElement()),i.initialize(!0),i.type!=="group"&&(e=!1)}),e?t.style.minWidth=this.table.columnManager.getWidth()+"px":t.style.minWidth=""}}Ne(Qw,"moduleName","groupRows");var gW={cellEdit:function(s){s.component.setValueProcessData(s.data.oldValue),s.component.cellRendered()},rowAdd:function(s){s.component.deleteActual(),this.table.rowManager.checkPlaceholder()},rowDelete:function(s){var t=this.table.rowManager.addRowActual(s.data.data,s.data.pos,s.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(s.component,t),this.table.rowManager.checkPlaceholder()},rowMove:function(s){var t=s.data.posFrom-s.data.posTo>0;this.table.rowManager.moveRowActual(s.component,this.table.rowManager.getRowFromPosition(s.data.posFrom),t),this.table.rowManager.regenerateRowPositions(),this.table.rowManager.reRenderInPosition()}},bW={cellEdit:function(s){s.component.setValueProcessData(s.data.newValue),s.component.cellRendered()},rowAdd:function(s){var t=this.table.rowManager.addRowActual(s.data.data,s.data.pos,s.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(s.component,t),this.table.rowManager.checkPlaceholder()},rowDelete:function(s){s.component.deleteActual(),this.table.rowManager.checkPlaceholder()},rowMove:function(s){this.table.rowManager.moveRowActual(s.component,this.table.rowManager.getRowFromPosition(s.data.posTo),s.data.after),this.table.rowManager.regenerateRowPositions(),this.table.rowManager.reRenderInPosition()}},yW={undo:["ctrl + 90","meta + 90"],redo:["ctrl + 89","meta + 89"]},xW={undo:function(s){var t=!1;this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell,t||(s.preventDefault(),this.table.modules.history.undo()))},redo:function(s){var t=!1;this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell,t||(s.preventDefault(),this.table.modules.history.redo()))}},CW={keybindings:{bindings:yW,actions:xW}};const yn=class yn extends pt{constructor(t){super(t),this.history=[],this.index=-1,this.registerTableOption("history",!1)}initialize(){this.table.options.history&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("cell-delete",this.clearComponentHistory.bind(this)),this.subscribe("row-delete",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clear.bind(this)),this.subscribe("row-added",this.rowAdded.bind(this)),this.subscribe("row-move",this.rowMoved.bind(this))),this.registerTableFunction("undo",this.undo.bind(this)),this.registerTableFunction("redo",this.redo.bind(this)),this.registerTableFunction("getHistoryUndoSize",this.getHistoryUndoSize.bind(this)),this.registerTableFunction("getHistoryRedoSize",this.getHistoryRedoSize.bind(this)),this.registerTableFunction("clearHistory",this.clear.bind(this))}rowMoved(t,e,i){this.action("rowMove",t,{posFrom:t.getPosition(),posTo:e.getPosition(),to:e,after:i})}rowAdded(t,e,i,r){this.action("rowAdd",t,{data:e,pos:i,index:r})}rowDeleted(t){var e,i;this.table.options.groupBy?(i=t.getComponent().getGroup()._getSelf().rows,e=i.indexOf(t),e&&(e=i[e-1])):(e=t.table.rowManager.getRowIndex(t),e&&(e=t.table.rowManager.rows[e-1])),this.action("rowDelete",t,{data:t.getData(),pos:!e,index:e})}cellUpdated(t){this.action("cellEdit",t,{oldValue:t.oldValue,newValue:t.value})}clear(){this.history=[],this.index=-1}action(t,e,i){this.history=this.history.slice(0,this.index+1),this.history.push({type:t,component:e,data:i}),this.index++}getHistoryUndoSize(){return this.index+1}getHistoryRedoSize(){return this.history.length-(this.index+1)}clearComponentHistory(t){var e=this.history.findIndex(function(i){return i.component===t});e>-1&&(this.history.splice(e,1),e<=this.index&&this.index--,this.clearComponentHistory(t))}undo(){if(this.index>-1){let t=this.history[this.index];return yn.undoers[t.type].call(this,t),this.index--,this.dispatchExternal("historyUndo",t.type,t.component.getComponent(),t.data),!0}else return console.warn(this.options("history")?"History Undo Error - No more history to undo":"History module not enabled"),!1}redo(){if(this.history.length-1>this.index){this.index++;let t=this.history[this.index];return yn.redoers[t.type].call(this,t),this.dispatchExternal("historyRedo",t.type,t.component.getComponent(),t.data),!0}else return console.warn(this.options("history")?"History Redo Error - No more history to redo":"History module not enabled"),!1}_rebindRow(t,e){this.history.forEach(function(i){if(i.component instanceof pr)i.component===t&&(i.component=e);else if(i.component instanceof Dh&&i.component.row===t){var r=i.component.column.getField();r&&(i.component=e.getCell(r))}})}};Ne(yn,"moduleName","history"),Ne(yn,"moduleExtensions",CW),Ne(yn,"undoers",gW),Ne(yn,"redoers",bW);let kp=yn;class Zw extends pt{constructor(t){super(t),this.fieldIndex=[],this.hasIndex=!1}initialize(){this.tableElementCheck()}tableElementCheck(){this.table.originalElement&&this.table.originalElement.tagName==="TABLE"&&(this.table.originalElement.childNodes.length?this.parseTable():console.warn("Unable to parse data from empty table tag, Tabulator should be initialized on a div tag unless importing data from a table element."))}parseTable(){var t=this.table.originalElement,e=this.table.options,i=t.getElementsByTagName("th"),r=t.getElementsByTagName("tbody")[0],n=[];this.hasIndex=!1,this.dispatchExternal("htmlImporting"),r=r?r.getElementsByTagName("tr"):[],this._extractOptions(t,e),i.length?this._extractHeaders(i,r):this._generateBlankHeaders(i,r);for(var a=0;a<r.length;a++){var o=r[a],l=o.getElementsByTagName("td"),h={};this.hasIndex||(h[e.index]=a);for(var u=0;u<l.length;u++){var c=l[u];typeof this.fieldIndex[u]<"u"&&(h[this.fieldIndex[u]]=c.innerHTML)}n.push(h)}e.data=n,this.dispatchExternal("htmlImported")}_extractOptions(t,e,i){var r=t.attributes,n=Object.keys(i||e),a={};n.forEach(u=>{a[u.toLowerCase()]=u});for(var o in r){var l=r[o],h;l&&typeof l=="object"&&l.name&&l.name.indexOf("tabulator-")===0&&(h=l.name.replace("tabulator-",""),typeof a[h]<"u"&&(e[a[h]]=this._attribValue(l.value)))}}_attribValue(t){return t==="true"?!0:t==="false"?!1:t}_findCol(t){var e=this.table.options.columns.find(i=>i.title===t);return e||!1}_extractHeaders(t,e){for(var i=0;i<t.length;i++){var r=t[i],n=!1,a=this._findCol(r.textContent),o;a?n=!0:a={title:r.textContent.trim()},a.field||(a.field=r.textContent.trim().toLowerCase().replaceAll(" ","_")),o=r.getAttribute("width"),o&&!a.width&&(a.width=o),this._extractOptions(r,a,this.table.columnManager.optionsList.registeredDefaults),this.fieldIndex[i]=a.field,a.field==this.table.options.index&&(this.hasIndex=!0),n||this.table.options.columns.push(a)}}_generateBlankHeaders(t,e){for(var i=0;i<t.length;i++){var r=t[i],n={title:"",field:"col"+i};this.fieldIndex[i]=n.field;var a=r.getAttribute("width");a&&(n.width=a),this.table.options.columns.push(n)}}}Ne(Zw,"moduleName","htmlTableImport");function wW(s){var t=[],e=0,i=0,r=!1;for(let n=0;n<s.length;n++){let a=s[n],o=s[n+1];if(t[e]||(t[e]=[]),t[e][i]||(t[e][i]=""),a=='"'&&r&&o=='"'){t[e][i]+=a,n++;continue}if(a=='"'){r=!r;continue}if(a==","&&!r){i++;continue}if(a=="\r"&&o=="\n"&&!r){i=0,e++,n++;continue}if((a=="\r"||a=="\n")&&!r){i=0,e++;continue}t[e][i]+=a}return t}function EW(s){try{return JSON.parse(s)}catch(t){return console.warn("JSON Import Error - File contents is invalid JSON",t),Promise.reject()}}function SW(s){return s}function kW(s){var t=this.dependencyRegistry.lookup("XLSX"),e=t.read(s),i=e.Sheets[e.SheetNames[0]];return t.utils.sheet_to_json(i,{header:1})}var TW={csv:wW,json:EW,array:SW,xlsx:kW};const zl=class zl extends pt{constructor(t){super(t),this.registerTableOption("importFormat"),this.registerTableOption("importReader","text"),this.registerTableOption("importHeaderTransform"),this.registerTableOption("importValueTransform"),this.registerTableOption("importDataValidator"),this.registerTableOption("importFileValidator")}initialize(){this.registerTableFunction("import",this.importFromFile.bind(this)),this.table.options.importFormat&&(this.subscribe("data-loading",this.loadDataCheck.bind(this),10),this.subscribe("data-load",this.loadData.bind(this),10))}loadDataCheck(t){return this.table.options.importFormat&&(typeof t=="string"||Array.isArray(t)&&t.length&&Array.isArray(t))}loadData(t,e,i,r,n){return this.importData(this.lookupImporter(),t).then(this.structureData.bind(this)).catch(a=>(console.error("Import Error:",a||"Unable to import data"),Promise.reject(a)))}lookupImporter(t){var e;return t||(t=this.table.options.importFormat),typeof t=="string"?e=zl.importers[t]:e=t,e||console.error("Import Error - Importer not found:",t),e}importFromFile(t,e,i){var r=this.lookupImporter(t);if(r)return this.pickFile(e,i).then(this.importData.bind(this,r)).then(this.structureData.bind(this)).then(this.mutateData.bind(this)).then(this.validateData.bind(this)).then(this.setData.bind(this)).catch(n=>(this.dispatch("import-error",n),this.dispatchExternal("importError",n),console.error("Import Error:",n||"Unable to import file"),this.table.dataLoader.alertError(),setTimeout(()=>{this.table.dataLoader.clearAlert()},3e3),Promise.reject(n)))}pickFile(t,e){return new Promise((i,r)=>{var n=document.createElement("input");n.type="file",n.accept=t,n.addEventListener("change",a=>{var o=n.files[0],l=new FileReader,h=this.validateFile(o);if(h===!0){switch(this.dispatch("import-importing",n.files),this.dispatchExternal("importImporting",n.files),e||this.table.options.importReader){case"buffer":l.readAsArrayBuffer(o);break;case"binary":l.readAsBinaryString(o);break;case"url":l.readAsDataURL(o);break;case"text":default:l.readAsText(o)}l.onload=u=>{i(l.result)},l.onerror=u=>{console.warn("File Load Error - Unable to read file"),r(u)}}else r(h)}),this.dispatch("import-choose"),this.dispatchExternal("importChoose"),n.click()})}importData(t,e){var i;return this.table.dataLoader.alertLoader(),new Promise((r,n)=>{setTimeout(()=>{i=t.call(this.table,e),i instanceof Promise||i?r(i):n()},10)})}structureData(t){var e=[];return Array.isArray(t)&&t.length&&Array.isArray(t[0])?(this.table.options.autoColumns?e=this.structureArrayToObject(t):e=this.structureArrayToColumns(t),e):t}mutateData(t){var e=[];return Array.isArray(t)?t.forEach(i=>{e.push(this.table.modules.mutator.transformRow(i,"import"))}):e=t,e}transformHeader(t){var e=[];if(this.table.options.importHeaderTransform)t.forEach(i=>{e.push(this.table.options.importHeaderTransform.call(this.table,i,t))});else return t;return e}transformData(t){var e=[];if(this.table.options.importValueTransform)t.forEach(i=>{e.push(this.table.options.importValueTransform.call(this.table,i,t))});else return t;return e}structureArrayToObject(t){var e=this.transformHeader(t.shift()),i=t.map(r=>{var n={};return r=this.transformData(r),e.forEach((a,o)=>{n[a]=r[o]}),n});return i}structureArrayToColumns(t){var e=[],i=this.transformHeader(t[0]),r=this.table.getColumns();return r[0]&&i[0]&&r[0].getDefinition().title===i[0]&&t.shift(),t.forEach(n=>{var a={};n=this.transformData(n),n.forEach((o,l)=>{var h=r[l];h&&(a[h.getField()]=o)}),e.push(a)}),e}validateFile(t){return this.table.options.importFileValidator?this.table.options.importFileValidator.call(this.table,t):!0}validateData(t){var e;return this.table.options.importDataValidator?(e=this.table.options.importDataValidator.call(this.table,t),e===!0?t:Promise.reject(e)):t}setData(t){return this.dispatch("import-imported",t),this.dispatchExternal("importImported",t),this.table.dataLoader.clearAlert(),this.table.setData(t)}};Ne(zl,"moduleName","import"),Ne(zl,"importers",TW);let Tp=zl;class eE extends pt{constructor(t){super(t),this.eventMap={rowClick:"row-click",rowDblClick:"row-dblclick",rowContext:"row-contextmenu",rowMouseEnter:"row-mouseenter",rowMouseLeave:"row-mouseleave",rowMouseOver:"row-mouseover",rowMouseOut:"row-mouseout",rowMouseMove:"row-mousemove",rowMouseDown:"row-mousedown",rowMouseUp:"row-mouseup",rowTap:"row",rowDblTap:"row",rowTapHold:"row",cellClick:"cell-click",cellDblClick:"cell-dblclick",cellContext:"cell-contextmenu",cellMouseEnter:"cell-mouseenter",cellMouseLeave:"cell-mouseleave",cellMouseOver:"cell-mouseover",cellMouseOut:"cell-mouseout",cellMouseMove:"cell-mousemove",cellMouseDown:"cell-mousedown",cellMouseUp:"cell-mouseup",cellTap:"cell",cellDblTap:"cell",cellTapHold:"cell",headerClick:"column-click",headerDblClick:"column-dblclick",headerContext:"column-contextmenu",headerMouseEnter:"column-mouseenter",headerMouseLeave:"column-mouseleave",headerMouseOver:"column-mouseover",headerMouseOut:"column-mouseout",headerMouseMove:"column-mousemove",headerMouseDown:"column-mousedown",headerMouseUp:"column-mouseup",headerTap:"column",headerDblTap:"column",headerTapHold:"column",groupClick:"group-click",groupDblClick:"group-dblclick",groupContext:"group-contextmenu",groupMouseEnter:"group-mouseenter",groupMouseLeave:"group-mouseleave",groupMouseOver:"group-mouseover",groupMouseOut:"group-mouseout",groupMouseMove:"group-mousemove",groupMouseDown:"group-mousedown",groupMouseUp:"group-mouseup",groupTap:"group",groupDblTap:"group",groupTapHold:"group"},this.subscribers={},this.touchSubscribers={},this.columnSubscribers={},this.touchWatchers={row:{tap:null,tapDbl:null,tapHold:null},cell:{tap:null,tapDbl:null,tapHold:null},column:{tap:null,tapDbl:null,tapHold:null},group:{tap:null,tapDbl:null,tapHold:null}},this.registerColumnOption("headerClick"),this.registerColumnOption("headerDblClick"),this.registerColumnOption("headerContext"),this.registerColumnOption("headerMouseEnter"),this.registerColumnOption("headerMouseLeave"),this.registerColumnOption("headerMouseOver"),this.registerColumnOption("headerMouseOut"),this.registerColumnOption("headerMouseMove"),this.registerColumnOption("headerMouseDown"),this.registerColumnOption("headerMouseUp"),this.registerColumnOption("headerTap"),this.registerColumnOption("headerDblTap"),this.registerColumnOption("headerTapHold"),this.registerColumnOption("cellClick"),this.registerColumnOption("cellDblClick"),this.registerColumnOption("cellContext"),this.registerColumnOption("cellMouseEnter"),this.registerColumnOption("cellMouseLeave"),this.registerColumnOption("cellMouseOver"),this.registerColumnOption("cellMouseOut"),this.registerColumnOption("cellMouseMove"),this.registerColumnOption("cellMouseDown"),this.registerColumnOption("cellMouseUp"),this.registerColumnOption("cellTap"),this.registerColumnOption("cellDblTap"),this.registerColumnOption("cellTapHold")}initialize(){this.initializeExternalEvents(),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("cell-dblclick",this.cellContentsSelectionFixer.bind(this)),this.subscribe("scroll-horizontal",this.clearTouchWatchers.bind(this)),this.subscribe("scroll-vertical",this.clearTouchWatchers.bind(this))}clearTouchWatchers(){var t=Object.values(this.touchWatchers);t.forEach(e=>{for(let i in e)e[i]=null})}cellContentsSelectionFixer(t,e){var i;if(!(this.table.modExists("edit")&&this.table.modules.edit.currentCell===e)){t.preventDefault();try{document.selection?(i=document.body.createTextRange(),i.moveToElementText(e.getElement()),i.select()):window.getSelection&&(i=document.createRange(),i.selectNode(e.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(i))}catch(r){}}}initializeExternalEvents(){for(let t in this.eventMap)this.subscriptionChangeExternal(t,this.subscriptionChanged.bind(this,t))}subscriptionChanged(t,e){e?this.subscribers[t]||(this.eventMap[t].includes("-")?(this.subscribers[t]=this.handle.bind(this,t),this.subscribe(this.eventMap[t],this.subscribers[t])):this.subscribeTouchEvents(t)):this.eventMap[t].includes("-")?this.subscribers[t]&&!this.columnSubscribers[t]&&!this.subscribedExternal(t)&&(this.unsubscribe(this.eventMap[t],this.subscribers[t]),delete this.subscribers[t]):this.unsubscribeTouchEvents(t)}subscribeTouchEvents(t){var e=this.eventMap[t];this.touchSubscribers[e+"-touchstart"]||(this.touchSubscribers[e+"-touchstart"]=this.handleTouch.bind(this,e,"start"),this.touchSubscribers[e+"-touchend"]=this.handleTouch.bind(this,e,"end"),this.subscribe(e+"-touchstart",this.touchSubscribers[e+"-touchstart"]),this.subscribe(e+"-touchend",this.touchSubscribers[e+"-touchend"])),this.subscribers[t]=!0}unsubscribeTouchEvents(t){var e=!0,i=this.eventMap[t];if(this.subscribers[t]&&!this.subscribedExternal(t)){delete this.subscribers[t];for(let r in this.eventMap)this.eventMap[r]===i&&this.subscribers[r]&&(e=!1);e&&(this.unsubscribe(i+"-touchstart",this.touchSubscribers[i+"-touchstart"]),this.unsubscribe(i+"-touchend",this.touchSubscribers[i+"-touchend"]),delete this.touchSubscribers[i+"-touchstart"],delete this.touchSubscribers[i+"-touchend"])}}initializeColumn(t){var e=t.definition;for(let i in this.eventMap)e[i]&&(this.subscriptionChanged(i,!0),this.columnSubscribers[i]||(this.columnSubscribers[i]=[]),this.columnSubscribers[i].push(t))}handle(t,e,i){this.dispatchEvent(t,e,i)}handleTouch(t,e,i,r){var n=this.touchWatchers[t];switch(t==="column"&&(t="header"),e){case"start":n.tap=!0,clearTimeout(n.tapHold),n.tapHold=setTimeout(()=>{clearTimeout(n.tapHold),n.tapHold=null,n.tap=null,clearTimeout(n.tapDbl),n.tapDbl=null,this.dispatchEvent(t+"TapHold",i,r)},1e3);break;case"end":n.tap&&(n.tap=null,this.dispatchEvent(t+"Tap",i,r)),n.tapDbl?(clearTimeout(n.tapDbl),n.tapDbl=null,this.dispatchEvent(t+"DblTap",i,r)):n.tapDbl=setTimeout(()=>{clearTimeout(n.tapDbl),n.tapDbl=null},300),clearTimeout(n.tapHold),n.tapHold=null;break}}dispatchEvent(t,e,i){var r=i.getComponent(),n;this.columnSubscribers[t]&&(i instanceof Dh?n=i.column.definition[t]:i instanceof pa&&(n=i.definition[t]),n&&n(e,r)),this.dispatchExternal(t,e,r)}}Ne(eE,"moduleName","interaction");var AW={navPrev:"shift + 9",navNext:9,navUp:38,navDown:40,navLeft:37,navRight:39,scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35},OW={keyBlock:function(s){s.stopPropagation(),s.preventDefault()},scrollPageUp:function(s){var t=this.table.rowManager,e=t.scrollTop-t.element.clientHeight;s.preventDefault(),t.displayRowsCount&&(e>=0?t.element.scrollTop=e:t.scrollToRow(t.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(s){var t=this.table.rowManager,e=t.scrollTop+t.element.clientHeight,i=t.element.scrollHeight;s.preventDefault(),t.displayRowsCount&&(e<=i?t.element.scrollTop=e:t.scrollToRow(t.getDisplayRows()[t.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(s){var t=this.table.rowManager;s.preventDefault(),t.displayRowsCount&&t.scrollToRow(t.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(s){var t=this.table.rowManager;s.preventDefault(),t.displayRowsCount&&t.scrollToRow(t.getDisplayRows()[t.displayRowsCount-1]),this.table.element.focus()},navPrev:function(s){this.dispatch("keybinding-nav-prev",s)},navNext:function(s){this.dispatch("keybinding-nav-next",s)},navLeft:function(s){this.dispatch("keybinding-nav-left",s)},navRight:function(s){this.dispatch("keybinding-nav-right",s)},navUp:function(s){this.dispatch("keybinding-nav-up",s)},navDown:function(s){this.dispatch("keybinding-nav-down",s)}};const xn=class xn extends pt{constructor(t){super(t),this.watchKeys=null,this.pressedKeys=null,this.keyupBinding=!1,this.keydownBinding=!1,this.registerTableOption("keybindings",{}),this.registerTableOption("tabEndNewRow",!1)}initialize(){var t=this.table.options.keybindings,e={};this.watchKeys={},this.pressedKeys=[],t!==!1&&(Object.assign(e,xn.bindings),Object.assign(e,t),this.mapBindings(e),this.bindEvents()),this.subscribe("table-destroy",this.clearBindings.bind(this))}mapBindings(t){for(let e in t)xn.actions[e]?t[e]&&(typeof t[e]!="object"&&(t[e]=[t[e]]),t[e].forEach(i=>{var r=Array.isArray(i)?i:[i];r.forEach(n=>{this.mapBinding(e,n)})})):console.warn("Key Binding Error - no such action:",e)}mapBinding(t,e){var i={action:xn.actions[t],keys:[],ctrl:!1,shift:!1,meta:!1},r=e.toString().toLowerCase().split(" ").join("").split("+");r.forEach(n=>{switch(n){case"ctrl":i.ctrl=!0;break;case"shift":i.shift=!0;break;case"meta":i.meta=!0;break;default:n=isNaN(n)?n.toUpperCase().charCodeAt(0):parseInt(n),i.keys.push(n),this.watchKeys[n]||(this.watchKeys[n]=[]),this.watchKeys[n].push(i)}})}bindEvents(){var t=this;this.keyupBinding=function(e){var i=e.keyCode,r=t.watchKeys[i];r&&(t.pressedKeys.push(i),r.forEach(function(n){t.checkBinding(e,n)}))},this.keydownBinding=function(e){var i=e.keyCode,r=t.watchKeys[i];if(r){var n=t.pressedKeys.indexOf(i);n>-1&&t.pressedKeys.splice(n,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)}clearBindings(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)}checkBinding(t,e){var i=!0;return t.ctrlKey==e.ctrl&&t.shiftKey==e.shift&&t.metaKey==e.meta?(e.keys.forEach(r=>{var n=this.pressedKeys.indexOf(r);n==-1&&(i=!1)}),i&&e.action.call(this,t),!0):!1}};Ne(xn,"moduleName","keybindings"),Ne(xn,"bindings",AW),Ne(xn,"actions",OW);let Ap=xn;class tE extends pt{constructor(t){super(t),this.menuContainer=null,this.nestedMenuBlock=!1,this.currentComponent=null,this.rootPopup=null,this.columnSubscribers={},this.registerTableOption("rowContextMenu",!1),this.registerTableOption("rowClickMenu",!1),this.registerTableOption("rowDblClickMenu",!1),this.registerTableOption("groupContextMenu",!1),this.registerTableOption("groupClickMenu",!1),this.registerTableOption("groupDblClickMenu",!1),this.registerColumnOption("headerContextMenu"),this.registerColumnOption("headerClickMenu"),this.registerColumnOption("headerDblClickMenu"),this.registerColumnOption("headerMenu"),this.registerColumnOption("headerMenuIcon"),this.registerColumnOption("contextMenu"),this.registerColumnOption("clickMenu"),this.registerColumnOption("dblClickMenu")}initialize(){this.deprecatedOptionsCheck(),this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){}initializeRowWatchers(){this.table.options.rowContextMenu&&(this.subscribe("row-contextmenu",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu)),this.table.on("rowTapHold",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu))),this.table.options.rowClickMenu&&this.subscribe("row-click",this.loadMenuEvent.bind(this,this.table.options.rowClickMenu)),this.table.options.rowDblClickMenu&&this.subscribe("row-dblclick",this.loadMenuEvent.bind(this,this.table.options.rowDblClickMenu))}initializeGroupWatchers(){this.table.options.groupContextMenu&&(this.subscribe("group-contextmenu",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu)),this.table.on("groupTapHold",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu))),this.table.options.groupClickMenu&&this.subscribe("group-click",this.loadMenuEvent.bind(this,this.table.options.groupClickMenu)),this.table.options.groupDblClickMenu&&this.subscribe("group-dblclick",this.loadMenuEvent.bind(this,this.table.options.groupDblClickMenu))}initializeColumn(t){var e=t.definition;e.headerContextMenu&&!this.columnSubscribers.headerContextMenu&&(this.columnSubscribers.headerContextMenu=this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextMenu),this.table.on("headerTapHold",this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"))),e.headerClickMenu&&!this.columnSubscribers.headerClickMenu&&(this.columnSubscribers.headerClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerClickMenu"),this.subscribe("column-click",this.columnSubscribers.headerClickMenu)),e.headerDblClickMenu&&!this.columnSubscribers.headerDblClickMenu&&(this.columnSubscribers.headerDblClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerDblClickMenu"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickMenu)),e.headerMenu&&this.initializeColumnHeaderMenu(t),e.contextMenu&&!this.columnSubscribers.contextMenu&&(this.columnSubscribers.contextMenu=this.loadMenuTableCellEvent.bind(this,"contextMenu"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextMenu),this.table.on("cellTapHold",this.loadMenuTableCellEvent.bind(this,"contextMenu"))),e.clickMenu&&!this.columnSubscribers.clickMenu&&(this.columnSubscribers.clickMenu=this.loadMenuTableCellEvent.bind(this,"clickMenu"),this.subscribe("cell-click",this.columnSubscribers.clickMenu)),e.dblClickMenu&&!this.columnSubscribers.dblClickMenu&&(this.columnSubscribers.dblClickMenu=this.loadMenuTableCellEvent.bind(this,"dblClickMenu"),this.subscribe("cell-dblclick",this.columnSubscribers.dblClickMenu))}initializeColumnHeaderMenu(t){var e=t.definition.headerMenuIcon,i;i=document.createElement("span"),i.classList.add("tabulator-header-popup-button"),e?(typeof e=="function"&&(e=e(t.getComponent())),e instanceof HTMLElement?i.appendChild(e):i.innerHTML=e):i.innerHTML="&vellip;",i.addEventListener("click",r=>{r.stopPropagation(),r.preventDefault(),this.loadMenuEvent(t.definition.headerMenu,r,t)}),t.titleElement.insertBefore(i,t.titleElement.firstChild)}loadMenuTableCellEvent(t,e,i){i._cell&&(i=i._cell),i.column.definition[t]&&this.loadMenuEvent(i.column.definition[t],e,i)}loadMenuTableColumnEvent(t,e,i){i._column&&(i=i._column),i.definition[t]&&this.loadMenuEvent(i.definition[t],e,i)}loadMenuEvent(t,e,i){i._group?i=i._group:i._row&&(i=i._row),t=typeof t=="function"?t.call(this.table,e,i.getComponent()):t,this.loadMenu(e,i,t)}loadMenu(t,e,i,r,n){var a=!(t instanceof MouseEvent),o=document.createElement("div"),l;if(o.classList.add("tabulator-menu"),a||t.preventDefault(),!(!i||!i.length)){if(r)l=n.child(o);else{if(this.nestedMenuBlock){if(this.rootPopup)return}else this.nestedMenuBlock=setTimeout(()=>{this.nestedMenuBlock=!1},100);this.rootPopup&&this.rootPopup.hide(),this.rootPopup=l=this.popup(o)}i.forEach(h=>{var u=document.createElement("div"),c=h.label,f=h.disabled;h.separator?u.classList.add("tabulator-menu-separator"):(u.classList.add("tabulator-menu-item"),typeof c=="function"&&(c=c.call(this.table,e.getComponent())),c instanceof Node?u.appendChild(c):u.innerHTML=c,typeof f=="function"&&(f=f.call(this.table,e.getComponent())),f?(u.classList.add("tabulator-menu-item-disabled"),u.addEventListener("click",d=>{d.stopPropagation()})):h.menu&&h.menu.length?u.addEventListener("click",d=>{d.stopPropagation(),this.loadMenu(d,e,h.menu,u,l)}):h.action&&u.addEventListener("click",d=>{h.action(d,e.getComponent())}),h.menu&&h.menu.length&&u.classList.add("tabulator-menu-item-submenu")),o.appendChild(u)}),o.addEventListener("click",h=>{this.rootPopup&&this.rootPopup.hide()}),l.show(r||t),l===this.rootPopup&&(this.rootPopup.hideOnBlur(()=>{this.rootPopup=null,this.currentComponent&&(this.dispatch("menu-closed",i,l),this.dispatchExternal("menuClosed",this.currentComponent.getComponent()),this.currentComponent=null)}),this.currentComponent=e,this.dispatch("menu-opened",i,l),this.dispatchExternal("menuOpened",e.getComponent()))}}}Ne(tE,"moduleName","menu");class iE extends pt{constructor(t){super(t),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=250,this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.startX=0,this.autoScrollMargin=40,this.autoScrollStep=5,this.autoScrollTimeout=!1,this.touchMove=!1,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.registerTableOption("movableColumns",!1)}createPlaceholderElement(){var t=document.createElement("div");return t.classList.add("tabulator-col"),t.classList.add("tabulator-col-placeholder"),t}initialize(){this.table.options.movableColumns&&(this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("alert-show",this.abortMove.bind(this)))}abortMove(){clearTimeout(this.checkTimeout)}initializeColumn(t){var e=this,i={},r;!t.modules.frozen&&!t.isGroup&&!t.isRowHeader&&(r=t.getElement(),i.mousemove=(function(n){t.parent===e.moving.parent&&((e.touchMove?n.touches[0].pageX:n.pageX)-$t.elOffset(r).left+e.table.columnManager.contentsElement.scrollLeft>t.getWidth()/2?(e.toCol!==t||!e.toColAfter)&&(r.parentNode.insertBefore(e.placeholderElement,r.nextSibling),e.moveColumn(t,!0)):(e.toCol!==t||e.toColAfter)&&(r.parentNode.insertBefore(e.placeholderElement,r),e.moveColumn(t,!1)))}).bind(e),r.addEventListener("mousedown",function(n){e.touchMove=!1,n.which===1&&(e.checkTimeout=setTimeout(function(){e.startMove(n,t)},e.checkPeriod))}),r.addEventListener("mouseup",function(n){n.which===1&&e.checkTimeout&&clearTimeout(e.checkTimeout)}),e.bindTouchEvents(t)),t.modules.moveColumn=i}bindTouchEvents(t){var e=t.getElement(),i=!1,r,n,a,o,l,h;e.addEventListener("touchstart",u=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,r=t.nextColumn(),a=r?r.getWidth()/2:0,n=t.prevColumn(),o=n?n.getWidth()/2:0,l=0,h=0,i=!1,this.startMove(u,t)},this.checkPeriod)},{passive:!0}),e.addEventListener("touchmove",u=>{var c,f;this.moving&&(this.moveHover(u),i||(i=u.touches[0].pageX),c=u.touches[0].pageX-i,c>0?r&&c-l>a&&(f=r,f!==t&&(i=u.touches[0].pageX,f.getElement().parentNode.insertBefore(this.placeholderElement,f.getElement().nextSibling),this.moveColumn(f,!0))):n&&-c-h>o&&(f=n,f!==t&&(i=u.touches[0].pageX,f.getElement().parentNode.insertBefore(this.placeholderElement,f.getElement()),this.moveColumn(f,!1))),f&&(r=f.nextColumn(),l=a,a=r?r.getWidth()/2:0,n=f.prevColumn(),h=o,o=n?n.getWidth()/2:0))},{passive:!0}),e.addEventListener("touchend",u=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&this.endMove(u)})}startMove(t,e){var i=e.getElement(),r=this.table.columnManager.getContentsElement(),n=this.table.columnManager.getHeadersElement();this.table.modules.selectRange&&this.table.modules.selectRange.columnSelection&&this.table.modules.selectRange.mousedown&&this.table.modules.selectRange.selecting==="column"||(this.moving=e,this.startX=(this.touchMove?t.touches[0].pageX:t.pageX)-$t.elOffset(i).left,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=e.getWidth()+"px",this.placeholderElement.style.height=e.getHeight()+"px",i.parentNode.insertBefore(this.placeholderElement,i),i.parentNode.removeChild(i),this.hoverElement=i.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),r.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.bottom=r.clientHeight-n.offsetHeight+"px",this.touchMove||(this._bindMouseMove(),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove)),this.moveHover(t),this.dispatch("column-moving",t,this.moving))}_bindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(t){t.modules.moveColumn.mousemove&&t.getElement().addEventListener("mousemove",t.modules.moveColumn.mousemove)})}_unbindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(t){t.modules.moveColumn.mousemove&&t.getElement().removeEventListener("mousemove",t.modules.moveColumn.mousemove)})}moveColumn(t,e){var i=this.moving.getCells();this.toCol=t,this.toColAfter=e,e?t.getCells().forEach(function(r,n){var a=r.getElement(!0);a.parentNode&&i[n]&&a.parentNode.insertBefore(i[n].getElement(),a.nextSibling)}):t.getCells().forEach(function(r,n){var a=r.getElement(!0);a.parentNode&&i[n]&&a.parentNode.insertBefore(i[n].getElement(),a)})}endMove(t){(t.which===1||this.touchMove)&&(this._unbindMouseMove(),this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toCol&&this.table.columnManager.moveColumnActual(this.moving,this.toCol,this.toColAfter),this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.touchMove||(document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove)))}moveHover(t){var e=this.table.columnManager.getContentsElement(),i=e.scrollLeft,r=(this.touchMove?t.touches[0].pageX:t.pageX)-$t.elOffset(e).left+i,n;this.hoverElement.style.left=r-this.startX+"px",r-i<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{n=Math.max(0,i-5),this.table.rowManager.getElement().scrollLeft=n,this.autoScrollTimeout=!1},1))),i+e.clientWidth-r<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{n=Math.min(e.clientWidth,i+5),this.table.rowManager.getElement().scrollLeft=n,this.autoScrollTimeout=!1},1)))}}Ne(iE,"moduleName","moveColumn");var DW={delete:function(s,t,e){s.delete()}},LW={insert:function(s,t,e){return this.table.addRow(s.getData(),void 0,t),!0},add:function(s,t,e){return this.table.addRow(s.getData()),!0},update:function(s,t,e){return t?(t.update(s.getData()),!0):!1},replace:function(s,t,e){return t?(this.table.addRow(s.getData(),void 0,t),t.delete(),!0):!1}};const na=class na extends pt{constructor(t){super(t),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=150,this.moving=!1,this.toRow=!1,this.toRowAfter=!1,this.hasHandle=!1,this.startY=0,this.startX=0,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.tableRowDropEvent=!1,this.touchMove=!1,this.connection=!1,this.connectionSelectorsTables=!1,this.connectionSelectorsElements=!1,this.connectionElements=[],this.connections=[],this.connectedTable=!1,this.connectedRow=!1,this.registerTableOption("movableRows",!1),this.registerTableOption("movableRowsConnectedTables",!1),this.registerTableOption("movableRowsConnectedElements",!1),this.registerTableOption("movableRowsSender",!1),this.registerTableOption("movableRowsReceiver","insert"),this.registerColumnOption("rowHandle")}createPlaceholderElement(){var t=document.createElement("div");return t.classList.add("tabulator-row"),t.classList.add("tabulator-row-placeholder"),t}initialize(){this.table.options.movableRows&&(this.connectionSelectorsTables=this.table.options.movableRowsConnectedTables,this.connectionSelectorsElements=this.table.options.movableRowsConnectedElements,this.connection=this.connectionSelectorsTables||this.connectionSelectorsElements,this.subscribe("cell-init",this.initializeCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)))}initializeGroupHeader(t){var e=this,i={};i.mouseup=(function(r){e.tableRowDrop(r,t)}).bind(e),i.mousemove=(function(r){var n;r.pageY-$t.elOffset(t.element).top+e.table.rowManager.element.scrollTop>t.getHeight()/2?(e.toRow!==t||!e.toRowAfter)&&(n=t.getElement(),n.parentNode.insertBefore(e.placeholderElement,n.nextSibling),e.moveRow(t,!0)):(e.toRow!==t||e.toRowAfter)&&(n=t.getElement(),n.previousSibling&&(n.parentNode.insertBefore(e.placeholderElement,n),e.moveRow(t,!1)))}).bind(e),t.modules.moveRow=i}initializeRow(t){var e=this,i={},r;i.mouseup=(function(n){e.tableRowDrop(n,t)}).bind(e),i.mousemove=(function(n){var a=t.getElement();n.pageY-$t.elOffset(a).top+e.table.rowManager.element.scrollTop>t.getHeight()/2?(e.toRow!==t||!e.toRowAfter)&&(a.parentNode.insertBefore(e.placeholderElement,a.nextSibling),e.moveRow(t,!0)):(e.toRow!==t||e.toRowAfter)&&(a.parentNode.insertBefore(e.placeholderElement,a),e.moveRow(t,!1))}).bind(e),this.hasHandle||(r=t.getElement(),r.addEventListener("mousedown",function(n){n.which===1&&(e.checkTimeout=setTimeout(function(){e.startMove(n,t)},e.checkPeriod))}),r.addEventListener("mouseup",function(n){n.which===1&&e.checkTimeout&&clearTimeout(e.checkTimeout)}),this.bindTouchEvents(t,t.getElement())),t.modules.moveRow=i}initializeColumn(t){t.definition.rowHandle&&this.table.options.movableRows!==!1&&(this.hasHandle=!0)}initializeCell(t){if(t.column.definition.rowHandle&&this.table.options.movableRows!==!1){var e=this,i=t.getElement(!0);i.addEventListener("mousedown",function(r){r.which===1&&(e.checkTimeout=setTimeout(function(){e.startMove(r,t.row)},e.checkPeriod))}),i.addEventListener("mouseup",function(r){r.which===1&&e.checkTimeout&&clearTimeout(e.checkTimeout)}),this.bindTouchEvents(t.row,i)}}bindTouchEvents(t,e){var i=!1,r,n,a,o,l,h;e.addEventListener("touchstart",u=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,r=t.nextRow(),a=r?r.getHeight()/2:0,n=t.prevRow(),o=n?n.getHeight()/2:0,l=0,h=0,i=!1,this.startMove(u,t)},this.checkPeriod)},{passive:!0}),this.moving,this.toRow,this.toRowAfter,e.addEventListener("touchmove",u=>{var c,f;this.moving&&(u.preventDefault(),this.moveHover(u),i||(i=u.touches[0].pageY),c=u.touches[0].pageY-i,c>0?r&&c-l>a&&(f=r,f!==t&&(i=u.touches[0].pageY,f.getElement().parentNode.insertBefore(this.placeholderElement,f.getElement().nextSibling),this.moveRow(f,!0))):n&&-c-h>o&&(f=n,f!==t&&(i=u.touches[0].pageY,f.getElement().parentNode.insertBefore(this.placeholderElement,f.getElement()),this.moveRow(f,!1))),f&&(r=f.nextRow(),l=a,a=r?r.getHeight()/2:0,n=f.prevRow(),h=o,o=n?n.getHeight()/2:0))}),e.addEventListener("touchend",u=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&(this.endMove(u),this.touchMove=!1)})}_bindMouseMove(){this.table.rowManager.getDisplayRows().forEach(t=>{(t.type==="row"||t.type==="group")&&t.modules.moveRow&&t.modules.moveRow.mousemove&&t.getElement().addEventListener("mousemove",t.modules.moveRow.mousemove)})}_unbindMouseMove(){this.table.rowManager.getDisplayRows().forEach(t=>{(t.type==="row"||t.type==="group")&&t.modules.moveRow&&t.modules.moveRow.mousemove&&t.getElement().removeEventListener("mousemove",t.modules.moveRow.mousemove)})}startMove(t,e){var i=e.getElement();this.setStartPosition(t,e),this.moving=e,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=e.getWidth()+"px",this.placeholderElement.style.height=e.getHeight()+"px",this.connection?(this.table.element.classList.add("tabulator-movingrow-sending"),this.connectToTables(e)):(i.parentNode.insertBefore(this.placeholderElement,i),i.parentNode.removeChild(i)),this.hoverElement=i.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.connection?(document.body.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this.hoverElement.style.width=this.table.element.clientWidth+"px",this.hoverElement.style.whiteSpace="nowrap",this.hoverElement.style.overflow="hidden",this.hoverElement.style.pointerEvents="none"):(this.table.rowManager.getTableElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this._bindMouseMove()),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove),this.dispatchExternal("rowMoving",e.getComponent()),this.moveHover(t)}setStartPosition(t,e){var i=this.touchMove?t.touches[0].pageX:t.pageX,r=this.touchMove?t.touches[0].pageY:t.pageY,n,a;n=e.getElement(),this.connection?(a=n.getBoundingClientRect(),this.startX=a.left-i+window.pageXOffset,this.startY=a.top-r+window.pageYOffset):this.startY=r-n.getBoundingClientRect().top}endMove(t){(!t||t.which===1||this.touchMove)&&(this._unbindMouseMove(),this.connection||(this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement)),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toRow?this.table.rowManager.moveRow(this.moving,this.toRow,this.toRowAfter):this.dispatchExternal("rowMoveCancelled",this.moving.getComponent()),this.moving=!1,this.toRow=!1,this.toRowAfter=!1,document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove),this.connection&&(this.table.element.classList.remove("tabulator-movingrow-sending"),this.disconnectFromTables()))}moveRow(t,e){this.toRow=t,this.toRowAfter=e}moveHover(t){this.connection?this.moveHoverConnections.call(this,t):this.moveHoverTable.call(this,t)}moveHoverTable(t){var e=this.table.rowManager.getElement(),i=e.scrollTop,r=(this.touchMove?t.touches[0].pageY:t.pageY)-e.getBoundingClientRect().top+i;this.hoverElement.style.top=Math.min(r-this.startY,this.table.rowManager.element.scrollHeight-this.hoverElement.offsetHeight)+"px"}moveHoverConnections(t){this.hoverElement.style.left=this.startX+(this.touchMove?t.touches[0].pageX:t.pageX)+"px",this.hoverElement.style.top=this.startY+(this.touchMove?t.touches[0].pageY:t.pageY)+"px"}elementRowDrop(t,e,i){this.dispatchExternal("movableRowsElementDrop",t,e,i?i.getComponent():!1)}connectToTables(t){var e;this.connectionSelectorsTables&&(e=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStart",e),this.commsSend(this.connectionSelectorsTables,"moveRow","connect",{row:t})),this.connectionSelectorsElements&&(this.connectionElements=[],Array.isArray(this.connectionSelectorsElements)||(this.connectionSelectorsElements=[this.connectionSelectorsElements]),this.connectionSelectorsElements.forEach(i=>{typeof i=="string"?this.connectionElements=this.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(i))):this.connectionElements.push(i)}),this.connectionElements.forEach(i=>{var r=n=>{this.elementRowDrop(n,i,this.moving)};i.addEventListener("mouseup",r),i.tabulatorElementDropEvent=r,i.classList.add("tabulator-movingrow-receiving")}))}disconnectFromTables(){var t;this.connectionSelectorsTables&&(t=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStop",t),this.commsSend(this.connectionSelectorsTables,"moveRow","disconnect")),this.connectionElements.forEach(e=>{e.classList.remove("tabulator-movingrow-receiving"),e.removeEventListener("mouseup",e.tabulatorElementDropEvent),delete e.tabulatorElementDropEvent})}connect(t,e){return this.connectedTable?(console.warn("Move Row Error - Table cannot accept connection, already connected to table:",this.connectedTable),!1):(this.connectedTable=t,this.connectedRow=e,this.table.element.classList.add("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(i=>{i.type==="row"&&i.modules.moveRow&&i.modules.moveRow.mouseup&&i.getElement().addEventListener("mouseup",i.modules.moveRow.mouseup)}),this.tableRowDropEvent=this.tableRowDrop.bind(this),this.table.element.addEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStart",e,t),!0)}disconnect(t){t===this.connectedTable?(this.connectedTable=!1,this.connectedRow=!1,this.table.element.classList.remove("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(e=>{e.type==="row"&&e.modules.moveRow&&e.modules.moveRow.mouseup&&e.getElement().removeEventListener("mouseup",e.modules.moveRow.mouseup)}),this.table.element.removeEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStop",t)):console.warn("Move Row Error - trying to disconnect from non connected table")}dropComplete(t,e,i){var r=!1;if(i){switch(typeof this.table.options.movableRowsSender){case"string":r=na.senders[this.table.options.movableRowsSender];break;case"function":r=this.table.options.movableRowsSender;break}r?r.call(this,this.moving?this.moving.getComponent():void 0,e?e.getComponent():void 0,t):this.table.options.movableRowsSender&&console.warn("Mover Row Error - no matching sender found:",this.table.options.movableRowsSender),this.dispatchExternal("movableRowsSent",this.moving.getComponent(),e?e.getComponent():void 0,t)}else this.dispatchExternal("movableRowsSentFailed",this.moving.getComponent(),e?e.getComponent():void 0,t);this.endMove()}tableRowDrop(t,e){var i=!1,r=!1;switch(t.stopImmediatePropagation(),typeof this.table.options.movableRowsReceiver){case"string":i=na.receivers[this.table.options.movableRowsReceiver];break;case"function":i=this.table.options.movableRowsReceiver;break}i?r=i.call(this,this.connectedRow.getComponent(),e?e.getComponent():void 0,this.connectedTable):console.warn("Mover Row Error - no matching receiver found:",this.table.options.movableRowsReceiver),r?this.dispatchExternal("movableRowsReceived",this.connectedRow.getComponent(),e?e.getComponent():void 0,this.connectedTable):this.dispatchExternal("movableRowsReceivedFailed",this.connectedRow.getComponent(),e?e.getComponent():void 0,this.connectedTable),this.commsSend(this.connectedTable,"moveRow","dropcomplete",{row:e,success:r})}commsReceived(t,e,i){switch(e){case"connect":return this.connect(t,i.row);case"disconnect":return this.disconnect(t);case"dropcomplete":return this.dropComplete(t,i.row,i.success)}}};Ne(na,"moduleName","moveRow"),Ne(na,"senders",DW),Ne(na,"receivers",LW);let Op=na;var RW={};const co=class co extends pt{constructor(t){super(t),this.allowedTypes=["","data","edit","clipboard","import"],this.enabled=!0,this.registerColumnOption("mutator"),this.registerColumnOption("mutatorParams"),this.registerColumnOption("mutatorData"),this.registerColumnOption("mutatorDataParams"),this.registerColumnOption("mutatorEdit"),this.registerColumnOption("mutatorEditParams"),this.registerColumnOption("mutatorClipboard"),this.registerColumnOption("mutatorClipboardParams"),this.registerColumnOption("mutatorImport"),this.registerColumnOption("mutatorImportParams"),this.registerColumnOption("mutateLink")}initialize(){this.subscribe("cell-value-changing",this.transformCell.bind(this)),this.subscribe("cell-value-changed",this.mutateLink.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-init-before",this.rowDataChanged.bind(this)),this.subscribe("row-data-changing",this.rowDataChanged.bind(this))}rowDataChanged(t,e,i){return this.transformRow(e,"data",i)}initializeColumn(t){var e=!1,i={};this.allowedTypes.forEach(r=>{var n="mutator"+(r.charAt(0).toUpperCase()+r.slice(1)),a;t.definition[n]&&(a=this.lookupMutator(t.definition[n]),a&&(e=!0,i[n]={mutator:a,params:t.definition[n+"Params"]||{}}))}),e&&(t.modules.mutate=i)}lookupMutator(t){var e=!1;switch(typeof t){case"string":co.mutators[t]?e=co.mutators[t]:console.warn("Mutator Error - No such mutator found, ignoring: ",t);break;case"function":e=t;break}return e}transformRow(t,e,i){var r="mutator"+(e.charAt(0).toUpperCase()+e.slice(1)),n;return this.enabled&&this.table.columnManager.traverse(a=>{var o,l,h;a.modules.mutate&&(o=a.modules.mutate[r]||a.modules.mutate.mutator||!1,o&&(n=a.getFieldValue(typeof i<"u"?i:t),(e=="data"&&!i||typeof n<"u")&&(h=a.getComponent(),l=typeof o.params=="function"?o.params(n,t,e,h):o.params,a.setFieldValue(t,o.mutator(n,t,e,l,h)))))}),t}transformCell(t,e){if(t.column.modules.mutate){var i=t.column.modules.mutate.mutatorEdit||t.column.modules.mutate.mutator||!1,r={};if(i)return r=Object.assign(r,t.row.getData()),t.column.setFieldValue(r,e),i.mutator(e,r,"edit",i.params,t.getComponent())}return e}mutateLink(t){var e=t.column.definition.mutateLink;e&&(Array.isArray(e)||(e=[e]),e.forEach(i=>{var r=t.row.getCell(i);r&&r.setValue(r.getValue(),!0,!0)}))}enable(){this.enabled=!0}disable(){this.enabled=!1}};Ne(co,"moduleName","mutator"),Ne(co,"mutators",RW);let Dp=co;function IW(s,t,e,i,r){var n=document.createElement("span"),a=document.createElement("span"),o=document.createElement("span"),l=document.createElement("span"),h=document.createElement("span"),u=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",c=>{a.innerHTML=c}),this.table.modules.localize.langBind("pagination|counter|of",c=>{l.innerHTML=c}),this.table.modules.localize.langBind("pagination|counter|rows",c=>{u.innerHTML=c}),i?(o.innerHTML=" "+t+"-"+Math.min(t+s-1,i)+" ",h.innerHTML=" "+i+" ",n.appendChild(a),n.appendChild(o),n.appendChild(l),n.appendChild(h),n.appendChild(u)):(o.innerHTML=" 0 ",n.appendChild(a),n.appendChild(o),n.appendChild(u)),n}function _W(s,t,e,i,r){var n=document.createElement("span"),a=document.createElement("span"),o=document.createElement("span"),l=document.createElement("span"),h=document.createElement("span"),u=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",c=>{a.innerHTML=c}),o.innerHTML=" "+e+" ",this.table.modules.localize.langBind("pagination|counter|of",c=>{l.innerHTML=c}),h.innerHTML=" "+r+" ",this.table.modules.localize.langBind("pagination|counter|pages",c=>{u.innerHTML=c}),n.appendChild(a),n.appendChild(o),n.appendChild(l),n.appendChild(h),n.appendChild(u),n}var FW={rows:IW,pages:_W};const jl=class jl extends pt{constructor(t){super(t),this.mode="local",this.progressiveLoad=!1,this.element=null,this.pageCounterElement=null,this.pageCounter=null,this.size=0,this.page=1,this.count=5,this.max=1,this.remoteRowCountEstimate=null,this.initialLoad=!0,this.dataChanging=!1,this.pageSizes=[],this.registerTableOption("pagination",!1),this.registerTableOption("paginationMode","local"),this.registerTableOption("paginationSize",!1),this.registerTableOption("paginationInitialPage",1),this.registerTableOption("paginationCounter",!1),this.registerTableOption("paginationCounterElement",!1),this.registerTableOption("paginationButtonCount",5),this.registerTableOption("paginationSizeSelector",!1),this.registerTableOption("paginationElement",!1),this.registerTableOption("paginationAddRow","page"),this.registerTableOption("paginationOutOfRange",!1),this.registerTableOption("progressiveLoad",!1),this.registerTableOption("progressiveLoadDelay",0),this.registerTableOption("progressiveLoadScrollMargin",0),this.registerTableFunction("setMaxPage",this.setMaxPage.bind(this)),this.registerTableFunction("setPage",this.setPage.bind(this)),this.registerTableFunction("setPageToRow",this.userSetPageToRow.bind(this)),this.registerTableFunction("setPageSize",this.userSetPageSize.bind(this)),this.registerTableFunction("getPageSize",this.getPageSize.bind(this)),this.registerTableFunction("previousPage",this.previousPage.bind(this)),this.registerTableFunction("nextPage",this.nextPage.bind(this)),this.registerTableFunction("getPage",this.getPage.bind(this)),this.registerTableFunction("getPageMax",this.getPageMax.bind(this)),this.registerComponentFunction("row","pageTo",this.setPageToRow.bind(this))}initialize(){this.table.options.pagination?(this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("footer-redraw",this.footerRedraw.bind(this)),this.table.options.paginationAddRow=="page"&&this.subscribe("row-adding-position",this.rowAddingPosition.bind(this)),this.table.options.paginationMode==="remote"&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this))),this.table.options.progressiveLoad&&console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time"),this.registerDisplayHandler(this.restOnRenderBefore.bind(this),40),this.registerDisplayHandler(this.getRows.bind(this),50),this.createElements(),this.initializePageCounter(),this.initializePaginator()):this.table.options.progressiveLoad&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.initializeProgressive(this.table.options.progressiveLoad),this.table.options.progressiveLoad==="scroll"&&this.subscribe("scroll-vertical",this.scrollVertical.bind(this)))}rowAddingPosition(t,e){var i=this.table.rowManager,r=i.getDisplayRows(),n;return e?r.length?n=r[0]:i.activeRows.length&&(n=i.activeRows[i.activeRows.length-1],e=!1):r.length&&(n=r[r.length-1],e=!(r.length<this.size)),{index:n,top:e}}calculatePageSizes(){var t,e;this.table.options.paginationSize?this.size=this.table.options.paginationSize:(t=document.createElement("div"),t.classList.add("tabulator-row"),t.style.visibility="hidden",e=document.createElement("div"),e.classList.add("tabulator-cell"),e.innerHTML="Page Row Test",t.appendChild(e),this.table.rowManager.getTableElement().appendChild(t),this.size=Math.floor(this.table.rowManager.getElement().clientHeight/t.offsetHeight),this.table.rowManager.getTableElement().removeChild(t)),this.dispatchExternal("pageSizeChanged",this.size),this.generatePageSizeSelectList()}initialLoadComplete(){this.initialLoad=!1}remotePageParams(t,e,i,r){return this.initialLoad||(this.progressiveLoad&&!i||!this.progressiveLoad&&!this.dataChanging)&&this.reset(!0),r.page=this.page,this.size&&(r.size=this.size),r}userSetPageToRow(t){return this.table.options.pagination&&(t=this.table.rowManager.findRow(t),t)?this.setPageToRow(t):Promise.reject()}userSetPageSize(t){return this.table.options.pagination?(this.setPageSize(t),this.setPage(1)):!1}scrollVertical(t,e){var i,r,n;!e&&!this.table.dataLoader.loading&&(i=this.table.rowManager.getElement(),r=i.scrollHeight-i.clientHeight-t,n=this.table.options.progressiveLoadScrollMargin||i.clientHeight*2,r<n&&this.nextPage().catch(()=>{}))}restOnRenderBefore(t,e){return e||this.mode==="local"&&this.reset(),t}rowsUpdated(){this.refreshData(!0,"all")}createElements(){var t;this.element=document.createElement("span"),this.element.classList.add("tabulator-paginator"),this.pagesElement=document.createElement("span"),this.pagesElement.classList.add("tabulator-pages"),t=document.createElement("button"),t.classList.add("tabulator-page"),t.setAttribute("type","button"),t.setAttribute("role","button"),t.setAttribute("aria-label",""),t.setAttribute("title",""),this.firstBut=t.cloneNode(!0),this.firstBut.setAttribute("data-page","first"),this.prevBut=t.cloneNode(!0),this.prevBut.setAttribute("data-page","prev"),this.nextBut=t.cloneNode(!0),this.nextBut.setAttribute("data-page","next"),this.lastBut=t.cloneNode(!0),this.lastBut.setAttribute("data-page","last"),this.table.options.paginationSizeSelector&&(this.pageSizeSelect=document.createElement("select"),this.pageSizeSelect.classList.add("tabulator-page-size"))}generatePageSizeSelectList(){var t=[];if(this.pageSizeSelect){if(Array.isArray(this.table.options.paginationSizeSelector))t=this.table.options.paginationSizeSelector,this.pageSizes=t,this.pageSizes.indexOf(this.size)==-1&&t.unshift(this.size);else if(this.pageSizes.indexOf(this.size)==-1){t=[];for(let e=1;e<5;e++)t.push(this.size*e);this.pageSizes=t}else t=this.pageSizes;for(;this.pageSizeSelect.firstChild;)this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);t.forEach(e=>{var i=document.createElement("option");i.value=e,e===!0?this.langBind("pagination|all",function(r){i.innerHTML=r}):i.innerHTML=e,this.pageSizeSelect.appendChild(i)}),this.pageSizeSelect.value=this.size}}initializePageCounter(){var t=this.table.options.paginationCounter,e=null;t&&(typeof t=="function"?e=t:e=jl.pageCounters[t],e?(this.pageCounter=e,this.pageCounterElement=document.createElement("span"),this.pageCounterElement.classList.add("tabulator-page-counter")):console.warn("Pagination Error - No such page counter found: ",t))}initializePaginator(t){var e,i;t||(this.langBind("pagination|first",r=>{this.firstBut.innerHTML=r}),this.langBind("pagination|first_title",r=>{this.firstBut.setAttribute("aria-label",r),this.firstBut.setAttribute("title",r)}),this.langBind("pagination|prev",r=>{this.prevBut.innerHTML=r}),this.langBind("pagination|prev_title",r=>{this.prevBut.setAttribute("aria-label",r),this.prevBut.setAttribute("title",r)}),this.langBind("pagination|next",r=>{this.nextBut.innerHTML=r}),this.langBind("pagination|next_title",r=>{this.nextBut.setAttribute("aria-label",r),this.nextBut.setAttribute("title",r)}),this.langBind("pagination|last",r=>{this.lastBut.innerHTML=r}),this.langBind("pagination|last_title",r=>{this.lastBut.setAttribute("aria-label",r),this.lastBut.setAttribute("title",r)}),this.firstBut.addEventListener("click",()=>{this.setPage(1)}),this.prevBut.addEventListener("click",()=>{this.previousPage()}),this.nextBut.addEventListener("click",()=>{this.nextPage()}),this.lastBut.addEventListener("click",()=>{this.setPage(this.max)}),this.table.options.paginationElement&&(this.element=this.table.options.paginationElement),this.pageSizeSelect&&(e=document.createElement("label"),this.langBind("pagination|page_size",r=>{this.pageSizeSelect.setAttribute("aria-label",r),this.pageSizeSelect.setAttribute("title",r),e.innerHTML=r}),this.element.appendChild(e),this.element.appendChild(this.pageSizeSelect),this.pageSizeSelect.addEventListener("change",r=>{this.setPageSize(this.pageSizeSelect.value=="true"?!0:this.pageSizeSelect.value),this.setPage(1)})),this.element.appendChild(this.firstBut),this.element.appendChild(this.prevBut),this.element.appendChild(this.pagesElement),this.element.appendChild(this.nextBut),this.element.appendChild(this.lastBut),this.table.options.paginationElement||(this.table.options.paginationCounter&&(this.table.options.paginationCounterElement?this.table.options.paginationCounterElement instanceof HTMLElement?this.table.options.paginationCounterElement.appendChild(this.pageCounterElement):typeof this.table.options.paginationCounterElement=="string"&&(i=document.querySelector(this.table.options.paginationCounterElement),i?i.appendChild(this.pageCounterElement):console.warn("Pagination Error - Unable to find element matching paginationCounterElement selector:",this.table.options.paginationCounterElement)):this.footerAppend(this.pageCounterElement)),this.footerAppend(this.element)),this.page=this.table.options.paginationInitialPage,this.count=this.table.options.paginationButtonCount),this.mode=this.table.options.paginationMode}initializeProgressive(t){this.initializePaginator(!0),this.mode="progressive_"+t,this.progressiveLoad=!0}trackChanges(){this.dispatch("page-changed")}setMaxRows(t){t?this.max=this.size===!0?1:Math.ceil(t/this.size):this.max=1,this.page>this.max&&(this.page=this.max)}reset(t){this.initialLoad||(this.mode=="local"||t)&&(this.page=1,this.trackChanges())}setMaxPage(t){t=parseInt(t),this.max=t||1,this.page>this.max&&(this.page=this.max,this.trigger())}setPage(t){switch(t){case"first":return this.setPage(1);case"prev":return this.previousPage();case"next":return this.nextPage();case"last":return this.setPage(this.max)}return t=parseInt(t),t>0&&t<=this.max||this.mode!=="local"?(this.page=t,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Requested page is out of range of 1 - "+this.max+":",t),Promise.reject())}setPageToRow(t){var e=this.displayRows(-1),i=e.indexOf(t);if(i>-1){var r=this.size===!0?1:Math.ceil((i+1)/this.size);return this.setPage(r)}else return console.warn("Pagination Error - Requested row is not visible"),Promise.reject()}setPageSize(t){t!==!0&&(t=parseInt(t)),t>0&&(this.size=t,this.dispatchExternal("pageSizeChanged",t)),this.pageSizeSelect&&this.generatePageSizeSelectList(),this.trackChanges()}_setPageCounter(t,e,i){var r;if(this.pageCounter)switch(this.mode==="remote"&&(e=this.size,i=(this.page-1)*this.size+1,t=this.remoteRowCountEstimate),r=this.pageCounter.call(this,e,i,this.page,t,this.max),typeof r){case"object":if(r instanceof Node){for(;this.pageCounterElement.firstChild;)this.pageCounterElement.removeChild(this.pageCounterElement.firstChild);this.pageCounterElement.appendChild(r)}else this.pageCounterElement.innerHTML="",r!=null&&console.warn("Page Counter Error - Page Counter has returned a type of object, the only valid page counter object return is an instance of Node, the page counter returned:",r);break;case"undefined":this.pageCounterElement.innerHTML="";break;default:this.pageCounterElement.innerHTML=r}}_setPageButtons(){let t=Math.floor((this.count-1)/2),e=Math.ceil((this.count-1)/2),i=this.max-this.page+t+1<this.count?this.max-this.count+1:Math.max(this.page-t,1),r=this.page<=e?Math.min(this.count,this.max):Math.min(this.page+e,this.max);for(;this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);this.page==1?(this.firstBut.disabled=!0,this.prevBut.disabled=!0):(this.firstBut.disabled=!1,this.prevBut.disabled=!1),this.page==this.max?(this.lastBut.disabled=!0,this.nextBut.disabled=!0):(this.lastBut.disabled=!1,this.nextBut.disabled=!1);for(let n=i;n<=r;n++)n>0&&n<=this.max&&this.pagesElement.appendChild(this._generatePageButton(n));this.footerRedraw()}_generatePageButton(t){var e=document.createElement("button");return e.classList.add("tabulator-page"),t==this.page&&e.classList.add("active"),e.setAttribute("type","button"),e.setAttribute("role","button"),this.langBind("pagination|page_title",i=>{e.setAttribute("aria-label",i+" "+t),e.setAttribute("title",i+" "+t)}),e.setAttribute("data-page",t),e.textContent=t,e.addEventListener("click",i=>{this.setPage(t)}),e}previousPage(){return this.page>1?(this.page--,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Previous page would be less than page 1:",0),Promise.reject())}nextPage(){return this.page<this.max?(this.page++,this.trackChanges(),this.trigger()):(this.progressiveLoad||console.warn("Pagination Error - Next page would be greater than maximum page of "+this.max+":",this.max+1),Promise.reject())}getPage(){return this.page}getPageMax(){return this.max}getPageSize(t){return this.size}getMode(){return this.mode}getRows(t){var e=0,i,r,n,a,o=t.filter(l=>l.type==="row");if(this.mode=="local"){i=[],this.setMaxRows(t.length),this.size===!0?(r=0,n=t.length):(r=this.size*(this.page-1),n=r+parseInt(this.size)),this._setPageButtons();for(let l=r;l<n;l++){let h=t[l];h&&(i.push(h),h.type==="row"&&(a||(a=h),e++))}return this._setPageCounter(o.length,e,a?o.indexOf(a)+1:0),i}else return this._setPageButtons(),this._setPageCounter(o.length),t.slice(0)}trigger(){var t;switch(this.mode){case"local":return t=this.table.rowManager.scrollLeft,this.refreshData(),this.table.rowManager.scrollHorizontal(t),this.dispatchExternal("pageLoaded",this.getPage()),Promise.resolve();case"remote":return this.dataChanging=!0,this.reloadData(null).finally(()=>{this.dataChanging=!1});case"progressive_load":case"progressive_scroll":return this.reloadData(null,!0);default:return console.warn("Pagination Error - no such pagination mode:",this.mode),Promise.reject()}}_parseRemoteData(t){var e,i;if(typeof t.last_page>"u"&&console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").last_page||"last_page")+"' property"),t.data)if(this.max=parseInt(t.last_page)||1,this.remoteRowCountEstimate=typeof t.last_row<"u"?t.last_row:t.last_page*this.size-(this.page==t.last_page?this.size-t.data.length:0),this.progressiveLoad){switch(this.mode){case"progressive_load":this.page==1?this.table.rowManager.setData(t.data,!1,this.page==1):this.table.rowManager.addRows(t.data),this.page<this.max&&setTimeout(()=>{this.nextPage()},this.table.options.progressiveLoadDelay);break;case"progressive_scroll":t=this.page===1?t.data:this.table.rowManager.getData().concat(t.data),this.table.rowManager.setData(t,this.page!==1,this.page==1),e=this.table.options.progressiveLoadScrollMargin||this.table.rowManager.element.clientHeight*2,this.table.rowManager.element.scrollHeight<=this.table.rowManager.element.clientHeight+e&&this.page<this.max&&setTimeout(()=>{this.nextPage()});break}return!1}else{if(this.page>this.max&&(console.warn("Remote Pagination Error - Server returned last page value lower than the current page"),i=this.options("paginationOutOfRange"),i))return this.setPage(typeof i=="function"?i.call(this,this.page,this.max):i);this.dispatchExternal("pageLoaded",this.getPage())}else console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").data||"data")+"' property");return t.data}footerRedraw(){var t=this.table.footerManager.containerElement;Math.ceil(t.clientWidth)-t.scrollWidth<0?this.pagesElement.style.display="none":(this.pagesElement.style.display="",Math.ceil(t.clientWidth)-t.scrollWidth<0&&(this.pagesElement.style.display="none"))}};Ne(jl,"moduleName","page"),Ne(jl,"pageCounters",FW);let Lp=jl;var NW={local:function(s,t){var e=localStorage.getItem(s+"-"+t);return e?JSON.parse(e):!1},cookie:function(s,t){var e=document.cookie,i=s+"-"+t,r=e.indexOf(i+"="),n,a;return r>-1&&(e=e.slice(r),n=e.indexOf(";"),n>-1&&(e=e.slice(0,n)),a=e.replace(i+"=","")),a?JSON.parse(a):!1}},MW={local:function(s,t,e){localStorage.setItem(s+"-"+t,JSON.stringify(e))},cookie:function(s,t,e){var i=new Date;i.setDate(i.getDate()+1e4),document.cookie=s+"-"+t+"="+JSON.stringify(e)+"; expires="+i.toUTCString()}};const wr=class wr extends pt{constructor(t){super(t),this.mode="",this.id="",this.defWatcherBlock=!1,this.config={},this.readFunc=!1,this.writeFunc=!1,this.registerTableOption("persistence",!1),this.registerTableOption("persistenceID",""),this.registerTableOption("persistenceMode",!0),this.registerTableOption("persistenceReaderFunc",!1),this.registerTableOption("persistenceWriterFunc",!1)}localStorageTest(){var t="_tabulator_test";try{return window.localStorage.setItem(t,t),window.localStorage.removeItem(t),!0}catch(e){return!1}}initialize(){if(this.table.options.persistence){var t=this.table.options.persistenceMode,e=this.table.options.persistenceID,i;this.mode=t!==!0?t:this.localStorageTest()?"local":"cookie",this.table.options.persistenceReaderFunc?typeof this.table.options.persistenceReaderFunc=="function"?this.readFunc=this.table.options.persistenceReaderFunc:wr.readers[this.table.options.persistenceReaderFunc]?this.readFunc=wr.readers[this.table.options.persistenceReaderFunc]:console.warn("Persistence Read Error - invalid reader set",this.table.options.persistenceReaderFunc):wr.readers[this.mode]?this.readFunc=wr.readers[this.mode]:console.warn("Persistence Read Error - invalid reader set",this.mode),this.table.options.persistenceWriterFunc?typeof this.table.options.persistenceWriterFunc=="function"?this.writeFunc=this.table.options.persistenceWriterFunc:wr.writers[this.table.options.persistenceWriterFunc]?this.writeFunc=wr.writers[this.table.options.persistenceWriterFunc]:console.warn("Persistence Write Error - invalid reader set",this.table.options.persistenceWriterFunc):wr.writers[this.mode]?this.writeFunc=wr.writers[this.mode]:console.warn("Persistence Write Error - invalid writer set",this.mode),this.id="tabulator-"+(e||this.table.element.getAttribute("id")||""),this.config={sort:this.table.options.persistence===!0||this.table.options.persistence.sort,filter:this.table.options.persistence===!0||this.table.options.persistence.filter,headerFilter:this.table.options.persistence===!0||this.table.options.persistence.headerFilter,group:this.table.options.persistence===!0||this.table.options.persistence.group,page:this.table.options.persistence===!0||this.table.options.persistence.page,columns:this.table.options.persistence===!0?["title","width","visible"]:this.table.options.persistence.columns},this.config.page&&(i=this.retrieveData("page"),i&&(typeof i.paginationSize<"u"&&(this.config.page===!0||this.config.page.size)&&(this.table.options.paginationSize=i.paginationSize),typeof i.paginationInitialPage<"u"&&(this.config.page===!0||this.config.page.page)&&(this.table.options.paginationInitialPage=i.paginationInitialPage))),this.config.group&&(i=this.retrieveData("group"),i&&(typeof i.groupBy<"u"&&(this.config.group===!0||this.config.group.groupBy)&&(this.table.options.groupBy=i.groupBy),typeof i.groupStartOpen<"u"&&(this.config.group===!0||this.config.group.groupStartOpen)&&(this.table.options.groupStartOpen=i.groupStartOpen),typeof i.groupHeader<"u"&&(this.config.group===!0||this.config.group.groupHeader)&&(this.table.options.groupHeader=i.groupHeader))),this.config.columns&&(this.table.options.columns=this.load("columns",this.table.options.columns),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-show",this.save.bind(this,"columns")),this.subscribe("column-hide",this.save.bind(this,"columns")),this.subscribe("column-moved",this.save.bind(this,"columns"))),this.subscribe("table-built",this.tableBuilt.bind(this),0),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("filter-changed",this.eventSave.bind(this,"filter")),this.subscribe("filter-changed",this.eventSave.bind(this,"headerFilter")),this.subscribe("sort-changed",this.eventSave.bind(this,"sort")),this.subscribe("group-changed",this.eventSave.bind(this,"group")),this.subscribe("page-changed",this.eventSave.bind(this,"page")),this.subscribe("column-resized",this.eventSave.bind(this,"columns")),this.subscribe("column-width",this.eventSave.bind(this,"columns")),this.subscribe("layout-refreshed",this.eventSave.bind(this,"columns"))}this.registerTableFunction("getColumnLayout",this.getColumnLayout.bind(this)),this.registerTableFunction("setColumnLayout",this.setColumnLayout.bind(this))}eventSave(t){this.config[t]&&this.save(t)}tableBuilt(){var t,e,i;this.config.sort&&(t=this.load("sort"),t&&(this.table.options.initialSort=t)),this.config.filter&&(e=this.load("filter"),e&&(this.table.options.initialFilter=e)),this.config.headerFilter&&(i=this.load("headerFilter"),i&&(this.table.options.initialHeaderFilter=i))}tableRedraw(t){t&&this.config.columns&&this.save("columns")}getColumnLayout(){return this.parseColumns(this.table.columnManager.getColumns())}setColumnLayout(t){return this.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns,t,!0)),!0}initializeColumn(t){var e,i;this.config.columns&&(this.defWatcherBlock=!0,e=t.getDefinition(),i=this.config.columns===!0?Object.keys(e):this.config.columns,i.forEach(r=>{var n=Object.getOwnPropertyDescriptor(e,r),a=e[r];n&&Object.defineProperty(e,r,{set:o=>{a=o,this.defWatcherBlock||this.save("columns"),n.set&&n.set(o)},get:()=>(n.get&&n.get(),a)})}),this.defWatcherBlock=!1)}load(t,e){var i=this.retrieveData(t);return e&&(i=i?this.mergeDefinition(e,i):e),i}retrieveData(t){return this.readFunc?this.readFunc(this.id,t):!1}mergeDefinition(t,e,i){var r=[];return e=e||[],e.forEach((n,a)=>{var o=this._findColumn(t,n),l;o&&(i?l=Object.keys(n):this.config.columns===!0||this.config.columns==null?(l=Object.keys(o),l.push("width")):l=this.config.columns,l.forEach(h=>{h!=="columns"&&typeof n[h]<"u"&&(o[h]=n[h])}),o.columns&&(o.columns=this.mergeDefinition(o.columns,n.columns)),r.push(o))}),t.forEach((n,a)=>{var o=this._findColumn(e,n);o||(r.length>a?r.splice(a,0,n):r.push(n))}),r}_findColumn(t,e){var i=e.columns?"group":e.field?"field":"object";return t.find(function(r){switch(i){case"group":return r.title===e.title&&r.columns.length===e.columns.length;case"field":return r.field===e.field;case"object":return r===e}})}save(t){var e={};switch(t){case"columns":e=this.parseColumns(this.table.columnManager.getColumns());break;case"filter":e=this.table.modules.filter.getFilters();break;case"headerFilter":e=this.table.modules.filter.getHeaderFilters();break;case"sort":e=this.validateSorters(this.table.modules.sort.getSort());break;case"group":e=this.getGroupConfig();break;case"page":e=this.getPageConfig();break}this.writeFunc&&this.writeFunc(this.id,t,e)}validateSorters(t){return t.forEach(function(e){e.column=e.field,delete e.field}),t}getGroupConfig(){var t={};return this.config.group&&((this.config.group===!0||this.config.group.groupBy)&&(t.groupBy=this.table.options.groupBy),(this.config.group===!0||this.config.group.groupStartOpen)&&(t.groupStartOpen=this.table.options.groupStartOpen),(this.config.group===!0||this.config.group.groupHeader)&&(t.groupHeader=this.table.options.groupHeader)),t}getPageConfig(){var t={};return this.config.page&&((this.config.page===!0||this.config.page.size)&&(t.paginationSize=this.table.modules.page.getPageSize()),(this.config.page===!0||this.config.page.page)&&(t.paginationInitialPage=this.table.modules.page.getPage())),t}parseColumns(t){var e=[],i=["headerContextMenu","headerMenu","contextMenu","clickMenu"];return t.forEach(r=>{var n={},a=r.getDefinition(),o;r.isGroup?(n.title=a.title,n.columns=this.parseColumns(r.getColumns())):(n.field=r.getField(),this.config.columns===!0||this.config.columns==null?(o=Object.keys(a),o.push("width"),o.push("visible")):o=this.config.columns,o.forEach(l=>{switch(l){case"width":n.width=r.getWidth();break;case"visible":n.visible=r.visible;break;default:typeof a[l]!="function"&&i.indexOf(l)===-1&&(n[l]=a[l])}})),e.push(n)}),e}};Ne(wr,"moduleName","persistence"),Ne(wr,"moduleInitOrder",-10),Ne(wr,"readers",NW),Ne(wr,"writers",MW);let Rp=wr;class rE extends pt{constructor(t){super(t),this.columnSubscribers={},this.registerTableOption("rowContextPopup",!1),this.registerTableOption("rowClickPopup",!1),this.registerTableOption("rowDblClickPopup",!1),this.registerTableOption("groupContextPopup",!1),this.registerTableOption("groupClickPopup",!1),this.registerTableOption("groupDblClickPopup",!1),this.registerColumnOption("headerContextPopup"),this.registerColumnOption("headerClickPopup"),this.registerColumnOption("headerDblClickPopup"),this.registerColumnOption("headerPopup"),this.registerColumnOption("headerPopupIcon"),this.registerColumnOption("contextPopup"),this.registerColumnOption("clickPopup"),this.registerColumnOption("dblClickPopup"),this.registerComponentFunction("cell","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("column","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("row","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("group","popup",this._componentPopupCall.bind(this))}initialize(){this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}_componentPopupCall(t,e,i){this.loadPopupEvent(e,null,t,i)}initializeRowWatchers(){this.table.options.rowContextPopup&&(this.subscribe("row-contextmenu",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup)),this.table.on("rowTapHold",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup))),this.table.options.rowClickPopup&&this.subscribe("row-click",this.loadPopupEvent.bind(this,this.table.options.rowClickPopup)),this.table.options.rowDblClickPopup&&this.subscribe("row-dblclick",this.loadPopupEvent.bind(this,this.table.options.rowDblClickPopup))}initializeGroupWatchers(){this.table.options.groupContextPopup&&(this.subscribe("group-contextmenu",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup)),this.table.on("groupTapHold",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup))),this.table.options.groupClickPopup&&this.subscribe("group-click",this.loadPopupEvent.bind(this,this.table.options.groupClickPopup)),this.table.options.groupDblClickPopup&&this.subscribe("group-dblclick",this.loadPopupEvent.bind(this,this.table.options.groupDblClickPopup))}initializeColumn(t){var e=t.definition;e.headerContextPopup&&!this.columnSubscribers.headerContextPopup&&(this.columnSubscribers.headerContextPopup=this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextPopup),this.table.on("headerTapHold",this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"))),e.headerClickPopup&&!this.columnSubscribers.headerClickPopup&&(this.columnSubscribers.headerClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerClickPopup"),this.subscribe("column-click",this.columnSubscribers.headerClickPopup)),e.headerDblClickPopup&&!this.columnSubscribers.headerDblClickPopup&&(this.columnSubscribers.headerDblClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerDblClickPopup"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickPopup)),e.headerPopup&&this.initializeColumnHeaderPopup(t),e.contextPopup&&!this.columnSubscribers.contextPopup&&(this.columnSubscribers.contextPopup=this.loadPopupTableCellEvent.bind(this,"contextPopup"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextPopup),this.table.on("cellTapHold",this.loadPopupTableCellEvent.bind(this,"contextPopup"))),e.clickPopup&&!this.columnSubscribers.clickPopup&&(this.columnSubscribers.clickPopup=this.loadPopupTableCellEvent.bind(this,"clickPopup"),this.subscribe("cell-click",this.columnSubscribers.clickPopup)),e.dblClickPopup&&!this.columnSubscribers.dblClickPopup&&(this.columnSubscribers.dblClickPopup=this.loadPopupTableCellEvent.bind(this,"dblClickPopup"),this.subscribe("cell-click",this.columnSubscribers.dblClickPopup))}initializeColumnHeaderPopup(t){var e=t.definition.headerPopupIcon,i;i=document.createElement("span"),i.classList.add("tabulator-header-popup-button"),e?(typeof e=="function"&&(e=e(t.getComponent())),e instanceof HTMLElement?i.appendChild(e):i.innerHTML=e):i.innerHTML="&vellip;",i.addEventListener("click",r=>{r.stopPropagation(),r.preventDefault(),this.loadPopupEvent(t.definition.headerPopup,r,t)}),t.titleElement.insertBefore(i,t.titleElement.firstChild)}loadPopupTableCellEvent(t,e,i){i._cell&&(i=i._cell),i.column.definition[t]&&this.loadPopupEvent(i.column.definition[t],e,i)}loadPopupTableColumnEvent(t,e,i){i._column&&(i=i._column),i.definition[t]&&this.loadPopupEvent(i.definition[t],e,i)}loadPopupEvent(t,e,i,r){var n;function a(o){n=o}i._group?i=i._group:i._row&&(i=i._row),t=typeof t=="function"?t.call(this.table,e,i.getComponent(),a):t,this.loadPopup(e,i,t,n,r)}loadPopup(t,e,i,r,n){var a=!(t instanceof MouseEvent),o,l;i instanceof HTMLElement?o=i:(o=document.createElement("div"),o.innerHTML=i),o.classList.add("tabulator-popup"),o.addEventListener("click",h=>{h.stopPropagation()}),a||t.preventDefault(),l=this.popup(o),typeof r=="function"&&l.renderCallback(r),t?l.show(t):l.show(e.getElement(),n||"center"),l.hideOnBlur(()=>{this.dispatchExternal("popupClosed",e.getComponent())}),this.dispatchExternal("popupOpened",e.getComponent())}}Ne(rE,"moduleName","popup");class sE extends pt{constructor(t){super(t),this.element=!1,this.manualBlock=!1,this.beforeprintEventHandler=null,this.afterprintEventHandler=null,this.registerTableOption("printAsHtml",!1),this.registerTableOption("printFormatter",!1),this.registerTableOption("printHeader",!1),this.registerTableOption("printFooter",!1),this.registerTableOption("printStyled",!0),this.registerTableOption("printRowRange","visible"),this.registerTableOption("printConfig",{}),this.registerColumnOption("print"),this.registerColumnOption("titlePrint")}initialize(){this.table.options.printAsHtml&&(this.beforeprintEventHandler=this.replaceTable.bind(this),this.afterprintEventHandler=this.cleanup.bind(this),window.addEventListener("beforeprint",this.beforeprintEventHandler),window.addEventListener("afterprint",this.afterprintEventHandler),this.subscribe("table-destroy",this.destroy.bind(this))),this.registerTableFunction("print",this.printFullscreen.bind(this))}destroy(){this.table.options.printAsHtml&&(window.removeEventListener("beforeprint",this.beforeprintEventHandler),window.removeEventListener("afterprint",this.afterprintEventHandler))}replaceTable(){this.manualBlock||(this.element=document.createElement("div"),this.element.classList.add("tabulator-print-table"),this.element.appendChild(this.table.modules.export.generateTable(this.table.options.printConfig,this.table.options.printStyled,this.table.options.printRowRange,"print")),this.table.element.style.display="none",this.table.element.parentNode.insertBefore(this.element,this.table.element))}cleanup(){document.body.classList.remove("tabulator-print-fullscreen-hide"),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.table.element.style.display="")}printFullscreen(t,e,i){var r=window.scrollX,n=window.scrollY,a=document.createElement("div"),o=document.createElement("div"),l=this.table.modules.export.generateTable(typeof i<"u"?i:this.table.options.printConfig,typeof e<"u"?e:this.table.options.printStyled,t||this.table.options.printRowRange,"print"),h,u;this.manualBlock=!0,this.element=document.createElement("div"),this.element.classList.add("tabulator-print-fullscreen"),this.table.options.printHeader&&(a.classList.add("tabulator-print-header"),h=typeof this.table.options.printHeader=="function"?this.table.options.printHeader.call(this.table):this.table.options.printHeader,typeof h=="string"?a.innerHTML=h:a.appendChild(h),this.element.appendChild(a)),this.element.appendChild(l),this.table.options.printFooter&&(o.classList.add("tabulator-print-footer"),u=typeof this.table.options.printFooter=="function"?this.table.options.printFooter.call(this.table):this.table.options.printFooter,typeof u=="string"?o.innerHTML=u:o.appendChild(u),this.element.appendChild(o)),document.body.classList.add("tabulator-print-fullscreen-hide"),document.body.appendChild(this.element),this.table.options.printFormatter&&this.table.options.printFormatter(this.element,l),window.print(),this.cleanup(),window.scrollTo(r,n),this.manualBlock=!1}}Ne(sE,"moduleName","print");class nE extends pt{constructor(t){super(t),this.data=!1,this.blocked=!1,this.origFuncs={},this.currentVersion=0,this.registerTableOption("reactiveData",!1)}initialize(){this.table.options.reactiveData&&(this.subscribe("cell-value-save-before",this.block.bind(this,"cellsave")),this.subscribe("cell-value-save-after",this.unblock.bind(this,"cellsave")),this.subscribe("row-data-save-before",this.block.bind(this,"rowsave")),this.subscribe("row-data-save-after",this.unblock.bind(this,"rowsave")),this.subscribe("row-data-init-after",this.watchRow.bind(this)),this.subscribe("data-processing",this.watchData.bind(this)),this.subscribe("table-destroy",this.unwatchData.bind(this)))}watchData(t){var e=this,i;this.currentVersion++,i=this.currentVersion,this.unwatchData(),this.data=t,this.origFuncs.push=t.push,Object.defineProperty(this.data,"push",{enumerable:!1,configurable:!0,value:function(){var r=Array.from(arguments),n;return!e.blocked&&i===e.currentVersion&&(e.block("data-push"),r.forEach(a=>{e.table.rowManager.addRowActual(a,!1)}),n=e.origFuncs.push.apply(t,arguments),e.unblock("data-push")),n}}),this.origFuncs.unshift=t.unshift,Object.defineProperty(this.data,"unshift",{enumerable:!1,configurable:!0,value:function(){var r=Array.from(arguments),n;return!e.blocked&&i===e.currentVersion&&(e.block("data-unshift"),r.forEach(a=>{e.table.rowManager.addRowActual(a,!0)}),n=e.origFuncs.unshift.apply(t,arguments),e.unblock("data-unshift")),n}}),this.origFuncs.shift=t.shift,Object.defineProperty(this.data,"shift",{enumerable:!1,configurable:!0,value:function(){var r,n;return!e.blocked&&i===e.currentVersion&&(e.block("data-shift"),e.data.length&&(r=e.table.rowManager.getRowFromDataObject(e.data[0]),r&&r.deleteActual()),n=e.origFuncs.shift.call(t),e.unblock("data-shift")),n}}),this.origFuncs.pop=t.pop,Object.defineProperty(this.data,"pop",{enumerable:!1,configurable:!0,value:function(){var r,n;return!e.blocked&&i===e.currentVersion&&(e.block("data-pop"),e.data.length&&(r=e.table.rowManager.getRowFromDataObject(e.data[e.data.length-1]),r&&r.deleteActual()),n=e.origFuncs.pop.call(t),e.unblock("data-pop")),n}}),this.origFuncs.splice=t.splice,Object.defineProperty(this.data,"splice",{enumerable:!1,configurable:!0,value:function(){var r=Array.from(arguments),n=r[0]<0?t.length+r[0]:r[0],a=r[1],o=r[2]?r.slice(2):!1,l,h;if(!e.blocked&&i===e.currentVersion){if(e.block("data-splice"),o&&(l=t[n]?e.table.rowManager.getRowFromDataObject(t[n]):!1,l?o.forEach(c=>{e.table.rowManager.addRowActual(c,!0,l,!0)}):(o=o.slice().reverse(),o.forEach(c=>{e.table.rowManager.addRowActual(c,!0,!1,!0)}))),a!==0){var u=t.slice(n,typeof r[1]>"u"?r[1]:n+a);u.forEach((c,f)=>{var d=e.table.rowManager.getRowFromDataObject(c);d&&d.deleteActual(f!==u.length-1)})}(o||a!==0)&&e.table.rowManager.reRenderInPosition(),h=e.origFuncs.splice.apply(t,arguments),e.unblock("data-splice")}return h}})}unwatchData(){if(this.data!==!1)for(var t in this.origFuncs)Object.defineProperty(this.data,t,{enumerable:!0,configurable:!0,writable:!0,value:this.origFuncs.key})}watchRow(t){var e=t.getData();for(var i in e)this.watchKey(t,e,i);this.table.options.dataTree&&this.watchTreeChildren(t)}watchTreeChildren(t){var e=this,i=t.getData()[this.table.options.dataTreeChildField],r={};i&&(r.push=i.push,Object.defineProperty(i,"push",{enumerable:!1,configurable:!0,value:()=>{if(!e.blocked){e.block("tree-push");var n=r.push.apply(i,arguments);this.rebuildTree(t),e.unblock("tree-push")}return n}}),r.unshift=i.unshift,Object.defineProperty(i,"unshift",{enumerable:!1,configurable:!0,value:()=>{if(!e.blocked){e.block("tree-unshift");var n=r.unshift.apply(i,arguments);this.rebuildTree(t),e.unblock("tree-unshift")}return n}}),r.shift=i.shift,Object.defineProperty(i,"shift",{enumerable:!1,configurable:!0,value:()=>{if(!e.blocked){e.block("tree-shift");var n=r.shift.call(i);this.rebuildTree(t),e.unblock("tree-shift")}return n}}),r.pop=i.pop,Object.defineProperty(i,"pop",{enumerable:!1,configurable:!0,value:()=>{if(!e.blocked){e.block("tree-pop");var n=r.pop.call(i);this.rebuildTree(t),e.unblock("tree-pop")}return n}}),r.splice=i.splice,Object.defineProperty(i,"splice",{enumerable:!1,configurable:!0,value:()=>{if(!e.blocked){e.block("tree-splice");var n=r.splice.apply(i,arguments);this.rebuildTree(t),e.unblock("tree-splice")}return n}}))}rebuildTree(t){this.table.modules.dataTree.initializeRow(t),this.table.modules.dataTree.layoutRow(t),this.table.rowManager.refreshActiveData("tree",!1,!0)}watchKey(t,e,i){var r=this,n=Object.getOwnPropertyDescriptor(e,i),a=e[i],o=this.currentVersion;Object.defineProperty(e,i,{set:l=>{if(a=l,!r.blocked&&o===r.currentVersion){r.block("key");var h={};h[i]=l,t.updateData(h),r.unblock("key")}n.set&&n.set(l)},get:()=>(n.get&&n.get(),a)})}unwatchRow(t){var e=t.getData();for(var i in e)Object.defineProperty(e,i,{value:e[i]})}block(t){this.blocked||(this.blocked=t)}unblock(t){this.blocked===t&&(this.blocked=!1)}}Ne(nE,"moduleName","reactiveData");class aE extends pt{constructor(t){super(t),this.startColumn=!1,this.startX=!1,this.startWidth=!1,this.latestX=!1,this.handle=null,this.initialNextColumn=null,this.nextColumn=null,this.initialized=!1,this.registerColumnOption("resizable",!0),this.registerTableOption("resizableColumnFit",!1),this.registerTableOption("resizableColumnGuide",!1)}initialize(){this.subscribe("column-rendered",this.layoutColumnHeader.bind(this))}initializeEventWatchers(){this.initialized||(this.subscribe("cell-rendered",this.layoutCellHandles.bind(this)),this.subscribe("cell-delete",this.deInitializeComponent.bind(this)),this.subscribe("cell-height",this.resizeHandle.bind(this)),this.subscribe("column-moved",this.columnLayoutUpdated.bind(this)),this.subscribe("column-hide",this.deInitializeColumn.bind(this)),this.subscribe("column-show",this.columnLayoutUpdated.bind(this)),this.subscribe("column-width",this.columnWidthUpdated.bind(this)),this.subscribe("column-delete",this.deInitializeComponent.bind(this)),this.subscribe("column-height",this.resizeHandle.bind(this)),this.initialized=!0)}layoutCellHandles(t){t.row.type==="row"&&(this.deInitializeComponent(t),this.initializeColumn("cell",t,t.column,t.element))}layoutColumnHeader(t){t.definition.resizable&&(this.initializeEventWatchers(),this.deInitializeComponent(t),this.initializeColumn("header",t,t,t.element))}columnLayoutUpdated(t){var e=t.prevColumn();this.reinitializeColumn(t),e&&this.reinitializeColumn(e)}columnWidthUpdated(t){t.modules.frozen&&(this.table.modules.frozenColumns.leftColumns.includes(t)?this.table.modules.frozenColumns.leftColumns.forEach(e=>{this.reinitializeColumn(e)}):this.table.modules.frozenColumns.rightColumns.includes(t)&&this.table.modules.frozenColumns.rightColumns.forEach(e=>{this.reinitializeColumn(e)}))}frozenColumnOffset(t){var e=!1;return t.modules.frozen&&(e=t.modules.frozen.marginValue,t.modules.frozen.position==="left"?e+=t.getWidth()-3:e&&(e-=3)),e!==!1?e+"px":!1}reinitializeColumn(t){var e=this.frozenColumnOffset(t);t.cells.forEach(i=>{i.modules.resize&&i.modules.resize.handleEl&&(e&&(i.modules.resize.handleEl.style[t.modules.frozen.position]=e,i.modules.resize.handleEl.style["z-index"]=11),i.element.after(i.modules.resize.handleEl))}),t.modules.resize&&t.modules.resize.handleEl&&(e&&(t.modules.resize.handleEl.style[t.modules.frozen.position]=e),t.element.after(t.modules.resize.handleEl))}initializeColumn(t,e,i,r){var n=this,a=!1,o=i.definition.resizable,l={},h=i.getLastColumn();if(t==="header"&&(a=i.definition.formatter=="textarea"||i.definition.variableHeight,l={variableHeight:a}),(o===!0||o==t)&&this._checkResizability(h)){var u=document.createElement("span");u.className="tabulator-col-resize-handle",u.addEventListener("click",function(f){f.stopPropagation()});var c=function(f){n.startColumn=i,n.initialNextColumn=n.nextColumn=h.nextColumn(),n._mouseDown(f,h,u)};u.addEventListener("mousedown",c),u.addEventListener("touchstart",c,{passive:!0}),u.addEventListener("dblclick",f=>{var d=h.getWidth();f.stopPropagation(),h.reinitializeWidth(!0),d!==h.getWidth()&&(n.dispatch("column-resized",h),n.dispatchExternal("columnResized",h.getComponent()))}),i.modules.frozen&&(u.style.position="sticky",u.style[i.modules.frozen.position]=this.frozenColumnOffset(i)),l.handleEl=u,r.parentNode&&i.visible&&r.after(u)}e.modules.resize=l}deInitializeColumn(t){this.deInitializeComponent(t),t.cells.forEach(e=>{this.deInitializeComponent(e)})}deInitializeComponent(t){var e;t.modules.resize&&(e=t.modules.resize.handleEl,e&&e.parentElement&&e.parentElement.removeChild(e))}resizeHandle(t,e){t.modules.resize&&t.modules.resize.handleEl&&(t.modules.resize.handleEl.style.height=e)}resize(t,e){var i=typeof t.clientX>"u"?t.touches[0].clientX:t.clientX,r=i-this.startX,n=i-this.latestX,a,o;if(this.latestX=i,this.table.rtl&&(r=-r,n=-n),a=e.width==e.minWidth||e.width==e.maxWidth,e.setWidth(this.startWidth+r),o=e.width==e.minWidth||e.width==e.maxWidth,n<0&&(this.nextColumn=this.initialNextColumn),this.table.options.resizableColumnFit&&this.nextColumn&&!(a&&o)){let l=this.nextColumn.getWidth();n>0&&l<=this.nextColumn.minWidth&&(this.nextColumn=this.nextColumn.nextColumn()),this.nextColumn&&this.nextColumn.setWidth(this.nextColumn.getWidth()-n)}this.table.columnManager.rerenderColumns(!0),!this.table.browserSlow&&e.modules.resize&&e.modules.resize.variableHeight&&e.checkCellHeights()}calcGuidePosition(t,e,i){var r=typeof t.clientX>"u"?t.touches[0].clientX:t.clientX,n=i.getBoundingClientRect().x-this.table.element.getBoundingClientRect().x,a=this.table.element.getBoundingClientRect().x,o=e.element.getBoundingClientRect().left-a,l=r-this.startX,h=Math.max(n+l,o+e.minWidth);return e.maxWidth&&(h=Math.min(h,o+e.maxWidth)),h}_checkResizability(t){return t.definition.resizable}_mouseDown(t,e,i){var r=this,n;this.dispatchExternal("columnResizing",e.getComponent()),r.table.options.resizableColumnGuide&&(n=document.createElement("span"),n.classList.add("tabulator-col-resize-guide"),r.table.element.appendChild(n),setTimeout(()=>{n.style.left=r.calcGuidePosition(t,e,i)+"px"})),r.table.element.classList.add("tabulator-block-select");function a(l){r.table.options.resizableColumnGuide?n.style.left=r.calcGuidePosition(l,e,i)+"px":r.resize(l,e)}function o(l){r.table.options.resizableColumnGuide&&(r.resize(l,e),n.remove()),r.startColumn.modules.edit&&(r.startColumn.modules.edit.blocked=!1),r.table.browserSlow&&e.modules.resize&&e.modules.resize.variableHeight&&e.checkCellHeights(),document.body.removeEventListener("mouseup",o),document.body.removeEventListener("mousemove",a),i.removeEventListener("touchmove",a),i.removeEventListener("touchend",o),r.table.element.classList.remove("tabulator-block-select"),r.startWidth!==e.getWidth()&&(r.table.columnManager.verticalAlignHeaders(),r.dispatch("column-resized",e),r.dispatchExternal("columnResized",e.getComponent()))}t.stopPropagation(),r.startColumn.modules.edit&&(r.startColumn.modules.edit.blocked=!0),r.startX=typeof t.clientX>"u"?t.touches[0].clientX:t.clientX,r.latestX=r.startX,r.startWidth=e.getWidth(),document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",o),i.addEventListener("touchmove",a,{passive:!0}),i.addEventListener("touchend",o)}}Ne(aE,"moduleName","resizeColumns");class oE extends pt{constructor(t){super(t),this.startColumn=!1,this.startY=!1,this.startHeight=!1,this.handle=null,this.prevHandle=null,this.registerTableOption("resizableRows",!1),this.registerTableOption("resizableRowGuide",!1)}initialize(){this.table.options.resizableRows&&this.subscribe("row-layout-after",this.initializeRow.bind(this))}initializeRow(t){var e=this,i=t.getElement(),r=document.createElement("div");r.className="tabulator-row-resize-handle";var n=document.createElement("div");n.className="tabulator-row-resize-handle prev",r.addEventListener("click",function(l){l.stopPropagation()});var a=function(l){e.startRow=t,e._mouseDown(l,t,r)};r.addEventListener("mousedown",a),r.addEventListener("touchstart",a,{passive:!0}),n.addEventListener("click",function(l){l.stopPropagation()});var o=function(l){var h=e.table.rowManager.prevDisplayRow(t);h&&(e.startRow=h,e._mouseDown(l,h,n))};n.addEventListener("mousedown",o),n.addEventListener("touchstart",o,{passive:!0}),i.appendChild(r),i.appendChild(n)}resize(t,e){e.setHeight(this.startHeight+((typeof t.screenY>"u"?t.touches[0].screenY:t.screenY)-this.startY))}calcGuidePosition(t,e,i){var r=typeof t.screenY>"u"?t.touches[0].screenY:t.screenY,n=i.getBoundingClientRect().y-this.table.element.getBoundingClientRect().y,a=this.table.element.getBoundingClientRect().y,o=e.element.getBoundingClientRect().top-a,l=r-this.startY;return Math.max(n+l,o)}_mouseDown(t,e,i){var r=this,n;r.dispatchExternal("rowResizing",e.getComponent()),r.table.options.resizableRowGuide&&(n=document.createElement("span"),n.classList.add("tabulator-row-resize-guide"),r.table.element.appendChild(n),setTimeout(()=>{n.style.top=r.calcGuidePosition(t,e,i)+"px"})),r.table.element.classList.add("tabulator-block-select");function a(l){r.table.options.resizableRowGuide?n.style.top=r.calcGuidePosition(l,e,i)+"px":r.resize(l,e)}function o(l){r.table.options.resizableRowGuide&&(r.resize(l,e),n.remove()),document.body.removeEventListener("mouseup",a),document.body.removeEventListener("mousemove",a),i.removeEventListener("touchmove",a),i.removeEventListener("touchend",o),r.table.element.classList.remove("tabulator-block-select"),r.dispatchExternal("rowResized",e.getComponent())}t.stopPropagation(),r.startY=typeof t.screenY>"u"?t.touches[0].screenY:t.screenY,r.startHeight=e.getHeight(),document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",o),i.addEventListener("touchmove",a,{passive:!0}),i.addEventListener("touchend",o)}}Ne(oE,"moduleName","resizeRows");class lE extends pt{constructor(t){super(t),this.binding=!1,this.visibilityObserver=!1,this.resizeObserver=!1,this.containerObserver=!1,this.tableHeight=0,this.tableWidth=0,this.containerHeight=0,this.containerWidth=0,this.autoResize=!1,this.visible=!1,this.initialized=!1,this.initialRedraw=!1,this.registerTableOption("autoResize",!0)}initialize(){if(this.table.options.autoResize){var t=this.table,e;this.tableHeight=t.element.clientHeight,this.tableWidth=t.element.clientWidth,t.element.parentNode&&(this.containerHeight=t.element.parentNode.clientHeight,this.containerWidth=t.element.parentNode.clientWidth),typeof IntersectionObserver<"u"&&typeof ResizeObserver<"u"&&t.rowManager.getRenderMode()==="virtual"?(this.initializeVisibilityObserver(),this.autoResize=!0,this.resizeObserver=new ResizeObserver(i=>{if(!t.browserMobile||t.browserMobile&&(!t.modules.edit||t.modules.edit&&!t.modules.edit.currentCell)){var r=Math.floor(i[0].contentRect.height),n=Math.floor(i[0].contentRect.width);(this.tableHeight!=r||this.tableWidth!=n)&&(this.tableHeight=r,this.tableWidth=n,t.element.parentNode&&(this.containerHeight=t.element.parentNode.clientHeight,this.containerWidth=t.element.parentNode.clientWidth),this.redrawTable())}}),this.resizeObserver.observe(t.element),e=window.getComputedStyle(t.element),this.table.element.parentNode&&!this.table.rowManager.fixedHeight&&(e.getPropertyValue("max-height")||e.getPropertyValue("min-height"))&&(this.containerObserver=new ResizeObserver(i=>{if(!t.browserMobile||t.browserMobile&&(!t.modules.edit||t.modules.edit&&!t.modules.edit.currentCell)){var r=Math.floor(i[0].contentRect.height),n=Math.floor(i[0].contentRect.width);(this.containerHeight!=r||this.containerWidth!=n)&&(this.containerHeight=r,this.containerWidth=n,this.tableHeight=t.element.clientHeight,this.tableWidth=t.element.clientWidth),this.redrawTable()}}),this.containerObserver.observe(this.table.element.parentNode)),this.subscribe("table-resize",this.tableResized.bind(this))):(this.binding=function(){(!t.browserMobile||t.browserMobile&&(!t.modules.edit||t.modules.edit&&!t.modules.edit.currentCell))&&(t.columnManager.rerenderColumns(!0),t.redraw())},window.addEventListener("resize",this.binding)),this.subscribe("table-destroy",this.clearBindings.bind(this))}}initializeVisibilityObserver(){this.visibilityObserver=new IntersectionObserver(t=>{this.visible=t[0].isIntersecting,this.initialized?this.visible&&(this.redrawTable(this.initialRedraw),this.initialRedraw=!1):(this.initialized=!0,this.initialRedraw=!this.visible)}),this.visibilityObserver.observe(this.table.element)}redrawTable(t){this.initialized&&this.visible&&(this.table.columnManager.rerenderColumns(!0),this.table.redraw(t))}tableResized(){this.table.rowManager.redraw()}clearBindings(){this.binding&&window.removeEventListener("resize",this.binding),this.resizeObserver&&this.resizeObserver.unobserve(this.table.element),this.visibilityObserver&&this.visibilityObserver.unobserve(this.table.element),this.containerObserver&&this.containerObserver.unobserve(this.table.element.parentNode)}}Ne(lE,"moduleName","resizeTable");function PW(s,t,e){var i=document.createElement("div"),r=s.getRow()._row.modules.responsiveLayout;i.classList.add("tabulator-responsive-collapse-toggle"),i.innerHTML='<svg class=\'tabulator-responsive-collapse-toggle-open\' viewbox="0 0 24 24">\n  <line x1="7" y1="12" x2="17" y2="12" fill="none" stroke-width="3" stroke-linecap="round" />\n  <line y1="7" x1="12" y2="17" x2="12" fill="none" stroke-width="3" stroke-linecap="round" />\n</svg>\n\n<svg class=\'tabulator-responsive-collapse-toggle-close\' viewbox="0 0 24 24">\n  <line x1="7" y1="12" x2="17" y2="12"  fill="none" stroke-width="3" stroke-linecap="round" />\n</svg>',s.getElement().classList.add("tabulator-row-handle");function n(a){var o=r.element;r.open=a,o&&(r.open?(i.classList.add("open"),o.style.display=""):(i.classList.remove("open"),o.style.display="none"))}return i.addEventListener("click",function(a){a.stopImmediatePropagation(),n(!r.open),s.getTable().rowManager.adjustTableSize()}),n(r.open),i}var BW={format:{formatters:{responsiveCollapse:PW}}};class Ip extends pt{constructor(t){super(t),this.columns=[],this.hiddenColumns=[],this.mode="",this.index=0,this.collapseFormatter=[],this.collapseStartOpen=!0,this.collapseHandleColumn=!1,this.registerTableOption("responsiveLayout",!1),this.registerTableOption("responsiveLayoutCollapseStartOpen",!0),this.registerTableOption("responsiveLayoutCollapseUseFormatters",!0),this.registerTableOption("responsiveLayoutCollapseFormatter",!1),this.registerColumnOption("responsive")}initialize(){this.table.options.responsiveLayout&&(this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-show",this.updateColumnVisibility.bind(this)),this.subscribe("column-hide",this.updateColumnVisibility.bind(this)),this.subscribe("columns-loaded",this.initializeResponsivity.bind(this)),this.subscribe("column-moved",this.initializeResponsivity.bind(this)),this.subscribe("column-add",this.initializeResponsivity.bind(this)),this.subscribe("column-delete",this.initializeResponsivity.bind(this)),this.subscribe("table-redrawing",this.tableRedraw.bind(this)),this.table.options.responsiveLayout==="collapse"&&(this.subscribe("row-data-changed",this.generateCollapsedRowContent.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout",this.layoutRow.bind(this))))}tableRedraw(t){["fitColumns","fitDataStretch"].indexOf(this.layoutMode())===-1&&(t||this.update())}initializeResponsivity(){var t=[];this.mode=this.table.options.responsiveLayout,this.collapseFormatter=this.table.options.responsiveLayoutCollapseFormatter||this.formatCollapsedData,this.collapseStartOpen=this.table.options.responsiveLayoutCollapseStartOpen,this.hiddenColumns=[],this.collapseFormatter&&(this.collapseFormatter=this.collapseFormatter.bind(this.table)),this.table.columnManager.columnsByIndex.forEach((e,i)=>{e.modules.responsive&&e.modules.responsive.order&&e.modules.responsive.visible&&(e.modules.responsive.index=i,t.push(e),!e.visible&&this.mode==="collapse"&&this.hiddenColumns.push(e))}),t=t.reverse(),t=t.sort((e,i)=>{var r=i.modules.responsive.order-e.modules.responsive.order;return r||i.modules.responsive.index-e.modules.responsive.index}),this.columns=t,this.mode==="collapse"&&this.generateCollapsedContent();for(let e of this.table.columnManager.columnsByIndex)if(e.definition.formatter=="responsiveCollapse"){this.collapseHandleColumn=e;break}this.collapseHandleColumn&&(this.hiddenColumns.length?this.collapseHandleColumn.show():this.collapseHandleColumn.hide())}initializeColumn(t){var e=t.getDefinition();t.modules.responsive={order:typeof e.responsive>"u"?1:e.responsive,visible:e.visible!==!1}}initializeRow(t){var e;t.type!=="calc"&&(e=document.createElement("div"),e.classList.add("tabulator-responsive-collapse"),t.modules.responsiveLayout={element:e,open:this.collapseStartOpen},this.collapseStartOpen||(e.style.display="none"))}layoutRow(t){var e=t.getElement();t.modules.responsiveLayout&&(e.appendChild(t.modules.responsiveLayout.element),this.generateCollapsedRowContent(t))}updateColumnVisibility(t,e){!e&&t.modules.responsive&&(t.modules.responsive.visible=t.visible,this.initializeResponsivity())}hideColumn(t){var e=this.hiddenColumns.length;t.hide(!1,!0),this.mode==="collapse"&&(this.hiddenColumns.unshift(t),this.generateCollapsedContent(),this.collapseHandleColumn&&!e&&this.collapseHandleColumn.show())}showColumn(t){var e;t.show(!1,!0),t.setWidth(t.getWidth()),this.mode==="collapse"&&(e=this.hiddenColumns.indexOf(t),e>-1&&this.hiddenColumns.splice(e,1),this.generateCollapsedContent(),this.collapseHandleColumn&&!this.hiddenColumns.length&&this.collapseHandleColumn.hide())}update(){for(var t=!0;t;){let e=this.table.modules.layout.getMode()=="fitColumns"?this.table.columnManager.getFlexBaseWidth():this.table.columnManager.getWidth(),i=(this.table.options.headerVisible?this.table.columnManager.element.clientWidth:this.table.element.clientWidth)-e;if(i<0){let r=this.columns[this.index];r?(this.hideColumn(r),this.index++):t=!1}else{let r=this.columns[this.index-1];r&&i>0&&i>=r.getWidth()?(this.showColumn(r),this.index--):t=!1}this.table.rowManager.activeRowsCount||this.table.rowManager.renderEmptyScroll()}}generateCollapsedContent(){var t=this.table.rowManager.getDisplayRows();t.forEach(e=>{this.generateCollapsedRowContent(e)})}generateCollapsedRowContent(t){var e,i;if(t.modules.responsiveLayout){for(e=t.modules.responsiveLayout.element;e.firstChild;)e.removeChild(e.firstChild);i=this.collapseFormatter(this.generateCollapsedRowData(t)),i&&e.appendChild(i),t.calcHeight(!0)}}generateCollapsedRowData(t){var e=t.getData(),i=[],r;return this.hiddenColumns.forEach(n=>{var a=n.getFieldValue(e);if(n.definition.title&&n.field)if(n.modules.format&&this.table.options.responsiveLayoutCollapseUseFormatters){let o=function(l){l()};r={value:!1,data:{},getValue:function(){return a},getData:function(){return e},getType:function(){return"cell"},getElement:function(){return document.createElement("div")},getRow:function(){return t.getComponent()},getColumn:function(){return n.getComponent()},getTable:()=>this.table},i.push({field:n.field,title:n.definition.title,value:n.modules.format.formatter.call(this.table.modules.format,r,n.modules.format.params,o)})}else i.push({field:n.field,title:n.definition.title,value:a})}),i}formatCollapsedData(t){var e=document.createElement("table");return t.forEach(i=>{var r=document.createElement("tr"),n=document.createElement("td"),a=document.createElement("td"),o,l=document.createElement("strong");n.appendChild(l),this.modules.localize.bind("columns|"+i.field,function(h){l.innerHTML=h||i.title}),i.value instanceof Node?(o=document.createElement("div"),o.appendChild(i.value),a.appendChild(o)):a.innerHTML=i.value,r.appendChild(n),r.appendChild(a),e.appendChild(r)}),Object.keys(t).length?e:""}}Ne(Ip,"moduleName","responsiveLayout"),Ne(Ip,"moduleExtensions",BW);function HW(s,t,e){var i=document.createElement("input"),r=!1;if(i.type="checkbox",i.setAttribute("aria-label","Select Row"),this.table.modExists("selectRow",!0))if(i.addEventListener("click",a=>{a.stopPropagation()}),typeof s.getRow=="function"){var n=s.getRow();n instanceof Zc?(i.addEventListener("change",a=>{this.table.options.selectableRowsRangeMode==="click"&&r?r=!1:n.toggleSelect()}),this.table.options.selectableRowsRangeMode==="click"&&i.addEventListener("click",a=>{r=!0,this.table.modules.selectRow.handleComplexRowClick(n._row,a)}),i.checked=n.isSelected&&n.isSelected(),this.table.modules.selectRow.registerRowSelectCheckbox(n,i)):i=""}else i.addEventListener("change",a=>{this.table.modules.selectRow.selectedRows.length?this.table.deselectRow():this.table.selectRow(t.rowRange)}),this.table.modules.selectRow.registerHeaderSelectCheckbox(i);return i}var VW={format:{formatters:{rowSelection:HW}}};class _p extends pt{constructor(t){super(t),this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],this.headerCheckboxElement=null,this.registerTableOption("selectableRows","highlight"),this.registerTableOption("selectableRowsRangeMode","drag"),this.registerTableOption("selectableRowsRollingSelection",!0),this.registerTableOption("selectableRowsPersistence",!0),this.registerTableOption("selectableRowsCheck",function(e,i){return!0}),this.registerTableFunction("selectRow",this.selectRows.bind(this)),this.registerTableFunction("deselectRow",this.deselectRows.bind(this)),this.registerTableFunction("toggleSelectRow",this.toggleRow.bind(this)),this.registerTableFunction("getSelectedRows",this.getSelectedRows.bind(this)),this.registerTableFunction("getSelectedData",this.getSelectedData.bind(this)),this.registerComponentFunction("row","select",this.selectRows.bind(this)),this.registerComponentFunction("row","deselect",this.deselectRows.bind(this)),this.registerComponentFunction("row","toggleSelect",this.toggleRow.bind(this)),this.registerComponentFunction("row","isSelected",this.isRowSelected.bind(this))}initialize(){this.deprecatedOptionsCheck(),this.table.options.selectableRows==="highlight"&&this.table.options.selectableRange&&(this.table.options.selectableRows=!1),this.table.options.selectableRows!==!1&&(this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-deleting",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clearSelectionData.bind(this)),this.subscribe("rows-retrieve",this.rowRetrieve.bind(this)),this.table.options.selectableRows&&!this.table.options.selectableRowsPersistence&&this.subscribe("data-refreshing",this.deselectRows.bind(this)))}deprecatedOptionsCheck(){}rowRetrieve(t,e){return t==="selected"?this.selectedRows:e}rowDeleted(t){this._deselectRow(t,!0)}clearSelectionData(t){var e=this.selectedRows.length;this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],e&&t!==!0&&this._rowSelectionChanged()}initializeRow(t){var e=this,i=e.checkRowSelectability(t),r=t.getElement(),n=function(){setTimeout(function(){e.selecting=!1},50),document.body.removeEventListener("mouseup",n)};t.modules.select={selected:!1},r.classList.toggle("tabulator-selectable",i),r.classList.toggle("tabulator-unselectable",!i),e.checkRowSelectability(t)&&e.table.options.selectableRows&&e.table.options.selectableRows!="highlight"&&(e.table.options.selectableRowsRangeMode==="click"?r.addEventListener("click",this.handleComplexRowClick.bind(this,t)):(r.addEventListener("click",function(a){(!e.table.modExists("edit")||!e.table.modules.edit.getCurrentCell())&&e.table._clearSelection(),e.selecting||e.toggleRow(t)}),r.addEventListener("mousedown",function(a){if(a.shiftKey)return e.table._clearSelection(),e.selecting=!0,e.selectPrev=[],document.body.addEventListener("mouseup",n),document.body.addEventListener("keyup",n),e.toggleRow(t),!1}),r.addEventListener("mouseenter",function(a){e.selecting&&(e.table._clearSelection(),e.toggleRow(t),e.selectPrev[1]==t&&e.toggleRow(e.selectPrev[0]))}),r.addEventListener("mouseout",function(a){e.selecting&&(e.table._clearSelection(),e.selectPrev.unshift(t))})))}handleComplexRowClick(t,e){if(e.shiftKey){this.table._clearSelection(),this.lastClickedRow=this.lastClickedRow||t;var i=this.table.rowManager.getDisplayRowIndex(this.lastClickedRow),r=this.table.rowManager.getDisplayRowIndex(t),n=i<=r?i:r,a=i>=r?i:r,o=this.table.rowManager.getDisplayRows().slice(0),l=o.splice(n,a-n+1);e.ctrlKey||e.metaKey?(l.forEach(h=>{h!==this.lastClickedRow&&(this.table.options.selectableRows!==!0&&!this.isRowSelected(t)?this.selectedRows.length<this.table.options.selectableRows&&this.toggleRow(h):this.toggleRow(h))}),this.lastClickedRow=t):(this.deselectRows(void 0,!0),this.table.options.selectableRows!==!0&&l.length>this.table.options.selectableRows&&(l=l.slice(0,this.table.options.selectableRows)),this.selectRows(l)),this.table._clearSelection()}else e.ctrlKey||e.metaKey?(this.toggleRow(t),this.lastClickedRow=t):(this.deselectRows(void 0,!0),this.selectRows(t),this.lastClickedRow=t)}checkRowSelectability(t){return t&&t.type==="row"?this.table.options.selectableRowsCheck.call(this.table,t.getComponent()):!1}toggleRow(t){this.checkRowSelectability(t)&&(t.modules.select&&t.modules.select.selected?this._deselectRow(t):this._selectRow(t))}selectRows(t){var e=[],i,r;switch(typeof t){case"undefined":i=this.table.rowManager.rows;break;case"number":i=this.table.rowManager.findRow(t);break;case"string":i=this.table.rowManager.findRow(t),i||(i=this.table.rowManager.getRows(t));break;default:i=t;break}Array.isArray(i)?i.length&&(i.forEach(n=>{r=this._selectRow(n,!0,!0),r&&e.push(r)}),this._rowSelectionChanged(!1,e)):i&&this._selectRow(i,!1,!0)}_selectRow(t,e,i){if(!isNaN(this.table.options.selectableRows)&&this.table.options.selectableRows!==!0&&!i&&this.selectedRows.length>=this.table.options.selectableRows)if(this.table.options.selectableRowsRollingSelection)this._deselectRow(this.selectedRows[0]);else return!1;var r=this.table.rowManager.findRow(t);if(r){if(this.selectedRows.indexOf(r)==-1)return r.getElement().classList.add("tabulator-selected"),r.modules.select||(r.modules.select={}),r.modules.select.selected=!0,r.modules.select.checkboxEl&&(r.modules.select.checkboxEl.checked=!0),this.selectedRows.push(r),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(r,!0),this.dispatchExternal("rowSelected",r.getComponent()),this._rowSelectionChanged(e,r),r}else e||console.warn("Selection Error - No such row found, ignoring selection:"+t)}isRowSelected(t){return this.selectedRows.indexOf(t)!==-1}deselectRows(t,e){var i=[],r,n;switch(typeof t){case"undefined":r=Object.assign([],this.selectedRows);break;case"number":r=this.table.rowManager.findRow(t);break;case"string":r=this.table.rowManager.findRow(t),r||(r=this.table.rowManager.getRows(t));break;default:r=t;break}Array.isArray(r)?r.length&&(r.forEach(a=>{n=this._deselectRow(a,!0,!0),n&&i.push(n)}),this._rowSelectionChanged(e,[],i)):r&&this._deselectRow(r,e,!0)}_deselectRow(t,e){var i=this,r=i.table.rowManager.findRow(t),n,a;if(r){if(n=i.selectedRows.findIndex(function(o){return o==r}),n>-1)return a=r.getElement(),a&&a.classList.remove("tabulator-selected"),r.modules.select||(r.modules.select={}),r.modules.select.selected=!1,r.modules.select.checkboxEl&&(r.modules.select.checkboxEl.checked=!1),i.selectedRows.splice(n,1),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(r,!1),this.dispatchExternal("rowDeselected",r.getComponent()),i._rowSelectionChanged(e,void 0,r),r}else e||console.warn("Deselection Error - No such row found, ignoring selection:"+t)}getSelectedData(){var t=[];return this.selectedRows.forEach(function(e){t.push(e.getData())}),t}getSelectedRows(){var t=[];return this.selectedRows.forEach(function(e){t.push(e.getComponent())}),t}_rowSelectionChanged(t,e=[],i=[]){this.headerCheckboxElement&&(this.selectedRows.length===0?(this.headerCheckboxElement.checked=!1,this.headerCheckboxElement.indeterminate=!1):this.table.rowManager.rows.length===this.selectedRows.length?(this.headerCheckboxElement.checked=!0,this.headerCheckboxElement.indeterminate=!1):(this.headerCheckboxElement.indeterminate=!0,this.headerCheckboxElement.checked=!1)),t||(Array.isArray(e)||(e=[e]),e=e.map(r=>r.getComponent()),Array.isArray(i)||(i=[i]),i=i.map(r=>r.getComponent()),this.dispatchExternal("rowSelectionChanged",this.getSelectedData(),this.getSelectedRows(),e,i))}registerRowSelectCheckbox(t,e){t._row.modules.select||(t._row.modules.select={}),t._row.modules.select.checkboxEl=e}registerHeaderSelectCheckbox(t){this.headerCheckboxElement=t}childRowSelection(t,e){var i=this.table.modules.dataTree.getChildren(t,!0,!0);if(e)for(let r of i)this._selectRow(r,!0);else for(let r of i)this._deselectRow(r,!0)}}Ne(_p,"moduleName","selectRow"),Ne(_p,"moduleExtensions",VW);class WW{constructor(t){return this._range=t,new Proxy(this,{get:function(e,i,r){return typeof e[i]<"u"?e[i]:e._range.table.componentFunctionBinder.handle("range",e._range,i)}})}getElement(){return this._range.element}getData(){return this._range.getData()}getCells(){return this._range.getCells(!0,!0)}getStructuredCells(){return this._range.getStructuredCells()}getRows(){return this._range.getRows().map(t=>t.getComponent())}getColumns(){return this._range.getColumns().map(t=>t.getComponent())}getBounds(){return this._range.getBounds()}getTopEdge(){return this._range.top}getBottomEdge(){return this._range.bottom}getLeftEdge(){return this._range.left}getRightEdge(){return this._range.right}setBounds(t,e){this._range.destroyedGuard("setBounds")&&this._range.setBounds(t&&t._cell,e&&e._cell)}setStartBound(t){this._range.destroyedGuard("setStartBound")&&(this._range.setEndBound(t&&t._cell),this._range.rangeManager.layoutElement())}setEndBound(t){this._range.destroyedGuard("setEndBound")&&(this._range.setEndBound(t&&t._cell),this._range.rangeManager.layoutElement())}clearValues(){this._range.destroyedGuard("clearValues")&&this._range.clearValues()}remove(){this._range.destroyedGuard("remove")&&this._range.destroy(!0)}}class zW extends Gi{constructor(t,e,i,r){super(t),this.rangeManager=e,this.element=null,this.initialized=!1,this.initializing={start:!1,end:!1},this.destroyed=!1,this.top=0,this.bottom=0,this.left=0,this.right=0,this.table=t,this.start={row:0,col:0},this.end={row:0,col:0},this.rangeManager.rowHeader&&(this.left=1,this.right=1,this.start.col=1,this.end.col=1),this.initElement(),setTimeout(()=>{this.initBounds(i,r)})}initElement(){this.element=document.createElement("div"),this.element.classList.add("tabulator-range")}initBounds(t,e){this._updateMinMax(),t&&this.setBounds(t,e||t)}setStart(t,e){(this.start.row!==t||this.start.col!==e)&&(this.start.row=t,this.start.col=e,this.initializing.start=!0,this._updateMinMax())}setEnd(t,e){(this.end.row!==t||this.end.col!==e)&&(this.end.row=t,this.end.col=e,this.initializing.end=!0,this._updateMinMax())}setBounds(t,e,i){t&&this.setStartBound(t),this.setEndBound(e||t),this.rangeManager.layoutElement(i)}setStartBound(t){var e,i;t.type==="column"?this.rangeManager.columnSelection&&this.setStart(0,t.getPosition()-1):(e=t.row.position-1,i=t.column.getPosition()-1,t.column===this.rangeManager.rowHeader?this.setStart(e,1):this.setStart(e,i))}setEndBound(t){var e=this._getTableRows().length,i,r,n;t.type==="column"?this.rangeManager.columnSelection&&(this.rangeManager.selecting==="column"?this.setEnd(e-1,t.getPosition()-1):this.rangeManager.selecting==="cell"&&this.setEnd(0,t.getPosition()-1)):(i=t.row.position-1,r=t.column.getPosition()-1,n=t.column===this.rangeManager.rowHeader,this.rangeManager.selecting==="row"?this.setEnd(i,this._getTableColumns().length-1):this.rangeManager.selecting!=="row"&&n?this.setEnd(i,0):this.rangeManager.selecting==="column"?this.setEnd(e-1,r):this.setEnd(i,r))}_updateMinMax(){this.top=Math.min(this.start.row,this.end.row),this.bottom=Math.max(this.start.row,this.end.row),this.left=Math.min(this.start.col,this.end.col),this.right=Math.max(this.start.col,this.end.col),this.initialized?this.dispatchExternal("rangeChanged",this.getComponent()):this.initializing.start&&this.initializing.end&&(this.initialized=!0,this.dispatchExternal("rangeAdded",this.getComponent()))}_getTableColumns(){return this.table.columnManager.getVisibleColumnsByIndex()}_getTableRows(){return this.table.rowManager.getDisplayRows().filter(t=>t.type==="row")}layout(){var t=this.table.rowManager.renderer.vDomTop,e=this.table.rowManager.renderer.vDomBottom,i=this.table.columnManager.renderer.leftCol,r=this.table.columnManager.renderer.rightCol,n,a,o,l,h,u,c,f,d,p;this.table.options.renderHorizontal==="virtual"&&this.rangeManager.rowHeader&&(r+=1),t==null&&(t=0),e==null&&(e=1/0),i==null&&(i=0),r==null&&(r=1/0),this.overlaps(i,t,r,e)&&(n=Math.max(this.top,t),a=Math.min(this.bottom,e),o=Math.max(this.left,i),l=Math.min(this.right,r),h=this.rangeManager.getCell(n,o),u=this.rangeManager.getCell(a,l),c=h.getElement(),f=u.getElement(),d=h.row.getElement(),p=u.row.getElement(),this.element.classList.add("tabulator-range-active"),this.table.rtl?(this.element.style.right=d.offsetWidth-c.offsetLeft-c.offsetWidth+"px",this.element.style.width=c.offsetLeft+c.offsetWidth-f.offsetLeft+"px"):(this.element.style.left=d.offsetLeft+c.offsetLeft+"px",this.element.style.width=f.offsetLeft+f.offsetWidth-c.offsetLeft+"px"),this.element.style.top=d.offsetTop+"px",this.element.style.height=p.offsetTop+p.offsetHeight-d.offsetTop+"px")}atTopLeft(t){return t.row.position-1===this.top&&t.column.getPosition()-1===this.left}atBottomRight(t){return t.row.position-1===this.bottom&&t.column.getPosition()-1===this.right}occupies(t){return this.occupiesRow(t.row)&&this.occupiesColumn(t.column)}occupiesRow(t){return this.top<=t.position-1&&t.position-1<=this.bottom}occupiesColumn(t){return this.left<=t.getPosition()-1&&t.getPosition()-1<=this.right}overlaps(t,e,i,r){return!(this.left>i||t>this.right||this.top>r||e>this.bottom)}getData(){var t=[],e=this.getRows(),i=this.getColumns();return e.forEach(r=>{var n=r.getData(),a={};i.forEach(o=>{a[o.field]=n[o.field]}),t.push(a)}),t}getCells(t,e){var i=[],r=this.getRows(),n=this.getColumns();return t?i=r.map(a=>{var o=[];return a.getCells().forEach(l=>{n.includes(l.column)&&o.push(e?l.getComponent():l)}),o}):r.forEach(a=>{a.getCells().forEach(o=>{n.includes(o.column)&&i.push(e?o.getComponent():o)})}),i}getStructuredCells(){return this.getCells(!0,!0)}getRows(){return this._getTableRows().slice(this.top,this.bottom+1)}getColumns(){return this._getTableColumns().slice(this.left,this.right+1)}clearValues(){var t=this.getCells(),e=this.table.options.selectableRangeClearCellsValue;this.table.blockRedraw(),t.forEach(i=>{i.setValue(e)}),this.table.restoreRedraw()}getBounds(t){var e=this.getCells(!1,t),i={start:null,end:null};return e.length?(i.start=e[0],i.end=e[e.length-1]):console.warn("No bounds defined on range"),i}getComponent(){return this.component||(this.component=new WW(this)),this.component}destroy(t){this.destroyed=!0,this.element.remove(),t&&this.rangeManager.rangeRemoved(this),this.initialized&&this.dispatchExternal("rangeRemoved",this.getComponent())}destroyedGuard(t){return this.destroyed&&console.warn("You cannot call the "+t+" function on a destroyed range"),!this.destroyed}}var jW={rangeJumpUp:["ctrl + 38","meta + 38"],rangeJumpDown:["ctrl + 40","meta + 40"],rangeJumpLeft:["ctrl + 37","meta + 37"],rangeJumpRight:["ctrl + 39","meta + 39"],rangeExpandUp:"shift + 38",rangeExpandDown:"shift + 40",rangeExpandLeft:"shift + 37",rangeExpandRight:"shift + 39",rangeExpandJumpUp:["ctrl + shift + 38","meta + shift + 38"],rangeExpandJumpDown:["ctrl + shift + 40","meta + shift + 40"],rangeExpandJumpLeft:["ctrl + shift + 37","meta + shift + 37"],rangeExpandJumpRight:["ctrl + shift + 39","meta + shift + 39"]},UW={rangeJumpLeft:function(s){this.dispatch("keybinding-nav-range",s,"left",!0,!1)},rangeJumpRight:function(s){this.dispatch("keybinding-nav-range",s,"right",!0,!1)},rangeJumpUp:function(s){this.dispatch("keybinding-nav-range",s,"up",!0,!1)},rangeJumpDown:function(s){this.dispatch("keybinding-nav-range",s,"down",!0,!1)},rangeExpandLeft:function(s){this.dispatch("keybinding-nav-range",s,"left",!1,!0)},rangeExpandRight:function(s){this.dispatch("keybinding-nav-range",s,"right",!1,!0)},rangeExpandUp:function(s){this.dispatch("keybinding-nav-range",s,"up",!1,!0)},rangeExpandDown:function(s){this.dispatch("keybinding-nav-range",s,"down",!1,!0)},rangeExpandJumpLeft:function(s){this.dispatch("keybinding-nav-range",s,"left",!0,!0)},rangeExpandJumpRight:function(s){this.dispatch("keybinding-nav-range",s,"right",!0,!0)},rangeExpandJumpUp:function(s){this.dispatch("keybinding-nav-range",s,"up",!0,!0)},rangeExpandJumpDown:function(s){this.dispatch("keybinding-nav-range",s,"down",!0,!0)}},$W={range:function(s){var t=[],e=this.table.modules.selectRange.activeRange,i=!1,r,n,a,o,l;return l=s.length,e&&(r=e.getBounds(),n=r.start,r.start===r.end&&(i=!0),n&&(t=this.table.rowManager.activeRows.slice(),a=t.indexOf(n.row),i?o=s.length:o=t.indexOf(r.end.row)-a+1,a>-1&&(this.table.blockRedraw(),t=t.slice(a,a+o),t.forEach((h,u)=>{h.updateData(s[u%l])}),this.table.restoreRedraw()))),t}},qW={range:function(s){var t=[],e=[],i=this.table.modules.selectRange.activeRange,r=!1,n,a,o,l,h;return i&&(n=i.getBounds(),a=n.start,n.start===n.end&&(r=!0),a&&(s=s.split("\n"),s.forEach(function(u){t.push(u.split("	"))}),t.length&&(l=this.table.columnManager.getVisibleColumnsByIndex(),h=l.indexOf(a.column),h>-1)))?(r?o=t[0].length:o=l.indexOf(n.end.column)-h+1,l=l.slice(h,h+o),t.forEach(u=>{var c={},f=u.length;l.forEach(function(d,p){c[d.field]=u[p%f]}),e.push(c)}),e):!1}},GW={range:function(){var s=this.modules.selectRange.selectedColumns();return this.columnManager.rowHeader&&s.unshift(this.columnManager.rowHeader),s}},XW={range:function(){return this.modules.selectRange.selectedRows()}},KW={keybindings:{bindings:jW,actions:UW},clipboard:{pasteActions:$W,pasteParsers:qW},export:{columnLookups:GW,rowLookups:XW}};class Gu extends pt{constructor(t){super(t),this.selecting="cell",this.mousedown=!1,this.ranges=[],this.overlay=null,this.rowHeader=null,this.layoutChangeTimeout=null,this.columnSelection=!1,this.rowSelection=!1,this.maxRanges=0,this.activeRange=!1,this.blockKeydown=!1,this.keyDownEvent=this._handleKeyDown.bind(this),this.mouseUpEvent=this._handleMouseUp.bind(this),this.registerTableOption("selectableRange",!1),this.registerTableOption("selectableRangeColumns",!1),this.registerTableOption("selectableRangeRows",!1),this.registerTableOption("selectableRangeClearCells",!1),this.registerTableOption("selectableRangeClearCellsValue",void 0),this.registerTableOption("selectableRangeAutoFocus",!0),this.registerTableFunction("getRangesData",this.getRangesData.bind(this)),this.registerTableFunction("getRanges",this.getRanges.bind(this)),this.registerTableFunction("addRange",this.addRangeFromComponent.bind(this)),this.registerComponentFunction("cell","getRanges",this.cellGetRanges.bind(this)),this.registerComponentFunction("row","getRanges",this.rowGetRanges.bind(this)),this.registerComponentFunction("column","getRanges",this.colGetRanges.bind(this))}initialize(){this.options("selectableRange")&&(this.options("selectableRows")?console.warn("SelectRange functionality cannot be used in conjunction with row selection"):(this.maxRanges=this.options("selectableRange"),this.initializeTable(),this.initializeWatchers()),this.options("columns").findIndex(t=>t.frozen)>0&&console.warn("Having frozen column in arbitrary position with selectRange option may result in unpredictable behavior."),this.options("columns").filter(t=>t.frozen)>1&&console.warn("Having multiple frozen columns with selectRange option may result in unpredictable behavior."))}initializeTable(){this.overlay=document.createElement("div"),this.overlay.classList.add("tabulator-range-overlay"),this.rangeContainer=document.createElement("div"),this.rangeContainer.classList.add("tabulator-range-container"),this.activeRangeCellElement=document.createElement("div"),this.activeRangeCellElement.classList.add("tabulator-range-cell-active"),this.overlay.appendChild(this.rangeContainer),this.overlay.appendChild(this.activeRangeCellElement),this.table.rowManager.element.addEventListener("keydown",this.keyDownEvent),this.resetRanges(),this.table.rowManager.element.appendChild(this.overlay),this.table.columnManager.element.setAttribute("tabindex",0),this.table.element.classList.add("tabulator-ranges")}initializeWatchers(){this.columnSelection=this.options("selectableRangeColumns"),this.rowSelection=this.options("selectableRangeRows"),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-mousedown",this.handleColumnMouseDown.bind(this)),this.subscribe("column-mousemove",this.handleColumnMouseMove.bind(this)),this.subscribe("column-resized",this.handleColumnResized.bind(this)),this.subscribe("column-moving",this.handleColumnMoving.bind(this)),this.subscribe("column-moved",this.handleColumnMoved.bind(this)),this.subscribe("column-width",this.layoutChange.bind(this)),this.subscribe("column-height",this.layoutChange.bind(this)),this.subscribe("column-resized",this.layoutChange.bind(this)),this.subscribe("columns-loaded",this.updateHeaderColumn.bind(this)),this.subscribe("cell-height",this.layoutChange.bind(this)),this.subscribe("cell-rendered",this.renderCell.bind(this)),this.subscribe("cell-mousedown",this.handleCellMouseDown.bind(this)),this.subscribe("cell-mousemove",this.handleCellMouseMove.bind(this)),this.subscribe("cell-click",this.handleCellClick.bind(this)),this.subscribe("cell-editing",this.handleEditingCell.bind(this)),this.subscribe("page-changed",this.redraw.bind(this)),this.subscribe("scroll-vertical",this.layoutChange.bind(this)),this.subscribe("scroll-horizontal",this.layoutChange.bind(this)),this.subscribe("data-destroy",this.tableDestroyed.bind(this)),this.subscribe("data-processed",this.resetRanges.bind(this)),this.subscribe("table-layout",this.layoutElement.bind(this)),this.subscribe("table-redraw",this.redraw.bind(this)),this.subscribe("table-destroy",this.tableDestroyed.bind(this)),this.subscribe("edit-editor-clear",this.finishEditingCell.bind(this)),this.subscribe("edit-blur",this.restoreFocus.bind(this)),this.subscribe("keybinding-nav-prev",this.keyNavigate.bind(this,"left")),this.subscribe("keybinding-nav-next",this.keyNavigate.bind(this,"right")),this.subscribe("keybinding-nav-left",this.keyNavigate.bind(this,"left")),this.subscribe("keybinding-nav-right",this.keyNavigate.bind(this,"right")),this.subscribe("keybinding-nav-up",this.keyNavigate.bind(this,"up")),this.subscribe("keybinding-nav-down",this.keyNavigate.bind(this,"down")),this.subscribe("keybinding-nav-range",this.keyNavigateRange.bind(this))}initializeColumn(t){this.columnSelection&&t.definition.headerSort&&this.options("headerSortClickElement")!=="icon"&&console.warn("Using column headerSort with selectableRangeColumns option may result in unpredictable behavior. Consider using headerSortClickElement: 'icon'."),t.modules.edit}updateHeaderColumn(){var t;this.rowSelection&&(this.rowHeader=this.table.columnManager.getVisibleColumnsByIndex()[0],this.rowHeader&&(this.rowHeader.definition.cssClass=this.rowHeader.definition.cssClass+" tabulator-range-row-header",this.rowHeader.definition.headerSort&&console.warn("Using column headerSort with selectableRangeRows option may result in unpredictable behavior"),this.rowHeader.definition.editor&&console.warn("Using column editor with selectableRangeRows option may result in unpredictable behavior"))),this.table.modules.frozenColumns&&this.table.modules.frozenColumns.active&&(t=this.table.modules.frozenColumns.getFrozenColumns(),(t.length>1||t.length===1&&t[0]!==this.rowHeader)&&console.warn("Using frozen columns that are not the range header in combination with the selectRange option may result in unpredictable behavior"))}getRanges(){return this.ranges.map(t=>t.getComponent())}getRangesData(){return this.ranges.map(t=>t.getData())}addRangeFromComponent(t,e){return t=t?t._cell:null,e=e?e._cell:null,this.addRange(t,e)}cellGetRanges(t){var e=[];return t.column===this.rowHeader?e=this.ranges.filter(i=>i.occupiesRow(t.row)):e=this.ranges.filter(i=>i.occupies(t)),e.map(i=>i.getComponent())}rowGetRanges(t){var e=this.ranges.filter(i=>i.occupiesRow(t));return e.map(i=>i.getComponent())}colGetRanges(t){var e=this.ranges.filter(i=>i.occupiesColumn(t));return e.map(i=>i.getComponent())}_handleMouseUp(t){this.mousedown=!1,document.removeEventListener("mouseup",this.mouseUpEvent)}_handleKeyDown(t){if(!this.blockKeydown&&(!this.table.modules.edit||this.table.modules.edit&&!this.table.modules.edit.currentCell)){if(t.key==="Enter"){if(this.table.modules.edit&&this.table.modules.edit.currentCell)return;this.table.modules.edit.editCell(this.getActiveCell()),t.preventDefault()}(t.key==="Backspace"||t.key==="Delete")&&this.options("selectableRangeClearCells")&&this.activeRange&&this.activeRange.clearValues()}}initializeFocus(t){var e;this.restoreFocus();try{document.selection?(e=document.body.createTextRange(),e.moveToElementText(t.getElement()),e.select()):window.getSelection&&(e=document.createRange(),e.selectNode(t.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(e))}catch(i){}}restoreFocus(t){return this.table.rowManager.element.focus(),!0}handleColumnResized(t){var e;this.selecting!=="column"&&this.selecting!=="all"||(e=this.ranges.some(i=>i.occupiesColumn(t)),e&&this.ranges.forEach(i=>{var r=i.getColumns(!0);r.forEach(n=>{n!==t&&n.setWidth(t.width)})}))}handleColumnMoving(t,e){this.resetRanges().setBounds(e),this.overlay.style.visibility="hidden"}handleColumnMoved(t,e,i){this.activeRange.setBounds(t),this.layoutElement()}handleColumnMouseDown(t,e){t.button===2&&(this.selecting==="column"||this.selecting==="all")&&this.activeRange.occupiesColumn(e)||this.table.options.movableColumns&&this.selecting==="column"&&this.activeRange.occupiesColumn(e)||(this.mousedown=!0,document.addEventListener("mouseup",this.mouseUpEvent),this.newSelection(t,e))}handleColumnMouseMove(t,e){e===this.rowHeader||!this.mousedown||this.selecting==="all"||this.activeRange.setBounds(!1,e,!0)}renderCell(t){var e=t.getElement(),i=this.ranges.findIndex(r=>r.occupies(t));e.classList.toggle("tabulator-range-selected",i!==-1),e.classList.toggle("tabulator-range-only-cell-selected",this.ranges.length===1&&this.ranges[0].atTopLeft(t)&&this.ranges[0].atBottomRight(t)),e.dataset.range=i}handleCellMouseDown(t,e){t.button===2&&(this.activeRange.occupies(e)||(this.selecting==="row"||this.selecting==="all")&&this.activeRange.occupiesRow(e.row))||(this.mousedown=!0,document.addEventListener("mouseup",this.mouseUpEvent),this.newSelection(t,e))}handleCellMouseMove(t,e){!this.mousedown||this.selecting==="all"||this.activeRange.setBounds(!1,e,!0)}handleCellClick(t,e){this.initializeFocus(e)}handleEditingCell(t){this.activeRange&&this.activeRange.setBounds(t)}finishEditingCell(){this.blockKeydown=!0,this.table.rowManager.element.focus(),setTimeout(()=>{this.blockKeydown=!1},10)}keyNavigate(t,e){this.navigate(!1,!1,t),e.preventDefault()}keyNavigateRange(t,e,i,r){this.navigate(i,r,e),t.preventDefault()}navigate(t,e,i){var r=!1,n,a,o,l,h,u,c,f,d,p,v;if(this.table.modules.edit&&this.table.modules.edit.currentCell)return!1;if(this.ranges.length>1&&(this.ranges=this.ranges.filter(g=>g===this.activeRange?(g.setEnd(g.start.row,g.start.col),!0):(g.destroy(),!1))),n=this.activeRange,o={top:n.top,bottom:n.bottom,left:n.left,right:n.right},a=e?n.end:n.start,l=a.row,h=a.col,t)switch(i){case"left":h=this.findJumpCellLeft(n.start.row,a.col);break;case"right":h=this.findJumpCellRight(n.start.row,a.col);break;case"up":l=this.findJumpCellUp(a.row,n.start.col);break;case"down":l=this.findJumpCellDown(a.row,n.start.col);break}else{if(e&&(this.selecting==="row"&&(i==="left"||i==="right")||this.selecting==="column"&&(i==="up"||i==="down")))return;switch(i){case"left":h=Math.max(h-1,0);break;case"right":h=Math.min(h+1,this.getTableColumns().length-1);break;case"up":l=Math.max(l-1,0);break;case"down":l=Math.min(l+1,this.getTableRows().length-1);break}}if(this.rowHeader&&h===0&&(h=1),e||n.setStart(l,h),n.setEnd(l,h),e||(this.selecting="cell"),r=o.top!==n.top||o.bottom!==n.bottom||o.left!==n.left||o.right!==n.right,r)return u=this.getRowByRangePos(n.end.row),c=this.getColumnByRangePos(n.end.col),f=u.getElement().getBoundingClientRect(),p=c.getElement().getBoundingClientRect(),d=this.table.rowManager.getElement().getBoundingClientRect(),v=this.table.columnManager.getElement().getBoundingClientRect(),f.top>=d.top&&f.bottom<=d.bottom||(u.getElement().parentNode&&c.getElement().parentNode?this.autoScroll(n,u.getElement(),c.getElement()):u.getComponent().scrollTo(void 0,!1)),p.left>=v.left+this.getRowHeaderWidth()&&p.right<=v.right||(u.getElement().parentNode&&c.getElement().parentNode?this.autoScroll(n,u.getElement(),c.getElement()):c.getComponent().scrollTo(void 0,!1)),this.layoutElement(),!0}rangeRemoved(t){this.ranges=this.ranges.filter(e=>e!==t),this.activeRange===t&&(this.ranges.length?this.activeRange=this.ranges[this.ranges.length-1]:this.addRange()),this.layoutElement()}findJumpRow(t,e,i,r,n){return i&&(e=e.reverse()),this.findJumpItem(r,n,e,function(a){return a.getData()[t.getField()]})}findJumpCol(t,e,i,r,n){return i&&(e=e.reverse()),this.findJumpItem(r,n,e,function(a){return t.getData()[a.getField()]})}findJumpItem(t,e,i,r){var n;for(let a of i){let o=r(a);if(t){if(n=a,o)break}else if(e){if(n=a,o)break}else if(o)n=a;else break}return n}findJumpCellLeft(t,e){var i=this.getRowByRangePos(t),r=this.getTableColumns(),n=this.isEmpty(i.getData()[r[e].getField()]),a=r[e-1]?this.isEmpty(i.getData()[r[e-1].getField()]):!1,o=this.rowHeader?r.slice(1,e):r.slice(0,e),l=this.findJumpCol(i,o,!0,n,a);return l?l.getPosition()-1:e}findJumpCellRight(t,e){var i=this.getRowByRangePos(t),r=this.getTableColumns(),n=this.isEmpty(i.getData()[r[e].getField()]),a=r[e+1]?this.isEmpty(i.getData()[r[e+1].getField()]):!1,o=this.findJumpCol(i,r.slice(e+1,r.length),!1,n,a);return o?o.getPosition()-1:e}findJumpCellUp(t,e){var i=this.getColumnByRangePos(e),r=this.getTableRows(),n=this.isEmpty(r[t].getData()[i.getField()]),a=r[t-1]?this.isEmpty(r[t-1].getData()[i.getField()]):!1,o=this.findJumpRow(i,r.slice(0,t),!0,n,a);return o?o.position-1:t}findJumpCellDown(t,e){var i=this.getColumnByRangePos(e),r=this.getTableRows(),n=this.isEmpty(r[t].getData()[i.getField()]),a=r[t+1]?this.isEmpty(r[t+1].getData()[i.getField()]):!1,o=this.findJumpRow(i,r.slice(t+1,r.length),!1,n,a);return o?o.position-1:t}newSelection(t,e){var i;if(e.type==="column"){if(!this.columnSelection)return;if(e===this.rowHeader){i=this.resetRanges(),this.selecting="all";var r,n=this.getCell(-1,-1);this.rowHeader?r=this.getCell(0,1):r=this.getCell(0,0),i.setBounds(r,n);return}else this.selecting="column"}else e.column===this.rowHeader?this.selecting="row":this.selecting="cell";t.shiftKey?this.activeRange.setBounds(!1,e):t.ctrlKey?this.addRange().setBounds(e):this.resetRanges().setBounds(e)}autoScroll(t,e,i){var r=this.table.rowManager.element,n,a,o,l;typeof e>"u"&&(e=this.getRowByRangePos(t.end.row).getElement()),typeof i>"u"&&(i=this.getColumnByRangePos(t.end.col).getElement()),n={left:i.offsetLeft,right:i.offsetLeft+i.offsetWidth,top:e.offsetTop,bottom:e.offsetTop+e.offsetHeight},a={left:r.scrollLeft+this.getRowHeaderWidth(),right:Math.ceil(r.scrollLeft+r.clientWidth),top:r.scrollTop,bottom:r.scrollTop+r.offsetHeight-this.table.rowManager.scrollbarWidth},o=a.left<n.left&&n.left<a.right&&a.left<n.right&&n.right<a.right,l=a.top<n.top&&n.top<a.bottom&&a.top<n.bottom&&n.bottom<a.bottom,o||(n.left<a.left?r.scrollLeft=n.left-this.getRowHeaderWidth():n.right>a.right&&(r.scrollLeft=Math.min(n.right-r.clientWidth,n.left-this.getRowHeaderWidth()))),l||(n.top<a.top?r.scrollTop=n.top:n.bottom>a.bottom&&(r.scrollTop=n.bottom-r.clientHeight))}layoutChange(){this.overlay.style.visibility="hidden",clearTimeout(this.layoutChangeTimeout),this.layoutChangeTimeout=setTimeout(this.layoutRanges.bind(this),200)}redraw(t){t&&(this.selecting="cell",this.resetRanges(),this.layoutElement())}layoutElement(t){var e;t?e=this.table.rowManager.getVisibleRows(!0):e=this.table.rowManager.getRows(),e.forEach(i=>{i.type==="row"&&(this.layoutRow(i),i.cells.forEach(r=>this.renderCell(r)))}),this.getTableColumns().forEach(i=>{this.layoutColumn(i)}),this.layoutRanges()}layoutRow(t){var e=t.getElement(),i=!1,r=this.ranges.some(n=>n.occupiesRow(t));this.selecting==="row"?i=r:this.selecting==="all"&&(i=!0),e.classList.toggle("tabulator-range-selected",i),e.classList.toggle("tabulator-range-highlight",r)}layoutColumn(t){var e=t.getElement(),i=!1,r=this.ranges.some(n=>n.occupiesColumn(t));this.selecting==="column"?i=r:this.selecting==="all"&&(i=!0),e.classList.toggle("tabulator-range-selected",i),e.classList.toggle("tabulator-range-highlight",r)}layoutRanges(){var t,e,i;this.table.initialized&&(t=this.getActiveCell(),t&&(e=t.getElement(),i=t.row.getElement(),this.table.rtl?this.activeRangeCellElement.style.right=i.offsetWidth-e.offsetLeft-e.offsetWidth+"px":this.activeRangeCellElement.style.left=i.offsetLeft+e.offsetLeft+"px",this.activeRangeCellElement.style.top=i.offsetTop+"px",this.activeRangeCellElement.style.width=e.offsetWidth+"px",this.activeRangeCellElement.style.height=i.offsetHeight+"px",this.ranges.forEach(r=>r.layout()),this.overlay.style.visibility="visible"))}getCell(t,e){var i;return e<0&&(e=this.getTableColumns().length+e,e<0)?null:(t<0&&(t=this.getTableRows().length+t),i=this.table.rowManager.getRowFromPosition(t+1),i?i.getCells(!1,!0).filter(r=>r.column.visible)[e]:null)}getActiveCell(){return this.getCell(this.activeRange.start.row,this.activeRange.start.col)}getRowByRangePos(t){return this.getTableRows()[t]}getColumnByRangePos(t){return this.getTableColumns()[t]}getTableRows(){return this.table.rowManager.getDisplayRows().filter(t=>t.type==="row")}getTableColumns(){return this.table.columnManager.getVisibleColumnsByIndex()}addRange(t,e){var i;return this.maxRanges!==!0&&this.ranges.length>=this.maxRanges&&this.ranges.shift().destroy(),i=new zW(this.table,this,t,e),this.activeRange=i,this.ranges.push(i),this.rangeContainer.appendChild(i.element),i}resetRanges(){var t,e,i;return this.ranges.forEach(r=>r.destroy()),this.ranges=[],t=this.addRange(),this.table.rowManager.activeRows.length&&(i=this.table.rowManager.activeRows[0].cells.filter(r=>r.column.visible),e=i[this.rowHeader?1:0],e&&(t.setBounds(e),this.options("selectableRangeAutoFocus")&&this.initializeFocus(e))),t}tableDestroyed(){document.removeEventListener("mouseup",this.mouseUpEvent),this.table.rowManager.element.removeEventListener("keydown",this.keyDownEvent)}selectedRows(t){return t?this.activeRange.getRows().map(e=>e.getComponent()):this.activeRange.getRows()}selectedColumns(t){return t?this.activeRange.getColumns().map(e=>e.getComponent()):this.activeRange.getColumns()}getRowHeaderWidth(){return this.rowHeader?this.rowHeader.getElement().offsetWidth:0}isEmpty(t){return t==null||t===""}}Ne(Gu,"moduleName","selectRange"),Ne(Gu,"moduleInitOrder",1),Ne(Gu,"moduleExtensions",KW);function YW(s,t,e,i,r,n,a){var o=a.alignEmptyValues,l=a.decimalSeparator,h=a.thousandSeparator,u=0;if(s=String(s),t=String(t),h&&(s=s.split(h).join(""),t=t.split(h).join("")),l&&(s=s.split(l).join("."),t=t.split(l).join(".")),s=parseFloat(s),t=parseFloat(t),isNaN(s))u=isNaN(t)?0:-1;else if(isNaN(t))u=1;else return s-t;return(o==="top"&&n==="desc"||o==="bottom"&&n==="asc")&&(u*=-1),u}function JW(s,t,e,i,r,n,a){var o=a.alignEmptyValues,l=0,h;if(!s)l=t?-1:0;else if(!t)l=1;else{switch(typeof a.locale){case"boolean":a.locale&&(h=this.langLocale());break;case"string":h=a.locale;break}return String(s).toLowerCase().localeCompare(String(t).toLowerCase(),h)}return(o==="top"&&n==="desc"||o==="bottom"&&n==="asc")&&(l*=-1),l}function bv(s,t,e,i,r,n,a){var o=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),l=a.format||"dd/MM/yyyy HH:mm:ss",h=a.alignEmptyValues,u=0;if(typeof o<"u"){if(o.isDateTime(s)||(l==="iso"?s=o.fromISO(String(s)):s=o.fromFormat(String(s),l)),o.isDateTime(t)||(l==="iso"?t=o.fromISO(String(t)):t=o.fromFormat(String(t),l)),!s.isValid)u=t.isValid?-1:0;else if(!t.isValid)u=1;else return s-t;return(h==="top"&&n==="desc"||h==="bottom"&&n==="asc")&&(u*=-1),u}else console.error("Sort Error - 'datetime' sorter is dependant on luxon.js")}function QW(s,t,e,i,r,n,a){return a.format||(a.format="dd/MM/yyyy"),bv.call(this,s,t,e,i,r,n,a)}function ZW(s,t,e,i,r,n,a){return a.format||(a.format="HH:mm"),bv.call(this,s,t,e,i,r,n,a)}function ez(s,t,e,i,r,n,a){var o=s===!0||s==="true"||s==="True"||s===1?1:0,l=t===!0||t==="true"||t==="True"||t===1?1:0;return o-l}function tz(s,t,e,i,r,n,a){var o=a.type||"length",l=a.alignEmptyValues,h=0,u=this.table,c;a.valueMap&&(typeof a.valueMap=="string"?c=function(d){return d.map(p=>$t.retrieveNestedData(u.options.nestedFieldSeparator,a.valueMap,p))}:c=a.valueMap);function f(d){var p;switch(c&&(d=c(d)),o){case"length":p=d.length;break;case"sum":p=d.reduce(function(v,g){return v+g});break;case"max":p=Math.max.apply(null,d);break;case"min":p=Math.min.apply(null,d);break;case"avg":p=d.reduce(function(v,g){return v+g})/d.length;break;case"string":p=d.join("");break}return p}if(!Array.isArray(s))h=Array.isArray(t)?-1:0;else if(!Array.isArray(t))h=1;else return o==="string"?String(f(s)).toLowerCase().localeCompare(String(f(t)).toLowerCase()):f(t)-f(s);return(l==="top"&&n==="desc"||l==="bottom"&&n==="asc")&&(h*=-1),h}function iz(s,t,e,i,r,n,a){var o=typeof s>"u"?0:1,l=typeof t>"u"?0:1;return o-l}function rz(s,t,e,i,r,n,a){var o,l,h,u,c=0,f,d=/(\d+)|(\D+)/g,p=/\d/,v=a.alignEmptyValues,g=0;if(!s&&s!==0)g=!t&&t!==0?0:-1;else if(!t&&t!==0)g=1;else{if(isFinite(s)&&isFinite(t))return s-t;if(o=String(s).toLowerCase(),l=String(t).toLowerCase(),o===l)return 0;if(!(p.test(o)&&p.test(l)))return o>l?1:-1;for(o=o.match(d),l=l.match(d),f=o.length>l.length?l.length:o.length;c<f;)if(h=o[c],u=l[c++],h!==u)return isFinite(h)&&isFinite(u)?(h.charAt(0)==="0"&&(h="."+h),u.charAt(0)==="0"&&(u="."+u),h-u):h>u?1:-1;return o.length>l.length}return(v==="top"&&n==="desc"||v==="bottom"&&n==="asc")&&(g*=-1),g}var sz={number:YW,string:JW,date:QW,time:ZW,datetime:bv,boolean:ez,array:tz,exists:iz,alphanum:rz};const aa=class aa extends pt{constructor(t){super(t),this.sortList=[],this.changed=!1,this.registerTableOption("sortMode","local"),this.registerTableOption("initialSort",!1),this.registerTableOption("columnHeaderSortMulti",!0),this.registerTableOption("sortOrderReverse",!1),this.registerTableOption("headerSortElement","<div class='tabulator-arrow'></div>"),this.registerTableOption("headerSortClickElement","header"),this.registerColumnOption("sorter"),this.registerColumnOption("sorterParams"),this.registerColumnOption("headerSort",!0),this.registerColumnOption("headerSortStartingDir"),this.registerColumnOption("headerSortTristate")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.registerDataHandler(this.sort.bind(this),20),this.registerTableFunction("setSort",this.userSetSort.bind(this)),this.registerTableFunction("getSorters",this.getSort.bind(this)),this.registerTableFunction("clearSort",this.clearSort.bind(this)),this.table.options.sortMode==="remote"&&this.subscribe("data-params",this.remoteSortParams.bind(this))}tableBuilt(){this.table.options.initialSort&&this.setSort(this.table.options.initialSort)}remoteSortParams(t,e,i,r){var n=this.getSort();return n.forEach(a=>{delete a.column}),r.sort=n,r}userSetSort(t,e){this.setSort(t,e),this.refreshSort()}clearSort(){this.clear(),this.refreshSort()}initializeColumn(t){var e=!1,i,r;switch(typeof t.definition.sorter){case"string":aa.sorters[t.definition.sorter]?e=aa.sorters[t.definition.sorter]:console.warn("Sort Error - No such sorter found: ",t.definition.sorter);break;case"function":e=t.definition.sorter;break}if(t.modules.sort={sorter:e,dir:"none",params:t.definition.sorterParams||{},startingDir:t.definition.headerSortStartingDir||"asc",tristate:t.definition.headerSortTristate},t.definition.headerSort!==!1){switch(i=t.getElement(),i.classList.add("tabulator-sortable"),r=document.createElement("div"),r.classList.add("tabulator-col-sorter"),this.table.options.headerSortClickElement){case"icon":r.classList.add("tabulator-col-sorter-element");break;case"header":i.classList.add("tabulator-col-sorter-element");break;default:i.classList.add("tabulator-col-sorter-element");break}switch(this.table.options.headerSortElement){case"function":break;case"object":r.appendChild(this.table.options.headerSortElement);break;default:r.innerHTML=this.table.options.headerSortElement}t.titleHolderElement.appendChild(r),t.modules.sort.element=r,this.setColumnHeaderSortIcon(t,"none"),this.table.options.headerSortClickElement==="icon"&&r.addEventListener("mousedown",n=>{n.stopPropagation()}),(this.table.options.headerSortClickElement==="icon"?r:i).addEventListener("click",n=>{var a="",o=[],l=!1;if(t.modules.sort){if(t.modules.sort.tristate)t.modules.sort.dir=="none"?a=t.modules.sort.startingDir:t.modules.sort.dir==t.modules.sort.startingDir?a=t.modules.sort.dir=="asc"?"desc":"asc":a="none";else switch(t.modules.sort.dir){case"asc":a="desc";break;case"desc":a="asc";break;default:a=t.modules.sort.startingDir}this.table.options.columnHeaderSortMulti&&(n.shiftKey||n.ctrlKey)?(o=this.getSort(),l=o.findIndex(h=>h.field===t.getField()),l>-1?(o[l].dir=a,l=o.splice(l,1)[0],a!="none"&&o.push(l)):a!="none"&&o.push({column:t,dir:a}),this.setSort(o)):a=="none"?this.clear():this.setSort(t,a),this.refreshSort()}})}}refreshSort(){this.table.options.sortMode==="remote"?this.reloadData(null,!1,!1):this.refreshData(!0)}hasChanged(){var t=this.changed;return this.changed=!1,t}getSort(){var t=this,e=[];return t.sortList.forEach(function(i){i.column&&e.push({column:i.column.getComponent(),field:i.column.getField(),dir:i.dir})}),e}setSort(t,e){var i=this,r=[];Array.isArray(t)||(t=[{column:t,dir:e}]),t.forEach(function(n){var a;a=i.table.columnManager.findColumn(n.column),a?(n.column=a,r.push(n),i.changed=!0):console.warn("Sort Warning - Sort field does not exist and is being ignored: ",n.column)}),i.sortList=r,this.dispatch("sort-changed")}clear(){this.setSort([])}findSorter(t){var e=this.table.rowManager.activeRows[0],i="string",r,n;if(e&&(e=e.getData(),r=t.getField(),r))switch(n=t.getFieldValue(e),typeof n){case"undefined":i="string";break;case"boolean":i="boolean";break;default:!isNaN(n)&&n!==""?i="number":n.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)&&(i="alphanum");break}return aa.sorters[i]}sort(t,e){var i=this,r=this.table.options.sortOrderReverse?i.sortList.slice().reverse():i.sortList,n=[],a=[];return this.subscribedExternal("dataSorting")&&this.dispatchExternal("dataSorting",i.getSort()),e||i.clearColumnHeaders(),this.table.options.sortMode!=="remote"?(r.forEach(function(o,l){var h;o.column&&(h=o.column.modules.sort,h&&(h.sorter||(h.sorter=i.findSorter(o.column)),o.params=typeof h.params=="function"?h.params(o.column.getComponent(),o.dir):h.params,n.push(o)),e||i.setColumnHeader(o.column,o.dir))}),n.length&&i._sortItems(t,n)):e||r.forEach(function(o,l){i.setColumnHeader(o.column,o.dir)}),this.subscribedExternal("dataSorted")&&(t.forEach(o=>{a.push(o.getComponent())}),this.dispatchExternal("dataSorted",i.getSort(),a)),t}clearColumnHeaders(){this.table.columnManager.getRealColumns().forEach(t=>{t.modules.sort&&(t.modules.sort.dir="none",t.getElement().setAttribute("aria-sort","none"),this.setColumnHeaderSortIcon(t,"none"))})}setColumnHeader(t,e){t.modules.sort.dir=e,t.getElement().setAttribute("aria-sort",e==="asc"?"ascending":"descending"),this.setColumnHeaderSortIcon(t,e)}setColumnHeaderSortIcon(t,e){var i=t.modules.sort.element,r;if(t.definition.headerSort&&typeof this.table.options.headerSortElement=="function"){for(;i.firstChild;)i.removeChild(i.firstChild);r=this.table.options.headerSortElement.call(this.table,t.getComponent(),e),typeof r=="object"?i.appendChild(r):i.innerHTML=r}}_sortItems(t,e){var i=e.length-1;t.sort((r,n)=>{for(var a,o=i;o>=0;o--){let l=e[o];if(a=this._sortRow(r,n,l.column,l.dir,l.params),a!==0)break}return a})}_sortRow(t,e,i,r,n){var a,o,l=r=="asc"?t:e,h=r=="asc"?e:t;return t=i.getFieldValue(l.getData()),e=i.getFieldValue(h.getData()),t=typeof t<"u"?t:"",e=typeof e<"u"?e:"",a=l.getComponent(),o=h.getComponent(),i.modules.sort.sorter.call(this,t,e,a,o,i.getComponent(),r,n)}};Ne(aa,"moduleName","sort"),Ne(aa,"sorters",sz);let Fp=aa;class nz{constructor(t,e){this.columnCount=t,this.rowCount=e,this.columnString=[],this.columns=[],this.rows=[]}genColumns(t){var e=Math.max(this.columnCount,Math.max(...t.map(i=>i.length)));this.columnString=[],this.columns=[];for(let i=1;i<=e;i++)this.incrementChar(this.columnString.length-1),this.columns.push(this.columnString.join(""));return this.columns}genRows(t){var e=Math.max(this.rowCount,t.length);this.rows=[];for(let i=1;i<=e;i++)this.rows.push(i);return this.rows}incrementChar(t){let e=this.columnString[t];e?e!=="Z"?this.columnString[t]=String.fromCharCode(this.columnString[t].charCodeAt(0)+1):(this.columnString[t]="A",t?this.incrementChar(t-1):this.columnString.push("A")):this.columnString.push("A")}setRowCount(t){this.rowCount=t}setColumnCount(t){this.columnCount=t}}class hE{constructor(t){return this._sheet=t,new Proxy(this,{get:function(e,i,r){return typeof e[i]<"u"?e[i]:e._sheet.table.componentFunctionBinder.handle("sheet",e._sheet,i)}})}getTitle(){return this._sheet.title}getKey(){return this._sheet.key}getDefinition(){return this._sheet.getDefinition()}getData(){return this._sheet.getData()}setData(t){return this._sheet.setData(t)}clear(){return this._sheet.clear()}remove(){return this._sheet.remove()}active(){return this._sheet.active()}setTitle(t){return this._sheet.setTitle(t)}setRows(t){return this._sheet.setRows(t)}setColumns(t){return this._sheet.setColumns(t)}}class wy extends Gi{constructor(t,e){super(t.table),this.spreadsheetManager=t,this.definition=e,this.title=this.definition.title||"",this.key=this.definition.key||this.definition.title,this.rowCount=this.definition.rows,this.columnCount=this.definition.columns,this.data=this.definition.data||[],this.element=null,this.isActive=!1,this.grid=new nz(this.columnCount,this.rowCount),this.defaultColumnDefinition={width:100,headerHozAlign:"center",headerSort:!1},this.columnDefinition=Object.assign(this.defaultColumnDefinition,this.options("spreadsheetColumnDefinition")),this.columnDefs=[],this.rowDefs=[],this.columnFields=[],this.columns=[],this.rows=[],this.scrollTop=null,this.scrollLeft=null,this.initialize(),this.dispatchExternal("sheetAdded",this.getComponent())}initialize(){this.initializeElement(),this.initializeColumns(),this.initializeRows()}reinitialize(){this.initializeColumns(),this.initializeRows()}initializeElement(){this.element=document.createElement("div"),this.element.classList.add("tabulator-spreadsheet-tab"),this.element.innerText=this.title,this.element.addEventListener("click",()=>{this.spreadsheetManager.loadSheet(this)})}initializeColumns(){this.grid.setColumnCount(this.columnCount),this.columnFields=this.grid.genColumns(this.data),this.columnDefs=[],this.columnFields.forEach(t=>{var e=Object.assign({},this.columnDefinition);e.field=t,e.title=t,this.columnDefs.push(e)})}initializeRows(){var t;this.grid.setRowCount(this.rowCount),t=this.grid.genRows(this.data),this.rowDefs=[],t.forEach((e,i)=>{var r={_id:e},n=this.data[i];n&&n.forEach((a,o)=>{var l=this.columnFields[o];l&&(r[l]=a)}),this.rowDefs.push(r)})}unload(){this.isActive=!1,this.scrollTop=this.table.rowManager.scrollTop,this.scrollLeft=this.table.rowManager.scrollLeft,this.data=this.getData(!0),this.element.classList.remove("tabulator-spreadsheet-tab-active")}load(){var t=!this.isActive;this.isActive=!0,this.table.blockRedraw(),this.table.setData([]),this.table.setColumns(this.columnDefs),this.table.setData(this.rowDefs),this.table.restoreRedraw(),t&&this.scrollTop!==null&&(this.table.rowManager.element.scrollLeft=this.scrollLeft,this.table.rowManager.element.scrollTop=this.scrollTop),this.element.classList.add("tabulator-spreadsheet-tab-active"),this.dispatchExternal("sheetLoaded",this.getComponent())}getComponent(){return new hE(this)}getDefinition(){return{title:this.title,key:this.key,rows:this.rowCount,columns:this.columnCount,data:this.getData()}}getData(t){var e=[],i,r,n;return this.rowDefs.forEach(a=>{var o=[];this.columnFields.forEach(l=>{o.push(a[l])}),e.push(o)}),!t&&!this.options("spreadsheetOutputFull")&&(i=e.map(a=>a.findLastIndex(o=>typeof o<"u")+1),r=Math.max(...i),n=i.findLastIndex(a=>a>0)+1,e=e.slice(0,n),e=e.map(a=>a.slice(0,r))),e}setData(t){this.data=t,this.reinitialize(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}clear(){this.setData([])}setTitle(t){this.title=t,this.element.innerText=t,this.dispatchExternal("sheetUpdated",this.getComponent())}setRows(t){this.rowCount=t,this.initializeRows(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}setColumns(t){this.columnCount=t,this.reinitialize(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}remove(){this.spreadsheetManager.removeSheet(this)}destroy(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.dispatchExternal("sheetRemoved",this.getComponent())}active(){this.spreadsheetManager.loadSheet(this)}}class uE extends pt{constructor(t){super(t),this.sheets=[],this.element=null,this.registerTableOption("spreadsheet",!1),this.registerTableOption("spreadsheetRows",50),this.registerTableOption("spreadsheetColumns",50),this.registerTableOption("spreadsheetColumnDefinition",{}),this.registerTableOption("spreadsheetOutputFull",!1),this.registerTableOption("spreadsheetData",!1),this.registerTableOption("spreadsheetSheets",!1),this.registerTableOption("spreadsheetSheetTabs",!1),this.registerTableOption("spreadsheetSheetTabsElement",!1),this.registerTableFunction("setSheets",this.setSheets.bind(this)),this.registerTableFunction("addSheet",this.addSheet.bind(this)),this.registerTableFunction("getSheets",this.getSheets.bind(this)),this.registerTableFunction("getSheetDefinitions",this.getSheetDefinitions.bind(this)),this.registerTableFunction("setSheetData",this.setSheetData.bind(this)),this.registerTableFunction("getSheet",this.getSheet.bind(this)),this.registerTableFunction("getSheetData",this.getSheetData.bind(this)),this.registerTableFunction("clearSheet",this.clearSheet.bind(this)),this.registerTableFunction("removeSheet",this.removeSheetFunc.bind(this)),this.registerTableFunction("activeSheet",this.activeSheetFunc.bind(this))}initialize(){this.options("spreadsheet")&&(this.subscribe("table-initialized",this.tableInitialized.bind(this)),this.subscribe("data-loaded",this.loadRemoteData.bind(this)),this.table.options.index="_id",this.options("spreadsheetData")&&this.options("spreadsheetSheets")&&(console.warn("You cannot use spreadsheetData and spreadsheetSheets at the same time, ignoring spreadsheetData"),this.table.options.spreadsheetData=!1),this.compatibilityCheck(),this.options("spreadsheetSheetTabs")&&this.initializeTabset())}compatibilityCheck(){this.options("data")&&console.warn("Do not use the data option when working with spreadsheets, use either spreadsheetData or spreadsheetSheets to pass data into the table"),this.options("pagination")&&console.warn("The spreadsheet module is not compatible with the pagination module"),this.options("groupBy")&&console.warn("The spreadsheet module is not compatible with the row grouping module"),this.options("responsiveCollapse")&&console.warn("The spreadsheet module is not compatible with the responsive collapse module")}initializeTabset(){this.element=document.createElement("div"),this.element.classList.add("tabulator-spreadsheet-tabs");var t=this.options("spreadsheetSheetTabsElement");t&&!(t instanceof HTMLElement)&&(t=document.querySelector(t),t||console.warn("Unable to find element matching spreadsheetSheetTabsElement selector:",this.options("spreadsheetSheetTabsElement"))),t?t.appendChild(this.element):this.footerAppend(this.element)}tableInitialized(){this.sheets.length?this.loadSheet(this.sheets[0]):this.options("spreadsheetSheets")?this.loadSheets(this.options("spreadsheetSheets")):this.options("spreadsheetData")&&this.loadData(this.options("spreadsheetData"))}loadRemoteData(t,e,i){return console.log("data",t,e,i),Array.isArray(t)?(this.table.dataLoader.clearAlert(),this.dispatchExternal("dataLoaded",t),!t.length||Array.isArray(t[0])?this.loadData(t):this.loadSheets(t)):console.error("Spreadsheet Loading Error - Unable to process remote data due to invalid data type \nExpecting: array \nReceived: ",typeof t,"\nData:     ",t),!1}loadData(t){var e={data:t};this.loadSheet(this.newSheet(e))}destroySheets(){this.sheets.forEach(t=>{t.destroy()}),this.sheets=[],this.activeSheet=null}loadSheets(t){Array.isArray(t)||(t=[]),this.destroySheets(),t.forEach(e=>{this.newSheet(e)}),this.loadSheet(this.sheets[0])}loadSheet(t){this.activeSheet!==t&&(this.activeSheet&&this.activeSheet.unload(),this.activeSheet=t,t.load())}newSheet(t={}){var e;return t.rows||(t.rows=this.options("spreadsheetRows")),t.columns||(t.columns=this.options("spreadsheetColumns")),e=new wy(this,t),this.sheets.push(e),this.element&&this.element.appendChild(e.element),e}removeSheet(t){var e=this.sheets.indexOf(t),i;this.sheets.length>1?e>-1&&(this.sheets.splice(e,1),t.destroy(),this.activeSheet===t&&(i=this.sheets[e-1]||this.sheets[0],i?this.loadSheet(i):this.activeSheet=null)):console.warn("Unable to remove sheet, at least one sheet must be active")}lookupSheet(t){return t?t instanceof wy?t:t instanceof hE?t._sheet:this.sheets.find(e=>e.key===t)||!1:this.activeSheet}setSheets(t){return this.loadSheets(t),this.getSheets()}addSheet(t){return this.newSheet(t).getComponent()}getSheetDefinitions(){return this.sheets.map(t=>t.getDefinition())}getSheets(){return this.sheets.map(t=>t.getComponent())}getSheet(t){var e=this.lookupSheet(t);return e?e.getComponent():!1}setSheetData(t,e){t&&!e&&(e=t,t=!1);var i=this.lookupSheet(t);return i?i.setData(e):!1}getSheetData(t){var e=this.lookupSheet(t);return e?e.getData():!1}clearSheet(t){var e=this.lookupSheet(t);return e?e.clear():!1}removeSheetFunc(t){var e=this.lookupSheet(t);e&&this.removeSheet(e)}activeSheetFunc(t){var e=this.lookupSheet(t);return e?this.loadSheet(e):!1}}Ne(uE,"moduleName","spreadsheet");class cE extends pt{constructor(t){super(t),this.tooltipSubscriber=null,this.headerSubscriber=null,this.timeout=null,this.popupInstance=null,this.registerTableOption("tooltipDelay",300),this.registerColumnOption("tooltip"),this.registerColumnOption("headerTooltip")}initialize(){this.deprecatedOptionsCheck(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){}initializeColumn(t){t.definition.headerTooltip&&!this.headerSubscriber&&(this.headerSubscriber=!0,this.subscribe("column-mousemove",this.mousemoveCheck.bind(this,"headerTooltip")),this.subscribe("column-mouseout",this.mouseoutCheck.bind(this,"headerTooltip"))),t.definition.tooltip&&!this.tooltipSubscriber&&(this.tooltipSubscriber=!0,this.subscribe("cell-mousemove",this.mousemoveCheck.bind(this,"tooltip")),this.subscribe("cell-mouseout",this.mouseoutCheck.bind(this,"tooltip")))}mousemoveCheck(t,e,i){var r=t==="tooltip"?i.column.definition.tooltip:i.definition.headerTooltip;r&&(this.clearPopup(),this.timeout=setTimeout(this.loadTooltip.bind(this,e,i,r),this.table.options.tooltipDelay))}mouseoutCheck(t,e,i){this.popupInstance||this.clearPopup()}clearPopup(t,e,i){clearTimeout(this.timeout),this.timeout=null,this.popupInstance&&this.popupInstance.hide()}loadTooltip(t,e,i){var r,n,a;function o(l){n=l}typeof i=="function"&&(i=i(t,e.getComponent(),o)),i instanceof HTMLElement?r=i:(r=document.createElement("div"),i===!0&&(e instanceof Dh?i=e.value:e.definition.field?this.langBind("columns|"+e.definition.field,l=>{r.innerHTML=i=l||e.definition.title}):i=e.definition.title),r.innerHTML=i),(i||i===0||i===!1)&&(r.classList.add("tabulator-tooltip"),r.addEventListener("mousemove",l=>l.preventDefault()),this.popupInstance=this.popup(r),typeof n=="function"&&this.popupInstance.renderCallback(n),a=this.popupInstance.containerEventCoords(t),this.popupInstance.show(a.x+15,a.y+15).hideOnBlur(()=>{this.dispatchExternal("TooltipClosed",e.getComponent()),this.popupInstance=null}),this.dispatchExternal("TooltipOpened",e.getComponent()))}}Ne(cE,"moduleName","tooltip");var az={integer:function(s,t,e){return t===""||t===null||typeof t>"u"?!0:(t=Number(t),!isNaN(t)&&isFinite(t)&&Math.floor(t)===t)},float:function(s,t,e){return t===""||t===null||typeof t>"u"?!0:(t=Number(t),!isNaN(t)&&isFinite(t)&&t%1!==0)},numeric:function(s,t,e){return t===""||t===null||typeof t>"u"?!0:!isNaN(t)},string:function(s,t,e){return t===""||t===null||typeof t>"u"?!0:isNaN(t)},alphanumeric:function(s,t,e){if(t===""||t===null||typeof t>"u")return!0;var i=new RegExp(/^[a-z0-9]+$/i);return i.test(t)},max:function(s,t,e){return t===""||t===null||typeof t>"u"?!0:parseFloat(t)<=e},min:function(s,t,e){return t===""||t===null||typeof t>"u"?!0:parseFloat(t)>=e},starts:function(s,t,e){return t===""||t===null||typeof t>"u"?!0:String(t).toLowerCase().startsWith(String(e).toLowerCase())},ends:function(s,t,e){return t===""||t===null||typeof t>"u"?!0:String(t).toLowerCase().endsWith(String(e).toLowerCase())},minLength:function(s,t,e){return t===""||t===null||typeof t>"u"?!0:String(t).length>=e},maxLength:function(s,t,e){return t===""||t===null||typeof t>"u"?!0:String(t).length<=e},in:function(s,t,e){return t===""||t===null||typeof t>"u"?!0:(typeof e=="string"&&(e=e.split("|")),e.indexOf(t)>-1)},regex:function(s,t,e){if(t===""||t===null||typeof t>"u")return!0;var i=new RegExp(e);return i.test(t)},unique:function(s,t,e){if(t===""||t===null||typeof t>"u")return!0;var i=!0,r=s.getData(),n=s.getColumn()._getSelf();return this.table.rowManager.rows.forEach(function(a){var o=a.getData();o!==r&&t==n.getFieldValue(o)&&(i=!1)}),i},required:function(s,t,e){return t!==""&&t!==null&&typeof t<"u"}};const Ul=class Ul extends pt{constructor(t){super(t),this.invalidCells=[],this.registerTableOption("validationMode","blocking"),this.registerColumnOption("validator"),this.registerTableFunction("getInvalidCells",this.getInvalidCells.bind(this)),this.registerTableFunction("clearCellValidation",this.userClearCellValidation.bind(this)),this.registerTableFunction("validate",this.userValidate.bind(this)),this.registerComponentFunction("cell","isValid",this.cellIsValid.bind(this)),this.registerComponentFunction("cell","clearValidation",this.clearValidation.bind(this)),this.registerComponentFunction("cell","validate",this.cellValidate.bind(this)),this.registerComponentFunction("column","validate",this.columnValidate.bind(this)),this.registerComponentFunction("row","validate",this.rowValidate.bind(this))}initialize(){this.subscribe("cell-delete",this.clearValidation.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("edit-success",this.editValidate.bind(this)),this.subscribe("edit-editor-clear",this.editorClear.bind(this)),this.subscribe("edit-edited-clear",this.editedClear.bind(this))}editValidate(t,e,i){var r=this.table.options.validationMode!=="manual"?this.validate(t.column.modules.validate,t,e):!0;return r!==!0&&setTimeout(()=>{t.getElement().classList.add("tabulator-validation-fail"),this.dispatchExternal("validationFailed",t.getComponent(),e,r)}),r}editorClear(t,e){e&&t.column.modules.validate&&this.cellValidate(t),t.getElement().classList.remove("tabulator-validation-fail")}editedClear(t){t.modules.validate&&(t.modules.validate.invalid=!1)}cellIsValid(t){return t.modules.validate&&t.modules.validate.invalid||!0}cellValidate(t){return this.validate(t.column.modules.validate,t,t.getValue())}columnValidate(t){var e=[];return t.cells.forEach(i=>{this.cellValidate(i)!==!0&&e.push(i.getComponent())}),e.length?e:!0}rowValidate(t){var e=[];return t.cells.forEach(i=>{this.cellValidate(i)!==!0&&e.push(i.getComponent())}),e.length?e:!0}userClearCellValidation(t){t||(t=this.getInvalidCells()),Array.isArray(t)||(t=[t]),t.forEach(e=>{this.clearValidation(e._getSelf())})}userValidate(t){var e=[];return this.table.rowManager.rows.forEach(i=>{i=i.getComponent();var r=i.validate();r!==!0&&(e=e.concat(r))}),e.length?e:!0}initializeColumnCheck(t){typeof t.definition.validator<"u"&&this.initializeColumn(t)}initializeColumn(t){var e=this,i=[],r;t.definition.validator&&(Array.isArray(t.definition.validator)?t.definition.validator.forEach(n=>{r=e._extractValidator(n),r&&i.push(r)}):(r=this._extractValidator(t.definition.validator),r&&i.push(r)),t.modules.validate=i.length?i:!1)}_extractValidator(t){var e,i,r;switch(typeof t){case"string":return r=t.indexOf(":"),r>-1?(e=t.substring(0,r),i=t.substring(r+1)):e=t,this._buildValidator(e,i);case"function":return this._buildValidator(t);case"object":return this._buildValidator(t.type,t.parameters)}}_buildValidator(t,e){var i=typeof t=="function"?t:Ul.validators[t];return i?{type:typeof t=="function"?"function":t,func:i,params:e}:(console.warn("Validator Setup Error - No matching validator found:",t),!1)}validate(t,e,i){var r=this,n=[],a=this.invalidCells.indexOf(e);return t&&t.forEach(o=>{o.func.call(r,e.getComponent(),i,o.params)||n.push({type:o.type,parameters:o.params})}),e.modules.validate||(e.modules.validate={}),n.length?(e.modules.validate.invalid=n,this.table.options.validationMode!=="manual"&&e.getElement().classList.add("tabulator-validation-fail"),a==-1&&this.invalidCells.push(e)):(e.modules.validate.invalid=!1,e.getElement().classList.remove("tabulator-validation-fail"),a>-1&&this.invalidCells.splice(a,1)),n.length?n:!0}getInvalidCells(){var t=[];return this.invalidCells.forEach(e=>{t.push(e.getComponent())}),t}clearValidation(t){var e;t.modules.validate&&t.modules.validate.invalid&&(t.getElement().classList.remove("tabulator-validation-fail"),t.modules.validate.invalid=!1,e=this.invalidCells.indexOf(t),e>-1&&this.invalidCells.splice(e,1))}};Ne(Ul,"moduleName","validate"),Ne(Ul,"validators",az);let Np=Ul;var Id=Object.freeze({__proto__:null,AccessorModule:pp,AjaxModule:gp,ClipboardModule:bp,ColumnCalcsModule:yp,DataTreeModule:Kw,DownloadModule:xp,EditModule:Cp,ExportModule:wp,FilterModule:Ep,FormatModule:Sp,FrozenColumnsModule:Yw,FrozenRowsModule:Jw,GroupRowsModule:Qw,HistoryModule:kp,HtmlTableImportModule:Zw,ImportModule:Tp,InteractionModule:eE,KeybindingsModule:Ap,MenuModule:tE,MoveColumnsModule:iE,MoveRowsModule:Op,MutatorModule:Dp,PageModule:Lp,PersistenceModule:Rp,PopupModule:rE,PrintModule:sE,ReactiveDataModule:nE,ResizeColumnsModule:aE,ResizeRowsModule:oE,ResizeTableModule:lE,ResponsiveLayoutModule:Ip,SelectRangeModule:Gu,SelectRowModule:_p,SortModule:Fp,SpreadsheetModule:uE,TooltipModule:cE,ValidateModule:Np}),oz={debugEventsExternal:!1,debugEventsInternal:!1,debugInvalidOptions:!0,debugInvalidComponentFuncs:!0,debugInitialization:!0,debugDeprecation:!0,height:!1,minHeight:!1,maxHeight:!1,columnHeaderVertAlign:"top",popupContainer:!1,columns:[],columnDefaults:{},rowHeader:!1,data:!1,autoColumns:!1,autoColumnsDefinitions:!1,nestedFieldSeparator:".",footerElement:!1,index:"id",textDirection:"auto",addRowPos:"bottom",headerVisible:!0,renderVertical:"virtual",renderHorizontal:"basic",renderVerticalBuffer:0,scrollToRowPosition:"top",scrollToRowIfVisible:!0,scrollToColumnPosition:"left",scrollToColumnIfVisible:!0,rowFormatter:!1,rowFormatterPrint:null,rowFormatterClipboard:null,rowFormatterHtmlOutput:null,rowHeight:null,placeholder:!1,dataLoader:!0,dataLoaderLoading:!1,dataLoaderError:!1,dataLoaderErrorTimeout:3e3,dataSendParams:{},dataReceiveParams:{},dependencies:{}};class fE{constructor(t,e,i={}){this.table=t,this.msgType=e,this.registeredDefaults=Object.assign({},i)}register(t,e){this.registeredDefaults[t]=e}generate(t,e={}){var i=Object.assign({},this.registeredDefaults),r=this.table.options.debugInvalidOptions||e.debugInvalidOptions===!0;Object.assign(i,t);for(let n in e)i.hasOwnProperty(n)||(r&&console.warn("Invalid "+this.msgType+" option:",n),i[n]=e.key);for(let n in i)n in e?i[n]=e[n]:Array.isArray(i[n])?i[n]=Object.assign([],i[n]):typeof i[n]=="object"&&i[n]!==null?i[n]=Object.assign({},i[n]):typeof i[n]>"u"&&delete i[n];return i}}class tf extends Gi{constructor(t){super(t),this.elementVertical=t.rowManager.element,this.elementHorizontal=t.columnManager.element,this.tableElement=t.rowManager.tableElement,this.verticalFillMode="fit"}initialize(){}clearRows(){}clearColumns(){}reinitializeColumnWidths(t){}renderRows(){}renderColumns(){}rerenderRows(t){t&&t()}rerenderColumns(t,e){}renderRowCells(t){}rerenderRowCells(t,e){}scrollColumns(t,e){}scrollRows(t,e){}resize(){}scrollToRow(t){}scrollToRowNearestTop(t){}visibleRows(t){return[]}rows(){return this.table.rowManager.getDisplayRows()}styleRow(t,e){var i=t.getElement();e%2?(i.classList.add("tabulator-row-even"),i.classList.remove("tabulator-row-odd")):(i.classList.add("tabulator-row-odd"),i.classList.remove("tabulator-row-even"))}clear(){this.clearRows(),this.clearColumns()}render(){this.renderRows(),this.renderColumns()}rerender(t){this.rerenderRows(),this.rerenderColumns()}scrollToRowPosition(t,e,i){var r=this.rows().indexOf(t),n=t.getElement(),a=0;return new Promise((o,l)=>{if(r>-1){if(typeof i>"u"&&(i=this.table.options.scrollToRowIfVisible),!i&&$t.elVisible(n)&&(a=$t.elOffset(n).top-$t.elOffset(this.elementVertical).top,a>0&&a<this.elementVertical.clientHeight-n.offsetHeight))return o(),!1;switch(typeof e>"u"&&(e=this.table.options.scrollToRowPosition),e==="nearest"&&(e=this.scrollToRowNearestTop(t)?"top":"bottom"),this.scrollToRow(t),e){case"middle":case"center":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop+(n.offsetTop-this.elementVertical.scrollTop)-(this.elementVertical.scrollHeight-n.offsetTop)/2:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight/2;break;case"bottom":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop-(this.elementVertical.scrollHeight-n.offsetTop)+n.offsetHeight:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight+n.offsetHeight;break;case"top":this.elementVertical.scrollTop=n.offsetTop;break}o()}else console.warn("Scroll Error - Row not visible"),l("Scroll Error - Row not visible")})}}class lz extends tf{constructor(t){super(t)}renderRowCells(t,e){const i=document.createDocumentFragment();t.cells.forEach(r=>{i.appendChild(r.getElement())}),t.element.appendChild(i),e||t.cells.forEach(r=>{r.cellRendered()})}reinitializeColumnWidths(t){t.forEach(function(e){e.reinitializeWidth()})}}class hz extends tf{constructor(t){super(t),this.leftCol=0,this.rightCol=0,this.scrollLeft=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0,this.fitDataColAvg=0,this.windowBuffer=200,this.visibleRows=null,this.initialized=!1,this.isFitData=!1,this.columns=[]}initialize(){this.compatibilityCheck(),this.layoutCheck(),this.vertScrollListen()}compatibilityCheck(){this.options("layout")=="fitDataTable"&&console.warn("Horizontal Virtual DOM is not compatible with fitDataTable layout mode"),this.options("responsiveLayout")&&console.warn("Horizontal Virtual DOM is not compatible with responsive columns"),this.options("rtl")&&console.warn("Horizontal Virtual DOM is not currently compatible with RTL text direction")}layoutCheck(){this.isFitData=this.options("layout").startsWith("fitData")}vertScrollListen(){this.subscribe("scroll-vertical",this.clearVisRowCache.bind(this)),this.subscribe("data-refreshed",this.clearVisRowCache.bind(this))}clearVisRowCache(){this.visibleRows=null}renderColumns(t,e){this.dataChange()}scrollColumns(t,e){this.scrollLeft!=t&&(this.scrollLeft=t,this.scroll(t-(this.vDomScrollPosLeft+this.windowBuffer)))}calcWindowBuffer(){var t=this.elementVertical.clientWidth;this.table.columnManager.columnsByIndex.forEach(e=>{if(e.visible){var i=e.getWidth();i>t&&(t=i)}}),this.windowBuffer=t*2}rerenderColumns(t,e){var i={cols:this.columns,leftCol:this.leftCol,rightCol:this.rightCol},r=0;t&&!this.initialized||(this.clear(),this.calcWindowBuffer(),this.scrollLeft=this.elementVertical.scrollLeft,this.vDomScrollPosLeft=this.scrollLeft-this.windowBuffer,this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,this.table.columnManager.columnsByIndex.forEach(n=>{var a={},o;n.visible&&(n.modules.frozen||(o=n.getWidth(),a.leftPos=r,a.rightPos=r+o,a.width=o,this.isFitData&&(a.fitDataCheck=n.modules.vdomHoz?n.modules.vdomHoz.fitDataCheck:!0),r+o>this.vDomScrollPosLeft&&r<this.vDomScrollPosRight?(this.leftCol==-1&&(this.leftCol=this.columns.length,this.vDomPadLeft=r),this.rightCol=this.columns.length):this.leftCol!==-1&&(this.vDomPadRight+=o),this.columns.push(n),n.modules.vdomHoz=a,r+=o))}),this.tableElement.style.paddingLeft=this.vDomPadLeft+"px",this.tableElement.style.paddingRight=this.vDomPadRight+"px",this.initialized=!0,e||(!t||this.reinitChanged(i))&&this.reinitializeRows(),this.elementVertical.scrollLeft=this.scrollLeft)}renderRowCells(t){if(this.initialized)this.initializeRow(t);else{const e=document.createDocumentFragment();t.cells.forEach(i=>{e.appendChild(i.getElement())}),t.element.appendChild(e),t.cells.forEach(i=>{i.cellRendered()})}}rerenderRowCells(t,e){this.reinitializeRow(t,e)}reinitializeColumnWidths(t){for(let e=this.leftCol;e<=this.rightCol;e++)this.columns[e].reinitializeWidth()}deinitialize(){this.initialized=!1}clear(){this.columns=[],this.leftCol=-1,this.rightCol=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0}dataChange(){var t=!1,e,i;if(this.isFitData){if(this.table.columnManager.columnsByIndex.forEach(r=>{!r.definition.width&&r.visible&&(t=!0)}),t&&this.table.rowManager.getDisplayRows().length&&(this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,e=this.chain("rows-sample",[1],[],()=>this.table.rowManager.getDisplayRows())[0],e)){i=e.getElement(),e.generateCells(),this.tableElement.appendChild(i);for(let r=0;r<e.cells.length;r++){let n=e.cells[r];i.appendChild(n.getElement()),n.column.reinitializeWidth()}i.parentNode.removeChild(i),this.rerenderColumns(!1,!0)}}else this.options("layout")==="fitColumns"&&(this.layoutRefresh(),this.rerenderColumns(!1,!0))}reinitChanged(t){var e=!0;return t.cols.length!==this.columns.length||t.leftCol!==this.leftCol||t.rightCol!==this.rightCol?!0:(t.cols.forEach((i,r)=>{i!==this.columns[r]&&(e=!1)}),!e)}reinitializeRows(){var t=this.getVisibleRows(),e=this.table.rowManager.getRows().filter(i=>!t.includes(i));t.forEach(i=>{this.reinitializeRow(i,!0)}),e.forEach(i=>{i.deinitialize()})}getVisibleRows(){return this.visibleRows||(this.visibleRows=this.table.rowManager.getVisibleRows()),this.visibleRows}scroll(t){this.vDomScrollPosLeft+=t,this.vDomScrollPosRight+=t,Math.abs(t)>this.windowBuffer/2?this.rerenderColumns():t>0?(this.addColRight(),this.removeColLeft()):(this.addColLeft(),this.removeColRight())}colPositionAdjust(t,e,i){for(let r=t;r<e;r++){let n=this.columns[r];n.modules.vdomHoz.leftPos+=i,n.modules.vdomHoz.rightPos+=i}}addColRight(){for(var t=!1,e=!0;e;){let i=this.columns[this.rightCol+1];i&&i.modules.vdomHoz.leftPos<=this.vDomScrollPosRight?(t=!0,this.getVisibleRows().forEach(r=>{if(r.type!=="group"){var n=r.getCell(i);r.getElement().insertBefore(n.getElement(),r.getCell(this.columns[this.rightCol]).getElement().nextSibling),n.cellRendered()}}),this.fitDataColActualWidthCheck(i),this.rightCol++,this.getVisibleRows().forEach(r=>{r.type!=="group"&&(r.modules.vdomHoz.rightCol=this.rightCol)}),this.rightCol>=this.columns.length-1?this.vDomPadRight=0:this.vDomPadRight-=i.getWidth()):e=!1}t&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}addColLeft(){for(var t=!1,e=!0;e;){let i=this.columns[this.leftCol-1];if(i)if(i.modules.vdomHoz.rightPos>=this.vDomScrollPosLeft){t=!0,this.getVisibleRows().forEach(n=>{if(n.type!=="group"){var a=n.getCell(i);n.getElement().insertBefore(a.getElement(),n.getCell(this.columns[this.leftCol]).getElement()),a.cellRendered()}}),this.leftCol--,this.getVisibleRows().forEach(n=>{n.type!=="group"&&(n.modules.vdomHoz.leftCol=this.leftCol)}),this.leftCol<=0?this.vDomPadLeft=0:this.vDomPadLeft-=i.getWidth();let r=this.fitDataColActualWidthCheck(i);r&&(this.scrollLeft=this.elementVertical.scrollLeft=this.elementVertical.scrollLeft+r,this.vDomPadRight-=r)}else e=!1;else e=!1}t&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}removeColRight(){for(var t=!1,e=!0;e;){let i=this.columns[this.rightCol];i&&i.modules.vdomHoz.leftPos>this.vDomScrollPosRight?(t=!0,this.getVisibleRows().forEach(r=>{if(r.type!=="group"){var n=r.getCell(i);try{r.getElement().removeChild(n.getElement())}catch(a){console.warn("Could not removeColRight",a.message)}}}),this.vDomPadRight+=i.getWidth(),this.rightCol--,this.getVisibleRows().forEach(r=>{r.type!=="group"&&(r.modules.vdomHoz.rightCol=this.rightCol)})):e=!1}t&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}removeColLeft(){for(var t=!1,e=!0;e;){let i=this.columns[this.leftCol];i&&i.modules.vdomHoz.rightPos<this.vDomScrollPosLeft?(t=!0,this.getVisibleRows().forEach(r=>{if(r.type!=="group"){var n=r.getCell(i);try{r.getElement().removeChild(n.getElement())}catch(a){console.warn("Could not removeColLeft",a.message)}}}),this.vDomPadLeft+=i.getWidth(),this.leftCol++,this.getVisibleRows().forEach(r=>{r.type!=="group"&&(r.modules.vdomHoz.leftCol=this.leftCol)})):e=!1}t&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}fitDataColActualWidthCheck(t){var e,i;return t.modules.vdomHoz.fitDataCheck&&(t.reinitializeWidth(),e=t.getWidth(),i=e-t.modules.vdomHoz.width,i&&(t.modules.vdomHoz.rightPos+=i,t.modules.vdomHoz.width=e,this.colPositionAdjust(this.columns.indexOf(t)+1,this.columns.length,i)),t.modules.vdomHoz.fitDataCheck=!1),i}initializeRow(t){if(t.type!=="group"){t.modules.vdomHoz={leftCol:this.leftCol,rightCol:this.rightCol},this.table.modules.frozenColumns&&this.table.modules.frozenColumns.leftColumns.forEach(e=>{this.appendCell(t,e)});for(let e=this.leftCol;e<=this.rightCol;e++)this.appendCell(t,this.columns[e]);this.table.modules.frozenColumns&&this.table.modules.frozenColumns.rightColumns.forEach(e=>{this.appendCell(t,e)})}}appendCell(t,e){if(e&&e.visible){let i=t.getCell(e);t.getElement().appendChild(i.getElement()),i.cellRendered()}}reinitializeRow(t,e){if(t.type!=="group"&&(e||!t.modules.vdomHoz||t.modules.vdomHoz.leftCol!==this.leftCol||t.modules.vdomHoz.rightCol!==this.rightCol)){for(var i=t.getElement();i.firstChild;)i.removeChild(i.firstChild);this.initializeRow(t)}}}class uz extends Gi{constructor(t){super(t),this.blockHozScrollEvent=!1,this.headersElement=null,this.contentsElement=null,this.rowHeader=null,this.element=null,this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.scrollLeft=0,this.optionsList=new fE(this.table,"column definition",Xw),this.redrawBlock=!1,this.redrawBlockUpdate=null,this.renderer=null}initialize(){this.initializeRenderer(),this.headersElement=this.createHeadersElement(),this.contentsElement=this.createHeaderContentsElement(),this.element=this.createHeaderElement(),this.contentsElement.insertBefore(this.headersElement,this.contentsElement.firstChild),this.element.insertBefore(this.contentsElement,this.element.firstChild),this.initializeScrollWheelWatcher(),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("scrollbar-vertical",this.padVerticalScrollbar.bind(this))}padVerticalScrollbar(t){this.table.rtl?this.headersElement.style.marginLeft=t+"px":this.headersElement.style.marginRight=t+"px"}initializeRenderer(){var t,e={virtual:hz,basic:lz};typeof this.table.options.renderHorizontal=="string"?t=e[this.table.options.renderHorizontal]:t=this.table.options.renderHorizontal,t?(this.renderer=new t(this.table,this.element,this.tableElement),this.renderer.initialize()):console.error("Unable to find matching renderer:",this.table.options.renderHorizontal)}createHeadersElement(){var t=document.createElement("div");return t.classList.add("tabulator-headers"),t.setAttribute("role","row"),t}createHeaderContentsElement(){var t=document.createElement("div");return t.classList.add("tabulator-header-contents"),t.setAttribute("role","rowgroup"),t}createHeaderElement(){var t=document.createElement("div");return t.classList.add("tabulator-header"),t.setAttribute("role","rowgroup"),this.table.options.headerVisible||t.classList.add("tabulator-header-hidden"),t}getElement(){return this.element}getContentsElement(){return this.contentsElement}getHeadersElement(){return this.headersElement}scrollHorizontal(t){this.contentsElement.scrollLeft=t,this.scrollLeft=t,this.renderer.scrollColumns(t)}initializeScrollWheelWatcher(){this.contentsElement.addEventListener("wheel",t=>{var e;t.deltaX&&(e=this.contentsElement.scrollLeft+t.deltaX,this.table.rowManager.scrollHorizontal(e),this.table.columnManager.scrollHorizontal(e))})}generateColumnsFromRowData(t){var e=[],i={},r=this.table.options.autoColumns==="full"?t:[t[0]],n=this.table.options.autoColumnsDefinitions;if(t&&t.length){if(r.forEach(a=>{Object.keys(a).forEach((o,l)=>{let h=a[o],u;i[o]?i[o]!==!0&&typeof h<"u"&&(i[o].sorter=this.calculateSorterFromValue(h),i[o]=!0):(u={field:o,title:o,sorter:this.calculateSorterFromValue(h)},e.splice(l,0,u),i[o]=typeof h>"u"?u:!0)})}),n)switch(typeof n){case"function":this.table.options.columns=n.call(this.table,e);break;case"object":Array.isArray(n)?e.forEach(a=>{var o=n.find(l=>l.field===a.field);o&&Object.assign(a,o)}):e.forEach(a=>{n[a.field]&&Object.assign(a,n[a.field])}),this.table.options.columns=e;break}else this.table.options.columns=e;this.setColumns(this.table.options.columns)}}calculateSorterFromValue(t){var e;switch(typeof t){case"undefined":e="string";break;case"boolean":e="boolean";break;case"number":e="number";break;case"object":Array.isArray(t)?e="array":e="string";break;default:!isNaN(t)&&t!==""?e="number":t.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)?e="alphanum":e="string";break}return e}setColumns(t,e){for(;this.headersElement.firstChild;)this.headersElement.removeChild(this.headersElement.firstChild);this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.dispatch("columns-loading"),this.dispatchExternal("columnsLoading"),this.table.options.rowHeader&&(this.rowHeader=new pa(this.table.options.rowHeader===!0?{}:this.table.options.rowHeader,this,!0),this.columns.push(this.rowHeader),this.headersElement.appendChild(this.rowHeader.getElement()),this.rowHeader.columnRendered()),t.forEach((i,r)=>{this._addColumn(i)}),this._reIndexColumns(),this.dispatch("columns-loaded"),this.subscribedExternal("columnsLoaded")&&this.dispatchExternal("columnsLoaded",this.getComponents()),this.rerenderColumns(!1,!0),this.redraw(!0)}_addColumn(t,e,i){var r=new pa(t,this),n=r.getElement(),a=i&&this.findColumnIndex(i);if(e&&this.rowHeader&&(!i||i===this.rowHeader)&&(e=!1,i=this.rowHeader,a=0),i&&a>-1){var o=i.getTopColumn(),l=this.columns.indexOf(o),h=o.getElement();e?(this.columns.splice(l,0,r),h.parentNode.insertBefore(n,h)):(this.columns.splice(l+1,0,r),h.parentNode.insertBefore(n,h.nextSibling))}else e?(this.columns.unshift(r),this.headersElement.insertBefore(r.getElement(),this.headersElement.firstChild)):(this.columns.push(r),this.headersElement.appendChild(r.getElement()));return r.columnRendered(),r}registerColumnField(t){t.definition.field&&(this.columnsByField[t.definition.field]=t)}registerColumnPosition(t){this.columnsByIndex.push(t)}_reIndexColumns(){this.columnsByIndex=[],this.columns.forEach(function(t){t.reRegisterPosition()})}verticalAlignHeaders(){var t=0;this.redrawBlock||(this.headersElement.style.height="",this.columns.forEach(e=>{e.clearVerticalAlign()}),this.columns.forEach(e=>{var i=e.getHeight();i>t&&(t=i)}),this.headersElement.style.height=t+"px",this.columns.forEach(e=>{e.verticalAlign(this.table.options.columnHeaderVertAlign,t)}),this.table.rowManager.adjustTableSize())}findColumn(t){var e;if(typeof t=="object"){if(t instanceof pa)return t;if(t instanceof Gw)return t._getSelf()||!1;if(typeof HTMLElement<"u"&&t instanceof HTMLElement)return e=[],this.columns.forEach(r=>{e.push(r),e=e.concat(r.getColumns(!0))}),e.find(r=>r.element===t)||!1}else return this.columnsByField[t]||!1;return!1}getColumnByField(t){return this.columnsByField[t]}getColumnsByFieldRoot(t){var e=[];return Object.keys(this.columnsByField).forEach(i=>{var r=this.table.options.nestedFieldSeparator?i.split(this.table.options.nestedFieldSeparator)[0]:i;r===t&&e.push(this.columnsByField[i])}),e}getColumnByIndex(t){return this.columnsByIndex[t]}getFirstVisibleColumn(){var t=this.columnsByIndex.findIndex(e=>e.visible);return t>-1?this.columnsByIndex[t]:!1}getVisibleColumnsByIndex(){return this.columnsByIndex.filter(t=>t.visible)}getColumns(){return this.columns}findColumnIndex(t){return this.columnsByIndex.findIndex(e=>t===e)}getRealColumns(){return this.columnsByIndex}traverse(t){this.columnsByIndex.forEach((e,i)=>{t(e,i)})}getDefinitions(t){var e=[];return this.columnsByIndex.forEach(i=>{(!t||t&&i.visible)&&e.push(i.getDefinition())}),e}getDefinitionTree(){var t=[];return this.columns.forEach(e=>{t.push(e.getDefinition(!0))}),t}getComponents(t){var e=[],i=t?this.columns:this.columnsByIndex;return i.forEach(r=>{e.push(r.getComponent())}),e}getWidth(){var t=0;return this.columnsByIndex.forEach(e=>{e.visible&&(t+=e.getWidth())}),t}moveColumn(t,e,i){e.element.parentNode.insertBefore(t.element,e.element),i&&e.element.parentNode.insertBefore(e.element,t.element),this.moveColumnActual(t,e,i),this.verticalAlignHeaders(),this.table.rowManager.reinitialize()}moveColumnActual(t,e,i){t.parent.isGroup?this._moveColumnInArray(t.parent.columns,t,e,i):this._moveColumnInArray(this.columns,t,e,i),this._moveColumnInArray(this.columnsByIndex,t,e,i,!0),this.rerenderColumns(!0),this.dispatch("column-moved",t,e,i),this.subscribedExternal("columnMoved")&&this.dispatchExternal("columnMoved",t.getComponent(),this.table.columnManager.getComponents())}_moveColumnInArray(t,e,i,r,n){var a=t.indexOf(e),o,l=[];a>-1&&(t.splice(a,1),o=t.indexOf(i),o>-1?r&&(o=o+1):o=a,t.splice(o,0,e),n&&(l=this.chain("column-moving-rows",[e,i,r],null,[])||[],l=l.concat(this.table.rowManager.rows),l.forEach(function(h){if(h.cells.length){var u=h.cells.splice(a,1)[0];h.cells.splice(o,0,u)}})))}scrollToColumn(t,e,i){var r=0,n=t.getLeftOffset(),a=0,o=t.getElement();return new Promise((l,h)=>{if(typeof e>"u"&&(e=this.table.options.scrollToColumnPosition),typeof i>"u"&&(i=this.table.options.scrollToColumnIfVisible),t.visible){switch(e){case"middle":case"center":a=-this.element.clientWidth/2;break;case"right":a=o.clientWidth-this.headersElement.clientWidth;break}if(!i&&n>0&&n+o.offsetWidth<this.element.clientWidth)return!1;r=n+a,r=Math.max(Math.min(r,this.table.rowManager.element.scrollWidth-this.table.rowManager.element.clientWidth),0),this.table.rowManager.scrollHorizontal(r),this.scrollHorizontal(r),l()}else console.warn("Scroll Error - Column not visible"),h("Scroll Error - Column not visible")})}generateCells(t){var e=[];return this.columnsByIndex.forEach(i=>{e.push(i.generateCell(t))}),e}getFlexBaseWidth(){var t=this.table.element.clientWidth,e=0;return this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(t-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),this.columnsByIndex.forEach(function(i){var r,n,a;i.visible&&(r=i.definition.width||0,n=parseInt(i.minWidth),typeof r=="string"?r.indexOf("%")>-1?a=t/100*parseInt(r):a=parseInt(r):a=r,e+=a>n?a:n)}),e}addColumn(t,e,i){return new Promise((r,n)=>{var a=this._addColumn(t,e,i);this._reIndexColumns(),this.dispatch("column-add",t,e,i),this.layoutMode()!="fitColumns"&&a.reinitializeWidth(),this.redraw(!0),this.table.rowManager.reinitialize(),this.rerenderColumns(),r(a)})}deregisterColumn(t){var e=t.getField(),i;e&&delete this.columnsByField[e],i=this.columnsByIndex.indexOf(t),i>-1&&this.columnsByIndex.splice(i,1),i=this.columns.indexOf(t),i>-1&&this.columns.splice(i,1),this.verticalAlignHeaders(),this.redraw()}rerenderColumns(t,e){this.redrawBlock?(t===!1||t===!0&&this.redrawBlockUpdate===null)&&(this.redrawBlockUpdate=t):this.renderer.rerenderColumns(t,e)}blockRedraw(){this.redrawBlock=!0,this.redrawBlockUpdate=null}restoreRedraw(){this.redrawBlock=!1,this.verticalAlignHeaders(),this.renderer.rerenderColumns(this.redrawBlockUpdate)}redraw(t){$t.elVisible(this.element)&&this.verticalAlignHeaders(),t&&(this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),this.confirm("table-redrawing",t)||this.layoutRefresh(t),this.dispatch("table-redraw",t),this.table.footerManager.redraw()}}class cz extends tf{constructor(t){super(t),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0}clearRows(){for(var t=this.tableElement;t.firstChild;)t.removeChild(t.firstChild);t.scrollTop=0,t.scrollLeft=0,t.style.minWidth="",t.style.minHeight="",t.style.display="",t.style.visibility=""}renderRows(){var t=this.tableElement,e=!0,i=document.createDocumentFragment(),r=this.rows();r.forEach((n,a)=>{this.styleRow(n,a),n.initialize(!1,!0),n.type!=="group"&&(e=!1),i.appendChild(n.getElement())}),t.appendChild(i),r.forEach(n=>{n.rendered(),n.heightInitialized||n.calcHeight(!0)}),r.forEach(n=>{n.heightInitialized||n.setCellHeight()}),e?t.style.minWidth=this.table.columnManager.getWidth()+"px":t.style.minWidth=""}rerenderRows(t){this.clearRows(),t&&t(),this.renderRows(),this.rows().length||this.table.rowManager.tableEmpty()}scrollToRowNearestTop(t){var e=$t.elOffset(t.getElement()).top;return!(Math.abs(this.elementVertical.scrollTop-e)>Math.abs(this.elementVertical.scrollTop+this.elementVertical.clientHeight-e))}scrollToRow(t){var e=t.getElement();this.elementVertical.scrollTop=$t.elOffset(e).top-$t.elOffset(this.elementVertical).top+this.elementVertical.scrollTop}visibleRows(t){return this.rows()}}class fz extends tf{constructor(t){super(t),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.vDomRowHeight=20,this.vDomTop=0,this.vDomBottom=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomMaxRenderChain=90,this.vDomWindowBuffer=0,this.vDomWindowMinTotalRows=20,this.vDomWindowMinMarginRows=5,this.vDomTopNewRows=[],this.vDomBottomNewRows=[]}clearRows(){for(var t=this.tableElement;t.firstChild;)t.removeChild(t.firstChild);t.style.paddingTop="",t.style.paddingBottom="",t.style.minHeight="",t.style.display="",t.style.visibility="",this.elementVertical.scrollTop=0,this.elementVertical.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0,this.vDomTop=0,this.vDomBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0}renderRows(){this._virtualRenderFill()}rerenderRows(t){for(var e=this.elementVertical.scrollTop,i=!1,r=!1,n=this.table.rowManager.scrollLeft,a=this.rows(),o=this.vDomTop;o<=this.vDomBottom;o++)if(a[o]){var l=e-a[o].getElement().offsetTop;if(r===!1||Math.abs(l)<r)r=l,i=o;else break}a.forEach(h=>{h.deinitializeHeight()}),t&&t(),this.rows().length?this._virtualRenderFill(i===!1?this.rows.length-1:i,!0,r||0):(this.clear(),this.table.rowManager.tableEmpty()),this.scrollColumns(n)}scrollColumns(t){this.table.rowManager.scrollHorizontal(t)}scrollRows(t,e){var i=t-this.vDomScrollPosTop,r=t-this.vDomScrollPosBottom,n=this.vDomWindowBuffer*2,a=this.rows();if(this.scrollTop=t,-i>n||r>n){var o=this.table.rowManager.scrollLeft;this._virtualRenderFill(Math.floor(this.elementVertical.scrollTop/this.elementVertical.scrollHeight*a.length)),this.scrollColumns(o)}else e?(i<0&&this._addTopRow(a,-i),r<0&&(this.vDomScrollHeight-this.scrollTop>this.vDomWindowBuffer?this._removeBottomRow(a,-r):this.vDomScrollPosBottom=this.scrollTop)):(r>=0&&this._addBottomRow(a,r),i>=0&&(this.scrollTop>this.vDomWindowBuffer?this._removeTopRow(a,i):this.vDomScrollPosTop=this.scrollTop))}resize(){this.vDomWindowBuffer=this.table.options.renderVerticalBuffer||this.elementVertical.clientHeight}scrollToRowNearestTop(t){var e=this.rows().indexOf(t);return!(Math.abs(this.vDomTop-e)>Math.abs(this.vDomBottom-e))}scrollToRow(t){var e=this.rows().indexOf(t);e>-1&&this._virtualRenderFill(e,!0)}visibleRows(t){var e=this.elementVertical.scrollTop,i=this.elementVertical.clientHeight+e,r=!1,n=0,a=0,o=this.rows();if(t)n=this.vDomTop,a=this.vDomBottom;else for(var l=this.vDomTop;l<=this.vDomBottom;l++)if(o[l])if(r)if(i-o[l].getElement().offsetTop>=0)a=l;else break;else if(e-o[l].getElement().offsetTop>=0)n=l;else if(r=!0,i-o[l].getElement().offsetTop>=0)a=l;else break;return o.slice(n,a+1)}_virtualRenderFill(t,e,i){var r=this.tableElement,n=this.elementVertical,a=0,o=0,l=0,h=0,u=0,c=0,f=this.rows(),d=f.length,p=0,v,g,b=[],C=0,y=0,x=this.table.rowManager.fixedHeight,w=this.elementVertical.clientHeight,S=this.table.options.rowHeight,E=!0;if(t=t||0,i=i||0,!t)this.clear();else{for(;r.firstChild;)r.removeChild(r.firstChild);h=(d-t+1)*this.vDomRowHeight,h<w&&(t-=Math.ceil((w-h)/this.vDomRowHeight),t<0&&(t=0)),a=Math.min(Math.max(Math.floor(this.vDomWindowBuffer/this.vDomRowHeight),this.vDomWindowMinMarginRows),t),t-=a}if(d&&$t.elVisible(this.elementVertical)){for(this.vDomTop=t,this.vDomBottom=t-1,x||this.table.options.maxHeight?(S&&(y=w/S+this.vDomWindowBuffer/S),y=Math.max(this.vDomWindowMinTotalRows,Math.ceil(y))):y=d;(y==d||o<=w+this.vDomWindowBuffer||C<this.vDomWindowMinTotalRows)&&this.vDomBottom<d-1;){for(b=[],g=document.createDocumentFragment(),c=0;c<y&&this.vDomBottom<d-1;)p=this.vDomBottom+1,v=f[p],this.styleRow(v,p),v.initialize(!1,!0),!v.heightInitialized&&!this.table.options.rowHeight&&v.clearCellHeight(),g.appendChild(v.getElement()),b.push(v),this.vDomBottom++,c++;if(!b.length)break;r.appendChild(g),b.forEach(k=>{k.rendered(),k.heightInitialized||k.calcHeight(!0)}),b.forEach(k=>{k.heightInitialized||k.setCellHeight()}),b.forEach(k=>{l=k.getHeight(),C<a?u+=l:o+=l,l>this.vDomWindowBuffer&&(this.vDomWindowBuffer=l*2),C++}),E=this.table.rowManager.adjustTableSize(),w=this.elementVertical.clientHeight,E&&(x||this.table.options.maxHeight)&&(S=o/C,y=Math.max(this.vDomWindowMinTotalRows,Math.ceil(w/S+this.vDomWindowBuffer/S)))}t?(this.vDomTopPad=e?this.vDomRowHeight*this.vDomTop+i:this.scrollTop-u,this.vDomBottomPad=this.vDomBottom==d-1?0:Math.max(this.vDomScrollHeight-this.vDomTopPad-o-u,0)):(this.vDomTopPad=0,this.vDomRowHeight=Math.floor((o+u)/C),this.vDomBottomPad=this.vDomRowHeight*(d-this.vDomBottom-1),this.vDomScrollHeight=u+o+this.vDomBottomPad-w),r.style.paddingTop=this.vDomTopPad+"px",r.style.paddingBottom=this.vDomBottomPad+"px",e&&(this.scrollTop=this.vDomTopPad+u+i-(this.elementVertical.scrollWidth>this.elementVertical.clientWidth?this.elementVertical.offsetHeight-w:0)),this.scrollTop=Math.min(this.scrollTop,this.elementVertical.scrollHeight-w),this.elementVertical.scrollWidth>this.elementVertical.clientWidth&&e&&(this.scrollTop+=this.elementVertical.offsetHeight-w),this.vDomScrollPosTop=this.scrollTop,this.vDomScrollPosBottom=this.scrollTop,n.scrollTop=this.scrollTop,this.dispatch("render-virtual-fill")}}_addTopRow(t,e){for(var i=this.tableElement,r=[],n=0,a=this.vDomTop-1,o=0,l=!0;l;)if(this.vDomTop){let h=t[a],u,c;h&&o<this.vDomMaxRenderChain?(u=h.getHeight()||this.vDomRowHeight,c=h.initialized,e>=u?(this.styleRow(h,a),i.insertBefore(h.getElement(),i.firstChild),(!h.initialized||!h.heightInitialized)&&r.push(h),h.initialize(),c||(u=h.getElement().offsetHeight,u>this.vDomWindowBuffer&&(this.vDomWindowBuffer=u*2)),e-=u,n+=u,this.vDomTop--,a--,o++):l=!1):l=!1}else l=!1;for(let h of r)h.clearCellHeight();this._quickNormalizeRowHeight(r),n&&(this.vDomTopPad-=n,this.vDomTopPad<0&&(this.vDomTopPad=a*this.vDomRowHeight),a<1&&(this.vDomTopPad=0),i.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop-=n)}_removeTopRow(t,e){for(var i=[],r=0,n=0,a=!0;a;){let o=t[this.vDomTop],l;o&&n<this.vDomMaxRenderChain?(l=o.getHeight()||this.vDomRowHeight,e>=l?(this.vDomTop++,e-=l,r+=l,i.push(o),n++):a=!1):a=!1}for(let o of i){let l=o.getElement();l.parentNode&&l.parentNode.removeChild(l)}r&&(this.vDomTopPad+=r,this.tableElement.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop+=this.vDomTop?r:r+this.vDomWindowBuffer)}_addBottomRow(t,e){for(var i=this.tableElement,r=[],n=0,a=this.vDomBottom+1,o=0,l=!0;l;){let h=t[a],u,c;h&&o<this.vDomMaxRenderChain?(u=h.getHeight()||this.vDomRowHeight,c=h.initialized,e>=u?(this.styleRow(h,a),i.appendChild(h.getElement()),(!h.initialized||!h.heightInitialized)&&r.push(h),h.initialize(),c||(u=h.getElement().offsetHeight,u>this.vDomWindowBuffer&&(this.vDomWindowBuffer=u*2)),e-=u,n+=u,this.vDomBottom++,a++,o++):l=!1):l=!1}for(let h of r)h.clearCellHeight();this._quickNormalizeRowHeight(r),n&&(this.vDomBottomPad-=n,(this.vDomBottomPad<0||a==t.length-1)&&(this.vDomBottomPad=0),i.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom+=n)}_removeBottomRow(t,e){for(var i=[],r=0,n=0,a=!0;a;){let o=t[this.vDomBottom],l;o&&n<this.vDomMaxRenderChain?(l=o.getHeight()||this.vDomRowHeight,e>=l?(this.vDomBottom--,e-=l,r+=l,i.push(o),n++):a=!1):a=!1}for(let o of i){let l=o.getElement();l.parentNode&&l.parentNode.removeChild(l)}r&&(this.vDomBottomPad+=r,this.vDomBottomPad<0&&(this.vDomBottomPad=0),this.tableElement.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom-=r)}_quickNormalizeRowHeight(t){for(let e of t)e.calcHeight();for(let e of t)e.setCellHeight()}}class dz extends Gi{constructor(t){super(t),this.element=this.createHolderElement(),this.tableElement=this.createTableElement(),this.heightFixer=this.createTableElement(),this.placeholder=null,this.placeholderContents=null,this.firstRender=!1,this.renderMode="virtual",this.fixedHeight=!1,this.rows=[],this.activeRowsPipeline=[],this.activeRows=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.scrollTop=0,this.scrollLeft=0,this.redrawBlock=!1,this.redrawBlockRestoreConfig=!1,this.redrawBlockRenderInPosition=!1,this.dataPipeline=[],this.displayPipeline=[],this.scrollbarWidth=0,this.renderer=null}createHolderElement(){var t=document.createElement("div");return t.classList.add("tabulator-tableholder"),t.setAttribute("tabindex",0),t}createTableElement(){var t=document.createElement("div");return t.classList.add("tabulator-table"),t.setAttribute("role","rowgroup"),t}initializePlaceholder(){var t=this.table.options.placeholder;if(typeof t=="function"&&(t=t.call(this.table)),t=this.chain("placeholder",[t],t,t)||t,t){let e=document.createElement("div");if(e.classList.add("tabulator-placeholder"),typeof t=="string"){let i=document.createElement("div");i.classList.add("tabulator-placeholder-contents"),i.innerHTML=t,e.appendChild(i),this.placeholderContents=i}else typeof HTMLElement<"u"&&t instanceof HTMLElement?(e.appendChild(t),this.placeholderContents=t):(console.warn("Invalid placeholder provided, must be string or HTML Element",t),this.el=null);this.placeholder=e}}getElement(){return this.element}getTableElement(){return this.tableElement}initialize(){this.initializePlaceholder(),this.initializeRenderer(),this.element.appendChild(this.tableElement),this.firstRender=!0,this.element.addEventListener("scroll",()=>{var t=this.element.scrollLeft,e=this.scrollLeft>t,i=this.element.scrollTop,r=this.scrollTop>i;this.scrollLeft!=t&&(this.scrollLeft=t,this.dispatch("scroll-horizontal",t,e),this.dispatchExternal("scrollHorizontal",t,e),this._positionPlaceholder()),this.scrollTop!=i&&(this.scrollTop=i,this.renderer.scrollRows(i,r),this.dispatch("scroll-vertical",i,r),this.dispatchExternal("scrollVertical",i,r))})}findRow(t){if(typeof t=="object"){if(t instanceof pr)return t;if(t instanceof Zc)return t._getSelf()||!1;if(typeof HTMLElement<"u"&&t instanceof HTMLElement)return this.rows.find(i=>i.getElement()===t)||!1;if(t===null)return!1}else return typeof t>"u"?!1:this.rows.find(i=>i.data[this.table.options.index]==t)||!1;return!1}getRowFromDataObject(t){var e=this.rows.find(i=>i.data===t);return e||!1}getRowFromPosition(t){return this.getDisplayRows().find(e=>e.type==="row"&&e.getPosition()===t&&e.isDisplayed())}scrollToRow(t,e,i){return this.renderer.scrollToRowPosition(t,e,i)}setData(t,e,i){return new Promise((r,n)=>{e&&this.getDisplayRows().length?this.table.options.pagination?this._setDataActual(t,!0):this.reRenderInPosition(()=>{this._setDataActual(t)}):(this.table.options.autoColumns&&i&&this.table.initialized&&this.table.columnManager.generateColumnsFromRowData(t),this.resetScroll(),this._setDataActual(t)),r()})}_setDataActual(t,e){this.dispatchExternal("dataProcessing",t),this._wipeElements(),Array.isArray(t)?(this.dispatch("data-processing",t),t.forEach((i,r)=>{if(i&&typeof i=="object"){var n=new pr(i,this);this.rows.push(n)}else console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:",i)}),this.refreshActiveData(!1,!1,e),this.dispatch("data-processed",t),this.dispatchExternal("dataProcessed",t)):console.error("Data Loading Error - Unable to process data due to invalid data type \nExpecting: array \nReceived: ",typeof t,"\nData:     ",t)}_wipeElements(){this.dispatch("rows-wipe"),this.destroy(),this.adjustTableSize(),this.dispatch("rows-wiped")}destroy(){this.rows.forEach(t=>{t.wipe()}),this.rows=[],this.activeRows=[],this.activeRowsPipeline=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0}deleteRow(t,e){var i=this.rows.indexOf(t),r=this.activeRows.indexOf(t);r>-1&&this.activeRows.splice(r,1),i>-1&&this.rows.splice(i,1),this.setActiveRows(this.activeRows),this.displayRowIterator(n=>{var a=n.indexOf(t);a>-1&&n.splice(a,1)}),e||this.reRenderInPosition(),this.regenerateRowPositions(),this.dispatchExternal("rowDeleted",t.getComponent()),this.displayRowsCount||this.tableEmpty(),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.getData())}addRow(t,e,i,r){var n=this.addRowActual(t,e,i,r);return n}addRows(t,e,i,r){var n=[];return new Promise((a,o)=>{e=this.findAddRowPos(e),Array.isArray(t)||(t=[t]),(typeof i>"u"&&e||typeof i<"u"&&!e)&&t.reverse(),t.forEach((l,h)=>{var u=this.addRow(l,e,i,!0);n.push(u),this.dispatch("row-added",u,l,e,i)}),this.refreshActiveData(r?"displayPipeline":!1,!1,!0),this.regenerateRowPositions(),this.displayRowsCount&&this._clearPlaceholder(),a(n)})}findAddRowPos(t){return typeof t>"u"&&(t=this.table.options.addRowPos),t==="pos"&&(t=!0),t==="bottom"&&(t=!1),t}addRowActual(t,e,i,r){var n=t instanceof pr?t:new pr(t||{},this),a=this.findAddRowPos(e),o=-1,l,h;return i||(h=this.chain("row-adding-position",[n,a],null,{index:i,top:a}),i=h.index,a=h.top),typeof i<"u"&&(i=this.findRow(i)),i=this.chain("row-adding-index",[n,i,a],null,i),i&&(o=this.rows.indexOf(i)),i&&o>-1?(l=this.activeRows.indexOf(i),this.displayRowIterator(function(u){var c=u.indexOf(i);c>-1&&u.splice(a?c:c+1,0,n)}),l>-1&&this.activeRows.splice(a?l:l+1,0,n),this.rows.splice(a?o:o+1,0,n)):a?(this.displayRowIterator(function(u){u.unshift(n)}),this.activeRows.unshift(n),this.rows.unshift(n)):(this.displayRowIterator(function(u){u.push(n)}),this.activeRows.push(n),this.rows.push(n)),this.setActiveRows(this.activeRows),this.dispatchExternal("rowAdded",n.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),r||this.reRenderInPosition(),n}moveRow(t,e,i){this.dispatch("row-move",t,e,i),this.moveRowActual(t,e,i),this.regenerateRowPositions(),this.dispatch("row-moved",t,e,i),this.dispatchExternal("rowMoved",t.getComponent())}moveRowActual(t,e,i){this.moveRowInArray(this.rows,t,e,i),this.moveRowInArray(this.activeRows,t,e,i),this.displayRowIterator(r=>{this.moveRowInArray(r,t,e,i)}),this.dispatch("row-moving",t,e,i)}moveRowInArray(t,e,i,r){var n,a,o,l;if(e!==i&&(n=t.indexOf(e),n>-1&&(t.splice(n,1),a=t.indexOf(i),a>-1?r?t.splice(a+1,0,e):t.splice(a,0,e):t.splice(n,0,e)),t===this.getDisplayRows())){o=n<a?n:a,l=a>n?a:n+1;for(let h=o;h<=l;h++)t[h]&&this.styleRow(t[h],h)}}clearData(){this.setData([])}getRowIndex(t){return this.findRowIndex(t,this.rows)}getDisplayRowIndex(t){var e=this.getDisplayRows().indexOf(t);return e>-1?e:!1}nextDisplayRow(t,e){var i=this.getDisplayRowIndex(t),r=!1;return i!==!1&&i<this.displayRowsCount-1&&(r=this.getDisplayRows()[i+1]),r&&(!(r instanceof pr)||r.type!="row")?this.nextDisplayRow(r,e):r}prevDisplayRow(t,e){var i=this.getDisplayRowIndex(t),r=!1;return i&&(r=this.getDisplayRows()[i-1]),e&&r&&(!(r instanceof pr)||r.type!="row")?this.prevDisplayRow(r,e):r}findRowIndex(t,e){var i;return t=this.findRow(t),t&&(i=e.indexOf(t),i>-1)?i:!1}getData(t,e){var i=[],r=this.getRows(t);return r.forEach(function(n){n.type=="row"&&i.push(n.getData(e||"data"))}),i}getComponents(t){var e=[],i=this.getRows(t);return i.forEach(function(r){e.push(r.getComponent())}),e}getDataCount(t){var e=this.getRows(t);return e.length}scrollHorizontal(t){this.scrollLeft=t,this.element.scrollLeft=t,this.dispatch("scroll-horizontal",t)}registerDataPipelineHandler(t,e){typeof e<"u"?(this.dataPipeline.push({handler:t,priority:e}),this.dataPipeline.sort((i,r)=>i.priority-r.priority)):console.error("Data pipeline handlers must have a priority in order to be registered")}registerDisplayPipelineHandler(t,e){typeof e<"u"?(this.displayPipeline.push({handler:t,priority:e}),this.displayPipeline.sort((i,r)=>i.priority-r.priority)):console.error("Display pipeline handlers must have a priority in order to be registered")}refreshActiveData(t,e,i){var r=this.table,n="",a=0,o=["all","dataPipeline","display","displayPipeline","end"];if(!this.table.destroyed){if(typeof t=="function")if(a=this.dataPipeline.findIndex(l=>l.handler===t),a>-1)n="dataPipeline",e&&(a==this.dataPipeline.length-1?n="display":a++);else if(a=this.displayPipeline.findIndex(l=>l.handler===t),a>-1)n="displayPipeline",e&&(a==this.displayPipeline.length-1?n="end":a++);else{console.error("Unable to refresh data, invalid handler provided",t);return}else n=t||"all",a=0;if(this.redrawBlock){(!this.redrawBlockRestoreConfig||this.redrawBlockRestoreConfig&&(this.redrawBlockRestoreConfig.stage===n&&a<this.redrawBlockRestoreConfig.index||o.indexOf(n)<o.indexOf(this.redrawBlockRestoreConfig.stage)))&&(this.redrawBlockRestoreConfig={handler:t,skipStage:e,renderInPosition:i,stage:n,index:a});return}else $t.elVisible(this.element)?i?this.reRenderInPosition(this.refreshPipelines.bind(this,t,n,a,i)):(this.refreshPipelines(t,n,a,i),t||this.table.columnManager.renderer.renderColumns(),this.renderTable(),r.options.layoutColumnsOnNewData&&this.table.columnManager.redraw(!0)):this.refreshPipelines(t,n,a,i),this.dispatch("data-refreshed")}}refreshPipelines(t,e,i,r){switch(this.dispatch("data-refreshing"),(!t||!this.activeRowsPipeline[0])&&(this.activeRowsPipeline[0]=this.rows.slice(0)),e){case"all":case"dataPipeline":for(let n=i;n<this.dataPipeline.length;n++){let a=this.dataPipeline[n].handler(this.activeRowsPipeline[n].slice(0));this.activeRowsPipeline[n+1]=a||this.activeRowsPipeline[n].slice(0)}this.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]);case"display":i=0,this.resetDisplayRows();case"displayPipeline":for(let n=i;n<this.displayPipeline.length;n++){let a=this.displayPipeline[n].handler((n?this.getDisplayRows(n-1):this.activeRows).slice(0),r);this.setDisplayRows(a||this.getDisplayRows(n-1).slice(0),n)}case"end":this.regenerateRowPositions()}this.getDisplayRows().length&&this._clearPlaceholder()}regenerateRowPositions(){var t=this.getDisplayRows(),e=1;t.forEach(i=>{i.type==="row"&&(i.setPosition(e),e++)})}setActiveRows(t){this.activeRows=this.activeRows=Object.assign([],t),this.activeRowsCount=this.activeRows.length}resetDisplayRows(){this.displayRows=[],this.displayRows.push(this.activeRows.slice(0)),this.displayRowsCount=this.displayRows[0].length}setDisplayRows(t,e){this.displayRows[e]=t,e==this.displayRows.length-1&&(this.displayRowsCount=this.displayRows[this.displayRows.length-1].length)}getDisplayRows(t){return typeof t>"u"?this.displayRows.length?this.displayRows[this.displayRows.length-1]:[]:this.displayRows[t]||[]}getVisibleRows(t,e){var i=Object.assign([],this.renderer.visibleRows(!e));return t&&(i=this.chain("rows-visible",[e],i,i)),i}displayRowIterator(t){this.activeRowsPipeline.forEach(t),this.displayRows.forEach(t),this.displayRowsCount=this.displayRows[this.displayRows.length-1].length}getRows(t){var e=[];switch(t){case"active":e=this.activeRows;break;case"display":e=this.table.rowManager.getDisplayRows();break;case"visible":e=this.getVisibleRows(!1,!0);break;default:e=this.chain("rows-retrieve",t,null,this.rows)||this.rows}return e}reRenderInPosition(t){this.redrawBlock?t?t():this.redrawBlockRenderInPosition=!0:(this.dispatchExternal("renderStarted"),this.renderer.rerenderRows(t),this.fixedHeight||this.adjustTableSize(),this.scrollBarCheck(),this.dispatchExternal("renderComplete"))}scrollBarCheck(){var t=0;this.element.scrollHeight>this.element.clientHeight&&(t=this.element.offsetWidth-this.element.clientWidth),t!==this.scrollbarWidth&&(this.scrollbarWidth=t,this.dispatch("scrollbar-vertical",t))}initializeRenderer(){var t,e={virtual:fz,basic:cz};typeof this.table.options.renderVertical=="string"?t=e[this.table.options.renderVertical]:t=this.table.options.renderVertical,t?(this.renderMode=this.table.options.renderVertical,this.renderer=new t(this.table,this.element,this.tableElement),this.renderer.initialize(),(this.table.element.clientHeight||this.table.options.height)&&!(this.table.options.minHeight&&this.table.options.maxHeight)?this.fixedHeight=!0:this.fixedHeight=!1):console.error("Unable to find matching renderer:",this.table.options.renderVertical)}getRenderMode(){return this.renderMode}renderTable(){this.dispatchExternal("renderStarted"),this.element.scrollTop=0,this._clearTable(),this.displayRowsCount?(this.renderer.renderRows(),this.firstRender&&(this.firstRender=!1,this.fixedHeight||this.adjustTableSize(),this.layoutRefresh(!0))):this.renderEmptyScroll(),this.fixedHeight||this.adjustTableSize(),this.dispatch("table-layout"),this.displayRowsCount||this._showPlaceholder(),this.scrollBarCheck(),this.dispatchExternal("renderComplete")}renderEmptyScroll(){this.placeholder?this.tableElement.style.display="none":this.tableElement.style.minWidth=this.table.columnManager.getWidth()+"px"}_clearTable(){this._clearPlaceholder(),this.scrollTop=0,this.scrollLeft=0,this.renderer.clearRows()}tableEmpty(){this.renderEmptyScroll(),this._showPlaceholder()}checkPlaceholder(){this.displayRowsCount?this._clearPlaceholder():this.tableEmpty()}_showPlaceholder(){this.placeholder&&(this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.initializePlaceholder(),this.placeholder.setAttribute("tabulator-render-mode",this.renderMode),this.getElement().appendChild(this.placeholder),this._positionPlaceholder(),this.adjustTableSize())}_clearPlaceholder(){this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.tableElement.style.minWidth="",this.tableElement.style.display=""}_positionPlaceholder(){this.placeholder&&this.placeholder.parentNode&&(this.placeholder.style.width=this.table.columnManager.getWidth()+"px",this.placeholderContents.style.width=this.table.rowManager.element.clientWidth+"px",this.placeholderContents.style.marginLeft=this.scrollLeft+"px")}styleRow(t,e){var i=t.getElement();e%2?(i.classList.add("tabulator-row-even"),i.classList.remove("tabulator-row-odd")):(i.classList.add("tabulator-row-odd"),i.classList.remove("tabulator-row-even"))}normalizeHeight(t){this.activeRows.forEach(function(e){e.normalizeHeight(t)})}adjustTableSize(){let t=this.element.clientHeight,e,i=!1;if(this.renderer.verticalFillMode==="fill"){let r=Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height+(this.table.footerManager&&this.table.footerManager.active&&!this.table.footerManager.external?this.table.footerManager.getElement().getBoundingClientRect().height:0));if(this.fixedHeight){e=isNaN(this.table.options.minHeight)?this.table.options.minHeight:this.table.options.minHeight+"px";const n="calc(100% - "+r+"px)";this.element.style.minHeight=e||"calc(100% - "+r+"px)",this.element.style.height=n,this.element.style.maxHeight=n}else this.element.style.height="",this.element.style.height=this.table.element.clientHeight-r+"px",this.element.scrollTop=this.scrollTop;this.renderer.resize(),!this.fixedHeight&&t!=this.element.clientHeight&&(i=!0,this.subscribed("table-resize")?this.dispatch("table-resize"):this.redraw()),this.scrollBarCheck()}return this._positionPlaceholder(),i}reinitialize(){this.rows.forEach(function(t){t.reinitialize(!0)})}blockRedraw(){this.redrawBlock=!0,this.redrawBlockRestoreConfig=!1}restoreRedraw(){this.redrawBlock=!1,this.redrawBlockRestoreConfig?(this.refreshActiveData(this.redrawBlockRestoreConfig.handler,this.redrawBlockRestoreConfig.skipStage,this.redrawBlockRestoreConfig.renderInPosition),this.redrawBlockRestoreConfig=!1):this.redrawBlockRenderInPosition&&this.reRenderInPosition(),this.redrawBlockRenderInPosition=!1}redraw(t){this.adjustTableSize(),this.table.tableWidth=this.table.element.clientWidth,t?this.renderTable():(this.reRenderInPosition(),this.scrollHorizontal(this.scrollLeft))}resetScroll(){if(this.element.scrollLeft=0,this.element.scrollTop=0,this.table.browser==="ie"){var t=document.createEvent("Event");t.initEvent("scroll",!1,!0),this.element.dispatchEvent(t)}else this.element.dispatchEvent(new Event("scroll"))}}class pz extends Gi{constructor(t){super(t),this.active=!1,this.element=this.createElement(),this.containerElement=this.createContainerElement(),this.external=!1}initialize(){this.initializeElement()}createElement(){var t=document.createElement("div");return t.classList.add("tabulator-footer"),t}createContainerElement(){var t=document.createElement("div");return t.classList.add("tabulator-footer-contents"),this.element.appendChild(t),t}initializeElement(){if(this.table.options.footerElement)switch(typeof this.table.options.footerElement){case"string":this.table.options.footerElement[0]==="<"?this.containerElement.innerHTML=this.table.options.footerElement:(this.external=!0,this.containerElement=document.querySelector(this.table.options.footerElement));break;default:this.element=this.table.options.footerElement;break}}getElement(){return this.element}append(t){this.activate(),this.containerElement.appendChild(t),this.table.rowManager.adjustTableSize()}prepend(t){this.activate(),this.element.insertBefore(t,this.element.firstChild),this.table.rowManager.adjustTableSize()}remove(t){t.parentNode.removeChild(t),this.deactivate()}deactivate(t){(!this.element.firstChild||t)&&(this.external||this.element.parentNode.removeChild(this.element),this.active=!1)}activate(){this.active||(this.active=!0,this.external||(this.table.element.appendChild(this.getElement()),this.table.element.style.display=""))}redraw(){this.dispatch("footer-redraw")}}class mz extends Gi{constructor(t){super(t),this.el=null,this.abortClasses=["tabulator-headers","tabulator-table"],this.previousTargets={},this.listeners=["click","dblclick","contextmenu","mouseenter","mouseleave","mouseover","mouseout","mousemove","mouseup","mousedown","touchstart","touchend"],this.componentMap={"tabulator-cell":"cell","tabulator-row":"row","tabulator-group":"group","tabulator-col":"column"},this.pseudoTrackers={row:{subscriber:null,target:null},cell:{subscriber:null,target:null},group:{subscriber:null,target:null},column:{subscriber:null,target:null}},this.pseudoTracking=!1}initialize(){this.el=this.table.element,this.buildListenerMap(),this.bindSubscriptionWatchers()}buildListenerMap(){var t={};this.listeners.forEach(e=>{t[e]={handler:null,components:[]}}),this.listeners=t}bindPseudoEvents(){Object.keys(this.pseudoTrackers).forEach(t=>{this.pseudoTrackers[t].subscriber=this.pseudoMouseEnter.bind(this,t),this.subscribe(t+"-mouseover",this.pseudoTrackers[t].subscriber)}),this.pseudoTracking=!0}pseudoMouseEnter(t,e,i){this.pseudoTrackers[t].target!==i&&(this.pseudoTrackers[t].target&&this.dispatch(t+"-mouseleave",e,this.pseudoTrackers[t].target),this.pseudoMouseLeave(t,e),this.pseudoTrackers[t].target=i,this.dispatch(t+"-mouseenter",e,i))}pseudoMouseLeave(t,e){var i=Object.keys(this.pseudoTrackers),r={row:["cell"],cell:["row"]};i=i.filter(n=>{var a=r[t];return n!==t&&(!a||a&&!a.includes(n))}),i.forEach(n=>{var a=this.pseudoTrackers[n].target;this.pseudoTrackers[n].target&&(this.dispatch(n+"-mouseleave",e,a),this.pseudoTrackers[n].target=null)})}bindSubscriptionWatchers(){var t=Object.keys(this.listeners),e=Object.values(this.componentMap);for(let i of e)for(let r of t){let n=i+"-"+r;this.subscriptionChange(n,this.subscriptionChanged.bind(this,i,r))}this.subscribe("table-destroy",this.clearWatchers.bind(this))}subscriptionChanged(t,e,i){var r=this.listeners[e].components,n=r.indexOf(t),a=!1;i?n===-1&&(r.push(t),a=!0):this.subscribed(t+"-"+e)||n>-1&&(r.splice(n,1),a=!0),(e==="mouseenter"||e==="mouseleave")&&!this.pseudoTracking&&this.bindPseudoEvents(),a&&this.updateEventListeners()}updateEventListeners(){for(let t in this.listeners){let e=this.listeners[t];e.components.length?e.handler||(e.handler=this.track.bind(this,t),this.el.addEventListener(t,e.handler)):e.handler&&(this.el.removeEventListener(t,e.handler),e.handler=null)}}track(t,e){var i=e.composedPath&&e.composedPath()||e.path,r=this.findTargets(i);r=this.bindComponents(t,r),this.triggerEvents(t,e,r),this.pseudoTracking&&(t=="mouseover"||t=="mouseleave")&&!Object.keys(r).length&&this.pseudoMouseLeave("none",e)}findTargets(t){var e={};let i=Object.keys(this.componentMap);for(let r of t){let n=r.classList?[...r.classList]:[];if(n.filter(l=>this.abortClasses.includes(l)).length)break;let o=n.filter(l=>i.includes(l));for(let l of o)e[this.componentMap[l]]||(e[this.componentMap[l]]=r)}return e.group&&e.group===e.row&&delete e.row,e}bindComponents(t,e){var i=Object.keys(e).reverse(),r=this.listeners[t],n={},a={};for(let o of i){let l,h=e[o],u=this.previousTargets[o];if(u&&u.target===h)l=u.component;else switch(o){case"row":case"group":(r.components.includes("row")||r.components.includes("cell")||r.components.includes("group"))&&(l=this.table.rowManager.getVisibleRows(!0).find(f=>f.getElement()===h),e.row&&e.row.parentNode&&e.row.parentNode.closest(".tabulator-row")&&(e[o]=!1));break;case"column":r.components.includes("column")&&(l=this.table.columnManager.findColumn(h));break;case"cell":r.components.includes("cell")&&(n.row instanceof pr?l=n.row.findCell(h):e.row&&console.warn("Event Target Lookup Error - The row this cell is attached to cannot be found, has the table been reinitialized without being destroyed first?"));break}l&&(n[o]=l,a[o]={target:h,component:l})}return this.previousTargets=a,n}triggerEvents(t,e,i){var r=this.listeners[t];for(let n in i)i[n]&&r.components.includes(n)&&this.dispatch(n+"-"+t,e,i[n])}clearWatchers(){for(let t in this.listeners){let e=this.listeners[t];e.handler&&(this.el.removeEventListener(t,e.handler),e.handler=null)}}}class vz{constructor(t){this.table=t,this.bindings={}}bind(t,e,i){this.bindings[t]||(this.bindings[t]={}),this.bindings[t][e]?console.warn("Unable to bind component handler, a matching function name is already bound",t,e,i):this.bindings[t][e]=i}handle(t,e,i){if(this.bindings[t]&&this.bindings[t][i]&&typeof this.bindings[t][i].bind=="function")return this.bindings[t][i].bind(null,e);i!=="then"&&typeof i=="string"&&!i.startsWith("_")&&this.table.options.debugInvalidComponentFuncs&&console.error("The "+t+" component does not have a "+i+" function, have you checked that you have the correct Tabulator module installed?")}}class gz extends Gi{constructor(t){super(t),this.requestOrder=0,this.loading=!1}initialize(){}load(t,e,i,r,n,a){var o=++this.requestOrder;if(this.table.destroyed)return Promise.resolve();if(this.dispatchExternal("dataLoading",t),t&&(t.indexOf("{")==0||t.indexOf("[")==0)&&(t=JSON.parse(t)),this.confirm("data-loading",[t,e,i,n])){this.loading=!0,n||this.alertLoader(),e=this.chain("data-params",[t,i,n],e||{},e||{}),e=this.mapParams(e,this.table.options.dataSendParams);var l=this.chain("data-load",[t,e,i,n],!1,Promise.resolve([]));return l.then(h=>{if(this.table.destroyed)console.warn("Data Load Response Blocked - Table has been destroyed");else{!Array.isArray(h)&&typeof h=="object"&&(h=this.mapParams(h,this.objectInvert(this.table.options.dataReceiveParams)));var u=this.chain("data-loaded",[h],null,h);o==this.requestOrder?(this.clearAlert(),u!==!1&&(this.dispatchExternal("dataLoaded",u),this.table.rowManager.setData(u,r,typeof a>"u"?!r:a))):console.warn("Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made")}}).catch(h=>{console.error("Data Load Error: ",h),this.dispatchExternal("dataLoadError",h),n||this.alertError(),setTimeout(()=>{this.clearAlert()},this.table.options.dataLoaderErrorTimeout)}).finally(()=>{this.loading=!1})}else return this.dispatchExternal("dataLoaded",t),t||(t=[]),this.table.rowManager.setData(t,r,typeof a>"u"?!r:a),Promise.resolve()}mapParams(t,e){var i={};for(let r in t)i[e.hasOwnProperty(r)?e[r]:r]=t[r];return i}objectInvert(t){var e={};for(let i in t)e[t[i]]=i;return e}blockActiveLoad(){this.requestOrder++}alertLoader(){var t=typeof this.table.options.dataLoader=="function"?this.table.options.dataLoader():this.table.options.dataLoader;t&&this.table.alertManager.alert(this.table.options.dataLoaderLoading||this.langText("data|loading"))}alertError(){this.table.alertManager.alert(this.table.options.dataLoaderError||this.langText("data|error"),"error")}clearAlert(){this.table.alertManager.clear()}}class bz{constructor(t,e,i){this.table=t,this.events={},this.optionsList=e||{},this.subscriptionNotifiers={},this.dispatch=i?this._debugDispatch.bind(this):this._dispatch.bind(this),this.debug=i}subscriptionChange(t,e){this.subscriptionNotifiers[t]||(this.subscriptionNotifiers[t]=[]),this.subscriptionNotifiers[t].push(e),this.subscribed(t)&&this._notifySubscriptionChange(t,!0)}subscribe(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e),this._notifySubscriptionChange(t,!0)}unsubscribe(t,e){var i;if(this.events[t])if(e)if(i=this.events[t].findIndex(r=>r===e),i>-1)this.events[t].splice(i,1);else{console.warn("Cannot remove event, no matching event found:",t,e);return}else delete this.events[t];else{console.warn("Cannot remove event, no events set on:",t);return}this._notifySubscriptionChange(t,!1)}subscribed(t){return this.events[t]&&this.events[t].length}_notifySubscriptionChange(t,e){var i=this.subscriptionNotifiers[t];i&&i.forEach(r=>{r(e)})}_dispatch(){var t=Array.from(arguments),e=t.shift(),i;return this.events[e]&&this.events[e].forEach((r,n)=>{let a=r.apply(this.table,t);n||(i=a)}),i}_debugDispatch(){var t=Array.from(arguments),e=t[0];return t[0]="ExternalEvent:"+t[0],(this.debug===!0||this.debug.includes(e))&&console.log(...t),this._dispatch(...arguments)}}class yz{constructor(t){this.events={},this.subscriptionNotifiers={},this.dispatch=t?this._debugDispatch.bind(this):this._dispatch.bind(this),this.chain=t?this._debugChain.bind(this):this._chain.bind(this),this.confirm=t?this._debugConfirm.bind(this):this._confirm.bind(this),this.debug=t}subscriptionChange(t,e){this.subscriptionNotifiers[t]||(this.subscriptionNotifiers[t]=[]),this.subscriptionNotifiers[t].push(e),this.subscribed(t)&&this._notifySubscriptionChange(t,!0)}subscribe(t,e,i=1e4){this.events[t]||(this.events[t]=[]),this.events[t].push({callback:e,priority:i}),this.events[t].sort((r,n)=>r.priority-n.priority),this._notifySubscriptionChange(t,!0)}unsubscribe(t,e){var i;if(this.events[t]){if(e)if(i=this.events[t].findIndex(r=>r.callback===e),i>-1)this.events[t].splice(i,1);else{console.warn("Cannot remove event, no matching event found:",t,e);return}}else{console.warn("Cannot remove event, no events set on:",t);return}this._notifySubscriptionChange(t,!1)}subscribed(t){return this.events[t]&&this.events[t].length}_chain(t,e,i,r){var n=i;return Array.isArray(e)||(e=[e]),this.subscribed(t)?(this.events[t].forEach((a,o)=>{n=a.callback.apply(this,e.concat([n]))}),n):typeof r=="function"?r():r}_confirm(t,e){var i=!1;return Array.isArray(e)||(e=[e]),this.subscribed(t)&&this.events[t].forEach((r,n)=>{r.callback.apply(this,e)&&(i=!0)}),i}_notifySubscriptionChange(t,e){var i=this.subscriptionNotifiers[t];i&&i.forEach(r=>{r(e)})}_dispatch(){var t=Array.from(arguments),e=t.shift();this.events[e]&&this.events[e].forEach(i=>{i.callback.apply(this,t)})}_debugDispatch(){var t=Array.from(arguments),e=t[0];return t[0]="InternalEvent:"+e,(this.debug===!0||this.debug.includes(e))&&console.log(...t),this._dispatch(...arguments)}_debugChain(){var t=Array.from(arguments),e=t[0];return t[0]="InternalEvent:"+e,(this.debug===!0||this.debug.includes(e))&&console.log(...t),this._chain(...arguments)}_debugConfirm(){var t=Array.from(arguments),e=t[0];return t[0]="InternalEvent:"+e,(this.debug===!0||this.debug.includes(e))&&console.log(...t),this._confirm(...arguments)}}class xz extends Gi{constructor(t){super(t)}_warnUser(){this.options("debugDeprecation")&&console.warn(...arguments)}check(t,e,i){var r="";return typeof this.options(t)<"u"?(r="Deprecated Setup Option - Use of the %c"+t+"%c option is now deprecated",e?(r=r+", Please use the %c"+e+"%c option instead",this._warnUser(r,"font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;"),i&&(this.table.options[e]=this.table.options[t])):this._warnUser(r,"font-weight: bold;","font-weight: normal;"),!1):!0}checkMsg(t,e){return typeof this.options(t)<"u"?(this._warnUser("%cDeprecated Setup Option - Use of the %c"+t+" %c option is now deprecated, "+e,"font-weight: normal;","font-weight: bold;","font-weight: normal;"),!1):!0}msg(t){this._warnUser(t)}}class Cz extends Gi{constructor(t){super(t),this.deps={},this.props={}}initialize(){this.deps=Object.assign({},this.options("dependencies"))}lookup(t,e,i){if(Array.isArray(t)){for(const n of t){var r=this.lookup(n,e,!0);if(r)break}if(r)return r;this.error(t)}else return e?this.lookupProp(t,e,i):this.lookupKey(t,i)}lookupProp(t,e,i){var r;if(this.props[t]&&this.props[t][e])return this.props[t][e];if(r=this.lookupKey(t,i),r)return this.props[t]||(this.props[t]={}),this.props[t][e]=r[e]||r,this.props[t][e]}lookupKey(t,e){var i;return this.deps[t]?i=this.deps[t]:window[t]?(this.deps[t]=window[t],i=this.deps[t]):e||this.error(t),i}error(t){console.error("Unable to find dependency",t,"Please check documentation and ensure you have imported the required library into your project")}}function wz(s,t){t&&this.table.columnManager.renderer.reinitializeColumnWidths(s),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function Ey(s,t){s.forEach(function(e){e.reinitializeWidth()}),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function Ez(s,t){var e=0,i=this.table.rowManager.element.clientWidth,r=0,n=!1;s.forEach((a,o)=>{a.widthFixed||a.reinitializeWidth(),(this.table.options.responsiveLayout?a.modules.responsive.visible:a.visible)&&(n=a),a.visible&&(e+=a.getWidth())}),n?(r=i-e+n.getWidth(),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&(n.setWidth(0),this.table.modules.responsiveLayout.update()),r>0?n.setWidth(r):n.reinitializeWidth()):this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function Sz(s,t){var e=this.table.rowManager.element.getBoundingClientRect().width,i=0,r=0,n=0,a=0,o=[],l=[],h=0,u=0,c=0;function f(p){var v;return typeof p=="string"?p.indexOf("%")>-1?v=e/100*parseInt(p):v=parseInt(p):v=p,v}function d(p,v,g,b){var C=[],y=0,x=0,w=0,S=n,E=0,k=0,A=[];function z(T){return g*(T.column.definition.widthGrow||1)}function D(T){return f(T.width)-g*(T.column.definition.widthShrink||0)}return p.forEach(function(T,M){var K=b?D(T):z(T);T.column.minWidth>=K?C.push(T):T.column.maxWidth&&T.column.maxWidth<K?(T.width=T.column.maxWidth,v-=T.column.maxWidth,S-=b?T.column.definition.widthShrink||1:T.column.definition.widthGrow||1,S&&(g=Math.floor(v/S))):(A.push(T),k+=b?T.column.definition.widthShrink||1:T.column.definition.widthGrow||1)}),C.length?(C.forEach(function(T){y+=b?T.width-T.column.minWidth:T.column.minWidth,T.width=T.column.minWidth}),x=v-y,w=k?Math.floor(x/k):x,E=d(A,x,w,b)):(E=k?v-Math.floor(v/k)*k:v,A.forEach(function(T){T.width=b?D(T):z(T)})),E}this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(e-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),s.forEach(function(p){var v,g,b;p.visible&&(v=p.definition.width,g=parseInt(p.minWidth),v?(b=f(v),i+=b>g?b:g,p.definition.widthShrink&&(l.push({column:p,width:b>g?b:g}),h+=p.definition.widthShrink)):(o.push({column:p,width:0}),n+=p.definition.widthGrow||1))}),r=e-i,a=Math.floor(r/n),c=d(o,r,a,!1),o.length&&c>0&&(o[o.length-1].width+=c),o.forEach(function(p){r-=p.width}),u=Math.abs(c)+r,u>0&&h&&(c=d(l,u,Math.floor(u/h),!0)),c&&l.length&&(l[l.length-1].width-=c),o.forEach(function(p){p.column.setWidth(p.width)}),l.forEach(function(p){p.column.setWidth(p.width)})}var kz={fitData:wz,fitDataFill:Ey,fitDataTable:Ey,fitDataStretch:Ez,fitColumns:Sz};const fo=class fo extends pt{constructor(t){super(t,"layout"),this.mode=null,this.registerTableOption("layout","fitData"),this.registerTableOption("layoutColumnsOnNewData",!1),this.registerColumnOption("widthGrow"),this.registerColumnOption("widthShrink")}initialize(){var t=this.table.options.layout;fo.modes[t]?this.mode=t:(console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : "+t),this.mode="fitData"),this.table.element.setAttribute("tabulator-layout",this.mode),this.subscribe("column-init",this.initializeColumn.bind(this))}initializeColumn(t){t.definition.widthGrow&&(t.definition.widthGrow=Number(t.definition.widthGrow)),t.definition.widthShrink&&(t.definition.widthShrink=Number(t.definition.widthShrink))}getMode(){return this.mode}layout(t){var e=this.table.columnManager.columnsByIndex.find(i=>i.definition.variableHeight||i.definition.formatter==="textarea");this.dispatch("layout-refreshing"),fo.modes[this.mode].call(this,this.table.columnManager.columnsByIndex,t),e&&this.table.rowManager.normalizeHeight(!0),this.dispatch("layout-refreshed")}};Ne(fo,"moduleName","layout"),Ne(fo,"modes",kz);let Mp=fo;var Tz={default:{groups:{item:"item",items:"items"},columns:{},data:{loading:"Loading",error:"Error"},pagination:{page_size:"Page Size",page_title:"Show Page",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page",all:"All",counter:{showing:"Showing",of:"of",rows:"rows",pages:"pages"}},headerFilters:{default:"filter column...",columns:{}}}};const $l=class $l extends pt{constructor(t){super(t),this.locale="default",this.lang=!1,this.bindings={},this.langList={},this.registerTableOption("locale",!1),this.registerTableOption("langs",{})}initialize(){this.langList=$t.deepClone($l.langs),this.table.options.columnDefaults.headerFilterPlaceholder!==!1&&this.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder);for(let t in this.table.options.langs)this.installLang(t,this.table.options.langs[t]);this.setLocale(this.table.options.locale),this.registerTableFunction("setLocale",this.setLocale.bind(this)),this.registerTableFunction("getLocale",this.getLocale.bind(this)),this.registerTableFunction("getLang",this.getLang.bind(this))}setHeaderFilterPlaceholder(t){this.langList.default.headerFilters.default=t}installLang(t,e){this.langList[t]?this._setLangProp(this.langList[t],e):this.langList[t]=e}_setLangProp(t,e){for(let i in e)t[i]&&typeof t[i]=="object"?this._setLangProp(t[i],e[i]):t[i]=e[i]}setLocale(t){t=t||"default";function e(i,r){for(var n in i)typeof i[n]=="object"?(r[n]||(r[n]={}),e(i[n],r[n])):r[n]=i[n]}if(t===!0&&navigator.language&&(t=navigator.language.toLowerCase()),t&&!this.langList[t]){let i=t.split("-")[0];this.langList[i]?(console.warn("Localization Error - Exact matching locale not found, using closest match: ",t,i),t=i):(console.warn("Localization Error - Matching locale not found, using default: ",t),t="default")}this.locale=t,this.lang=$t.deepClone(this.langList.default||{}),t!="default"&&e(this.langList[t],this.lang),this.dispatchExternal("localized",this.locale,this.lang),this._executeBindings()}getLocale(t){return this.locale}getLang(t){return t?this.langList[t]:this.lang}getText(t,e){var i=e?t+"|"+e:t,r=i.split("|"),n=this._getLangElement(r,this.locale);return n||""}_getLangElement(t,e){var i=this.lang;return t.forEach(function(r){var n;i&&(n=i[r],typeof n<"u"?i=n:i=!1)}),i}bind(t,e){this.bindings[t]||(this.bindings[t]=[]),this.bindings[t].push(e),e(this.getText(t),this.lang)}_executeBindings(){for(let t in this.bindings)this.bindings[t].forEach(e=>{e(this.getText(t),this.lang)})}};Ne($l,"moduleName","localize"),Ne($l,"langs",Tz);let Pp=$l;class dE extends pt{constructor(t){super(t)}initialize(){this.registerTableFunction("tableComms",this.receive.bind(this))}getConnections(t){var e=[],i;return i=this.table.constructor.registry.lookupTable(t),i.forEach(r=>{this.table!==r&&e.push(r)}),e}send(t,e,i,r){var n=this.getConnections(t);n.forEach(a=>{a.tableComms(this.table.element,e,i,r)}),!n.length&&t&&console.warn("Table Connection Error - No tables matching selector found",t)}receive(t,e,i,r){if(this.table.modExists(e))return this.table.modules[e].commsReceived(t,i,r);console.warn("Inter-table Comms Error - no such module:",e)}}Ne(dE,"moduleName","comms");var Az=Object.freeze({__proto__:null,CommsModule:dE,LayoutModule:Mp,LocalizeModule:Pp});const Pr=class Pr{static findTable(t){var e=Pr.registry.lookupTable(t,!0);return Array.isArray(e)&&!e.length?!1:e}};Ne(Pr,"registry",{tables:[],register(t){Pr.registry.tables.push(t)},deregister(t){var e=Pr.registry.tables.indexOf(t);e>-1&&Pr.registry.tables.splice(e,1)},lookupTable(t,e){var i=[],r,n;if(typeof t=="string"){if(r=document.querySelectorAll(t),r.length)for(var a=0;a<r.length;a++)n=Pr.registry.matchElement(r[a]),n&&i.push(n)}else typeof HTMLElement<"u"&&t instanceof HTMLElement||t instanceof Pr?(n=Pr.registry.matchElement(t),n&&i.push(n)):Array.isArray(t)?t.forEach(function(o){i=i.concat(Pr.registry.lookupTable(o))}):e||console.warn("Table Connection Error - Invalid Selector",t);return i},matchElement(t){return Pr.registry.tables.find(function(e){return t instanceof Pr?e===t:e.element===t})}});let Bp=Pr;const Bt=class Bt extends Bp{constructor(){super()}static initializeModuleBinder(t){Bt.modulesRegistered||(Bt.modulesRegistered=!0,Bt._registerModules(Az,!0),t&&Bt._registerModules(t))}static _extendModule(t,e,i){if(Bt.moduleBindings[t]){var r=Bt.moduleBindings[t][e];if(r)if(typeof i=="object")for(let n in i)r[n]=i[n];else console.warn("Module Error - Invalid value type, it must be an object");else console.warn("Module Error - property does not exist:",e)}else console.warn("Module Error - module does not exist:",t)}static _registerModules(t,e){var i=Object.values(t);e&&i.forEach(r=>{r.prototype.moduleCore=!0}),Bt._registerModule(i)}static _registerModule(t){Array.isArray(t)||(t=[t]),t.forEach(e=>{Bt._registerModuleBinding(e),Bt._registerModuleExtensions(e)})}static _registerModuleBinding(t){t.moduleName?Bt.moduleBindings[t.moduleName]=t:console.error("Unable to bind module, no moduleName defined",t.moduleName)}static _registerModuleExtensions(t){var e=t.moduleExtensions;if(t.moduleExtensions)for(let i in e){let r=e[i];if(Bt.moduleBindings[i])for(let n in r)Bt._extendModule(i,n,r[n]);else{Bt.moduleExtensions[i]||(Bt.moduleExtensions[i]={});for(let n in r)Bt.moduleExtensions[i][n]||(Bt.moduleExtensions[i][n]={}),Object.assign(Bt.moduleExtensions[i][n],r[n])}}Bt._extendModuleFromQueue(t)}static _extendModuleFromQueue(t){var e=Bt.moduleExtensions[t.moduleName];if(e)for(let i in e)Bt._extendModule(t.moduleName,i,e[i])}_bindModules(){var t=[],e=[],i=[];this.modules={};for(var r in Bt.moduleBindings){let n=Bt.moduleBindings[r],a=new n(this);this.modules[r]=a,n.prototype.moduleCore?this.modulesCore.push(a):n.moduleInitOrder?n.moduleInitOrder<0?t.push(a):e.push(a):i.push(a)}t.sort((n,a)=>n.moduleInitOrder>a.moduleInitOrder?1:-1),e.sort((n,a)=>n.moduleInitOrder>a.moduleInitOrder?1:-1),this.modulesRegular=t.concat(i.concat(e))}};Ne(Bt,"moduleBindings",{}),Ne(Bt,"moduleExtensions",{}),Ne(Bt,"modulesRegistered",!1),Ne(Bt,"defaultModules",!1);let Hp=Bt;class Oz extends Gi{constructor(t){super(t),this.element=this._createAlertElement(),this.msgElement=this._createMsgElement(),this.type=null,this.element.appendChild(this.msgElement)}_createAlertElement(){var t=document.createElement("div");return t.classList.add("tabulator-alert"),t}_createMsgElement(){var t=document.createElement("div");return t.classList.add("tabulator-alert-msg"),t.setAttribute("role","alert"),t}_typeClass(){return"tabulator-alert-state-"+this.type}alert(t,e="msg"){if(t){for(this.clear(),this.dispatch("alert-show",e),this.type=e;this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.add(this._typeClass()),typeof t=="function"&&(t=t()),t instanceof HTMLElement?this.msgElement.appendChild(t):this.msgElement.innerHTML=t,this.table.element.appendChild(this.element)}}clear(){this.dispatch("alert-hide",this.type),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.msgElement.classList.remove(this._typeClass())}}const Ks=class Ks extends Hp{static extendModule(){Ks.initializeModuleBinder(),Ks._extendModule(...arguments)}static registerModule(){Ks.initializeModuleBinder(),Ks._registerModule(...arguments)}constructor(t,e,i){super(),Ks.initializeModuleBinder(i),this.options={},this.columnManager=null,this.rowManager=null,this.footerManager=null,this.alertManager=null,this.vdomHoz=null,this.externalEvents=null,this.eventBus=null,this.interactionMonitor=!1,this.browser="",this.browserSlow=!1,this.browserMobile=!1,this.rtl=!1,this.originalElement=null,this.componentFunctionBinder=new vz(this),this.dataLoader=!1,this.modules={},this.modulesCore=[],this.modulesRegular=[],this.deprecationAdvisor=new xz(this),this.optionsList=new fE(this,"table constructor"),this.dependencyRegistry=new Cz(this),this.initialized=!1,this.destroyed=!1,this.initializeElement(t)&&(this.initializeCoreSystems(e),setTimeout(()=>{this._create()})),this.constructor.registry.register(this)}initializeElement(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement?(this.element=t,!0):typeof t=="string"?(this.element=document.querySelector(t),this.element?!0:(console.error("Tabulator Creation Error - no element found matching selector: ",t),!1)):(console.error("Tabulator Creation Error - Invalid element provided:",t),!1)}initializeCoreSystems(t){this.columnManager=new uz(this),this.rowManager=new dz(this),this.footerManager=new pz(this),this.dataLoader=new gz(this),this.alertManager=new Oz(this),this._bindModules(),this.options=this.optionsList.generate(Ks.defaultOptions,t),this._clearObjectPointers(),this._mapDeprecatedFunctionality(),this.externalEvents=new bz(this,this.options,this.options.debugEventsExternal),this.eventBus=new yz(this.options.debugEventsInternal),this.interactionMonitor=new mz(this),this.dataLoader.initialize(),this.footerManager.initialize(),this.dependencyRegistry.initialize()}_mapDeprecatedFunctionality(){}_clearSelection(){this.element.classList.add("tabulator-block-select"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this.element.classList.remove("tabulator-block-select")}_create(){this.externalEvents.dispatch("tableBuilding"),this.eventBus.dispatch("table-building"),this._rtlCheck(),this._buildElement(),this._initializeTable(),this.initialized=!0,this._loadInitialData().finally(()=>{this.eventBus.dispatch("table-initialized"),this.externalEvents.dispatch("tableBuilt")})}_rtlCheck(){var t=window.getComputedStyle(this.element);switch(this.options.textDirection){case"auto":if(t.direction!=="rtl")break;case"rtl":this.element.classList.add("tabulator-rtl"),this.rtl=!0;break;case"ltr":this.element.classList.add("tabulator-ltr");default:this.rtl=!1}}_clearObjectPointers(){this.options.columns=this.options.columns.slice(0),Array.isArray(this.options.data)&&!this.options.reactiveData&&(this.options.data=this.options.data.slice(0))}_buildElement(){var t=this.element,e=this.options,i;if(t.tagName==="TABLE"){this.originalElement=this.element,i=document.createElement("div");var r=t.attributes;for(var n in r)typeof r[n]=="object"&&i.setAttribute(r[n].name,r[n].value);t.parentNode.replaceChild(i,t),this.element=t=i}for(t.classList.add("tabulator"),t.setAttribute("role","grid");t.firstChild;)t.removeChild(t.firstChild);e.height&&(e.height=isNaN(e.height)?e.height:e.height+"px",t.style.height=e.height),e.minHeight!==!1&&(e.minHeight=isNaN(e.minHeight)?e.minHeight:e.minHeight+"px",t.style.minHeight=e.minHeight),e.maxHeight!==!1&&(e.maxHeight=isNaN(e.maxHeight)?e.maxHeight:e.maxHeight+"px",t.style.maxHeight=e.maxHeight)}_initializeTable(){var t=this.element,e=this.options;this.interactionMonitor.initialize(),this.columnManager.initialize(),this.rowManager.initialize(),this._detectBrowser(),this.modulesCore.forEach(i=>{i.initialize()}),t.appendChild(this.columnManager.getElement()),t.appendChild(this.rowManager.getElement()),e.footerElement&&this.footerManager.activate(),e.autoColumns&&e.data&&this.columnManager.generateColumnsFromRowData(this.options.data),this.modulesRegular.forEach(i=>{i.initialize()}),this.columnManager.setColumns(e.columns),this.eventBus.dispatch("table-built")}_loadInitialData(){return this.dataLoader.load(this.options.data).finally(()=>{this.columnManager.verticalAlignHeaders()})}destroy(){var t=this.element;for(this.destroyed=!0,this.constructor.registry.deregister(this),this.eventBus.dispatch("table-destroy"),this.rowManager.destroy();t.firstChild;)t.removeChild(t.firstChild);t.classList.remove("tabulator"),this.externalEvents.dispatch("tableDestroyed")}_detectBrowser(){var t=navigator.userAgent||navigator.vendor||window.opera;t.indexOf("Trident")>-1?(this.browser="ie",this.browserSlow=!0):t.indexOf("Edge")>-1?(this.browser="edge",this.browserSlow=!0):t.indexOf("Firefox")>-1?(this.browser="firefox",this.browserSlow=!1):t.indexOf("Mac OS")>-1?(this.browser="safari",this.browserSlow=!1):(this.browser="other",this.browserSlow=!1),this.browserMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t.slice(0,4))}initGuard(t,e){var i,r;return this.options.debugInitialization&&!this.initialized&&(t||(i=new Error().stack.split("\n"),r=i[0]=="Error"?i[2]:i[1],r[0]==" "?t=r.trim().split(" ")[1].split(".")[1]:t=r.trim().split("@")[0]),console.warn("Table Not Initialized - Calling the "+t+" function before the table is initialized may result in inconsistent behavior, Please wait for the `tableBuilt` event before calling this function."+(e?" "+e:""))),this.initialized}blockRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-blocking"),this.rowManager.blockRedraw(),this.columnManager.blockRedraw(),this.eventBus.dispatch("redraw-blocked")}restoreRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-restoring"),this.rowManager.restoreRedraw(),this.columnManager.restoreRedraw(),this.eventBus.dispatch("redraw-restored")}setData(t,e,i){return this.initGuard(!1,"To set initial data please use the 'data' property in the table constructor."),this.dataLoader.load(t,e,i,!1)}clearData(){this.initGuard(),this.dataLoader.blockActiveLoad(),this.rowManager.clearData()}getData(t){return this.rowManager.getData(t)}getDataCount(t){return this.rowManager.getDataCount(t)}replaceData(t,e,i){return this.initGuard(),this.dataLoader.load(t,e,i,!0,!0)}updateData(t){var e=0;return this.initGuard(),new Promise((i,r)=>{this.dataLoader.blockActiveLoad(),typeof t=="string"&&(t=JSON.parse(t)),t&&t.length>0?t.forEach(n=>{var a=this.rowManager.findRow(n[this.options.index]);a?(e++,a.updateData(n).then(()=>{e--,e||i()}).catch(o=>{r("Update Error - Unable to update row",n,o)})):r("Update Error - Unable to find row",n)}):(console.warn("Update Error - No data provided"),r("Update Error - No data provided"))})}addData(t,e,i){return this.initGuard(),new Promise((r,n)=>{this.dataLoader.blockActiveLoad(),typeof t=="string"&&(t=JSON.parse(t)),t?this.rowManager.addRows(t,e,i).then(a=>{var o=[];a.forEach(function(l){o.push(l.getComponent())}),r(o)}):(console.warn("Update Error - No data provided"),n("Update Error - No data provided"))})}updateOrAddData(t){var e=[],i=0;return this.initGuard(),new Promise((r,n)=>{this.dataLoader.blockActiveLoad(),typeof t=="string"&&(t=JSON.parse(t)),t&&t.length>0?t.forEach(a=>{var o=this.rowManager.findRow(a[this.options.index]);i++,o?o.updateData(a).then(()=>{i--,e.push(o.getComponent()),i||r(e)}):this.rowManager.addRows(a).then(l=>{i--,e.push(l[0].getComponent()),i||r(e)})}):(console.warn("Update Error - No data provided"),n("Update Error - No data provided"))})}getRow(t){var e=this.rowManager.findRow(t);return e?e.getComponent():(console.warn("Find Error - No matching row found:",t),!1)}getRowFromPosition(t){var e=this.rowManager.getRowFromPosition(t);return e?e.getComponent():(console.warn("Find Error - No matching row found:",t),!1)}deleteRow(t){var e=[];this.initGuard(),Array.isArray(t)||(t=[t]);for(let i of t){let r=this.rowManager.findRow(i,!0);if(r)e.push(r);else return console.error("Delete Error - No matching row found:",i),Promise.reject("Delete Error - No matching row found")}return e.sort((i,r)=>this.rowManager.rows.indexOf(i)>this.rowManager.rows.indexOf(r)?1:-1),e.forEach(i=>{i.delete()}),this.rowManager.reRenderInPosition(),Promise.resolve()}addRow(t,e,i){return this.initGuard(),typeof t=="string"&&(t=JSON.parse(t)),this.rowManager.addRows(t,e,i,!0).then(r=>r[0].getComponent())}updateOrAddRow(t,e){var i=this.rowManager.findRow(t);return this.initGuard(),typeof e=="string"&&(e=JSON.parse(e)),i?i.updateData(e).then(()=>i.getComponent()):this.rowManager.addRows(e).then(r=>r[0].getComponent())}updateRow(t,e){var i=this.rowManager.findRow(t);return this.initGuard(),typeof e=="string"&&(e=JSON.parse(e)),i?i.updateData(e).then(()=>Promise.resolve(i.getComponent())):(console.warn("Update Error - No matching row found:",t),Promise.reject("Update Error - No matching row found"))}scrollToRow(t,e,i){var r=this.rowManager.findRow(t);return r?this.rowManager.scrollToRow(r,e,i):(console.warn("Scroll Error - No matching row found:",t),Promise.reject("Scroll Error - No matching row found"))}moveRow(t,e,i){var r=this.rowManager.findRow(t);this.initGuard(),r?r.moveToRow(e,i):console.warn("Move Error - No matching row found:",t)}getRows(t){return this.rowManager.getComponents(t)}getRowPosition(t){var e=this.rowManager.findRow(t);return e?e.getPosition():(console.warn("Position Error - No matching row found:",t),!1)}setColumns(t){this.initGuard(!1,"To set initial columns please use the 'columns' property in the table constructor"),this.columnManager.setColumns(t)}getColumns(t){return this.columnManager.getComponents(t)}getColumn(t){var e=this.columnManager.findColumn(t);return e?e.getComponent():(console.warn("Find Error - No matching column found:",t),!1)}getColumnDefinitions(){return this.columnManager.getDefinitionTree()}showColumn(t){var e=this.columnManager.findColumn(t);if(this.initGuard(),e)e.show();else return console.warn("Column Show Error - No matching column found:",t),!1}hideColumn(t){var e=this.columnManager.findColumn(t);if(this.initGuard(),e)e.hide();else return console.warn("Column Hide Error - No matching column found:",t),!1}toggleColumn(t){var e=this.columnManager.findColumn(t);if(this.initGuard(),e)e.visible?e.hide():e.show();else return console.warn("Column Visibility Toggle Error - No matching column found:",t),!1}addColumn(t,e,i){var r=this.columnManager.findColumn(i);return this.initGuard(),this.columnManager.addColumn(t,e,r).then(n=>n.getComponent())}deleteColumn(t){var e=this.columnManager.findColumn(t);return this.initGuard(),e?e.delete():(console.warn("Column Delete Error - No matching column found:",t),Promise.reject())}updateColumnDefinition(t,e){var i=this.columnManager.findColumn(t);return this.initGuard(),i?i.updateDefinition(e):(console.warn("Column Update Error - No matching column found:",t),Promise.reject())}moveColumn(t,e,i){var r=this.columnManager.findColumn(t),n=this.columnManager.findColumn(e);this.initGuard(),r?n?this.columnManager.moveColumn(r,n,i):console.warn("Move Error - No matching column found:",n):console.warn("Move Error - No matching column found:",t)}scrollToColumn(t,e,i){return new Promise((r,n)=>{var a=this.columnManager.findColumn(t);return a?this.columnManager.scrollToColumn(a,e,i):(console.warn("Scroll Error - No matching column found:",t),Promise.reject("Scroll Error - No matching column found"))})}redraw(t){this.initGuard(),this.columnManager.redraw(t),this.rowManager.redraw(t)}setHeight(t){this.options.height=isNaN(t)?t:t+"px",this.element.style.height=this.options.height,this.rowManager.initializeRenderer(),this.rowManager.redraw(!0)}on(t,e){this.externalEvents.subscribe(t,e)}off(t,e){this.externalEvents.unsubscribe(t,e)}dispatchEvent(){var t=Array.from(arguments);t.shift(),this.externalEvents.dispatch(...arguments)}alert(t,e){this.initGuard(),this.alertManager.alert(t,e)}clearAlert(){this.initGuard(),this.alertManager.clear()}modExists(t,e){return this.modules[t]?!0:(e&&console.error("Tabulator Module Not Installed: "+t),!1)}module(t){var e=this.modules[t];return e||console.error("Tabulator module not installed: "+t),e}};Ne(Ks,"defaultOptions",oz);let Vp=Ks;var gl=Vp;class Dz extends gl{static extendModule(){gl.initializeModuleBinder(Id),gl._extendModule(...arguments)}static registerModule(){gl.initializeModuleBinder(Id),gl._registerModule(...arguments)}constructor(t,e,i){super(t,e,Id)}}var Lz=Dz;function Sy(s,t){var e="data-"+s.n;return t&&t!==zp?e+"-"+t:e}function Rz(s){return{t:s[0],e:s[1],r:!!s[2],i:!!s[3],o:!!s[4]}}function gc(s,t){if(Ri(t)&&typeof t!="object"&&typeof t!="function"){if(s===Boolean||s===3)return t!=="false"&&(t===""||!!t);if(s===Number||s===4)return parseFloat(t);if(s===String||s===2)return t.toString()}return t}function ky(s,t,e,i){var r=s.u.get(t);r&&((i=r["s-ld"]||r.$activeLoading)&&((e=i.indexOf(t))>-1&&i.splice(e,1),i.length||(r["s-init"]&&r["s-init"](),r.$initLoad&&r.$initLoad())),s.u.delete(t))}function pE(s,t){for(var e,i,r=null,n=!1,a=!1,o=arguments.length;o-- >2;)Zn.push(arguments[o]);for(;Zn.length>0;){var l=Zn.pop();if(l&&l.pop!==void 0)for(o=l.length;o--;)Zn.push(l[o]);else typeof l=="boolean"&&(l=null),(a=typeof s!="function")&&(l==null?l="":typeof l=="number"?l=String(l):typeof l!="string"&&(a=!1)),a&&n?r[r.length-1].f+=l:r===null?r=[a?{f:l}:l]:r.push(a?{f:l}:l),n=a}if(t!=null){if(t.className&&(t.class=t.className),typeof t.class=="object"){for(o in t.class)t.class[o]&&Zn.push(o);t.class=Zn.join(" "),Zn.length=0}t.key!=null&&(e=t.key),t.name!=null&&(i=t.name)}return typeof s=="function"?s(Object.assign({},t,{children:r}),Wz):{c:s,a:r,f:void 0,s:t,l:e,v:i,d:void 0,p:!1}}function Ty(s,t,e,i){t.split(" ").forEach(function(r){s[r]=!0,e&&(s[r+"-"+e]=!0,i&&(s[r+"-"+e+"-"+i]=s[r+"-"+i]=!0))})}function bc(s,t){s.y.has(t)||(s.y.set(t,!0),s.m?s.queue.write(function(){return Wp(s,t)}):s.queue.tick(function(){return Wp(s,t)}))}function Wp(s,t,e,i,r,n){if(s.y.delete(t),!s.b.has(t)){if(i=s.w.get(t),e=!i){if((r=s.u.get(t))&&r.$rendered&&(r["s-rn"]=!0),r&&!r["s-rn"])return(r["s-rc"]=r["s-rc"]||[]).push(function(){Wp(s,t)}),void(r.$onRender=r["s-rc"]);i=function(o,l,h,u,c,f,d){try{(function(v,g,b,C,y,x,w){for(w in v.g.set(C,b),v.M.has(b)||v.M.set(b,{}),(x=Object.assign({color:{type:String}},g.properties)).mode={type:String},x)Iz(v,x[w],b,C,w,y)})(o,c=o.k(l).j,l,u=new c,h),function(v,g,b){if(g){var C=v.g.get(b);g.forEach(function(y){b[y.method]={emit:function(x){v.A(C,y.name,{bubbles:y.bubbles,composed:y.composed,cancelable:y.cancelable,detail:x})}}})}}(o,c.events,u);try{if(f=o.O.get(l)){for(d=0;d<f.length;d+=2)u[f[d]](f[d+1]);o.O.delete(l)}}catch(p){o.C(p,2,l)}}catch(p){u={},o.C(p,7,l,!0)}return o.w.set(l,u),u}(s,t,s.P.get(t));try{i.componentWillLoad&&(n=i.componentWillLoad())}catch(a){s.C(a,3,t)}}else try{i.componentWillUpdate&&(n=i.componentWillUpdate())}catch(a){s.C(a,5,t)}n&&n.then?n.then(function(){return Ay(s,t,i,e)}):Ay(s,t,i,e)}}function Ay(s,t,e,i){(function(n,a,o,l){try{var h,u,c=a.j.host,f=a.j.encapsulation,d=f==="shadow"&&n._.T;if(h=function(w,S,E){return w&&Object.keys(w).forEach(function(k){w[k].reflectToAttr&&((E=E||{})[k]=S[k])}),E}(a.j.properties,l),u=d?o.shadowRoot:o,!o["s-rn"]){n.N(n,n._,a,o);var p=o["s-sc"];p&&(n._.S(o,function(w){return w+"-host"}(p),""),l.render||n._.S(o,function(w){return w+"-slot"}(p),""))}if(l.render||l.hostData||c||h){n.x=!0;var v=l.render&&l.render(),g=void 0;if((g=l.hostData&&l.hostData())&&a.W){var b=Object.keys(g).reduce(function(x,w){return a.W[w]?x.concat(w):a.W[My(w)]?x.concat(My(w)):x},[]);if(b.length>0)throw new Error("The following keys were attempted to be set with hostData() from the "+a.n+" component: "+b.join(", ")+". If you would like to modify these please set @Prop({ mutable: true, reflectToAttr: true}) on the @Prop() decorator.")}h&&(g=g?Object.assign(g,h):h),n.x=!1,c&&(g=function(w,S,E){return w=w||{},Object.keys(S).forEach(function(k){k==="theme"?Ty(w.class=w.class||{},S[k],E.mode,E.color):k==="class"?Ty(w[k]=w[k]||{},S[k]):w[k]=S[k]}),w}(g,c,l));var C=n.D.get(o)||{};C.d=u;var y=pE(null,g,v);y.p=!0,n.D.set(o,n.render(o,C,y,d,f))}n.L&&n.L.R(o),o["s-rn"]=!0,o.$onRender&&(o["s-rc"]=o.$onRender),o["s-rc"]&&(o["s-rc"].forEach(function(x){return x()}),o["s-rc"]=null)}catch(x){n.x=!1,n.C(x,8,o,!0)}})(s,s.k(t),t,e);try{i?t["s-init"]():(e.componentDidUpdate&&e.componentDidUpdate(),yc(s.D.get(t))),t["s-hmr-load"]&&t["s-hmr-load"]()}catch(r){s.C(r,6,t,!0)}}function Iz(s,t,e,i,r,n,a,o){if(t.type||t.state){var l=s.M.get(e);t.state||(!t.attr||l[r]!==void 0&&l[r]!==""||(a=n&&n.F)&&Ri(o=a[t.attr])&&(l[r]=gc(t.type,o)),e.hasOwnProperty(r)&&(l[r]===void 0&&(l[r]=gc(t.type,e[r])),r!=="mode"&&delete e[r])),i.hasOwnProperty(r)&&l[r]===void 0&&(l[r]=i[r]),t.watchCallbacks&&(l[bE+r]=t.watchCallbacks.slice()),vE(i,r,function(c){return(c=s.M.get(s.g.get(this)))&&c[r]},function(c,f){(f=s.g.get(this))&&(t.state||t.mutable)&&mE(s,f,r,c)})}else if(t.elementRef)Al(i,r,e);else if(t.method)Al(e,r,i[r].bind(i));else if(t.context){var h=s.H(t.context);h!==void 0&&Al(i,r,h.q&&h.q(e)||h)}else t.connect&&Al(i,r,s.I(t.connect))}function mE(s,t,e,i,r,n,a){(r=s.M.get(t))||s.M.set(t,r={});var o=r[e];if(i!==o&&(r[e]=i,n=s.w.get(t))){if(a=r[bE+e])for(var l=0;l<a.length;l++)try{n[a[l]].call(n,i,o,e)}catch(h){}!s.x&&t["s-rn"]&&bc(s,t)}}function Al(s,t,e){Object.defineProperty(s,t,{configurable:!0,value:e})}function vE(s,t,e,i){Object.defineProperty(s,t,{configurable:!0,get:e,set:i})}function Oy(s,t,e,i,r){var n=t!==(t=t.replace(/^xlink\:?/,"")),a=zz[t]||i;a&&(!e||e==="false")||r?n?s.removeAttributeNS(Py,en(t)):s.removeAttribute(t):typeof e!="function"&&(a&&(e=""),n?s.setAttributeNS(Py,en(t),e):s.setAttribute(t,e))}function Dy(s,t,e,i,r,n,a){if(e!=="class"||n)if(e==="style"){for(var o in i)r&&r[o]!=null||t.style.B(o);for(var o in r)i&&r[o]===i[o]||t.style.setProperty(o,r[o])}else if(e[0]!=="o"||e[1]!=="n"||!/[A-Z]/.test(e[2])||e in t)if(e!=="list"&&e!=="type"&&!n&&(e in t||["object","function"].indexOf(typeof r)!==-1&&r!==null)){var l=s.k(t);l&&l.W&&l.W[e]?(Ly(t,e,r),a&&l.W[e].U&&Oy(t,l.W[e].z,r,l.W[e].Q===3,r==null)):e!=="ref"&&(Ly(t,e,r==null?"":r),r!=null&&r!==!1||s._.Y(t,e))}else r!=null&&e!=="key"?Oy(t,e,r):(n||s._.Z(t,e)&&(r==null||r===!1))&&s._.Y(t,e);else e=en(e)in t?en(e.substring(2)):en(e[2])+e.substring(3),r?r!==i&&s._.G(t,e,r):s._.J(t,e);else if(i!==r){var h=_d(i),u=_d(r),c=h.filter(function(p){return!u.includes(p)}),f=_d(t.className).filter(function(p){return!c.includes(p)}),d=u.filter(function(p){return!h.includes(p)&&!f.includes(p)});f.push.apply(f,d),t.className=f.join(" ")}}function _d(s){return s==null||s===""?[]:s.trim().split(/\s+/)}function Ly(s,t,e){try{s[t]=e}catch(i){}}function Ry(s,t,e,i,r){var n=e.d.nodeType===11&&e.d.host?e.d.host:e.d,a=t&&t.s||Ny,o=e.s||Ny;for(r in a)o&&o[r]!=null||a[r]==null||Dy(s,n,r,a[r],void 0,i,e.p);for(r in o)r in a&&o[r]===(r==="value"||r==="checked"?n[r]:a[r])||Dy(s,n,r,a[r],o[r],i,e.p)}function _z(s,t){function e(b,C,y,x,w,S,E,k,A){if(k=C.a[y],h||(d=!0,k.c==="slot"&&(c&&t.S(x,c+"-slot",""),k.a?k.K=!0:k.V=!0)),Ri(k.f))k.d=t.X(k.f);else if(k.V)k.d=t.X("");else{if(S=k.d=ys||k.c==="svg"?t.nn("http://www.w3.org/2000/svg",k.c):t.tn(k.K?"slot-fb":k.c),ys=k.c==="svg"||k.c!=="foreignObject"&&ys,Ry(s,null,k,ys),Ri(c)&&S["s-si"]!==c&&t.S(S,S["s-si"]=c,""),Ri(u)&&t.S(S,Bz,u+"."+y+(function z(D){if(D){for(var T=0;T<D.length;T++)if(D[T].c!=="slot"||z(D[T].a))return!0}return!1}(k.a)?"":".")),k.a)for(w=0;w<k.a.length;++w)(E=e(b,k,w,S))&&(Ri(u)&&E.nodeType===3&&!E["s-cr"]&&t.en(S,t.rn("s."+u+"."+w)),t.en(S,E),Ri(u)&&E.nodeType===3&&!E["s-cr"]&&(t.en(S,t.rn("/")),t.en(S,t.X(" "))));k.c==="svg"&&(ys=!1)}return k.d["s-hn"]=p,(k.K||k.V)&&(k.d["s-sr"]=!0,k.d["s-cr"]=v,k.d["s-sn"]=k.v||"",(A=b&&b.a&&b.a[y])&&A.c===k.c&&b.d&&i(b.d)),k.d}function i(b,C,y,x){s.in=!0;var w=t.on(b);for(y=w.length-1;y>=0;y--)(x=w[y])["s-hn"]!==p&&x["s-ol"]&&(t.un(x),t.fn(l(x),x,o(x)),t.un(x["s-ol"]),x["s-ol"]=null,d=!0),C&&i(x,C);s.in=!1}function r(b,C,y,x,w,S,E,k){var A=b["s-cr"]||b.$defaultHolder;for((E=A&&t.cn(A)||b).shadowRoot&&t.an(E)===p&&(E=E.shadowRoot);w<=S;++w)x[w]&&(k=Ri(x[w].f)?t.X(x[w].f):e(null,y,w,b))&&(x[w].d=k,t.fn(E,k,o(C)))}function n(b,C,y,x){for(;C<=y;++C)Ri(b[C])&&(x=b[C].d,f=!0,x["s-ol"]?t.un(x["s-ol"]):i(x,!0),t.un(x))}function a(b,C){return b.c===C.c&&b.l===C.l&&(b.c!=="slot"||b.v===C.v)}function o(b){return b&&b["s-ol"]?b["s-ol"]:b}function l(b){return t.cn(b["s-ol"]?b["s-ol"]:b)}var h,u,c,f,d,p,v,g=[];return function(C,y,x,w,S,E,k,A,z,D,T,M){if(p=t.an(C),v=C["s-cr"],h=w,u=S!=="shadow"?E:null,c=C["s-sc"],d=f=!1,function K(te,ee,J){var re=ee.d=te.d,j=te.a,de=ee.a;ys=ee.d&&Ri(t.sn(ee.d))&&ee.d.ownerSVGElement!==void 0,ys=ee.c==="svg"||ee.c!=="foreignObject"&&ys,Ri(ee.f)?(J=re["s-cr"]||re.$defaultHolder)?t.ln(t.cn(J),ee.f):te.f!==ee.f&&t.ln(re,ee.f):(ee.c!=="slot"&&Ry(s,te,ee,ys),Ri(j)&&Ri(de)?function(N,H,L,_,U,se,ae,oe){for(var me=0,Re=0,V=H.length-1,$e=H[0],Me=H[V],Ze=_.length-1,Je=_[0],Le=_[Ze];me<=V&&Re<=Ze;)if($e==null)$e=H[++me];else if(Me==null)Me=H[--V];else if(Je==null)Je=_[++Re];else if(Le==null)Le=_[--Ze];else if(a($e,Je))K($e,Je),$e=H[++me],Je=_[++Re];else if(a(Me,Le))K(Me,Le),Me=H[--V],Le=_[--Ze];else if(a($e,Le))$e.c!=="slot"&&Le.c!=="slot"||i(t.cn($e.d)),K($e,Le),t.fn(N,$e.d,t.vn(Me.d)),$e=H[++me],Le=_[--Ze];else if(a(Me,Je))$e.c!=="slot"&&Le.c!=="slot"||i(t.cn(Me.d)),K(Me,Je),t.fn(N,Me.d,$e.d),Me=H[--V],Je=_[++Re];else{for(U=null,se=me;se<=V;++se)if(H[se]&&Ri(H[se].l)&&H[se].l===Je.l){U=se;break}Ri(U)?((oe=H[U]).c!==Je.c?ae=e(H&&H[Re],L,U,N):(K(oe,Je),H[U]=void 0,ae=oe.d),Je=_[++Re]):(ae=e(H&&H[Re],L,Re,N),Je=_[++Re]),ae&&t.fn(l($e.d),ae,o($e.d))}me>V?r(N,_[Ze+1]==null?null:_[Ze+1].d,L,_,Re,Ze):Re>Ze&&n(H,me,V)}(re,j,ee,de):Ri(de)?(Ri(te.f)&&t.ln(re,""),r(re,null,ee,de,0,de.length-1)):Ri(j)&&n(j,0,j.length-1)),ys&&ee.c==="svg"&&(ys=!1)}(y,x),Ri(u)&&t.S(y.d,gE,u),d){for(function K(te,ee,J,re,j,de,we,N,H,L){for(j=0,de=(ee=t.on(te)).length;j<de;j++){if((J=ee[j])["s-sr"]&&(re=J["s-cr"]))for(N=t.on(t.cn(re)),H=J["s-sn"],we=N.length-1;we>=0;we--)(re=N[we])["s-cn"]||re["s-nr"]||re["s-hn"]===J["s-hn"]||(((L=t.dn(re))===3||L===8)&&H===""||L===1&&t.pn(re,"slot")===null&&H===""||L===1&&t.pn(re,"slot")===H)&&(g.some(function(_){return _.hn===re})||(f=!0,re["s-sn"]=H,g.push({yn:J,hn:re})));t.dn(J)===1&&K(J)}}(x.d),k=0;k<g.length;k++)(A=g[k]).hn["s-ol"]||((z=t.X(""))["s-nr"]=A.hn,t.fn(t.cn(A.hn),A.hn["s-ol"]=z,A.hn));for(s.in=!0,k=0;k<g.length;k++){for(A=g[k],T=t.cn(A.yn),M=t.vn(A.yn),z=A.hn["s-ol"];z=t.mn(z);)if((D=z["s-nr"])&&D&&D["s-sn"]===A.hn["s-sn"]&&T===t.cn(D)&&(D=t.vn(D))&&D&&!D["s-nr"]){M=D;break}(!M&&T!==t.cn(A.hn)||t.vn(A.hn)!==M)&&A.hn!==M&&(t.un(A.hn),t.fn(T,A.hn,M))}s.in=!1}return f&&function K(te,ee,J,re,j,de,we,N){for(re=0,j=(J=t.on(te)).length;re<j;re++)if(ee=J[re],t.dn(ee)===1){if(ee["s-sr"]){for(we=ee["s-sn"],ee.hidden=!1,de=0;de<j;de++)if(J[de]["s-hn"]!==ee["s-hn"]){if(N=t.dn(J[de]),we!==""){if(N===1&&we===t.pn(J[de],"slot")){ee.hidden=!0;break}}else if(N===1||N===3&&t.bn(J[de]).trim()!==""){ee.hidden=!0;break}}}K(ee)}}(x.d),g.length=0,x}}function yc(s,t){s&&(s.s&&s.s.ref&&s.s.ref(t?null:s.d),s.a&&s.a.forEach(function(e){yc(e,t)}))}function Iy(s,t){var e=s.k(t);e.wn&&e.wn.forEach(function(i){i.r||s._.G(t,i.t,function(n,a,o,l){return function(h){(l=n.w.get(a))?l[o](h):((l=n.O.get(a)||[]).push(o,h),n.O.set(a,l))}}(s,t,i.e),i.o,i.i)})}function Fd(s,t){var e={nodeName:t},i=s.k(e);if(!i||!i.j)return Promise.resolve(null);var r=i.j,n=function(u){return Object.keys(u).reduce(function(c,f){var d,p=u[f],v={name:f};if(p.state)d="states",v.gn=p.watchCallbacks||[];else if(p.elementRef)d="elements";else if(p.method)d="methods";else{d="props";var g="any";p.type&&(g=p.type,typeof p.type=="function"&&(g=p.type.name)),v.type=g.toLowerCase(),v.mutable=p.mutable||!1,v.connect=p.connect||"-",v.context=p.connect||"-",v.gn=p.watchCallbacks||[]}return c[d].push(v),c},{Mn:[],jn:[],kn:[],An:[]})}(r.properties||{}),a=(i.wn||[]).map(function(h){return{$n:h.t,capture:h.o,disabled:h.r,passive:h.i,method:h.e}}),o=r.events||[],l=Object.assign({En:r.is,On:i.Cn||"unknown",encapsulation:r.encapsulation||"none"},n,{events:{Pn:o,listeners:a}});return Promise.resolve(l)}function _y(s,t,e,i,r){return e.mode||(e.mode=s.Tn(e)),e["s-cr"]||s.pn(e,gE)||s.T&&t.encapsulation===1||(e["s-cr"]=s.X(""),e["s-cr"]["s-cn"]=!0,s.fn(e,e["s-cr"],s.on(e)[0])),s.T||t.encapsulation!==1||"shadowRoot"in HTMLElement.prototype||(e.shadowRoot=e),t.encapsulation===1&&s.T&&!e.shadowRoot&&s._n(e,{mode:"open"}),i={Nn:e["s-id"],F:{}},t.W&&Object.keys(t.W).forEach(function(n){(r=t.W[n].z)&&(i.F[r]=s.pn(e,r))}),i}function Fz(s,t,e,i){e.connectedCallback=function(){(function(n,a,o){n.Sn.has(o)||(n.Sn.set(o,!0),Iy(n,o)),n.b.delete(o),n.xn.has(o)||(n.xn.set(o,!0),o["s-id"]||(o["s-id"]=n.Wn()),function(h,u,c){for(c=u;c=h._.sn(c);)if(h.Dn(c)){h.Ln.has(u)||(h.u.set(u,c),c.$activeLoading&&(c["s-ld"]=c.$activeLoading),(c["s-ld"]=c["s-ld"]||[]).push(u));break}}(n,o),n.queue.tick(function(){n.P.set(o,_y(n._,a,o)),n.Rn(a,o)}))})(s,t,this)},e.attributeChangedCallback=function(r,n,a){(function(l,h,u,c,f,d,p){if(l&&c!==f){for(d in l)if((p=l[d]).z&&en(p.z)===en(u)){h[d]=gc(p.Q,f);break}}})(t.W,this,r,n,a)},e.disconnectedCallback=function(){(function(n,a){if(!n.in&&function(h,u){for(;u;){if(!h.cn(u))return h.dn(u)!==9;u=h.cn(u)}}(n._,a)){n.b.set(a,!0),ky(n,a),yc(n.D.get(a),!0),n._.J(a),n.Sn.delete(a);var o=n.w.get(a);o&&o.componentDidUnload&&o.componentDidUnload(),n.L&&n.L.Fn(a),[n.u,n.Hn,n.P].forEach(function(l){return l.delete(a)})}})(s,this)},e["s-init"]=function(){(function(n,a,o,l,h){if(!n.Ln.has(a)&&(l=n.w.get(a))&&!n.b.has(a)&&(!a["s-ld"]||!a["s-ld"].length)){delete a["s-ld"],n.Ln.set(a,!0);try{yc(n.D.get(a)),(h=n.Hn.get(a))&&(h.forEach(function(u){return u(a)}),n.Hn.delete(a)),l.componentDidLoad&&l.componentDidLoad()}catch(u){n.C(u,4,a)}a.classList.add(o),ky(n,a)}})(s,this,i)},e["s-hmr"]=function(r){(function(a,o,l,h){o.j=null;var u=a.w.get(l);u&&(a.g.delete(u),a.w.delete(l)),a._.J(l),a.Sn.delete(l),o.wn=null,l["s-hmr-load"]=function(){delete l["s-hmr-load"],function(f,d,p){f.Sn.has(p)||(f.Sn.set(p,!0),d.j&&d.j.listeners&&(d.wn=d.j.listeners.map(function(v){return{e:v.method,t:v.name,o:!!v.capture,i:!!v.passive,r:!!v.disabled}}),Iy(f,p)))}(a,o,l)},a.P.set(l,_y(a._,o,l)),a.Rn(o,l,h)})(s,t,this,r)},e.forceUpdate=function(){bc(s,this)},function(n,a,o){a&&Object.keys(a).forEach(function(l){var h=a[l],u=h.qn;u===1||u===2?vE(o,l,function(){return(n.M.get(this)||{})[l]},function(f){mE(n,this,l,gc(h.Q,f))}):u===6&&Al(o,l,Vz)})}(s,t.W,e)}function Fy(s,t,e,i){return function(){var r=arguments;return function(a,o,l){var h=o[l],u=a.In.body;return u?(h||(h=u.querySelector(l)),h||(h=o[l]=a.tn(l),a.en(u,h)),h.componentOnReady()):Promise.resolve()}(s,t,e).then(function(n){return n[i].apply(n,r)})}}function Nz(s,t,e,i,r,n){var a={html:{}},o={},l=e[s]=e[s]||{},h=function(v,g,b){v.Bn||(v.Bn=function(x,w,S,E){return x.addEventListener(w,S,E)},v.Un=function(x,w,S,E){return x.removeEventListener(w,S,E)});var C=new WeakMap,y={In:b,zn:!1,dn:function(x){return x.nodeType},tn:function(x){return b.createElement(x)},nn:function(x,w){return b.createElementNS(x,w)},X:function(x){return b.createTextNode(x)},rn:function(x){return b.createComment(x)},fn:function(x,w,S){return x.insertBefore(w,S)},un:function(x){return x.remove()},en:function(x,w){return x.appendChild(w)},on:function(x){return x.childNodes},cn:function(x){return x.parentNode},vn:function(x){return x.nextSibling},mn:function(x){return x.previousSibling},an:function(x){return en(x.nodeName)},bn:function(x){return x.textContent},ln:function(x,w){return x.textContent=w},pn:function(x,w){return x.getAttribute(w)},S:function(x,w,S){return x.setAttribute(w,S)},Qn:function(x,w,S,E){return x.setAttributeNS(w,S,E)},Y:function(x,w){return x.removeAttribute(w)},Z:function(x,w){return x.hasAttribute(w)},Tn:function(x){return x.getAttribute("mode")||(v.Context||{}).mode},Yn:function(x,w){return w==="child"?x.firstElementChild:w==="parent"?y.sn(x):w==="body"?b.body:w==="document"?b:w==="window"?g:x},G:function(x,w,S,E,k,A,z,D){var T=w,M=x,K=C.get(x);if(K&&K[T]&&K[T](),typeof A=="string"?M=y.Yn(x,A):typeof A=="object"?M=A:(D=w.split(":")).length>1&&(M=y.Yn(x,D[0]),w=D[1]),M){var te=S;(D=w.split(".")).length>1&&(w=D[0],te=function(ee){ee.keyCode===Hz[D[1]]&&S(ee)}),z=y.zn?{capture:!!E,passive:!!k}:!!E,v.Bn(M,w,te,z),K||C.set(x,K={}),K[T]=function(){M&&v.Un(M,w,te,z),K[T]=null}}},J:function(x,w){var S=C.get(x);S&&(w?S[w]&&S[w]():Object.keys(S).forEach(function(E){S[E]&&S[E]()}))},_n:function(x,w){return x.attachShadow(w)}};y.T=!!y.In.documentElement.attachShadow,g.location.search.indexOf("shadow=false")>0&&(y.T=!1),typeof g.CustomEvent!="function"&&(g.CustomEvent=function(x,w,S){return(S=b.createEvent("CustomEvent")).initCustomEvent(x,w.bubbles,w.cancelable,w.detail),S},g.CustomEvent.prototype=g.Event.prototype),y.Zn=function(x,w,S){return x&&x.dispatchEvent(new g.CustomEvent(w,S))};try{g.addEventListener("e",null,Object.defineProperty({},"passive",{get:function(){return y.zn=!0}}))}catch(x){}return y.sn=function(x,w){return(w=y.cn(x))&&y.dn(w)===11?w.host:w},y}(l,e,i);t.isServer=t.isPrerender=!(t.isClient=!0),t.window=e,t.location=e.location,t.document=i,t.resourcesUrl=t.publicPath=r,t.enableListener=function(p,v,g,b,C){return function(x,w,S,E,k,A){if(w){var z=x.g.get(w),D=x.k(z);if(D&&D.wn)if(E){var T=D.wn.find(function(M){return M.t===S});T&&x._.G(z,S,function(M){return w[T.e](M)},T.o,A===void 0?T.i:!!A,k)}else x._.J(z,S)}}(f,p,v,g,b,C)},t.emit=function(p,v,g){return h.Zn(p,t.eventNameFn?t.eventNameFn(v):v,g)},l.h=pE,l.Context=t;var u=e["s-defined"]=e.$definedCmps=e["s-defined"]||e.$definedCmps||{},c=0,f={_:h,Gn:function(v,g){if(!e.customElements.get(v.n)){Fz(f,a[v.n]=v,g.prototype,n);var b=g.observedAttributes=[];for(var C in v.W)v.W[C].z&&b.push(v.W[C].z);e.customElements.define(v.n,g)}},A:t.emit,k:function(p){return a[h.an(p)]},H:function(p){return t[p]},isClient:!0,Dn:function(p){return!(!u[h.an(p)]&&!f.k(p))},Wn:function(){return s+c++},C:function(p,v,g){},I:function(p){return function(g,b,C){return{create:Fy(g,b,C,"create"),componentOnReady:Fy(g,b,C,"componentOnReady")}}(h,o,p)},queue:t.queue=function(v,g){function b(T){for(var M=0;M<T.length;M++)try{T[M]()}catch(K){}T.length=0}function C(T,M){for(var K=0;K<T.length&&x()<M;)try{T[K++]()}catch(te){}K===T.length?T.length=0:K!==0&&T.splice(0,K)}function y(){z++,b(E);var T=x()+7*Math.ceil(z*(1/22));C(k,T),C(A,T),k.length>0&&(A.push.apply(A,k),k.length=0),(D=E.length+k.length+A.length>0)?v.raf(y):z=0}var x=function(){return g.performance.now()},w=Promise.resolve(),S=[],E=[],k=[],A=[],z=0,D=!1;return v.raf||(v.raf=g.requestAnimationFrame.bind(g)),{tick:function(T){S.push(T),S.length===1&&w.then(function(){return b(S)})},read:function(T){E.push(T),D||(D=!0,v.raf(y))},write:function(T){k.push(T),D||(D=!0,v.raf(y))}}}(l,e),Rn:function(v,g,b){if(v.j)bc(f,g);else{var C={mode:g.mode,scoped:v.encapsulation===2||v.encapsulation===1&&!h.T};v.Cn(C).then(function(y){try{v.j=y,function(w,S,E,k,A){if(k){var z=S.n+(A||zp);S[z]||(S[z]=k)}}(0,v,v.encapsulation,y.style,y.styleMode)}catch(x){v.j=function(){}}bc(f,g)})}},u:new WeakMap,Jn:new WeakMap,xn:new WeakMap,Sn:new WeakMap,Ln:new WeakMap,g:new WeakMap,P:new WeakMap,w:new WeakMap,b:new WeakMap,y:new WeakMap,Hn:new WeakMap,O:new WeakMap,D:new WeakMap,M:new WeakMap};f.render=_z(f,h);var d=h.In.documentElement;return d["s-ld"]=[],d["s-rn"]=!0,d["s-init"]=function(){f.Ln.set(d,l.loaded=f.m=!0),h.Zn(e,"appload",{detail:{namespace:s}})},f.N=function(p,v,g,b){(function(y,x,w,S){var E=w.encapsulation,k=E===2||E===1&&!y._.T,A=w.n+S.mode,z=w[A];if(k&&(S["s-sc"]=Sy(w,S.mode)),z||(z=w[A=w.n+zp],k&&(S["s-sc"]=Sy(w))),z){var D=x.In.head;if(x.T){if(E===1)D=S.shadowRoot;else for(var T=S;T=x.cn(T);)if(T.host&&T.host.shadowRoot){D=T.host.shadowRoot;break}}var M=y.Jn.get(D);if(M||y.Jn.set(D,M={}),!M[A]){var K=void 0;if(y.L?K=y.L.Kn(S,A,z):((K=x.tn("style")).innerHTML=z,M[A]=!0),K){x.S(K,"data-style-tag",w.n),S.mode&&x.S(K,"data-style-mode",w.n),S["s-sc"]&&x.S(K,"data-style-scoped","true");var te=D.querySelectorAll("[data-styles]");x.fn(D,K,te.length&&te[te.length-1].nextSibling||D.firstChild)}}}})(p,v,g,b)},function(v,g,b,C){var y=b.Vn=b.Vn||{};return y.Xn=y.Xn||[],y.Xn.push(function(w,S,E){return{namespace:S,nt:function(k){return k&&k.tagName?Promise.all([Fd(E,k.tagName),function(z,D){return Promise.resolve(z.w.get(D))}(E,k)]).then(function(A){return A[0]&&A[1]?{tt:A[0],et:A[1]}:null}):Promise.resolve(null)},rt:function(k){return Fd(E,k)},it:function(){return Promise.all(w.components.map(function(k){return Fd(E,k[0])})).then(function(k){return k.filter(function(A){return A})})}}}(v,g,C)),y.nt||(y.nt=function(x){return Promise.all(y.Xn.map(function(w){return w.nt(x)})).then(function(w){return w.find(function(S){return!!S})})}),y.it||(y.it=function(){var x=[];return y.Xn.forEach(function(w){x.push(w.it())}),Promise.all(x).then(function(w){var S=[];return w.forEach(function(E){E.forEach(function(k){S.push(k)})}),S})}),y}(l,s,e,f),function(v,g,b,C,y,x){if(g.componentOnReady=function(w,S){if(!w.nodeName.includes("-"))return S(null),!1;var E=v.k(w);if(E)if(v.Ln.has(w))S(w);else{var k=v.Hn.get(w)||[];k.push(S),v.Hn.set(w,k)}return!!E},y){for(x=y.length-1;x>=0;x--)g.componentOnReady(y[x][0],y[x][1])&&y.splice(x,1);for(x=0;x<C.length;x++)if(!b[C[x]].componentOnReady)return;for(x=0;x<y.length;x++)y[x][1](null);y.length=0}}(f,l,e,e["s-apps"],e["s-cr"]),l.initialized=!0,f}function Mz(s,t,e){e===void 0&&(e={}),t=Array.isArray(t)?t:[t];var i=s.document,r=e.hydratedCssClass||"hydrated",n=t.filter(function(l){return l[2]}).map(function(l){return l[0]});if(n.length){var a=i.createElement("style");a.innerHTML=n.join()+"{visibility:hidden}."+r+"{visibility:inherit}",a.setAttribute("data-styles",""),i.head.insertBefore(a,i.head.firstChild)}var o=e.namespace||"QrCode";By||(By=!0,function(h,u,c){(h["s-apps"]=h["s-apps"]||[]).push(u),c.componentOnReady||(c.componentOnReady=function(){function d(v){if(p.nodeName.indexOf("-")>0){for(var g=h["s-apps"],b=0,C=0;C<g.length;C++)if(h[g[C]].componentOnReady){if(h[g[C]].componentOnReady(p,v))return;b++}if(b<g.length)return void(h["s-cr"]=h["s-cr"]||[]).push([p,v])}v(null)}var p=this;return h.Promise?new h.Promise(d):{then:d}})}(s,o,s.HTMLElement.prototype)),Pz(s,function(){if(!Nd[o]){var l={},h=e.resourcesUrl||"./";Nd[o]=Nz(o,l,s,i,h,r)}t.forEach(function(u){var c;(function(d){return/\{\s*\[native code\]\s*\}/.test(""+d)})(s.customElements.define)?c=new Function("w","return class extends w.HTMLElement{}")(s):(c=function(f){return s.HTMLElement.call(this,f)}).prototype=Object.create(s.HTMLElement.prototype,{constructor:{value:c,configurable:!0}}),Nd[o].Gn(function(d,p,v){var g={n:d[0],W:{color:{z:"color"}}};g.Cn=d[1];var b=d[3];if(b)for(p=0;p<b.length;p++)v=b[p],g.W[v[0]]={qn:v[1],U:!!v[2],z:typeof v[3]=="string"?v[3]:v[3]?v[0]:0,Q:v[4]};return g.encapsulation=d[4],d[5]&&(g.wn=d[5].map(Rz)),g}(u),c)})})}function Pz(s,t){s.ut=function(){function i(){var L=setTimeout;return function(){return L(r,1)}}function r(){for(var L=0;L<x;L+=2)(0,K[L])(K[L+1]),K[L]=void 0,K[L+1]=void 0;x=0}function n(L,_){var U=this,se=new this.constructor(o);se[ee]===void 0&&b(se);var ae=U.ft;if(ae){var oe=arguments[ae-1];E(function(){return g(ae,se,oe,U.ct)})}else p(U,se,L,_);return se}function a(L){if(L&&typeof L=="object"&&L.constructor===this)return L;var _=new this(o);return u(_,L),_}function o(){}function l(L){try{return L.then}catch(_){return de.error=_,de}}function h(L,_,U){_.constructor===L.constructor&&U===n&&_.constructor.resolve===a?function(se,ae){ae.ft===re?f(se,ae.ct):ae.ft===j?d(se,ae.ct):p(ae,void 0,function(oe){return u(se,oe)},function(oe){return d(se,oe)})}(L,_):U===de?(d(L,de.error),de.error=null):U===void 0?f(L,_):typeof U=="function"?function(se,ae,oe){E(function(me){var Re=!1,V=function($e,Me,Ze,Je){try{$e.call(Me,Ze,Je)}catch(Le){return Le}}(oe,ae,function($e){Re||(Re=!0,ae!==$e?u(me,$e):f(me,$e))},function($e){Re||(Re=!0,d(me,$e))},me.st);!Re&&V&&(Re=!0,d(me,V))},se)}(L,_,U):f(L,_)}function u(L,_){if(L===_)d(L,new TypeError("cannot resolve promise w/ itself"));else{var U=typeof _;_===null||U!=="object"&&U!=="function"?f(L,_):h(L,_,l(_))}}function c(L){L.lt&&L.lt(L.ct),v(L)}function f(L,_){L.ft===J&&(L.ct=_,L.ft=re,L.vt.length!==0&&E(v,L))}function d(L,_){L.ft===J&&(L.ft=j,L.ct=_,E(c,L))}function p(L,_,U,se){var ae=L.vt,oe=ae.length;L.lt=null,ae[oe]=_,ae[oe+re]=U,ae[oe+j]=se,oe===0&&L.ft&&E(v,L)}function v(L){var _=L.vt,U=L.ft;if(_.length!==0){for(var se,ae,oe=L.ct,me=0;me<_.length;me+=3)se=_[me],ae=_[me+U],se?g(U,se,ae,oe):ae(oe);L.vt.length=0}}function g(L,_,U,se){var ae=typeof U=="function",oe=void 0,me=void 0,Re=void 0,V=void 0;if(ae){try{oe=U(se)}catch($e){de.error=$e,oe=de}if(oe===de?(V=!0,me=oe.error,oe.error=null):Re=!0,_===oe)return void d(_,new TypeError("Cannot return same promise"))}else oe=se,Re=!0;_.ft===J&&(ae&&Re?u(_,oe):V?d(_,me):L===re?f(_,oe):L===j&&d(_,oe))}function b(L){L[ee]=we++,L.ft=void 0,L.ct=void 0,L.vt=[]}var C,y=Array.isArray?Array.isArray:function(L){return Object.prototype.toString.call(L)==="[object Array]"},x=0,w=void 0,S=void 0,E=function(L,_){K[x]=L,K[x+1]=_,(x+=2)===2&&(S?S(r):te())},k=(C=s!==void 0?s:void 0)||{},A=k.dt||k.pt;k=typeof self>"u";var z,D,T,M=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u",K=Array(1e3),te=void 0;te=A?(z=0,D=new A(r),T=document.createTextNode(""),D.observe(T,{characterData:!0}),function(){T.data=z=++z%2}):M?function(){var L=new MessageChannel;return L.ht.onmessage=r,function(){return L.yt.postMessage(0)}}():C===void 0&&typeof require=="function"?function(){try{var L=Function("return this")().mt("vertx");return(w=L.bt||L.wt)!==void 0?function(){w(r)}:i()}catch(_){return i()}}():i();var ee=Math.random().toString(36).substring(2),J=void 0,re=1,j=2,de={error:null},we=0,N=function(){function L(_,U){this.gt=_,this.Mt=new _(o),this.Mt[ee]||b(this.Mt),y(U)?(this.jt=this.length=U.length,this.ct=Array(this.length),this.length===0?f(this.Mt,this.ct):(this.length=this.length||0,this.kt(U),this.jt===0&&f(this.Mt,this.ct))):d(this.Mt,Error("Array Methods must be provided an Array"))}return L.prototype.kt=function(_){for(var U=0;this.ft===J&&U<_.length;U++)this.At(_[U],U)},L.prototype.At=function(_,U){var se=this.gt,ae=se.resolve;ae===a?(ae=l(_))===n&&_.ft!==J?this.$t(_.ft,U,_.ct):typeof ae!="function"?(this.jt--,this.ct[U]=_):se===H?(h(se=new se(o),_,ae),this.Et(se,U)):this.Et(new se(function(oe){return oe(_)}),U):this.Et(ae(_),U)},L.prototype.$t=function(_,U,se){var ae=this.Mt;ae.ft===J&&(this.jt--,_===j?d(ae,se):this.ct[U]=se),this.jt===0&&f(ae,this.ct)},L.prototype.Et=function(_,U){var se=this;p(_,void 0,function(ae){return se.$t(re,U,ae)},function(ae){return se.$t(j,U,ae)})},L}(),H=function(){function L(_){if(this[ee]=we++,this.ct=this.ft=void 0,this.vt=[],o!==_){if(typeof _!="function")throw new TypeError("Must pass a resolver fn as 1st arg");if(!(this instanceof L))throw new TypeError("Failed to construct 'Promise': Use the 'new' operator.");(function(U,se){try{se(function(ae){u(U,ae)},function(ae){d(U,ae)})}catch(ae){d(U,ae)}})(this,_)}}return L.prototype.catch=function(_){return this.then(null,_)},L.prototype.finally=function(_){var U=this.constructor;return this.then(function(se){return U.resolve(_()).then(function(){return se})},function(se){return U.resolve(_()).then(function(){throw se})})},L}();return H.prototype.then=n,H.all=function(L){return new N(this,L).Mt},H.race=function(L){var _=this;return y(L)?new _(function(U,se){for(var ae=L.length,oe=0;oe<ae;oe++)_.resolve(L[oe]).then(U,se)}):new _(function(U,se){return se(new TypeError("Must pass array to race"))})},H.resolve=a,H.reject=function(L){var _=new this(o);return d(_,L),_},H.Ot=function(L){S=L},H.Ct=function(L){E=L},H.Pt=E,H.Tt=function(){var L=void 0;if(typeof global<"u")L=global;else if(typeof self<"u")L=self;else try{L=Function("return this")()}catch(se){throw Error("polyfill failed")}var _=L.Promise;if(_){var U=null;try{U=Object.prototype.toString.call(_.resolve())}catch(se){}if(U==="[object Promise]"&&!_._t)return}L.Promise=H},H.Promise=H,H.Tt(),H}();var e=[];s.customElements&&(!s.Element||s.Element.prototype.closest&&s.Element.prototype.matches&&s.Element.prototype.remove)||e.push(io(()=>import("./dom.js"),[],import.meta.url)),typeof Object.assign=="function"&&Object.entries||e.push(io(()=>import("./object.js"),[],import.meta.url)),Array.prototype.find&&Array.prototype.includes||e.push(io(()=>import("./array.js"),[],import.meta.url)),String.prototype.startsWith&&String.prototype.endsWith||e.push(io(()=>import("./string.js"),[],import.meta.url)),s.fetch||e.push(io(()=>import("./fetch.js"),[],import.meta.url)),Promise.all(e).then(function(i){i.forEach(function(r){r.applyPolyfill(s,s.document)}),t()})}var gE="data-ssrv",Bz="data-ssrc",zp="$",Ny={},Hz={enter:13,escape:27,space:32,tab:9,left:37,up:38,right:39,down:40},Ri=function(s){return s!=null},en=function(s){return s.toLowerCase()},My=function(s){return en(s).split("-").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join("")},Vz=function(){},Zn=[],Wz={getTag:function(s){return s.c},getChildren:function(s){return s.a},getText:function(s){return s.f},getAttributes:function(s){return s.s},replaceAttributes:function(s,t){return s.s=t}},bE="wc-",zz={allowfullscreen:1,async:1,autofocus:1,autoplay:1,checked:1,controls:1,disabled:1,enabled:1,formnovalidate:1,hidden:1,multiple:1,noresize:1,readonly:1,required:1,selected:1,spellcheck:1},Py="http://www.w3.org/1999/xlink",ys=!1,Nd={},By=!1,jz=["qr-code",function(){return io(()=>import("./mu42bxql.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(function(s){return s.QrCode})},1,[["animateQRCode",6],["contents",1,0,1,2],["data",5],["getModuleCount",6],["maskXToYRatio",1,0,"mask-x-to-y-ratio",4],["moduleColor",1,0,"module-color",2],["moduleCount",5],["positionCenterColor",1,0,"position-center-color",2],["positionRingColor",1,0,"position-ring-color",2],["protocol",1,0,1,2],["qrCodeElement",7],["squares",1,0,1,3]],1];function Uz(s,t){Mz(s,[jz],t)}const Hy=({contents:s,height:t=20,width:e=20,size:i})=>{_e.useEffect(()=>{Uz(window)},[]);const r=String(s),n=i||Math.min(t,e),a=i?"px":"mm";return Ae.jsx("div",{style:{height:"".concat(n).concat(a),width:"".concat(n).concat(a)},children:Ae.jsx("qr-code",{contents:r})})};var yv={},rf={},_r={};Object.defineProperty(_r,"__esModule",{value:!0});function $z(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var qz=function s(t,e){$z(this,s),this.data=t,this.text=e.text||t,this.options=e};_r.default=qz;Object.defineProperty(rf,"__esModule",{value:!0});rf.CODE39=void 0;var Gz=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),Xz=_r,Kz=Yz(Xz);function Yz(s){return s&&s.__esModule?s:{default:s}}function Jz(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function Qz(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function Zz(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var e8=function(s){Zz(t,s);function t(e,i){return Jz(this,t),e=e.toUpperCase(),i.mod43&&(e+=r8(s8(e))),Qz(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return Gz(t,[{key:"encode",value:function(){for(var i=Md("*"),r=0;r<this.data.length;r++)i+=Md(this.data[r])+"0";return i+=Md("*"),{data:i,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)!==-1}}]),t}(Kz.default),yE=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],t8=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function Md(s){return i8(xE(s))}function i8(s){return t8[s].toString(2)}function r8(s){return yE[s]}function xE(s){return yE.indexOf(s)}function s8(s){for(var t=0,e=0;e<s.length;e++)t+=xE(s[e]);return t=t%43,t}rf.CODE39=e8;var Is={},xv={},Ho={},ii={};Object.defineProperty(ii,"__esModule",{value:!0});var bl;function Pd(s,t,e){return t in s?Object.defineProperty(s,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):s[t]=e,s}var CE=ii.SET_A=0,wE=ii.SET_B=1,EE=ii.SET_C=2;ii.SHIFT=98;var n8=ii.START_A=103,a8=ii.START_B=104,o8=ii.START_C=105;ii.MODULO=103;ii.STOP=106;ii.FNC1=207;ii.SET_BY_CODE=(bl={},Pd(bl,n8,CE),Pd(bl,a8,wE),Pd(bl,o8,EE),bl);ii.SWAP={101:CE,100:wE,99:EE};ii.A_START_CHAR="";ii.B_START_CHAR="";ii.C_START_CHAR="";ii.A_CHARS="[\0-_-]";ii.B_CHARS="[ --]";ii.C_CHARS="(*[0-9]{2}*)";ii.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011];Object.defineProperty(Ho,"__esModule",{value:!0});var l8=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),h8=_r,u8=c8(h8),Nr=ii;function c8(s){return s&&s.__esModule?s:{default:s}}function f8(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function d8(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function p8(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var m8=function(s){p8(t,s);function t(e,i){f8(this,t);var r=d8(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.substring(1),i));return r.bytes=e.split("").map(function(n){return n.charCodeAt(0)}),r}return l8(t,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var i=this.bytes,r=i.shift()-105,n=Nr.SET_BY_CODE[r];if(n===void 0)throw new RangeError("The encoding does not start with a start character.");this.shouldEncodeAsEan128()===!0&&i.unshift(Nr.FNC1);var a=t.next(i,1,n);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:t.getBar(r)+a.result+t.getBar((a.checksum+r)%Nr.MODULO)+t.getBar(Nr.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var i=this.options.ean128||!1;return typeof i=="string"&&(i=i.toLowerCase()==="true"),i}}],[{key:"getBar",value:function(i){return Nr.BARS[i]?Nr.BARS[i].toString():""}},{key:"correctIndex",value:function(i,r){if(r===Nr.SET_A){var n=i.shift();return n<32?n+64:n-32}else return r===Nr.SET_B?i.shift()-32:(i.shift()-48)*10+i.shift()-48}},{key:"next",value:function(i,r,n){if(!i.length)return{result:"",checksum:0};var a=void 0,o=void 0;if(i[0]>=200){o=i.shift()-105;var l=Nr.SWAP[o];l!==void 0?a=t.next(i,r+1,l):((n===Nr.SET_A||n===Nr.SET_B)&&o===Nr.SHIFT&&(i[0]=n===Nr.SET_A?i[0]>95?i[0]-96:i[0]:i[0]<32?i[0]+96:i[0]),a=t.next(i,r+1,n))}else o=t.correctIndex(i,n),a=t.next(i,r+1,n);var h=t.getBar(o),u=o*r;return{result:h+a.result,checksum:u+a.checksum}}}]),t}(u8.default);Ho.default=m8;var Cv={};Object.defineProperty(Cv,"__esModule",{value:!0});var An=ii,SE=function(t){return t.match(new RegExp("^"+An.A_CHARS+"*"))[0].length},kE=function(t){return t.match(new RegExp("^"+An.B_CHARS+"*"))[0].length},TE=function(t){return t.match(new RegExp("^"+An.C_CHARS+"*"))[0]};function wv(s,t){var e=t?An.A_CHARS:An.B_CHARS,i=s.match(new RegExp("^("+e+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(i)return i[1]+""+AE(s.substring(i[1].length));var r=s.match(new RegExp("^"+e+"+"))[0];return r.length===s.length?s:r+String.fromCharCode(t?205:206)+wv(s.substring(r.length),!t)}function AE(s){var t=TE(s),e=t.length;if(e===s.length)return s;s=s.substring(e);var i=SE(s)>=kE(s);return t+String.fromCharCode(i?206:205)+wv(s,i)}Cv.default=function(s){var t=void 0,e=TE(s).length;if(e>=2)t=An.C_START_CHAR+AE(s);else{var i=SE(s)>kE(s);t=(i?An.A_START_CHAR:An.B_START_CHAR)+wv(s,i)}return t.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,function(r,n){return""+n})};Object.defineProperty(xv,"__esModule",{value:!0});var v8=Ho,g8=OE(v8),b8=Cv,y8=OE(b8);function OE(s){return s&&s.__esModule?s:{default:s}}function x8(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function Bd(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function C8(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var w8=function(s){C8(t,s);function t(e,i){if(x8(this,t),/^[\x00-\x7F\xC8-\xD3]+$/.test(e))var r=Bd(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(0,y8.default)(e),i));else var r=Bd(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return Bd(r)}return t}(g8.default);xv.default=w8;var Ev={};Object.defineProperty(Ev,"__esModule",{value:!0});var E8=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),S8=Ho,k8=T8(S8),Vy=ii;function T8(s){return s&&s.__esModule?s:{default:s}}function A8(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function O8(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function D8(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var L8=function(s){D8(t,s);function t(e,i){return A8(this,t),O8(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,Vy.A_START_CHAR+e,i))}return E8(t,[{key:"valid",value:function(){return new RegExp("^"+Vy.A_CHARS+"+$").test(this.data)}}]),t}(k8.default);Ev.default=L8;var Sv={};Object.defineProperty(Sv,"__esModule",{value:!0});var R8=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),I8=Ho,_8=F8(I8),Wy=ii;function F8(s){return s&&s.__esModule?s:{default:s}}function N8(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function M8(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function P8(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var B8=function(s){P8(t,s);function t(e,i){return N8(this,t),M8(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,Wy.B_START_CHAR+e,i))}return R8(t,[{key:"valid",value:function(){return new RegExp("^"+Wy.B_CHARS+"+$").test(this.data)}}]),t}(_8.default);Sv.default=B8;var kv={};Object.defineProperty(kv,"__esModule",{value:!0});var H8=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),V8=Ho,W8=z8(V8),zy=ii;function z8(s){return s&&s.__esModule?s:{default:s}}function j8(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function U8(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function $8(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var q8=function(s){$8(t,s);function t(e,i){return j8(this,t),U8(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,zy.C_START_CHAR+e,i))}return H8(t,[{key:"valid",value:function(){return new RegExp("^"+zy.C_CHARS+"+$").test(this.data)}}]),t}(W8.default);kv.default=q8;Object.defineProperty(Is,"__esModule",{value:!0});Is.CODE128C=Is.CODE128B=Is.CODE128A=Is.CODE128=void 0;var G8=xv,X8=sf(G8),K8=Ev,Y8=sf(K8),J8=Sv,Q8=sf(J8),Z8=kv,e6=sf(Z8);function sf(s){return s&&s.__esModule?s:{default:s}}Is.CODE128=X8.default;Is.CODE128A=Y8.default;Is.CODE128B=Q8.default;Is.CODE128C=e6.default;var kr={},Tv={},vs={};Object.defineProperty(vs,"__esModule",{value:!0});vs.SIDE_BIN="101";vs.MIDDLE_BIN="01010";vs.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]};vs.EAN2_STRUCTURE=["LL","LG","GL","GG"];vs.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"];vs.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"];var nf={},Fa={};Object.defineProperty(Fa,"__esModule",{value:!0});var t6=vs,i6=function(t,e,i){var r=t.split("").map(function(a,o){return t6.BINARIES[e[o]]}).map(function(a,o){return a?a[t[o]]:""});if(i){var n=t.length-1;r=r.map(function(a,o){return o<n?a+i:a})}return r.join("")};Fa.default=i6;Object.defineProperty(nf,"__esModule",{value:!0});var r6=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),Qa=vs,s6=Fa,jy=DE(s6),n6=_r,a6=DE(n6);function DE(s){return s&&s.__esModule?s:{default:s}}function o6(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function l6(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function h6(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var u6=function(s){h6(t,s);function t(e,i){o6(this,t);var r=l6(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return r.fontSize=!i.flat&&i.fontSize>i.width*10?i.width*10:i.fontSize,r.guardHeight=i.height+r.fontSize/2+i.textMargin,r}return r6(t,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(i,r){return this.text.substr(i,r)}},{key:"leftEncode",value:function(i,r){return(0,jy.default)(i,r)}},{key:"rightText",value:function(i,r){return this.text.substr(i,r)}},{key:"rightEncode",value:function(i,r){return(0,jy.default)(i,r)}},{key:"encodeGuarded",value:function(){var i={fontSize:this.fontSize},r={height:this.guardHeight};return[{data:Qa.SIDE_BIN,options:r},{data:this.leftEncode(),text:this.leftText(),options:i},{data:Qa.MIDDLE_BIN,options:r},{data:this.rightEncode(),text:this.rightText(),options:i},{data:Qa.SIDE_BIN,options:r}]}},{key:"encodeFlat",value:function(){var i=[Qa.SIDE_BIN,this.leftEncode(),Qa.MIDDLE_BIN,this.rightEncode(),Qa.SIDE_BIN];return{data:i.join(""),text:this.text}}}]),t}(a6.default);nf.default=u6;Object.defineProperty(Tv,"__esModule",{value:!0});var c6=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),yl=function s(t,e,i){t===null&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(r===void 0){var n=Object.getPrototypeOf(t);return n===null?void 0:s(n,e,i)}else{if("value"in r)return r.value;var a=r.get;return a===void 0?void 0:a.call(i)}},f6=vs,d6=nf,p6=m6(d6);function m6(s){return s&&s.__esModule?s:{default:s}}function v6(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function g6(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function b6(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var Uy=function(t){var e=t.substr(0,12).split("").map(function(i){return+i}).reduce(function(i,r,n){return n%2?i+r*3:i+r},0);return(10-e%10)%10},y6=function(s){b6(t,s);function t(e,i){v6(this,t),e.search(/^[0-9]{12}$/)!==-1&&(e+=Uy(e));var r=g6(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return r.lastChar=i.lastChar,r}return c6(t,[{key:"valid",value:function(){return this.data.search(/^[0-9]{13}$/)!==-1&&+this.data[12]===Uy(this.data)}},{key:"leftText",value:function(){return yl(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var i=this.data.substr(1,6),r=f6.EAN13_STRUCTURE[this.data[0]];return yl(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftEncode",this).call(this,i,r)}},{key:"rightText",value:function(){return yl(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var i=this.data.substr(7,6);return yl(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightEncode",this).call(this,i,"RRRRRR")}},{key:"encodeGuarded",value:function(){var i=yl(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(i.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(i.push({data:"00"}),i.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),i}}]),t}(p6.default);Tv.default=y6;var Av={};Object.defineProperty(Av,"__esModule",{value:!0});var x6=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),Pu=function s(t,e,i){t===null&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(r===void 0){var n=Object.getPrototypeOf(t);return n===null?void 0:s(n,e,i)}else{if("value"in r)return r.value;var a=r.get;return a===void 0?void 0:a.call(i)}},C6=nf,w6=E6(C6);function E6(s){return s&&s.__esModule?s:{default:s}}function S6(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function k6(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function T6(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var $y=function(t){var e=t.substr(0,7).split("").map(function(i){return+i}).reduce(function(i,r,n){return n%2?i+r:i+r*3},0);return(10-e%10)%10},A6=function(s){T6(t,s);function t(e,i){return S6(this,t),e.search(/^[0-9]{7}$/)!==-1&&(e+=$y(e)),k6(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return x6(t,[{key:"valid",value:function(){return this.data.search(/^[0-9]{8}$/)!==-1&&+this.data[7]===$y(this.data)}},{key:"leftText",value:function(){return Pu(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var i=this.data.substr(0,4);return Pu(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftEncode",this).call(this,i,"LLLL")}},{key:"rightText",value:function(){return Pu(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var i=this.data.substr(4,4);return Pu(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightEncode",this).call(this,i,"RRRR")}}]),t}(w6.default);Av.default=A6;var Ov={};Object.defineProperty(Ov,"__esModule",{value:!0});var O6=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),D6=vs,L6=Fa,R6=LE(L6),I6=_r,_6=LE(I6);function LE(s){return s&&s.__esModule?s:{default:s}}function F6(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function N6(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function M6(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var P6=function(t){var e=t.split("").map(function(i){return+i}).reduce(function(i,r,n){return n%2?i+r*9:i+r*3},0);return e%10},B6=function(s){M6(t,s);function t(e,i){return F6(this,t),N6(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return O6(t,[{key:"valid",value:function(){return this.data.search(/^[0-9]{5}$/)!==-1}},{key:"encode",value:function(){var i=D6.EAN5_STRUCTURE[P6(this.data)];return{data:"1011"+(0,R6.default)(this.data,i,"01"),text:this.text}}}]),t}(_6.default);Ov.default=B6;var Dv={};Object.defineProperty(Dv,"__esModule",{value:!0});var H6=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),V6=vs,W6=Fa,z6=RE(W6),j6=_r,U6=RE(j6);function RE(s){return s&&s.__esModule?s:{default:s}}function $6(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function q6(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function G6(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var X6=function(s){G6(t,s);function t(e,i){return $6(this,t),q6(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return H6(t,[{key:"valid",value:function(){return this.data.search(/^[0-9]{2}$/)!==-1}},{key:"encode",value:function(){var i=V6.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,z6.default)(this.data,i,"01"),text:this.text}}}]),t}(U6.default);Dv.default=X6;var Lh={};Object.defineProperty(Lh,"__esModule",{value:!0});var K6=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}();Lh.checksum=jp;var Y6=Fa,Za=IE(Y6),J6=_r,Q6=IE(J6);function IE(s){return s&&s.__esModule?s:{default:s}}function Z6(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function e5(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function t5(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var i5=function(s){t5(t,s);function t(e,i){Z6(this,t),e.search(/^[0-9]{11}$/)!==-1&&(e+=jp(e));var r=e5(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return r.displayValue=i.displayValue,i.fontSize>i.width*10?r.fontSize=i.width*10:r.fontSize=i.fontSize,r.guardHeight=i.height+r.fontSize/2+i.textMargin,r}return K6(t,[{key:"valid",value:function(){return this.data.search(/^[0-9]{12}$/)!==-1&&this.data[11]==jp(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var i="";return i+="101",i+=(0,Za.default)(this.data.substr(0,6),"LLLLLL"),i+="01010",i+=(0,Za.default)(this.data.substr(6,6),"RRRRRR"),i+="101",{data:i,text:this.text}}},{key:"guardedEncoding",value:function(){var i=[];return this.displayValue&&i.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),i.push({data:"101"+(0,Za.default)(this.data[0],"L"),options:{height:this.guardHeight}}),i.push({data:(0,Za.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),i.push({data:"01010",options:{height:this.guardHeight}}),i.push({data:(0,Za.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),i.push({data:(0,Za.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&i.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),i}}]),t}(Q6.default);function jp(s){var t=0,e;for(e=1;e<11;e+=2)t+=parseInt(s[e]);for(e=0;e<11;e+=2)t+=parseInt(s[e])*3;return(10-t%10)%10}Lh.default=i5;var Lv={};Object.defineProperty(Lv,"__esModule",{value:!0});var r5=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),s5=Fa,n5=_E(s5),a5=_r,o5=_E(a5),l5=Lh;function _E(s){return s&&s.__esModule?s:{default:s}}function h5(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function Hd(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function u5(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var c5=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],f5=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],d5=function(s){u5(t,s);function t(e,i){h5(this,t);var r=Hd(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));if(r.isValid=!1,e.search(/^[0-9]{6}$/)!==-1)r.middleDigits=e,r.upcA=qy(e,"0"),r.text=i.text||""+r.upcA[0]+e+r.upcA[r.upcA.length-1],r.isValid=!0;else if(e.search(/^[01][0-9]{7}$/)!==-1)if(r.middleDigits=e.substring(1,e.length-1),r.upcA=qy(r.middleDigits,e[0]),r.upcA[r.upcA.length-1]===e[e.length-1])r.isValid=!0;else return Hd(r);else return Hd(r);return r.displayValue=i.displayValue,i.fontSize>i.width*10?r.fontSize=i.width*10:r.fontSize=i.fontSize,r.guardHeight=i.height+r.fontSize/2+i.textMargin,r}return r5(t,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var i="";return i+="101",i+=this.encodeMiddleDigits(),i+="010101",{data:i,text:this.text}}},{key:"guardedEncoding",value:function(){var i=[];return this.displayValue&&i.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),i.push({data:"101",options:{height:this.guardHeight}}),i.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),i.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&i.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),i}},{key:"encodeMiddleDigits",value:function(){var i=this.upcA[0],r=this.upcA[this.upcA.length-1],n=f5[parseInt(r)][parseInt(i)];return(0,n5.default)(this.middleDigits,n)}}]),t}(o5.default);function qy(s,t){for(var e=parseInt(s[s.length-1]),i=c5[e],r="",n=0,a=0;a<i.length;a++){var o=i[a];o==="X"?r+=s[n++]:r+=o}return r=""+t+r,""+r+(0,l5.checksum)(r)}Lv.default=d5;Object.defineProperty(kr,"__esModule",{value:!0});kr.UPCE=kr.UPC=kr.EAN2=kr.EAN5=kr.EAN8=kr.EAN13=void 0;var p5=Tv,m5=Vo(p5),v5=Av,g5=Vo(v5),b5=Ov,y5=Vo(b5),x5=Dv,C5=Vo(x5),w5=Lh,E5=Vo(w5),S5=Lv,k5=Vo(S5);function Vo(s){return s&&s.__esModule?s:{default:s}}kr.EAN13=m5.default;kr.EAN8=g5.default;kr.EAN5=y5.default;kr.EAN2=C5.default;kr.UPC=E5.default;kr.UPCE=k5.default;var Lo={},af={},Rh={};Object.defineProperty(Rh,"__esModule",{value:!0});Rh.START_BIN="1010";Rh.END_BIN="11101";Rh.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"];Object.defineProperty(af,"__esModule",{value:!0});var T5=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),Bu=Rh,A5=_r,O5=D5(A5);function D5(s){return s&&s.__esModule?s:{default:s}}function L5(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function R5(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function I5(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var _5=function(s){I5(t,s);function t(){return L5(this,t),R5(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return T5(t,[{key:"valid",value:function(){return this.data.search(/^([0-9]{2})+$/)!==-1}},{key:"encode",value:function(){var i=this,r=this.data.match(/.{2}/g).map(function(n){return i.encodePair(n)}).join("");return{data:Bu.START_BIN+r+Bu.END_BIN,text:this.text}}},{key:"encodePair",value:function(i){var r=Bu.BINARIES[i[1]];return Bu.BINARIES[i[0]].split("").map(function(n,a){return(n==="1"?"111":"1")+(r[a]==="1"?"000":"0")}).join("")}}]),t}(O5.default);af.default=_5;var Rv={};Object.defineProperty(Rv,"__esModule",{value:!0});var F5=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),N5=af,M5=P5(N5);function P5(s){return s&&s.__esModule?s:{default:s}}function B5(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function H5(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function V5(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var Gy=function(t){var e=t.substr(0,13).split("").map(function(i){return parseInt(i,10)}).reduce(function(i,r,n){return i+r*(3-n%2*2)},0);return Math.ceil(e/10)*10-e},W5=function(s){V5(t,s);function t(e,i){return B5(this,t),e.search(/^[0-9]{13}$/)!==-1&&(e+=Gy(e)),H5(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return F5(t,[{key:"valid",value:function(){return this.data.search(/^[0-9]{14}$/)!==-1&&+this.data[13]===Gy(this.data)}}]),t}(M5.default);Rv.default=W5;Object.defineProperty(Lo,"__esModule",{value:!0});Lo.ITF14=Lo.ITF=void 0;var z5=af,j5=FE(z5),U5=Rv,$5=FE(U5);function FE(s){return s&&s.__esModule?s:{default:s}}Lo.ITF=j5.default;Lo.ITF14=$5.default;var as={},Na={};Object.defineProperty(Na,"__esModule",{value:!0});var q5=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),G5=_r,X5=K5(G5);function K5(s){return s&&s.__esModule?s:{default:s}}function Y5(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function J5(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function Q5(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var Z5=function(s){Q5(t,s);function t(e,i){return Y5(this,t),J5(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return q5(t,[{key:"encode",value:function(){for(var i="110",r=0;r<this.data.length;r++){var n=parseInt(this.data[r]),a=n.toString(2);a=ej(a,4-a.length);for(var o=0;o<a.length;o++)i+=a[o]=="0"?"100":"110"}return i+="1001",{data:i,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9]+$/)!==-1}}]),t}(X5.default);function ej(s,t){for(var e=0;e<t;e++)s="0"+s;return s}Na.default=Z5;var Iv={},Ma={};Object.defineProperty(Ma,"__esModule",{value:!0});Ma.mod10=tj;Ma.mod11=ij;function tj(s){for(var t=0,e=0;e<s.length;e++){var i=parseInt(s[e]);(e+s.length)%2===0?t+=i:t+=i*2%10+Math.floor(i*2/10)}return(10-t%10)%10}function ij(s){for(var t=0,e=[2,3,4,5,6,7],i=0;i<s.length;i++){var r=parseInt(s[s.length-1-i]);t+=e[i%e.length]*r}return(11-t%11)%11}Object.defineProperty(Iv,"__esModule",{value:!0});var rj=Na,sj=aj(rj),nj=Ma;function aj(s){return s&&s.__esModule?s:{default:s}}function oj(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function lj(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function hj(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var uj=function(s){hj(t,s);function t(e,i){return oj(this,t),lj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e+(0,nj.mod10)(e),i))}return t}(sj.default);Iv.default=uj;var _v={};Object.defineProperty(_v,"__esModule",{value:!0});var cj=Na,fj=pj(cj),dj=Ma;function pj(s){return s&&s.__esModule?s:{default:s}}function mj(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function vj(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function gj(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var bj=function(s){gj(t,s);function t(e,i){return mj(this,t),vj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e+(0,dj.mod11)(e),i))}return t}(fj.default);_v.default=bj;var Fv={};Object.defineProperty(Fv,"__esModule",{value:!0});var yj=Na,xj=Cj(yj),Xy=Ma;function Cj(s){return s&&s.__esModule?s:{default:s}}function wj(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function Ej(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function Sj(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var kj=function(s){Sj(t,s);function t(e,i){return wj(this,t),e+=(0,Xy.mod10)(e),e+=(0,Xy.mod10)(e),Ej(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return t}(xj.default);Fv.default=kj;var Nv={};Object.defineProperty(Nv,"__esModule",{value:!0});var Tj=Na,Aj=Oj(Tj),Ky=Ma;function Oj(s){return s&&s.__esModule?s:{default:s}}function Dj(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function Lj(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function Rj(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var Ij=function(s){Rj(t,s);function t(e,i){return Dj(this,t),e+=(0,Ky.mod11)(e),e+=(0,Ky.mod10)(e),Lj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return t}(Aj.default);Nv.default=Ij;Object.defineProperty(as,"__esModule",{value:!0});as.MSI1110=as.MSI1010=as.MSI11=as.MSI10=as.MSI=void 0;var _j=Na,Fj=Ih(_j),Nj=Iv,Mj=Ih(Nj),Pj=_v,Bj=Ih(Pj),Hj=Fv,Vj=Ih(Hj),Wj=Nv,zj=Ih(Wj);function Ih(s){return s&&s.__esModule?s:{default:s}}as.MSI=Fj.default;as.MSI10=Mj.default;as.MSI11=Bj.default;as.MSI1010=Vj.default;as.MSI1110=zj.default;var of={};Object.defineProperty(of,"__esModule",{value:!0});of.pharmacode=void 0;var jj=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),Uj=_r,$j=qj(Uj);function qj(s){return s&&s.__esModule?s:{default:s}}function Gj(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function Xj(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function Kj(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var Yj=function(s){Kj(t,s);function t(e,i){Gj(this,t);var r=Xj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return r.number=parseInt(e,10),r}return jj(t,[{key:"encode",value:function(){for(var i=this.number,r="";!isNaN(i)&&i!=0;)i%2===0?(r="11100"+r,i=(i-2)/2):(r="100"+r,i=(i-1)/2);return r=r.slice(0,-2),{data:r,text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),t}($j.default);of.pharmacode=Yj;var lf={};Object.defineProperty(lf,"__esModule",{value:!0});lf.codabar=void 0;var Jj=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),Qj=_r,Zj=eU(Qj);function eU(s){return s&&s.__esModule?s:{default:s}}function tU(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function iU(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function rU(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var sU=function(s){rU(t,s);function t(e,i){tU(this,t),e.search(/^[0-9\-\$\:\.\+\/]+$/)===0&&(e="A"+e+"A");var r=iU(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.toUpperCase(),i));return r.text=r.options.text||r.text.replace(/[A-D]/g,""),r}return Jj(t,[{key:"valid",value:function(){return this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)!==-1}},{key:"encode",value:function(){for(var i=[],r=this.getEncodings(),n=0;n<this.data.length;n++)i.push(r[this.data.charAt(n)]),n!==this.data.length-1&&i.push("0");return{text:this.text,data:i.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),t}(Zj.default);lf.codabar=sU;var hf={};Object.defineProperty(hf,"__esModule",{value:!0});hf.GenericBarcode=void 0;var nU=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),aU=_r,oU=lU(aU);function lU(s){return s&&s.__esModule?s:{default:s}}function hU(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function uU(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function cU(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var fU=function(s){cU(t,s);function t(e,i){return hU(this,t),uU(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return nU(t,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),t}(oU.default);hf.GenericBarcode=fU;Object.defineProperty(yv,"__esModule",{value:!0});var dU=rf,Hu=Is,eo=kr,Yy=Lo,xl=as,pU=of,mU=lf,vU=hf;yv.default={CODE39:dU.CODE39,CODE128:Hu.CODE128,CODE128A:Hu.CODE128A,CODE128B:Hu.CODE128B,CODE128C:Hu.CODE128C,EAN13:eo.EAN13,EAN8:eo.EAN8,EAN5:eo.EAN5,EAN2:eo.EAN2,UPC:eo.UPC,UPCE:eo.UPCE,ITF14:Yy.ITF14,ITF:Yy.ITF,MSI:xl.MSI,MSI10:xl.MSI10,MSI11:xl.MSI11,MSI1010:xl.MSI1010,MSI1110:xl.MSI1110,pharmacode:pU.pharmacode,codabar:mU.codabar,GenericBarcode:vU.GenericBarcode};var Wo={};Object.defineProperty(Wo,"__esModule",{value:!0});var gU=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(s[i]=e[i])}return s};Wo.default=function(s,t){return gU({},s,t)};var Mv={};Object.defineProperty(Mv,"__esModule",{value:!0});Mv.default=bU;function bU(s){var t=[];function e(i){if(Array.isArray(i))for(var r=0;r<i.length;r++)e(i[r]);else i.text=i.text||"",i.data=i.data||"",t.push(i)}return e(s),t}var Pv={};Object.defineProperty(Pv,"__esModule",{value:!0});Pv.default=yU;function yU(s){return s.marginTop=s.marginTop||s.margin,s.marginBottom=s.marginBottom||s.margin,s.marginRight=s.marginRight||s.margin,s.marginLeft=s.marginLeft||s.margin,s}var Bv={},Hv={},uf={};Object.defineProperty(uf,"__esModule",{value:!0});uf.default=xU;function xU(s){var t=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var e in t)t.hasOwnProperty(e)&&(e=t[e],typeof s[e]=="string"&&(s[e]=parseInt(s[e],10)));return typeof s.displayValue=="string"&&(s.displayValue=s.displayValue!="false"),s}var cf={};Object.defineProperty(cf,"__esModule",{value:!0});var CU={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};cf.default=CU;Object.defineProperty(Hv,"__esModule",{value:!0});var wU=uf,EU=NE(wU),SU=cf,Jy=NE(SU);function NE(s){return s&&s.__esModule?s:{default:s}}function kU(s){var t={};for(var e in Jy.default)Jy.default.hasOwnProperty(e)&&(s.hasAttribute("jsbarcode-"+e.toLowerCase())&&(t[e]=s.getAttribute("jsbarcode-"+e.toLowerCase())),s.hasAttribute("data-"+e.toLowerCase())&&(t[e]=s.getAttribute("data-"+e.toLowerCase())));return t.value=s.getAttribute("jsbarcode-value")||s.getAttribute("data-value"),t=(0,EU.default)(t),t}Hv.default=kU;var Vv={},Wv={},zr={};Object.defineProperty(zr,"__esModule",{value:!0});zr.getTotalWidthOfEncodings=zr.calculateEncodingAttributes=zr.getBarcodePadding=zr.getEncodingHeight=zr.getMaximumHeightOfEncodings=void 0;var TU=Wo,AU=OU(TU);function OU(s){return s&&s.__esModule?s:{default:s}}function ME(s,t){return t.height+(t.displayValue&&s.text.length>0?t.fontSize+t.textMargin:0)+t.marginTop+t.marginBottom}function PE(s,t,e){if(e.displayValue&&t<s){if(e.textAlign=="center")return Math.floor((s-t)/2);if(e.textAlign=="left")return 0;if(e.textAlign=="right")return Math.floor(s-t)}return 0}function DU(s,t,e){for(var i=0;i<s.length;i++){var r=s[i],n=(0,AU.default)(t,r.options),a;n.displayValue?a=IU(r.text,n,e):a=0;var o=r.data.length*n.width;r.width=Math.ceil(Math.max(a,o)),r.height=ME(r,n),r.barcodePadding=PE(a,o,n)}}function LU(s){for(var t=0,e=0;e<s.length;e++)t+=s[e].width;return t}function RU(s){for(var t=0,e=0;e<s.length;e++)s[e].height>t&&(t=s[e].height);return t}function IU(s,t,e){var i;if(e)i=e;else if(typeof document<"u")i=document.createElement("canvas").getContext("2d");else return 0;i.font=t.fontOptions+" "+t.fontSize+"px "+t.font;var r=i.measureText(s);if(!r)return 0;var n=r.width;return n}zr.getMaximumHeightOfEncodings=RU;zr.getEncodingHeight=ME;zr.getBarcodePadding=PE;zr.calculateEncodingAttributes=DU;zr.getTotalWidthOfEncodings=LU;Object.defineProperty(Wv,"__esModule",{value:!0});var _U=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),FU=Wo,NU=MU(FU),Vd=zr;function MU(s){return s&&s.__esModule?s:{default:s}}function PU(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var BU=function(){function s(t,e,i){PU(this,s),this.canvas=t,this.encodings=e,this.options=i}return _U(s,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var e=0;e<this.encodings.length;e++){var i=(0,NU.default)(this.options,this.encodings[e].options);this.drawCanvasBarcode(i,this.encodings[e]),this.drawCanvasText(i,this.encodings[e]),this.moveCanvasDrawing(this.encodings[e])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var e=this.canvas.getContext("2d");e.save(),(0,Vd.calculateEncodingAttributes)(this.encodings,this.options,e);var i=(0,Vd.getTotalWidthOfEncodings)(this.encodings),r=(0,Vd.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=i+this.options.marginLeft+this.options.marginRight,this.canvas.height=r,e.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(e.fillStyle=this.options.background,e.fillRect(0,0,this.canvas.width,this.canvas.height)),e.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(e,i){var r=this.canvas.getContext("2d"),n=i.data,a;e.textPosition=="top"?a=e.marginTop+e.fontSize+e.textMargin:a=e.marginTop,r.fillStyle=e.lineColor;for(var o=0;o<n.length;o++){var l=o*e.width+i.barcodePadding;n[o]==="1"?r.fillRect(l,a,e.width,e.height):n[o]&&r.fillRect(l,a,e.width,e.height*n[o])}}},{key:"drawCanvasText",value:function(e,i){var r=this.canvas.getContext("2d"),n=e.fontOptions+" "+e.fontSize+"px "+e.font;if(e.displayValue){var a,o;e.textPosition=="top"?o=e.marginTop+e.fontSize-e.textMargin:o=e.height+e.textMargin+e.marginTop+e.fontSize,r.font=n,e.textAlign=="left"||i.barcodePadding>0?(a=0,r.textAlign="left"):e.textAlign=="right"?(a=i.width-1,r.textAlign="right"):(a=i.width/2,r.textAlign="center"),r.fillText(i.text,a,o)}}},{key:"moveCanvasDrawing",value:function(e){var i=this.canvas.getContext("2d");i.translate(e.width,0)}},{key:"restoreCanvas",value:function(){var e=this.canvas.getContext("2d");e.restore()}}]),s}();Wv.default=BU;var zv={};Object.defineProperty(zv,"__esModule",{value:!0});var HU=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}(),VU=Wo,WU=zU(VU),Wd=zr;function zU(s){return s&&s.__esModule?s:{default:s}}function jU(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var Vu="http://www.w3.org/2000/svg",UU=function(){function s(t,e,i){jU(this,s),this.svg=t,this.encodings=e,this.options=i,this.document=i.xmlDocument||document}return HU(s,[{key:"render",value:function(){var e=this.options.marginLeft;this.prepareSVG();for(var i=0;i<this.encodings.length;i++){var r=this.encodings[i],n=(0,WU.default)(this.options,r.options),a=this.createGroup(e,n.marginTop,this.svg);this.setGroupOptions(a,n),this.drawSvgBarcode(a,n,r),this.drawSVGText(a,n,r),e+=r.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,Wd.calculateEncodingAttributes)(this.encodings,this.options);var e=(0,Wd.getTotalWidthOfEncodings)(this.encodings),i=(0,Wd.getMaximumHeightOfEncodings)(this.encodings),r=e+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(r,i),this.options.background&&this.drawRect(0,0,r,i,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(e,i,r){var n=r.data,a;i.textPosition=="top"?a=i.fontSize+i.textMargin:a=0;for(var o=0,l=0,h=0;h<n.length;h++)l=h*i.width+r.barcodePadding,n[h]==="1"?o++:o>0&&(this.drawRect(l-i.width*o,a,i.width*o,i.height,e),o=0);o>0&&this.drawRect(l-i.width*(o-1),a,i.width*o,i.height,e)}},{key:"drawSVGText",value:function(e,i,r){var n=this.document.createElementNS(Vu,"text");if(i.displayValue){var a,o;n.setAttribute("style","font:"+i.fontOptions+" "+i.fontSize+"px "+i.font),i.textPosition=="top"?o=i.fontSize-i.textMargin:o=i.height+i.textMargin+i.fontSize,i.textAlign=="left"||r.barcodePadding>0?(a=0,n.setAttribute("text-anchor","start")):i.textAlign=="right"?(a=r.width-1,n.setAttribute("text-anchor","end")):(a=r.width/2,n.setAttribute("text-anchor","middle")),n.setAttribute("x",a),n.setAttribute("y",o),n.appendChild(this.document.createTextNode(r.text)),e.appendChild(n)}}},{key:"setSvgAttributes",value:function(e,i){var r=this.svg;r.setAttribute("width",e+"px"),r.setAttribute("height",i+"px"),r.setAttribute("x","0px"),r.setAttribute("y","0px"),r.setAttribute("viewBox","0 0 "+e+" "+i),r.setAttribute("xmlns",Vu),r.setAttribute("version","1.1"),r.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(e,i,r){var n=this.document.createElementNS(Vu,"g");return n.setAttribute("transform","translate("+e+", "+i+")"),r.appendChild(n),n}},{key:"setGroupOptions",value:function(e,i){e.setAttribute("style","fill:"+i.lineColor+";")}},{key:"drawRect",value:function(e,i,r,n,a){var o=this.document.createElementNS(Vu,"rect");return o.setAttribute("x",e),o.setAttribute("y",i),o.setAttribute("width",r),o.setAttribute("height",n),a.appendChild(o),o}}]),s}();zv.default=UU;var jv={};Object.defineProperty(jv,"__esModule",{value:!0});var $U=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}();function qU(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var GU=function(){function s(t,e,i){qU(this,s),this.object=t,this.encodings=e,this.options=i}return $U(s,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),s}();jv.default=GU;Object.defineProperty(Vv,"__esModule",{value:!0});var XU=Wv,KU=Uv(XU),YU=zv,JU=Uv(YU),QU=jv,ZU=Uv(QU);function Uv(s){return s&&s.__esModule?s:{default:s}}Vv.default={CanvasRenderer:KU.default,SVGRenderer:JU.default,ObjectRenderer:ZU.default};var zo={};Object.defineProperty(zo,"__esModule",{value:!0});function $v(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function qv(s,t){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:s}function Gv(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(s,t):s.__proto__=t)}var e9=function(s){Gv(t,s);function t(e,i){$v(this,t);var r=qv(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.name="InvalidInputException",r.symbology=e,r.input=i,r.message='"'+r.input+'" is not a valid input for '+r.symbology,r}return t}(Error),t9=function(s){Gv(t,s);function t(){$v(this,t);var e=qv(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="InvalidElementException",e.message="Not supported type to render on",e}return t}(Error),i9=function(s){Gv(t,s);function t(){$v(this,t);var e=qv(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="NoElementException",e.message="No element to render on.",e}return t}(Error);zo.InvalidInputException=e9;zo.InvalidElementException=t9;zo.NoElementException=i9;Object.defineProperty(Bv,"__esModule",{value:!0});var r9=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},s9=Hv,Up=BE(s9),n9=Vv,Ol=BE(n9),a9=zo;function BE(s){return s&&s.__esModule?s:{default:s}}function Xv(s){if(typeof s=="string")return o9(s);if(Array.isArray(s)){for(var t=[],e=0;e<s.length;e++)t.push(Xv(s[e]));return t}else{if(typeof HTMLCanvasElement<"u"&&s instanceof HTMLImageElement)return l9(s);if(s&&s.nodeName&&s.nodeName.toLowerCase()==="svg"||typeof SVGElement<"u"&&s instanceof SVGElement)return{element:s,options:(0,Up.default)(s),renderer:Ol.default.SVGRenderer};if(typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement)return{element:s,options:(0,Up.default)(s),renderer:Ol.default.CanvasRenderer};if(s&&s.getContext)return{element:s,renderer:Ol.default.CanvasRenderer};if(s&&(typeof s>"u"?"undefined":r9(s))==="object"&&!s.nodeName)return{element:s,renderer:Ol.default.ObjectRenderer};throw new a9.InvalidElementException}}function o9(s){var t=document.querySelectorAll(s);if(t.length!==0){for(var e=[],i=0;i<t.length;i++)e.push(Xv(t[i]));return e}}function l9(s){var t=document.createElement("canvas");return{element:t,options:(0,Up.default)(s),renderer:Ol.default.CanvasRenderer,afterRender:function(){s.setAttribute("src",t.toDataURL())}}}Bv.default=Xv;var Kv={};Object.defineProperty(Kv,"__esModule",{value:!0});var h9=function(){function s(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}();function u9(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var c9=function(){function s(t){u9(this,s),this.api=t}return h9(s,[{key:"handleCatch",value:function(e){if(e.name==="InvalidInputException")if(this.api._options.valid!==this.api._defaults.valid)this.api._options.valid(!1);else throw e.message;else throw e;this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(e){try{var i=e.apply(void 0,arguments);return this.api._options.valid(!0),i}catch(r){return this.handleCatch(r),this.api}}}]),s}();Kv.default=c9;var f9=yv,ma=Bn(f9),d9=Wo,_h=Bn(d9),p9=Mv,HE=Bn(p9),m9=Pv,Qy=Bn(m9),v9=Bv,g9=Bn(v9),b9=uf,y9=Bn(b9),x9=Kv,C9=Bn(x9),VE=zo,w9=cf,WE=Bn(w9);function Bn(s){return s&&s.__esModule?s:{default:s}}var tn=function(){},ff=function(t,e,i){var r=new tn;if(typeof t>"u")throw Error("No element to render on was provided.");return r._renderProperties=(0,g9.default)(t),r._encodings=[],r._options=WE.default,r._errorHandler=new C9.default(r),typeof e<"u"&&(i=i||{},i.format||(i.format=jE()),r.options(i)[i.format](e,i).render()),r};ff.getModule=function(s){return ma.default[s]};for(var Zy in ma.default)ma.default.hasOwnProperty(Zy)&&E9(ma.default,Zy);function E9(s,t){tn.prototype[t]=tn.prototype[t.toUpperCase()]=tn.prototype[t.toLowerCase()]=function(e,i){var r=this;return r._errorHandler.wrapBarcodeCall(function(){i.text=typeof i.text>"u"?void 0:""+i.text;var n=(0,_h.default)(r._options,i);n=(0,y9.default)(n);var a=s[t],o=zE(e,a,n);return r._encodings.push(o),r})}}function zE(s,t,e){s=""+s;var i=new t(s,e);if(!i.valid())throw new VE.InvalidInputException(i.constructor.name,s);var r=i.encode();r=(0,HE.default)(r);for(var n=0;n<r.length;n++)r[n].options=(0,_h.default)(e,r[n].options);return r}function jE(){return ma.default.CODE128?"CODE128":Object.keys(ma.default)[0]}tn.prototype.options=function(s){return this._options=(0,_h.default)(this._options,s),this};tn.prototype.blank=function(s){var t=new Array(s+1).join("0");return this._encodings.push({data:t}),this};tn.prototype.init=function(){if(this._renderProperties){Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]);var s;for(var t in this._renderProperties){s=this._renderProperties[t];var e=(0,_h.default)(this._options,s.options);e.format=="auto"&&(e.format=jE()),this._errorHandler.wrapBarcodeCall(function(){var i=e.value,r=ma.default[e.format.toUpperCase()],n=zE(i,r,e);$p(s,n,e)})}}};tn.prototype.render=function(){if(!this._renderProperties)throw new VE.NoElementException;if(Array.isArray(this._renderProperties))for(var s=0;s<this._renderProperties.length;s++)$p(this._renderProperties[s],this._encodings,this._options);else $p(this._renderProperties,this._encodings,this._options);return this};tn.prototype._defaults=WE.default;function $p(s,t,e){t=(0,HE.default)(t);for(var i=0;i<t.length;i++)t[i].options=(0,_h.default)(e,t[i].options),(0,Qy.default)(t[i].options);(0,Qy.default)(e);var r=s.renderer,n=new r(s.element,t,e);n.render(),s.afterRender&&s.afterRender()}typeof window<"u"&&(window.JsBarcode=ff);typeof jQuery<"u"&&(jQuery.fn.JsBarcode=function(s,t){var e=[];return jQuery(this).each(function(){e.push(this)}),ff(e,s,t)});var S9=ff;function Xu(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Xu=function(e){return typeof e}:Xu=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xu(s)}var so=Yv(_e),k9=Yv(S9),hi=Yv(XS);function Yv(s){return s&&s.__esModule?s:{default:s}}function T9(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function A9(s,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function O9(s,t,e){return t&&A9(s.prototype,t),s}function D9(s,t){return t&&(Xu(t)==="object"||typeof t=="function")?t:UE(s)}function qp(s){return qp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qp(s)}function UE(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function L9(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),t&&Gp(s,t)}function Gp(s,t){return Gp=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Gp(s,t)}var Xp,zd=so.default.version.split(/[.-]/);zd[0]==="0"&&(zd[1]==="13"||zd[1]==="12")?Xp=function(t){return t.getDOMNode()}:Xp=function(t){return t};var Jv=function(s){L9(t,s);function t(e){var i;return T9(this,t),i=D9(this,qp(t).call(this,e)),i.renderElementRef=so.default.createRef(),i.update=i.update.bind(UE(i)),i}return O9(t,[{key:"shouldComponentUpdate",value:function(i){var r=this;return Object.keys(t.propTypes).some(function(n){return r.props[n]!==i[n]})}},{key:"componentDidMount",value:function(){this.update()}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"update",value:function(){var i=Xp(this.renderElementRef.current);try{new k9.default(i,this.props.value,Object.assign({},this.props))}catch(r){window.console.error(r)}}},{key:"render",value:function(){var i=this.props,r=i.id,n=i.className;if(this.props.renderer==="svg")return so.default.createElement("svg",{ref:this.renderElementRef,id:r,className:n});if(this.props.renderer==="canvas")return so.default.createElement("canvas",{ref:this.renderElementRef,id:r,className:n});if(this.props.renderer==="img")return so.default.createElement("img",{ref:this.renderElementRef,id:r,className:n})}}]),t}(so.default.Component);Jv.propTypes={value:hi.default.string.isRequired,renderer:hi.default.string,format:hi.default.string,width:hi.default.number,height:hi.default.number,displayValue:hi.default.bool,fontOptions:hi.default.string,font:hi.default.string,textAlign:hi.default.string,textPosition:hi.default.string,textMargin:hi.default.number,fontSize:hi.default.number,background:hi.default.string,lineColor:hi.default.string,margin:hi.default.number,marginTop:hi.default.number,marginBottom:hi.default.number,marginLeft:hi.default.number,marginRight:hi.default.number,id:hi.default.string,className:hi.default.string,ean128:hi.default.bool};Jv.defaultProps={format:"CODE128",renderer:"svg",width:2,height:100,displayValue:!0,fontOptions:"",font:"monospace",textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,className:"",ean128:!1};var R9=Jv;const I9=M1(R9),_9=({value:s})=>Ae.jsx(I9,{value:s,width:1,margin:2,fontSize:10,height:20}),F9=ks(Ae.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),$E=s=>{const t="../"+s;return new URL(t,import.meta.url).href},e1=({value:s,data:t,classes:e,isPanelImage:i})=>{const[r,n]=_e.useState(!1),{laminates:a}=t!=null?t:{},o=!1,l=i,{topLaminateExists:h,topLaminateGrainAngle:u,bottomLaminateExists:c,bottomLaminateGrainAngle:f}=_e.useMemo(()=>{var C,y,x,w,S,E;let p=!1,v=0,g=!1,b=0;if(!a)return{topLaminateExists:!1,topLaminateGrainAngle:0,bottomLaminateExists:!1,bottomLaminateGrainAngle:0};for(const k of a!=null?a:[])k.material||console.warn("no laminate material set for ".concat(s)),k.name==="TOP"&&((C=k.material)!=null&&C.hasGrain)&&(p=!0,v=-((x=(y=k.variables)==null?void 0:y.ST_ANGLEINPANEL)!=null?x:0)),k.name==="BOTTOM"&&((w=k.material)!=null&&w.hasGrain)&&(g=!0,b=-((E=(S=k.variables)==null?void 0:S.ST_ANGLEINPANEL)!=null?E:0));return{topLaminateExists:p,topLaminateGrainAngle:v,bottomLaminateExists:g,bottomLaminateGrainAngle:b}},[a,s]);if(!s)return Ae.jsx(Ae.Fragment,{});const d=$E(s);return Ae.jsxs(mo,{sx:{position:"relative",width:"100%",height:"100%"},children:[l&&Ae.jsx(t1,{topLaminateExists:h,bottomLaminateExists:c,topLaminateGrainAngle:u,bottomLaminateGrainAngle:f,isUltraDarkMode:o}),Ae.jsx("img",{src:d,className:e,style:{filter:"invert(0)",width:"100%",height:"100%",objectFit:"contain",objectPosition:"center",position:"absolute",top:0,left:0,cursor:"pointer"},alt:"Image",onClick:()=>n(!0)}),Ae.jsxs(VS,{open:r,onClose:()=>n(!1),maxWidth:"xl",PaperProps:{sx:{position:"relative",backgroundColor:"black"}},children:[Ae.jsx(no,{"aria-label":"close",onClick:()=>n(!1),sx:{position:"absolute",right:8,top:8,zIndex:10},children:Ae.jsx(F9,{color:"primary"})}),l&&Ae.jsx(t1,{topLaminateExists:h,bottomLaminateExists:c,topLaminateGrainAngle:u,bottomLaminateGrainAngle:f,isUltraDarkMode:o}),Ae.jsx("img",{src:d,alt:"Enlarged",style:{filter:"invert(0)",width:"100%",height:"100%",objectFit:"contain",background:"#000"}})]})]})},t1=({topLaminateExists:s,bottomLaminateExists:t,topLaminateGrainAngle:e,bottomLaminateGrainAngle:i,isUltraDarkMode:r})=>{const n={filter:r?"invert(0.92)":"invert(0)",width:"40%",height:"40%",top:"50%",left:"50%",objectFit:"contain",objectPosition:"center",position:"absolute",transform:"translate(-50%, -50%)",zIndex:2,pointerEvents:"none"},a={...n,width:"35%",height:"35%"};return Ae.jsxs(Ae.Fragment,{children:[s&&Ae.jsx("img",{src:"assets/images/top-grain.png",style:{...n,transform:"".concat(n.transform," rotate(").concat(e,"deg)")}}),t&&Ae.jsx("img",{src:"assets/images/bottom-grain.png",style:{...a,transform:"".concat(a.transform," rotate(").concat(i,"deg)")}})]})},N9=(s,t,e,i)=>M9(t,i),M9=(s,t)=>{if(!i(t)){const o=t.split(".");let l=s;for(const h of o)if(l&&h in l)l=l[h];else{l="&nbsp;";break}return l}let e=r(s,t);return e=n(s,e),e;function i(o){return new RegExp(/(.*?)/g).test(o)}function r(o,l){const h=/\s*?EVAL\s*?\((.*?)\)\s*?([A-Za-z0-9]+)?(?::([A-Za-z0-9]+))?\s*?/g,u=[...l.matchAll(new RegExp(h))];for(const c of u){const f=n(o,c[1]),d=c[2];let p=0;if(d){if(!/^\d+$/.test(d))return"Invalid format: integer places should be digits only";p=d.length}const v=c[3];let g=0;if(v){if(!/^\d+$/.test(v))return"Invalid format: decimal places should be digits only";g=v.length}const b=a(f,p,g);l=l.replace(c[0],b)}return l}function n(o,l){const h=/(.*?)/g,u=[...l.matchAll(new RegExp(h))];for(const c of u){const f=c[1].split(".");let d=o;for(const p of f)if(d&&p in d)d=d[p];else{d="";break}l=l.replace(c[0],d)}return l}function a(o,l,h){const u=/[^-()\d/*+.]/g;o=o.replace(new RegExp(u),"");try{const f=new Function("return "+o)();return l===0&&h===0?f.toString():h===0?Math.round(f).toString().padStart(l,"0"):f.toFixed(h).padStart(l+h+1,"0")}catch(c){return c instanceof Error?console.warn(o,"=>",c.message):console.warn(o,"=>",c),"Invalid expression"}}},P9=({value:s})=>{const t=()=>{window.open(s)};return s&&Ae.jsx(no,{"aria-label":"open pdf",onClick:t,children:Ae.jsx("img",{src:"assets/images/pdf.svg",alt:"pdf icon",style:{width:24,height:24}})})};function B9(){this.__data__=[],this.size=0}var H9=B9;function V9(s,t){return s===t||s!==s&&t!==t}var qE=V9,W9=qE;function z9(s,t){for(var e=s.length;e--;)if(W9(s[e][0],t))return e;return-1}var df=z9,j9=df,U9=Array.prototype,$9=U9.splice;function q9(s){var t=this.__data__,e=j9(t,s);if(e<0)return!1;var i=t.length-1;return e==i?t.pop():$9.call(t,e,1),--this.size,!0}var G9=q9,X9=df;function K9(s){var t=this.__data__,e=X9(t,s);return e<0?void 0:t[e][1]}var Y9=K9,J9=df;function Q9(s){return J9(this.__data__,s)>-1}var Z9=Q9,e7=df;function t7(s,t){var e=this.__data__,i=e7(e,s);return i<0?(++this.size,e.push([s,t])):e[i][1]=t,this}var i7=t7,r7=H9,s7=G9,n7=Y9,a7=Z9,o7=i7;function jo(s){var t=-1,e=s==null?0:s.length;for(this.clear();++t<e;){var i=s[t];this.set(i[0],i[1])}}jo.prototype.clear=r7;jo.prototype.delete=s7;jo.prototype.get=n7;jo.prototype.has=a7;jo.prototype.set=o7;var pf=jo,l7=pf;function h7(){this.__data__=new l7,this.size=0}var u7=h7;function c7(s){var t=this.__data__,e=t.delete(s);return this.size=t.size,e}var f7=c7;function d7(s){return this.__data__.get(s)}var p7=d7;function m7(s){return this.__data__.has(s)}var v7=m7,g7=typeof Kh=="object"&&Kh&&Kh.Object===Object&&Kh,GE=g7,b7=GE,y7=typeof self=="object"&&self&&self.Object===Object&&self,x7=b7||y7||Function("return this")(),Ws=x7,C7=Ws,w7=C7.Symbol,Qv=w7,i1=Qv,XE=Object.prototype,E7=XE.hasOwnProperty,S7=XE.toString,Cl=i1?i1.toStringTag:void 0;function k7(s){var t=E7.call(s,Cl),e=s[Cl];try{s[Cl]=void 0;var i=!0}catch(n){}var r=S7.call(s);return i&&(t?s[Cl]=e:delete s[Cl]),r}var T7=k7,A7=Object.prototype,O7=A7.toString;function D7(s){return O7.call(s)}var L7=D7,r1=Qv,R7=T7,I7=L7,_7="[object Null]",F7="[object Undefined]",s1=r1?r1.toStringTag:void 0;function N7(s){return s==null?s===void 0?F7:_7:s1&&s1 in Object(s)?R7(s):I7(s)}var mf=N7;function M7(s){var t=typeof s;return s!=null&&(t=="object"||t=="function")}var Fh=M7,P7=mf,B7=Fh,H7="[object AsyncFunction]",V7="[object Function]",W7="[object GeneratorFunction]",z7="[object Proxy]";function j7(s){if(!B7(s))return!1;var t=P7(s);return t==V7||t==W7||t==H7||t==z7}var KE=j7,U7=Ws,$7=U7["__core-js_shared__"],q7=$7,jd=q7,n1=function(){var s=/[^.]+$/.exec(jd&&jd.keys&&jd.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function G7(s){return!!n1&&n1 in s}var X7=G7,K7=Function.prototype,Y7=K7.toString;function J7(s){if(s!=null){try{return Y7.call(s)}catch(t){}try{return s+""}catch(t){}}return""}var YE=J7,Q7=KE,Z7=X7,e$=Fh,t$=YE,i$=/[\\^$.*+?()[\]{}|]/g,r$=/^\[object .+?Constructor\]$/,s$=Function.prototype,n$=Object.prototype,a$=s$.toString,o$=n$.hasOwnProperty,l$=RegExp("^"+a$.call(o$).replace(i$,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h$(s){if(!e$(s)||Z7(s))return!1;var t=Q7(s)?l$:r$;return t.test(t$(s))}var u$=h$;function c$(s,t){return s==null?void 0:s[t]}var f$=c$,d$=u$,p$=f$;function m$(s,t){var e=p$(s,t);return d$(e)?e:void 0}var Pa=m$,v$=Pa,g$=Ws,b$=v$(g$,"Map"),Zv=b$,y$=Pa,x$=y$(Object,"create"),vf=x$,a1=vf;function C$(){this.__data__=a1?a1(null):{},this.size=0}var w$=C$;function E$(s){var t=this.has(s)&&delete this.__data__[s];return this.size-=t?1:0,t}var S$=E$,k$=vf,T$="__lodash_hash_undefined__",A$=Object.prototype,O$=A$.hasOwnProperty;function D$(s){var t=this.__data__;if(k$){var e=t[s];return e===T$?void 0:e}return O$.call(t,s)?t[s]:void 0}var L$=D$,R$=vf,I$=Object.prototype,_$=I$.hasOwnProperty;function F$(s){var t=this.__data__;return R$?t[s]!==void 0:_$.call(t,s)}var N$=F$,M$=vf,P$="__lodash_hash_undefined__";function B$(s,t){var e=this.__data__;return this.size+=this.has(s)?0:1,e[s]=M$&&t===void 0?P$:t,this}var H$=B$,V$=w$,W$=S$,z$=L$,j$=N$,U$=H$;function Uo(s){var t=-1,e=s==null?0:s.length;for(this.clear();++t<e;){var i=s[t];this.set(i[0],i[1])}}Uo.prototype.clear=V$;Uo.prototype.delete=W$;Uo.prototype.get=z$;Uo.prototype.has=j$;Uo.prototype.set=U$;var $$=Uo,o1=$$,q$=pf,G$=Zv;function X$(){this.size=0,this.__data__={hash:new o1,map:new(G$||q$),string:new o1}}var K$=X$;function Y$(s){var t=typeof s;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?s!=="__proto__":s===null}var J$=Y$,Q$=J$;function Z$(s,t){var e=s.__data__;return Q$(t)?e[typeof t=="string"?"string":"hash"]:e.map}var gf=Z$,eq=gf;function tq(s){var t=eq(this,s).delete(s);return this.size-=t?1:0,t}var iq=tq,rq=gf;function sq(s){return rq(this,s).get(s)}var nq=sq,aq=gf;function oq(s){return aq(this,s).has(s)}var lq=oq,hq=gf;function uq(s,t){var e=hq(this,s),i=e.size;return e.set(s,t),this.size+=e.size==i?0:1,this}var cq=uq,fq=K$,dq=iq,pq=nq,mq=lq,vq=cq;function $o(s){var t=-1,e=s==null?0:s.length;for(this.clear();++t<e;){var i=s[t];this.set(i[0],i[1])}}$o.prototype.clear=fq;$o.prototype.delete=dq;$o.prototype.get=pq;$o.prototype.has=mq;$o.prototype.set=vq;var gq=$o,bq=pf,yq=Zv,xq=gq,Cq=200;function wq(s,t){var e=this.__data__;if(e instanceof bq){var i=e.__data__;if(!yq||i.length<Cq-1)return i.push([s,t]),this.size=++e.size,this;e=this.__data__=new xq(i)}return e.set(s,t),this.size=e.size,this}var Eq=wq,Sq=pf,kq=u7,Tq=f7,Aq=p7,Oq=v7,Dq=Eq;function qo(s){var t=this.__data__=new Sq(s);this.size=t.size}qo.prototype.clear=kq;qo.prototype.delete=Tq;qo.prototype.get=Aq;qo.prototype.has=Oq;qo.prototype.set=Dq;var Lq=qo;function Rq(s,t){for(var e=-1,i=s==null?0:s.length;++e<i&&t(s[e],e,s)!==!1;);return s}var Iq=Rq,_q=Pa,Fq=function(){try{var s=_q(Object,"defineProperty");return s({},"",{}),s}catch(t){}}(),Nq=Fq,l1=Nq;function Mq(s,t,e){t=="__proto__"&&l1?l1(s,t,{configurable:!0,enumerable:!0,value:e,writable:!0}):s[t]=e}var JE=Mq,Pq=JE,Bq=qE,Hq=Object.prototype,Vq=Hq.hasOwnProperty;function Wq(s,t,e){var i=s[t];(!(Vq.call(s,t)&&Bq(i,e))||e===void 0&&!(t in s))&&Pq(s,t,e)}var QE=Wq,zq=QE,jq=JE;function Uq(s,t,e,i){var r=!e;e||(e={});for(var n=-1,a=t.length;++n<a;){var o=t[n],l=i?i(e[o],s[o],o,e,s):void 0;l===void 0&&(l=s[o]),r?jq(e,o,l):zq(e,o,l)}return e}var bf=Uq;function $q(s,t){for(var e=-1,i=Array(s);++e<s;)i[e]=t(e);return i}var qq=$q;function Gq(s){return s!=null&&typeof s=="object"}var Nh=Gq,Xq=mf,Kq=Nh,Yq="[object Arguments]";function Jq(s){return Kq(s)&&Xq(s)==Yq}var Qq=Jq,h1=Qq,Zq=Nh,ZE=Object.prototype,eG=ZE.hasOwnProperty,tG=ZE.propertyIsEnumerable,iG=h1(function(){return arguments}())?h1:function(s){return Zq(s)&&eG.call(s,"callee")&&!tG.call(s,"callee")},rG=iG,sG=Array.isArray,e0=sG,xc={exports:{}};function nG(){return!1}var aG=nG;xc.exports;(function(s,t){var e=Ws,i=aG,r=t&&!t.nodeType&&t,n=r&&!0&&s&&!s.nodeType&&s,a=n&&n.exports===r,o=a?e.Buffer:void 0,l=o?o.isBuffer:void 0,h=l||i;s.exports=h})(xc,xc.exports);var eS=xc.exports,oG=9007199254740991,lG=/^(?:0|[1-9]\d*)$/;function hG(s,t){var e=typeof s;return t=t==null?oG:t,!!t&&(e=="number"||e!="symbol"&&lG.test(s))&&s>-1&&s%1==0&&s<t}var uG=hG,cG=9007199254740991;function fG(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=cG}var tS=fG,dG=mf,pG=tS,mG=Nh,vG="[object Arguments]",gG="[object Array]",bG="[object Boolean]",yG="[object Date]",xG="[object Error]",CG="[object Function]",wG="[object Map]",EG="[object Number]",SG="[object Object]",kG="[object RegExp]",TG="[object Set]",AG="[object String]",OG="[object WeakMap]",DG="[object ArrayBuffer]",LG="[object DataView]",RG="[object Float32Array]",IG="[object Float64Array]",_G="[object Int8Array]",FG="[object Int16Array]",NG="[object Int32Array]",MG="[object Uint8Array]",PG="[object Uint8ClampedArray]",BG="[object Uint16Array]",HG="[object Uint32Array]",Qt={};Qt[RG]=Qt[IG]=Qt[_G]=Qt[FG]=Qt[NG]=Qt[MG]=Qt[PG]=Qt[BG]=Qt[HG]=!0;Qt[vG]=Qt[gG]=Qt[DG]=Qt[bG]=Qt[LG]=Qt[yG]=Qt[xG]=Qt[CG]=Qt[wG]=Qt[EG]=Qt[SG]=Qt[kG]=Qt[TG]=Qt[AG]=Qt[OG]=!1;function VG(s){return mG(s)&&pG(s.length)&&!!Qt[dG(s)]}var WG=VG;function zG(s){return function(t){return s(t)}}var t0=zG,Cc={exports:{}};Cc.exports;(function(s,t){var e=GE,i=t&&!t.nodeType&&t,r=i&&!0&&s&&!s.nodeType&&s,n=r&&r.exports===i,a=n&&e.process,o=function(){try{var l=r&&r.require&&r.require("util").types;return l||a&&a.binding&&a.binding("util")}catch(h){}}();s.exports=o})(Cc,Cc.exports);var i0=Cc.exports,jG=WG,UG=t0,u1=i0,c1=u1&&u1.isTypedArray,$G=c1?UG(c1):jG,qG=$G,GG=qq,XG=rG,KG=e0,YG=eS,JG=uG,QG=qG,ZG=Object.prototype,eX=ZG.hasOwnProperty;function tX(s,t){var e=KG(s),i=!e&&XG(s),r=!e&&!i&&YG(s),n=!e&&!i&&!r&&QG(s),a=e||i||r||n,o=a?GG(s.length,String):[],l=o.length;for(var h in s)(t||eX.call(s,h))&&!(a&&(h=="length"||r&&(h=="offset"||h=="parent")||n&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||JG(h,l)))&&o.push(h);return o}var iS=tX,iX=Object.prototype;function rX(s){var t=s&&s.constructor,e=typeof t=="function"&&t.prototype||iX;return s===e}var r0=rX;function sX(s,t){return function(e){return s(t(e))}}var rS=sX,nX=rS,aX=nX(Object.keys,Object),oX=aX,lX=r0,hX=oX,uX=Object.prototype,cX=uX.hasOwnProperty;function fX(s){if(!lX(s))return hX(s);var t=[];for(var e in Object(s))cX.call(s,e)&&e!="constructor"&&t.push(e);return t}var dX=fX,pX=KE,mX=tS;function vX(s){return s!=null&&mX(s.length)&&!pX(s)}var sS=vX,gX=iS,bX=dX,yX=sS;function xX(s){return yX(s)?gX(s):bX(s)}var s0=xX,CX=bf,wX=s0;function EX(s,t){return s&&CX(t,wX(t),s)}var SX=EX;function kX(s){var t=[];if(s!=null)for(var e in Object(s))t.push(e);return t}var TX=kX,AX=Fh,OX=r0,DX=TX,LX=Object.prototype,RX=LX.hasOwnProperty;function IX(s){if(!AX(s))return DX(s);var t=OX(s),e=[];for(var i in s)i=="constructor"&&(t||!RX.call(s,i))||e.push(i);return e}var _X=IX,FX=iS,NX=_X,MX=sS;function PX(s){return MX(s)?FX(s,!0):NX(s)}var n0=PX,BX=bf,HX=n0;function VX(s,t){return s&&BX(t,HX(t),s)}var WX=VX,wc={exports:{}};wc.exports;(function(s,t){var e=Ws,i=t&&!t.nodeType&&t,r=i&&!0&&s&&!s.nodeType&&s,n=r&&r.exports===i,a=n?e.Buffer:void 0,o=a?a.allocUnsafe:void 0;function l(h,u){if(u)return h.slice();var c=h.length,f=o?o(c):new h.constructor(c);return h.copy(f),f}s.exports=l})(wc,wc.exports);var zX=wc.exports;function jX(s,t){var e=-1,i=s.length;for(t||(t=Array(i));++e<i;)t[e]=s[e];return t}var UX=jX;function $X(s,t){for(var e=-1,i=s==null?0:s.length,r=0,n=[];++e<i;){var a=s[e];t(a,e,s)&&(n[r++]=a)}return n}var qX=$X;function GX(){return[]}var nS=GX,XX=qX,KX=nS,YX=Object.prototype,JX=YX.propertyIsEnumerable,f1=Object.getOwnPropertySymbols,QX=f1?function(s){return s==null?[]:(s=Object(s),XX(f1(s),function(t){return JX.call(s,t)}))}:KX,a0=QX,ZX=bf,eK=a0;function tK(s,t){return ZX(s,eK(s),t)}var iK=tK;function rK(s,t){for(var e=-1,i=t.length,r=s.length;++e<i;)s[r+e]=t[e];return s}var aS=rK,sK=rS,nK=sK(Object.getPrototypeOf,Object),oS=nK,aK=aS,oK=oS,lK=a0,hK=nS,uK=Object.getOwnPropertySymbols,cK=uK?function(s){for(var t=[];s;)aK(t,lK(s)),s=oK(s);return t}:hK,lS=cK,fK=bf,dK=lS;function pK(s,t){return fK(s,dK(s),t)}var mK=pK,vK=aS,gK=e0;function bK(s,t,e){var i=t(s);return gK(s)?i:vK(i,e(s))}var hS=bK,yK=hS,xK=a0,CK=s0;function wK(s){return yK(s,CK,xK)}var EK=wK,SK=hS,kK=lS,TK=n0;function AK(s){return SK(s,TK,kK)}var OK=AK,DK=Pa,LK=Ws,RK=DK(LK,"DataView"),IK=RK,_K=Pa,FK=Ws,NK=_K(FK,"Promise"),MK=NK,PK=Pa,BK=Ws,HK=PK(BK,"Set"),VK=HK,WK=Pa,zK=Ws,jK=WK(zK,"WeakMap"),UK=jK,Kp=IK,Yp=Zv,Jp=MK,Qp=VK,Zp=UK,uS=mf,Go=YE,d1="[object Map]",$K="[object Object]",p1="[object Promise]",m1="[object Set]",v1="[object WeakMap]",g1="[object DataView]",qK=Go(Kp),GK=Go(Yp),XK=Go(Jp),KK=Go(Qp),YK=Go(Zp),ta=uS;(Kp&&ta(new Kp(new ArrayBuffer(1)))!=g1||Yp&&ta(new Yp)!=d1||Jp&&ta(Jp.resolve())!=p1||Qp&&ta(new Qp)!=m1||Zp&&ta(new Zp)!=v1)&&(ta=function(s){var t=uS(s),e=t==$K?s.constructor:void 0,i=e?Go(e):"";if(i)switch(i){case qK:return g1;case GK:return d1;case XK:return p1;case KK:return m1;case YK:return v1}return t});var o0=ta,JK=Object.prototype,QK=JK.hasOwnProperty;function ZK(s){var t=s.length,e=new s.constructor(t);return t&&typeof s[0]=="string"&&QK.call(s,"index")&&(e.index=s.index,e.input=s.input),e}var eY=ZK,tY=Ws,iY=tY.Uint8Array,rY=iY,b1=rY;function sY(s){var t=new s.constructor(s.byteLength);return new b1(t).set(new b1(s)),t}var l0=sY,nY=l0;function aY(s,t){var e=t?nY(s.buffer):s.buffer;return new s.constructor(e,s.byteOffset,s.byteLength)}var oY=aY,lY=/\w*$/;function hY(s){var t=new s.constructor(s.source,lY.exec(s));return t.lastIndex=s.lastIndex,t}var uY=hY,y1=Qv,x1=y1?y1.prototype:void 0,C1=x1?x1.valueOf:void 0;function cY(s){return C1?Object(C1.call(s)):{}}var fY=cY,dY=l0;function pY(s,t){var e=t?dY(s.buffer):s.buffer;return new s.constructor(e,s.byteOffset,s.length)}var mY=pY,vY=l0,gY=oY,bY=uY,yY=fY,xY=mY,CY="[object Boolean]",wY="[object Date]",EY="[object Map]",SY="[object Number]",kY="[object RegExp]",TY="[object Set]",AY="[object String]",OY="[object Symbol]",DY="[object ArrayBuffer]",LY="[object DataView]",RY="[object Float32Array]",IY="[object Float64Array]",_Y="[object Int8Array]",FY="[object Int16Array]",NY="[object Int32Array]",MY="[object Uint8Array]",PY="[object Uint8ClampedArray]",BY="[object Uint16Array]",HY="[object Uint32Array]";function VY(s,t,e){var i=s.constructor;switch(t){case DY:return vY(s);case CY:case wY:return new i(+s);case LY:return gY(s,e);case RY:case IY:case _Y:case FY:case NY:case MY:case PY:case BY:case HY:return xY(s,e);case EY:return new i;case SY:case AY:return new i(s);case kY:return bY(s);case TY:return new i;case OY:return yY(s)}}var WY=VY,zY=Fh,w1=Object.create,jY=function(){function s(){}return function(t){if(!zY(t))return{};if(w1)return w1(t);s.prototype=t;var e=new s;return s.prototype=void 0,e}}(),UY=jY,$Y=UY,qY=oS,GY=r0;function XY(s){return typeof s.constructor=="function"&&!GY(s)?$Y(qY(s)):{}}var KY=XY,YY=o0,JY=Nh,QY="[object Map]";function ZY(s){return JY(s)&&YY(s)==QY}var eJ=ZY,tJ=eJ,iJ=t0,E1=i0,S1=E1&&E1.isMap,rJ=S1?iJ(S1):tJ,sJ=rJ,nJ=o0,aJ=Nh,oJ="[object Set]";function lJ(s){return aJ(s)&&nJ(s)==oJ}var hJ=lJ,uJ=hJ,cJ=t0,k1=i0,T1=k1&&k1.isSet,fJ=T1?cJ(T1):uJ,dJ=fJ,pJ=Lq,mJ=Iq,vJ=QE,gJ=SX,bJ=WX,yJ=zX,xJ=UX,CJ=iK,wJ=mK,EJ=EK,SJ=OK,kJ=o0,TJ=eY,AJ=WY,OJ=KY,DJ=e0,LJ=eS,RJ=sJ,IJ=Fh,_J=dJ,FJ=s0,NJ=n0,MJ=1,PJ=2,BJ=4,cS="[object Arguments]",HJ="[object Array]",VJ="[object Boolean]",WJ="[object Date]",zJ="[object Error]",fS="[object Function]",jJ="[object GeneratorFunction]",UJ="[object Map]",$J="[object Number]",dS="[object Object]",qJ="[object RegExp]",GJ="[object Set]",XJ="[object String]",KJ="[object Symbol]",YJ="[object WeakMap]",JJ="[object ArrayBuffer]",QJ="[object DataView]",ZJ="[object Float32Array]",eQ="[object Float64Array]",tQ="[object Int8Array]",iQ="[object Int16Array]",rQ="[object Int32Array]",sQ="[object Uint8Array]",nQ="[object Uint8ClampedArray]",aQ="[object Uint16Array]",oQ="[object Uint32Array]",Kt={};Kt[cS]=Kt[HJ]=Kt[JJ]=Kt[QJ]=Kt[VJ]=Kt[WJ]=Kt[ZJ]=Kt[eQ]=Kt[tQ]=Kt[iQ]=Kt[rQ]=Kt[UJ]=Kt[$J]=Kt[dS]=Kt[qJ]=Kt[GJ]=Kt[XJ]=Kt[KJ]=Kt[sQ]=Kt[nQ]=Kt[aQ]=Kt[oQ]=!0;Kt[zJ]=Kt[fS]=Kt[YJ]=!1;function Ku(s,t,e,i,r,n){var a,o=t&MJ,l=t&PJ,h=t&BJ;if(e&&(a=r?e(s,i,r,n):e(s)),a!==void 0)return a;if(!IJ(s))return s;var u=DJ(s);if(u){if(a=TJ(s),!o)return xJ(s,a)}else{var c=kJ(s),f=c==fS||c==jJ;if(LJ(s))return yJ(s,o);if(c==dS||c==cS||f&&!r){if(a=l||f?{}:OJ(s),!o)return l?wJ(s,bJ(a,s)):CJ(s,gJ(a,s))}else{if(!Kt[c])return r?s:{};a=AJ(s,c,o)}}n||(n=new pJ);var d=n.get(s);if(d)return d;n.set(s,a),_J(s)?s.forEach(function(g){a.add(Ku(g,t,e,g,s,n))}):RJ(s)&&s.forEach(function(g,b){a.set(b,Ku(g,t,e,b,s,n))});var p=h?l?SJ:EJ:l?NJ:FJ,v=u?void 0:p(s);return mJ(v||s,function(g,b){v&&(b=g,g=s[b]),vJ(a,b,Ku(g,t,e,b,s,n))}),a}var lQ=Ku,hQ=lQ,uQ=1,cQ=4;function fQ(s){return hQ(s,uQ|cQ)}var dQ=fQ;const pQ=M1(dQ),mQ=({value:s})=>{if(!(s===0||s===void 0))return Ae.jsxs(mo,{className:"badge-number",sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:25,height:25,borderRadius:"50%",backgroundColor:t=>ns(t.palette.primary.main,.7),border:"2px solid",borderColor:"rgb(25, 118, 210)",color:"white",fontSize:12,fontWeight:"bold",flexShrink:0},children:[s,Ae.jsx("style",{children:"\n			@media print {\n				.badge-number {\n					background-color: white !important;\n					color:black;\n					border-color: gray;\n				}\n			}\n        "})]})},vQ=(s,t=!1)=>{var C,y,x,w,S,E,k,A,z,D,T,M,K;const e="4,4",n="lightgrey",a=t?"gray":"black",o=5,l=s.edgebandBack?"solid":"dashed",h=s.edgebandFront?"solid":"dashed",u=s.edgebandLeft?"solid":"dashed",c=s.edgebandRight?"solid":"dashed",f=(x=(y=(C=s.edgebandBack)==null?void 0:C.material)==null?void 0:y.color)!=null?x:a,d=(E=(S=(w=s.edgebandFront)==null?void 0:w.material)==null?void 0:S.color)!=null?E:a,p=(z=(A=(k=s.edgebandLeft)==null?void 0:k.material)==null?void 0:A.color)!=null?z:a,v=(M=(T=(D=s.edgebandRight)==null?void 0:D.material)==null?void 0:T.color)!=null?M:a,g=((K=s.edgebands)!=null?K:[]).some(te=>te.position===""||te.isCurved),b=(te,ee,J,re,j,de,we=!1)=>{const N=j==="dashed",H=N?o:o*1.2;return we?'<line x1="'.concat(te,'" y1="').concat(ee,'" x2="').concat(J,'" y2="').concat(re,'"\n		stroke="').concat(de,'" stroke-width="').concat(H*.5,'"\n		').concat(N?'stroke-dasharray="'.concat(e,'"'):""," />"):'<line x1="'.concat(te,'" y1="').concat(ee,'" x2="').concat(J,'" y2="').concat(re,'"\n        stroke="').concat(de,'" stroke-width="').concat(H,'"\n        ').concat(N?'stroke-dasharray="'.concat(e,'"'):""," />")};return'\n    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="25">\n\n	<style>\n        @media print {\n            line {\n                stroke: black !important;\n            }\n        }\n    </style>\n\n		<!-- Miscellaneous Edgeband -->\n		'.concat(g?b(0,25,30,0,"solid","black",!0):"","\n\n        <!-- Dashed lines -->\n		").concat(l==="dashed"?b(0,0,30,0,"dashed",n):"","\n		").concat(c==="dashed"?b(30,0,30,25,"dashed",n):"","\n		").concat(h==="dashed"?b(30,25,0,25,"dashed",n):"","\n		").concat(u==="dashed"?b(0,25,0,0,"dashed",n):"","\n\n        <!-- Solid lines -->\n		").concat(l==="solid"?b(0,0,30,0,"solid",f):"","\n		").concat(c==="solid"?b(30,0,30,25,"solid",v):"","\n		").concat(h==="solid"?b(30,25,0,25,"solid",d):"","\n		").concat(u==="solid"?b(0,25,0,0,"solid",p):"","\n\n	</svg>").trim()};function gQ(s,t){if(!s||s.angle===null)return"";const n=s.angle;return'\n<style>\n	@media print {\n		polygon { fill: #000000 !important; }\n	}\n</style>\n<svg fill="'.concat(t?"gray":"#000000",'" height="25px" width="25px" version="1.1"\n	xmlns="http://www.w3.org/2000/svg" viewBox="0 0 492.426 492.426">\n\n	\n	<g transform="rotate(').concat(n,", ").concat(246.213,", ").concat(246.213,')">\n		<polygon points="411.819,165.606 390.606,186.82 435.019,231.232 57.407,231.232 101.819,186.82 80.606,165.606 \n		0,246.213 80.606,326.82 101.819,305.606 57.445,261.232 434.981,261.232 390.606,305.606 411.819,326.82 492.426,246.213" />\n	</g>\n</svg>\n').trim()}const bQ=(s,t,e,i)=>{const r=i.parser;return r?r.evaluate(i.field,t):"parser missing"},pS=s=>!/^[a-zA-Z_][a-zA-Z0-9_]*(\.[a-zA-Z_][a-zA-Z0-9_]*)*$/.test(s),yQ=(s,t)=>{var l,h,u,c;const e=(l=t==null?void 0:t.delimiter)!=null?l:"",i=(h=t==null?void 0:t.order)!=null?h:!1,r=(u=t==null?void 0:t.reverse)!=null?u:!1;s.edgebands!=null&&s.edgebands.sort((f,d)=>f.order-d.order);const n=[];for(const f of(c=s.edgebands)!=null?c:[])!f.isPaint&&!f.isCurved?f.lengthStock===s.lengthStock?s.lengthStock>s.widthStock?n.push("L"):n.push("S"):f.lengthStock==s.widthStock?s.lengthStock>s.widthStock?n.push("S"):n.push("L"):(console.warn("Unable to categorise EB in: "+s.name),n.push("U")):!f.isPaint&&f.isCurved&&n.push("C");let a="";for(let f=0;f<n.length;f++){let d=1;for(;n[f]==n[f+1];)d++,f++;a+=d+n[f],f!=n.length-1&&(a+=e)}if(i)return a;n.sort(),r&&n.reverse();let o="";for(let f=0;f<n.length;f++){let d=1;for(;n[f]===n[f+1];)d++,f++;o+=d+n[f],f!=n.length-1&&(o+=e)}return o},xQ=(s,t)=>{var a;if(!Array.isArray(s))return s;const e=(a=t==null?void 0:t.delimiter)!=null?a:", ",i=t==null?void 0:t.valueMap,r=i?s.map(o=>im(i,o)):s;return(t.removeDuplicates?[...new Set(r)]:r).join(e)},CQ=(s,t)=>{if(typeof s!="string"||!(t!=null&&t.trimString))return s;const{trimString:e,instance:i=1,keepSide:r="left",trimWhitespace:n=!0}=t,a=[];let o=0;for(;;){const u=s.indexOf(e,o);if(u===-1)break;a.push(u),o=u+e.length}if(a.length===0)return s;let l;if(i>0)l=a[i-1];else{const u=Math.abs(i);l=a[a.length-u]}if(l===void 0)return s;const h=r==="left"?s.slice(0,l):s.slice(l+e.length);return n?h.trim():h},A1=(s,t)=>{s=Math.round(s/t)*t;const e=Math.floor(s),i=s-e;if(i===0)return e;const r=[2,4,8,16,32,64];for(const n of r){const a=Math.round(i*n);if(Math.abs(i*n-a)<1e-6)return e===0?"<sup>".concat(a,"</sup>&frasl;<sub>").concat(n,"</sub>"):"".concat(e,"&nbsp;<sup>").concat(a,"</sup>&frasl;<sub>").concat(n,"</sub>")}return s},GQ=(s,t)=>{s=Math.round(s/t)*t;const e=Math.floor(s),i=s-e;if(i===0)return{integer:e,numerator:0,denominator:1,formatted:"".concat(e)};const r=[2,4,8,16,32,64];for(const n of r){const a=Math.round(i*n);if(Math.abs(i*n-a)<1e-6){const o=e===0?"<sup>".concat(a,"</sup>&frasl;<sub>").concat(n,"</sub>"):"".concat(e,"&nbsp;<sup>").concat(a,"</sup>&frasl;<sub>").concat(n,"</sub>");return{integer:e,numerator:a,denominator:n,formatted:o}}}return{value:s}},wQ=(s,t,e,i=!1)=>{var u,c,f,d,p,v,g,b,C,y,x,w;const r=wn.hasInstance()?wn.getInstance():null,n=(u=r==null?void 0:r.dimensionProperties)!=null?u:[],a=(d=(f=(c=r==null?void 0:r.dataSettings)==null?void 0:c.units)==null?void 0:f.roundToNearest)!=null?d:1,o=(g=(v=(p=r==null?void 0:r.dataSettings)==null?void 0:p.units)==null?void 0:v.imperialFractions)!=null?g:!1;let l=40;const h=[];for(const S of s){const E=pQ(S);E.width==="auto"&&delete E.width;const k=E.width?E.width==="auto"?void 0:E.width:void 0,A={title:"",hozAlign:"left"};switch(pS((b=E.field)!=null?b:"")&&(A.mutator=bQ,A.mutatorParams={field:E.field,parser:t},A.editor=void 0),new RegExp(/(.*?)/g).test((C=E.field)!=null?C:"")&&(A.mutator=N9,A.mutatorParams=E.field,A.editor=void 0),E.formatter){case"tickCross":A.hozAlign="center",A.headerHozAlign="center",A.vertAlign="middle",(y=E.formatterParams)!=null&&y.disableCrossElement&&(E.formatterParams={...E.formatterParams,crossElement:""}),E.editor==="tickCross"&&(delete E.editor,A.cellClick=(D,T)=>{D.preventDefault(),T.setValue(!T.getValue())});break;case"image":l=Math.max(typeof k=="number"?k:0,l),A.hozAlign="center",A.vertAlign="middle",A.formatterParams={...(x=E.formatterParams)!=null?x:{}},A.formatterParams.height=l+"px",A.formatterParams.width=l+"px",delete E.formatter,A.formatter=kQ;break;case"link":delete E.formatter,A.formatter=TQ;break;case"money":A.hozAlign="right",A.headerHozAlign="right";break;case"edging":A.formatter=D=>vQ(D.getData(),i),A.headerSort=!1,A.vertAlign="middle",delete E.formatter,delete E.formatterParams;break;case"edgingCode":A.formatter=D=>yQ(D.getData(),E.formatterParams),A.headerSort=!1,delete E.formatter;break;case"grain":A.formatter=D=>gQ(D.getData(),i),A.vertAlign="middle",delete E.formatter,delete E.formatterParams;break;case"fraction":A.formatter=D=>{var M,K;const T=A1(D.getValue(),(K=(M=E.formatterParams)==null?void 0:M.roundToNearest)!=null?K:1);return typeof T=="number"?T.toString():T},delete E.formatter;break;case"number":A.hozAlign="right",A.headerHozAlign="right",A.formatter="money",A.formatterParams=E.formatterParams,delete E.formatter,delete E.formatterParams;break;case"qrcode":delete E.formatter,l=Math.max(typeof k=="number"?k:0,l),A.hozAlign="center",A.vertAlign="middle",A.formatter=D=>{const T=document.createElement("div"),M=D.getValue();return jn.createRoot(T).render(Ae.jsx(Hy,{contents:M,size:typeof k=="number"?k:0})),T},A.formatterPrint=D=>{const T=document.createElement("div"),M=D.getValue();return jn.createRoot(T).render(Ae.jsx(Hy,{contents:M,size:typeof k=="number"?k:0})),T};break;case"list":delete E.formatter,A.formatter=D=>xQ(D.getValue(),E.formatterParams);break;case"trim":delete E.formatter,A.formatter=D=>CQ(D.getValue(),E.formatterParams);break;case"badge":delete E.formatter,A.hozAlign="center",A.vertAlign="middle",A.formatter=D=>{const T=document.createElement("div"),M=D.getValue();return jn.createRoot(T).render(Ae.jsx(mQ,{value:M})),T};break;case"barcode":delete E.formatter,A.hozAlign="center",A.vertAlign="middle",A.formatter=D=>{const T=document.createElement("div"),M=D.getValue();return jn.createRoot(T).render(Ae.jsx(_9,{value:M})),T};break;case"imageComponent":delete E.formatter,l=Math.max(typeof k=="number"?k:0,l),A.hozAlign="center",A.vertAlign="middle",A.formatter=D=>{const T=D.getData(),M=D.getValue(),K=document.createElement("div");return K.style.height="".concat(l,"px"),K.style.width="".concat(l,"px"),jn.createRoot(K).render(Ae.jsx(e1,{value:M,data:T})),K},A.formatterPrint=D=>{const T=D.getValue(),M=D.getData(),K=document.createElement("div");return K.style.height="".concat(l-100,"px"),K.style.width="".concat(l-100,"px"),jn.createRoot(K).render(Ae.jsx(e1,{value:T,data:M})),K};break;case"component":delete E.formatter,A.formatterParams={...(w=E.formatterParams)!=null?w:{}},A.formatter=D=>{var te,ee;const T=D.getData(),M=D.getValue(),K=20;return T.resource==="parts"?'<img src="assets/images/icon-part.png" alt="part icon" width="'.concat(K,'" height="').concat(K,'" /> &nbsp; ').concat(M):T.resource==="assemblies"?'<img src="assets/images/icon-assembly.png" alt="assembly icon" width="'.concat(K,'" height="').concat(K,'" /> &nbsp; ').concat(M):((te=T.variables)==null?void 0:te.SWMODELTYPE)===1?'<img src="assets/images/icon-part.png" alt="part icon" width="'.concat(K,'" height="').concat(K,'" /> &nbsp; ').concat(M):((ee=T.variables)==null?void 0:ee.SWMODELTYPE)===2?'<img src="assets/images/icon-assembly.png" alt="part icon" width="'.concat(K,'" height="').concat(K,'" /> &nbsp; ').concat(M):M};break;case"pdf":delete E.formatter,A.vertAlign="middle",A.formatter=D=>{const T=D.getValue(),M=D.getData(),K=D.getField(),te=K.substring(0,K.lastIndexOf(".")),ee=im(te,M);if(!(ee!=null&&ee.exists))return"";const J=document.createElement("div");return J.style.height="".concat(l-100,"px"),J.style.width="".concat(l-100,"px"),jn.createRoot(J).render(Ae.jsx(P9,{value:T})),J};break;default:E.field!=="quantityInParent"?A.formatter=D=>{const T=D.getValue();return T?typeof T=="number"&&o&&n.includes(D.getField())?A1(T,a):T:""}:A.formatter=D=>AQ(D,e);break}const z={...A,...E};h.push(z)}return{processedColumns:h,rowHeight:l}},EQ=(s,t)=>t.replace(/\[(\w+)\]/g,".$1").split(".").reduce((i,r)=>{if(i&&typeof i=="object"&&r in i)return i[r]},s),SQ=(s,t)=>{let e=!1;const i=s.replace(/:([a-zA-Z0-9_.[\]]+)/g,(r,n)=>{const a=EQ(t,n);return a===void 0?(e=!0,""):encodeURIComponent(String(a))});return e?null:i},kQ=(s,t)=>{const e=document.createElement("img");let i=s.getValue();switch(i=$E(i),t.urlPrefix&&(i=t.urlPrefix+s.getValue()),t.urlSuffix&&(i=i+t.urlSuffix),e.setAttribute("src",i),typeof t.height){case"number":e.style.height=t.height+"px";break;case"string":e.style.height=t.height;break}switch(typeof t.width){case"number":e.style.width=t.width+"px";break;case"string":e.style.width=t.width;break}return e.addEventListener("load",function(){s.getRow().normalizeHeight()}),e},TQ=(s,t)=>{var d,p,v,g;const e=s.getValue(),i=s.getData();s.getRow().getTreeParent()!==!1&&t.urlChildren&&(t.url=t.urlChildren);let o=(d=t==null?void 0:t.label)!=null?d:e;t!=null&&t.labelField&&i[t.labelField]!==void 0&&(o=i[t.labelField]);const l=(p=t==null?void 0:t.target)!=null?p:"",h=t!=null&&t.urlField&&(i!=null&&i[t.urlField])?i[t.urlField]:(v=t==null?void 0:t.url)!=null?v:"";let u=SQ(h,i);if(!u)return o;const c=(g=t.urlPrefix)!=null?g:"#";u="".concat(c).concat(u);let f="";return(t==null?void 0:t.download)!==void 0&&(t.download===!0?f=" download":typeof t.download=="string"&&(f=' download="'.concat(t.download,'"'))),'<a href="'.concat(u,'" target="').concat(l,'" rel="noopener noreferrer"').concat(f,">").concat(o,"</a>")},AQ=(s,t)=>{var r,n;const e=s.getData();if(!t)return(r=e.quantity)!=null?r:0;const i=(n=e.refQuantities)==null?void 0:n.find(a=>a.key===t);return i?i.quantity:0},OQ=ks(Ae.jsx("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3m-3 11H8v-5h8zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m-1-9H6v4h12z"}),"Print"),DQ=ks(Ae.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10H7v-2h10z"}),"IndeterminateCheckBox"),LQ=ks(Ae.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"}),"AddBox"),RQ=ks(Ae.jsx("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download"),IQ=ks([Ae.jsx("path",{d:"M6 8.83V20h12V4h-7.17zm5 .19L13 9v4h3l-4 4-4-4h3z",opacity:".3"},"0"),Ae.jsx("path",{d:"M18 2h-8L4 8v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 18H6V8.83L10.83 4H18z"},"1"),Ae.jsx("path",{d:"m12 17 4-4h-3V9l-2 .02V13H8z"},"2")],"SimCardDownloadTwoTone"),_Q=({data:s,header:t,handlePrint:e,handleDownload:i,handleCSVDownload:r,hasExpandables:n,expanded:a,handleExpandCollapse:o,setFilter:l,search:h,resource:u,displayResults:c,settings:f})=>{const d=s?s.length:[],p=c?s==null?void 0:s.reduce((v,g)=>"quantity"in g&&typeof g.quantity=="number"?v+g.quantity:v,0):0;return Ae.jsx(WS,{variant:"outlined",sx:{px:2,backgroundColor:"rgba(0, 0, 0, 0.1)",borderBottom:"none",borderBottomLeftRadius:0,borderBottomRightRadius:0,height:40,pageBreakInside:"avoid"},children:Ae.jsxs(Qh,{container:!0,alignItems:"center",sx:{height:"100%"},children:[Ae.jsx(Qh,{item:!0,xs:4,children:Ae.jsxs(mo,{className:"no-print",sx:{height:"100%",display:"flex",alignItems:"center"},children:[h&&Ae.jsx(sV,{setFilter:l}),n&&Ae.jsx(no,{sx:{m:0,width:18,height:18},className:"no-print",color:"inherit","aria-label":"open drawer",onClick:o,edge:"start",title:"expand/collapse",children:a?Ae.jsx(DQ,{color:"primary",sx:{width:18}}):Ae.jsx(LQ,{color:"primary",sx:{width:18}})})]})}),Ae.jsx(Qh,{item:!0,xs:4,children:Ae.jsxs(mo,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:[Ae.jsx(I0,{title:u,placement:"top",slotProps:{tooltip:{sx:{fontSize:"0.875rem"}}},children:Ae.jsx(Ll,{variant:"h6",sx:{fontWeight:"bold",m:0},children:t})}),(f==null?void 0:f.initialFilter)&&Ae.jsx(I0,{title:Ae.jsx("pre",{style:{margin:0},children:JSON.stringify(f==null?void 0:f.initialFilter,null,2)}),placement:"top",slotProps:{tooltip:{sx:{fontSize:"0.75rem",maxWidth:400,whiteSpace:"pre-wrap",wordBreak:"break-word"}}},children:Ae.jsx(Ll,{className:"no-print",sx:{cursor:"pointer",ml:.25},children:"*"})})]})}),Ae.jsx(Qh,{item:!0,xs:4,children:Ae.jsxs(mo,{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:1,sx:{height:"100%"},children:[Ae.jsx(Ll,{sx:{m:0,fontStyle:"italic",fontSize:"0.9em",color:"GrayText",textWrap:"nowrap"},children:c&&Ae.jsxs(Ae.Fragment,{children:[d," ",d===1?"item":"items",p>0&&"  ".concat(p," ").concat(p===1?"instance":"instances")]})}),Ae.jsx(no,{sx:{m:0,px:1.5,py:0,width:26,height:26},className:"no-print",color:"inherit",title:"download csv file","aria-label":"download csv file",onClick:r,edge:"start",children:Ae.jsx(IQ,{color:"primary"})}),Ae.jsx(no,{sx:{m:0,px:1.5,py:0,width:26,height:26},className:"no-print",color:"inherit",title:"download excel file","aria-label":"download excel file",onClick:i,edge:"start",children:Ae.jsx(RQ,{color:"primary"})}),Ae.jsx(no,{sx:{m:0,px:1.5,py:0,width:26,height:26},className:"no-print",color:"inherit",title:"print table","aria-label":"print table",onClick:e,edge:"start",children:Ae.jsx(OQ,{color:"primary"})})]})})]})})},FQ=async(s,t,e)=>{await zS.system_report.where("id").equals(s).modify(i=>{const r=t.split(".").map(a=>a.trim()).filter(Boolean),n=(a,o)=>{if(o.length===0)return;const[l,...h]=o,u=l.match(/^(\w+)\[(\w+)=(.+)\]$/);if(u){const[,f,d,p]=u,v=p;Array.isArray(a[f])||(a[f]=[]);const g=a[f];let b=!1;for(let C=0;C<g.length;C++)g[C]&&g[C][d]===v&&(b=!0,h.length===0?g[C]=e:n(g[C],h));if(!b){const C={[d]:v};h.length===0?g.push(e):(g.push(C),n(C,h))}return}const c=l.match(/^(\w+)\[(\d+)\]$/);if(c){const[,f,d]=c,p=Number(d);Array.isArray(a[f])||(a[f]=[]);const v=a[f];v[p]||(v[p]={}),h.length===0?v[p]=e:n(v[p],h);return}if(h.length===0){a[l]=e;return}(a[l]==null||typeof a[l]!="object")&&(a[l]={}),n(a[l],h)};(!i.data||typeof i.data!="object")&&(i.data={}),n(i.data,r)})};class NQ{constructor(t){Ne(this,"data");Ne(this,"groupCounter",{});Ne(this,"defaultValues",{parentCalculations:[],flattenSingleChildGroups:!0,ignoreEmptyGroupKey:!1,flattenEmptyGroupKey:!0});this.data=t}build(t=[],e){if(!t.length)return[...this.data];this.groupCounter={};let i=this.data;for(let r=0;r<t.length;r++)i=this.groupLevel(i,t[r],r,e);return i}groupLevel(t,e,i,r){var l,h,u;const n=e.field,a=new Map,o=[];e={...this.defaultValues,...e},t.forEach(c=>{var p;const f=this.getFieldValue(c,n,(p=e.parser)!=null?p:r);if(e.ignoreEmptyGroupKey&&(f===""||f==null))return;if(e.flattenEmptyGroupKey&&(f===""||f==null)){o.push(c);return}const d=a.get(f!=null?f:"")||[];d.push(c),a.set(f!=null?f:"",d)});for(const[c,f]of a){const d=f;if(((l=e.flattenSingleChildGroups)!=null?l:e.flattenSingleChildGroups)&&f.length===1){o.push(f[0]);continue}this.groupCounter[e.field]=(h=this.groupCounter[e.field])!=null?h:0,this.groupCounter[e.field]++;const v={isGroup:!0,_children:d,counter:this.groupCounter[e.field]},g=f[0];for(const b of Object.keys(g)){const C=this.CalculationField(b,f,e);v[b]=C!==void 0?C:this.safeClone(g[b])}(u=e.parentValues)==null||u.forEach(b=>{var S;const C=b.field;let y=!0,x=[];if(b.ifChildrenDifferent&&(x=f.map(A=>this.getFieldValue(A,C,r)),!x.every(A=>A===x[0])||(y=!1)),!y)return;!x&&(!b.value||b.fn)&&(x=f.map(E=>this.getFieldValue(E,C,r)));let w;b.fn?w=b.fn(v,f):b.value?w=this.getFieldValue(v,b.value,(S=e.parser)!=null?S:r):w=x[0],this.setNestedValue(v,C,w)}),o.push(v)}return o}safeClone(t,e=new WeakMap){if(t===null||typeof t!="object")return t;if(typeof t=="function"||e.has(t))return;if(e.set(t,!0),Array.isArray(t))return t.map(r=>this.safeClone(r,e)).filter(r=>r!==void 0);const i={};for(const r of Object.keys(t)){if(["parent","children","_parent","_tree"].includes(r))continue;const n=this.safeClone(t[r],e);n!==void 0&&(i[r]=n)}return i}CalculationField(t,e,i){var a,o;const r=(a=i==null?void 0:i.parentCalculations)==null?void 0:a.find(l=>l.field===t);if(!r)return;const n=e.map(l=>l[t]).filter(l=>l!=null);if(r.fn)return r.fn(n,e);switch(r.type){case"sum":return n.reduce((l,h)=>Number(l)+Number(h),0);case"avg":return n.reduce((l,h)=>Number(l)+Number(h),0)/n.length;case"min":return Math.min(...n.map(Number));case"max":return Math.max(...n.map(Number));case"concat":{let l=r.ignoreEmpty?n.filter(h=>h):n;return r.removeDuplicates&&(l=Array.from(new Set(l))),l.join((o=r.delimiter)!=null?o:", ")}case"unique":return Array.from(new Set(n));case"count":return n.length;default:return}}getFieldValue(t,e,i){return i&&pS(e)?i.evaluate(e,t):im(e,t)}setNestedValue(t,e,i){const r=e.split(".");let n=t;for(let a=0;a<r.length-1;a++)r[a]in n||(n[r[a]]={}),n=n[r[a]];n[r[r.length-1]]=i}}window.XLSX=tB;const MQ=(s,t)=>t?s.filter(e=>Object.values(e).some(i=>typeof i=="string"||typeof i=="number"?i.toString().toLowerCase().includes(t):!1)):s,XQ=({data:s,settings:t,header:e,resource:i="",parser:r,search:n=!1,parentKey:a,displayResults:o=!1})=>{const l=_e.useRef(null),h=_e.useRef(null),[u,c]=_e.useState(!1),[f,d]=_e.useState(!1),{isDarkMode:p}=jS(),[v,g]=_e.useState(""),b=_e.useCallback(D1(A=>g(A),300),[]),C=_e.useRef(fB()),y=_e.useMemo(()=>new NQ(s).build(t==null?void 0:t.treeBy,r),[s,t==null?void 0:t.treeBy,r]);_e.useEffect(()=>{var A,z,D;if(l.current&&!h.current){const{processedColumns:T,rowHeight:M}=wQ((A=t==null?void 0:t.columns)!=null?A:[],r,a,p),K={showVerticalSeparators:!1,sortOrderReverse:!0,height:"100%",layout:"fitColumns",movableRows:!1,movableColumns:!1,headerSort:!0,placeholder:"no data available",index:"key",dataTree:!0,dataTreeExpandElement:'<span class="material-symbols-outlined expand-collapse-button">add_box</span>',dataTreeCollapseElement:'<span class="material-symbols-outlined expand-collapse-button">indeterminate_check_box</span>',dataTreeBranchElement:'<span class="material-symbols-outlined expand-collapse-button">subdirectory_arrow_right</span>',dataTreeChildIndent:20,printAsHtml:!0,printStyled:!0,groupToggleElement:"header",groupClosedShowCalcs:!0,rowHeight:M,data:y,...t,columns:T,columnDefaults:{resizable:!0,sorter:"alphanum",headerTooltip:(te,ee)=>{const J=ee.getField(),re=ee.getDefinition().title;return"".concat(re," [").concat(J,"]")}}};h.current=new Lz(l.current,K),K.showVerticalSeparators?(z=l.current)==null||z.classList.add("tabulator-vertical-separators"):(D=l.current)==null||D.classList.remove("tabulator-vertical-separators"),h.current.on("tableBuilt",x),h.current.on("cellEdited",te=>{var oe,me;const ee=te.getRow().getData(),J=te.getField();if(!J)return;const re=String(te.getValue()),j={variables:{build:(Re,V,$e)=>"".concat(Re,"[ID=").concat(V,"].variables[alias=").concat($e,"].value")},swcps:{build:(Re,V,$e)=>"".concat(Re,"[ID=").concat(V,"].swcps[name=").concat($e,"].value")}},de={part:"parts",assembly:"assemblies"},we=J.split(".").map(Re=>Re.trim()).filter(Boolean);if(we.length<2){console.warn("field does not contain prefix and alias:",J);return}const N=we.find(Re=>j[Re]);if(!N){console.warn("variable not mapped:",J);return}const H=we.indexOf(N),L=(oe=we[H+1])==null?void 0:oe.trim();if(!L){console.warn("empty alias for field:",J);return}const _=H>0?we[0].toLowerCase():void 0,U=_?(me=de[_])!=null?me:"".concat(_,"s"):ee.resource,se=String(ee.key),ae=j[N].build(U,se,L);console.log("changeAddress:",ae);try{FQ(wn.getInstance().key,ae,re)}catch(Re){console.error("updateLocalDBProperty failed",Re,{changeAddress:ae,value:re})}})}return()=>{if(h.current){const T=h.current.element;T instanceof Element&&document.body.contains(T)&&h.current.destroy(),h.current=null}}},[s,p,t,a,r,y]),_e.useEffect(()=>{if(l.current){const A=l.current;p?(A.style.setProperty("--header-font-color","#cfcfcf"),A.style.setProperty("--table-font-color","#cfcfcf")):(A.style.setProperty("--header-font-color","black"),A.style.setProperty("--table-font-color","black"))}},[p]);const x=_e.useCallback(()=>{const A=h.current;if(!A)return;const z=A.getRows().some(D=>D.getTreeChildren().length>0);d(D=>D===z?D:z)},[]),w=()=>{var A;console.log("printing table"),(A=h.current)==null||A.print(void 0,!0)},S=()=>{var A;(A=h.current)==null||A.download("xlsx","".concat(e,".xlsx"),{sheetName:"table"})},E=()=>{var z;const A={bom:!1,delimiter:",",...t==null?void 0:t.csvParams};(z=h.current)==null||z.download("csv","".concat(e,".csv"),A)},k=()=>{const A=h.current;A&&(A.getRows().forEach(z=>{u?z.treeCollapse():z.treeExpand()}),c(!u))};return _e.useEffect(()=>{if(v!=""&&h.current){const A=MQ(y,v);h.current.setData(A)}},[v,y]),Ae.jsxs(Ae.Fragment,{children:[e&&Ae.jsx(_Q,{header:e,handlePrint:w,handleDownload:S,handleCSVDownload:E,hasExpandables:f,expanded:u,handleExpandCollapse:k,setFilter:b,search:n,data:y,resource:i,displayResults:o,settings:t}),Ae.jsx(mo,{className:"".concat(e?"tabulator-bottom-rounded-corners":"tabulator-all-rounded-corners"),ref:l,id:C.current,sx:{marginBottom:1,maxHeight:"calc(70vh - 20px)",overflowY:"auto"}})]})};export{mQ as B,oV as C,fe as D,VQ as F,Qh as G,e1 as I,P9 as P,Q3 as Q,wn as R,sV as S,UQ as T,tB as X,jQ as a,zQ as b,$Q as c,XQ as d,We as e,pT as f,F9 as g,GQ as h,yQ as i,_9 as j,Hy as k,xQ as l,pE as m,pS as r,CQ as s,WQ as t,fB as v};
