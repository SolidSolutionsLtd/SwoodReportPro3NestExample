import{o as W,V as k,S as Us}from"../main.Nnz1qe81.js";const gi=(g,t)=>g.startsWith(t)?g.slice(t.length):g,qe=g=>g.replace(/\\/g,"/"),q=class q{constructor(t,s,e,i,a,n,r,h,o,d){this.name=t,this.type=s,this.docType=e,this.processingStatus=i,this.absoluteURI=a,this.relativeURI=n,this.hidden=r,this.storageType=h,this.exists=o,this.objType=d}};q.fromDocumentRaw=t=>{var n;let s="";const e=W.getInstance(),i="file:///"+qe(e.reportPath)+"/",a=t.absoluteURI;return a.startsWith(i)&&(s=a.slice(i.length)),new q((n=t.documentName)!=null?n:"",t.type,t.docType,t.processingStatus,t.absoluteURI,s,t.hidden,t.storageType,t.exists,t.objType)},q.fromDocumentsRaw=t=>{const s=[];for(const e of t!=null?t:[])s.push(q.fromDocumentRaw(e));return s};let L=q;class Hs{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c){this.key=t,this.messages=s,this.variables=e,this.serialNumbers=i,this.heritedVariables=a,this.typedObjectVariables=n,this.refPrograms=r,this.refParts=h,this.refPartsQuantities=o,this.refAssemblies=d,this.refAssembliesQuantities=m,this.documents=l,this.swcps=c,this.programs=[],this.parts=[],this.assemblies=[]}static fromAssemblyRaw(t,s){const e=k.parseVariables(t.variables,s),i=k.parseVariablesArrayToObject(t.serialNumbers.variables),a=k.parseTypedVariablesArray(t.heritedVariables),n=k.parseVariableGroupToRecord(t.typedObjectVariables),r=Us.parseVariablesArrayToObject(t.swcps),h=t.partsRefs.map(d=>({key:d.ID,quantity:d.count})),o=t.assembliesRefs.map(d=>({key:d.ID,quantity:d.count}));return new Hs(t.ID,t.messages,e,i,a,n,t.programs,t.parts,h,t.assemblies,o,L.fromDocumentsRaw(t.documents),r)}}class R{constructor(){this.instances=new Map}addInstance(t,s){this.instances.set(t,s)}get(t){return this.instances.get(t)}getAll(){return Array.from(this.instances.values())}getTotalInstances(){return this.instances.size}}class li extends R{addInstances(t){for(const s of t.assemblies)this.addInstance(s.ID,Hs.fromAssemblyRaw(s,t.variableDefinitions.assemblies));return this}}const Ot=class Ot{constructor(t,s){this.articles=t,this.cost=s}};Ot.fromToolRaw=t=>new Ot(t.articles,t.cost);let ls=Ot;class di extends R{addInstances(t){return this.addInstance("0",ls.fromToolRaw(t.costing)),this}}class Gs{constructor(t,s,e,i,a,n,r){this.key=t,this.panel=s,this.refMaterial=e,this.variables=i,this.serialNumbers=a,this.documents=n,this.messages=r}static fromEdgebandRaw(t,s){const e=k.parseVariables(t.variables,s),i=k.parseVariablesArrayToObject(t.serialNumbers.variables);return new Gs(t.ID,t.panel,t.edgebandMaterial,e,i,L.fromDocumentsRaw(t.documents),t.messages)}}class ui extends R{addInstances(t){for(const s of t.edgebands)this.addInstance(s.ID,Gs.fromEdgebandRaw(s,t.variableDefinitions.edgebands));return this}}class qs{constructor(t,s){this.key=t,this.variables=s}static fromEdgebandMaterialRaw(t,s){const e=k.parseVariables(t.variables,s);return new qs(t.ID,e)}}class mi extends R{addInstances(t){var s;for(const e of(s=t.edgebandMaterials)!=null?s:[])this.addInstance(e.ID,qs.fromEdgebandMaterialRaw(e,t.variableDefinitions.edgebandMaterials));return this}}const Rt=class Rt{constructor(t,s,e,i,a){this.key=t,this.messages=s,this.documents=e,this.variables=i,this.serialNumbers=a}};Rt.fromMaterialRaw=(t,s)=>{const e=k.parseVariables(t.variables,s),i=k.parseVariablesArrayToObject(t.serialNumbers.variables);return new Rt(t.ID,t.messages,L.fromDocumentsRaw(t.documents),e,i)};let ds=Rt;class fi extends R{addInstances(t){var s;for(const e of(s=t.materials)!=null?s:[])this.addInstance(e.ID,ds.fromMaterialRaw(e,t.variableDefinitions.materials));return this}}class Zs{constructor(t,s,e,i,a,n,r,h,o,d,m){this.key=t,this.name=s,this.refPart=e,this.refPrograms=i,this.refStocks=a,this.refProcessZones=n,this.refEdgebands=r,this.messages=h,this.documents=o,this.variables=d,this.serialNumbers=m,this.programs=[],this.stocks=[],this.edgebands=[]}static fromPanelRaw(t,s){const e=k.parseVariables(t.variables,s),i=k.parseVariablesArrayToObject(t.serialNumbers.variables);return new Zs(t.ID,t.name,t.ID,t.programs,t.stocks,t.processZones,t.edgebands,t.messages,L.fromDocumentsRaw(t.documents),e,i)}}class bi extends R{addInstances(t){var s;for(const e of(s=t.panels)!=null?s:[])this.addInstance(e.ID,Zs.fromPanelRaw(e,t.variableDefinitions.panels));return this}}class zs{constructor(t,s,e,i){this.key=t,this.messages=s,this.documents=e,this.variables=i}static fromPanelProcessRaw(t,s){const e=k.parseVariables(t.variables,s);return new zs(t.ID,t.messages,L.fromDocumentsRaw(t.documents),e)}}class pi extends R{addInstances(t){var s;if(!t.panelProcesses)return this;for(const e of t.panelProcesses)this.addInstance(e.ID,zs.fromPanelProcessRaw(e,(s=t.variableDefinitions.panelProcesses)!=null?s:[]));return this}}class _s{constructor(t,s,e,i,a,n){this.key=t,this.refPanel=s,this.refPanelProcess=e,this.messages=i,this.documents=a,this.variables=n}static fromProcessZoneRaw(t,s){const e=k.parseVariables(t.variables,s);return new _s(t.ID,t.panel,t.panelProcess,t.messages,L.fromDocumentsRaw(t.documents),e)}}class Pi extends R{addInstances(t){var s;if(!t.processZones)return this;for(const e of t.processZones)this.addInstance(e.ID,_s.fromProcessZoneRaw(e,(s=t.variableDefinitions.processZones)!=null?s:[]));return this}}class Ys{constructor(t,s,e,i,a,n,r,h,o,d,m,l){this.key=t,this.refPrograms=s,this.refStocks=e,this.refPanel=i,this.bodyCount=a,this.messages=n,this.variables=r,this.serialNumbers=h,this.heritedVariables=o,this.typedObjectVariables=d,this.documents=m,this.swcps=l,this.programs=[],this.stocks=[]}static fromPartRaw(t,s){const e=k.parseVariables(t.variables,s),i=k.parseVariablesArrayToObject(t.serialNumbers.variables),a=k.parseTypedVariablesArray(t.heritedVariables),n=k.parseVariableGroupToRecord(t.typedObjectVariables),r=Us.parseVariablesArrayToObject(t.swcps);return new Ys(t.ID,t.programs,t.stocks,t.panel,t.bodyCount,t.messages,e,i,a,n,L.fromDocumentsRaw(t.documents),r)}}class Mi extends R{addInstances(t){for(const s of t.parts)this.addInstance(s.ID,Ys.fromPartRaw(s,t.variableDefinitions.parts));return this}}class Xs{constructor(t,s,e,i,a,n,r,h){this.key=t,this.refTools=s,this.refProgramParts=e,this.refBoard=i,this.messages=a,this.documents=n,this.variables=r,this.serialNumbers=h,this.tools=[]}static fromProgramRaw(t,s){const e=k.parseVariables(t.variables,s),i=k.parseVariablesArrayToObject(t.serialNumbers.variables);return new Xs(t.ID,t.tools,t.programParts,t.nestingBoard,t.messages,L.fromDocumentsRaw(t.documents),e,i)}}class wi extends R{addInstances(t){for(const s of t.programs)this.addInstance(s.ID,Xs.fromProgramRaw(s,t.variableDefinitions.programs));return this}}class Ks{constructor(t,s,e,i,a,n,r){this.key=t,this.part=s,this.program=e,this.documents=i,this.messages=a,this.variables=n,this.serialNumbers=r}static fromProgramPartRaw(t,s){const e=k.parseVariables(t.variables,s),i=k.parseVariablesArrayToObject(t.serialNumbers.variables);return new Ks(t.ID,t.part,t.program,L.fromDocumentsRaw(t.documents),t.messages,e,i)}}class yi extends R{addInstances(t){for(const s of t.programParts)this.addInstance(s.ID,Ks.fromProgramPartRaw(s,t.variableDefinitions.programParts));return this}}class Js{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c){this.key=t,this.swoodVersion=s,this.schemaVersion=e,this.name=i,this.projectPath=a,this.reportPath=n,this.timestamp=r,this.createdBy=h,this.documents=o,this.messages=d,this.variables=m,this.serialNumbers=l,this.swcps=c}static fromProjectRaw(t,s){const e=k.parseVariables(t.variables,s),i=k.parseVariablesArrayToObject(t.serialNumbers.variables),a=Us.parseVariablesArrayToObject(t.swcps);return new Js(t.reportGUID,t.reportVersion,t.schemaVersion,t.projectName,t.projectPath,t.reportPath,t.createdDate,t.createdBy,L.fromDocumentsRaw(t.documents),t.messages,e,i,a)}}class te{constructor(t,s,e,i){this.key=t,this.messages=s,this.documents=e,this.variables=i}static fromSpindleRaw(t,s){const e=k.parseVariables(t.variables,s);return new te(t.ID,t.messages,L.fromDocumentsRaw(t.documents),e)}}class Di extends R{addInstances(t){var s;if(!t.spindles)return this;for(const e of t.spindles)this.addInstance(e.ID,te.fromSpindleRaw(e,(s=t.variableDefinitions.spindles)!=null?s:[]));return this}}const Vt=class Vt{constructor(t,s,e,i,a,n){this.key=t,this.refPart=s,this.refMaterial=e,this.messages=i,this.documents=a,this.variables=n}};Vt.fromStockRaw=(t,s)=>{const e=k.parseVariables(t.variables,s);return new Vt(t.ID,t.part,t.material,t.messages,L.fromDocumentsRaw(t.documents),e)};let us=Vt;class Ii extends R{addInstances(t){for(const s of t.stocks)this.addInstance(s.ID,us.fromStockRaw(s,t.variableDefinitions.stocks));return this}}class se{constructor(t,s,e,i,a=[]){this.key=t,this.variables=s,this.messages=e,this.documents=i,this.refSpindles=a}static fromToolRaw(t,s){var i;const e=k.parseVariables(t.variables,s);return new se(t.ID,e,t.messages,L.fromDocumentsRaw(t.documents),(i=t.spindles)!=null?i:[])}}class Ti extends R{addInstances(t){var s;for(const e of(s=t.tools)!=null?s:[])this.addInstance(e.ID,se.fromToolRaw(e,t.variableDefinitions.tools));return this}}class ki{constructor(){this.instances=new Map}addInstance(t,s){const e=this.instances.get(t);e?e.push(s):this.instances.set(t,[s])}addInstances(t,s,e){for(const i of t.typedObjects){const a=s.get(i);if(a){const r=a.variables.TOTYPES.split(";");for(const h of r)this.addInstance(h,a)}const n=e.get(i);if(n){const r=n.variables.TOTYPES.split(";");for(const h of r)this.addInstance(h,n)}}return this}getInstancesById(t){return this.instances.get(t)||null}getAll(){return this.instances}}class ee{constructor(t,s,e,i,a){this.key=t,this.name=s,this.material=e,this.thickness=i,this.stock=a}static fromPatternRaw(t,s,e){return new ee(t,t,s.material,s.thickness,e)}}class vi extends R{addInstances(t){var e;let s=1;for(const i of t!=null?t:[])for(const a of(e=i.stocks)!=null?e:[]){const n="Pattern ".concat(s.toString());this.addInstance(n,ee.fromPatternRaw(n,i,a)),s++}return this}}class ft{constructor(t,s,e={},i={}){this.type=t,this.key=s,this.variables=e,this.articleVariables=i}static fromArticlesRaw(t){return new ft("article",t.name,{},{name:t.name,count:t.count,quantity:t.quantity,quantityUnit:t.quantityUnit,cost:t.cost,costUnit:t.unitCost})}static fromBoardMaterialRaw(t,s){const e=k.parseVariables(t.variables,s);return new ft("material",t.ID,e)}}class Ai extends R{addInstances(t){var s,e;for(const i of(s=t.costing.articles)!=null?s:[])i.type==="CUTTINGPATTERN_BOARD"&&this.addInstance(i.name,ft.fromArticlesRaw(i));for(const i of(e=t.boards)!=null?e:[])this.addInstance(i.ID,ft.fromBoardMaterialRaw(i,t.variableDefinitions.boards));return this}}function Me(g,t){return t.split(".").reduce((s,e)=>s==null?void 0:s[e],g)}const ms=(g,t)=>{g.sort((s,e)=>{for(const{field:i,order:a="asc"}of t){const n=Me(s,i),r=Me(e,i);if(n==null&&r!=null)return a==="asc"?1:-1;if(n!=null&&r==null)return a==="asc"?-1:1;if(!(n==null&&r==null)){if(n<r)return a==="asc"?-1:1;if(n>r)return a==="asc"?1:-1}}return 0});for(const s of g)Array.isArray(s.children)&&ms(s.children,t)},fs=(g,t)=>function(s,e){for(const i in g){let a=s[g[i].Property],n=e[g[i].Property];if(we(a)&&(a=new Date(a)),we(n)&&(n=new Date(n)),s.combineId!=0&&g[i].Property=="Name"&&(a=t.CombinedPanelName+" "+s.combineId+" - "+s.Name),e.combineId!=0&&g[i].Property=="Name"&&(n=t.CombinedPanelName+" "+e.combineId+" - "+e.Name),s.Multibody&&g[i].Property=="Name"&&(s.Quantity==0?a=s.ParentFrame+" - "+s.Name:s.Quantity!=0&&(s.Quantity>1?a=s.ParentFrame+" - "+s.WeldmentFolder+" - "+s.Name:a=s.ParentFrame+" - "+s.WeldmentFolder)),e.Multibody&&g[i].Property=="Name"&&(e.Quantity==0?n=e.ParentFrame+" - "+e.Name:e.Quantity!=0&&(e.Quantity>1?n=e.ParentFrame+" - "+e.WeldmentFolder+" - "+e.Name:n=e.ParentFrame+" - "+e.WeldmentFolder)),s.hasOwnProperty("CombinedList")&&s.CombinedList.sort(fs(g,t)),e.hasOwnProperty("CombinedList")&&e.CombinedList.sort(fs(g,t)),typeof a=="string"){const r=a.localeCompare(n,"en",{numeric:!0});if(r!=0)return r*g[i].Type}else{if(a>n)return 1*g[i].Type;if(a<n)return-1*g[i].Type}}return 1};function we(g){if(typeof g!="string")return!1;const t=/^(\d{2})\/(\d{2})\/(\d{4})$/,s=g.match(t);if(s){const i=parseInt(s[1],10),a=parseInt(s[2],10)-1,n=parseInt(s[3],10),r=new Date(n,a,i);return r.getFullYear()===n&&r.getMonth()===a&&r.getDate()===i}const e=new Date(g);return!isNaN(e.getTime())&&g===e.toISOString().split("T")[0]}class wt{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y,v,T,C,A,S,E,B,O,x,F,Q,$,H,G){this.database=t,this.projectData=s,this.panelsData=e,this.stocksData=i,this.partsData=a,this.assembliesData=n,this.edgebandsData=r,this.edgebandMaterialsData=h,this.materialsData=o,this.boardMaterialsData=d,this.programsData=m,this.programPartsData=l,this.toolsData=c,this.spindlesData=u,this.costsData=b,this.typedObjectsData=f,this.panelProcessesData=p,this.processZonesData=P,this.patternsData=M,this.panelDataManager=w,this.stockDataManager=y,this.partDataManager=v,this.assemblyDataManager=T,this.edgebandDataManager=C,this.edgebandMaterialDataManager=A,this.materialDataManager=S,this.boardMaterialDataManager=E,this.programDataManager=B,this.programPartDataManager=O,this.toolDataManager=x,this.spindleDataManager=F,this.costDataManager=Q,this.panelProcessDataManager=$,this.processZoneDataManager=H,this.patternDataManager=G}static createFromRawData(t){const s=Js.fromProjectRaw(t,t.variableDefinitions.report),e=new bi().addInstances(t),i=new Ii().addInstances(t),a=new Mi().addInstances(t),n=new li().addInstances(t),r=new ui().addInstances(t),h=new mi().addInstances(t),o=new fi().addInstances(t),d=new Ai().addInstances(t),m=new wi().addInstances(t),l=new yi().addInstances(t),c=new Ti().addInstances(t),u=new Di().addInstances(t),b=new di().addInstances(t),f=new ki().addInstances(t,a,n),p=new pi().addInstances(t),P=new Pi().addInstances(t),M=new vi().addInstances(t.cuttingPattern);return new wt(t,s,e.getAll(),i.getAll(),a.getAll(),n.getAll(),r.getAll(),h.getAll(),o.getAll(),d.getAll(),m.getAll(),l.getAll(),c.getAll(),u.getAll(),b.getAll(),f.getAll(),p.getAll(),P.getAll(),M.getAll(),e,i,a,n,r,h,o,d,m,l,c,u,b,p,P,M).relateData()}relateData(){return this.assignDataToEdgebands(),this.assignDataToStocks(),this.assignDataToPanels(),this.assignDataToAssemblies(),this.assignSubAssemblies(),this.assignDataToParts(),this.sortData(),this}sortData(){const t=[{field:"variables.PAN_T",order:"desc"},{field:"material.name",order:"asc"},{field:"variables.PAN_L",order:"desc"},{field:"variables.PAN_W",order:"desc"},{field:"name",order:"asc"},{field:"quantity",order:"asc"}];ms(this.panelsData,t);const s=[{field:"variables.ST_T",order:"desc"},{field:"refMaterial",order:"asc"},{field:"variables.ST_L",order:"desc"},{field:"variables.ST_W",order:"desc"},{field:"name",order:"asc"},{field:"quantity",order:"asc"}];ms(this.stocksData,s)}assignDataToEdgebands(){for(const t of this.edgebandDataManager.getAll())t.material=this.edgebandMaterialDataManager.get(t.refMaterial)}assignDataToStocks(){for(const t of this.stockDataManager.getAll()){const s=this.materialDataManager.get(t.refMaterial);t.material=s}}assignDataToPanels(){for(const t of this.panelDataManager.getAll()){for(const e of t.refStocks){const i=this.stockDataManager.get(e);i&&(t.stocks.push(i),i.variables.ST_N==="CORE"&&(t.material=i.material))}for(const e of t.refEdgebands){const i=this.edgebandDataManager.get(e);i&&t.edgebands.push(i)}for(const e of t.refPrograms){const i=this.programDataManager.get(e);i&&t.programs.push(i)}const s=this.partDataManager.get(t.key);s&&(t.part=s)}}assignDataToAssemblies(){var t,s;for(const e of this.assemblyDataManager.getAll()){for(const i of e.refParts){const a=this.partDataManager.get(i);a&&((t=e.parts)==null||t.push(a))}for(const i of e.refPrograms){const a=this.programDataManager.get(i);a&&((s=e.programs)==null||s.push(a))}}}assignSubAssemblies(){var t;for(const s of this.assemblyDataManager.getAll())for(const e of s.refAssemblies){const i=this.assemblyDataManager.get(e);i&&((t=s.assemblies)==null||t.push(i))}}assignDataToParts(){var t;for(const s of this.partDataManager.getAll()){s.panel=s.refPanel?this.panelDataManager.get(s.refPanel):void 0;for(const e of(t=s.refStocks)!=null?t:[]){const i=this.stockDataManager.get(e);i&&s.stocks.push(i)}for(const e of s.refPrograms){const i=this.programDataManager.get(e);i&&(s.programs.push(i),i.part=s)}}}}class N{constructor(){this.instances=new Map}add(t,s){this.instances.set(t,s)}get(t){const s=this.instances.get(t);return s||console.error("".concat(this.constructor.name," - unable to find instance: ").concat(t)),s}getAll(){return Array.from(this.instances.values())}getTotalInstances(){return this.instances.size}}class Ze{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y){this.key=t,this.messages=s,this.variables=e,this.heritedVariables=i,this.typedObjectVariables=a,this.refPrograms=n,this.refParts=r,this.refPartsQuantities=h,this.refAssemblies=o,this.refAssembliesQuantities=d,this.documents=m,this.swcps=l,this.name=c,this.description=u,this.configuration=b,this.quantity=f,this.height=p,this.width=P,this.depth=M,this.images=w,this.edrawings=y,this.resource="assemblies",this.programs=[],this.parts=[],this.assemblies=[]}static fromAssemblyBusiness(t){return t.createViewModel()}}const Z=class Z{constructor(t,s,e,i,a,n,r,h){this.type=t,this.typeDescription=s,this.description=e,this.message=i,this.messageType=a,this.item=n,this.category=r,this.url=h,this.resource="messages"}};Z.fromMessageRaw=(t,s="",e="",i="")=>new Z(t.type,t.typeDesc,t.desc,t.message,t.messageType,s,e,i),Z.fromMessagesRaw=(t,s="",e="",i="")=>{const a=[];for(const n of t!=null?t:[])a.push(Z.fromMessageRaw(n,s,e,i));return a};let D=Z;class j{constructor(t){this.documents=t}getImages(){var s;const t={};for(const e of(s=this.documents)!=null?s:[])if(e.docType==="IMAGE"){const i=e.absoluteURI,a=W.getInstance(),n="file:///"+qe(a.reportPath),r=gi(i,n);e.name!==null&&(t[e.name]=r)}return t}}const Lt=class Lt{constructor(t,s,e,i,a,n,r,h,o,d,m,l){this.key=t,this.messages=s,this.variables=e,this.heritedVariables=i,this.typedObjectVariables=a,this.refPrograms=n,this.refParts=r,this.refPartsQuantities=h,this.refAssemblies=o,this.refAssembliesQuantities=d,this.documents=m,this.swcps=l,this.programs=[],this.parts=[],this.assemblies=[],this.getName=()=>this.variables.NAME,this.getDescription=()=>this.variables.DESC,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>{var c;return((c=this.variables.NB)!=null?c:0)*W.getInstance().projectQuantity},this.getHeight=()=>{var c;return(c=this.variables.Height)!=null?c:0},this.getWidth=()=>{var c;return(c=this.variables.Width)!=null?c:0},this.getDepth=()=>{var c;return(c=this.variables.Depth)!=null?c:0},this.getImages=()=>new j(this.documents).getImages()}createViewModel(){return new Ze(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Assembly"),this.variables,this.heritedVariables,this.typedObjectVariables,this.refPrograms,this.refParts,this.refPartsQuantities,this.refAssemblies,this.refAssembliesQuantities,this.documents,this.swcps,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getHeight(),this.getWidth(),this.getDepth(),this.getImages(),this.getEdrawings())}getEdrawings(){return"edrawings/".concat(this.getName(),".html")}};Lt.fromAssemblyData=t=>new Lt(t.key,t.messages,t.variables,t.heritedVariables,t.typedObjectVariables,t.refPrograms,t.refParts,t.refPartsQuantities,t.refAssemblies,t.refAssembliesQuantities,t.documents,t.swcps);let bs=Lt;class ye extends N{constructor(){super(...arguments),this.addPrograms=t=>{const s=this.getAll();for(const e of s)for(const i of e.refPrograms){const a=t.get(i);a&&e.programs.push(a)}},this.addParts=t=>{const s=this.getAll();for(const e of s)for(const i of e.refParts){const a=t.get(i);a&&e.parts.push(a)}},this.addAssemblies=t=>{const s=this.getAll();for(const e of s)for(const i of e.refAssemblies){const a=t.get(i);a&&e.assemblies.push(a)}}}addInstances(t){for(const s of t)this.add(s.key,bs.fromAssemblyData(s));return this}}class ze{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y,v,T){this.key=t,this.swoodVersion=s,this.schemaVersion=e,this.name=i,this.projectPath=a,this.reportPath=n,this.timestamp=r,this.date=h,this.time=o,this.createdBy=d,this.documents=m,this.swcps=l,this.messages=c,this.variables=u,this.isDesign=b,this.isCam=f,this.isNesting=p,this.isUsingOffcuts=P,this.images=M,this.pdfs=w,this.configuration=y,this.description=v,this.reportVersion=T,this.resource="project"}static fromProjectBusiness(t){return t.createViewModel()}}class V{constructor(t){this.documents=t}getDocuments(){var s;const t={};for(const e of(s=this.documents)!=null?s:[])e.name!==null&&(t[e.name]=e);return t}}class ns{constructor(t){this.documents=t}getPDFs(){var s;const t={};for(const e of(s=this.documents)!=null?s:[])e.docType==="DRAWING2PDF"&&e.exists&&e.name!==null&&(t[e.name]=e.relativeURI);return t}}const Wt=class Wt{constructor(t,s,e,i,a,n,r,h,o,d,m,l){this.key=t,this.swoodVersion=s,this.schemaVersion=e,this.name=i,this.projectPath=a,this.reportPath=n,this.timestamp=r,this.createdBy=h,this.documents=o,this.messages=d,this.variables=m,this.swcps=l,this.getTime=()=>{const c=new Date(this.timestamp),u=String(c.getHours()).padStart(2,"0"),b=String(c.getMinutes()).padStart(2,"0"),f=String(c.getSeconds()).padStart(2,"0");return"".concat(u,":").concat(b,":").concat(f)},this.getDate=()=>{const c=new Date(this.timestamp),u=c.getFullYear(),b=String(c.getMonth()+1).padStart(2,"0"),f=String(c.getDate()).padStart(2,"0");return"".concat(f,"/").concat(b,"/").concat(u)},this.getIsDesign=()=>{var c;return(c=this.variables.REPORT_ISUSINGDESIGN)!=null?c:!1},this.getIsCam=()=>{var c;return(c=this.variables.REPORT_ISUSINGCAM)!=null?c:!1},this.getIsNesting=()=>{var c;return(c=this.variables.REPORT_ISNESTINGPROJECT)!=null?c:!1},this.getIsUsingOffcuts=()=>{var c;return(c=this.variables.MODULE_PROGRAMOFFCUTS_ISACTIVE)!=null?c:!1},this.getImages=()=>new j(this.documents).getImages(),this.getPDFs=()=>new ns(this.documents).getPDFs(),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getConfiguration=()=>{var c,u;return(u=(c=this.component)==null?void 0:c.getConfiguration())!=null?u:""},this.getDescription=()=>{var c,u;return(u=(c=this.component)==null?void 0:c.getDescription())!=null?u:""},this.getReportVersion=()=>{var c;return(c=this.variables.ReportVersion)!=null?c:"0.0.0"}}createViewModel(){return new ze(this.key,this.swoodVersion,this.schemaVersion,this.name,this.projectPath,this.reportPath,this.timestamp,this.getDate(),this.getTime(),this.createdBy,this.getDocuments(),this.swcps,D.fromMessagesRaw(this.messages,this.name,"Project"),this.variables,this.getIsDesign(),this.getIsCam(),this.getIsNesting(),this.getIsUsingOffcuts(),this.getImages(),this.getPDFs(),this.getConfiguration(),this.getDescription(),this.getReportVersion())}};Wt.fromProjectData=t=>new Wt(t.key,t.swoodVersion,t.schemaVersion,t.name,t.projectPath,t.reportPath,t.timestamp,t.createdBy,t.documents,t.messages,t.variables,t.swcps);let yt=Wt;const xt=class xt{constructor(t,s){this.articles=t,this.cost=s}};xt.fromCostData=t=>new xt(t.articles,t.cost);let ps=xt;class De extends N{addInstances(t){return this.add("0",ps.fromCostData(t[0])),this}}const Ft=class Ft{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p){this.key=t,this.refPanel=s,this.refMaterial=e,this.variables=i,this.documents=a,this.messages=n,this.name=r,this.quantity=h,this.length=o,this.lengthStock=d,this.width=m,this.thickness=l,this.overLength=c,this.position=u,this.isCurved=b,this.isPaint=f,this.cost=p,this.resource="edgebands"}static fromEdgebandBusiness(t){return t.createViewModel()}};Ft.createCombinedEdgeband=(t,s,e)=>new Ft(t.key,t.refPanel,t.refMaterial,t.variables,t.documents,t.messages,s,e,t.length,t.lengthStock,t.width,t.thickness,t.overLength,t.position,t.isCurved,t.isPaint,t.cost);let bt=Ft;const Qt=class Qt{constructor(t,s,e,i,a,n){this.key=t,this.refPanel=s,this.refMaterial=e,this.variables=i,this.documents=a,this.messages=n,this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>{var r;return(r=this.variables.EB_N)!=null?r:""},this.getQuantity=()=>{var r,h;return(h=(r=this.panel)==null?void 0:r.getQuantity())!=null?h:0},this.getLength=()=>{var r;return(r=this.variables.EB_L)!=null?r:0},this.getLengthStock=()=>{var r;return(r=this.variables.EB_LSTOCK)!=null?r:0},this.getWidth=()=>{var r,h;return(h=(r=this.panel)==null?void 0:r.getThickness())!=null?h:0},this.getThickness=()=>{var r,h;return(h=(r=this.material)==null?void 0:r.getThickness())!=null?h:0},this.getOverLength=()=>{var r;return(r=this.variables.EB_OVERLENGTH)!=null?r:0},this.getPosition=()=>this.variables.EB_STOCKPOSITION,this.getIsCurved=()=>{var r;return(r=this.variables.EB_ISCURVED)!=null?r:!1},this.getIsPaint=()=>{var r,h;return(h=(r=this.material)==null?void 0:r.getIsPaint())!=null?h:!1},this.getMaterialQuantity=()=>(this.getLength()+this.getOverLength())/1e3*this.getQuantity(),this.getCost=()=>{var r,h;return this.getMaterialQuantity()*((h=(r=this.material)==null?void 0:r.getCostUnit())!=null?h:0)},this.updateMaterialQuantity=()=>{this.material?this.material.quantity+=(this.getLength()+this.getOverLength())/1e3*this.getQuantity():console.warn("unable to update quantity – material or panel missing for ".concat(this.getName()))}}createViewModel(){return this.updateMaterialQuantity(),new bt(this.key,this.refPanel,this.refMaterial,this.variables,this.getDocuments(),D.fromMessagesRaw(this.messages,this.getName(),"Edgeband"),this.getName(),this.getQuantity(),this.getLength(),this.getLengthStock(),this.getWidth(),this.getThickness(),this.getOverLength(),this.getPosition(),this.getIsCurved(),this.getIsPaint(),this.getCost())}};Qt.fromEdgebandData=t=>new Qt(t.key,t.panel,t.refMaterial,t.variables,t.documents,t.messages);let Ps=Qt;class Ie extends N{constructor(){super(...arguments),this.addMaterials=t=>{const s=this.getAll();for(const e of s){const i=t.get(e.refMaterial);i&&(e.material=i)}}}addInstances(t){for(const s of t)this.add(s.key,Ps.fromEdgebandData(s));return this}}class _e{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u){this.key=t,this.variables=s,this.name=e,this.description=i,this.reference=a,this.thickness=n,this.extension=r,this.color=h,this.isPaint=o,this.cost=d,this.costUnit=m,this.costType=l,this.quantity=c,this.unitOfMeasure=u}static fromEdgebandMaterialBusiness(t){return t.createViewModel()}}const jt=class jt{constructor(t,s,e){this.key=t,this.variables=s,this.quantity=e,this.createViewModel=()=>new _e(this.key,this.variables,this.getName(),this.getDescription(),this.getReference(),this.getThickness(),this.getExtension(),this.getColor(),this.getIsPaint(),this.getCost(),this.getCostUnit(),2,this.quantity,"m"),this.getName=()=>{var i;return(i=this.variables.EBMAT_C)!=null?i:""},this.getDescription=()=>{var i;return(i=this.variables.EBMAT_D)!=null?i:""},this.getReference=()=>{var i;return(i=this.variables.EBMAT_REF)!=null?i:""},this.getCostUnit=()=>this.variables.EBMAT_UCOST,this.getThickness=()=>{var i;return(i=this.variables.EBMAT_T)!=null?i:0},this.getIsPaint=()=>{var i;return(i=this.variables.PAINT)!=null?i:!1},this.getExtension=()=>{var i;return(i=this.variables.EXTENSION)!=null?i:0},this.getCost=()=>this.quantity*this.getCostUnit(),this.getColor=()=>this.variables.EBMAT_CO===void 0||this.variables.EBMAT_CO==="0"?"#000000ff":this.argbToRgba(this.variables.EBMAT_CO),this.argbToRgba=i=>{if(i=i.replace(/^#/,""),i.length!==8)return console.warn("invalid ARGB hex format: ".concat(i)),"#000000ff";const a=parseInt(i.slice(0,2),16)/255,n=parseInt(i.slice(2,4),16),r=parseInt(i.slice(4,6),16),h=parseInt(i.slice(6,8),16);return"rgba(".concat(n,", ").concat(r,", ").concat(h,", ").concat(a.toFixed(2),")")}}};jt.fromEdgebandMaterialData=t=>new jt(t.key,t.variables,0);let Ms=jt;class Te extends N{addInstances(t){for(const s of t)this.add(s.key,Ms.fromEdgebandMaterialData(s));return this}}class I{constructor(){this.instances=new Map}addInstance(t,s){this.instances.set(t,s)}get(t){return this.instances.get(t)}getAll(){return Array.from(this.instances.values())}getTotalInstances(){return this.instances.size}groupBy(t){const s=new Map;for(const e of this.getAll()){const i=this.getNestedValue(t.toString(),e);s.has(i)||s.set(i,[]),s.get(i).push(e)}return s}mergeDescription(t,s){return t?!s||t.includes(s)?t:"".concat(t," | ").concat(s):s}getNestedValue(t,s){return t.split(".").reduce((e,i)=>e==null?void 0:e[i],s)}}const oe=class oe{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y,v,T,C,A){this.key=t,this.messages=s,this.refParts=e,this.refPartsQuantities=i,this.refAssemblies=a,this.refAssembliesQuantities=n,this.documents=r,this.swcps=h,this.variables=o,this.heritedVariables=d,this.typedObjectVariables=m,this.id=l,this.name=c,this.description=u,this.configuration=b,this.quantity=f,this.height=p,this.width=P,this.depth=M,this.url=w,this.images=y,this.pdfs=v,this.cost=T,this.costPanels=C,this.costHardware=A,this.resource="frames",this.parts=[],this.assemblies=[],this.panels=[],this.programs=[],this.hardware=[],this.weldments=[]}};oe.fromFrameBusiness=t=>t.createViewModel();let Dt=oe;const $t=class $t{constructor(t,s,e,i,a,n,r,h,o,d,m){this.key=t,this.messages=s,this.heritedVariables=e,this.typedObjectVariables=i,this.refParts=a,this.refPartsQuantities=n,this.refAssemblies=r,this.refAssembliesQuantities=h,this.documents=o,this.swcps=d,this.variables=m,this.parts=[],this.assemblies=[],this.panels=[],this.programs=[],this.hardware=[],this.weldments=[],this.getID=()=>this.variables.ID,this.getName=()=>this.variables.NAME,this.getDescription=()=>this.variables.DESC,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>{var l;return((l=this.variables.NB)!=null?l:0)*W.getInstance().projectQuantity},this.getHeight=()=>{var l;return(l=this.variables.Height)!=null?l:0},this.getWidth=()=>{var l;return(l=this.variables.Width)!=null?l:0},this.getDepth=()=>{var l;return(l=this.variables.Depth)!=null?l:0},this.getImages=()=>new j(this.documents).getImages(),this.getPDFs=()=>new ns(this.documents).getPDFs(),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getUrl=()=>"frames/".concat(this.key),this.getCostPanels=()=>{let l=0;for(const c of this.panels)l+=c.getCost();return l},this.getCostHardware=()=>{let l=0;for(const c of this.hardware)l+=c.getCost();return l},this.getCost=()=>this.getCostPanels()+this.getCostHardware(),this.getIsExcluded=()=>this.typedObjectVariables!=null&&"EXCLUDED"in this.typedObjectVariables}createViewModel(){return new Dt(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Frame",this.getUrl()),this.refParts,this.refPartsQuantities,this.refAssemblies,this.refAssembliesQuantities,this.getDocuments(),this.swcps,this.variables,this.heritedVariables,this.typedObjectVariables,this.getID(),this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getHeight(),this.getWidth(),this.getDepth(),this.getUrl(),this.getImages(),this.getPDFs(),this.getCost(),this.getCostPanels(),this.getCostHardware())}};$t.fromAssemblyPartBusiness=t=>new $t(t.key,t.messages,t.heritedVariables,t.typedObjectVariables,"refParts"in t?t.refParts:[],"refPartsQuantities"in t?t.refPartsQuantities:[],"refAssemblies"in t?t.refAssemblies:[],"refAssembliesQuantities"in t?t.refAssembliesQuantities:[],t.documents,t.swcps,t.variables);let ws=$t;class ke extends I{constructor(){super(...arguments),this.FrameTypedObjectName="FRAME"}addInstances(t){var e;const s=(e=t.getInstancesByName(this.FrameTypedObjectName))!=null?e:[];for(const i of s)this.addInstance(i.key,ws.fromAssemblyPartBusiness(i));return this}}const ce=class ce{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P){this.key=t,this.messages=s,this.heritedVariables=e,this.typedObjectVariables=i,this.refPrograms=a,this.refParts=n,this.refAssemblies=r,this.documents=h,this.swcps=o,this.variables=d,this.name=m,this.description=l,this.configuration=c,this.quantity=u,this.length=b,this.images=f,this.cost=p,this.costUnit=P,this.resource="hardware",this.parts=[],this.assemblies=[]}};ce.fromHardwareBusiness=t=>t.createViewModel();let It=ce;const Ut=class Ut{constructor(t,s,e,i,a,n,r,h,o,d){this.key=t,this.messages=s,this.heritedVariables=e,this.typedObjectVariables=i,this.refPrograms=a,this.refParts=n,this.refAssemblies=r,this.documents=h,this.swcps=o,this.variables=d,this.parts=[],this.assemblies=[],this.createViewModel=()=>new It(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Hardware"),this.heritedVariables,this.typedObjectVariables,this.refPrograms,this.refParts,this.refAssemblies,this.getDocuments(),this.swcps,this.variables,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getImages(),this.getCost(),this.getCostUnit()),this.getName=()=>this.variables.NAME,this.getDescription=()=>this.variables.DESC,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>this.variables.NB,this.getLength=()=>this.variables.Length,this.getImages=()=>new j(this.documents).getImages(),this.getCost=()=>this.getCostUnit()*this.getQuantity(),this.getCostUnit=()=>{var m;return(m=this.swcps.Cost)!=null?m:0},this.getDocuments=()=>new V(this.documents).getDocuments()}};Ut.fromAssemblyPartBusiness=t=>new Ut(t.key,t.messages,t.heritedVariables,t.typedObjectVariables,t.refPrograms,"refParts"in t?t.refParts:[],"refAssemblies"in t?t.refAssemblies:[],t.documents,t.swcps,t.variables);let ys=Ut;class ve extends I{constructor(){super(...arguments),this.HardwareTypedObjectName="HARDWARE"}addInstances(t){var e;const s=(e=t.getInstancesByName(this.HardwareTypedObjectName))!=null?e:[];for(const i of s)this.addInstance(i.key,ys.fromAssemblyPartBusiness(i));return this}}const ut=class ut{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c){this.key=t,this.refPart=s,this.refMaterial=e,this.messages=i,this.documents=a,this.variables=n,this.name=r,this.description=h,this.quantity=o,this.length=d,this.width=m,this.thickness=l,this.cost=c,this.resource="laminates"}};ut.fromLaminateBusiness=t=>t.createViewModel(),ut.createCombinedLaminate=(t,s,e)=>new ut(t.key,t.refPart,t.refMaterial,t.messages,t.documents,t.variables,s,t.description,e,t.length,t.width,t.thickness,t.cost);let pt=ut;const Ht=class Ht{constructor(t,s,e,i,a,n,r){this.key=t,this.refPart=s,this.refMaterial=e,this.messages=i,this.documents=a,this.variables=n,this.settings=r,this.createViewModel=()=>(this.updateMaterialQuantity(),new pt(this.key,this.refPart,this.refMaterial,D.fromMessagesRaw(this.messages,this.getName(),"Laminate"),this.getDocuments(),this.variables,this.getName(),this.getDescription(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getCost())),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>this.variables.ST_N,this.getDescription=()=>this.variables.ST_DESC,this.getQuantity=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.getQuantity())!=null?o:0},this.getSwoodLength=()=>this.variables.ST_L,this.getSwoodWidth=()=>this.variables.ST_W,this.getThickness=()=>this.variables.ST_T,this.getHasGrain=()=>{var h,o;return(o=(h=this.material)==null?void 0:h.getHasGrain())!=null?o:!1},this.getLength=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).length,this.getWidth=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).width,this.getVolume=()=>this.getLength()*this.getWidth()*this.getThickness()/1e9,this.getSurface=()=>this.getLength()*this.getWidth()/1e6,this.getMaterialQuantity=()=>{if(!this.material)return console.warn("material not defined for ".concat(this.getName())),0;switch(this.material.getCostType()){case 0:return this.getVolume();case 1:return this.getSurface();case 2:return this.getLength()/1e3;case 3:return this.getQuantity();default:return 0}},this.getCost=()=>{var h,o;return this.getMaterialQuantity()*((o=(h=this.material)==null?void 0:h.getCostUnit())!=null?o:0)},this.updateMaterialQuantity=()=>{const h=this.getName();if(!this.panel){console.warn("Panel not defined for ".concat(h));return}if(!this.material){console.warn("unable to update quantity – material missing for ".concat(h));return}if(this.panel.isNested||this.panel.isPatterned)return;const o=this.getMaterialQuantity()*this.getQuantity();this.material.quantity+=o}}getLongest(t,s,e){return this.settings.LengthLongestEdge?e?{length:t,width:s}:s>t?{width:s,length:t}:{length:t,width:s}:{length:t,width:s}}};Ht.fromStockData=(t,s)=>new Ht(t.key,t.refPart,t.refMaterial,t.messages,t.documents,t.variables,s);let Ds=Ht;class Ae extends N{addInstances(t,s){var e;for(const i of t)((e=i.material)==null?void 0:e.variables.MAT_TYPE)===1&&this.add(i.key,Ds.fromStockData(i,s));return this}}class Ye{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b){this.key=t,this.messages=s,this.documents=e,this.variables=i,this.name=a,this.description=n,this.category=r,this.thickness=h,this.hasGrain=o,this.cost=d,this.costUnit=m,this.costType=l,this.quantity=c,this.type=u,this.unitOfMeasure=b,this.resource="materials.panels"}static fromMaterialBusiness(t){return t.createViewModel()}}const Gt=class Gt{constructor(t,s,e,i,a){this.key=t,this.messages=s,this.documents=e,this.variables=i,this.quantity=a,this.createViewModel=()=>new Ye(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Material"),this.getDocuments(),this.variables,this.getName(),this.getDescription(),this.getCategory(),this.getThickness(),this.getHasGrain(),this.getCost(),this.getCostUnit(),this.getCostType(),this.quantity,this.getType(),this.getUnitOfMeasure()),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>{var n;return(n=this.variables.MAT_NAME)!=null?n:""},this.getDescription=()=>{var n;return(n=this.variables.MAT_DESC)!=null?n:""},this.getCategory=()=>{var n;return(n=this.variables.CATEGORY)!=null?n:""},this.getCostUnit=()=>{var n;return(n=this.variables.MAT_UCOST)!=null?n:0},this.getCostType=()=>{var n;return(n=this.variables.MAT_COSTTYPE)!=null?n:0},this.getHasGrain=()=>{var n;return(n=this.variables.MAT_WITHGRAIN)!=null?n:!1},this.getThickness=()=>{var n;return(n=this.variables.MAT_T)!=null?n:0},this.getBoardLength=()=>{var n;return(n=this.variables.BOARD_LENGTH)!=null?n:0},this.getBoardWidth=()=>{var n;return(n=this.variables.BOARD_WIDTH)!=null?n:0},this.getUnitOfMeasure=()=>{switch(this.getCostType()){case 0:return"m³";case 1:return"m²";case 2:return"m";case 3:return"unit";default:return"unknown"}},this.getCost=()=>this.quantity*this.getCostUnit(),this.getType=()=>{var n;return(n=this.variables.MAT_TYPE)!=null?n:0},this.getIsWeldment=()=>{var n;return(n=this.variables.WELDMENT)!=null?n:!1}}};Gt.fromMaterialData=t=>new Gt(t.key,t.messages,t.documents,t.variables,0);let Is=Gt;class Ce extends N{addInstances(t){for(const s of t)this.add(s.key,Is.fromMaterialData(s));return this}}class Pt{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y,v,T,C,A,S,E,B,O,x,F,Q,$,H,G,z,_,Y,X,K,J,tt,st,et,it,at,rt,nt,ht,ot,ct,gt,hs,os,cs,ei,ii,ai,ri,ni,hi,oi=""){this.key=t,this.name=s,this.refPart=e,this.refPrograms=i,this.refStocks=a,this.refProcessZones=n,this.refEdgebands=r,this.messages=h,this.variables=o,this.heritedVariables=d,this.typedObjectVariables=m,this.serialNumbers=l,this.documents=c,this.swcps=u,this.id=b,this.description=f,this.configuration=p,this.quantity=P,this.length=M,this.width=w,this.thickness=y,this.lengthWithEdgeband=v,this.widthWithEdgeband=T,this.thicknessWithLaminate=C,this.lengthWithoutEdgeband=A,this.widthWithoutEdgeband=S,this.thicknessWithoutLaminate=E,this.lengthStock=B,this.widthStock=O,this.thicknessStock=x,this.hasGrain=F,this.hasEdgebands=Q,this.hasLaminates=$,this.hasPrograms=H,this.hasProcessZones=G,this.isCompleted=z,this.isPatterned=_,this.isNested=Y,this.listEdgebandMaterials=X,this.angle=K,this.edgingCode=J,this.edgingCodeOrder=tt,this.volume=st,this.nameHead=et,this.nameTail=it,this.board=at,this.images=rt,this.pdfs=nt,this.cost=ht,this.costUnit=ot,this.costCore=ct,this.costEdgebands=gt,this.costLaminates=hs,this.costPrograms=os,this.costProcessZones=cs,this.hasTopPrograms=ei,this.hasBottomPrograms=ii,this.quantityTopPrograms=ai,this.quantityBottomPrograms=ri,this.combineId=ni,this.settings=hi,this.comment=oi,this.resource="panels",this.stocks=[],this.layers=[],this.edgebands=[],this.laminates=[],this.programs=[],this.processZones=[],this.addChildren=ci=>{this.children||(this.children=[]),this.children.push(ci)}}static fromPanelBusiness(t){return t.createViewModel()}static createCombinedPanel(t,s){return new Pt("combined-panel-".concat(t.key),"Combined Panel ".concat(t.combineId),t.refPart,t.refPrograms,t.refStocks,t.refProcessZones,t.refEdgebands,t.messages,t.variables,t.heritedVariables,t.typedObjectVariables,t.serialNumbers,t.documents,t.swcps,t.id,t.description,t.configuration,s,t.length,t.width,t.thickness,t.lengthWithEdgeband,t.widthWithEdgeband,t.thicknessWithLaminate,t.lengthWithoutEdgeband,t.widthWithoutEdgeband,t.thicknessWithoutLaminate,t.lengthStock,t.widthStock,t.thicknessStock,t.hasGrain,t.hasEdgebands,t.hasLaminates,t.hasPrograms,t.hasProcessZones,t.isCompleted,t.isPatterned,t.isNested,t.listEdgebandMaterials,t.angle,t.edgingCode,t.edgingCodeOrder,t.volume,t.nameHead,t.nameTail,t.board,t.images,t.pdfs,t.cost,t.costUnit,t.costCore,t.costEdgebands,t.costLaminates,t.costPrograms,t.costProcessZones,t.hasTopPrograms,t.hasBottomPrograms,t.quantityTopPrograms,t.quantityBottomPrograms,t.combineId,t.settings)}}const Ci=g=>g.filter((t,s)=>g.indexOf(t)===s),gs=(g,t)=>{var r;let s=[],e="";for(const h of g.edgebands)s.push((r=h.material)==null?void 0:r.getName());s=Ci(s);for(const h of s)e+=h+", ";e=e.slice(0,-2),g.edgebands!=null&&g.edgebands.sort(fs([{Property:"Order",Type:1}],t));const i=[];for(const h of g.edgebands)!h.getIsPaint()&&!h.getIsCurved()?h.getLengthStock()===g.getLengthStock()?g.getLengthStock()>g.getWidthStock()?i.push("L"):i.push("S"):h.getLengthStock()==g.getWidthStock()?g.getLengthStock()>g.getWidthStock()?i.push("S"):i.push("L"):(console.warn("Unable to categorise EB in: "+g.name),i.push("U")):!h.getIsPaint()&&h.getIsCurved()&&i.push("C");let a="";for(let h=0;h<i.length;h++){let o=1;for(;i[h]==i[h+1];)o++,h++;a+=o+i[h],h!=i.length-1&&(a+=t.EBStringSeparator)}i.sort(),t.EBStringReverse&&i.reverse();let n="";for(let h=0;h<i.length;h++){let o=1;for(;i[h]===i[h+1];)o++,h++;n+=o+i[h],h!=i.length-1&&(n+=t.EBStringSeparator)}return{EBString:n,EBStringOrder:a,EdgingListString:e}},Bi=(g,t)=>g?!t||g.includes(t)?g:"".concat(g," | ").concat(t):t,qt=class qt{constructor(t,s,e,i,a,n,r,h,o,d,m,l){this.key=t,this.name=s,this.refPart=e,this.refPrograms=i,this.refStocks=a,this.refProcessZones=n,this.refEdgebands=r,this.messages=h,this.documents=o,this.variables=d,this.serialNumbers=m,this.settings=l,this.programs=[],this.stocks=[],this.edgebands=[],this.laminates=[],this.processZones=[],this.isPatterned=!1,this.isNested=!1,this.getID=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.variables.ID)!=null?u:""},this.getDescription=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.getDescription())!=null?u:""},this.getConfiguration=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.getConfiguration())!=null?u:""},this.getQuantity=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.getQuantity())!=null?u:0},this.getCombineId=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.getCombinedId())!=null?u:0},this.getIsCompleted=()=>{var c;return(c=this.variables.IS_COMPLETED)!=null?c:!1},this.getSwoodLength=()=>this.variables.PAN_L,this.getSwoodWidth=()=>{var c;return(c=this.variables.PAN_W)!=null?c:0},this.getSwoodThickness=()=>this.variables.PAN_T,this.getSwoodLengthWithEdgeband=()=>this.variables.PAN_LWEB,this.getSwoodWidthWithEdgeband=()=>this.variables.PAN_WWEB,this.getSwoodThicknessWithLaminate=()=>this.variables.PAN_TWL,this.getSwoodLengthWithoutEdgeband=()=>this.variables.PAN_LWOEB,this.getSwoodWidthWithoutEdgeband=()=>this.variables.PAN_WWOEB,this.getSwoodThicknessWithoutLaminate=()=>this.variables.PAN_TWOL,this.getSwoodLengthStock=()=>this.variables.PAN_STL,this.getSwoodWidthStock=()=>this.variables.PAN_STW,this.getSwoodThicknessStock=()=>this.variables.PAN_STT,this.getLength=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).length,this.getWidth=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).width,this.getThickness=()=>this.getSwoodThickness(),this.getHasGrain=()=>this.stocks.some(c=>{var u;return((u=c.material)==null?void 0:u.getHasGrain())===!0}),this.getHasEdgebands=()=>this.edgebands.length>0,this.getHasLaminates=()=>this.laminates.length>0,this.getHasPrograms=()=>this.programs.length>0,this.getHasProcessZones=()=>this.processZones.length>0,this.getListEdgebandMaterials=()=>gs(this,this.settings).EdgingListString,this.getAngleGrain=()=>{var b,f;if(!((f=(b=this.getCoreStock())==null?void 0:b.material)!=null&&f.getHasGrain()))return null;const c=this.variables.PAN_ANGLEINPART,u=this.variables.PAN_GRAINANGLEINPART;return c+u},this.getEdgingCode=()=>gs(this,this.settings).EBString,this.getEdgingCodeOrder=()=>gs(this,this.settings).EBStringOrder,this.getLengthWithEdgeband=()=>this.getLongest(this.getSwoodLengthWithEdgeband(),this.getSwoodWidthWithEdgeband(),this.getHasGrain()).length,this.getWidthWithEdgeband=()=>this.getLongest(this.getSwoodLengthWithEdgeband(),this.getSwoodLengthWithEdgeband(),this.getHasGrain()).width,this.getThicknessWithLaminate=()=>this.getSwoodThicknessWithLaminate(),this.getLengthWithoutEdgeband=()=>this.getLongest(this.getSwoodLengthWithoutEdgeband(),this.getSwoodWidthWithoutEdgeband(),this.getHasGrain()).length,this.getWidthWithoutEdgeband=()=>this.getLongest(this.getSwoodLengthWithoutEdgeband(),this.getSwoodWidthWithoutEdgeband(),this.getHasGrain()).width,this.getThicknessWithoutLaminate=()=>this.getSwoodThicknessWithoutLaminate(),this.getLengthStock=()=>this.getLongest(this.getSwoodLengthStock(),this.getSwoodWidthStock(),this.getHasGrain()).length,this.getWidthStock=()=>this.getLongest(this.getSwoodLengthStock(),this.getSwoodWidthStock(),this.getHasGrain()).width,this.getThicknessStock=()=>this.getSwoodThicknessStock(),this.getVolume=()=>this.getLength()*this.getWidth()*this.getThickness()/1e9,this.getSurface=()=>this.getLength()*this.getWidth()/1e6,this.getImages=()=>new j(this.documents).getImages(),this.getPDFs=()=>new ns(this.documents).getPDFs(),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getSwcps=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.swcps)!=null?u:{}},this.getHeritedVariables=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.heritedVariables)!=null?u:{}},this.getTypedObjectVariables=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.typedObjectVariables)!=null?u:{}},this.getMaterialQuantity=()=>{if(!this.material)return console.warn("material not defined for ".concat(this.name)),0;switch(this.material.getCostType()){case 0:return this.getVolume();case 1:return this.getSurface();case 2:return this.getLength()/1e3;case 3:return this.getQuantity();default:return 0}},this.getCost=()=>this.getCostUnit()*this.getQuantity(),this.getCostUnit=()=>this.getCostCore()+this.getCostEdgebands()+this.getCostLaminates()+this.getCostProcessZones(),this.getCostCore=()=>{var c,u;return this.getMaterialQuantity()*((u=(c=this.material)==null?void 0:c.getCostUnit())!=null?u:0)},this.getCostEdgebands=()=>{let c=0;for(const u of this.edgebands)c+=u.getCost();return c},this.getCostLaminates=()=>{let c=0;for(const u of this.laminates)c+=u.getCost();return c},this.getCostPrograms=()=>{let c=0;for(const u of this.programs)c+=u.getCost();return c},this.getCostProcessZone=c=>{if(!c.panelProcess)return console.warn("panelProcess not defined for ".concat(this.name)),0;const u=c.panelProcess.getCostUnit(),b=c.getCostType();let f=0,p=0;switch(b){case 0:f=this.getVolume(),p=u*f;break;case 1:f=this.getSurface(),p=u*f;break;case 2:f=this.getLength()/1e3,p=u*f;break;case 3:f=this.getQuantity(),p=u*f;break;default:return 0}return c.panelProcess.quantity+=f,p},this.getCostProcessZones=()=>{let c=0;for(const u of this.processZones)c+=this.getCostProcessZone(u);return c},this.getQuantityTopPrograms=()=>this.programs.filter(c=>c.getIsTopProgram()).length,this.getQuantityBottomPrograms=()=>this.programs.filter(c=>c.getIsBottomProgram()).length,this.getHasTopPrograms=()=>this.programs.some(c=>c.getIsTopProgram()),this.getHasBottomPrograms=()=>this.programs.some(c=>c.getIsBottomProgram()),this.getBoard=()=>{var b,f,p,P;const c=(f=(b=this.material)==null?void 0:b.getBoardLength())!=null?f:0,u=(P=(p=this.material)==null?void 0:p.getBoardWidth())!=null?P:0;return{length:c,width:u}},this.getIsExcluded=()=>{var u;return((u=this.part)==null?void 0:u.variables.TOTYPES).split(";").includes("EXCLUDED")},this.updateMaterialQuantity=()=>{if(!this.material){console.warn("unable to update quantity – material missing for ".concat(this.name));return}if(this.isNested||this.isPatterned||this.getIsExcluded())return;const c=this.getMaterialQuantity()*this.getQuantity();this.material.quantity+=c}}createViewModel(){return this.updateMaterialQuantity(),new Pt(this.key,this.name,this.refPart,this.refPrograms,this.refStocks,this.refProcessZones,this.refEdgebands,D.fromMessagesRaw(this.messages,this.name,"Panel"),this.variables,this.getHeritedVariables(),this.getTypedObjectVariables(),this.serialNumbers,this.getDocuments(),this.getSwcps(),this.getID(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getLengthWithEdgeband(),this.getWidthWithEdgeband(),this.getThicknessWithLaminate(),this.getLengthWithoutEdgeband(),this.getWidthWithoutEdgeband(),this.getThicknessWithoutLaminate(),this.getLengthStock(),this.getWidthStock(),this.getThicknessStock(),this.getHasGrain(),this.getHasEdgebands(),this.getHasLaminates(),this.getHasPrograms(),this.getHasProcessZones(),this.getIsCompleted(),this.isPatterned,this.isNested,this.getListEdgebandMaterials(),this.getAngleGrain(),this.getEdgingCode(),this.getEdgingCodeOrder(),this.getVolume(),this.getNameHead(),this.getNameTail(),this.getBoard(),this.getImages(),this.getPDFs(),this.getCost(),this.getCostUnit(),this.getCostCore(),this.getCostEdgebands(),this.getCostLaminates(),this.getCostPrograms(),this.getCostProcessZones(),this.getHasTopPrograms(),this.getHasBottomPrograms(),this.getQuantityTopPrograms(),this.getQuantityBottomPrograms(),this.getCombineId(),this.settings)}createCombinedViewModel(){return new Pt("combined-panel-".concat(this.getCombineId()),"Combined Panel ".concat(this.getCombineId()),this.refPart,this.refPrograms,this.refStocks,this.refProcessZones,this.refEdgebands,D.fromMessagesRaw(this.messages,"Panel"),this.variables,this.getHeritedVariables(),this.getTypedObjectVariables(),this.serialNumbers,this.getDocuments(),this.getSwcps(),this.getID(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getLengthWithEdgeband(),this.getWidthWithEdgeband(),this.getThicknessWithLaminate(),this.getLengthWithoutEdgeband(),this.getWidthWithoutEdgeband(),this.getThicknessWithoutLaminate(),this.getLengthStock(),this.getWidthStock(),this.getThicknessStock(),this.getHasGrain(),this.getHasEdgebands(),this.getHasLaminates(),this.getHasPrograms(),this.getHasProcessZones(),this.getIsCompleted(),this.isPatterned,this.isNested,this.getListEdgebandMaterials(),this.getAngleGrain(),this.getEdgingCode(),this.getEdgingCodeOrder(),this.getVolume(),this.getNameHead(),this.getNameTail(),this.getBoard(),this.getImages(),this.getPDFs(),this.getCost(),this.getCostUnit(),this.getCostCore(),this.getCostEdgebands(),this.getCostLaminates(),this.getCostPrograms(),this.getCostProcessZones(),this.getHasTopPrograms(),this.getHasBottomPrograms(),this.getQuantityTopPrograms(),this.getQuantityBottomPrograms(),this.getCombineId(),this.settings)}getLongest(t,s,e){return this.settings.LengthLongestEdge?e?{length:t,width:s}:s>t?{width:s,length:t}:{length:t,width:s}:{length:t,width:s}}getCoreStock(){for(const t of this.stocks)if(t.variables.ST_N==="CORE")return t}getNameTail(){const t=this.name.lastIndexOf("_");return t===-1?this.name:this.name.substring(t+1,this.name.length)}getNameHead(){const t=this.name.indexOf("_");return t===-1?this.name:this.name.substring(0,t)}};qt.fromPanelData=(t,s)=>new qt(t.key,t.name,t.refPart,t.refPrograms,t.refStocks,t.refProcessZones,t.refEdgebands,t.messages,t.documents,t.variables,t.serialNumbers,s);let Ts=qt;class Be extends N{constructor(){super(...arguments),this.addStocks=t=>{const s=this.getAll();for(const e of s)for(const i of e.refStocks){const a=t.get(i);a&&(e.stocks.push(a),a.variables.ST_N==="CORE"&&(e.material=a.material))}},this.addPrograms=t=>{const s=this.getAll();for(const e of s)for(const i of e.refPrograms){const a=t.get(i);a&&(e.programs.push(a),a.panel=e)}},this.addEdgebands=t=>{const s=this.getAll();for(const e of s)for(const i of e.refEdgebands){const a=t.get(i);a&&(e.edgebands.push(a),a.panel=e)}},this.addLaminates=t=>{const s=this.getAll();for(const e of s)for(const i of e.refStocks){const a=t.get(i);a&&(e.laminates.push(a),a.panel=e)}}}addInstances(t,s){for(const e of t)this.add(e.key,Ts.fromPanelData(e,s));return this}}class Xe{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M){this.key=t,this.refPrograms=s,this.refStocks=e,this.refPanel=i,this.bodyCount=a,this.messages=n,this.variables=r,this.heritedVariables=h,this.typedObjectVariables=o,this.documents=d,this.swcps=m,this.name=l,this.description=c,this.configuration=u,this.quantity=b,this.height=f,this.width=p,this.depth=P,this.images=M,this.resource="parts",this.programs=[],this.stocks=[]}static fromPartBusiness(t){return t.createViewModel()}}const Zt=class Zt{constructor(t,s,e,i,a,n,r,h,o,d,m){this.key=t,this.refPrograms=s,this.refStocks=e,this.refPanel=i,this.bodyCount=a,this.messages=n,this.variables=r,this.heritedVariables=h,this.typedObjectVariables=o,this.documents=d,this.swcps=m,this.programs=[],this.stocks=[],this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>{var l;return(l=this.variables.NAME)!=null?l:""},this.getDescription=()=>this.variables.DESC,this.getConfiguration=()=>{var l;return(l=this.variables.CONF)!=null?l:""},this.getQuantity=()=>{var l;return((l=this.variables.NB)!=null?l:0)*W.getInstance().projectQuantity},this.getImages=()=>new j(this.documents).getImages(),this.getCombinedId=()=>{var l;return(l=this.variables.CombineID)!=null?l:0}}createViewModel(){return new Xe(this.key,this.refPrograms,this.refStocks,this.refPanel,this.bodyCount,D.fromMessagesRaw(this.messages,this.getName(),"Part"),this.variables,this.heritedVariables,this.typedObjectVariables,this.getDocuments(),this.swcps,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),0,0,0,this.getImages())}};Zt.fromPartData=t=>new Zt(t.key,t.refPrograms,t.refStocks,t.refPanel,t.bodyCount,t.messages,t.variables,t.heritedVariables,t.typedObjectVariables,t.documents,t.swcps);let ks=Zt;class Se extends N{constructor(){super(...arguments),this.addStocks=t=>{var e;const s=this.getAll();for(const i of s)for(const a of(e=i.refStocks)!=null?e:[]){const n=t.get(a);n&&(i.stocks.push(n),n.part=i)}},this.addPrograms=t=>{const s=this.getAll();for(const e of s)for(const i of e.refPrograms){const a=t.get(i);a&&(e.programs.push(a),a.part=e)}}}addInstances(t){for(const s of t)this.add(s.key,ks.fromPartData(s));return this}}const ge=class ge{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y,v,T,C,A,S,E){this.key=t,this.refTools=s,this.programParts=e,this.refBoard=i,this.variables=a,this.heritedVariables=n,this.typedObjectVariables=r,this.messages=h,this.documents=o,this.swcps=d,this.name=m,this.description=l,this.configuration=c,this.quantity=u,this.length=b,this.width=f,this.thickness=p,this.url=P,this.cost=M,this.costHour=w,this.time=y,this.isTopProgram=v,this.isBottomProgram=T,this.machine=C,this.images=A,this.programFilepath=S,this.programFile=E,this.resource="programs",this.tools=[]}};ge.fromProgramBusiness=t=>t.createViewModel();let Tt=ge;const zt=class zt{constructor(t,s,e,i,a,n,r){this.key=t,this.refTools=s,this.programParts=e,this.refBoard=i,this.variables=a,this.messages=n,this.documents=r,this.tools=[],this.getDocuments=()=>new V(this.documents).getDocuments(),this.getSwcps=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.swcps)!=null?o:{}},this.getHeritedVariables=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.heritedVariables)!=null?o:{}},this.getTypedObjectVariables=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.typedObjectVariables)!=null?o:{}},this.getName=()=>this.variables.PROG_PHASENAME,this.getDescription=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.getDescription())!=null?o:""},this.getConfiguration=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.getConfiguration())!=null?o:""},this.getQuantity=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.getQuantity())!=null?o:0},this.getLength=()=>{var h;return(h=this.variables.PROGBX)!=null?h:0},this.getWidth=()=>{var h;return(h=this.variables.PROGBY)!=null?h:0},this.getThickness=()=>{var h;return(h=this.variables.PROGBZ)!=null?h:0},this.getUrl=()=>"programs/".concat(this.key),this.getImages=()=>new j(this.documents).getImages(),this.getCostHour=()=>{var h;return(h=this.variables.PROGMAC_HOURCOST)!=null?h:0},this.getTotalTime=()=>{var h;return(h=this.variables.PROGTPS)!=null?h:0},this.getCost=()=>this.getCostHour()*this.getTotalTime()/3600,this.getIsTopProgram=()=>this.variables.PROG_OP0ZXPANELZ===1,this.getIsBottomProgram=()=>this.variables.PROG_OP0ZXPANELZ===-1,this.getMachine=()=>{var h;return(h=this.variables.PROGMAC)!=null?h:""},this.getProgramFilepath=()=>{var h;return(h=this.variables.PROGPATH)!=null?h:""},this.getProgramFile=()=>{const h=this.documents.find(o=>o.objType==="PROGRAM"&&o.type===null&&o.docType===null);return h||console.warn("unable to find program file for program: ".concat(this.getName())),h}}createViewModel(){return new Tt(this.key,this.refTools,this.programParts,this.refBoard,this.variables,this.getHeritedVariables(),this.getTypedObjectVariables(),D.fromMessagesRaw(this.messages,this.getName(),"Program",this.getUrl()),this.getDocuments(),this.getSwcps(),this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getUrl(),this.getCost(),this.getCostHour(),this.getTotalTime(),this.getIsTopProgram(),this.getIsBottomProgram(),this.getMachine(),this.getImages(),this.getProgramFilepath(),this.getProgramFile())}};zt.fromProgramData=t=>new zt(t.key,t.refTools,t.refProgramParts,t.refBoard,t.variables,t.messages,t.documents);let vs=zt;class Ee extends N{addInstances(t){for(const s of t)s.refBoard||this.add(s.key,vs.fromProgramData(s));return this}addTools(t){const s=this.getAll();for(const e of s)for(const i of e.refTools){const a=t.get(i);a&&e.tools.push(a)}}}const le=class le{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f){this.key=t,this.refPart=s,this.refProgram=e,this.documents=i,this.messages=a,this.variables=n,this.images=r,this.name=h,this.description=o,this.configuration=d,this.quantity=m,this.quantityInSheet=l,this.quantityInProject=c,this.programPartId=u,this.angle=b,this.parent=f,this.resource="programParts"}};le.fromProgramPartBusiness=t=>t.createViewModel();let kt=le;const _t=class _t{constructor(t,s,e,i,a,n){this.key=t,this.refPart=s,this.refProgram=e,this.documents=i,this.messages=a,this.variables=n,this.sheets=[],this.getDocuments=()=>new V(this.documents).getDocuments(),this.getImages=()=>new j(this.documents).getImages(),this.getName=()=>{var r;return(r=this.panel)==null?void 0:r.name},this.getDescription=()=>{var r,h;return(h=(r=this.part)==null?void 0:r.getDescription())!=null?h:""},this.getConfiguration=()=>{var r,h;return(h=(r=this.part)==null?void 0:r.getConfiguration())!=null?h:""},this.getQuantity=()=>{var r,h;return((h=(r=this.sheet)==null?void 0:r.getQuantity())!=null?h:0)*W.getInstance().projectQuantity},this.getQuantityInSheet=()=>{var r,h;return((h=(r=this.sheet)==null?void 0:r.programParts)!=null?h:[]).filter(o=>this.getName()===o.getName()).length},this.getQuantityInProject=()=>{var h;let r=0;for(const o of this.sheets)for(const d of o.programParts)((h=d.part)==null?void 0:h.getName())===this.getName()&&(r+=o.getQuantity()*W.getInstance().projectQuantity);return r},this.getProgramPartId=()=>this.variables.PROGPART_ID,this.getAngle=()=>this.variables.PROGPART_NANGLE,this.getParentIndex=()=>this.variables.PROGPART_NPARENTINDEX,this.getParentName=()=>this.variables.PROGPART_NPARENTNAME,this.getParentPath=()=>this.variables.PROGPART_NPARENTPATH,this.getParentConfiguration=()=>this.variables.PROGPART_NPARENTCONFIG}createViewModel(){return new kt(this.key,this.refPart,this.refProgram,this.getDocuments(),D.fromMessagesRaw(this.messages,this.getName(),"Program Part"),this.variables,this.getImages(),this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getQuantityInSheet(),this.getQuantityInProject(),this.getProgramPartId(),this.getAngle(),{index:this.getParentIndex(),name:this.getParentName(),configuration:this.getParentConfiguration(),filepath:this.getParentPath()})}};_t.fromProgramPartData=t=>new _t(t.key,t.part,t.program,t.documents,t.messages,t.variables);let As=_t;class Ne extends N{addInstances(t){for(const s of t)this.add(s.key,As.fromProgramPartData(s));return this}}const Yt=class Yt{constructor(t,s,e,i){this.key=t,this.messages=s,this.documents=e,this.variables=i}};Yt.fromSpindleData=t=>new Yt(t.key,t.messages,t.documents,t.variables);let Cs=Yt;class Oe extends N{addInstances(t){if(!t)return this;for(const s of t)this.add(s.key,Cs.fromSpindleData(s));return this}}const mt=class mt{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b){this.key=t,this.refPart=s,this.refMaterial=e,this.messages=i,this.documents=a,this.swcps=n,this.variables=r,this.name=h,this.description=o,this.configuration=d,this.quantity=m,this.length=l,this.width=c,this.thickness=u,this.angle=b,this.resource="stocks"}};mt.fromStockBusiness=t=>t.createViewModel(),mt.createCombinedStock=(t,s,e)=>new mt(t.key,t.refPart,t.refMaterial,t.messages,t.documents,t.swcps,t.variables,s,t.description,t.configuration,e,t.length,t.width,t.thickness,t.angle);let Mt=mt;const Xt=class Xt{constructor(t,s,e,i,a,n){this.key=t,this.refPart=s,this.refMaterial=e,this.messages=i,this.documents=a,this.variables=n,this.createViewModel=()=>new Mt(this.key,this.refPart,this.refMaterial,D.fromMessagesRaw(this.messages,this.getName(),"Stock"),this.documents,this.getSwcps(),this.variables,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getAngle()),this.getSwcps=()=>{var r,h;return(h=(r=this.part)==null?void 0:r.swcps)!=null?h:{}},this.getName=()=>{var r,h;return(h=(r=this.panel)==null?void 0:r.name)!=null?h:""},this.getDescription=()=>{var r,h;return(h=(r=this.part)==null?void 0:r.getDescription())!=null?h:""},this.getConfiguration=()=>{var r,h;return(h=(r=this.part)==null?void 0:r.getConfiguration())!=null?h:""},this.getQuantity=()=>{var r,h;return(h=(r=this.part)==null?void 0:r.getQuantity())!=null?h:0},this.getLength=()=>this.variables.ST_L,this.getWidth=()=>this.variables.ST_W,this.getThickness=()=>this.variables.ST_T,this.getAngle=()=>{var r;return(r=this.variables.ST_ANGLEINPANEL)!=null?r:0}}};Xt.fromStockData=t=>new Xt(t.key,t.refPart,t.refMaterial,t.messages,t.documents,t.variables);let Bs=Xt;class Re extends N{constructor(){super(...arguments),this.addMaterials=t=>{const s=this.getAll();for(const e of s){const i=t.get(e.refMaterial);i&&(e.material=i)}}}addInstances(t){for(const s of t)this.add(s.key,Bs.fromStockData(s));return this}}const de=class de{constructor(t,s,e,i,a,n,r,h,o){this.key=t,this.messages=s,this.documents=e,this.variables=i,this.refSpindles=a,this.name=n,this.reference=r,this.number=h,this.diameter=o,this.spindles=[]}};de.fromToolBusiness=t=>t.createViewModel();let vt=de;class ie{constructor(t,s,e,i,a=[]){this.key=t,this.variables=s,this.messages=e,this.documents=i,this.refSpindles=a,this.createViewModel=()=>new vt(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Tool"),this.getDocuments(),this.variables,this.refSpindles,this.getName(),this.getReference(),this.getNumber(),this.getDiameter()),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>this.variables.TOOL_NAME,this.getReference=()=>this.variables.TOOL_REFERENCE,this.getNumber=()=>this.variables.TOOL_DIAM,this.getDiameter=()=>this.variables.TOOL_NUMBER}static fromToolData(t){return new ie(t.key,t.variables,t.messages,t.documents,t.refSpindles)}}class Ve extends N{addInstances(t){for(const s of t)this.add(s.key,ie.fromToolData(s));return this}}class Le{constructor(){this.instances=new Map}addInstance(t,s){const e=this.instances.get(t);e?e.push(s):this.instances.set(t,[s])}addInstances(t,s,e){for(const i of t.typedObjects){const a=s.get(i);if(a){const r=a.variables.TOTYPES.split(";");for(const h of r)this.addInstance(h,a)}const n=e.get(i);if(n){const r=n.variables.TOTYPES.split(";");for(const h of r)this.addInstance(h,n)}}return this}getInstancesByName(t){return this.instances.get(t)||void 0}getAll(){return this.instances}}const ue=class ue{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y){this.key=t,this.refTools=s,this.refProgramParts=e,this.refBoard=i,this.variables=a,this.messages=n,this.documents=r,this.name=h,this.quantity=o,this.programFilename=d,this.programFilepath=m,this.comments=l,this.totalParts=c,this.totalOffcuts=u,this.machine=b,this.length=f,this.width=p,this.thickness=P,this.url=M,this.images=w,this.programFile=y,this.resource="sheets",this.tools=[],this.programParts=[]}};ue.fromProgramBusiness=t=>t.createViewModel();let At=ue;const Kt=class Kt{constructor(t,s,e,i,a,n,r){this.key=t,this.refTools=s,this.refProgramParts=e,this.refBoard=i,this.variables=a,this.messages=n,this.documents=r,this.programParts=[],this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>this.variables.PROG_PHASENAME,this.getQuantity=()=>{var h;return((h=this.variables.PROG_NSHEETQTY)!=null?h:0)*W.getInstance().projectQuantity},this.getProgramFilename=()=>this.variables.PROGCFGFILE,this.getProgramFilepath=()=>this.variables.PROGCFGPATH,this.getProgramComment=()=>this.variables.PROGCOMMENT,this.getTotalParts=()=>this.variables.PROG_PARTCOUNT,this.getTotalOffcuts=()=>this.variables.PROG_OFFCUTCOUNT,this.getMachine=()=>this.variables.PROGMAC,this.getLength=()=>this.variables.PROGBX,this.getWidth=()=>this.variables.PROGBY,this.getThickness=()=>this.variables.PROGBZ,this.getUrl=()=>"sheets/".concat(this.key),this.getImages=()=>new j(this.documents).getImages(),this.getProgramFile=()=>{const h=this.documents.find(o=>o.objType==="PROGRAM"&&o.type===null&&o.docType===null);return h||console.warn("unable to find program file for program: ".concat(this.getName())),h}}createViewModel(){return new At(this.key,this.refTools,this.refProgramParts,this.refBoard,this.variables,D.fromMessagesRaw(this.messages,this.getName(),"Sheet",this.getUrl()),this.getDocuments(),this.getName(),this.getQuantity(),this.getProgramFilename(),this.getProgramFilepath(),this.getProgramComment(),this.getTotalParts(),this.getTotalOffcuts(),this.getMachine(),this.getLength(),this.getWidth(),this.getThickness(),this.getUrl(),this.getImages(),this.getProgramFile())}};Kt.fromProgramData=t=>new Kt(t.key,t.refTools,t.refProgramParts,t.refBoard,t.variables,t.messages,t.documents);let Ss=Kt;class We extends N{addInstances(t){for(const s of t)s.refBoard&&this.add(s.key,Ss.fromProgramData(s));return this}}const me=class me{constructor(t,s,e,i,a,n,r,h,o,d,m,l){this.key=t,this.messages=s,this.documents=e,this.variables=i,this.name=a,this.description=n,this.quantity=r,this.thickness=h,this.category=o,this.cost=d,this.costUnit=m,this.costType=l,this.resource="panelProcesses"}};me.fromPanelProcessBusiness=t=>t.createViewModel();let Es=me;class ae{constructor(t,s,e,i,a){this.key=t,this.messages=s,this.documents=e,this.variables=i,this.quantity=a,this.createViewModel=()=>new Es(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Panel Process"),this.documents,this.variables,this.getName(),this.getDescription(),this.quantity,this.getThickness(),this.getCategory(),this.getCost(),this.getCostUnit(),this.getCostType()),this.getName=()=>this.variables.PROC_NAME,this.getDescription=()=>this.variables.PROC_DESC,this.getThickness=()=>this.variables.PROC_THICKNESS,this.getCategory=()=>this.variables.PROC_CAT,this.getCostUnit=()=>this.variables.PROC_UCOST,this.getCost=()=>this.quantity*this.getCostUnit(),this.getCostType=()=>this.variables.PROC_COSTTYPE}static fromPanelProcessData(t){return new ae(t.key,t.messages,t.documents,t.variables,0)}}class xe extends N{addInstances(t){if(!t)return this;for(const s of t)this.add(s.key,ae.fromPanelProcessData(s));return this}}const fe=class fe{constructor(t,s,e,i,a,n,r,h,o,d,m){this.key=t,this.refPanel=s,this.refPanelProcess=e,this.messages=i,this.documents=a,this.variables=n,this.name=r,this.quantity=h,this.unitOfMeasure=o,this.cost=d,this.mask=m,this.resource="processZones"}};fe.fromProcessZoneBusiness=t=>t.createViewModel();let Ns=fe;class re{constructor(t,s,e,i,a,n){this.key=t,this.refPanel=s,this.refPanelProcess=e,this.messages=i,this.documents=a,this.variables=n,this.createViewModel=()=>new Ns(this.key,this.refPanel,this.refPanelProcess,D.fromMessagesRaw(this.messages,this.getName(),"Process Zone"),this.documents,this.variables,this.getName(),this.getQuantity(),this.getUnitOfMeasure(),this.getCost(),this.getMask()),this.getName=()=>this.variables.PROC_ZONENAME,this.getQuantity=()=>this.variables.PROC_ZONE_QTT,this.getUnitOfMeasure=()=>this.variables.PROC_ZONE_QTT_UNIT,this.getCost=()=>this.variables.PROC_ZONE_COST,this.getMask=()=>this.variables.PROC_ZONEMASK,this.getCostUnit=()=>this.panelProcess?this.panelProcess.getCostUnit():0,this.getCostType=()=>this.panelProcess?this.panelProcess.getCostType():0}static fromProcessZoneData(t){return new re(t.key,t.refPanel,t.refPanelProcess,t.messages,t.documents,t.variables)}}class Fe extends N{addInstances(t){if(!t)return this;for(const s of t)this.add(s.key,re.fromProcessZoneData(s));return this}}class lt{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w){this.key=t,this.refPart=s,this.refMaterial=e,this.messages=i,this.documents=a,this.swcps=n,this.variables=r,this.heritedVariables=h,this.typedObjectVariables=o,this.name=d,this.description=m,this.configuration=l,this.quantity=c,this.length=u,this.lengthTotal=b,this.width=f,this.thickness=p,this.angle1=P,this.angle2=M,this.cutlist=w,this.resource="weldments",this.addChildren=y=>{this.children||(this.children=[]),this.children.push(y)}}static fromWeldmentBusiness(t){return t.createViewModel()}static fromWeldmentBusinessChild(t){return t.createViewModelChild()}}const Jt=class Jt{constructor(t,s,e,i,a,n){this.key=t,this.refPart=s,this.refMaterial=e,this.messages=i,this.documents=a,this.variables=n,this.getDocuments=()=>new V(this.documents).getDocuments(),this.getSwcps=()=>{var r,h;return(h=(r=this.part)==null?void 0:r.swcps)!=null?h:{}},this.getHeritedVariables=()=>{var r,h;return(h=(r=this.part)==null?void 0:r.heritedVariables)!=null?h:{}},this.getTypedObjectVariables=()=>{var r,h;return(h=(r=this.part)==null?void 0:r.typedObjectVariables)!=null?h:{}},this.getName=()=>{var r;return(r=this.variables.ST_N)!=null?r:""},this.getDescription=()=>{var r;return(r=this.variables.MBS_Description)!=null?r:""},this.getConfiguration=()=>{var r,h;return(h=(r=this.part)==null?void 0:r.getConfiguration())!=null?h:""},this.getPartQuantity=()=>{var r,h;return(h=(r=this.part)==null?void 0:r.getQuantity())!=null?h:0},this.getQuantity=()=>{var r;return(r=this.variables.MBS_Quantity)!=null?r:0*this.getPartQuantity()},this.getLength=()=>this.variables.MBS_Length,this.getLengthTotal=()=>this.variables.MBS_TotalLength,this.getWidth=()=>this.variables.ST_W,this.getThickness=()=>this.variables.ST_T,this.getAngle1=()=>{var r;return(r=this.variables.MBS_Angle1)!=null?r:""},this.getAngle2=()=>{var r;return(r=this.variables.MBS_Angle2)!=null?r:""},this.getCutlist=()=>{var r;return(r=this.variables.MBS_Cutlist)!=null?r:""}}createViewModel(){return new lt(this.key,this.refPart,this.refMaterial,D.fromMessagesRaw(this.messages,this.getName(),"Weldment"),this.getDocuments(),this.getSwcps(),this.variables,this.getHeritedVariables(),this.getTypedObjectVariables(),this.getCutlist(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getLengthTotal(),this.getWidth(),this.getThickness(),this.getAngle1(),this.getAngle2(),this.getCutlist())}createViewModelChild(){return new lt(this.key,this.refPart,this.refMaterial,D.fromMessagesRaw(this.messages,this.getName(),"Weldment"),this.getDocuments(),this.getSwcps(),this.variables,this.getHeritedVariables(),this.getTypedObjectVariables(),this.getName(),this.getDescription(),this.getConfiguration(),1,this.getLength(),this.getLengthTotal(),this.getWidth(),this.getThickness(),this.getAngle1(),this.getAngle2(),this.getCutlist())}};Jt.fromStockData=t=>new Jt(t.key,t.refPart,t.refMaterial,t.messages,t.documents,t.variables);let Os=Jt;class Qe extends N{addInstances(t){var s;for(const e of t)(s=e.material)!=null&&s.variables.WELDMENT&&this.add(e.key,Os.fromStockData(e));return this}}class Ke{constructor(t,s,e,i,a,n,r,h,o,d,m,l){this.key=t,this.messages=s,this.documents=e,this.variables=i,this.name=a,this.description=n,this.cost=r,this.costUnit=h,this.costType=o,this.quantity=d,this.type=m,this.unitOfMeasure=l}static fromMaterialBusiness(t){return t.createViewModel()}}const ts=class ts{constructor(t,s,e,i,a,n){this.key=t,this.description=s,this.messages=e,this.documents=i,this.variables=a,this.quantity=n,this.createViewModel=()=>new Ke(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Weldment Material"),this.getDocuments(),this.variables,this.getName(),this.description,this.getCost(),this.getCostUnit(),this.getCostType(),this.quantity,this.getType(),this.getUnitOfMeasure()),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>{var r;return(r=this.variables.MAT_NAME)!=null?r:""},this.getDescription=()=>{var r;return(r=this.variables.MAT_DESC)!=null?r:""},this.getCostUnit=()=>{var r;return(r=this.variables.MAT_UCOST)!=null?r:0},this.getCostType=()=>{var r;return(r=this.variables.MAT_COSTTYPE)!=null?r:0},this.getBoardLength=()=>{var r;return(r=this.variables.BOARD_LENGTH)!=null?r:0},this.getBoardWidth=()=>{var r;return(r=this.variables.BOARD_WIDTH)!=null?r:0},this.getUnitOfMeasure=()=>{switch(this.getCostType()){case 0:return"m³";case 1:return"m²";case 2:return"m";case 3:return"unit";default:return"unknown"}},this.getCost=()=>this.quantity*this.getCostUnit(),this.getType=()=>{var r;return(r=this.variables.MAT_TYPE)!=null?r:0},this.getIsWeldment=()=>{var r;return(r=this.variables.WELDMENT)!=null?r:!1}}};ts.fromMaterialData=(t,s)=>new ts("".concat(t.key,"-").concat(s.getDescription()," "),s.getDescription(),t.messages,t.documents,t.variables,s.getLengthTotal()/1e3);let Rs=ts;class je extends N{addInstances(t,s){for(const e of s){const i=t.get(e.refMaterial);if(i&&i.getIsWeldment()){const a=Rs.fromMaterialData(i,e);this.add(a.key,a)}}return this}}const be=class be{constructor(t,s,e,i,a,n,r,h,o,d,m){this.key=t,this.messages=s,this.documents=e,this.swcps=i,this.variables=a,this.heritedVariables=n,this.typedObjectVariables=r,this.name=h,this.description=o,this.configuration=d,this.quantity=m,this.resource="excluded"}};be.fromExcludedBusiness=t=>t.createViewModel();let Ct=be;const ss=class ss{constructor(t,s,e,i,a,n,r,h,o){this.key=t,this.messages=s,this.heritedVariables=e,this.typedObjectVariables=i,this.refParts=a,this.refAssemblies=n,this.documents=r,this.swcps=h,this.variables=o,this.parts=[],this.assemblies=[],this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>this.variables.NAME,this.getDescription=()=>this.variables.DESC,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>this.variables.NB}createViewModel(){return new Ct(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Excluded"),this.getDocuments(),this.swcps,this.variables,this.heritedVariables,this.typedObjectVariables,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity())}};ss.fromAssemblyPartBusiness=t=>new ss(t.key,t.messages,t.heritedVariables,t.typedObjectVariables,"refParts"in t?t.refParts:[],"refAssemblies"in t?t.refAssemblies:[],t.documents,t.swcps,t.variables);let Vs=ss;class $e extends I{constructor(){super(...arguments),this.FrameTypedObjectName="EXCLUDED"}addInstances(t){var e;const s=(e=t.getInstancesByName(this.FrameTypedObjectName))!=null?e:[];for(const i of s)this.addInstance(i.key,Vs.fromAssemblyPartBusiness(i));return this}}class Je{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y,v,T,C,A,S,E,B){this.key=t,this.name=s,this.url=e,this.refBoard=i,this.quantity=a,this.length=n,this.width=r,this.thickness=h,this.cutterThickness=o,this.areaTotal=d,this.areaPanels=m,this.areaWaste=l,this.areaTrims=c,this.areaCuts=u,this.percentagePanels=b,this.percentageWaste=f,this.percentageTrims=p,this.quantityPanels=P,this.quantityWaste=M,this.quantityTrims=w,this.quantityCuts=y,this.lengthCuts=v,this.stock=T,this.refPanels=C,this.items=A,this.cuts=S,this.trims=E,this.waste=B,this.resource="patterns",this.panels=[]}static fromPatternBusiness(t){return t.createViewModel()}}class Ls{constructor(t){this.cuts=[],this.length=t.length,this.width=t.width,this.cutDirection=t.cutDirection,this.coordinate=t.cutCoordinate,this.stockLeft=t.stockLeft?t.stockLeft:null,this.stockRight=t.stockRight?t.stockRight:null}}class ne{constructor(t){var s,e;this.indexParent=-1,this.children=[],this.cuts=[],this.parent=null,this.quantity=1,this.stock=t,this.type=t.type,this.length=t.length,this.width=t.width,this.grain=t.grain,this.cutDirection=t.cutDirection,this.cutterThickness=t.cutterThickness,this.name=(e=(s=t.name)!=null?s:t.type)!=null?e:"group",this.cutCoordinate=t.cutCoordinate,this.x=t.x,this.y=t.y,this.parent=t.parent?new ne(t.parent):null}}class Bt{constructor(t){var s,e;this.parent=null,this.index=0,this.indexPanel=0,this.indexParent=-1,this.children=[],this.cuts=[],this.stock=t,this.type=t.type,this.length=t.length,this.width=t.width,this.grain=t.grain,this.cutDirection=t.cutDirection,this.cutterThickness=t.cutterThickness,this.name=(e=(s=t.name)!=null?s:t.type)!=null?e:"group",this.cutCoordinate=t.cutCoordinate,this.x=t.x,this.y=t.y,this.parent=t.parent?new Bt(t.parent):null}getTrimSide(t){for(const s of this.children)if(s.type==="trimming"||s.type==="padding"){if(t==="length"&&this.cutDirection==="V")return this.cutCoordinate;if(t==="width"&&this.cutDirection==="H")return this.cutCoordinate}return 0}getGroupedNodes(){const t=[];for(const s of this.children){const e=new ne(s.stock);this.isPreviousEqual(e,t[t.length-1])?t[t.length-1].quantity++:t.push(e)}return t}isPreviousEqual(t,s){return s?t.length===s.length&&t.width===s.width&&t.type===s.type:!1}}class St{constructor(t,s=null,e=0,i=0){this.type=t.type,this.length=t.length*1e3,this.width=t.width*1e3,this.cutDirection=t.cut,this.name=t["panel-name"]!=""?t["panel-name"]:null,this.cutCoordinate=t["cut-coordinate"]*1e3,this.grain=t["grain-direction"],this.cutterThickness=t["cut-half-thickness"]*2*1e3,this.parent=s,this.x=e,this.y=i;let a=0,n=0,r=0,h=0;t.cut==="V"&&(r=this.x+this.cutCoordinate+this.cutterThickness,h=this.y,a=this.x,n=this.y),t.cut==="H"&&(r=this.x,h=this.y+this.cutCoordinate+this.cutterThickness,a=this.x,n=this.y),this.stockLeft=t["left-stock"]?new St(t["left-stock"],this,a,n):null,this.stockRight=t["right-stock"]?new St(t["right-stock"],this,r,h):null}getTreeStructure(){const t=new Bt(this),s=this.findChildren(t,this.stockLeft),e=this.findChildren(t,this.stockRight);t.children=[...s,...e];const i=new Ls(this),a=this.findCuts(i,this.stockLeft),n=this.findCuts(i,this.stockRight);return t.cuts=[...a,...n],t}findChildren(t,s){if(!s)return[];const e=new Bt(s);if(e.indexParent=t.index,s.type===null){if(t.cutDirection===s.cutDirection){const n=this.findChildren(t,s.stockLeft),r=this.findChildren(t,s.stockRight);return[...n,...r]}const i=this.findChildren(e,s.stockLeft),a=this.findChildren(e,s.stockRight);e.children=[...i,...a]}return[e]}findCuts(t,s){if(!s)return[];const e=new Ls(s);if(s.type===null){if(t.cutDirection===s.cutDirection){const n=this.findCuts(t,s.stockLeft),r=this.findCuts(t,s.stockRight);return[...n,...r]}const i=this.findCuts(e,s.stockLeft),a=this.findCuts(e,s.stockRight);e.cuts=[...i,...a]}return[e]}}const es=class es{constructor(t,s,e,i,a,n,r,h,o,d){this.key=t,this.name=s,this.material=e,this.stock=i,this.length=a,this.width=n,this.thickness=r,this.cutterThickness=h,this.panelsBusiness=o,this.url=d,this.getQuantity=()=>W.getInstance().projectQuantity}createViewModel(){return new Je(this.key,this.name,this.url,this.material,this.getQuantity(),this.length,this.width,this.thickness*1e3,this.cutterThickness,this.getTotalArea(),this.getPanelArea(),this.getWasteArea(),this.getTrimArea(),this.getCutArea(),this.getPanelAreaPercentage(),this.getWasteAreaPercentage(),this.getTrimAreaPercentage(),this.getRefPanels().length,this.getTrims().length,this.getWaste().length,this.getCuts().length,this.getLengthCuts(),this.stock,this.getRefPanels(),this.getItems(),this.getCuts(),this.getTrims(),this.getWaste())}getCuts(t=[],s){return s||(s=this.stock),s.cutDirection&&t.push(new Ls(s)),s.stockLeft&&this.getCuts(t,s.stockLeft),s.stockRight&&this.getCuts(t,s.stockRight),t}getItems(t=!1){const s=this.getFlattenedTreeStructure(t),e=[];for(const i of s)i.type&&e.push(i);return e}getPanels(t=!1){const s=this.getFlattenedTreeStructure(t),e=[];for(const i of s)i.type==="item"&&e.push(i);return e}getRefPanels(t=!1){var i;const s=this.getFlattenedTreeStructure(t),e=[];for(const a of s)a.type==="item"&&e.push((i=a.name)!=null?i:"");return e}getLengthCuts(t){const s=this.getCuts();let e=0;for(const a of s)a.cutDirection==="V"&&(e+=a.width),a.cutDirection==="H"&&(e+=a.length);const i=e/1e3;return t?parseFloat(i.toFixed(2)):i}getTrims(t=!1){const s=this.getFlattenedTreeStructure(t),e=[];for(const i of s)(i.type==="trimming"||i.type==="padding")&&e.push(i);return e}getWaste(t=!1){const s=this.getFlattenedTreeStructure(t),e=[];for(const i of s)i.type==="waste"&&e.push(i);return e}getTreeStructure(t=!1){const s=this.stock.getTreeStructure();return t&&this.reverseChildren(s),this.assignIndexes(s)}getFlattenedTreeStructure(t=!1){const s=this.getTreeStructure(t),e=[];return this.flattenTree(s,e),e}getTotalArea(t){const s=this.length*this.width/1e6;return t?parseFloat(s.toFixed(2)):s}getPanelArea(t){const s=this.getPanels();let e=0;for(const a of s)e+=a.length*a.width;const i=e/1e6;return t?parseFloat(i.toFixed(2)):i}getPanelAreaPercentage(t){const s=this.getPanelArea()/this.getTotalArea()*100;return t?parseFloat(s.toFixed(2)):s}getWasteArea(t){const s=this.getWaste();let e=0;for(const a of s)e+=a.length*a.width;const i=e/1e6;return t?parseFloat(i.toFixed(2)):i}getWasteAreaPercentage(t){const s=this.getWasteArea()/this.getTotalArea()*100;return t?parseFloat(s.toFixed(2)):s}getTrimArea(t){const s=this.getTrims();let e=0;for(const a of s)e+=a.length*a.width;const i=e/1e6;return t?parseFloat(i.toFixed(2)):i}getCutArea(t){const s=this.getCuts();let e=0;for(const a of s)a.cutDirection==="V"&&(e+=a.width*this.cutterThickness),a.cutDirection==="H"&&(e+=a.length*this.cutterThickness);const i=e/1e6;return t?parseFloat(i.toFixed(2)):i}getTrimAreaPercentage(t){const s=this.getTrimArea()/this.getTotalArea()*100;return t?parseFloat(s.toFixed(2)):s}getFirstTrimSize(t=this.stock){if(t.type==="trimming"||t.type==="padding")return t.parent.cutCoordinate;if(t.stockLeft)return this.getFirstTrimSize(t.stockLeft);if(t.stockRight)return this.getFirstTrimSize(t.stockRight)}assignIndexes(t,s={index:0,panelIndex:0}){t.index=s.index++,t.type==="item"&&(t.indexPanel=s.panelIndex++);for(const e of t.children)this.assignIndexes(e,s);return t}flattenTree(t,s){if(s.push(t),t.children)for(const e of t.children)this.flattenTree(e,s)}reverseChildren(t){if(t.children){t.children.reverse();for(const s of t.children)this.reverseChildren(s)}}};es.fromPatternData=(t,s)=>{const e=new St(t.stock);return new es(t.key,t.name,t.material,e,e.length,e.width,t.thickness,e.cutterThickness,s,"patterns/".concat(t.name))};let Ws=es;class Ue extends N{addInstances(t,s){for(const e of t)this.add(e.key,Ws.fromPatternData(e,s));return this}}class ti{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c){this.key=t,this.name=s,this.description=e,this.length=i,this.width=a,this.thickness=n,this.count=r,this.quantity=h,this.type=o,this.unitOfMeasure=d,this.cost=m,this.costUnit=l,this.refMaterial=c,this.resource="materials.board"}static fromBoardMaterialBusiness(t){return t.createViewModel()}}const is=class is{constructor(t,s,e={},i={}){this.type=t,this.key=s,this.variables=e,this.articleVariables=i,this.createViewModel=()=>new ti(this.key,this.getName(),this.getDescription(),this.getLength(),this.getWidth(),this.getThickness(),this.getCount(),this.getQuantity(),this.getType(),this.getUnitOfMeasure(),this.getCost(),this.getCostUnit(),this.getRefMaterial()),this.getName=()=>{var a;if(this.type==="article"){const n=this.parseMaterialSize(this.articleVariables.name);return n?n.name:""}return(a=this.variables.NBOARD_NAME)!=null?a:""},this.getDescription=()=>{var a;if(this.type==="article"){const n=this.parseMaterialSize(this.articleVariables.name);return n?n.name:""}return(a=this.variables.NBOARD_DESC)!=null?a:""},this.getLength=()=>{var a;if(this.type==="article"){const n=this.parseMaterialSize(this.articleVariables.name);return n?n.length:0}return(a=this.variables.NBOARD_L)!=null?a:0},this.getWidth=()=>{var a;if(this.type==="article"){const n=this.parseMaterialSize(this.articleVariables.name);return n?n.width:0}return(a=this.variables.NBOARD_W)!=null?a:0},this.getThickness=()=>{var a;return this.type==="article"?0:(a=this.variables.NBOARD_T)!=null?a:0},this.getCount=()=>this.type==="article"?this.articleVariables.count:0,this.getQuantity=()=>{var a,n;return this.type==="article"?((a=this.articleVariables.quantity)!=null?a:0)*W.getInstance().projectQuantity:((n=this.variables.NBOARD_QTY)!=null?n:0)*W.getInstance().projectQuantity},this.getType=()=>{var a;return this.type==="article"?-1:(a=this.variables.NBOARD_TYPE)!=null?a:0},this.getUnitOfMeasure=()=>"u",this.getCost=()=>this.type==="article"?this.articleVariables.cost*W.getInstance().projectQuantity:this.getQuantity()*this.getCostUnit(),this.getCostUnit=()=>{var a;return this.type==="article"?this.articleVariables.costUnit:(a=this.variables.NBOARD_COST)!=null?a:0},this.getRefMaterial=()=>{var a;return this.type==="article"?this.getName():(a=this.variables.NBOARD_MATNAME)!=null?a:""}}parseMaterialSize(t){const s=t.match(/^(.+?)\s*\((\d+)x(\d+)\)$/);if(!s)return null;const[,e,i,a]=s;return{name:e.trim(),length:parseInt(i,10),width:parseInt(a,10)}}};is.fromBoardMaterialData=t=>new is(t.type,t.key,t.variables,t.articleVariables);let xs=is;class He extends N{addInstances(t){for(const s of t)this.add(s.key,xs.fromBoardMaterialData(s));return this}}const pe=class pe{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y,v,T,C,A){this.key=t,this.messages=s,this.refParts=e,this.refPartsQuantities=i,this.refAssemblies=a,this.refAssembliesQuantities=n,this.documents=r,this.swcps=h,this.variables=o,this.heritedVariables=d,this.typedObjectVariables=m,this.id=l,this.name=c,this.description=u,this.configuration=b,this.quantity=f,this.height=p,this.width=P,this.depth=M,this.url=w,this.images=y,this.pdfs=v,this.cost=T,this.costPanels=C,this.costHardware=A,this.resource="subFrames",this.parts=[],this.assemblies=[],this.panels=[],this.programs=[],this.hardware=[],this.weldments=[]}};pe.fromFrameBusiness=t=>t.createViewModel();let Et=pe;const as=class as{constructor(t,s,e,i,a,n,r,h,o,d,m){this.key=t,this.messages=s,this.heritedVariables=e,this.typedObjectVariables=i,this.refParts=a,this.refPartsQuantities=n,this.refAssemblies=r,this.refAssembliesQuantities=h,this.documents=o,this.swcps=d,this.variables=m,this.parts=[],this.assemblies=[],this.panels=[],this.programs=[],this.hardware=[],this.weldments=[],this.getID=()=>this.variables.ID,this.getName=()=>this.variables.NAME,this.getDescription=()=>this.variables.DESC,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>{var l;return((l=this.variables.NB)!=null?l:0)*W.getInstance().projectQuantity},this.getHeight=()=>{var l;return(l=this.variables.Height)!=null?l:0},this.getWidth=()=>{var l;return(l=this.variables.Width)!=null?l:0},this.getDepth=()=>{var l;return(l=this.variables.Depth)!=null?l:0},this.getImages=()=>new j(this.documents).getImages(),this.getPDFs=()=>new ns(this.documents).getPDFs(),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getUrl=()=>"frames/".concat(this.key),this.getCostPanels=()=>{let l=0;for(const c of this.panels)l+=c.getCost();return l},this.getCostHardware=()=>{let l=0;for(const c of this.hardware)l+=c.getCost();return l},this.getCost=()=>this.getCostPanels()+this.getCostHardware(),this.getIsExcluded=()=>this.typedObjectVariables!=null&&"EXCLUDED"in this.typedObjectVariables}createViewModel(){return new Et(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Frame",this.getUrl()),this.refParts,this.refPartsQuantities,this.refAssemblies,this.refAssembliesQuantities,this.getDocuments(),this.swcps,this.variables,this.heritedVariables,this.typedObjectVariables,this.getID(),this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getHeight(),this.getWidth(),this.getDepth(),this.getUrl(),this.getImages(),this.getPDFs(),this.getCost(),this.getCostPanels(),this.getCostHardware())}};as.fromAssemblyPartBusiness=t=>new as(t.key,t.messages,t.heritedVariables,t.typedObjectVariables,"refParts"in t?t.refParts:[],"refPartsQuantities"in t?t.refPartsQuantities:[],"refAssemblies"in t?t.refAssemblies:[],"refAssembliesQuantities"in t?t.refAssembliesQuantities:[],t.documents,t.swcps,t.variables);let Fs=as;class Ge extends I{constructor(){super(...arguments),this.FrameTypedObjectName="SUBFRAME"}addInstances(t){var e;const s=(e=t.getInstancesByName(this.FrameTypedObjectName))!=null?e:[];for(const i of s)this.addInstance(i.key,Fs.fromAssemblyPartBusiness(i));return this}}class Nt{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y,v,T,C,A,S,E,B,O,x,F,Q,$,H,G,z,_,Y,X,K,J,tt,st,et,it,at,rt,nt,ht,ot,ct,gt){this.database=t,this.settings=s,this.projectBusiness=e,this.panelsBusiness=i,this.stocksBusiness=a,this.laminatesBusiness=n,this.partsBusiness=r,this.assembliesBusiness=h,this.edgebandsBusiness=o,this.edgebandMaterialsBusiness=d,this.materialsBusiness=m,this.weldmentMaterialsBusiness=l,this.boardMaterialsBusiness=c,this.programsBusiness=u,this.sheetBusiness=b,this.programPartsBusiness=f,this.toolsBusiness=p,this.spindlesBusiness=P,this.costsBusiness=M,this.typedObjectsBusiness=w,this.framesBusiness=y,this.subFramesBusiness=v,this.hardwaresBusiness=T,this.excludedItemsBusiness=C,this.panelProcessesBusiness=A,this.processZonesBusiness=S,this.weldmentsBusiness=E,this.patternsBusiness=B,this.panelBusinessManager=O,this.stockBusinessManager=x,this.laminateBusinessManager=F,this.partBusinessManager=Q,this.assemblyBusinessManager=$,this.edgebandBusinessManager=H,this.edgebandMaterialBusinessManager=G,this.materialBusinessManager=z,this.weldmentMaterialBusinessManager=_,this.boardMaterialBusinessManager=Y,this.programBusinessManager=X,this.sheetBusinessManager=K,this.programPartBusinessManager=J,this.toolBusinessManager=tt,this.spindleBusinessManager=st,this.costBusinessManager=et,this.frameBusinessManager=it,this.subFrameBusinessManager=at,this.hardwareBusinessManager=rt,this.excludedBusinessManager=nt,this.panelProcessBusinessManager=ht,this.processZoneBusinessManager=ot,this.weldmentBusinessManager=ct,this.patternsBusinessManager=gt}static createFromRawDataNew(t,s){const e=wt.createFromRawData(t),i=yt.fromProjectData(e.projectData),a=new Ce;a.addInstances(e.materialsData);const n=new Ve;n.addInstances(e.toolsData);const r=new Ee;r.addInstances(e.programsData),r.addTools(n);const h=new Re;h.addInstances(e.stocksData),h.addMaterials(a);const o=new Se;o.addInstances(e.partsData),o.addStocks(h),o.addPrograms(r);const d=new ye;d.addInstances(e.assembliesData),d.addPrograms(r),d.addParts(o),d.addAssemblies(d);const m=new Ae;m.addInstances(e.stocksData,s);const l=new Te;l.addInstances(e.edgebandMaterialsData);const c=new Ie;c.addInstances(e.edgebandsData),c.addMaterials(l);const u=new We().addInstances(e.programsData),b=new Ne().addInstances(e.programPartsData),f=new Oe().addInstances(e.spindlesData),p=new De().addInstances(e.costsData),P=new Le().addInstances(t,o,d),M=new ke().addInstances(P),w=new Ge().addInstances(P),y=new ve().addInstances(P),v=new $e().addInstances(P),T=new xe().addInstances(e.panelProcessesData),C=new Fe().addInstances(e.processZonesData),A=new Qe().addInstances(e.stocksData),S=new je().addInstances(a,A.getAll()),E=new He().addInstances(e.boardMaterialsData),B=new Be;B.addInstances(e.panelsData,s),B.addStocks(h),B.addEdgebands(c),B.addLaminates(m),B.addPrograms(r);const O=new Ue().addInstances(e.patternsData,B.getAll());return new Nt(t,s,i,B.getAll(),h.getAll(),m.getAll(),o.getAll(),d.getAll(),c.getAll(),l.getAll(),a.getAll(),S.getAll(),E.getAll(),r.getAll(),u.getAll(),b.getAll(),n.getAll(),f.getAll(),p.getAll(),P.getAll(),M.getAll(),w.getAll(),y.getAll(),v.getAll(),T.getAll(),C.getAll(),A.getAll(),O.getAll(),B,h,m,o,d,c,l,a,S,E,r,u,b,n,f,p,M,w,y,v,T,C,A,O)}static createFromRawData(t,s){const e=wt.createFromRawData(t),i=yt.fromProjectData(e.projectData),a=new Ce().addInstances(e.materialsData),n=new Ee().addInstances(e.programsData),r=new Se().addInstances(e.partsData),h=new ye().addInstances(e.assembliesData),o=new Be().addInstances(e.panelsData,s),d=new Re().addInstances(e.stocksData),m=new Ae().addInstances(e.stocksData,s),l=new Ie().addInstances(e.edgebandsData),c=new Te().addInstances(e.edgebandMaterialsData),u=new We().addInstances(e.programsData),b=new Ne().addInstances(e.programPartsData),f=new Ve().addInstances(e.toolsData),p=new Oe().addInstances(e.spindlesData),P=new De().addInstances(e.costsData),M=new Le().addInstances(t,r,h),w=new ke().addInstances(M),y=new Ge().addInstances(M),v=new ve().addInstances(M),T=new $e().addInstances(M),C=new xe().addInstances(e.panelProcessesData),A=new Fe().addInstances(e.processZonesData),S=new Qe().addInstances(e.stocksData),E=new je().addInstances(a,S.getAll()),B=new He().addInstances(e.boardMaterialsData),O=new Ue().addInstances(e.patternsData,o.getAll());return new Nt(t,s,i,o.getAll(),d.getAll(),m.getAll(),r.getAll(),h.getAll(),l.getAll(),c.getAll(),a.getAll(),E.getAll(),B.getAll(),n.getAll(),u.getAll(),b.getAll(),f.getAll(),p.getAll(),P.getAll(),M.getAll(),w.getAll(),y.getAll(),v.getAll(),T.getAll(),C.getAll(),A.getAll(),S.getAll(),O.getAll(),o,d,m,r,h,l,c,a,E,B,n,u,b,f,p,P,w,y,v,T,C,A,S,O).relateData()}relateData(){return this.assignDataToProject(),this.assignDataToEdgebands(),this.assignDataToStocks(),this.assignDataToWeldments(),this.assignDataToLaminates(),this.assignDataToPanels(),this.assignDataToAssemblies(),this.assignSubAssemblies(),this.assignDataToFrames(),this.assignDataToSubFrames(),this.assignDataToParts(),this.assignDataToSheets(),this.assignDataToProgramParts(),this.assignDataToProcessZones(),this}assignDataToProject(){for(const t of this.assemblyBusinessManager.getAll())if(this.projectBusiness.name===t.getName()){this.projectBusiness.component=t;return}for(const t of this.partBusinessManager.getAll())if(this.projectBusiness.name===t.getName()){this.projectBusiness.component=t;return}}assignDataToEdgebands(){for(const t of this.edgebandBusinessManager.getAll())t.material=this.edgebandMaterialBusinessManager.get(t.refMaterial),t.part=this.partBusinessManager.get(t.refPanel),t.panel=this.panelBusinessManager.get(t.refPanel)}assignDataToStocks(){for(const t of this.stockBusinessManager.getAll())t.material=this.materialBusinessManager.get(t.refMaterial),t.part=this.partBusinessManager.get(t.refPart),t.panel=this.panelBusinessManager.get(t.refPart)}assignDataToWeldments(){for(const t of this.weldmentBusinessManager.getAll())t.material=this.weldmentMaterialBusinessManager.get(t.refMaterial),t.part=this.partBusinessManager.get(t.refPart)}assignDataToLaminates(){for(const t of this.laminateBusinessManager.getAll())t.material=this.materialBusinessManager.get(t.refMaterial),t.part=this.partBusinessManager.get(t.refPart),t.panel=this.panelBusinessManager.get(t.refPart)}assignDataToPanels(){for(const t of this.panelBusinessManager.getAll()){t.project=this.projectBusiness;const s=this.partBusinessManager.get(t.key);s&&(t.part=s);for(const e of t.refStocks){const i=this.stockBusinessManager.get(e);if(i){t.stocks.push(i),i.variables.ST_N==="CORE"&&(t.material=i.material);continue}const a=this.laminateBusinessManager.get(e);a&&t.laminates.push(a)}for(const e of t.refEdgebands){const i=this.edgebandBusinessManager.get(e);i&&t.edgebands.push(i)}for(const e of t.refPrograms){const i=this.programBusinessManager.get(e);i&&t.programs.push(i)}for(const e of t.refProcessZones){const i=this.processZoneBusinessManager.get(e);i&&t.processZones.push(i)}t.isNested=this.programPartBusinessManager.getAll().some(e=>e.refPart===t.key),t.isPatterned=this.patternsBusinessManager.getAll().some(e=>e.getRefPanels().includes(t.name))}}assignDataToAssemblies(){var t,s;for(const e of this.assemblyBusinessManager.getAll()){for(const i of e.refParts){const a=this.partBusinessManager.get(i);a&&((t=e.parts)==null||t.push(a))}for(const i of e.refPrograms){const a=this.programBusinessManager.get(i);a&&((s=e.programs)==null||s.push(a))}}}assignSubAssemblies(){var t;for(const s of this.assemblyBusinessManager.getAll())for(const e of s.refAssemblies){const i=this.assemblyBusinessManager.get(e);i&&((t=s.assemblies)==null||t.push(i))}}assignDataToFrames(){var t,s;for(const e of this.frameBusinessManager.getAll()){for(const i of e.refParts){const a=this.partBusinessManager.get(i);a&&((t=e.parts)==null||t.push(a));const n=this.panelBusinessManager.get(i);if(n){(s=e.panels)==null||s.push(n);for(const h of n.programs)e.programs.push(h)}const r=this.hardwareBusinessManager.get(i);r&&e.hardware.push(r)}for(const i of e.refAssemblies){const a=this.assemblyBusinessManager.get(i);a&&e.assemblies.push(a);const n=this.hardwareBusinessManager.get(i);n&&e.hardware.push(n)}}}assignDataToSubFrames(){var t,s;for(const e of this.subFrameBusinessManager.getAll()){for(const i of e.refParts){const a=this.partBusinessManager.get(i);a&&((t=e.parts)==null||t.push(a));const n=this.panelBusinessManager.get(i);if(n){(s=e.panels)==null||s.push(n);for(const h of n.programs)e.programs.push(h)}const r=this.hardwareBusinessManager.get(i);r&&e.hardware.push(r)}for(const i of e.refAssemblies){const a=this.assemblyBusinessManager.get(i);a&&e.assemblies.push(a);const n=this.hardwareBusinessManager.get(i);n&&e.hardware.push(n)}}}assignDataToParts(){var t;for(const s of this.partBusinessManager.getAll()){s.panel=s.refPanel?this.panelBusinessManager.get(s.refPanel):void 0;for(const e of(t=s.refStocks)!=null?t:[]){const i=this.stockBusinessManager.get(e);i&&s.stocks.push(i)}for(const e of s.refPrograms){const i=this.programBusinessManager.get(e);i&&(s.programs.push(i),i.part=s)}}}assignDataToSheets(){var t;for(const s of this.sheetBusiness)for(const e of(t=s.refProgramParts)!=null?t:[]){const i=this.programPartBusinessManager.get(e);i&&s.programParts.push(i)}}assignDataToProgramParts(){for(const t of this.programPartsBusiness){const s=this.panelBusinessManager.get(t.refPart);t.panel=s!=null?s:void 0;const e=this.partBusinessManager.get(t.refPart);t.part=e!=null?e:void 0;const i=this.sheetBusinessManager.get(t.refProgram);t.sheet=i!=null?i:void 0;for(const a of this.sheetBusinessManager.getAll())a.programParts.some(n=>n.refPart===t.refPart)&&t.sheets.push(a)}}assignDataToProcessZones(){for(const t of this.processZonesBusiness){const s=this.panelProcessBusinessManager.get(t.refPanelProcess);t.panelProcess=s}}}class Si extends I{addInstances(t){for(const s of t)this.addInstance(s.key,Ze.fromAssemblyBusiness(s));return this}}class Ei extends I{addInstances(t){for(const s of t)this.addInstance(s.key,ti.fromBoardMaterialBusiness(s));return this}}const Pe=class Pe extends I{constructor(){super(...arguments),this.findProjectComponent=(t,s,e)=>{const i=t.name,a=e.find(r=>r.name===i);if(a)return a;const n=s.find(r=>r.name===i);return n||null},this.getAll=()=>{const t=Array.from(this.instances.values());return t.map(s=>this.clone(s)),t}}addInstances(t,s,e){const i=this.findProjectComponent(t,s,e);return i&&this.addInstance(i.key,i),this}clone(t){return Object.assign(Object.create(Object.getPrototypeOf(t)),t)}};Pe.createBOM=t=>{var s,e,i,a;for(const n of(s=t.refPartsQuantities)!=null?s:[]){const{key:r}=n;if(t.children)for(let h=((e=t.children)==null?void 0:e.length)-1;h>=0;h--)r===t.children[h].key&&t.children.splice(h,1)}for(const n of(i=t.refAssembliesQuantities)!=null?i:[]){const{key:r,quantity:h}=n;let o=h;if(t.children)for(let d=((a=t.children)==null?void 0:a.length)-1;d>=0;d--)r===t.children[d].key&&(o--,o>1&&t.children.splice(d,1))}return t};let Qs=Pe;class he{constructor(t,s){this.articles=t,this.cost=s}static fromCostBusiness(t){return new he(t.articles,t.cost)}}class Ni extends I{addInstances(t){return this.addInstance("0",he.fromCostBusiness(t[0])),this}}class Oi extends I{constructor(){super(...arguments),this.getGroupKey=t=>{var s;return"".concat(t.length,"_").concat(t.width,"_").concat(t.thickness,"_").concat((s=t.material)==null?void 0:s.name)},this.getAllCombined=()=>{const t=new Map;for(const i of this.instances.values()){const a=this.getGroupKey(i);t.has(a)||t.set(a,[]),t.get(a).push(i)}const s=new Map;let e=1;for(const[,i]of t)if(i.length===1){const a=i[0];s.set(a.name,a)}else{const a=i[0],n=i.reduce((h,o)=>h+o.quantity,0),r=bt.createCombinedEdgeband(a,"Combined Edgeband ".concat(e++),n);r.children=i,r.part=a.part,r.panel=a.panel,r.material=a.material,s.set(r.name,r)}return Array.from(s.values())}}addInstances(t){for(const s of t)this.addInstance(s.key,bt.fromEdgebandBusiness(s));return this}}class Ri extends I{addInstances(t){for(const s of t)this.addInstance(s.key,_e.fromEdgebandMaterialBusiness(s));return this}}class Vi extends I{constructor(){super(...arguments),this.FrameTypedObjectName="EXCLUDED"}addInstances(t){for(const s of t)this.addInstance(s.key,Ct.fromExcludedBusiness(s));return this}}class Li extends I{addInstances(t){for(const s of t)s.getIsExcluded()||this.addInstance(s.key,Dt.fromFrameBusiness(s));return this}}class Wi extends I{constructor(){super(...arguments),this.FrameTypedObjectName="HARDWARE"}addInstances(t){for(const s of t)this.addInstance(s.key,It.fromHardwareBusiness(s));return this}}const U=class U{};U.makeLabels=t=>{var h;const s=[];let e=0;const i=((h=t[0])==null?void 0:h.resource)==="programParts",a=new Map;console.log(i);const n=o=>{const d=o.quantity>0?o.quantity:1;for(let m=0;m<d;m++){const l=U.clone(o);i?l.instance=r(o):l.instance=m+1,e++,l.instanceLabel=e,s.push(l)}},r=o=>{var c,u;const d=(c=o.refPart)!=null?c:"",l=((u=a.get(d))!=null?u:0)+1;return a.set(d,l),l};return t==null||t.forEach(o=>{o.resource==="panels"?!o.children||o.children.length===0?n(o):o.children.forEach(d=>{const m=U.clone(d);m.combineId!==0&&(m.name="Combined Panel ".concat(m.combineId)),n(m)}):n(o)}),s},U.clone=t=>Object.assign(Object.create(Object.getPrototypeOf(t)),t),U.deepCopy=t=>{if(t==null)return t;if(t instanceof Date)return new Date(t.getTime());if(Array.isArray(t))return t.map(s=>U.deepCopy(s));if(typeof t=="object"){const s={};for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const i=t[e];s[e]=U.deepCopy(i)}return s}return t};let js=U;class xi{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b){this.key=t,this.messages=s,this.documents=e,this.variables=i,this.name=a,this.description=n,this.category=r,this.thickness=h,this.hasGrain=o,this.cost=d,this.costUnit=m,this.costType=l,this.quantity=c,this.type=u,this.unitOfMeasure=b}static fromMaterialBusiness(t){return t.createViewModel()}}class Fi extends I{addInstances(t){for(const s of t)s.getIsWeldment()||s.getType()!==1||this.addInstance(s.key,xi.fromMaterialBusiness(s));return this}}class Qi extends I{constructor(){super(...arguments),this.combinedInstances=new Map,this.getLongest=(t,s,e)=>e?{length:t,width:s}:s>t?{width:s,length:t}:{length:t,width:s},this.getGroupKey=t=>{var i,a,n,r,h;const{length:s,width:e}=this.getLongest(t.length,t.width,(a=(i=t.material)==null?void 0:i.hasGrain)!=null?a:!1);return"".concat(s,"_").concat(e,"_").concat(t.thickness,"_").concat((r=(n=t.material)==null?void 0:n.hasGrain)!=null?r:!1,"_").concat((h=t.material)==null?void 0:h.name)},this.getAllCombined=()=>{const t=new Map;for(const i of this.instances.values()){const a=this.getGroupKey(i);t.has(a)||t.set(a,[]),t.get(a).push(i)}const s=new Map;let e=1;for(const[,i]of t)if(i.length===1){const a=i[0];s.set(a.name,a)}else{const a=i[0],n=i.reduce((h,o)=>h+o.quantity,0),r=pt.createCombinedLaminate(a,"Combined Laminate ".concat(e++),n);r.children=i,r.part=a.part,r.panel=a.panel,r.material=a.material,s.set(r.name,r)}return Array.from(s.values())}}addInstances(t){for(const s of t)this.addInstance(s.key,pt.fromLaminateBusiness(s));return this}}class ji extends I{addInstances(t){for(const s of t)s.getIsWeldment()||s.getType()!==0||this.addInstance(s.key,Ye.fromMaterialBusiness(s));return this}}class $i extends I{addInstances(t,s){for(const e of s)this.addInstance("".concat(t,"-").concat(e.messageType),e);return this}processMessages(t,s,e,i,a,n,r,h,o,d,m,l,c){this.processProjectMessages(t),this.processSourceMessages(s),this.processSourceMessages(e),this.processSourceMessages(i),this.processSourceMessages(a),this.processSourceMessages(n),this.processSourceMessages(r),this.processSourceMessages(h),this.processSourceMessages(o),this.processSourceMessages(d),this.processSourceMessages(m),this.processSourceMessages(l),this.processSourceMessages(c),this.processPanelMessages(s),this.processProgramMessages(o)}processSourceMessages(t){for(const s of t)this.addInstances(s.key,s.messages)}processProjectMessages(t){this.addInstances(t.name,t.messages)}processPanelMessages(t){for(const s of t)this.processPanelSize(s),this.processPanelLength(s),this.processPanelWidth(s),this.processPanelInvalidDimensions(s)}processProgramMessages(t){for(const s of t)this.processProgramEncodeMessage(s)}processPanelSize(t){if(t.hasGrain===!1&&t.board.length>0&&t.board.width>0){const s=t.lengthStock<=t.board.length&&t.widthStock<=t.board.width,e=t.lengthStock<=t.board.width&&t.widthStock<=t.board.length;if(!s&&!e){const i=new D("ERROR","Error","size out of range. Panel Size: ".concat(t.lengthStock," x ").concat(t.widthStock," | Board: ").concat(t.board.length," x ").concat(t.board.width),"size out of range. Panel Size: ".concat(t.lengthStock," x ").concat(t.widthStock," | Board: ").concat(t.board.length," x ").concat(t.board.width),t.name,t.name,"Panel","");this.addInstance("".concat(t.key,"-").concat(i.message),i),t.messages.push(i)}}}processPanelLength(t){if(t.board.length<t.lengthStock&&t.board.length>0&&t.hasGrain){const s=new D("ERROR","Error","length out of range. Length: ".concat(t.lengthStock," | Board: ").concat(t.board.length," x ").concat(t.board.width),"length out of range. Length: ".concat(t.lengthStock," | Board: ").concat(t.board.length," x ").concat(t.board.width),t.name,t.name,"Panel","");this.addInstance("".concat(t.key,"-").concat(s.message),s),t.messages.push(s)}}processPanelWidth(t){if(t.board.width<t.widthStock&&t.board.width>0&&t.hasGrain){const s=new D("ERROR","Error","width out of range. Width: ".concat(t.widthStock," | Board: ").concat(t.board.length," x ").concat(t.board.width),"width out of range. Width: ".concat(t.widthStock," | Board: ").concat(t.board.length," x ").concat(t.board.width),t.name,t.name,"Panel","");this.addInstance("".concat(t.key,"-").concat(s.message),s),t.messages.push(s)}}processPanelInvalidDimensions(t){if(t.length===0){const s=new D("ERROR","Error","invalid length dimension, value is 0","invalid length dimension, value is 0",t.name,t.name,"Panel","");this.addInstance("".concat(t.key,"-").concat(s.message),s),t.messages.push(s)}if(t.width===0){const s=new D("ERROR","Error","invalid width dimension, value is 0","invalid width dimension, value is 0",t.name,t.name,"Panel","");this.addInstance("".concat(t.key,"-").concat(s.message),s),t.messages.push(s)}if(t.thickness===0){const s=new D("ERROR","Error","invalid thickness dimension, value is 0","invalid thickness dimension, value is 0",t.name,t.name,"Panel","");this.addInstance("".concat(t.key,"-").concat(s.message),s),t.messages.push(s)}}processProgramEncodeMessage(t){var e;const s=(e=t.variables.ENCODEMSG)!=null?e:"";if(s!==""){const i=new D("ERROR","Error",s,s,t.name,t.name,"Program","");this.addInstance("".concat(t.key,"-").concat(s),i),t.messages.push(i)}}}class dt extends I{constructor(){super(...arguments),this.combine=!1,this.getCombinedPanels=()=>{const t=this.getAll();return dt.generateCombinedPanels(t)}}addInstances(t){for(const s of t){if(s.getIsExcluded())continue;if(!this.combine){this.addInstance(s.key,s.createViewModel());continue}if(s.getCombineId()===0){this.addInstance(s.key,s.createViewModel());continue}const i="combined-panel-".concat(s.getCombineId()),a=this.instances.get(i),n=s.createViewModel();if(a)a.addChildren(n),a.quantity+=n.quantity,a.cost+=n.cost,a.description=this.mergeDescription(a.description,n.description);else{const r=s.createCombinedViewModel();r.addChildren(n),this.addInstance(r.key,r)}}return this}get(t){var e;const s=this.instances.get(t);if(s)return s;for(const i of this.instances.values())for(const a of(e=i.children)!=null?e:[])if(a.key===t)return i}static generateCombinedPanels(t){const s=new Map;for(const i of t){const a=i.combineId;s.has(a)||s.set(a,[]),s.get(a).push(i)}const e=new Map;for(const[i,a]of s)if(i===0)for(const n of a)e.set(n.key,n);else{const n=a[0],r=a.reduce((d,m)=>d+m.quantity,0),h=Pt.createCombinedPanel(n,r);h.children=a,h.material=n.material;let o="";for(const d of a)o=Bi(o,d.description);h.description=o,e.set(h.name,h)}return Array.from(e.values())}}class Ui extends I{addInstances(t){for(const s of t)this.addInstance(s.key,s.createViewModel());return this}}class Hi extends I{addInstances(t){for(const s of t)this.addInstance(s.key,Xe.fromPartBusiness(s));return this}}class Gi extends I{addInstances(t){for(const s of t)this.addInstance(s.key,Je.fromPatternBusiness(s));return this}}class qi extends I{addInstances(t){for(const s of t)this.addInstance(s.key,s.createViewModel());return this}}class Zi extends I{addInstances(t){for(const s of t)s.refBoard||this.addInstance(s.key,Tt.fromProgramBusiness(s));return this}}class zi extends I{addInstances(t){for(const s of t)this.addInstance(s.key,kt.fromProgramPartBusiness(s));return this}}class _i extends I{addInstances(t){for(const s of t)s.refBoard&&this.addInstance(s.key,At.fromProgramBusiness(s));return this}}const rs=class rs{constructor(t,s,e,i){this.key=t,this.messages=s,this.documents=e,this.variables=i,this.resource="spindles"}};rs.fromSpindleBusiness=t=>new rs(t.key,D.fromMessagesRaw(t.messages,t.key,"Spindle",""),t.documents,t.variables);let $s=rs;class Yi extends I{addInstances(t){if(!t)return this;for(const s of t)this.addInstance(s.key,$s.fromSpindleBusiness(s));return this}}class Xi extends I{constructor(){super(...arguments),this.sourceInstances=new Map,this.combine=!0,this.getLongest=(t,s,e)=>e?{length:t,width:s}:s>t?{width:s,length:t}:{length:t,width:s},this.getGroupKey=t=>{var i,a,n,r,h;const{length:s,width:e}=this.getLongest(t.length,t.width,(a=(i=t.material)==null?void 0:i.hasGrain)!=null?a:!1);return"".concat(s,"_").concat(e,"_").concat(t.thickness,"_").concat((r=(n=t.material)==null?void 0:n.hasGrain)!=null?r:!1,"_").concat((h=t.material)==null?void 0:h.name)},this.combineStocks=()=>{const t=new Map;for(const i of this.sourceInstances.values()){const a=this.getGroupKey(i);t.has(a)||t.set(a,[]),t.get(a).push(i)}const s=new Map;let e=1;for(const[,i]of t)if(i.length===1){const a=i[0];s.set(a.name,a)}else{const a=i[0],n=i.reduce((o,d)=>o+d.quantity,0),r=Mt.createCombinedStock(a,"Combined Stock ".concat(e++),n);r.children=i;let h="";for(const o of i)h=this.mergeDescription(h,o.description);r.description=h,s.set(r.name,r)}return Array.from(s.values())}}addInstances(t){var e,i;for(const a of t)(e=a.material)!=null&&e.getIsWeldment()||((i=a.material)==null?void 0:i.getType())===0&&this.addSourceInstance(a.key,Mt.fromStockBusiness(a));const s=this.combine?this.combineStocks():Array.from(this.sourceInstances.values());for(const a of s)this.addInstance(a.key,a);return this}addSourceInstance(t,s){this.sourceInstances.set(t,s)}get(t){var e;const s=this.instances.get(t);if(s)return s;for(const i of this.instances.values())for(const a of(e=i.children)!=null?e:[])if(a.key===t)return i}}class Ki extends I{addInstances(t){for(const s of t)s.getIsExcluded()||this.addInstance(s.key,Et.fromFrameBusiness(s));return this}}class Ji extends I{addInstances(t){for(const s of t)this.addInstance(s.key,vt.fromToolBusiness(s));return this}}class ta{constructor(){this.instances=new Map,this.addInstance=(t,s)=>{const e=this.instances.get(t);e?e.push(s):this.instances.set(t,[s])},this.addInstances=(t,s,e)=>{for(const i of t.typedObjects){const a=s.get(i);if(a){const r=a.variables.TOTYPES.split(";");for(const h of r)this.addInstance(h,a)}const n=e.get(i);if(n){const r=n.variables.TOTYPES.split(";");for(const h of r)this.addInstance(h,n)}}return this},this.getInstancesByName=t=>this.instances.get(t)||void 0,this.getAll=()=>Object.fromEntries(this.instances)}}class sa extends I{addInstances(t){for(const s of t){const e=s.getCutlist(),i=this.instances.get(e);if(i)i.addChildren(lt.fromWeldmentBusinessChild(s));else{const a=lt.fromWeldmentBusiness(s);a.addChildren(lt.fromWeldmentBusinessChild(s)),this.addInstance(e,a)}}return this}get(t){var e;const s=this.instances.get(t);if(s)return s;for(const i of this.instances.values())for(const a of(e=i.children)!=null?e:[])if(a.key===t)return a}getFromRefPart(t){const s=[],e=Array.from(this.instances.values());for(const i of e)i.refPart===t&&s.push(i);return s}}class ea extends I{addInstances(t){for(const s of t)this.addInstance(s.key,Ke.fromMaterialBusiness(s));return this}}class si{constructor(t,s,e,i,a,n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y,v,T,C,A,S,E,B,O,x,F,Q,$,H,G,z,_,Y,X,K,J,tt,st,et,it,at,rt,nt,ht,ot,ct,gt,hs,os,cs){this.database=t,this.settings=s,this.project=e,this.panels=i,this.stocks=a,this.parts=n,this.assemblies=r,this.bom=h,this.edgebands=o,this.laminates=d,this.programs=m,this.sheets=l,this.programParts=c,this.tools=u,this.spindles=b,this.costs=f,this.messages=p,this.typedObjects=P,this.frames=M,this.subFrames=w,this.hardware=y,this.excluded=v,this.panelProcesses=T,this.processZones=C,this.weldments=A,this.patterns=S,this.materials=E,this.panelManager=B,this.stockManager=O,this.partManager=x,this.assemblyManager=F,this.edgebandManager=Q,this.edgebandMaterialManager=$,this.laminateManager=H,this.materialManager=G,this.laminateMaterialManager=z,this.weldmentMaterialManager=_,this.boardMaterialManager=Y,this.programManager=X,this.sheetManager=K,this.programPartManager=J,this.toolManager=tt,this.spindleManager=st,this.costManager=et,this.messageManager=it,this.typedObjectManager=at,this.frameManager=rt,this.subFrameManager=nt,this.hardwareManager=ht,this.excludedManager=ot,this.panelProcessManager=ct,this.processZoneManager=gt,this.weldmentManager=hs,this.patternManager=os,this.labelManager=cs,this.relateData=()=>(this.assignDataToProject(),this.assignDataToEdgebands(),this.assignDataToStocks(),this.assignDataToWeldments(),this.assignDataToLaminates(),this.assignDataToPanels(),this.assignDataToAssemblies(),this.assignSubAssemblies(),this.assignDataToFrames(),this.assignDataToSubFrames(),this.assignDataToParts(),this.assignDataToSheets(),this.assignDataToPrograms(),this.assignDataToProgramParts(),this.assignDataToProcessZones(),this.assignDataToPatterns(),this.assignDataToBoards(),this.assignDataToTools(),this)}static createFromRawData(t,s,e){if(W.getInstance(t,e),!e.status)throw Error("");const i=Nt.createFromRawData(t,s),a=ze.fromProjectBusiness(i.projectBusiness),n=new dt().addInstances(i.panelsBusiness),r=new Xi().addInstances(i.stocksBusiness),h=new Hi().addInstances(i.partsBusiness),o=new Si().addInstances(i.assembliesBusiness),d=new Oi().addInstances(i.edgebandsBusiness),m=new Ri().addInstances(i.edgebandMaterialsBusiness),l=new Qi().addInstances(i.laminatesBusiness),c=new ji().addInstances(i.materialsBusiness),u=new Fi().addInstances(i.materialsBusiness),b=new ea().addInstances(i.weldmentMaterialsBusiness),f=new Ei().addInstances(i.boardMaterialsBusiness),p=new Zi().addInstances(i.programsBusiness),P=new _i().addInstances(i.sheetBusiness),M=new zi().addInstances(i.programPartsBusiness),w=new Ji().addInstances(i.toolsBusiness),y=new Yi().addInstances(i.spindlesBusiness),v=new Ni().addInstances(i.costsBusiness),T=new $i,C=new ta().addInstances(t,h,o),A=new Li().addInstances(i.framesBusiness),S=new Ki().addInstances(i.subFramesBusiness),E=new Wi().addInstances(i.hardwaresBusiness),B=new Vi().addInstances(i.excludedItemsBusiness),O=new Ui().addInstances(i.panelProcessesBusiness),x=new qi().addInstances(i.processZonesBusiness),F=new sa().addInstances(i.weldmentsBusiness),Q=new Gi().addInstances(i.patternsBusiness),$=new Qs().addInstances(a,o.getAll(),h.getAll());return T.processMessages(a,n.getAll(),r.getAll(),h.getAll(),o.getAll(),d.getAll(),l.getAll(),c.getAll(),p.getAll(),P.getAll(),M.getAll(),w.getAll(),y.getAll()),new si(t,s,a,n.getCombinedPanels(),r.getAll(),h.getAll(),o.getAll(),$.getAll(),d.getAll(),l.getAll(),p.getAll(),P.getAll(),M.getAll(),w.getAll(),y.getAll(),v.getAll(),T.getAll(),C.getAll(),A.getAll(),S.getAll(),E.getAll(),B.getAll(),O.getAll(),x.getAll(),F.getAll(),Q.getAll(),{panels:c.getAll(),laminates:u.getAll(),edgebands:m.getAll(),weldments:b.getAll(),boards:f.getAll()},n,r,h,o,d,m,l,c,u,b,f,p,P,M,w,y,v,T,C,A,S,E,B,O,x,F,Q,js).relateData()}assignDataToProject(){}assignDataToEdgebands(){for(const t of this.edgebandManager.getAll())t.material=this.edgebandMaterialManager.get(t.refMaterial),t.part=this.partManager.get(t.refPanel),t.panel=this.panelManager.get(t.refPanel)}assignDataToStocks(){var t;for(const s of this.stockManager.getAll()){this.assignDataToStock(s);for(const e of(t=s.children)!=null?t:[])this.assignDataToStock(e)}}assignDataToStock(t){t.material=this.materialManager.get(t.refMaterial),t.material||console.warn("material not found for stock: ".concat(t.key)),t.part=this.partManager.get(t.refPart),t.panel=this.panelManager.get(t.refPart)}assignDataToWeldments(){for(const t of this.weldments)t.material=this.materialManager.get(t.refMaterial),t.part=this.partManager.get(t.refPart)}assignDataToLaminates(){for(const t of this.laminateManager.getAll())t.material=this.laminateMaterialManager.get(t.refMaterial),t.material||console.warn("material not found for laminate: ".concat(t.key)),t.part=this.partManager.get(t.refPart),t.panel=this.panelManager.get(t.refPart)}assignDataToPanels(){var t;for(const s of this.panels){this.assignDataToPanel(s);for(const e of(t=s.children)!=null?t:[])this.assignDataToPanel(e)}}assignDataToPanel(t){var e;t.project=this.project;const s=this.partManager.get(t.refPart);s&&(t.part=s);for(const i of t.refStocks){const a=this.stockManager.get(i);if(a){t.stocks.push(a),a.material||console.warn("material not found for stock",a.key,"in panel",t.key),a.variables.ST_N==="CORE"?t.material=a.material:((e=a.material)==null?void 0:e.type)===0&&t.layers.push(a);continue}const n=this.laminateManager.get(i);n&&(t.laminates.push(n),n.name==="TOP"&&(t.laminateTop=n),n.name==="BOTTOM"&&(t.laminateBottom=n))}for(const i of t.refEdgebands){const a=this.edgebandManager.get(i);a&&(t.edgebands.push(a),a.position==="F"&&(t.edgebandFront=a),a.position==="B"&&(t.edgebandBack=a),a.position==="L"&&(t.edgebandLeft=a),a.position==="R"&&(t.edgebandRight=a))}for(const i of t.refPrograms){const a=this.programManager.get(i);a&&(t.programs.push(a),a.panel=t,a.material=t.material,s&&(a.part=s))}for(const i of t.refProcessZones){const a=this.processZoneManager.get(i);a&&t.processZones.push(a)}}assignDataToAssemblies(){for(const t of this.assemblyManager.getAll()){for(const s of t.refParts){const e=this.partManager.get(s);e&&(t.parts.push(e),t.children||(t.children=[]),t.children.push(e))}for(const s of t.refPrograms){const e=this.programManager.get(s);e&&t.programs.push(e)}}}assignSubAssemblies(){for(const t of this.assemblyManager.getAll())for(const s of t.refAssemblies){const e=this.assemblyManager.get(s);e&&(t.assemblies.push(e),t.children||(t.children=[]),t.children.push(e))}}assignDataToFrames(){var t;for(const s of this.frameManager.getAll()){const e=[];for(const i of s.refParts){const a=this.partManager.get(i);if(a){(t=s.parts)==null||t.push(a);const h=this.weldmentManager.getFromRefPart(i);h&&(s.weldments=[...h])}const n=this.panelManager.get(i);if(n){n.frame=s,e.push(n);for(const h of n.programs)s.programs.push(h)}else console.warn("Panel not found for refPart: ".concat(i," in frame: ").concat(s.name));const r=this.hardwareManager.get(i);r&&s.hardware.push(r)}s.panels=dt.generateCombinedPanels(e);for(const i of s.refAssemblies){const a=this.assemblyManager.get(i);a&&s.assemblies.push(a);const n=this.hardwareManager.get(i);n&&s.hardware.push(n);const r=this.subFrameManager.get(i);r&&(s.children||(s.children=[]),s.children.push(r))}}}assignDataToSubFrames(){var t;for(const s of this.subFrameManager.getAll()){const e=[];for(const i of s.refParts){const a=this.partManager.get(i);if(a){(t=s.parts)==null||t.push(a);const h=this.weldmentManager.getFromRefPart(i);h&&(s.weldments=[...h])}const n=this.panelManager.get(i);if(n){e.push(n);for(const h of n.programs)s.programs.push(h)}else console.warn("Panel not found for refPart: ".concat(i," in frame: ").concat(s.name));const r=this.hardwareManager.get(i);r&&s.hardware.push(r)}s.panels=dt.generateCombinedPanels(e);for(const i of s.refAssemblies){const a=this.assemblyManager.get(i);a&&s.assemblies.push(a);const n=this.hardwareManager.get(i);n&&s.hardware.push(n);const r=this.subFrameManager.get(i);r&&(s.children||(s.children=[]),s.children.push(r))}}}assignDataToParts(){var t;for(const s of this.partManager.getAll()){s.panel=s.refPanel?this.panelManager.get(s.refPanel):void 0;for(const e of(t=s.refStocks)!=null?t:[]){const i=this.stockManager.get(e);i&&s.stocks.push(i)}for(const e of s.refPrograms){const i=this.programManager.get(e);i&&s.programs.push(i)}}}assignDataToSheets(){var t,s,e;for(const i of this.sheets){for(const n of(t=i.refProgramParts)!=null?t:[]){const r=this.programPartManager.get(n);r&&i.programParts.push(r)}for(const n of(s=i.refTools)!=null?s:[]){const r=this.toolManager.get(n);r&&i.tools.push(r)}const a=this.boardMaterialManager.get((e=i.refBoard)!=null?e:"");i.board=a!=null?a:void 0}}assignDataToPrograms(){var t;for(const s of this.programs)for(const e of(t=s.refTools)!=null?t:[]){const i=this.toolManager.get(e);i&&s.tools.push(i)}}assignDataToProgramParts(){for(const t of this.programParts){const s=this.panelManager.get(t.refPart);t.panel=s,s&&(s.programPart=t);const e=this.partManager.get(t.refPart);t.part=e!=null?e:void 0;const i=this.sheetManager.get(t.refProgram);t.sheet=i!=null?i:void 0}}assignDataToProcessZones(){for(const t of this.processZones){const s=this.panelProcessManager.get(t.refPanelProcess);t.panelProcess=s}}assignDataToPatterns(){const t=new Map(this.panelManager.getAll().map(s=>[s.name,s]));for(const s of this.patterns)s.panels=s.refPanels.map(e=>t.get(e)).filter(e=>!!e)}assignDataToBoards(){for(const t of this.boardMaterialManager.getAll())t.material=this.materialManager.get(t.refMaterial)}assignDataToTools(){for(const t of this.toolManager.getAll())for(const s of t.refSpindles){const e=this.spindleManager.get(s);e?t.spindles.push(e):console.warn("Spindle not found for refSpindle: ".concat(s," in tool: ").concat(t.key))}}}export{si as default};
