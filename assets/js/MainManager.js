import{R as x,V as A,x as xt}from"./main.DNR_O0SE.js";const oa=(f,s)=>f.startsWith(s)?f.slice(s.length):f,He=f=>f.replace(/\\/g,"/"),z=class z{constructor(s,t,e,a,i,r,n,h,o,l){this.name=s,this.type=t,this.docType=e,this.processingStatus=a,this.absoluteURI=i,this.relativeURI=r,this.hidden=n,this.storageType=h,this.exists=o,this.objType=l}};z.fromDocumentRaw=s=>{var r;let t="";const e=x.getInstance(),a="file:///"+He(e.reportPath)+"/",i=s.absoluteURI;return i.startsWith(a)&&(t=i.slice(a.length)),new z((r=s.documentName)!=null?r:"",s.type,s.docType,s.processingStatus,s.absoluteURI,t,s.hidden,s.storageType,s.exists,s.objType)},z.fromDocumentsRaw=s=>{const t=[];for(const e of s!=null?s:[])t.push(z.fromDocumentRaw(e));return t};let W=z;class Qt{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c){this.key=s,this.messages=t,this.variables=e,this.serialNumbers=a,this.heritedVariables=i,this.typedObjectVariables=r,this.refPrograms=n,this.refParts=h,this.refPartsQuantities=o,this.refAssemblies=l,this.refAssembliesQuantities=d,this.documents=g,this.swcps=c,this.programs=[],this.parts=[],this.assemblies=[]}static fromAssemblyRaw(s,t){const e=A.parseVariables(s.variables,t),a=A.parseVariablesArrayToObject(s.serialNumbers.variables),i=A.parseTypedVariablesArray(s.heritedVariables),r=A.parseVariableGroupToRecord(s.typedObjectVariables),n=xt.parseVariablesArrayToObject(s.swcps),h=s.partsRefs.map(l=>({key:l.ID,quantity:l.count})),o=s.assembliesRefs.map(l=>({key:l.ID,quantity:l.count}));return new Qt(s.ID,s.messages,e,a,i,r,s.programs,s.parts,h,s.assemblies,o,W.fromDocumentsRaw(s.documents),n)}}class E{constructor(){this.instances=new Map}addInstance(s,t){this.instances.set(s,t)}get(s){return this.instances.get(s)}getAll(){return Array.from(this.instances.values())}getTotalInstances(){return this.instances.size}}class ca extends E{addInstances(s){for(const t of s.assemblies)this.addInstance(t.ID,Qt.fromAssemblyRaw(t,s.variableDefinitions.assemblies));return this}}const Cs=class Cs{constructor(s,t){this.articles=s,this.cost=t}};Cs.fromToolRaw=s=>new Cs(s.articles,s.cost);let ht=Cs;class ga extends E{addInstances(s){return this.addInstance("0",ht.fromToolRaw(s.costing)),this}}class jt{constructor(s,t,e,a,i,r,n){this.key=s,this.panel=t,this.refMaterial=e,this.variables=a,this.serialNumbers=i,this.documents=r,this.messages=n}static fromEdgebandRaw(s,t){const e=A.parseVariables(s.variables,t),a=A.parseVariablesArrayToObject(s.serialNumbers.variables);return new jt(s.ID,s.panel,s.edgebandMaterial,e,a,W.fromDocumentsRaw(s.documents),s.messages)}}class la extends E{addInstances(s){for(const t of s.edgebands)this.addInstance(t.ID,jt.fromEdgebandRaw(t,s.variableDefinitions.edgebands));return this}}class Ft{constructor(s,t){this.key=s,this.variables=t}static fromEdgebandMaterialRaw(s,t){const e=A.parseVariables(s.variables,t);return new Ft(s.ID,e)}}class da extends E{addInstances(s){var t;for(const e of(t=s.edgebandMaterials)!=null?t:[])this.addInstance(e.ID,Ft.fromEdgebandMaterialRaw(e,s.variableDefinitions.edgebandMaterials));return this}}const Ns=class Ns{constructor(s,t,e,a,i){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.serialNumbers=i}};Ns.fromMaterialRaw=(s,t)=>{const e=A.parseVariables(s.variables,t),a=A.parseVariablesArrayToObject(s.serialNumbers.variables);return new Ns(s.ID,s.messages,W.fromDocumentsRaw(s.documents),e,a)};let ot=Ns;class ua extends E{addInstances(s){var t;for(const e of(t=s.materials)!=null?t:[])this.addInstance(e.ID,ot.fromMaterialRaw(e,s.variableDefinitions.materials));return this}}class Ut{constructor(s,t,e,a,i,r,n,h,o,l,d){this.key=s,this.name=t,this.refPart=e,this.refPrograms=a,this.refStocks=i,this.refProcessZones=r,this.refEdgebands=n,this.messages=h,this.documents=o,this.variables=l,this.serialNumbers=d,this.programs=[],this.stocks=[],this.edgebands=[]}static fromPanelRaw(s,t){const e=A.parseVariables(s.variables,t),a=A.parseVariablesArrayToObject(s.serialNumbers.variables);return new Ut(s.ID,s.name,s.ID,s.programs,s.stocks,s.processZones,s.edgebands,s.messages,W.fromDocumentsRaw(s.documents),e,a)}}class fa extends E{addInstances(s){var t;for(const e of(t=s.panels)!=null?t:[])this.addInstance(e.ID,Ut.fromPanelRaw(e,s.variableDefinitions.panels));return this}}class Gt{constructor(s,t,e,a){this.key=s,this.messages=t,this.documents=e,this.variables=a}static fromPanelProcessRaw(s,t){const e=A.parseVariables(s.variables,t);return new Gt(s.ID,s.messages,W.fromDocumentsRaw(s.documents),e)}}class ma extends E{addInstances(s){var t;if(!s.panelProcesses)return this;for(const e of s.panelProcesses)this.addInstance(e.ID,Gt.fromPanelProcessRaw(e,(t=s.variableDefinitions.panelProcesses)!=null?t:[]));return this}}class Ht{constructor(s,t,e,a,i,r){this.key=s,this.refPanel=t,this.refPanelProcess=e,this.messages=a,this.documents=i,this.variables=r}static fromProcessZoneRaw(s,t){const e=A.parseVariables(s.variables,t);return new Ht(s.ID,s.panel,s.panelProcess,s.messages,W.fromDocumentsRaw(s.documents),e)}}class pa extends E{addInstances(s){var t;if(!s.processZones)return this;for(const e of s.processZones)this.addInstance(e.ID,Ht.fromProcessZoneRaw(e,(t=s.variableDefinitions.processZones)!=null?t:[]));return this}}class $t{constructor(s,t,e,a,i,r,n,h,o,l,d,g){this.key=s,this.refPrograms=t,this.refStocks=e,this.refPanel=a,this.bodyCount=i,this.messages=r,this.variables=n,this.serialNumbers=h,this.heritedVariables=o,this.typedObjectVariables=l,this.documents=d,this.swcps=g,this.programs=[],this.stocks=[]}static fromPartRaw(s,t){const e=A.parseVariables(s.variables,t),a=A.parseVariablesArrayToObject(s.serialNumbers.variables),i=A.parseTypedVariablesArray(s.heritedVariables),r=A.parseVariableGroupToRecord(s.typedObjectVariables),n=xt.parseVariablesArrayToObject(s.swcps);return new $t(s.ID,s.programs,s.stocks,s.panel,s.bodyCount,s.messages,e,a,i,r,W.fromDocumentsRaw(s.documents),n)}}class ba extends E{addInstances(s){for(const t of s.parts)this.addInstance(t.ID,$t.fromPartRaw(t,s.variableDefinitions.parts));return this}}class qt{constructor(s,t,e,a,i,r,n,h){this.key=s,this.refTools=t,this.refProgramParts=e,this.refBoard=a,this.messages=i,this.documents=r,this.variables=n,this.serialNumbers=h,this.tools=[]}static fromProgramRaw(s,t){const e=A.parseVariables(s.variables,t),a=A.parseVariablesArrayToObject(s.serialNumbers.variables);return new qt(s.ID,s.tools,s.programParts,s.nestingBoard,s.messages,W.fromDocumentsRaw(s.documents),e,a)}}class Pa extends E{addInstances(s){for(const t of s.programs)this.addInstance(t.ID,qt.fromProgramRaw(t,s.variableDefinitions.programs));return this}}class Zt{constructor(s,t,e,a,i,r,n){this.key=s,this.part=t,this.program=e,this.documents=a,this.messages=i,this.variables=r,this.serialNumbers=n}static fromProgramPartRaw(s,t){const e=A.parseVariables(s.variables,t),a=A.parseVariablesArrayToObject(s.serialNumbers.variables);return new Zt(s.ID,s.part,s.program,W.fromDocumentsRaw(s.documents),s.messages,e,a)}}class Ma extends E{addInstances(s){for(const t of s.programParts)this.addInstance(t.ID,Zt.fromProgramPartRaw(t,s.variableDefinitions.programParts));return this}}class zt{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c){this.key=s,this.swoodVersion=t,this.schemaVersion=e,this.name=a,this.projectPath=i,this.reportPath=r,this.timestamp=n,this.createdBy=h,this.documents=o,this.messages=l,this.variables=d,this.serialNumbers=g,this.swcps=c}static fromProjectRaw(s,t){const e=A.parseVariables(s.variables,t),a=A.parseVariablesArrayToObject(s.serialNumbers.variables),i=xt.parseVariablesArrayToObject(s.swcps);return new zt(s.reportGUID,s.reportVersion,s.schemaVersion,s.projectName,s.projectPath,s.reportPath,s.createdDate,s.createdBy,W.fromDocumentsRaw(s.documents),s.messages,e,a,i)}}class Yt{constructor(s,t,e,a){this.key=s,this.messages=t,this.documents=e,this.variables=a}static fromSpindleRaw(s,t){const e=A.parseVariables(s.variables,t);return new Yt(s.ID,s.messages,W.fromDocumentsRaw(s.documents),e)}}class ya extends E{addInstances(s){var t;if(!s.spindles)return this;for(const e of s.spindles)this.addInstance(e.ID,Yt.fromSpindleRaw(e,(t=s.variableDefinitions.spindles)!=null?t:[]));return this}}const Os=class Os{constructor(s,t,e,a,i,r){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=r}};Os.fromStockRaw=(s,t)=>{const e=A.parseVariables(s.variables,t);return new Os(s.ID,s.part,s.material,s.messages,W.fromDocumentsRaw(s.documents),e)};let ct=Os;class wa extends E{addInstances(s){for(const t of s.stocks)this.addInstance(t.ID,ct.fromStockRaw(t,s.variableDefinitions.stocks));return this}}class _t{constructor(s,t,e,a,i=[]){this.key=s,this.variables=t,this.messages=e,this.documents=a,this.refSpindles=i}static fromToolRaw(s,t){var a;const e=A.parseVariables(s.variables,t);return new _t(s.ID,e,s.messages,W.fromDocumentsRaw(s.documents),(a=s.spindles)!=null?a:[])}}class Da extends E{addInstances(s){var t;for(const e of(t=s.tools)!=null?t:[])this.addInstance(e.ID,_t.fromToolRaw(e,s.variableDefinitions.tools));return this}}class Ta{constructor(){this.instances=new Map}addInstance(s,t){const e=this.instances.get(s);e?e.push(t):this.instances.set(s,[t])}addInstances(s,t,e){for(const a of s.typedObjects){const i=t.get(a);if(i){const n=i.variables.TOTYPES.split(";");for(const h of n)this.addInstance(h,i)}const r=e.get(a);if(r){const n=r.variables.TOTYPES.split(";");for(const h of n)this.addInstance(h,r)}}return this}getInstancesById(s){return this.instances.get(s)||null}getAll(){return this.instances}}class Xt{constructor(s,t,e,a,i){this.key=s,this.name=t,this.material=e,this.thickness=a,this.stock=i}static fromPatternRaw(s,t,e){return new Xt(s,s,t.material,t.thickness,e)}}class Aa extends E{addInstances(s){var e;let t=1;for(const a of s!=null?s:[])for(const i of(e=a.stocks)!=null?e:[]){const r="Pattern ".concat(t.toString());this.addInstance(r,Xt.fromPatternRaw(r,a,i)),t++}return this}}class ds{constructor(s,t,e={},a={}){this.type=s,this.key=t,this.variables=e,this.articleVariables=a}static fromArticlesRaw(s){return new ds("article",s.name,{},{name:s.name,count:s.count,quantity:s.quantity,quantityUnit:s.quantityUnit,cost:s.cost,costUnit:s.unitCost})}static fromBoardMaterialRaw(s,t){const e=A.parseVariables(s.variables,t);return new ds("material",s.ID,e)}}class Ia extends E{addInstances(s){var t,e;for(const a of(t=s.costing.articles)!=null?t:[])a.type==="CUTTINGPATTERN_BOARD"&&this.addInstance(a.name,ds.fromArticlesRaw(a));for(const a of(e=s.boards)!=null?e:[])this.addInstance(a.ID,ds.fromBoardMaterialRaw(a,s.variableDefinitions.boards));return this}}function be(f,s){return s.split(".").reduce((t,e)=>t==null?void 0:t[e],f)}const gt=(f,s)=>{f.sort((t,e)=>{for(const{field:a,order:i="asc"}of s){const r=be(t,a),n=be(e,a);if(r==null&&n!=null)return i==="asc"?1:-1;if(r!=null&&n==null)return i==="asc"?-1:1;if(!(r==null&&n==null)){if(r<n)return i==="asc"?-1:1;if(r>n)return i==="asc"?1:-1}}return 0});for(const t of f)Array.isArray(t.children)&&gt(t.children,s)};class Kt{constructor(s,t,e,a,i,r){this.key=s,this.refPart=t,this.variables=e,this.messages=a,this.documents=i,this.shape=r}static fromProfileRaw(s,t){const e=A.parseVariables(s.variables,t);return new Kt(s.ID,s.part,e,s.messages,W.fromDocumentsRaw(s.documents),s.shape)}}class ka extends E{addInstances(s){var t;for(const e of(t=s.profilings)!=null?t:[])this.addInstance(e.ID,Kt.fromProfileRaw(e,s.variableDefinitions.profilings));return this}}class fs{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P,y,T,B,k,S,C,N,O,R,I,L,Q,j,F,G,$,q,Z){this.database=s,this.projectData=t,this.panelsData=e,this.stocksData=a,this.partsData=i,this.assembliesData=r,this.edgebandsData=n,this.edgebandMaterialsData=h,this.profilesData=o,this.materialsData=l,this.boardMaterialsData=d,this.programsData=g,this.programPartsData=c,this.toolsData=u,this.spindlesData=p,this.costsData=m,this.typedObjectsData=b,this.panelProcessesData=M,this.processZonesData=P,this.patternsData=y,this.panelDataManager=T,this.stockDataManager=B,this.partDataManager=k,this.assemblyDataManager=S,this.edgebandDataManager=C,this.edgebandMaterialDataManager=N,this.profileDataManager=O,this.materialDataManager=R,this.boardMaterialDataManager=I,this.programDataManager=L,this.programPartDataManager=Q,this.toolDataManager=j,this.spindleDataManager=F,this.costDataManager=G,this.panelProcessDataManager=$,this.processZoneDataManager=q,this.patternDataManager=Z}static createFromRawData(s){const t=zt.fromProjectRaw(s,s.variableDefinitions.report),e=new fa().addInstances(s),a=new wa().addInstances(s),i=new ba().addInstances(s),r=new ca().addInstances(s),n=new la().addInstances(s),h=new da().addInstances(s),o=new ka().addInstances(s),l=new ua().addInstances(s),d=new Ia().addInstances(s),g=new Pa().addInstances(s),c=new Ma().addInstances(s),u=new Da().addInstances(s),p=new ya().addInstances(s),m=new ga().addInstances(s),b=new Ta().addInstances(s,i,r),M=new ma().addInstances(s),P=new pa().addInstances(s),y=new Aa().addInstances(s.cuttingPattern);return new fs(s,t,e.getAll(),a.getAll(),i.getAll(),r.getAll(),n.getAll(),h.getAll(),o.getAll(),l.getAll(),d.getAll(),g.getAll(),c.getAll(),u.getAll(),p.getAll(),m.getAll(),b.getAll(),M.getAll(),P.getAll(),y.getAll(),e,a,i,r,n,h,o,l,d,g,c,u,p,m,M,P,y).relateData()}relateData(){return this.assignDataToEdgebands(),this.assignDataToStocks(),this.assignDataToPanels(),this.assignDataToAssemblies(),this.assignSubAssemblies(),this.assignDataToParts(),this.sortData(),this}sortData(){const s=[{field:"variables.PAN_T",order:"desc"},{field:"material.name",order:"asc"},{field:"variables.PAN_L",order:"desc"},{field:"variables.PAN_W",order:"desc"},{field:"name",order:"asc"},{field:"quantity",order:"asc"}];gt(this.panelsData,s);const t=[{field:"variables.ST_T",order:"desc"},{field:"refMaterial",order:"asc"},{field:"variables.ST_L",order:"desc"},{field:"variables.ST_W",order:"desc"},{field:"name",order:"asc"},{field:"quantity",order:"asc"}];gt(this.stocksData,t)}assignDataToEdgebands(){for(const s of this.edgebandDataManager.getAll())s.material=this.edgebandMaterialDataManager.get(s.refMaterial)}assignDataToStocks(){for(const s of this.stockDataManager.getAll()){const t=this.materialDataManager.get(s.refMaterial);s.material=t}}assignDataToPanels(){for(const s of this.panelDataManager.getAll()){for(const e of s.refStocks){const a=this.stockDataManager.get(e);a&&(s.stocks.push(a),a.variables.ST_N==="CORE"&&(s.material=a.material))}for(const e of s.refEdgebands){const a=this.edgebandDataManager.get(e);a&&s.edgebands.push(a)}for(const e of s.refPrograms){const a=this.programDataManager.get(e);a&&s.programs.push(a)}const t=this.partDataManager.get(s.key);t&&(s.part=t)}}assignDataToAssemblies(){var s,t;for(const e of this.assemblyDataManager.getAll()){for(const a of e.refParts){const i=this.partDataManager.get(a);i&&((s=e.parts)==null||s.push(i))}for(const a of e.refPrograms){const i=this.programDataManager.get(a);i&&((t=e.programs)==null||t.push(i))}}}assignSubAssemblies(){var s;for(const t of this.assemblyDataManager.getAll())for(const e of t.refAssemblies){const a=this.assemblyDataManager.get(e);a&&((s=t.assemblies)==null||s.push(a))}}assignDataToParts(){var s;for(const t of this.partDataManager.getAll()){t.panel=t.refPanel?this.panelDataManager.get(t.refPanel):void 0;for(const e of(s=t.refStocks)!=null?s:[]){const a=this.stockDataManager.get(e);a&&t.stocks.push(a)}for(const e of t.refPrograms){const a=this.programDataManager.get(e);a&&(t.programs.push(a),a.part=t)}}}}class v{constructor(){this.instances=new Map}add(s,t){this.instances.set(s,t)}get(s){return this.instances.get(s)}getAll(){return Array.from(this.instances.values())}getTotalInstances(){return this.instances.size}}class $e{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P){this.key=s,this.messages=t,this.variables=e,this.heritedVariables=a,this.typedObjectVariables=i,this.refPrograms=r,this.refParts=n,this.refPartsQuantities=h,this.refAssemblies=o,this.refAssembliesQuantities=l,this.documents=d,this.swcps=g,this.name=c,this.description=u,this.configuration=p,this.quantity=m,this.height=b,this.width=M,this.depth=P,this.resource="assemblies",this.programs=[],this.parts=[],this.assemblies=[]}static fromAssemblyBusiness(s){return s.createViewModel()}}const Y=class Y{constructor(s,t,e,a,i,r,n,h){this.type=s,this.typeDescription=t,this.description=e,this.message=a,this.messageType=i,this.item=r,this.category=n,this.url=h,this.resource="messages"}};Y.fromMessageRaw=(s,t="",e="",a="")=>new Y(s.type,s.typeDesc,s.desc,s.message,s.messageType,t,e,a),Y.fromMessagesRaw=(s,t="",e="",a="")=>{const i=[];for(const r of s!=null?s:[])i.push(Y.fromMessageRaw(r,t,e,a));return i};let D=Y;class U{constructor(s){this.documents=s}getImages(){var t;const s={};for(const e of(t=this.documents)!=null?t:[])if(e.docType==="IMAGE"){const a=e.absoluteURI,i=x.getInstance(),r="file:///"+He(i.reportPath),n=oa(a,r);e.name!==null&&(s[e.name]=n)}return s}}const Rs=class Rs{constructor(s,t,e,a,i,r,n,h,o,l,d,g){this.key=s,this.messages=t,this.variables=e,this.heritedVariables=a,this.typedObjectVariables=i,this.refPrograms=r,this.refParts=n,this.refPartsQuantities=h,this.refAssemblies=o,this.refAssembliesQuantities=l,this.documents=d,this.swcps=g,this.programs=[],this.parts=[],this.assemblies=[],this.getName=()=>this.variables.NAME,this.getDescription=()=>this.variables.DESC,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>{var c;return((c=this.variables.NB)!=null?c:0)*x.getInstance().projectQuantity},this.getHeight=()=>{var c;return(c=this.variables.Height)!=null?c:0},this.getWidth=()=>{var c;return(c=this.variables.Width)!=null?c:0},this.getDepth=()=>{var c;return(c=this.variables.Depth)!=null?c:0},this.getImages=()=>new U(this.documents).getImages()}createViewModel(){return new $e(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Assembly"),this.variables,this.heritedVariables,this.typedObjectVariables,this.refPrograms,this.refParts,this.refPartsQuantities,this.refAssemblies,this.refAssembliesQuantities,this.documents,this.swcps,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getHeight(),this.getWidth(),this.getDepth())}};Rs.fromAssemblyData=s=>new Rs(s.key,s.messages,s.variables,s.heritedVariables,s.typedObjectVariables,s.refPrograms,s.refParts,s.refPartsQuantities,s.refAssemblies,s.refAssembliesQuantities,s.documents,s.swcps);let lt=Rs;class Pe extends v{constructor(){super(...arguments),this.addPrograms=s=>{const t=this.getAll();for(const e of t)for(const a of e.refPrograms){const i=s.get(a);i&&e.programs.push(i)}},this.addParts=s=>{const t=this.getAll();for(const e of t)for(const a of e.refParts){const i=s.get(a);i&&e.parts.push(i)}},this.addAssemblies=s=>{const t=this.getAll();for(const e of t)for(const a of e.refAssemblies){const i=s.get(a);i&&e.assemblies.push(i)}}}addInstances(s){for(const t of s)this.add(t.key,lt.fromAssemblyData(t));return this}}class qe{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P,y,T){this.key=s,this.swoodVersion=t,this.schemaVersion=e,this.name=a,this.projectPath=i,this.reportPath=r,this.timestamp=n,this.date=h,this.time=o,this.createdBy=l,this.documents=d,this.swcps=g,this.messages=c,this.variables=u,this.isDesign=p,this.isCam=m,this.isNesting=b,this.isUsingOffcuts=M,this.configuration=P,this.reportVersion=y,this.swoodDataDirectory=T,this.resource="project"}static fromProjectBusiness(s){return s.createViewModel()}}class V{constructor(s){this.documents=s}getDocuments(){var t;const s={};for(const e of(t=this.documents)!=null?t:[])e.name!==null&&e.name!==""&&(s[e.name]=e);return s}}class at{constructor(s){this.documents=s}getPDFs(){var t;const s={};for(const e of(t=this.documents)!=null?t:[])e.docType==="DRAWING2PDF"&&e.exists&&e.name!==null&&(s[e.name]=e.relativeURI);return s}}const Es=class Es{constructor(s,t,e,a,i,r,n,h,o,l,d,g){this.key=s,this.swoodVersion=t,this.schemaVersion=e,this.name=a,this.projectPath=i,this.reportPath=r,this.timestamp=n,this.createdBy=h,this.documents=o,this.messages=l,this.variables=d,this.swcps=g,this.getTime=()=>{const c=new Date(this.timestamp),u=String(c.getHours()).padStart(2,"0"),p=String(c.getMinutes()).padStart(2,"0"),m=String(c.getSeconds()).padStart(2,"0");return"".concat(u,":").concat(p,":").concat(m)},this.getDate=()=>{const c=new Date(this.timestamp),u=c.getFullYear(),p=String(c.getMonth()+1).padStart(2,"0"),m=String(c.getDate()).padStart(2,"0");return"".concat(m,"/").concat(p,"/").concat(u)},this.getIsDesign=()=>{var c;return(c=this.variables.REPORT_ISUSINGDESIGN)!=null?c:!1},this.getIsCam=()=>{var c;return(c=this.variables.REPORT_ISUSINGCAM)!=null?c:!1},this.getIsNesting=()=>{var c;return(c=this.variables.REPORT_ISNESTINGPROJECT)!=null?c:!1},this.getIsUsingOffcuts=()=>{var c;return(c=this.variables.MODULE_PROGRAMOFFCUTS_ISACTIVE)!=null?c:!1},this.getImages=()=>new U(this.documents).getImages(),this.getPDFs=()=>new at(this.documents).getPDFs(),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getConfiguration=()=>{var c,u;return(u=(c=this.component)==null?void 0:c.getConfiguration())!=null?u:""},this.getReportVersion=()=>{var c;return(c=this.variables.ReportVersion)!=null?c:"0.0.0"},this.getSwoodDataDirectory=()=>{var c;return(c=this.variables.SwoodDataDirectory)!=null?c:""}}createViewModel(){return new qe(this.key,this.swoodVersion,this.schemaVersion,this.name,this.projectPath,this.reportPath,this.timestamp,this.getDate(),this.getTime(),this.createdBy,this.getDocuments(),this.swcps,D.fromMessagesRaw(this.messages,this.name,"Project"),this.variables,this.getIsDesign(),this.getIsCam(),this.getIsNesting(),this.getIsUsingOffcuts(),this.getConfiguration(),this.getReportVersion(),this.getSwoodDataDirectory())}};Es.fromProjectData=s=>new Es(s.key,s.swoodVersion,s.schemaVersion,s.name,s.projectPath,s.reportPath,s.timestamp,s.createdBy,s.documents,s.messages,s.variables,s.swcps);let ms=Es;const Vs=class Vs{constructor(s,t){this.articles=s,this.cost=t}};Vs.fromCostData=s=>new Vs(s.articles,s.cost);let dt=Vs;class Me extends v{addInstances(s){return this.add("0",dt.fromCostData(s[0])),this}}const Ls=class Ls{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M){this.key=s,this.refPanel=t,this.refMaterial=e,this.variables=a,this.documents=i,this.messages=r,this.name=n,this.quantity=h,this.length=o,this.lengthStock=l,this.width=d,this.thickness=g,this.order=c,this.overLength=u,this.position=p,this.isCurved=m,this.isPaint=b,this.cost=M,this.resource="edgebands"}static fromEdgebandBusiness(s){return s.createViewModel()}};Ls.createCombinedEdgeband=(s,t,e)=>new Ls(s.key,s.refPanel,s.refMaterial,s.variables,s.documents,s.messages,t,e,s.length,s.lengthStock,s.width,s.thickness,s.order,s.overLength,s.position,s.isCurved,s.isPaint,s.cost);let ps=Ls;const Ws=class Ws{constructor(s,t,e,a,i,r){this.key=s,this.refPanel=t,this.refMaterial=e,this.variables=a,this.documents=i,this.messages=r,this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>{var n;return(n=this.variables.EB_N)!=null?n:""},this.getQuantity=()=>{var n,h;return(h=(n=this.panel)==null?void 0:n.getQuantity())!=null?h:0},this.getLength=()=>{var n;return(n=this.variables.EB_L)!=null?n:0},this.getLengthStock=()=>{var n;return(n=this.variables.EB_LSTOCK)!=null?n:0},this.getWidth=()=>{var n,h;return(h=(n=this.panel)==null?void 0:n.getThickness())!=null?h:0},this.getThickness=()=>{var n,h;return(h=(n=this.material)==null?void 0:n.getThickness())!=null?h:0},this.getOrder=()=>{var n;return(n=this.variables.EB_BO)!=null?n:0},this.getOverLength=()=>{var n;return(n=this.variables.EB_OVERLENGTH)!=null?n:0},this.getPosition=()=>this.variables.EB_STOCKPOSITION,this.getIsCurved=()=>{var n;return(n=this.variables.EB_ISCURVED)!=null?n:!1},this.getIsPaint=()=>{var n,h;return(h=(n=this.material)==null?void 0:n.getIsPaint())!=null?h:!1},this.getMaterialQuantity=()=>(this.getLength()+this.getOverLength())/1e3*this.getQuantity(),this.getCost=()=>{var n,h;return this.getMaterialQuantity()*((h=(n=this.material)==null?void 0:n.getCostUnit())!=null?h:0)},this.updateMaterialQuantity=()=>{this.material?this.material.quantity+=(this.getLength()+this.getOverLength())/1e3*this.getQuantity():console.warn("unable to update quantity – material or panel missing for ".concat(this.getName()))}}createViewModel(){return this.updateMaterialQuantity(),new ps(this.key,this.refPanel,this.refMaterial,this.variables,this.getDocuments(),D.fromMessagesRaw(this.messages,this.getName(),"Edgeband"),this.getName(),this.getQuantity(),this.getLength(),this.getLengthStock(),this.getWidth(),this.getThickness(),this.getOrder(),this.getOverLength(),this.getPosition(),this.getIsCurved(),this.getIsPaint(),this.getCost())}};Ws.fromEdgebandData=s=>new Ws(s.key,s.panel,s.refMaterial,s.variables,s.documents,s.messages);let ut=Ws;class ye extends v{constructor(){super(...arguments),this.addMaterials=s=>{const t=this.getAll();for(const e of t){const a=s.get(e.refMaterial);a&&(e.material=a)}}}addInstances(s){for(const t of s)this.add(t.key,ut.fromEdgebandData(t));return this}}class Ze{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u){this.key=s,this.variables=t,this.name=e,this.description=a,this.reference=i,this.thickness=r,this.extension=n,this.color=h,this.isPaint=o,this.cost=l,this.costUnit=d,this.costType=g,this.quantity=c,this.unitOfMeasure=u,this.resource="edgebandMaterials"}static fromEdgebandMaterialBusiness(s){return s.createViewModel()}}const xs=class xs{constructor(s,t,e){this.key=s,this.variables=t,this.quantity=e,this.createViewModel=()=>new Ze(this.key,this.variables,this.getName(),this.getDescription(),this.getReference(),this.getThickness(),this.getExtension(),this.getColor(),this.getIsPaint(),this.getCost(),this.getCostUnit(),2,this.quantity,"m"),this.getName=()=>{var a;return(a=this.variables.EBMAT_C)!=null?a:""},this.getDescription=()=>{var a;return(a=this.variables.EBMAT_D)!=null?a:""},this.getReference=()=>{var a;return(a=this.variables.EBMAT_REF)!=null?a:""},this.getCostUnit=()=>this.variables.EBMAT_UCOST,this.getThickness=()=>{var a;return(a=this.variables.EBMAT_T)!=null?a:0},this.getIsPaint=()=>{var a;return(a=this.variables.PAINT)!=null?a:!1},this.getExtension=()=>{var a;return(a=this.variables.EXTENSION)!=null?a:0},this.getCost=()=>this.quantity*this.getCostUnit(),this.getColor=()=>{if(this.variables.EBMAT_CO!==void 0&&this.variables.EBMAT_CO!=="0")return this.argbToRgba(this.variables.EBMAT_CO)},this.argbToRgba=a=>{if(a=a.replace(/^#/,""),a.length!==8)return console.warn("invalid ARGB hex format: ".concat(a)),"#000000ff";const i=parseInt(a.slice(0,2),16)/255,r=parseInt(a.slice(2,4),16),n=parseInt(a.slice(4,6),16),h=parseInt(a.slice(6,8),16);return"rgba(".concat(r,", ").concat(n,", ").concat(h,", ").concat(i.toFixed(2),")")}}};xs.fromEdgebandMaterialData=s=>new xs(s.key,s.variables,0);let ft=xs;class we extends v{addInstances(s){for(const t of s)this.add(t.key,ft.fromEdgebandMaterialData(t));return this}}class w{constructor(){this.instances=new Map}addInstance(s,t){this.instances.set(s,t)}get(s){return this.instances.get(s)}getAll(){return Array.from(this.instances.values())}getTotalInstances(){return this.instances.size}groupBy(s){const t=new Map;for(const e of this.getAll()){const a=this.getNestedValue(s.toString(),e);t.has(a)||t.set(a,[]),t.get(a).push(e)}return t}mergeDescription(s,t){return s?!t||s.includes(t)?s:"".concat(s," | ").concat(t):t}getNestedValue(s,t){return s.split(".").reduce((e,a)=>e==null?void 0:e[a],t)}}const re=class re{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P,y,T){this.key=s,this.messages=t,this.refParts=e,this.refPartsQuantities=a,this.refAssemblies=i,this.refAssembliesQuantities=r,this.documents=n,this.swcps=h,this.variables=o,this.heritedVariables=l,this.typedObjectVariables=d,this.name=g,this.configuration=c,this.quantity=u,this.height=p,this.width=m,this.depth=b,this.url=M,this.cost=P,this.costPanels=y,this.costHardware=T,this.resource="frames",this.parts=[],this.assemblies=[],this.panels=[],this.programs=[],this.hardware=[],this.weldments=[]}};re.fromFrameBusiness=s=>s.createViewModel();let bs=re;const Qs=class Qs{constructor(s,t,e,a,i,r,n,h,o,l,d){this.key=s,this.messages=t,this.heritedVariables=e,this.typedObjectVariables=a,this.refParts=i,this.refPartsQuantities=r,this.refAssemblies=n,this.refAssembliesQuantities=h,this.documents=o,this.swcps=l,this.variables=d,this.parts=[],this.assemblies=[],this.panels=[],this.programs=[],this.hardware=[],this.weldments=[],this.getName=()=>this.variables.NAME,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>{var g;return((g=this.variables.NB)!=null?g:0)*x.getInstance().projectQuantity},this.getHeight=()=>{var g;return(g=this.swcps.Height)!=null?g:0},this.getWidth=()=>{var g;return(g=this.swcps.Width)!=null?g:0},this.getDepth=()=>{var g;return(g=this.swcps.Depth)!=null?g:0},this.getImages=()=>new U(this.documents).getImages(),this.getPDFs=()=>new at(this.documents).getPDFs(),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getUrl=()=>"frames/".concat(this.key),this.getCostPanels=()=>{let g=0;for(const c of this.panels)g+=c.getCost();return g},this.getCostHardware=()=>{let g=0;for(const c of this.hardware)g+=c.getCost();return g},this.getCost=()=>this.getCostPanels()+this.getCostHardware(),this.getIsExcluded=()=>this.typedObjectVariables!=null&&"EXCLUDED"in this.typedObjectVariables}createViewModel(){return new bs(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Frame",this.getUrl()),this.refParts,this.refPartsQuantities,this.refAssemblies,this.refAssembliesQuantities,this.getDocuments(),this.swcps,this.variables,this.heritedVariables,this.typedObjectVariables,this.getName(),this.getConfiguration(),this.getQuantity(),this.getHeight(),this.getWidth(),this.getDepth(),this.getUrl(),this.getCost(),this.getCostPanels(),this.getCostHardware())}};Qs.fromAssemblyPartBusiness=s=>new Qs(s.key,s.messages,s.heritedVariables,s.typedObjectVariables,"refParts"in s?s.refParts:[],"refPartsQuantities"in s?s.refPartsQuantities:[],"refAssemblies"in s?s.refAssemblies:[],"refAssembliesQuantities"in s?s.refAssembliesQuantities:[],s.documents,s.swcps,s.variables);let mt=Qs;class De extends w{constructor(){super(...arguments),this.FrameTypedObjectName="FRAME"}addInstances(s){var e;const t=(e=s.getInstancesByName(this.FrameTypedObjectName))!=null?e:[];for(const a of t)this.addInstance(a.key,mt.fromAssemblyPartBusiness(a));return this}}const ne=class ne{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m){this.key=s,this.messages=t,this.heritedVariables=e,this.typedObjectVariables=a,this.refPrograms=i,this.refParts=r,this.refAssemblies=n,this.documents=h,this.swcps=o,this.variables=l,this.name=d,this.configuration=g,this.quantity=c,this.length=u,this.cost=p,this.costUnit=m,this.resource="hardware",this.parts=[],this.assemblies=[],this.refQuantities=[],this.frames=[]}};ne.fromHardwareBusiness=s=>s.createViewModel();let Ps=ne;const js=class js{constructor(s,t,e,a,i,r,n,h,o,l){this.key=s,this.messages=t,this.heritedVariables=e,this.typedObjectVariables=a,this.refPrograms=i,this.refParts=r,this.refAssemblies=n,this.documents=h,this.swcps=o,this.variables=l,this.parts=[],this.assemblies=[],this.createViewModel=()=>new Ps(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Hardware"),this.heritedVariables,this.typedObjectVariables,this.refPrograms,this.refParts,this.refAssemblies,this.getDocuments(),this.swcps,this.variables,this.getName(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getCost(),this.getCostUnit()),this.getName=()=>this.variables.NAME,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>this.variables.NB,this.getLength=()=>this.variables.Length,this.getImages=()=>new U(this.documents).getImages(),this.getCost=()=>this.getCostUnit()*this.getQuantity(),this.getCostUnit=()=>{var d;return(d=this.swcps.Cost)!=null?d:0},this.getDocuments=()=>new V(this.documents).getDocuments(),this.getIsExcluded=()=>this.typedObjectVariables!=null&&"EXCLUDED"in this.typedObjectVariables}};js.fromAssemblyPartBusiness=s=>new js(s.key,s.messages,s.heritedVariables,s.typedObjectVariables,s.refPrograms,"refParts"in s?s.refParts:[],"refAssemblies"in s?s.refAssemblies:[],s.documents,s.swcps,s.variables);let pt=js;class Te extends w{constructor(){super(...arguments),this.HardwareTypedObjectName="HARDWARE"}addInstances(s){var e;const t=(e=s.getInstancesByName(this.HardwareTypedObjectName))!=null?e:[];for(const a of t)this.addInstance(a.key,pt.fromAssemblyPartBusiness(a));return this}}const gs=class gs{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c){this.key=s,this.refPanel=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=r,this.name=n,this.description=h,this.quantity=o,this.length=l,this.width=d,this.thickness=g,this.cost=c,this.resource="laminates"}};gs.fromLaminateBusiness=s=>s.createViewModel(),gs.createCombinedLaminate=(s,t,e)=>new gs(s.key,s.refPanel,s.refMaterial,s.messages,s.documents,s.variables,t,s.description,e,s.length,s.width,s.thickness,s.cost);let us=gs;const Fs=class Fs{constructor(s,t,e,a,i,r,n){this.key=s,this.refPanel=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=r,this.settings=n,this.createViewModel=()=>(this.updateMaterialQuantity(),new us(this.key,this.refPanel,this.refMaterial,D.fromMessagesRaw(this.messages,this.getName(),"Laminate"),this.getDocuments(),this.variables,this.getName(),this.getDescription(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getCost())),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>this.variables.ST_N,this.getDescription=()=>this.variables.ST_DESC,this.getQuantity=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.getQuantity())!=null?o:0},this.getSwoodLength=()=>this.variables.ST_L,this.getSwoodWidth=()=>this.variables.ST_W,this.getThickness=()=>this.variables.ST_T,this.getHasGrain=()=>{var h,o;return(o=(h=this.material)==null?void 0:h.getHasGrain())!=null?o:!1},this.getLength=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).length,this.getWidth=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).width,this.getVolume=()=>this.getLength()*this.getWidth()*this.getThickness()/1e9,this.getSurface=()=>this.getLength()*this.getWidth()/1e6,this.getMaterialQuantity=()=>{if(!this.material)return console.warn("material not defined for ".concat(this.getName())),0;switch(this.material.getCostType()){case 0:return this.getVolume();case 1:return this.getSurface();case 2:return this.getLength()/1e3;case 3:return this.getQuantity();default:return 0}},this.getCost=()=>{var h,o;return this.getMaterialQuantity()*((o=(h=this.material)==null?void 0:h.getCostUnit())!=null?o:0)},this.updateMaterialQuantity=()=>{const h=this.getName();if(!this.panel){console.warn("Panel not defined for ".concat(h));return}if(!this.material){console.warn("unable to update quantity – material missing for ".concat(h));return}if(this.panel.isNested||this.panel.isPatterned)return;const o=this.getMaterialQuantity()*this.getQuantity();this.material.quantity+=o}}getLongest(s,t,e){return this.settings.LengthLongestEdge?e?{length:s,width:t}:t>s?{width:t,length:s}:{length:s,width:t}:{length:s,width:t}}};Fs.fromStockData=(s,t)=>new Fs(s.key,s.refPart,s.refMaterial,s.messages,s.documents,s.variables,t);let bt=Fs;class Ae extends v{addInstances(s,t){var e;for(const a of s)((e=a.material)==null?void 0:e.variables.MAT_TYPE)===1&&this.add(a.key,bt.fromStockData(a,t));return this}}class ze{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.name=i,this.description=r,this.category=n,this.thickness=h,this.hasGrain=o,this.cost=l,this.costUnit=d,this.costType=g,this.quantity=c,this.type=u,this.unitOfMeasure=p,this.resource="materials"}static fromMaterialBusiness(s){return s.createViewModel()}}const Us=class Us{constructor(s,t,e,a,i){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.quantity=i,this.createViewModel=()=>new ze(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Material"),this.getDocuments(),this.variables,this.getName(),this.getDescription(),this.getCategory(),this.getThickness(),this.getHasGrain(),this.getCost(),this.getCostUnit(),this.getCostType(),this.quantity,this.getType(),this.getUnitOfMeasure()),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>{var r;return(r=this.variables.MAT_NAME)!=null?r:""},this.getDescription=()=>{var r;return(r=this.variables.MAT_DESC)!=null?r:""},this.getCategory=()=>{var r;return(r=this.variables.CATEGORY)!=null?r:""},this.getCostUnit=()=>{var r;return(r=this.variables.MAT_UCOST)!=null?r:0},this.getCostType=()=>{var r;return(r=this.variables.MAT_COSTTYPE)!=null?r:0},this.getHasGrain=()=>{var r;return(r=this.variables.MAT_WITHGRAIN)!=null?r:!1},this.getThickness=()=>{var r;return(r=this.variables.MAT_T)!=null?r:0},this.getBoardLength=()=>{var r;return(r=this.variables.BOARD_LENGTH)!=null?r:0},this.getBoardWidth=()=>{var r;return(r=this.variables.BOARD_WIDTH)!=null?r:0},this.getUnitOfMeasure=()=>{switch(this.getCostType()){case 0:return"m³";case 1:return"m²";case 2:return"m";case 3:return"unit";default:return"unknown"}},this.getCost=()=>this.quantity*this.getCostUnit(),this.getType=()=>{var r;return(r=this.variables.MAT_TYPE)!=null?r:0},this.getIsWeldment=()=>{var r;return(r=this.variables.WELDMENT)!=null?r:!1}}};Us.fromMaterialData=s=>new Us(s.key,s.messages,s.documents,s.variables,0);let Pt=Us;class Ie extends v{addInstances(s){for(const t of s)this.add(t.key,Pt.fromMaterialData(t));return this}}class va{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P,y,T,B,k,S,C,N,O,R,I,L,Q,j,F,G,$,q,Z,_,X,K,J,ss,ts,es,as,is,rs,ns,hs,os,cs){this.key=s,this.name=t,this.refPart=e,this.refPrograms=a,this.refStocks=i,this.refProcessZones=r,this.refEdgebands=n,this.messages=h,this.variables=o,this.heritedVariables=l,this.typedObjectVariables=d,this.serialNumbers=g,this.documents=c,this.swcps=u,this.configuration=p,this.quantity=m,this.length=b,this.width=M,this.thickness=P,this.lengthWithEdgeband=y,this.widthWithEdgeband=T,this.thicknessWithLaminate=B,this.lengthWithoutEdgeband=k,this.widthWithoutEdgeband=S,this.thicknessWithoutLaminate=C,this.lengthStock=N,this.widthStock=O,this.thicknessStock=R,this.hasGrain=I,this.hasEdgebands=L,this.hasLaminates=Q,this.hasPrograms=j,this.hasProcessZones=F,this.isPatterned=G,this.isNested=$,this.angle=q,this.volume=Z,this.boardLength=_,this.boardWidth=X,this.cost=K,this.costUnit=J,this.costCore=ss,this.costEdgebands=ts,this.costLaminates=es,this.costPrograms=as,this.costProcessZones=is,this.hasTopPrograms=rs,this.hasBottomPrograms=ns,this.quantityTopPrograms=hs,this.quantityBottomPrograms=os,this.settings=cs,this.resource="panels",this.frames=[],this.stocks=[],this.layers=[],this.edgebands=[],this.laminates=[],this.programs=[],this.processZones=[],this.profiles=[],this.refQuantities=[]}static fromPanelBusiness(s){return s.createViewModel()}}const Gs=class Gs{constructor(s,t,e,a,i,r,n,h,o,l,d,g){this.key=s,this.name=t,this.refPart=e,this.refPrograms=a,this.refStocks=i,this.refProcessZones=r,this.refEdgebands=n,this.messages=h,this.documents=o,this.variables=l,this.serialNumbers=d,this.settings=g,this.programs=[],this.stocks=[],this.edgebands=[],this.laminates=[],this.processZones=[],this.isPatterned=!1,this.isNested=!1,this.getConfiguration=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.getConfiguration())!=null?u:""},this.getQuantity=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.getQuantity())!=null?u:0},this.getSwoodLength=()=>this.variables.PAN_L,this.getSwoodWidth=()=>{var c;return(c=this.variables.PAN_W)!=null?c:0},this.getSwoodThickness=()=>this.variables.PAN_T,this.getSwoodLengthWithEdgeband=()=>this.variables.PAN_LWEB,this.getSwoodWidthWithEdgeband=()=>this.variables.PAN_WWEB,this.getSwoodThicknessWithLaminate=()=>this.variables.PAN_TWL,this.getSwoodLengthWithoutEdgeband=()=>this.variables.PAN_LWOEB,this.getSwoodWidthWithoutEdgeband=()=>this.variables.PAN_WWOEB,this.getSwoodThicknessWithoutLaminate=()=>this.variables.PAN_TWOL,this.getSwoodLengthStock=()=>this.variables.PAN_STL,this.getSwoodWidthStock=()=>this.variables.PAN_STW,this.getSwoodThicknessStock=()=>this.variables.PAN_STT,this.getLength=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).length,this.getWidth=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).width,this.getThickness=()=>this.getSwoodThickness(),this.getHasGrain=()=>this.stocks.some(c=>{var u;return((u=c.material)==null?void 0:u.getHasGrain())===!0}),this.getHasEdgebands=()=>this.edgebands.length>0,this.getHasLaminates=()=>this.laminates.length>0,this.getHasPrograms=()=>this.programs.length>0,this.getHasProcessZones=()=>this.processZones.length>0,this.getAngleGrain=()=>{var p,m;if(!((m=(p=this.getCoreStock())==null?void 0:p.material)!=null&&m.getHasGrain()))return null;const c=this.variables.PAN_ANGLEINPART,u=this.variables.PAN_GRAINANGLEINPART;return c+u},this.getLengthWithEdgeband=()=>this.getLongest(this.getSwoodLengthWithEdgeband(),this.getSwoodWidthWithEdgeband(),this.getHasGrain()).length,this.getWidthWithEdgeband=()=>this.getLongest(this.getSwoodLengthWithEdgeband(),this.getSwoodLengthWithEdgeband(),this.getHasGrain()).width,this.getThicknessWithLaminate=()=>this.getSwoodThicknessWithLaminate(),this.getLengthWithoutEdgeband=()=>this.getLongest(this.getSwoodLengthWithoutEdgeband(),this.getSwoodWidthWithoutEdgeband(),this.getHasGrain()).length,this.getWidthWithoutEdgeband=()=>this.getLongest(this.getSwoodLengthWithoutEdgeband(),this.getSwoodWidthWithoutEdgeband(),this.getHasGrain()).width,this.getThicknessWithoutLaminate=()=>this.getSwoodThicknessWithoutLaminate(),this.getLengthStock=()=>this.getLongest(this.getSwoodLengthStock(),this.getSwoodWidthStock(),this.getHasGrain()).length,this.getWidthStock=()=>this.getLongest(this.getSwoodLengthStock(),this.getSwoodWidthStock(),this.getHasGrain()).width,this.getThicknessStock=()=>this.getSwoodThicknessStock(),this.getVolume=()=>this.getLength()*this.getWidth()*this.getThickness()/1e9,this.getSurface=()=>this.getLength()*this.getWidth()/1e6,this.getImages=()=>new U(this.documents).getImages(),this.getPDFs=()=>new at(this.documents).getPDFs(),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getSwcps=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.swcps)!=null?u:{}},this.getHeritedVariables=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.heritedVariables)!=null?u:{}},this.getTypedObjectVariables=()=>{var c,u;return(u=(c=this.part)==null?void 0:c.typedObjectVariables)!=null?u:{}},this.getMaterialQuantity=()=>{if(!this.material)return console.warn("material not defined for ".concat(this.name)),0;switch(this.material.getCostType()){case 0:return this.getVolume();case 1:return this.getSurface();case 2:return this.getLength()/1e3;case 3:return this.getQuantity();default:return 0}},this.getCost=()=>this.getCostUnit()*this.getQuantity(),this.getCostUnit=()=>this.getCostCore()+this.getCostEdgebands()+this.getCostLaminates()+this.getCostProcessZones(),this.getCostCore=()=>{var c,u;return this.getMaterialQuantity()*((u=(c=this.material)==null?void 0:c.getCostUnit())!=null?u:0)},this.getCostEdgebands=()=>{let c=0;for(const u of this.edgebands)c+=u.getCost();return c},this.getCostLaminates=()=>{let c=0;for(const u of this.laminates)c+=u.getCost();return c},this.getCostPrograms=()=>{let c=0;for(const u of this.programs)c+=u.getCost();return c},this.getCostProcessZone=c=>{if(!c.panelProcess)return console.warn("panelProcess not defined for ".concat(this.name)),0;const u=c.panelProcess.getCostUnit(),p=c.getCostType();let m=0,b=0;switch(p){case 0:m=this.getVolume(),b=u*m;break;case 1:m=this.getSurface(),b=u*m;break;case 2:m=this.getLength()/1e3,b=u*m;break;case 3:m=this.getQuantity(),b=u*m;break;default:return 0}return c.panelProcess.quantity+=m,b},this.getCostProcessZones=()=>{let c=0;for(const u of this.processZones)c+=this.getCostProcessZone(u);return c},this.getQuantityTopPrograms=()=>this.programs.filter(c=>c.getIsTopProgram()).length,this.getQuantityBottomPrograms=()=>this.programs.filter(c=>c.getIsBottomProgram()).length,this.getHasTopPrograms=()=>this.programs.some(c=>c.getIsTopProgram()),this.getHasBottomPrograms=()=>this.programs.some(c=>c.getIsBottomProgram()),this.getBoardLength=()=>{var c,u;return(u=(c=this.material)==null?void 0:c.getBoardLength())!=null?u:0},this.getBoardWidth=()=>{var c,u;return(u=(c=this.material)==null?void 0:c.getBoardWidth())!=null?u:0},this.getIsExcluded=()=>{var u;return((u=this.part)==null?void 0:u.variables.TOTYPES).split(";").includes("EXCLUDED")},this.updateMaterialQuantity=()=>{if(!this.material){console.warn("unable to update quantity – material missing for ".concat(this.name));return}if(this.isNested||this.isPatterned||this.getIsExcluded())return;const c=this.getMaterialQuantity()*this.getQuantity();this.material.quantity+=c}}createViewModel(){return this.updateMaterialQuantity(),new va(this.key,this.name,this.refPart,this.refPrograms,this.refStocks,this.refProcessZones,this.refEdgebands,D.fromMessagesRaw(this.messages,this.name,"Panel"),this.variables,this.getHeritedVariables(),this.getTypedObjectVariables(),this.serialNumbers,this.getDocuments(),this.getSwcps(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getLengthWithEdgeband(),this.getWidthWithEdgeband(),this.getThicknessWithLaminate(),this.getLengthWithoutEdgeband(),this.getWidthWithoutEdgeband(),this.getThicknessWithoutLaminate(),this.getLengthStock(),this.getWidthStock(),this.getThicknessStock(),this.getHasGrain(),this.getHasEdgebands(),this.getHasLaminates(),this.getHasPrograms(),this.getHasProcessZones(),this.isPatterned,this.isNested,this.getAngleGrain(),this.getVolume(),this.getBoardLength(),this.getBoardWidth(),this.getCost(),this.getCostUnit(),this.getCostCore(),this.getCostEdgebands(),this.getCostLaminates(),this.getCostPrograms(),this.getCostProcessZones(),this.getHasTopPrograms(),this.getHasBottomPrograms(),this.getQuantityTopPrograms(),this.getQuantityBottomPrograms(),this.settings)}getLongest(s,t,e){return this.settings.LengthLongestEdge?e?{length:s,width:t}:t>s?{width:t,length:s}:{length:s,width:t}:{length:s,width:t}}getCoreStock(){for(const s of this.stocks)if(s.variables.ST_N==="CORE")return s}};Gs.fromPanelData=(s,t)=>new Gs(s.key,s.name,s.refPart,s.refPrograms,s.refStocks,s.refProcessZones,s.refEdgebands,s.messages,s.documents,s.variables,s.serialNumbers,t);let Mt=Gs;class ke extends v{constructor(){super(...arguments),this.addStocks=s=>{const t=this.getAll();for(const e of t)for(const a of e.refStocks){const i=s.get(a);i&&(e.stocks.push(i),i.variables.ST_N==="CORE"&&(e.material=i.material))}},this.addPrograms=s=>{const t=this.getAll();for(const e of t)for(const a of e.refPrograms){const i=s.get(a);i&&(e.programs.push(i),i.panel=e)}},this.addEdgebands=s=>{const t=this.getAll();for(const e of t)for(const a of e.refEdgebands){const i=s.get(a);i&&(e.edgebands.push(i),i.panel=e)}},this.addLaminates=s=>{const t=this.getAll();for(const e of t)for(const a of e.refStocks){const i=s.get(a);i&&(e.laminates.push(i),i.panel=e)}}}addInstances(s,t){for(const e of s)this.add(e.key,Mt.fromPanelData(e,t));return this}}class Ye{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b){this.key=s,this.refPrograms=t,this.refStocks=e,this.refPanel=a,this.bodyCount=i,this.messages=r,this.variables=n,this.heritedVariables=h,this.typedObjectVariables=o,this.documents=l,this.swcps=d,this.name=g,this.configuration=c,this.quantity=u,this.height=p,this.width=m,this.depth=b,this.resource="parts",this.programs=[],this.stocks=[]}static fromPartBusiness(s){return s.createViewModel()}}const Hs=class Hs{constructor(s,t,e,a,i,r,n,h,o,l,d){this.key=s,this.refPrograms=t,this.refStocks=e,this.refPanel=a,this.bodyCount=i,this.messages=r,this.variables=n,this.heritedVariables=h,this.typedObjectVariables=o,this.documents=l,this.swcps=d,this.programs=[],this.stocks=[],this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>{var g;return(g=this.variables.NAME)!=null?g:""},this.getConfiguration=()=>{var g;return(g=this.variables.CONF)!=null?g:""},this.getQuantity=()=>{var g;return((g=this.variables.NB)!=null?g:0)*x.getInstance().projectQuantity},this.getImages=()=>new U(this.documents).getImages()}createViewModel(){return new Ye(this.key,this.refPrograms,this.refStocks,this.refPanel,this.bodyCount,D.fromMessagesRaw(this.messages,this.getName(),"Part"),this.variables,this.heritedVariables,this.typedObjectVariables,this.getDocuments(),this.swcps,this.getName(),this.getConfiguration(),this.getQuantity(),0,0,0)}};Hs.fromPartData=s=>new Hs(s.key,s.refPrograms,s.refStocks,s.refPanel,s.bodyCount,s.messages,s.variables,s.heritedVariables,s.typedObjectVariables,s.documents,s.swcps);let yt=Hs;class ve extends v{constructor(){super(...arguments),this.addStocks=s=>{var e;const t=this.getAll();for(const a of t)for(const i of(e=a.refStocks)!=null?e:[]){const r=s.get(i);r&&(a.stocks.push(r),r.part=a)}},this.addPrograms=s=>{const t=this.getAll();for(const e of t)for(const a of e.refPrograms){const i=s.get(a);i&&(e.programs.push(i),i.part=e)}}}addInstances(s){for(const t of s)this.add(t.key,yt.fromPartData(t));return this}}const he=class he{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P,y,T,B,k,S,C){this.key=s,this.refTools=t,this.programParts=e,this.refBoard=a,this.variables=i,this.heritedVariables=r,this.typedObjectVariables=n,this.messages=h,this.documents=o,this.swcps=l,this.name=d,this.configuration=g,this.quantity=c,this.length=u,this.width=p,this.thickness=m,this.url=b,this.cost=M,this.costHour=P,this.time=y,this.isTopProgram=T,this.isBottomProgram=B,this.machine=k,this.programFilepath=S,this.programDocument=C,this.resource="programs",this.tools=[]}};he.fromProgramBusiness=s=>s.createViewModel();let Ms=he;const $s=class $s{constructor(s,t,e,a,i,r,n){this.key=s,this.refTools=t,this.programParts=e,this.refBoard=a,this.variables=i,this.messages=r,this.documents=n,this.tools=[],this.getDocuments=()=>new V(this.documents).getDocuments(),this.getSwcps=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.swcps)!=null?o:{}},this.getHeritedVariables=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.heritedVariables)!=null?o:{}},this.getTypedObjectVariables=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.typedObjectVariables)!=null?o:{}},this.getName=()=>this.variables.PROG_PHASENAME,this.getConfiguration=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.getConfiguration())!=null?o:""},this.getQuantity=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.getQuantity())!=null?o:0},this.getLength=()=>{var h;return(h=this.variables.PROGBX)!=null?h:0},this.getWidth=()=>{var h;return(h=this.variables.PROGBY)!=null?h:0},this.getThickness=()=>{var h;return(h=this.variables.PROGBZ)!=null?h:0},this.getUrl=()=>"programs/".concat(this.key),this.getImages=()=>new U(this.documents).getImages(),this.getCostHour=()=>{var h;return(h=this.variables.PROGMAC_HOURCOST)!=null?h:0},this.getTotalTime=()=>{var h;return(h=this.variables.PROGTPS)!=null?h:0},this.getCost=()=>this.getCostHour()*this.getTotalTime()/3600,this.getIsTopProgram=()=>this.variables.PROG_OP0ZXPANELZ===1,this.getIsBottomProgram=()=>this.variables.PROG_OP0ZXPANELZ===-1,this.getMachine=()=>{var h;return(h=this.variables.PROGMAC)!=null?h:""},this.getProgramFilepath=()=>{var h;return(h=this.variables.PROGPATH)!=null?h:""},this.getProgramFile=()=>{const h=this.documents.find(o=>o.objType==="PROGRAM"&&o.type===null&&o.docType===null);return h||console.warn("unable to find program document for program: ".concat(this.getName())),h}}createViewModel(){return new Ms(this.key,this.refTools,this.programParts,this.refBoard,this.variables,this.getHeritedVariables(),this.getTypedObjectVariables(),D.fromMessagesRaw(this.messages,this.getName(),"Program",this.getUrl()),this.getDocuments(),this.getSwcps(),this.getName(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getUrl(),this.getCost(),this.getCostHour(),this.getTotalTime(),this.getIsTopProgram(),this.getIsBottomProgram(),this.getMachine(),this.getProgramFilepath(),this.getProgramFile())}};$s.fromProgramData=s=>new $s(s.key,s.refTools,s.refProgramParts,s.refBoard,s.variables,s.messages,s.documents);let wt=$s;class Be extends v{addInstances(s){for(const t of s)t.refBoard||this.add(t.key,wt.fromProgramData(t));return this}addTools(s){const t=this.getAll();for(const e of t)for(const a of e.refTools){const i=s.get(a);i&&e.tools.push(i)}}}const oe=class oe{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m){this.key=s,this.refPart=t,this.refProgram=e,this.messages=a,this.variables=i,this.serialNumbers=r,this.documents=n,this.swcps=h,this.name=o,this.configuration=l,this.quantity=d,this.quantityInSheet=g,this.quantityInProject=c,this.programPartId=u,this.angle=p,this.parent=m,this.resource="programParts",this.programs=[]}};oe.fromProgramPartBusiness=s=>s.createViewModel();let ys=oe;const qs=class qs{constructor(s,t,e,a,i,r,n){this.key=s,this.refPart=t,this.refProgram=e,this.documents=a,this.messages=i,this.variables=r,this.serialNumbers=n,this.sheets=[],this.getDocuments=()=>new V(this.documents).getDocuments(),this.getSwcps=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.swcps)!=null?o:{}},this.getImages=()=>new U(this.documents).getImages(),this.getName=()=>{var h;return(h=this.panel)==null?void 0:h.name},this.getConfiguration=()=>{var h,o;return(o=(h=this.part)==null?void 0:h.getConfiguration())!=null?o:""},this.getQuantity=()=>{var h,o;return((o=(h=this.sheet)==null?void 0:h.getQuantity())!=null?o:0)*x.getInstance().projectQuantity},this.getQuantityInSheet=()=>{var h,o;return((o=(h=this.sheet)==null?void 0:h.programParts)!=null?o:[]).filter(l=>this.getName()===l.getName()).length},this.getQuantityInProject=()=>{var o;let h=0;for(const l of this.sheets)for(const d of l.programParts)((o=d.part)==null?void 0:o.getName())===this.getName()&&(h+=l.getQuantity()*x.getInstance().projectQuantity);return h},this.getProgramPartId=()=>this.variables.PROGPART_ID,this.getAngle=()=>this.variables.PROGPART_NANGLE,this.getParentIndex=()=>this.variables.PROGPART_NPARENTINDEX,this.getParentName=()=>this.variables.PROGPART_NPARENTNAME,this.getParentPath=()=>this.variables.PROGPART_NPARENTPATH,this.getParentConfiguration=()=>this.variables.PROGPART_NPARENTCONFIG}createViewModel(){return new ys(this.key,this.refPart,this.refProgram,D.fromMessagesRaw(this.messages,this.getName(),"Program Part"),this.variables,this.serialNumbers,this.getDocuments(),this.getSwcps(),this.getName(),this.getConfiguration(),this.getQuantity(),this.getQuantityInSheet(),this.getQuantityInProject(),this.getProgramPartId(),this.getAngle(),{index:this.getParentIndex(),name:this.getParentName(),configuration:this.getParentConfiguration(),filepath:this.getParentPath()})}};qs.fromProgramPartData=s=>new qs(s.key,s.part,s.program,s.documents,s.messages,s.variables,s.serialNumbers);let Dt=qs;class Se extends v{addInstances(s){for(const t of s)this.add(t.key,Dt.fromProgramPartData(t));return this}}const Zs=class Zs{constructor(s,t,e,a){this.key=s,this.messages=t,this.documents=e,this.variables=a}};Zs.fromSpindleData=s=>new Zs(s.key,s.messages,s.documents,s.variables);let Tt=Zs;class Ce extends v{addInstances(s){if(!s)return this;for(const t of s)this.add(t.key,Tt.fromSpindleData(t));return this}}const ls=class ls{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.swcps=r,this.variables=n,this.name=h,this.configuration=o,this.quantity=l,this.length=d,this.width=g,this.thickness=c,this.angle=u,this.resource="stocks"}};ls.fromStockBusiness=s=>s.createViewModel(),ls.createCombinedStock=(s,t,e)=>new ls(s.key,s.refPart,s.refMaterial,s.messages,s.documents,s.swcps,s.variables,t,s.configuration,e,s.length,s.width,s.thickness,s.angle);let ws=ls;const zs=class zs{constructor(s,t,e,a,i,r){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=r,this.createViewModel=()=>new ws(this.key,this.refPart,this.refMaterial,D.fromMessagesRaw(this.messages,this.getName(),"Stock"),this.documents,this.getSwcps(),this.variables,this.getName(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getAngle()),this.getSwcps=()=>{var n,h;return(h=(n=this.part)==null?void 0:n.swcps)!=null?h:{}},this.getName=()=>{var n,h;return(h=(n=this.panel)==null?void 0:n.name)!=null?h:""},this.getConfiguration=()=>{var n,h;return(h=(n=this.part)==null?void 0:n.getConfiguration())!=null?h:""},this.getQuantity=()=>{var n,h;return(h=(n=this.part)==null?void 0:n.getQuantity())!=null?h:0},this.getLength=()=>this.variables.ST_L,this.getWidth=()=>this.variables.ST_W,this.getThickness=()=>this.variables.ST_T,this.getAngle=()=>{var n;return(n=this.variables.ST_ANGLEINPANEL)!=null?n:0}}};zs.fromStockData=s=>new zs(s.key,s.refPart,s.refMaterial,s.messages,s.documents,s.variables);let At=zs;class Ne extends v{constructor(){super(...arguments),this.addMaterials=s=>{const t=this.getAll();for(const e of t){const a=s.get(e.refMaterial);a&&(e.material=a)}}}addInstances(s){for(const t of s)this.add(t.key,At.fromStockData(t));return this}}const ce=class ce{constructor(s,t,e,a,i,r,n,h,o){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.refSpindles=i,this.name=r,this.reference=n,this.number=h,this.diameter=o,this.spindles=[]}};ce.fromToolBusiness=s=>s.createViewModel();let Ds=ce;class Jt{constructor(s,t,e,a,i=[]){this.key=s,this.variables=t,this.messages=e,this.documents=a,this.refSpindles=i,this.createViewModel=()=>new Ds(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Tool"),this.getDocuments(),this.variables,this.refSpindles,this.getName(),this.getReference(),this.getNumber(),this.getDiameter()),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>this.variables.TOOL_NAME,this.getReference=()=>this.variables.TOOL_REFERENCE,this.getNumber=()=>this.variables.TOOL_DIAM,this.getDiameter=()=>this.variables.TOOL_NUMBER}static fromToolData(s){return new Jt(s.key,s.variables,s.messages,s.documents,s.refSpindles)}}class Oe extends v{addInstances(s){for(const t of s)this.add(t.key,Jt.fromToolData(t));return this}}class Re{constructor(){this.instances=new Map}addInstance(s,t){const e=this.instances.get(s);e?e.push(t):this.instances.set(s,[t])}addInstances(s,t,e){for(const a of s.typedObjects){const i=t.get(a);if(i){const n=i.variables.TOTYPES.split(";");for(const h of n)this.addInstance(h,i)}const r=e.get(a);if(r){const n=r.variables.TOTYPES.split(";");for(const h of n)this.addInstance(h,r)}}return this}getInstancesByName(s){return this.instances.get(s)||void 0}getAll(){return this.instances}}const ge=class ge{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P){this.key=s,this.refTools=t,this.refProgramParts=e,this.refBoard=a,this.variables=i,this.messages=r,this.documents=n,this.name=h,this.quantity=o,this.programFilename=l,this.programFilepath=d,this.totalParts=g,this.totalOffcuts=c,this.machine=u,this.length=p,this.width=m,this.thickness=b,this.url=M,this.programDocument=P,this.resource="sheets",this.tools=[],this.programParts=[]}};ge.fromProgramBusiness=s=>s.createViewModel();let Ts=ge;const Ys=class Ys{constructor(s,t,e,a,i,r,n){this.key=s,this.refTools=t,this.refProgramParts=e,this.refBoard=a,this.variables=i,this.messages=r,this.documents=n,this.programParts=[],this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>this.variables.PROG_PHASENAME,this.getQuantity=()=>{var h;return((h=this.variables.PROG_NSHEETQTY)!=null?h:0)*x.getInstance().projectQuantity},this.getProgramFilename=()=>this.variables.PROGCFGFILE,this.getProgramFilepath=()=>this.variables.PROGCFGPATH,this.getProgramComment=()=>this.variables.PROGCOMMENT,this.getTotalParts=()=>this.variables.PROG_PARTCOUNT,this.getTotalOffcuts=()=>this.variables.PROG_OFFCUTCOUNT,this.getMachine=()=>this.variables.PROGMAC,this.getLength=()=>this.variables.PROGBX,this.getWidth=()=>this.variables.PROGBY,this.getThickness=()=>this.variables.PROGBZ,this.getUrl=()=>"sheets/".concat(this.key),this.getImages=()=>new U(this.documents).getImages(),this.getProgramFile=()=>{const h=this.documents.find(o=>o.objType==="PROGRAM"&&o.type===null&&o.docType===null);return h||console.warn("unable to find program document for program: ".concat(this.getName())),h}}createViewModel(){return new Ts(this.key,this.refTools,this.refProgramParts,this.refBoard,this.variables,D.fromMessagesRaw(this.messages,this.getName(),"Sheet",this.getUrl()),this.getDocuments(),this.getName(),this.getQuantity(),this.getProgramFilename(),this.getProgramFilepath(),this.getTotalParts(),this.getTotalOffcuts(),this.getMachine(),this.getLength(),this.getWidth(),this.getThickness(),this.getUrl(),this.getProgramFile())}};Ys.fromProgramData=s=>new Ys(s.key,s.refTools,s.refProgramParts,s.refBoard,s.variables,s.messages,s.documents);let It=Ys;class Ee extends v{addInstances(s){for(const t of s)t.refBoard&&this.add(t.key,It.fromProgramData(t));return this}}const le=class le{constructor(s,t,e,a,i,r,n,h,o,l,d,g){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.name=i,this.description=r,this.quantity=n,this.thickness=h,this.category=o,this.cost=l,this.costUnit=d,this.costType=g,this.resource="panelProcesses"}};le.fromPanelProcessBusiness=s=>s.createViewModel();let kt=le;class se{constructor(s,t,e,a,i){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.quantity=i,this.createViewModel=()=>new kt(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Panel Process"),this.documents,this.variables,this.getName(),this.getDescription(),this.quantity,this.getThickness(),this.getCategory(),this.getCost(),this.getCostUnit(),this.getCostType()),this.getName=()=>this.variables.PROC_NAME,this.getDescription=()=>this.variables.PROC_DESC,this.getThickness=()=>this.variables.PROC_THICKNESS,this.getCategory=()=>this.variables.PROC_CAT,this.getCostUnit=()=>this.variables.PROC_UCOST,this.getCost=()=>this.quantity*this.getCostUnit(),this.getCostType=()=>this.variables.PROC_COSTTYPE}static fromPanelProcessData(s){return new se(s.key,s.messages,s.documents,s.variables,0)}}class Ve extends v{addInstances(s){if(!s)return this;for(const t of s)this.add(t.key,se.fromPanelProcessData(t));return this}}const de=class de{constructor(s,t,e,a,i,r,n,h,o,l,d){this.key=s,this.refPanel=t,this.refPanelProcess=e,this.messages=a,this.documents=i,this.variables=r,this.name=n,this.quantity=h,this.unitOfMeasure=o,this.cost=l,this.mask=d,this.resource="processZones"}};de.fromProcessZoneBusiness=s=>s.createViewModel();let vt=de;class te{constructor(s,t,e,a,i,r){this.key=s,this.refPanel=t,this.refPanelProcess=e,this.messages=a,this.documents=i,this.variables=r,this.createViewModel=()=>new vt(this.key,this.refPanel,this.refPanelProcess,D.fromMessagesRaw(this.messages,this.getName(),"Process Zone"),this.documents,this.variables,this.getName(),this.getQuantity(),this.getUnitOfMeasure(),this.getCost(),this.getMask()),this.getName=()=>this.variables.PROC_ZONENAME,this.getQuantity=()=>this.variables.PROC_ZONE_QTT,this.getUnitOfMeasure=()=>this.variables.PROC_ZONE_QTT_UNIT,this.getCost=()=>this.variables.PROC_ZONE_COST,this.getMask=()=>this.variables.PROC_ZONEMASK,this.getCostUnit=()=>this.panelProcess?this.panelProcess.getCostUnit():0,this.getCostType=()=>this.panelProcess?this.panelProcess.getCostType():0}static fromProcessZoneData(s){return new te(s.key,s.refPanel,s.refPanelProcess,s.messages,s.documents,s.variables)}}class Le extends v{addInstances(s){if(!s)return this;for(const t of s)this.add(t.key,te.fromProcessZoneData(t));return this}}class _e{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P,y){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.swcps=r,this.variables=n,this.heritedVariables=h,this.typedObjectVariables=o,this.name=l,this.description=d,this.configuration=g,this.quantity=c,this.length=u,this.lengthTotal=p,this.width=m,this.thickness=b,this.angle1=M,this.angle2=P,this.cutlist=y,this.resource="weldments",this.addChildren=T=>{this.children||(this.children=[]),this.children.push(T)}}static fromWeldmentBusiness(s){return s.createViewModel()}}const _s=class _s{constructor(s,t,e,a,i,r){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=r,this.getDocuments=()=>new V(this.documents).getDocuments(),this.getSwcps=()=>{var n,h;return(h=(n=this.part)==null?void 0:n.swcps)!=null?h:{}},this.getHeritedVariables=()=>{var n,h;return(h=(n=this.part)==null?void 0:n.heritedVariables)!=null?h:{}},this.getTypedObjectVariables=()=>{var n,h;return(h=(n=this.part)==null?void 0:n.typedObjectVariables)!=null?h:{}},this.getName=()=>{var n;return(n=this.variables.ST_N)!=null?n:""},this.getDescription=()=>{var n;return(n=this.variables.MBS_Description)!=null?n:""},this.getConfiguration=()=>{var n,h;return(h=(n=this.part)==null?void 0:n.getConfiguration())!=null?h:""},this.getPartQuantity=()=>{var n,h;return(h=(n=this.part)==null?void 0:n.getQuantity())!=null?h:0},this.getQuantity=()=>{var n;return(n=this.variables.MBS_Quantity)!=null?n:0*this.getPartQuantity()},this.getLength=()=>this.variables.MBS_Length,this.getLengthTotal=()=>this.variables.MBS_TotalLength,this.getWidth=()=>this.variables.ST_W,this.getThickness=()=>this.variables.ST_T,this.getAngle1=()=>{var n;return(n=this.variables.MBS_Angle1)!=null?n:""},this.getAngle2=()=>{var n;return(n=this.variables.MBS_Angle2)!=null?n:""},this.getCutlist=()=>{var n;return(n=this.variables.MBS_Cutlist)!=null?n:""},this.getIsExcluded=()=>{var h;return((h=this.part)==null?void 0:h.variables.TOTYPES).split(";").includes("EXCLUDED")}}createViewModel(){return new _e(this.key,this.refPart,this.refMaterial,D.fromMessagesRaw(this.messages,this.getName(),"Weldment"),this.getDocuments(),this.getSwcps(),this.variables,this.getHeritedVariables(),this.getTypedObjectVariables(),this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getLengthTotal(),this.getWidth(),this.getThickness(),this.getAngle1(),this.getAngle2(),this.getCutlist())}};_s.fromStockData=s=>new _s(s.key,s.refPart,s.refMaterial,s.messages,s.documents,s.variables);let Bt=_s;class We extends v{addInstances(s){var t;for(const e of s)(t=e.material)!=null&&t.variables.WELDMENT&&this.add(e.key,Bt.fromStockData(e));return this}}class Xe{constructor(s,t,e,a,i,r,n,h,o,l,d,g){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.name=i,this.description=r,this.cost=n,this.costUnit=h,this.costType=o,this.quantity=l,this.type=d,this.unitOfMeasure=g,this.resource="weldmentMaterials"}static fromMaterialBusiness(s){return s.createViewModel()}}const Xs=class Xs{constructor(s,t,e,a,i,r){this.key=s,this.description=t,this.messages=e,this.documents=a,this.variables=i,this.quantity=r,this.createViewModel=()=>new Xe(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Weldment Material"),this.getDocuments(),this.variables,this.getName(),this.description,this.getCost(),this.getCostUnit(),this.getCostType(),this.quantity,this.getType(),this.getUnitOfMeasure()),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>{var n;return(n=this.variables.MAT_NAME)!=null?n:""},this.getDescription=()=>{var n;return(n=this.variables.MAT_DESC)!=null?n:""},this.getCostUnit=()=>{var n;return(n=this.variables.MAT_UCOST)!=null?n:0},this.getCostType=()=>{var n;return(n=this.variables.MAT_COSTTYPE)!=null?n:0},this.getBoardLength=()=>{var n;return(n=this.variables.BOARD_LENGTH)!=null?n:0},this.getBoardWidth=()=>{var n;return(n=this.variables.BOARD_WIDTH)!=null?n:0},this.getUnitOfMeasure=()=>{switch(this.getCostType()){case 0:return"m³";case 1:return"m²";case 2:return"m";case 3:return"unit";default:return"unknown"}},this.getCost=()=>this.quantity*this.getCostUnit(),this.getType=()=>{var n;return(n=this.variables.MAT_TYPE)!=null?n:0},this.getIsWeldment=()=>{var n;return(n=this.variables.WELDMENT)!=null?n:!1}}};Xs.fromMaterialData=(s,t)=>new Xs("".concat(s.key,"-").concat(t.getDescription()," "),t.getDescription(),s.messages,s.documents,s.variables,t.getLengthTotal()/1e3);let St=Xs;class xe extends v{addInstances(s,t){for(const e of t){const a=s.get(e.refMaterial);if(a&&a.getIsWeldment()){const i=St.fromMaterialData(a,e);this.add(i.key,i)}}return this}}const ue=class ue{constructor(s,t,e,a,i,r,n,h,o,l){this.key=s,this.messages=t,this.documents=e,this.swcps=a,this.variables=i,this.heritedVariables=r,this.typedObjectVariables=n,this.name=h,this.configuration=o,this.quantity=l,this.resource="excluded"}};ue.fromExcludedBusiness=s=>s.createViewModel();let As=ue;const Ks=class Ks{constructor(s,t,e,a,i,r,n,h,o){this.key=s,this.messages=t,this.heritedVariables=e,this.typedObjectVariables=a,this.refParts=i,this.refAssemblies=r,this.documents=n,this.swcps=h,this.variables=o,this.parts=[],this.assemblies=[],this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>this.variables.NAME,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>this.variables.NB}createViewModel(){return new As(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Excluded"),this.getDocuments(),this.swcps,this.variables,this.heritedVariables,this.typedObjectVariables,this.getName(),this.getConfiguration(),this.getQuantity())}};Ks.fromAssemblyPartBusiness=s=>new Ks(s.key,s.messages,s.heritedVariables,s.typedObjectVariables,"refParts"in s?s.refParts:[],"refAssemblies"in s?s.refAssemblies:[],s.documents,s.swcps,s.variables);let Ct=Ks;class Qe extends w{constructor(){super(...arguments),this.FrameTypedObjectName="EXCLUDED"}addInstances(s){var e;const t=(e=s.getInstancesByName(this.FrameTypedObjectName))!=null?e:[];for(const a of t)this.addInstance(a.key,Ct.fromAssemblyPartBusiness(a));return this}}class Ke{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P,y,T,B,k,S,C,N,O,R){this.key=s,this.name=t,this.url=e,this.refBoard=a,this.quantity=i,this.length=r,this.width=n,this.thickness=h,this.cutterThickness=o,this.areaTotal=l,this.areaPanels=d,this.areaWaste=g,this.areaTrims=c,this.areaCuts=u,this.percentagePanels=p,this.percentageWaste=m,this.percentageTrims=b,this.quantityPanels=M,this.quantityWaste=P,this.quantityTrims=y,this.quantityCuts=T,this.lengthCuts=B,this.stock=k,this.refPanels=S,this.items=C,this.cuts=N,this.trims=O,this.waste=R,this.resource="patterns",this.panels=[]}static fromPatternBusiness(s){return s.createViewModel()}}class Nt{constructor(s){this.cuts=[],this.length=s.length,this.width=s.width,this.cutDirection=s.cutDirection,this.coordinate=s.cutCoordinate,this.stockLeft=s.stockLeft?s.stockLeft:null,this.stockRight=s.stockRight?s.stockRight:null}}class ee{constructor(s){var t,e;this.indexParent=-1,this.children=[],this.cuts=[],this.parent=null,this.quantity=1,this.stock=s,this.type=s.type,this.length=s.length,this.width=s.width,this.grain=s.grain,this.cutDirection=s.cutDirection,this.cutterThickness=s.cutterThickness,this.name=(e=(t=s.name)!=null?t:s.type)!=null?e:"group",this.cutCoordinate=s.cutCoordinate,this.x=s.x,this.y=s.y,this.parent=s.parent?new ee(s.parent):null}}class Is{constructor(s){var t,e;this.parent=null,this.index=0,this.indexPanel=0,this.indexParent=-1,this.children=[],this.cuts=[],this.stock=s,this.type=s.type,this.length=s.length,this.width=s.width,this.grain=s.grain,this.cutDirection=s.cutDirection,this.cutterThickness=s.cutterThickness,this.name=(e=(t=s.name)!=null?t:s.type)!=null?e:"group",this.cutCoordinate=s.cutCoordinate,this.x=s.x,this.y=s.y,this.parent=s.parent?new Is(s.parent):null}getTrimSide(s){for(const t of this.children)if(t.type==="trimming"||t.type==="padding"){if(s==="length"&&this.cutDirection==="V")return this.cutCoordinate;if(s==="width"&&this.cutDirection==="H")return this.cutCoordinate}return 0}getGroupedNodes(){const s=[];for(const t of this.children){const e=new ee(t.stock);this.isPreviousEqual(e,s[s.length-1])?s[s.length-1].quantity++:s.push(e)}return s}isPreviousEqual(s,t){return t?s.length===t.length&&s.width===t.width&&s.type===t.type:!1}}class ks{constructor(s,t=null,e=0,a=0){this.type=s.type,this.length=s.length*1e3,this.width=s.width*1e3,this.cutDirection=s.cut,this.name=s["panel-name"]!=""?s["panel-name"]:null,this.cutCoordinate=s["cut-coordinate"]*1e3,this.grain=s["grain-direction"],this.cutterThickness=s["cut-half-thickness"]*2*1e3,this.parent=t,this.x=e,this.y=a;let i=0,r=0,n=0,h=0;s.cut==="V"&&(n=this.x+this.cutCoordinate+this.cutterThickness,h=this.y,i=this.x,r=this.y),s.cut==="H"&&(n=this.x,h=this.y+this.cutCoordinate+this.cutterThickness,i=this.x,r=this.y),this.stockLeft=s["left-stock"]?new ks(s["left-stock"],this,i,r):null,this.stockRight=s["right-stock"]?new ks(s["right-stock"],this,n,h):null}getTreeStructure(){const s=new Is(this),t=this.findChildren(s,this.stockLeft),e=this.findChildren(s,this.stockRight);s.children=[...t,...e];const a=new Nt(this),i=this.findCuts(a,this.stockLeft),r=this.findCuts(a,this.stockRight);return s.cuts=[...i,...r],s}findChildren(s,t){if(!t)return[];const e=new Is(t);if(e.indexParent=s.index,t.type===null){if(s.cutDirection===t.cutDirection){const r=this.findChildren(s,t.stockLeft),n=this.findChildren(s,t.stockRight);return[...r,...n]}const a=this.findChildren(e,t.stockLeft),i=this.findChildren(e,t.stockRight);e.children=[...a,...i]}return[e]}findCuts(s,t){if(!t)return[];const e=new Nt(t);if(t.type===null){if(s.cutDirection===t.cutDirection){const r=this.findCuts(s,t.stockLeft),n=this.findCuts(s,t.stockRight);return[...r,...n]}const a=this.findCuts(e,t.stockLeft),i=this.findCuts(e,t.stockRight);e.cuts=[...a,...i]}return[e]}}const Js=class Js{constructor(s,t,e,a,i,r,n,h,o,l){this.key=s,this.name=t,this.material=e,this.stock=a,this.length=i,this.width=r,this.thickness=n,this.cutterThickness=h,this.panelsBusiness=o,this.url=l,this.getQuantity=()=>x.getInstance().projectQuantity}createViewModel(){return new Ke(this.key,this.name,this.url,this.material,this.getQuantity(),this.length,this.width,this.thickness*1e3,this.cutterThickness,this.getTotalArea(),this.getPanelArea(),this.getWasteArea(),this.getTrimArea(),this.getCutArea(),this.getPanelAreaPercentage(),this.getWasteAreaPercentage(),this.getTrimAreaPercentage(),this.getRefPanels().length,this.getTrims().length,this.getWaste().length,this.getCuts().length,this.getLengthCuts(),this.stock,this.getRefPanels(),this.getItems(),this.getCuts(),this.getTrims(),this.getWaste())}getCuts(s=[],t){return t||(t=this.stock),t.cutDirection&&s.push(new Nt(t)),t.stockLeft&&this.getCuts(s,t.stockLeft),t.stockRight&&this.getCuts(s,t.stockRight),s}getItems(s=!1){const t=this.getFlattenedTreeStructure(s),e=[];for(const a of t)a.type&&e.push(a);return e}getPanels(s=!1){const t=this.getFlattenedTreeStructure(s),e=[];for(const a of t)a.type==="item"&&e.push(a);return e}getRefPanels(s=!1){var a;const t=this.getFlattenedTreeStructure(s),e=[];for(const i of t)i.type==="item"&&e.push((a=i.name)!=null?a:"");return e}getLengthCuts(s){const t=this.getCuts();let e=0;for(const i of t)i.cutDirection==="V"&&(e+=i.width),i.cutDirection==="H"&&(e+=i.length);const a=e/1e3;return s?parseFloat(a.toFixed(2)):a}getTrims(s=!1){const t=this.getFlattenedTreeStructure(s),e=[];for(const a of t)(a.type==="trimming"||a.type==="padding")&&e.push(a);return e}getWaste(s=!1){const t=this.getFlattenedTreeStructure(s),e=[];for(const a of t)a.type==="waste"&&e.push(a);return e}getTreeStructure(s=!1){const t=this.stock.getTreeStructure();return s&&this.reverseChildren(t),this.assignIndexes(t)}getFlattenedTreeStructure(s=!1){const t=this.getTreeStructure(s),e=[];return this.flattenTree(t,e),e}getTotalArea(s){const t=this.length*this.width/1e6;return s?parseFloat(t.toFixed(2)):t}getPanelArea(s){const t=this.getPanels();let e=0;for(const i of t)e+=i.length*i.width;const a=e/1e6;return s?parseFloat(a.toFixed(2)):a}getPanelAreaPercentage(s){const t=this.getPanelArea()/this.getTotalArea()*100;return s?parseFloat(t.toFixed(2)):t}getWasteArea(s){const t=this.getWaste();let e=0;for(const i of t)e+=i.length*i.width;const a=e/1e6;return s?parseFloat(a.toFixed(2)):a}getWasteAreaPercentage(s){const t=this.getWasteArea()/this.getTotalArea()*100;return s?parseFloat(t.toFixed(2)):t}getTrimArea(s){const t=this.getTrims();let e=0;for(const i of t)e+=i.length*i.width;const a=e/1e6;return s?parseFloat(a.toFixed(2)):a}getCutArea(s){const t=this.getCuts();let e=0;for(const i of t)i.cutDirection==="V"&&(e+=i.width*this.cutterThickness),i.cutDirection==="H"&&(e+=i.length*this.cutterThickness);const a=e/1e6;return s?parseFloat(a.toFixed(2)):a}getTrimAreaPercentage(s){const t=this.getTrimArea()/this.getTotalArea()*100;return s?parseFloat(t.toFixed(2)):t}getFirstTrimSize(s=this.stock){if(s.type==="trimming"||s.type==="padding")return s.parent.cutCoordinate;if(s.stockLeft)return this.getFirstTrimSize(s.stockLeft);if(s.stockRight)return this.getFirstTrimSize(s.stockRight)}assignIndexes(s,t={index:0,panelIndex:0}){s.index=t.index++,s.type==="item"&&(s.indexPanel=t.panelIndex++);for(const e of s.children)this.assignIndexes(e,t);return s}flattenTree(s,t){if(t.push(s),s.children)for(const e of s.children)this.flattenTree(e,t)}reverseChildren(s){if(s.children){s.children.reverse();for(const t of s.children)this.reverseChildren(t)}}};Js.fromPatternData=(s,t)=>{const e=new ks(s.stock);return new Js(s.key,s.name,s.material,e,e.length,e.width,s.thickness,e.cutterThickness,t,"patterns/".concat(s.name))};let Ot=Js;class je extends v{addInstances(s,t){for(const e of s)this.add(e.key,Ot.fromPatternData(e,t));return this}}class Je{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c){this.key=s,this.name=t,this.description=e,this.length=a,this.width=i,this.thickness=r,this.count=n,this.quantity=h,this.type=o,this.unitOfMeasure=l,this.cost=d,this.costUnit=g,this.refMaterial=c,this.resource="boardMaterials"}static fromBoardMaterialBusiness(s){return s.createViewModel()}}const st=class st{constructor(s,t,e={},a={}){this.type=s,this.key=t,this.variables=e,this.articleVariables=a,this.createViewModel=()=>new Je(this.key,this.getName(),this.getDescription(),this.getLength(),this.getWidth(),this.getThickness(),this.getCount(),this.getQuantity(),this.getType(),this.getUnitOfMeasure(),this.getCost(),this.getCostUnit(),this.getRefMaterial()),this.getName=()=>{var i;if(this.type==="article"){const r=this.parseMaterialSize(this.articleVariables.name);return r?r.name:""}return(i=this.variables.NBOARD_NAME)!=null?i:""},this.getDescription=()=>{var i;if(this.type==="article"){const r=this.parseMaterialSize(this.articleVariables.name);return r?r.name:""}return(i=this.variables.NBOARD_DESC)!=null?i:""},this.getLength=()=>{var i;if(this.type==="article"){const r=this.parseMaterialSize(this.articleVariables.name);return r?r.length:0}return(i=this.variables.NBOARD_L)!=null?i:0},this.getWidth=()=>{var i;if(this.type==="article"){const r=this.parseMaterialSize(this.articleVariables.name);return r?r.width:0}return(i=this.variables.NBOARD_W)!=null?i:0},this.getThickness=()=>{var i;return this.type==="article"?0:(i=this.variables.NBOARD_T)!=null?i:0},this.getCount=()=>this.type==="article"?this.articleVariables.count:0,this.getQuantity=()=>{var i,r;return this.type==="article"?((i=this.articleVariables.quantity)!=null?i:0)*x.getInstance().projectQuantity:((r=this.variables.NBOARD_QTY)!=null?r:0)*x.getInstance().projectQuantity},this.getType=()=>{var i;return this.type==="article"?-1:(i=this.variables.NBOARD_TYPE)!=null?i:0},this.getUnitOfMeasure=()=>"u",this.getCost=()=>this.type==="article"?this.articleVariables.cost*x.getInstance().projectQuantity:this.getQuantity()*this.getCostUnit(),this.getCostUnit=()=>{var i;return this.type==="article"?this.articleVariables.costUnit:(i=this.variables.NBOARD_COST)!=null?i:0},this.getRefMaterial=()=>{var i;return this.type==="article"?this.getName():(i=this.variables.NBOARD_MATNAME)!=null?i:""}}parseMaterialSize(s){const t=s.match(/^(.+?)\s*\((\d+)x(\d+)\)$/);if(!t)return null;const[,e,a,i]=t;return{name:e.trim(),length:parseInt(a,10),width:parseInt(i,10)}}};st.fromBoardMaterialData=s=>new st(s.type,s.key,s.variables,s.articleVariables);let Rt=st;class Fe extends v{addInstances(s){for(const t of s)this.add(t.key,Rt.fromBoardMaterialData(t));return this}}const fe=class fe{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P,y,T){this.key=s,this.messages=t,this.refParts=e,this.refPartsQuantities=a,this.refAssemblies=i,this.refAssembliesQuantities=r,this.documents=n,this.swcps=h,this.variables=o,this.heritedVariables=l,this.typedObjectVariables=d,this.name=g,this.configuration=c,this.quantity=u,this.height=p,this.width=m,this.depth=b,this.url=M,this.cost=P,this.costPanels=y,this.costHardware=T,this.resource="subFrames",this.parts=[],this.assemblies=[],this.panels=[],this.programs=[],this.hardware=[],this.weldments=[],this.refQuantities=[]}};fe.fromFrameBusiness=s=>s.createViewModel();let vs=fe;const tt=class tt{constructor(s,t,e,a,i,r,n,h,o,l,d){this.key=s,this.messages=t,this.heritedVariables=e,this.typedObjectVariables=a,this.refParts=i,this.refPartsQuantities=r,this.refAssemblies=n,this.refAssembliesQuantities=h,this.documents=o,this.swcps=l,this.variables=d,this.parts=[],this.assemblies=[],this.panels=[],this.programs=[],this.hardware=[],this.weldments=[],this.getName=()=>this.variables.NAME,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>{var g;return((g=this.variables.NB)!=null?g:0)*x.getInstance().projectQuantity},this.getHeight=()=>{var g;return(g=this.variables.Height)!=null?g:0},this.getWidth=()=>{var g;return(g=this.variables.Width)!=null?g:0},this.getDepth=()=>{var g;return(g=this.variables.Depth)!=null?g:0},this.getImages=()=>new U(this.documents).getImages(),this.getPDFs=()=>new at(this.documents).getPDFs(),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getUrl=()=>"frames/".concat(this.key),this.getCostPanels=()=>{let g=0;for(const c of this.panels)g+=c.getCost();return g},this.getCostHardware=()=>{let g=0;for(const c of this.hardware)g+=c.getCost();return g},this.getCost=()=>this.getCostPanels()+this.getCostHardware(),this.getIsExcluded=()=>this.typedObjectVariables!=null&&"EXCLUDED"in this.typedObjectVariables}createViewModel(){return new vs(this.key,D.fromMessagesRaw(this.messages,this.getName(),"Frame",this.getUrl()),this.refParts,this.refPartsQuantities,this.refAssemblies,this.refAssembliesQuantities,this.getDocuments(),this.swcps,this.variables,this.heritedVariables,this.typedObjectVariables,this.getName(),this.getConfiguration(),this.getQuantity(),this.getHeight(),this.getWidth(),this.getDepth(),this.getUrl(),this.getCost(),this.getCostPanels(),this.getCostHardware())}};tt.fromAssemblyPartBusiness=s=>new tt(s.key,s.messages,s.heritedVariables,s.typedObjectVariables,"refParts"in s?s.refParts:[],"refPartsQuantities"in s?s.refPartsQuantities:[],"refAssemblies"in s?s.refAssemblies:[],"refAssembliesQuantities"in s?s.refAssembliesQuantities:[],s.documents,s.swcps,s.variables);let Et=tt;class Ue extends w{constructor(){super(...arguments),this.FrameTypedObjectName="SUBFRAME"}addInstances(s){var e;const t=(e=s.getInstancesByName(this.FrameTypedObjectName))!=null?e:[];for(const a of t)this.addInstance(a.key,Et.fromAssemblyPartBusiness(a));return this}}const me=class me{constructor(s,t,e,a,i,r,n){this.key=s,this.refPart=t,this.messages=e,this.documents=a,this.variables=i,this.name=r,this.shape=n}};me.fromProfileBusiness=s=>s.createViewModel();let Bs=me;class ae{constructor(s,t,e,a,i,r){this.key=s,this.refPart=t,this.variables=e,this.messages=a,this.documents=i,this.shape=r,this.createViewModel=()=>new Bs(this.key,this.refPart,D.fromMessagesRaw(this.messages,this.getName(),"Profile"),this.getDocuments(),this.variables,this.getName(),this.shape),this.getDocuments=()=>new V(this.documents).getDocuments(),this.getName=()=>this.variables.PRF_N}static fromProfileData(s){return new ae(s.key,s.refPart,s.variables,s.messages,s.documents,s.shape)}}class Ge extends v{addInstances(s){for(const t of s)this.add(t.key,ae.fromProfileData(t));return this}}class Ss{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P,y,T,B,k,S,C,N,O,R,I,L,Q,j,F,G,$,q,Z,_,X,K,J,ss,ts,es,as,is,rs,ns,hs,os,cs,it,rt,nt){this.database=s,this.settings=t,this.projectBusiness=e,this.panelsBusiness=a,this.stocksBusiness=i,this.laminatesBusiness=r,this.partsBusiness=n,this.assembliesBusiness=h,this.edgebandsBusiness=o,this.edgebandMaterialsBusiness=l,this.profilesBusiness=d,this.materialsBusiness=g,this.weldmentMaterialsBusiness=c,this.boardMaterialsBusiness=u,this.programsBusiness=p,this.sheetBusiness=m,this.programPartsBusiness=b,this.toolsBusiness=M,this.spindlesBusiness=P,this.costsBusiness=y,this.typedObjectsBusiness=T,this.framesBusiness=B,this.subFramesBusiness=k,this.hardwaresBusiness=S,this.excludedItemsBusiness=C,this.panelProcessesBusiness=N,this.processZonesBusiness=O,this.weldmentsBusiness=R,this.patternsBusiness=I,this.panelBusinessManager=L,this.stockBusinessManager=Q,this.laminateBusinessManager=j,this.partBusinessManager=F,this.assemblyBusinessManager=G,this.edgebandBusinessManager=$,this.edgebandMaterialBusinessManager=q,this.profilesBusinessManager=Z,this.materialBusinessManager=_,this.weldmentMaterialBusinessManager=X,this.boardMaterialBusinessManager=K,this.programBusinessManager=J,this.sheetBusinessManager=ss,this.programPartBusinessManager=ts,this.toolBusinessManager=es,this.spindleBusinessManager=as,this.costBusinessManager=is,this.frameBusinessManager=rs,this.subFrameBusinessManager=ns,this.hardwareBusinessManager=hs,this.excludedBusinessManager=os,this.panelProcessBusinessManager=cs,this.processZoneBusinessManager=it,this.weldmentBusinessManager=rt,this.patternsBusinessManager=nt}static createFromRawDataNew(s,t){const e=fs.createFromRawData(s),a=ms.fromProjectData(e.projectData),i=new Ie;i.addInstances(e.materialsData);const r=new Oe;r.addInstances(e.toolsData);const n=new Be;n.addInstances(e.programsData),n.addTools(r);const h=new Ne;h.addInstances(e.stocksData),h.addMaterials(i);const o=new ve;o.addInstances(e.partsData),o.addStocks(h),o.addPrograms(n);const l=new Pe;l.addInstances(e.assembliesData),l.addPrograms(n),l.addParts(o),l.addAssemblies(l);const d=new Ae;d.addInstances(e.stocksData,t);const g=new we;g.addInstances(e.edgebandMaterialsData);const c=new ye;c.addInstances(e.edgebandsData),c.addMaterials(g);const u=new Ge().addInstances(e.profilesData),p=new Ee().addInstances(e.programsData),m=new Se().addInstances(e.programPartsData),b=new Ce().addInstances(e.spindlesData),M=new Me().addInstances(e.costsData),P=new Re().addInstances(s,o,l),y=new De().addInstances(P),T=new Ue().addInstances(P),B=new Te().addInstances(P),k=new Qe().addInstances(P),S=new Ve().addInstances(e.panelProcessesData),C=new Le().addInstances(e.processZonesData),N=new We().addInstances(e.stocksData),O=new xe().addInstances(i,N.getAll()),R=new Fe().addInstances(e.boardMaterialsData),I=new ke;I.addInstances(e.panelsData,t),I.addStocks(h),I.addEdgebands(c),I.addLaminates(d),I.addPrograms(n);const L=new je().addInstances(e.patternsData,I.getAll());return new Ss(s,t,a,I.getAll(),h.getAll(),d.getAll(),o.getAll(),l.getAll(),c.getAll(),g.getAll(),u.getAll(),i.getAll(),O.getAll(),R.getAll(),n.getAll(),p.getAll(),m.getAll(),r.getAll(),b.getAll(),M.getAll(),P.getAll(),y.getAll(),T.getAll(),B.getAll(),k.getAll(),S.getAll(),C.getAll(),N.getAll(),L.getAll(),I,h,d,o,l,c,g,u,i,O,R,n,p,m,r,b,M,y,T,B,k,S,C,N,L)}static createFromRawData(s,t){const e=fs.createFromRawData(s),a=ms.fromProjectData(e.projectData),i=new Ie().addInstances(e.materialsData),r=new Be().addInstances(e.programsData),n=new ve().addInstances(e.partsData),h=new Pe().addInstances(e.assembliesData),o=new ke().addInstances(e.panelsData,t),l=new Ne().addInstances(e.stocksData),d=new Ae().addInstances(e.stocksData,t),g=new ye().addInstances(e.edgebandsData),c=new we().addInstances(e.edgebandMaterialsData),u=new Ge().addInstances(e.profilesData),p=new Ee().addInstances(e.programsData),m=new Se().addInstances(e.programPartsData),b=new Oe().addInstances(e.toolsData),M=new Ce().addInstances(e.spindlesData),P=new Me().addInstances(e.costsData),y=new Re().addInstances(s,n,h),T=new De().addInstances(y),B=new Ue().addInstances(y),k=new Te().addInstances(y),S=new Qe().addInstances(y),C=new Ve().addInstances(e.panelProcessesData),N=new Le().addInstances(e.processZonesData),O=new We().addInstances(e.stocksData),R=new xe().addInstances(i,O.getAll()),I=new Fe().addInstances(e.boardMaterialsData),L=new je().addInstances(e.patternsData,o.getAll());return new Ss(s,t,a,o.getAll(),l.getAll(),d.getAll(),n.getAll(),h.getAll(),g.getAll(),c.getAll(),u.getAll(),i.getAll(),R.getAll(),I.getAll(),r.getAll(),p.getAll(),m.getAll(),b.getAll(),M.getAll(),P.getAll(),y.getAll(),T.getAll(),B.getAll(),k.getAll(),S.getAll(),C.getAll(),N.getAll(),O.getAll(),L.getAll(),o,l,d,n,h,g,c,u,i,R,I,r,p,m,b,M,P,T,B,k,S,C,N,O,L).relateData()}relateData(){return this.assignDataToProject(),this.assignDataToEdgebands(),this.assignDataToStocks(),this.assignDataToWeldments(),this.assignDataToLaminates(),this.assignDataToPanels(),this.assignDataToAssemblies(),this.assignSubAssemblies(),this.assignDataToFrames(),this.assignDataToSubFrames(),this.assignDataToParts(),this.assignDataToSheets(),this.assignDataToProgramParts(),this.assignDataToProcessZones(),this}assignDataToProject(){for(const s of this.assemblyBusinessManager.getAll())if(this.projectBusiness.name===s.getName()){this.projectBusiness.component=s;return}for(const s of this.partBusinessManager.getAll())if(this.projectBusiness.name===s.getName()){this.projectBusiness.component=s;return}}assignDataToEdgebands(){for(const s of this.edgebandBusinessManager.getAll())s.material=this.edgebandMaterialBusinessManager.get(s.refMaterial),s.part=this.partBusinessManager.get(s.refPanel),s.panel=this.panelBusinessManager.get(s.refPanel)}assignDataToStocks(){for(const s of this.stockBusinessManager.getAll())s.material=this.materialBusinessManager.get(s.refMaterial),s.part=this.partBusinessManager.get(s.refPart),s.panel=this.panelBusinessManager.get(s.refPart)}assignDataToWeldments(){for(const s of this.weldmentBusinessManager.getAll())s.material=this.weldmentMaterialBusinessManager.get(s.refMaterial),s.part=this.partBusinessManager.get(s.refPart)}assignDataToLaminates(){for(const s of this.laminateBusinessManager.getAll())s.material=this.materialBusinessManager.get(s.refMaterial),s.part=this.partBusinessManager.get(s.refPanel),s.panel=this.panelBusinessManager.get(s.refPanel)}assignDataToPanels(){for(const s of this.panelBusinessManager.getAll()){s.project=this.projectBusiness;const t=this.partBusinessManager.get(s.key);t&&(s.part=t);for(const e of s.refStocks){const a=this.stockBusinessManager.get(e);if(a){s.stocks.push(a),a.variables.ST_N==="CORE"&&(s.material=a.material);continue}const i=this.laminateBusinessManager.get(e);i&&s.laminates.push(i)}for(const e of s.refEdgebands){const a=this.edgebandBusinessManager.get(e);a&&s.edgebands.push(a)}for(const e of s.refPrograms){const a=this.programBusinessManager.get(e);a&&s.programs.push(a)}for(const e of s.refProcessZones){const a=this.processZoneBusinessManager.get(e);a&&s.processZones.push(a)}s.isNested=this.programPartBusinessManager.getAll().some(e=>e.refPart===s.key),s.isPatterned=this.patternsBusinessManager.getAll().some(e=>e.getRefPanels().includes(s.name))}}assignDataToAssemblies(){var s,t;for(const e of this.assemblyBusinessManager.getAll()){for(const a of e.refParts){const i=this.partBusinessManager.get(a);i&&((s=e.parts)==null||s.push(i))}for(const a of e.refPrograms){const i=this.programBusinessManager.get(a);i&&((t=e.programs)==null||t.push(i))}}}assignSubAssemblies(){var s;for(const t of this.assemblyBusinessManager.getAll())for(const e of t.refAssemblies){const a=this.assemblyBusinessManager.get(e);a&&((s=t.assemblies)==null||s.push(a))}}assignDataToFrames(){var s,t;for(const e of this.frameBusinessManager.getAll()){for(const a of e.refParts){const i=this.partBusinessManager.get(a);i&&((s=e.parts)==null||s.push(i));const r=this.panelBusinessManager.get(a);if(r){(t=e.panels)==null||t.push(r);for(const h of r.programs)e.programs.push(h)}const n=this.hardwareBusinessManager.get(a);n&&e.hardware.push(n)}for(const a of e.refAssemblies){const i=this.assemblyBusinessManager.get(a);i&&e.assemblies.push(i);const r=this.hardwareBusinessManager.get(a);r&&e.hardware.push(r)}}}assignDataToSubFrames(){var s,t;for(const e of this.subFrameBusinessManager.getAll()){for(const a of e.refParts){const i=this.partBusinessManager.get(a);i&&((s=e.parts)==null||s.push(i));const r=this.panelBusinessManager.get(a);if(r){(t=e.panels)==null||t.push(r);for(const h of r.programs)e.programs.push(h)}const n=this.hardwareBusinessManager.get(a);n&&e.hardware.push(n)}for(const a of e.refAssemblies){const i=this.assemblyBusinessManager.get(a);i&&e.assemblies.push(i);const r=this.hardwareBusinessManager.get(a);r&&e.hardware.push(r)}}}assignDataToParts(){var s;for(const t of this.partBusinessManager.getAll()){t.panel=t.refPanel?this.panelBusinessManager.get(t.refPanel):void 0;for(const e of(s=t.refStocks)!=null?s:[]){const a=this.stockBusinessManager.get(e);a&&t.stocks.push(a)}for(const e of t.refPrograms){const a=this.programBusinessManager.get(e);a&&(t.programs.push(a),a.part=t)}}}assignDataToSheets(){var s;for(const t of this.sheetBusiness)for(const e of(s=t.refProgramParts)!=null?s:[]){const a=this.programPartBusinessManager.get(e);a&&t.programParts.push(a)}}assignDataToProgramParts(){for(const s of this.programPartsBusiness){const t=this.panelBusinessManager.get(s.refPart);s.panel=t!=null?t:void 0;const e=this.partBusinessManager.get(s.refPart);s.part=e!=null?e:void 0;const a=this.sheetBusinessManager.get(s.refProgram);s.sheet=a!=null?a:void 0;for(const i of this.sheetBusinessManager.getAll())i.programParts.some(r=>r.refPart===s.refPart)&&s.sheets.push(i)}}assignDataToProcessZones(){for(const s of this.processZonesBusiness){const t=this.panelProcessBusinessManager.get(s.refPanelProcess);s.panelProcess=t}}}class Ba extends w{addInstances(s){for(const t of s)this.addInstance(t.key,$e.fromAssemblyBusiness(t));return this}}class Sa extends w{addInstances(s){for(const t of s)this.addInstance(t.key,Je.fromBoardMaterialBusiness(t));return this}}const pe=class pe extends w{constructor(){super(...arguments),this.findProjectComponent=(s,t,e)=>{const a=s.name,i=e.find(n=>n.name===a);if(i)return i;const r=t.find(n=>n.name===a);return r||null},this.getAll=()=>{const s=Array.from(this.instances.values());return s.map(t=>this.clone(t)),s}}addInstances(s,t,e){const a=this.findProjectComponent(s,t,e);return a&&this.addInstance(a.key,a),this}clone(s){return Object.assign(Object.create(Object.getPrototypeOf(s)),s)}};pe.createBOM=s=>{var t,e,a,i;for(const r of(t=s.refPartsQuantities)!=null?t:[]){const{key:n}=r;if(s.children)for(let h=((e=s.children)==null?void 0:e.length)-1;h>=0;h--)n===s.children[h].key&&s.children.splice(h,1)}for(const r of(a=s.refAssembliesQuantities)!=null?a:[]){const{key:n,quantity:h}=r;let o=h;if(s.children)for(let l=((i=s.children)==null?void 0:i.length)-1;l>=0;l--)n===s.children[l].key&&(o--,o>1&&s.children.splice(l,1))}return s};let Vt=pe;class ie{constructor(s,t){this.articles=s,this.cost=t}static fromCostBusiness(s){return new ie(s.articles,s.cost)}}class Ca extends w{addInstances(s){return this.addInstance("0",ie.fromCostBusiness(s[0])),this}}class Na extends w{constructor(){super(...arguments),this.getGroupKey=s=>{var t;return"".concat(s.length,"_").concat(s.width,"_").concat(s.thickness,"_").concat((t=s.material)==null?void 0:t.name)}}addInstances(s){for(const t of s)this.addInstance(t.key,ps.fromEdgebandBusiness(t));return this}}class Oa extends w{addInstances(s){for(const t of s)this.addInstance(t.key,Ze.fromEdgebandMaterialBusiness(t));return this}}class Ra extends w{constructor(){super(...arguments),this.FrameTypedObjectName="EXCLUDED"}addInstances(s){for(const t of s)this.addInstance(t.key,As.fromExcludedBusiness(t));return this}}class Ea extends w{addInstances(s){for(const t of s)t.getIsExcluded()||this.addInstance(t.key,bs.fromFrameBusiness(t));return this}}class Va extends w{constructor(){super(...arguments),this.FrameTypedObjectName="HARDWARE"}addInstances(s){for(const t of s)t.getIsExcluded()||this.addInstance(t.key,Ps.fromHardwareBusiness(t));return this}}const H=class H{};H.makeLabels=s=>{const t=[];let e=1;const a=i=>{const r=i.quantity>0?i.quantity:1;for(let n=0;n<r;n++){const h=H.clone(i);h.instance=n+1,h.instanceLabel=e,e++,t.push(h)}};return s==null||s.forEach(i=>a(i)),t},H.clone=s=>Object.assign(Object.create(Object.getPrototypeOf(s)),s),H.deepCopy=s=>{if(s==null)return s;if(s instanceof Date)return new Date(s.getTime());if(Array.isArray(s))return s.map(t=>H.deepCopy(t));if(typeof s=="object"){const t={};for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e)){const a=s[e];t[e]=H.deepCopy(a)}return t}return s};let Lt=H;class La{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.name=i,this.description=r,this.category=n,this.thickness=h,this.hasGrain=o,this.cost=l,this.costUnit=d,this.costType=g,this.quantity=c,this.type=u,this.unitOfMeasure=p,this.resource="laminateMaterials"}static fromMaterialBusiness(s){return s.createViewModel()}}class Wa extends w{addInstances(s){for(const t of s)t.getIsWeldment()||t.getType()!==1||this.addInstance(t.key,La.fromMaterialBusiness(t));return this}}class xa extends w{constructor(){super(...arguments),this.combinedInstances=new Map,this.getLongest=(s,t,e)=>e?{length:s,width:t}:t>s?{width:t,length:s}:{length:s,width:t},this.getGroupKey=s=>{var a,i,r,n,h;const{length:t,width:e}=this.getLongest(s.length,s.width,(i=(a=s.material)==null?void 0:a.hasGrain)!=null?i:!1);return"".concat(t,"_").concat(e,"_").concat(s.thickness,"_").concat((n=(r=s.material)==null?void 0:r.hasGrain)!=null?n:!1,"_").concat((h=s.material)==null?void 0:h.name)},this.getAllCombined=()=>{const s=new Map;for(const a of this.instances.values()){const i=this.getGroupKey(a);s.has(i)||s.set(i,[]),s.get(i).push(a)}const t=new Map;let e=1;for(const[,a]of s)if(a.length===1){const i=a[0];t.set(i.name,i)}else{const i=a[0],r=a.reduce((h,o)=>h+o.quantity,0),n=us.createCombinedLaminate(i,"Combined Laminate ".concat(e++),r);n.children=a,n.part=i.part,n.panel=i.panel,n.material=i.material,t.set(n.name,n)}return Array.from(t.values())}}addInstances(s){for(const t of s)this.addInstance(t.key,us.fromLaminateBusiness(t));return this}}class Qa extends w{addInstances(s){for(const t of s)t.getIsWeldment()||t.getType()!==0&&t.getType()!==2||this.addInstance(t.key,ze.fromMaterialBusiness(t));return this}}class ja extends w{addInstances(s,t){for(const e of t)this.addInstance("".concat(s,"-").concat(e.messageType),e);return this}processMessages(s,t,e,a,i,r,n,h,o,l,d,g,c){this.processProjectMessages(s),this.processSourceMessages(t),this.processSourceMessages(e),this.processSourceMessages(a),this.processSourceMessages(i),this.processSourceMessages(r),this.processSourceMessages(n),this.processSourceMessages(h),this.processSourceMessages(o),this.processSourceMessages(l),this.processSourceMessages(d),this.processSourceMessages(g),this.processSourceMessages(c),this.processPanelMessages(t),this.processProgramMessages(o)}processSourceMessages(s){for(const t of s)this.addInstances(t.key,t.messages)}processProjectMessages(s){this.addInstances(s.name,s.messages)}processPanelMessages(s){for(const t of s)this.processPanelSize(t),this.processPanelLength(t),this.processPanelWidth(t),this.processPanelInvalidDimensions(t)}processProgramMessages(s){for(const t of s)this.processProgramEncodeMessage(t)}processPanelSize(s){if(s.hasGrain===!1&&s.boardLength>0&&s.boardWidth>0){const t=s.lengthStock<=s.boardLength&&s.widthStock<=s.boardWidth,e=s.lengthStock<=s.boardWidth&&s.widthStock<=s.boardLength;if(!t&&!e){const a=new D("ERROR","Error","size out of range. Panel Size: ".concat(s.lengthStock," x ").concat(s.widthStock," | Board: ").concat(s.boardLength," x ").concat(s.boardWidth),"size out of range. Panel Size: ".concat(s.lengthStock," x ").concat(s.widthStock," | Board: ").concat(s.boardLength," x ").concat(s.boardWidth),s.name,s.name,"Panel","");this.addInstance("".concat(s.key,"-").concat(a.message),a),s.messages.push(a)}}}processPanelLength(s){if(s.boardLength<s.lengthStock&&s.boardLength>0&&s.hasGrain){const t=new D("ERROR","Error","length out of range. Length: ".concat(s.lengthStock," | Board: ").concat(s.boardLength," x ").concat(s.boardWidth),"length out of range. Length: ".concat(s.lengthStock," | Board: ").concat(s.boardLength," x ").concat(s.boardWidth),s.name,s.name,"Panel","");this.addInstance("".concat(s.key,"-").concat(t.message),t),s.messages.push(t)}}processPanelWidth(s){if(s.boardWidth<s.widthStock&&s.boardWidth>0&&s.hasGrain){const t=new D("ERROR","Error","width out of range. Width: ".concat(s.widthStock," | Board: ").concat(s.boardLength," x ").concat(s.boardWidth),"width out of range. Width: ".concat(s.widthStock," | Board: ").concat(s.boardLength," x ").concat(s.boardWidth),s.name,s.name,"Panel","");this.addInstance("".concat(s.key,"-").concat(t.message),t),s.messages.push(t)}}processPanelInvalidDimensions(s){if(s.length===0){const t=new D("ERROR","Error","invalid length dimension, value is 0","invalid length dimension, value is 0",s.name,s.name,"Panel","");this.addInstance("".concat(s.key,"-").concat(t.message),t),s.messages.push(t)}if(s.width===0){const t=new D("ERROR","Error","invalid width dimension, value is 0","invalid width dimension, value is 0",s.name,s.name,"Panel","");this.addInstance("".concat(s.key,"-").concat(t.message),t),s.messages.push(t)}if(s.thickness===0){const t=new D("ERROR","Error","invalid thickness dimension, value is 0","invalid thickness dimension, value is 0",s.name,s.name,"Panel","");this.addInstance("".concat(s.key,"-").concat(t.message),t),s.messages.push(t)}}processProgramEncodeMessage(s){var e;const t=(e=s.variables.ENCODEMSG)!=null?e:"";if(t!==""){const a=new D("ERROR","Error",t,t,s.name,s.name,"Program","");this.addInstance("".concat(s.key,"-").concat(t),a),s.messages.push(a)}}}class Fa extends w{constructor(){super(...arguments),this.combine=!1}addInstances(s){for(const t of s)t.getIsExcluded()||this.addInstance(t.key,t.createViewModel());return this}}class Ua extends w{addInstances(s){for(const t of s)this.addInstance(t.key,t.createViewModel());return this}}class Ga extends w{addInstances(s){for(const t of s)this.addInstance(t.key,Ye.fromPartBusiness(t));return this}}class Ha extends w{addInstances(s){for(const t of s)this.addInstance(t.key,Ke.fromPatternBusiness(t));return this}}class $a extends w{addInstances(s){for(const t of s)this.addInstance(t.key,t.createViewModel());return this}}class qa extends w{addInstances(s){for(const t of s)this.addInstance(t.key,Bs.fromProfileBusiness(t));return this}}class Za extends w{addInstances(s){for(const t of s)t.refBoard||this.addInstance(t.key,Ms.fromProgramBusiness(t));return this}}class za extends w{addInstances(s){for(const t of s)this.addInstance(t.key,ys.fromProgramPartBusiness(t));return this}}class Ya extends w{addInstances(s){for(const t of s)t.refBoard&&this.addInstance(t.key,Ts.fromProgramBusiness(t));return this}}const et=class et{constructor(s,t,e,a){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.resource="spindles"}};et.fromSpindleBusiness=s=>new et(s.key,D.fromMessagesRaw(s.messages,s.key,"Spindle",""),s.documents,s.variables);let Wt=et;class _a extends w{addInstances(s){if(!s)return this;for(const t of s)this.addInstance(t.key,Wt.fromSpindleBusiness(t));return this}}class Xa extends w{constructor(){super(...arguments),this.sourceInstances=new Map,this.combine=!1}addInstances(s){var t,e,a;for(const i of s)(t=i.material)!=null&&t.getIsWeldment()||((e=i.material)==null?void 0:e.getType())!==0&&((a=i.material)==null?void 0:a.getType())!==2||this.addInstance(i.key,ws.fromStockBusiness(i));return this}}class Ka extends w{addInstances(s){for(const t of s)t.getIsExcluded()||this.addInstance(t.key,vs.fromFrameBusiness(t));return this}}class Ja extends w{addInstances(s){for(const t of s)this.addInstance(t.key,Ds.fromToolBusiness(t));return this}}class si{constructor(){this.instances=new Map,this.addInstance=(s,t)=>{const e=this.instances.get(s);e?e.push(t):this.instances.set(s,[t])},this.addInstances=(s,t,e)=>{for(const a of s.typedObjects){const i=t.get(a);if(i){const n=i.variables.TOTYPES.split(";");for(const h of n)this.addInstance(h,i)}const r=e.get(a);if(r){const n=r.variables.TOTYPES.split(";");for(const h of n)this.addInstance(h,r)}}return this},this.getInstancesByName=s=>this.instances.get(s)||void 0,this.getAll=()=>Object.fromEntries(this.instances)}}class ti extends w{addInstances(s){for(const t of s)t.getIsExcluded()||this.addInstance(t.key,_e.fromWeldmentBusiness(t));return this}get(s){var e;const t=this.instances.get(s);if(t)return t;for(const a of this.instances.values())for(const i of(e=a.children)!=null?e:[])if(i.key===s)return i}getFromRefPart(s){const t=[],e=Array.from(this.instances.values());for(const a of e)a.refPart===s&&t.push(a);return t}}class ei extends w{addInstances(s){for(const t of s)this.addInstance(t.key,Xe.fromMaterialBusiness(t));return this}}class sa{constructor(s,t,e,a,i,r,n,h,o,l,d,g,c,u,p,m,b,M,P,y,T,B,k,S,C,N,O,R,I,L,Q,j,F,G,$,q,Z,_,X,K,J,ss,ts,es,as,is,rs,ns,hs,os,cs,it,rt,nt,ta,ea,aa,ia,ra,na,ha){this.database=s,this.settings=t,this.project=e,this.panels=a,this.stocks=i,this.parts=r,this.assemblies=n,this.bom=h,this.edgebands=o,this.laminates=l,this.programs=d,this.sheets=g,this.programParts=c,this.tools=u,this.spindles=p,this.costs=m,this.messages=b,this.typedObjects=M,this.frames=P,this.subFrames=y,this.hardware=T,this.excluded=B,this.panelProcesses=k,this.processZones=S,this.profiles=C,this.weldments=N,this.patterns=O,this.panelMaterials=R,this.laminateMaterials=I,this.edgebandMaterials=L,this.weldmentMaterials=Q,this.boardMaterials=j,this.panelManager=F,this.stockManager=G,this.partManager=$,this.assemblyManager=q,this.edgebandManager=Z,this.edgebandMaterialManager=_,this.laminateManager=X,this.materialManager=K,this.laminateMaterialManager=J,this.weldmentMaterialManager=ss,this.boardMaterialManager=ts,this.programManager=es,this.sheetManager=as,this.programPartManager=is,this.toolManager=rs,this.spindleManager=ns,this.costManager=hs,this.messageManager=os,this.typedObjectManager=cs,this.frameManager=it,this.subFrameManager=rt,this.hardwareManager=nt,this.excludedManager=ta,this.panelProcessManager=ea,this.processZoneManager=aa,this.profileManager=ia,this.weldmentManager=ra,this.patternManager=na,this.labelManager=ha,this.relateData=()=>(this.assignDataToProject(),this.assignDataToEdgebands(),this.assignDataToStocks(),this.assignDataToWeldments(),this.assignDataToLaminates(),this.assignDataToPanels(),this.assignDataToAssemblies(),this.assignSubAssemblies(),this.assignDataToFrames(),this.assignDataToSubFrames(),this.assignDataToParts(),this.assignDataToSheets(),this.assignDataToPrograms(),this.assignDataToProgramParts(),this.assignDataToProcessZones(),this.assignDataToPatterns(),this.assignDataToBoards(),this.assignDataToTools(),this)}static createFromRawData(s,t,e){if(x.getInstance(s,t,e),!e.status)throw Error("");const a=Ss.createFromRawData(s,t),i=qe.fromProjectBusiness(a.projectBusiness),r=new Fa().addInstances(a.panelsBusiness),n=new Qa().addInstances(a.materialsBusiness),h=new Xa().addInstances(a.stocksBusiness),o=new Ga().addInstances(a.partsBusiness),l=new Ba().addInstances(a.assembliesBusiness),d=new Na().addInstances(a.edgebandsBusiness),g=new Oa().addInstances(a.edgebandMaterialsBusiness),c=new xa().addInstances(a.laminatesBusiness),u=new Wa().addInstances(a.materialsBusiness),p=new ei().addInstances(a.weldmentMaterialsBusiness),m=new Sa().addInstances(a.boardMaterialsBusiness),b=new Za().addInstances(a.programsBusiness),M=new Ya().addInstances(a.sheetBusiness),P=new za().addInstances(a.programPartsBusiness),y=new Ja().addInstances(a.toolsBusiness),T=new _a().addInstances(a.spindlesBusiness),B=new Ca().addInstances(a.costsBusiness),k=new ja,S=new si().addInstances(s,o,l),C=new Ea().addInstances(a.framesBusiness),N=new Ka().addInstances(a.subFramesBusiness),O=new Va().addInstances(a.hardwaresBusiness),R=new Ra().addInstances(a.excludedItemsBusiness),I=new Ua().addInstances(a.panelProcessesBusiness),L=new $a().addInstances(a.processZonesBusiness),Q=new qa().addInstances(a.profilesBusiness),j=new ti().addInstances(a.weldmentsBusiness),F=new Ha().addInstances(a.patternsBusiness),G=new Vt().addInstances(i,l.getAll(),o.getAll());return k.processMessages(i,r.getAll(),h.getAll(),o.getAll(),l.getAll(),d.getAll(),c.getAll(),n.getAll(),b.getAll(),M.getAll(),P.getAll(),y.getAll(),T.getAll()),new sa(s,t,i,r.getAll(),h.getAll(),o.getAll(),l.getAll(),G.getAll(),d.getAll(),c.getAll(),b.getAll(),M.getAll(),P.getAll(),y.getAll(),T.getAll(),B.getAll(),k.getAll(),S.getAll(),C.getAll(),N.getAll(),O.getAll(),R.getAll(),I.getAll(),L.getAll(),Q.getAll(),j.getAll(),F.getAll(),n.getAll(),u.getAll(),g.getAll(),p.getAll(),m.getAll(),r,h,o,l,d,g,c,n,u,p,m,b,M,P,y,T,B,k,S,C,N,O,R,I,L,Q,j,F,Lt).relateData()}assignDataToProject(){}assignDataToEdgebands(){for(const s of this.edgebandManager.getAll())s.material=this.edgebandMaterialManager.get(s.refMaterial),s.part=this.partManager.get(s.refPanel),s.panel=this.panelManager.get(s.refPanel)}assignDataToStocks(){var s;for(const t of this.stockManager.getAll()){this.assignDataToStock(t);for(const e of(s=t.children)!=null?s:[])this.assignDataToStock(e)}}assignDataToStock(s){s.material=this.materialManager.get(s.refMaterial),s.material||console.warn("material not found for stock: ".concat(s.key)),s.part=this.partManager.get(s.refPart),s.panel=this.panelManager.get(s.refPart)}assignDataToWeldments(){for(const s of this.weldments)s.material=this.materialManager.get(s.refMaterial),s.part=this.partManager.get(s.refPart)}assignDataToLaminates(){for(const s of this.laminateManager.getAll())s.material=this.laminateMaterialManager.get(s.refMaterial),s.material||console.warn("material not found for laminate: ".concat(s.key)),s.part=this.partManager.get(s.refPanel),s.panel=this.panelManager.get(s.refPanel)}assignDataToPanels(){for(const s of this.panels)this.assignDataToPanel(s)}assignDataToPanel(s){var e,a;s.project=this.project;const t=this.partManager.get(s.refPart);t&&(s.part=t);for(const i of s.refStocks){const r=this.stockManager.get(i);if(r){s.stocks.push(r),r.material||console.warn("material not found for stock",r.key,"in panel",s.key),r.variables.ST_N==="CORE"&&(s.material=r.material),(e=r.variables.ST_N)!=null&&e.includes("LAYER")&&s.layers.push(r);continue}const n=this.laminateManager.get(i);n&&(s.laminates.push(n),n.name==="TOP"&&(s.laminateTop=n),n.name==="BOTTOM"&&(s.laminateBottom=n),(a=n.variables.ST_N)!=null&&a.includes("LAYER")&&s.layers.push(n))}for(const i of s.refEdgebands){const r=this.edgebandManager.get(i);r&&(s.edgebands.push(r),r.position==="F"&&(s.edgebandFront=r),r.position==="B"&&(s.edgebandBack=r),r.position==="L"&&(s.edgebandLeft=r),r.position==="R"&&(s.edgebandRight=r))}for(const i of s.refPrograms){const r=this.programManager.get(i);r&&(s.programs.push(r),r.panel=s,r.material=s.material,t&&(r.part=t))}for(const i of s.refProcessZones){const r=this.processZoneManager.get(i);r&&s.processZones.push(r)}for(const i of this.patterns)for(const r of i.refPanels)r===s.name&&(s.pattern=i)}assignDataToAssemblies(){for(const s of this.assemblyManager.getAll()){for(const t of s.refParts){const e=this.partManager.get(t);e&&(s.parts.push(e),s.children||(s.children=[]),s.children.push(e))}for(const t of s.refPrograms){const e=this.programManager.get(t);e&&s.programs.push(e)}}}assignSubAssemblies(){for(const s of this.assemblyManager.getAll())for(const t of s.refAssemblies){const e=this.assemblyManager.get(t);e&&(s.assemblies.push(e),s.children||(s.children=[]),s.children.push(e))}}assignDataToFrames(){var s,t,e,a;for(const i of this.frameManager.getAll()){for(const r of i.refParts){const n=this.partManager.get(r);if(n){(s=i.parts)==null||s.push(n);const l=this.weldmentManager.getFromRefPart(r);l&&(i.weldments=[...l])}const h=this.panelManager.get(r);if(h){(t=h.frames)==null||t.push(i),i.panels.push(h);for(const d of h.programs)i.programs.push(d);const l=i.refPartsQuantities.filter(d=>d.key===h.key).reduce((d,g)=>d+g.quantity,0);h.refQuantities.push({key:i.key,quantity:l})}const o=this.hardwareManager.get(r);if(o){i.hardware.push(o),(e=o.frames)==null||e.push(i);const l=[...i.refPartsQuantities,...i.refAssembliesQuantities].filter(d=>d.key===o.key).reduce((d,g)=>d+g.quantity,0);o.refQuantities.push({key:i.key,quantity:l})}}for(const r of i.refAssemblies){const n=this.assemblyManager.get(r);n&&i.assemblies.push(n);const h=this.subFrameManager.get(r);if(h){i.subFrames||(i.subFrames=[]),i.subFrames.push(h);const l=i.refAssembliesQuantities.filter(d=>d.key===h.key).reduce((d,g)=>d+g.quantity,0);h.refQuantities.push({key:i.key,quantity:l})}const o=this.hardwareManager.get(r);if(o){i.hardware.push(o),(a=o.frames)==null||a.push(i);const l=[...i.refPartsQuantities,...i.refAssembliesQuantities].filter(d=>d.key===o.key).reduce((d,g)=>d+g.quantity,0);o.refQuantities.push({key:i.key,quantity:l})}}}}assignDataToSubFrames(){var s;for(const t of this.subFrameManager.getAll()){for(const e of t.refParts){const a=this.partManager.get(e);if(a){(s=t.parts)==null||s.push(a);const n=this.weldmentManager.getFromRefPart(e);n&&(t.weldments=[...n])}const i=this.panelManager.get(e);if(i){t.panels.push(i);for(const n of i.programs)t.programs.push(n)}const r=this.hardwareManager.get(e);r&&t.hardware.push(r)}for(const e of t.refAssemblies){const a=this.assemblyManager.get(e);a&&t.assemblies.push(a);const i=this.hardwareManager.get(e);i&&t.hardware.push(i);const r=this.subFrameManager.get(e);r&&(r.subFrames||(r.subFrames=[]),r.subFrames.push(r))}}}assignDataToParts(){var s;for(const t of this.partManager.getAll()){t.panel=t.refPanel?this.panelManager.get(t.refPanel):void 0;for(const e of(s=t.refStocks)!=null?s:[]){const a=this.stockManager.get(e);a&&t.stocks.push(a)}for(const e of t.refPrograms){const a=this.programManager.get(e);a&&t.programs.push(a)}}}assignDataToSheets(){var s,t,e;for(const a of this.sheets){for(const r of(s=a.refProgramParts)!=null?s:[]){const n=this.programPartManager.get(r);n&&a.programParts.push(n)}for(const r of(t=a.refTools)!=null?t:[]){const n=this.toolManager.get(r);n&&a.tools.push(n)}const i=this.boardMaterialManager.get((e=a.refBoard)!=null?e:"");a.board=i!=null?i:void 0}}assignDataToPrograms(){var s;for(const t of this.programs)for(const e of(s=t.refTools)!=null?s:[]){const a=this.toolManager.get(e);a&&t.tools.push(a)}}assignDataToProgramParts(){var s,t;for(const e of this.programParts){const a=this.panelManager.get(e.refPart);e.panel=a,a&&(a.programParts=(s=a.programParts)!=null?s:[],a.programParts.push(e));const i=this.partManager.get(e.refPart);e.part=i!=null?i:void 0,e.programs=(t=i==null?void 0:i.programs)!=null?t:[];const r=this.sheetManager.get(e.refProgram);e.sheet=r!=null?r:void 0}}assignDataToProcessZones(){for(const s of this.processZones){const t=this.panelProcessManager.get(s.refPanelProcess);s.panelProcess=t}}assignDataToPatterns(){const s=new Map(this.panelManager.getAll().map(t=>[t.name,t]));for(const t of this.patterns){t.panels=t.refPanels.map(e=>s.get(e)).filter(e=>!!e);for(const e of this.boardMaterialManager.getAll())if(e.name===t.refBoard){t.board=e;break}}}assignDataToBoards(){for(const s of this.boardMaterialManager.getAll())s.material=this.materialManager.get(s.refMaterial)}assignDataToTools(){for(const s of this.toolManager.getAll())for(const t of s.refSpindles){const e=this.spindleManager.get(t);e?s.spindles.push(e):console.warn("Spindle not found for refSpindle: ".concat(t," in tool: ").concat(s.key))}}}export{sa as default};
