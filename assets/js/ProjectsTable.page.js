import{r as s,d as O,j as t,T as V,S as Q,I as X,M as _,B as q,R as G,u as L}from"../main.C0iT5PB5.js";import{X as M,Q as $,b as A,a as U,t as J,S as z,F as H,T as K,c as W,d as w,v as Y}from"./Table.js";import"./VariableParser.js";window.XLSX=M;const Z={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"50%",bgcolor:"white",boxShadow:24,p:4},g=({data:l,settings:e,title:i,filter:o,resource:n=""})=>{var j,R;const[B,u]=s.useState(!1),[m,x]=s.useState(""),[d,F]=s.useState(T(e==null?void 0:e.splitBy)),[p,f]=s.useState(null),[v,C]=s.useState(l),[b,h]=s.useState(o),[y,S]=s.useState(null),E=s.useCallback(a=>O(x,300)(a),[x]);s.useEffect(()=>{if(o){h(o);const r=new $({dataSource:l}).getPredicate(o);S(r)}return()=>{h(void 0),S(null)}},[l,o]),s.useEffect(()=>{const a=A(l,e),r=U(l,m,y,a);if(C(r),d){const c=J(r,d.field,d.emptyValue);f(c)}else f(null)},[l,m,y,d,o]);const P=()=>u(!0),k=(a,r)=>{r!=="backdropClick"&&u(!1)},D=s.useCallback(a=>{var c,I;const r=(I=(c=e==null?void 0:e.splitBy)==null?void 0:c.find(N=>N.field===a))!=null?I:null;F(r),a===null&&f(null)},[]);return t.jsxs(t.Fragment,{children:[i&&t.jsx(V,{variant:"h1",className:"section-title no-print",sx:{marginBottom:2},children:i}),t.jsxs(Q,{direction:"row",mb:1,className:"no-print",alignItems:"center",children:[t.jsx(z,{setFilter:E}),t.jsx(X,{onClick:P,"aria-label":"filter data",color:b?"error":"primary",children:t.jsx(H,{})}),(e==null?void 0:e.splitBy)&&t.jsx(K,{splitBy:(j=e.splitBy)!=null?j:[],handleToggle:a=>D(a),defaultValue:(R=T(e.splitBy))==null?void 0:R.field})]}),t.jsx(_,{open:B,onClose:k,className:"no-print",children:t.jsx(q,{sx:Z,children:t.jsx(W,{data:l,rules:b,setOpen:u,setFilteredData:(a,r,c)=>{h(r),S(c)}})})}),!p&&t.jsx(w,{data:v,settings:e,header:e==null?void 0:e.title,search:!1,resource:n,displayResults:!0}),p&&Array.from(p.entries()).map(([a,r])=>t.jsxs(G.Fragment,{children:[t.jsx(w,{data:r.items,settings:e,header:a?a.toString():"",resource:n,displayResults:!0},a?a.toString():""),t.jsx("br",{})]},Y()))]})},T=l=>{var e;return(e=l==null?void 0:l.find(i=>i.default))!=null?e:null},le=()=>{const l=L();if(!l)return t.jsx("div",{children:"no data available"});const e={title:"Reports",columns:[{field:"projectName",title:"Name",formatter:i=>{const o=i.getValue(),n=i.getData().url;return'<a href="'.concat(n,'">').concat(o,"</a>")}},{field:"createdBy",title:"createdBy",width:250},{field:"quantityRuns",title:"Runs",width:100},{field:"variables.ReportVersion",title:"Report Version",width:175},{field:"reportVersion",title:"Swood Version",width:175},{field:"variables.REPORT_ISUSINGDESIGN",title:"design",width:100,formatter:"tickCross"},{field:"variables.REPORT_ISUSINGCAM",title:"cam",width:100,formatter:"tickCross"},{field:"variables.REPORT_ISNESTINGPROJECT",title:"nest",width:100,formatter:"tickCross"},{field:"createdDate",title:"date",width:300}]};return t.jsx(g,{data:l,settings:e,title:"List of Reports"})};export{le as default};
